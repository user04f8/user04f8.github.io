var eH=Object.defineProperty;var tH=(t,e,n)=>e in t?eH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var X=(t,e,n)=>tH(t,typeof e!="symbol"?e+"":e,n);function a3(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(t,e){const n=Ru,s=t();for(;;)try{if(parseInt(n(332))/1+-parseInt(n(342))/2+parseInt(n(327))/3*(-parseInt(n(322))/4)+parseInt(n(317))/5*(parseInt(n(344))/6)+-parseInt(n(321))/7+-parseInt(n(323))/8+parseInt(n(326))/9===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Gx,632012),function(){const e=Ru,n=function(){let o=!0;return function(a,l){const c=o?function(){if(l){const u=l.apply(a,arguments);return l=null,u}}:function(){};return o=!1,c}}(),s=document.createElement(e(306))[e(312)];if(s&&s[e(315)]&&s.supports(e(316)))return;for(const o of document[e(328)]('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{const a=e;for(const l of o)if(l[a(333)]===a(335))for(const c of l[a(339)])c.tagName===a(314)&&c[a(338)]===a(316)&&i(c)})[e(343)](document,{childList:!0,subtree:!0});function r(o){const a=e,l={};return o[a(304)]&&(l[a(304)]=o[a(304)]),o.referrerPolicy&&(l[a(311)]=o[a(311)]),o[a(337)]===a(341)?l[a(331)]="include":o[a(337)]===a(305)?l[a(331)]=a(334):l[a(331)]=a(330),l}function i(o){if(function(){n(this,function(){const l=Ru,c=new RegExp(l(345)),u=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),h=WE("init");!c[l(340)](h+l(324))||!u[l(340)](h+"input")?h("0"):WE()})()}(),o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}}();function Ru(t,e){const n=Gx();return Ru=function(s,r){return s=s-304,n[s]},Ru(t,e)}function Gx(){const t=["observe","282DDhkGn","function *\\( *\\)","integrity","anonymous","link","apply","gger","call","stateObject","referrerPolicy","relList","while (true) {}","LINK","supports","modulepreload","32565JNrEnO","action","string","length","3745987KQWtnx","20keGdBu","10074448WqqtSN","chain","counter","18209880WXHULf","183531iZUcdx","querySelectorAll","constructor","same-origin","credentials","1119729EKuwGT","type","omit","childList","debu","crossOrigin","rel","addedNodes","test","use-credentials","1433632GZTRLv"];return Gx=function(){return t},Gx()}function WE(t){function e(n){const s=Ru;if(typeof n===s(319))return(function(r){})[s(329)](s(313))[s(307)](s(325));(""+n/n)[s(320)]!==1||n%20===0?(function(){return!0})[s(329)](s(336)+s(308))[s(309)](s(318)):(function(){return!1})[s(329)](s(336)+"gger")[s(307)](s(310)),e(++n)}try{if(t)return e;e(0)}catch{}}function ju(t,e){var n=qx();return ju=function(s,r){s=s-273;var i=n[s];return i},ju(t,e)}var fu=ju;(function(t,e){for(var n=ju,s=t();;)try{var r=-parseInt(n(288))/1+-parseInt(n(291))/2*(-parseInt(n(277))/3)+parseInt(n(287))/4*(parseInt(n(300))/5)+parseInt(n(302))/6*(parseInt(n(282))/7)+parseInt(n(273))/8+parseInt(n(301))/9+-parseInt(n(278))/10*(parseInt(n(276))/11);if(r===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(qx,914710);var nH=function(){var t=!0;return function(e,n){var s=t?function(){if(n){var r=n.apply(e,arguments);return n=null,r}}:function(){};return t=!1,s}}();(function(){nH(this,function(){var t=ju,e=new RegExp(t(286)),n=new RegExp(t(297),"i"),s=UE("init");!e.test(s+"chain")||!n[t(290)](s+"input")?s("0"):UE()})()})();function qx(){var t=["237013XqeZZX","debu","test","2bEkvto","construct","stateObject","default","keys","prototype","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","apply","hasOwnProperty","90hetWJZ","164970KqhVhn","10003212bquvSW","counter","undefined","8915832vUodkR","__esModule","string","5123492RtNUuN","2114706QvpvjB","80ZxlaWT","call","forEach","length","7OOFWqG","defineProperty","function","constructor","function *\\( *\\)","305108Mjpddp"];return qx=function(){return t},qx()}var Pc=typeof globalThis!==fu(304)?globalThis:typeof window!==fu(304)?window:typeof global!==fu(304)?global:typeof self!==fu(304)?self:{};function l3(t){var e=fu;return t&&t.__esModule&&Object[e(296)][e(299)][e(279)](t,"default")?t[e(294)]:t}function sH(t){var e=fu;if(t[e(274)])return t;var n=t[e(294)];if(typeof n==e(284)){var s=function r(){var i=e;return this instanceof r?Reflect[i(292)](n,arguments,this[i(285)]):n[i(298)](this,arguments)};s[e(296)]=n[e(296)]}else s={};return Object[e(283)](s,e(274),{value:!0}),Object[e(295)](t)[e(280)](function(r){var i=e,o=Object.getOwnPropertyDescriptor(t,r);Object[i(283)](s,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),s}function UE(t){function e(n){var s=ju;if(typeof n===s(275))return(function(r){}).constructor("while (true) {}")[s(298)](s(303));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(285)](s(289)+"gger")[s(279)]("action"):(function(){return!1})[s(285)]("debugger")[s(298)](s(293)),e(++n)}try{if(t)return e;e(0)}catch{}}var c3={exports:{}},V1={},u3={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cm=Symbol.for("react.element"),rH=Symbol.for("react.portal"),iH=Symbol.for("react.fragment"),oH=Symbol.for("react.strict_mode"),aH=Symbol.for("react.profiler"),lH=Symbol.for("react.provider"),cH=Symbol.for("react.context"),uH=Symbol.for("react.forward_ref"),hH=Symbol.for("react.suspense"),dH=Symbol.for("react.memo"),fH=Symbol.for("react.lazy"),jE=Symbol.iterator;function pH(t){return t===null||typeof t!="object"?null:(t=jE&&t[jE]||t["@@iterator"],typeof t=="function"?t:null)}var h3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},d3=Object.assign,f3={};function kh(t,e,n){this.props=t,this.context=e,this.refs=f3,this.updater=n||h3}kh.prototype.isReactComponent={};kh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};kh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function p3(){}p3.prototype=kh.prototype;function zC(t,e,n){this.props=t,this.context=e,this.refs=f3,this.updater=n||h3}var BC=zC.prototype=new p3;BC.constructor=zC;d3(BC,kh.prototype);BC.isPureReactComponent=!0;var HE=Array.isArray,m3=Object.prototype.hasOwnProperty,VC={current:null},g3={key:!0,ref:!0,__self:!0,__source:!0};function x3(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)m3.call(e,s)&&!g3.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:cm,type:t,key:i,ref:o,props:r,_owner:VC.current}}function mH(t,e){return{$$typeof:cm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function WC(t){return typeof t=="object"&&t!==null&&t.$$typeof===cm}function gH(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var GE=/\/+/g;function Kv(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gH(""+t.key):e.toString(36)}function px(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case cm:case rH:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+Kv(o,0):s,HE(r)?(n="",t!=null&&(n=t.replace(GE,"$&/")+"/"),px(r,e,n,"",function(c){return c})):r!=null&&(WC(r)&&(r=mH(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(GE,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",HE(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+Kv(i,a);o+=px(i,e,n,l,r)}else if(l=pH(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+Kv(i,a++),o+=px(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function m0(t,e,n){if(t==null)return t;var s=[],r=0;return px(t,s,"","",function(i){return e.call(n,i,r++)}),s}function xH(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ks={current:null},mx={transition:null},yH={ReactCurrentDispatcher:ks,ReactCurrentBatchConfig:mx,ReactCurrentOwner:VC};function y3(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:m0,forEach:function(t,e,n){m0(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return m0(t,function(){e++}),e},toArray:function(t){return m0(t,function(e){return e})||[]},only:function(t){if(!WC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};We.Component=kh;We.Fragment=iH;We.Profiler=aH;We.PureComponent=zC;We.StrictMode=oH;We.Suspense=hH;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yH;We.act=y3;We.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=d3({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=VC.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)m3.call(e,l)&&!g3.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:cm,type:t.type,key:r,ref:i,props:s,_owner:o}};We.createContext=function(t){return t={$$typeof:cH,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lH,_context:t},t.Consumer=t};We.createElement=x3;We.createFactory=function(t){var e=x3.bind(null,t);return e.type=t,e};We.createRef=function(){return{current:null}};We.forwardRef=function(t){return{$$typeof:uH,render:t}};We.isValidElement=WC;We.lazy=function(t){return{$$typeof:fH,_payload:{_status:-1,_result:t},_init:xH}};We.memo=function(t,e){return{$$typeof:dH,type:t,compare:e===void 0?null:e}};We.startTransition=function(t){var e=mx.transition;mx.transition={};try{t()}finally{mx.transition=e}};We.unstable_act=y3;We.useCallback=function(t,e){return ks.current.useCallback(t,e)};We.useContext=function(t){return ks.current.useContext(t)};We.useDebugValue=function(){};We.useDeferredValue=function(t){return ks.current.useDeferredValue(t)};We.useEffect=function(t,e){return ks.current.useEffect(t,e)};We.useId=function(){return ks.current.useId()};We.useImperativeHandle=function(t,e,n){return ks.current.useImperativeHandle(t,e,n)};We.useInsertionEffect=function(t,e){return ks.current.useInsertionEffect(t,e)};We.useLayoutEffect=function(t,e){return ks.current.useLayoutEffect(t,e)};We.useMemo=function(t,e){return ks.current.useMemo(t,e)};We.useReducer=function(t,e,n){return ks.current.useReducer(t,e,n)};We.useRef=function(t){return ks.current.useRef(t)};We.useState=function(t){return ks.current.useState(t)};We.useSyncExternalStore=function(t,e,n){return ks.current.useSyncExternalStore(t,e,n)};We.useTransition=function(){return ks.current.useTransition()};We.version="18.3.1";u3.exports=We;var H=u3.exports;const ze=l3(H),bH=a3({__proto__:null,default:ze},[H]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wH=H,vH=Symbol.for("react.element"),SH=Symbol.for("react.fragment"),kH=Object.prototype.hasOwnProperty,CH=wH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,TH={key:!0,ref:!0,__self:!0,__source:!0};function b3(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)kH.call(e,s)&&!TH.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:vH,type:t,key:i,ref:o,props:r,_owner:CH.current}}V1.Fragment=SH;V1.jsx=b3;V1.jsxs=b3;c3.exports=V1;var z=c3.exports,w3={exports:{}},fr={},v3={exports:{}},S3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(E,V){var G=E.length;E.push(V);e:for(;0<G;){var Y=G-1>>>1,Z=E[Y];if(0<r(Z,V))E[Y]=V,E[G]=Z,G=Y;else break e}}function n(E){return E.length===0?null:E[0]}function s(E){if(E.length===0)return null;var V=E[0],G=E.pop();if(G!==V){E[0]=G;e:for(var Y=0,Z=E.length,ee=Z>>>1;Y<ee;){var te=2*(Y+1)-1,ne=E[te],ie=te+1,ce=E[ie];if(0>r(ne,G))ie<Z&&0>r(ce,ne)?(E[Y]=ce,E[ie]=G,Y=ie):(E[Y]=ne,E[te]=G,Y=te);else if(ie<Z&&0>r(ce,G))E[Y]=ce,E[ie]=G,Y=ie;else break e}}return V}function r(E,V){var G=E.sortIndex-V.sortIndex;return G!==0?G:E.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(E){for(var V=n(c);V!==null;){if(V.callback===null)s(c);else if(V.startTime<=E)s(c),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(c)}}function w(E){if(g=!1,b(E),!p)if(n(l)!==null)p=!0,R(v);else{var V=n(c);V!==null&&O(w,V.startTime-E)}}function v(E,V){p=!1,g&&(g=!1,x(k),k=-1),f=!0;var G=d;try{for(b(V),h=n(l);h!==null&&(!(h.expirationTime>V)||E&&!D());){var Y=h.callback;if(typeof Y=="function"){h.callback=null,d=h.priorityLevel;var Z=Y(h.expirationTime<=V);V=t.unstable_now(),typeof Z=="function"?h.callback=Z:h===n(l)&&s(l),b(V)}else s(l);h=n(l)}if(h!==null)var ee=!0;else{var te=n(c);te!==null&&O(w,te.startTime-V),ee=!1}return ee}finally{h=null,d=G,f=!1}}var S=!1,T=null,k=-1,I=5,_=-1;function D(){return!(t.unstable_now()-_<I)}function A(){if(T!==null){var E=t.unstable_now();_=E;var V=!0;try{V=T(!0,E)}finally{V?L():(S=!1,T=null)}}else S=!1}var L;if(typeof y=="function")L=function(){y(A)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,F=B.port2;B.port1.onmessage=A,L=function(){F.postMessage(null)}}else L=function(){m(A,0)};function R(E){T=E,S||(S=!0,L())}function O(E,V){k=m(function(){E(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(E){E.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,R(v))},t.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<E?Math.floor(1e3/E):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(E){switch(d){case 1:case 2:case 3:var V=3;break;default:V=d}var G=d;d=V;try{return E()}finally{d=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(E,V){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var G=d;d=E;try{return V()}finally{d=G}},t.unstable_scheduleCallback=function(E,V,G){var Y=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?Y+G:Y):G=Y,E){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=G+Z,E={id:u++,callback:V,priorityLevel:E,startTime:G,expirationTime:Z,sortIndex:-1},G>Y?(E.sortIndex=G,e(c,E),n(l)===null&&E===n(c)&&(g?(x(k),k=-1):g=!0,O(w,G-Y))):(E.sortIndex=Z,e(l,E),p||f||(p=!0,R(v))),E},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(E){var V=d;return function(){var G=d;d=V;try{return E.apply(this,arguments)}finally{d=G}}}})(S3);v3.exports=S3;var IH=v3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NH=H,cr=IH;function oe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var k3=new Set,cp={};function Fc(t,e){Hu(t,e),Hu(t+"Capture",e)}function Hu(t,e){for(cp[t]=e,t=0;t<e.length;t++)k3.add(e[t])}var go=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dS=Object.prototype.hasOwnProperty,_H=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qE={},KE={};function $H(t){return dS.call(KE,t)?!0:dS.call(qE,t)?!1:_H.test(t)?KE[t]=!0:(qE[t]=!0,!1)}function EH(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function DH(t,e,n,s){if(e===null||typeof e>"u"||EH(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Cs(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Un[t]=new Cs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Un[e]=new Cs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Un[t]=new Cs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Un[t]=new Cs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Un[t]=new Cs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Un[t]=new Cs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Un[t]=new Cs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Un[t]=new Cs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Un[t]=new Cs(t,5,!1,t.toLowerCase(),null,!1,!1)});var UC=/[\-:]([a-z])/g;function jC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(UC,jC);Un[e]=new Cs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(UC,jC);Un[e]=new Cs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(UC,jC);Un[e]=new Cs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Un[t]=new Cs(t,1,!1,t.toLowerCase(),null,!1,!1)});Un.xlinkHref=new Cs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Un[t]=new Cs(t,1,!1,t.toLowerCase(),null,!0,!0)});function HC(t,e,n,s){var r=Un.hasOwnProperty(e)?Un[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(DH(e,n,r,s)&&(n=null),s||r===null?$H(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Eo=NH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,g0=Symbol.for("react.element"),pu=Symbol.for("react.portal"),mu=Symbol.for("react.fragment"),GC=Symbol.for("react.strict_mode"),fS=Symbol.for("react.profiler"),C3=Symbol.for("react.provider"),T3=Symbol.for("react.context"),qC=Symbol.for("react.forward_ref"),pS=Symbol.for("react.suspense"),mS=Symbol.for("react.suspense_list"),KC=Symbol.for("react.memo"),Yo=Symbol.for("react.lazy"),I3=Symbol.for("react.offscreen"),XE=Symbol.iterator;function Kd(t){return t===null||typeof t!="object"?null:(t=XE&&t[XE]||t["@@iterator"],typeof t=="function"?t:null)}var Ft=Object.assign,Xv;function yf(t){if(Xv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xv=e&&e[1]||""}return`
`+Xv+t}var Yv=!1;function Qv(t,e){if(!t||Yv)return"";Yv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Yv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?yf(t):""}function AH(t){switch(t.tag){case 5:return yf(t.type);case 16:return yf("Lazy");case 13:return yf("Suspense");case 19:return yf("SuspenseList");case 0:case 2:case 15:return t=Qv(t.type,!1),t;case 11:return t=Qv(t.type.render,!1),t;case 1:return t=Qv(t.type,!0),t;default:return""}}function gS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case mu:return"Fragment";case pu:return"Portal";case fS:return"Profiler";case GC:return"StrictMode";case pS:return"Suspense";case mS:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case T3:return(t.displayName||"Context")+".Consumer";case C3:return(t._context.displayName||"Context")+".Provider";case qC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case KC:return e=t.displayName||null,e!==null?e:gS(t.type)||"Memo";case Yo:e=t._payload,t=t._init;try{return gS(t(e))}catch{}}return null}function RH(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gS(e);case 8:return e===GC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Na(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function N3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OH(t){var e=N3(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function x0(t){t._valueTracker||(t._valueTracker=OH(t))}function _3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=N3(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Kx(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function xS(t,e){var n=e.checked;return Ft({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function YE(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Na(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function $3(t,e){e=e.checked,e!=null&&HC(t,"checked",e,!1)}function yS(t,e){$3(t,e);var n=Na(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?bS(t,e.type,n):e.hasOwnProperty("defaultValue")&&bS(t,e.type,Na(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function QE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function bS(t,e,n){(e!=="number"||Kx(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var bf=Array.isArray;function Ou(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Na(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function wS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return Ft({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ZE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(oe(92));if(bf(n)){if(1<n.length)throw Error(oe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Na(n)}}function E3(t,e){var n=Na(e.value),s=Na(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function JE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function D3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vS(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?D3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var y0,A3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(y0=y0||document.createElement("div"),y0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=y0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function up(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var zf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PH=["Webkit","ms","Moz","O"];Object.keys(zf).forEach(function(t){PH.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),zf[e]=zf[t]})});function R3(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||zf.hasOwnProperty(t)&&zf[t]?(""+e).trim():e+"px"}function O3(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=R3(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var FH=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function SS(t,e){if(e){if(FH[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function kS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var CS=null;function XC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var TS=null,Pu=null,Fu=null;function eD(t){if(t=dm(t)){if(typeof TS!="function")throw Error(oe(280));var e=t.stateNode;e&&(e=G1(e),TS(t.stateNode,t.type,e))}}function P3(t){Pu?Fu?Fu.push(t):Fu=[t]:Pu=t}function F3(){if(Pu){var t=Pu,e=Fu;if(Fu=Pu=null,eD(t),e)for(t=0;t<e.length;t++)eD(e[t])}}function M3(t,e){return t(e)}function L3(){}var Zv=!1;function z3(t,e,n){if(Zv)return t(e,n);Zv=!0;try{return M3(t,e,n)}finally{Zv=!1,(Pu!==null||Fu!==null)&&(L3(),F3())}}function hp(t,e){var n=t.stateNode;if(n===null)return null;var s=G1(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(oe(231,e,typeof n));return n}var IS=!1;if(go)try{var Xd={};Object.defineProperty(Xd,"passive",{get:function(){IS=!0}}),window.addEventListener("test",Xd,Xd),window.removeEventListener("test",Xd,Xd)}catch{IS=!1}function MH(t,e,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Bf=!1,Xx=null,Yx=!1,NS=null,LH={onError:function(t){Bf=!0,Xx=t}};function zH(t,e,n,s,r,i,o,a,l){Bf=!1,Xx=null,MH.apply(LH,arguments)}function BH(t,e,n,s,r,i,o,a,l){if(zH.apply(this,arguments),Bf){if(Bf){var c=Xx;Bf=!1,Xx=null}else throw Error(oe(198));Yx||(Yx=!0,NS=c)}}function Mc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function B3(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function tD(t){if(Mc(t)!==t)throw Error(oe(188))}function VH(t){var e=t.alternate;if(!e){if(e=Mc(t),e===null)throw Error(oe(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return tD(r),t;if(i===s)return tD(r),e;i=i.sibling}throw Error(oe(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(oe(189))}}if(n.alternate!==s)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?t:e}function V3(t){return t=VH(t),t!==null?W3(t):null}function W3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=W3(t);if(e!==null)return e;t=t.sibling}return null}var U3=cr.unstable_scheduleCallback,nD=cr.unstable_cancelCallback,WH=cr.unstable_shouldYield,UH=cr.unstable_requestPaint,Yt=cr.unstable_now,jH=cr.unstable_getCurrentPriorityLevel,YC=cr.unstable_ImmediatePriority,j3=cr.unstable_UserBlockingPriority,Qx=cr.unstable_NormalPriority,HH=cr.unstable_LowPriority,H3=cr.unstable_IdlePriority,W1=null,Ii=null;function GH(t){if(Ii&&typeof Ii.onCommitFiberRoot=="function")try{Ii.onCommitFiberRoot(W1,t,void 0,(t.current.flags&128)===128)}catch{}}var Yr=Math.clz32?Math.clz32:XH,qH=Math.log,KH=Math.LN2;function XH(t){return t>>>=0,t===0?32:31-(qH(t)/KH|0)|0}var b0=64,w0=4194304;function wf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zx(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=wf(a):(i&=o,i!==0&&(s=wf(i)))}else o=n&~r,o!==0?s=wf(o):i!==0&&(s=wf(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Yr(e),r=1<<n,s|=t[n],e&=~r;return s}function YH(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QH(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Yr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=YH(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function _S(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function G3(){var t=b0;return b0<<=1,!(b0&4194240)&&(b0=64),t}function Jv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function um(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yr(e),t[e]=n}function ZH(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Yr(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function QC(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Yr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var it=0;function q3(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var K3,ZC,X3,Y3,Q3,$S=!1,v0=[],fa=null,pa=null,ma=null,dp=new Map,fp=new Map,Jo=[],JH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sD(t,e){switch(t){case"focusin":case"focusout":fa=null;break;case"dragenter":case"dragleave":pa=null;break;case"mouseover":case"mouseout":ma=null;break;case"pointerover":case"pointerout":dp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fp.delete(e.pointerId)}}function Yd(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=dm(e),e!==null&&ZC(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function eG(t,e,n,s,r){switch(e){case"focusin":return fa=Yd(fa,t,e,n,s,r),!0;case"dragenter":return pa=Yd(pa,t,e,n,s,r),!0;case"mouseover":return ma=Yd(ma,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return dp.set(i,Yd(dp.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,fp.set(i,Yd(fp.get(i)||null,t,e,n,s,r)),!0}return!1}function Z3(t){var e=Ol(t.target);if(e!==null){var n=Mc(e);if(n!==null){if(e=n.tag,e===13){if(e=B3(n),e!==null){t.blockedOn=e,Q3(t.priority,function(){X3(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ES(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);CS=s,n.target.dispatchEvent(s),CS=null}else return e=dm(n),e!==null&&ZC(e),t.blockedOn=n,!1;e.shift()}return!0}function rD(t,e,n){gx(t)&&n.delete(e)}function tG(){$S=!1,fa!==null&&gx(fa)&&(fa=null),pa!==null&&gx(pa)&&(pa=null),ma!==null&&gx(ma)&&(ma=null),dp.forEach(rD),fp.forEach(rD)}function Qd(t,e){t.blockedOn===e&&(t.blockedOn=null,$S||($S=!0,cr.unstable_scheduleCallback(cr.unstable_NormalPriority,tG)))}function pp(t){function e(r){return Qd(r,t)}if(0<v0.length){Qd(v0[0],t);for(var n=1;n<v0.length;n++){var s=v0[n];s.blockedOn===t&&(s.blockedOn=null)}}for(fa!==null&&Qd(fa,t),pa!==null&&Qd(pa,t),ma!==null&&Qd(ma,t),dp.forEach(e),fp.forEach(e),n=0;n<Jo.length;n++)s=Jo[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Jo.length&&(n=Jo[0],n.blockedOn===null);)Z3(n),n.blockedOn===null&&Jo.shift()}var Mu=Eo.ReactCurrentBatchConfig,Jx=!0;function nG(t,e,n,s){var r=it,i=Mu.transition;Mu.transition=null;try{it=1,JC(t,e,n,s)}finally{it=r,Mu.transition=i}}function sG(t,e,n,s){var r=it,i=Mu.transition;Mu.transition=null;try{it=4,JC(t,e,n,s)}finally{it=r,Mu.transition=i}}function JC(t,e,n,s){if(Jx){var r=ES(t,e,n,s);if(r===null)c2(t,e,s,ey,n),sD(t,s);else if(eG(r,t,e,n,s))s.stopPropagation();else if(sD(t,s),e&4&&-1<JH.indexOf(t)){for(;r!==null;){var i=dm(r);if(i!==null&&K3(i),i=ES(t,e,n,s),i===null&&c2(t,e,s,ey,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else c2(t,e,s,null,n)}}var ey=null;function ES(t,e,n,s){if(ey=null,t=XC(s),t=Ol(t),t!==null)if(e=Mc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=B3(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ey=t,null}function J3(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jH()){case YC:return 1;case j3:return 4;case Qx:case HH:return 16;case H3:return 536870912;default:return 16}default:return 16}}var ta=null,eT=null,xx=null;function eM(){if(xx)return xx;var t,e=eT,n=e.length,s,r="value"in ta?ta.value:ta.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return xx=r.slice(t,1<s?1-s:void 0)}function yx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function S0(){return!0}function iD(){return!1}function pr(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?S0:iD,this.isPropagationStopped=iD,this}return Ft(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=S0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=S0)},persist:function(){},isPersistent:S0}),e}var Ch={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tT=pr(Ch),hm=Ft({},Ch,{view:0,detail:0}),rG=pr(hm),e2,t2,Zd,U1=Ft({},hm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Zd&&(Zd&&t.type==="mousemove"?(e2=t.screenX-Zd.screenX,t2=t.screenY-Zd.screenY):t2=e2=0,Zd=t),e2)},movementY:function(t){return"movementY"in t?t.movementY:t2}}),oD=pr(U1),iG=Ft({},U1,{dataTransfer:0}),oG=pr(iG),aG=Ft({},hm,{relatedTarget:0}),n2=pr(aG),lG=Ft({},Ch,{animationName:0,elapsedTime:0,pseudoElement:0}),cG=pr(lG),uG=Ft({},Ch,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),hG=pr(uG),dG=Ft({},Ch,{data:0}),aD=pr(dG),fG={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pG={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mG={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gG(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mG[t])?!!e[t]:!1}function nT(){return gG}var xG=Ft({},hm,{key:function(t){if(t.key){var e=fG[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?pG[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nT,charCode:function(t){return t.type==="keypress"?yx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yG=pr(xG),bG=Ft({},U1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lD=pr(bG),wG=Ft({},hm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nT}),vG=pr(wG),SG=Ft({},Ch,{propertyName:0,elapsedTime:0,pseudoElement:0}),kG=pr(SG),CG=Ft({},U1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),TG=pr(CG),IG=[9,13,27,32],sT=go&&"CompositionEvent"in window,Vf=null;go&&"documentMode"in document&&(Vf=document.documentMode);var NG=go&&"TextEvent"in window&&!Vf,tM=go&&(!sT||Vf&&8<Vf&&11>=Vf),cD=" ",uD=!1;function nM(t,e){switch(t){case"keyup":return IG.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sM(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var gu=!1;function _G(t,e){switch(t){case"compositionend":return sM(e);case"keypress":return e.which!==32?null:(uD=!0,cD);case"textInput":return t=e.data,t===cD&&uD?null:t;default:return null}}function $G(t,e){if(gu)return t==="compositionend"||!sT&&nM(t,e)?(t=eM(),xx=eT=ta=null,gu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tM&&e.locale!=="ko"?null:e.data;default:return null}}var EG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hD(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!EG[t.type]:e==="textarea"}function rM(t,e,n,s){P3(s),e=ty(e,"onChange"),0<e.length&&(n=new tT("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Wf=null,mp=null;function DG(t){mM(t,0)}function j1(t){var e=bu(t);if(_3(e))return t}function AG(t,e){if(t==="change")return e}var iM=!1;if(go){var s2;if(go){var r2="oninput"in document;if(!r2){var dD=document.createElement("div");dD.setAttribute("oninput","return;"),r2=typeof dD.oninput=="function"}s2=r2}else s2=!1;iM=s2&&(!document.documentMode||9<document.documentMode)}function fD(){Wf&&(Wf.detachEvent("onpropertychange",oM),mp=Wf=null)}function oM(t){if(t.propertyName==="value"&&j1(mp)){var e=[];rM(e,mp,t,XC(t)),z3(DG,e)}}function RG(t,e,n){t==="focusin"?(fD(),Wf=e,mp=n,Wf.attachEvent("onpropertychange",oM)):t==="focusout"&&fD()}function OG(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return j1(mp)}function PG(t,e){if(t==="click")return j1(e)}function FG(t,e){if(t==="input"||t==="change")return j1(e)}function MG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var si=typeof Object.is=="function"?Object.is:MG;function gp(t,e){if(si(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!dS.call(e,r)||!si(t[r],e[r]))return!1}return!0}function pD(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function mD(t,e){var n=pD(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=pD(n)}}function aM(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?aM(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function lM(){for(var t=window,e=Kx();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Kx(t.document)}return e}function rT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LG(t){var e=lM(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&aM(n.ownerDocument.documentElement,n)){if(s!==null&&rT(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=mD(n,i);var o=mD(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var zG=go&&"documentMode"in document&&11>=document.documentMode,xu=null,DS=null,Uf=null,AS=!1;function gD(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;AS||xu==null||xu!==Kx(s)||(s=xu,"selectionStart"in s&&rT(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Uf&&gp(Uf,s)||(Uf=s,s=ty(DS,"onSelect"),0<s.length&&(e=new tT("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=xu)))}function k0(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var yu={animationend:k0("Animation","AnimationEnd"),animationiteration:k0("Animation","AnimationIteration"),animationstart:k0("Animation","AnimationStart"),transitionend:k0("Transition","TransitionEnd")},i2={},cM={};go&&(cM=document.createElement("div").style,"AnimationEvent"in window||(delete yu.animationend.animation,delete yu.animationiteration.animation,delete yu.animationstart.animation),"TransitionEvent"in window||delete yu.transitionend.transition);function H1(t){if(i2[t])return i2[t];if(!yu[t])return t;var e=yu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in cM)return i2[t]=e[n];return t}var uM=H1("animationend"),hM=H1("animationiteration"),dM=H1("animationstart"),fM=H1("transitionend"),pM=new Map,xD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qa(t,e){pM.set(t,e),Fc(e,[t])}for(var o2=0;o2<xD.length;o2++){var a2=xD[o2],BG=a2.toLowerCase(),VG=a2[0].toUpperCase()+a2.slice(1);qa(BG,"on"+VG)}qa(uM,"onAnimationEnd");qa(hM,"onAnimationIteration");qa(dM,"onAnimationStart");qa("dblclick","onDoubleClick");qa("focusin","onFocus");qa("focusout","onBlur");qa(fM,"onTransitionEnd");Hu("onMouseEnter",["mouseout","mouseover"]);Hu("onMouseLeave",["mouseout","mouseover"]);Hu("onPointerEnter",["pointerout","pointerover"]);Hu("onPointerLeave",["pointerout","pointerover"]);Fc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WG=new Set("cancel close invalid load scroll toggle".split(" ").concat(vf));function yD(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,BH(s,e,void 0,t),t.currentTarget=null}function mM(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;yD(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;yD(r,a,c),i=l}}}if(Yx)throw t=NS,Yx=!1,NS=null,t}function yt(t,e){var n=e[MS];n===void 0&&(n=e[MS]=new Set);var s=t+"__bubble";n.has(s)||(gM(e,t,2,!1),n.add(s))}function l2(t,e,n){var s=0;e&&(s|=4),gM(n,t,s,e)}var C0="_reactListening"+Math.random().toString(36).slice(2);function xp(t){if(!t[C0]){t[C0]=!0,k3.forEach(function(n){n!=="selectionchange"&&(WG.has(n)||l2(n,!1,t),l2(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[C0]||(e[C0]=!0,l2("selectionchange",!1,e))}}function gM(t,e,n,s){switch(J3(e)){case 1:var r=nG;break;case 4:r=sG;break;default:r=JC}n=r.bind(null,e,n,t),r=void 0,!IS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function c2(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Ol(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}z3(function(){var c=i,u=XC(n),h=[];e:{var d=pM.get(t);if(d!==void 0){var f=tT,p=t;switch(t){case"keypress":if(yx(n)===0)break e;case"keydown":case"keyup":f=yG;break;case"focusin":p="focus",f=n2;break;case"focusout":p="blur",f=n2;break;case"beforeblur":case"afterblur":f=n2;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=oD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=oG;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=vG;break;case uM:case hM:case dM:f=cG;break;case fM:f=kG;break;case"scroll":f=rG;break;case"wheel":f=TG;break;case"copy":case"cut":case"paste":f=hG;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=lD}var g=(e&4)!==0,m=!g&&t==="scroll",x=g?d!==null?d+"Capture":null:d;g=[];for(var y=c,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,x!==null&&(w=hp(y,x),w!=null&&g.push(yp(y,w,b)))),m)break;y=y.return}0<g.length&&(d=new f(d,p,null,n,u),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==CS&&(p=n.relatedTarget||n.fromElement)&&(Ol(p)||p[xo]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Ol(p):null,p!==null&&(m=Mc(p),p!==m||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(g=oD,w="onMouseLeave",x="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(g=lD,w="onPointerLeave",x="onPointerEnter",y="pointer"),m=f==null?d:bu(f),b=p==null?d:bu(p),d=new g(w,y+"leave",f,n,u),d.target=m,d.relatedTarget=b,w=null,Ol(u)===c&&(g=new g(x,y+"enter",p,n,u),g.target=b,g.relatedTarget=m,w=g),m=w,f&&p)t:{for(g=f,x=p,y=0,b=g;b;b=iu(b))y++;for(b=0,w=x;w;w=iu(w))b++;for(;0<y-b;)g=iu(g),y--;for(;0<b-y;)x=iu(x),b--;for(;y--;){if(g===x||x!==null&&g===x.alternate)break t;g=iu(g),x=iu(x)}g=null}else g=null;f!==null&&bD(h,d,f,g,!1),p!==null&&m!==null&&bD(h,m,p,g,!0)}}e:{if(d=c?bu(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var v=AG;else if(hD(d))if(iM)v=FG;else{v=OG;var S=RG}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(v=PG);if(v&&(v=v(t,c))){rM(h,v,n,u);break e}S&&S(t,d,c),t==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&bS(d,"number",d.value)}switch(S=c?bu(c):window,t){case"focusin":(hD(S)||S.contentEditable==="true")&&(xu=S,DS=c,Uf=null);break;case"focusout":Uf=DS=xu=null;break;case"mousedown":AS=!0;break;case"contextmenu":case"mouseup":case"dragend":AS=!1,gD(h,n,u);break;case"selectionchange":if(zG)break;case"keydown":case"keyup":gD(h,n,u)}var T;if(sT)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else gu?nM(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(tM&&n.locale!=="ko"&&(gu||k!=="onCompositionStart"?k==="onCompositionEnd"&&gu&&(T=eM()):(ta=u,eT="value"in ta?ta.value:ta.textContent,gu=!0)),S=ty(c,k),0<S.length&&(k=new aD(k,t,null,n,u),h.push({event:k,listeners:S}),T?k.data=T:(T=sM(n),T!==null&&(k.data=T)))),(T=NG?_G(t,n):$G(t,n))&&(c=ty(c,"onBeforeInput"),0<c.length&&(u=new aD("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=T))}mM(h,e)})}function yp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ty(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=hp(t,n),i!=null&&s.unshift(yp(t,i,r)),i=hp(t,e),i!=null&&s.push(yp(t,i,r))),t=t.return}return s}function iu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function bD(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=hp(n,i),l!=null&&o.unshift(yp(n,l,a))):r||(l=hp(n,i),l!=null&&o.push(yp(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var UG=/\r\n?/g,jG=/\u0000|\uFFFD/g;function wD(t){return(typeof t=="string"?t:""+t).replace(UG,`
`).replace(jG,"")}function T0(t,e,n){if(e=wD(e),wD(t)!==e&&n)throw Error(oe(425))}function ny(){}var RS=null,OS=null;function PS(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var FS=typeof setTimeout=="function"?setTimeout:void 0,HG=typeof clearTimeout=="function"?clearTimeout:void 0,vD=typeof Promise=="function"?Promise:void 0,GG=typeof queueMicrotask=="function"?queueMicrotask:typeof vD<"u"?function(t){return vD.resolve(null).then(t).catch(qG)}:FS;function qG(t){setTimeout(function(){throw t})}function u2(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),pp(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);pp(e)}function ga(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function SD(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Th=Math.random().toString(36).slice(2),vi="__reactFiber$"+Th,bp="__reactProps$"+Th,xo="__reactContainer$"+Th,MS="__reactEvents$"+Th,KG="__reactListeners$"+Th,XG="__reactHandles$"+Th;function Ol(t){var e=t[vi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[xo]||n[vi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=SD(t);t!==null;){if(n=t[vi])return n;t=SD(t)}return e}t=n,n=t.parentNode}return null}function dm(t){return t=t[vi]||t[xo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function bu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(oe(33))}function G1(t){return t[bp]||null}var LS=[],wu=-1;function Ka(t){return{current:t}}function bt(t){0>wu||(t.current=LS[wu],LS[wu]=null,wu--)}function ft(t,e){wu++,LS[wu]=t.current,t.current=e}var _a={},rs=Ka(_a),Ms=Ka(!1),Jl=_a;function Gu(t,e){var n=t.type.contextTypes;if(!n)return _a;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Ls(t){return t=t.childContextTypes,t!=null}function sy(){bt(Ms),bt(rs)}function kD(t,e,n){if(rs.current!==_a)throw Error(oe(168));ft(rs,e),ft(Ms,n)}function xM(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(oe(108,RH(t)||"Unknown",r));return Ft({},n,s)}function ry(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_a,Jl=rs.current,ft(rs,t),ft(Ms,Ms.current),!0}function CD(t,e,n){var s=t.stateNode;if(!s)throw Error(oe(169));n?(t=xM(t,e,Jl),s.__reactInternalMemoizedMergedChildContext=t,bt(Ms),bt(rs),ft(rs,t)):bt(Ms),ft(Ms,n)}var Xi=null,q1=!1,h2=!1;function yM(t){Xi===null?Xi=[t]:Xi.push(t)}function YG(t){q1=!0,yM(t)}function Xa(){if(!h2&&Xi!==null){h2=!0;var t=0,e=it;try{var n=Xi;for(it=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Xi=null,q1=!1}catch(r){throw Xi!==null&&(Xi=Xi.slice(t+1)),U3(YC,Xa),r}finally{it=e,h2=!1}}return null}var vu=[],Su=0,iy=null,oy=0,kr=[],Cr=0,ec=null,no=1,so="";function yl(t,e){vu[Su++]=oy,vu[Su++]=iy,iy=t,oy=e}function bM(t,e,n){kr[Cr++]=no,kr[Cr++]=so,kr[Cr++]=ec,ec=t;var s=no;t=so;var r=32-Yr(s)-1;s&=~(1<<r),n+=1;var i=32-Yr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,no=1<<32-Yr(e)+r|n<<r|s,so=i+t}else no=1<<i|n<<r|s,so=t}function iT(t){t.return!==null&&(yl(t,1),bM(t,1,0))}function oT(t){for(;t===iy;)iy=vu[--Su],vu[Su]=null,oy=vu[--Su],vu[Su]=null;for(;t===ec;)ec=kr[--Cr],kr[Cr]=null,so=kr[--Cr],kr[Cr]=null,no=kr[--Cr],kr[Cr]=null}var or=null,tr=null,Tt=!1,Gr=null;function wM(t,e){var n=Ir(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function TD(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,or=t,tr=ga(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,or=t,tr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ec!==null?{id:no,overflow:so}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ir(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,or=t,tr=null,!0):!1;default:return!1}}function zS(t){return(t.mode&1)!==0&&(t.flags&128)===0}function BS(t){if(Tt){var e=tr;if(e){var n=e;if(!TD(t,e)){if(zS(t))throw Error(oe(418));e=ga(n.nextSibling);var s=or;e&&TD(t,e)?wM(s,n):(t.flags=t.flags&-4097|2,Tt=!1,or=t)}}else{if(zS(t))throw Error(oe(418));t.flags=t.flags&-4097|2,Tt=!1,or=t}}}function ID(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;or=t}function I0(t){if(t!==or)return!1;if(!Tt)return ID(t),Tt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!PS(t.type,t.memoizedProps)),e&&(e=tr)){if(zS(t))throw vM(),Error(oe(418));for(;e;)wM(t,e),e=ga(e.nextSibling)}if(ID(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(oe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tr=ga(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tr=null}}else tr=or?ga(t.stateNode.nextSibling):null;return!0}function vM(){for(var t=tr;t;)t=ga(t.nextSibling)}function qu(){tr=or=null,Tt=!1}function aT(t){Gr===null?Gr=[t]:Gr.push(t)}var QG=Eo.ReactCurrentBatchConfig;function Jd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var s=n.stateNode}if(!s)throw Error(oe(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,t))}return t}function N0(t,e){throw t=Object.prototype.toString.call(e),Error(oe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ND(t){var e=t._init;return e(t._payload)}function SM(t){function e(x,y){if(t){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function n(x,y){if(!t)return null;for(;y!==null;)e(x,y),y=y.sibling;return null}function s(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function r(x,y){return x=wa(x,y),x.index=0,x.sibling=null,x}function i(x,y,b){return x.index=b,t?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,y,b,w){return y===null||y.tag!==6?(y=y2(b,x.mode,w),y.return=x,y):(y=r(y,b),y.return=x,y)}function l(x,y,b,w){var v=b.type;return v===mu?u(x,y,b.props.children,w,b.key):y!==null&&(y.elementType===v||typeof v=="object"&&v!==null&&v.$$typeof===Yo&&ND(v)===y.type)?(w=r(y,b.props),w.ref=Jd(x,y,b),w.return=x,w):(w=Tx(b.type,b.key,b.props,null,x.mode,w),w.ref=Jd(x,y,b),w.return=x,w)}function c(x,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=b2(b,x.mode,w),y.return=x,y):(y=r(y,b.children||[]),y.return=x,y)}function u(x,y,b,w,v){return y===null||y.tag!==7?(y=Ul(b,x.mode,w,v),y.return=x,y):(y=r(y,b),y.return=x,y)}function h(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=y2(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case g0:return b=Tx(y.type,y.key,y.props,null,x.mode,b),b.ref=Jd(x,null,y),b.return=x,b;case pu:return y=b2(y,x.mode,b),y.return=x,y;case Yo:var w=y._init;return h(x,w(y._payload),b)}if(bf(y)||Kd(y))return y=Ul(y,x.mode,b,null),y.return=x,y;N0(x,y)}return null}function d(x,y,b,w){var v=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return v!==null?null:a(x,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case g0:return b.key===v?l(x,y,b,w):null;case pu:return b.key===v?c(x,y,b,w):null;case Yo:return v=b._init,d(x,y,v(b._payload),w)}if(bf(b)||Kd(b))return v!==null?null:u(x,y,b,w,null);N0(x,b)}return null}function f(x,y,b,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(b)||null,a(y,x,""+w,v);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case g0:return x=x.get(w.key===null?b:w.key)||null,l(y,x,w,v);case pu:return x=x.get(w.key===null?b:w.key)||null,c(y,x,w,v);case Yo:var S=w._init;return f(x,y,b,S(w._payload),v)}if(bf(w)||Kd(w))return x=x.get(b)||null,u(y,x,w,v,null);N0(y,w)}return null}function p(x,y,b,w){for(var v=null,S=null,T=y,k=y=0,I=null;T!==null&&k<b.length;k++){T.index>k?(I=T,T=null):I=T.sibling;var _=d(x,T,b[k],w);if(_===null){T===null&&(T=I);break}t&&T&&_.alternate===null&&e(x,T),y=i(_,y,k),S===null?v=_:S.sibling=_,S=_,T=I}if(k===b.length)return n(x,T),Tt&&yl(x,k),v;if(T===null){for(;k<b.length;k++)T=h(x,b[k],w),T!==null&&(y=i(T,y,k),S===null?v=T:S.sibling=T,S=T);return Tt&&yl(x,k),v}for(T=s(x,T);k<b.length;k++)I=f(T,x,k,b[k],w),I!==null&&(t&&I.alternate!==null&&T.delete(I.key===null?k:I.key),y=i(I,y,k),S===null?v=I:S.sibling=I,S=I);return t&&T.forEach(function(D){return e(x,D)}),Tt&&yl(x,k),v}function g(x,y,b,w){var v=Kd(b);if(typeof v!="function")throw Error(oe(150));if(b=v.call(b),b==null)throw Error(oe(151));for(var S=v=null,T=y,k=y=0,I=null,_=b.next();T!==null&&!_.done;k++,_=b.next()){T.index>k?(I=T,T=null):I=T.sibling;var D=d(x,T,_.value,w);if(D===null){T===null&&(T=I);break}t&&T&&D.alternate===null&&e(x,T),y=i(D,y,k),S===null?v=D:S.sibling=D,S=D,T=I}if(_.done)return n(x,T),Tt&&yl(x,k),v;if(T===null){for(;!_.done;k++,_=b.next())_=h(x,_.value,w),_!==null&&(y=i(_,y,k),S===null?v=_:S.sibling=_,S=_);return Tt&&yl(x,k),v}for(T=s(x,T);!_.done;k++,_=b.next())_=f(T,x,k,_.value,w),_!==null&&(t&&_.alternate!==null&&T.delete(_.key===null?k:_.key),y=i(_,y,k),S===null?v=_:S.sibling=_,S=_);return t&&T.forEach(function(A){return e(x,A)}),Tt&&yl(x,k),v}function m(x,y,b,w){if(typeof b=="object"&&b!==null&&b.type===mu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case g0:e:{for(var v=b.key,S=y;S!==null;){if(S.key===v){if(v=b.type,v===mu){if(S.tag===7){n(x,S.sibling),y=r(S,b.props.children),y.return=x,x=y;break e}}else if(S.elementType===v||typeof v=="object"&&v!==null&&v.$$typeof===Yo&&ND(v)===S.type){n(x,S.sibling),y=r(S,b.props),y.ref=Jd(x,S,b),y.return=x,x=y;break e}n(x,S);break}else e(x,S);S=S.sibling}b.type===mu?(y=Ul(b.props.children,x.mode,w,b.key),y.return=x,x=y):(w=Tx(b.type,b.key,b.props,null,x.mode,w),w.ref=Jd(x,y,b),w.return=x,x=w)}return o(x);case pu:e:{for(S=b.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(x,y.sibling),y=r(y,b.children||[]),y.return=x,x=y;break e}else{n(x,y);break}else e(x,y);y=y.sibling}y=b2(b,x.mode,w),y.return=x,x=y}return o(x);case Yo:return S=b._init,m(x,y,S(b._payload),w)}if(bf(b))return p(x,y,b,w);if(Kd(b))return g(x,y,b,w);N0(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(x,y.sibling),y=r(y,b),y.return=x,x=y):(n(x,y),y=y2(b,x.mode,w),y.return=x,x=y),o(x)):n(x,y)}return m}var Ku=SM(!0),kM=SM(!1),ay=Ka(null),ly=null,ku=null,lT=null;function cT(){lT=ku=ly=null}function uT(t){var e=ay.current;bt(ay),t._currentValue=e}function VS(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Lu(t,e){ly=t,lT=ku=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ps=!0),t.firstContext=null)}function Rr(t){var e=t._currentValue;if(lT!==t)if(t={context:t,memoizedValue:e,next:null},ku===null){if(ly===null)throw Error(oe(308));ku=t,ly.dependencies={lanes:0,firstContext:t}}else ku=ku.next=t;return e}var Pl=null;function hT(t){Pl===null?Pl=[t]:Pl.push(t)}function CM(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,hT(e)):(n.next=r.next,r.next=n),e.interleaved=n,yo(t,s)}function yo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Qo=!1;function dT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TM(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function lo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function xa(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,qe&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,yo(t,n)}return r=s.interleaved,r===null?(e.next=e,hT(s)):(e.next=r.next,r.next=e),s.interleaved=e,yo(t,n)}function bx(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,QC(t,n)}}function _D(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function cy(t,e,n,s){var r=t.updateQueue;Qo=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;o=0,u=c=l=null,a=i;do{var d=a.lane,f=a.eventTime;if((s&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(d=e,f=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=Ft({},h,d);break e;case 2:Qo=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(u===null&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);nc|=o,t.lanes=o,t.memoizedState=h}}function $D(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(oe(191,r));r.call(s)}}}var fm={},Ni=Ka(fm),wp=Ka(fm),vp=Ka(fm);function Fl(t){if(t===fm)throw Error(oe(174));return t}function fT(t,e){switch(ft(vp,e),ft(wp,t),ft(Ni,fm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:vS(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=vS(e,t)}bt(Ni),ft(Ni,e)}function Xu(){bt(Ni),bt(wp),bt(vp)}function IM(t){Fl(vp.current);var e=Fl(Ni.current),n=vS(e,t.type);e!==n&&(ft(wp,t),ft(Ni,n))}function pT(t){wp.current===t&&(bt(Ni),bt(wp))}var Dt=Ka(0);function uy(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var d2=[];function mT(){for(var t=0;t<d2.length;t++)d2[t]._workInProgressVersionPrimary=null;d2.length=0}var wx=Eo.ReactCurrentDispatcher,f2=Eo.ReactCurrentBatchConfig,tc=0,Pt=null,pn=null,Nn=null,hy=!1,jf=!1,Sp=0,ZG=0;function Gn(){throw Error(oe(321))}function gT(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!si(t[n],e[n]))return!1;return!0}function xT(t,e,n,s,r,i){if(tc=i,Pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wx.current=t===null||t.memoizedState===null?n9:s9,t=n(s,r),jf){i=0;do{if(jf=!1,Sp=0,25<=i)throw Error(oe(301));i+=1,Nn=pn=null,e.updateQueue=null,wx.current=r9,t=n(s,r)}while(jf)}if(wx.current=dy,e=pn!==null&&pn.next!==null,tc=0,Nn=pn=Pt=null,hy=!1,e)throw Error(oe(300));return t}function yT(){var t=Sp!==0;return Sp=0,t}function gi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?Pt.memoizedState=Nn=t:Nn=Nn.next=t,Nn}function Or(){if(pn===null){var t=Pt.alternate;t=t!==null?t.memoizedState:null}else t=pn.next;var e=Nn===null?Pt.memoizedState:Nn.next;if(e!==null)Nn=e,pn=t;else{if(t===null)throw Error(oe(310));pn=t,t={memoizedState:pn.memoizedState,baseState:pn.baseState,baseQueue:pn.baseQueue,queue:pn.queue,next:null},Nn===null?Pt.memoizedState=Nn=t:Nn=Nn.next=t}return Nn}function kp(t,e){return typeof e=="function"?e(t):e}function p2(t){var e=Or(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var s=pn,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((tc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=s):l=l.next=h,Pt.lanes|=u,nc|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,si(s,e.memoizedState)||(Ps=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Pt.lanes|=i,nc|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function m2(t){var e=Or(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);si(i,e.memoizedState)||(Ps=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function NM(){}function _M(t,e){var n=Pt,s=Or(),r=e(),i=!si(s.memoizedState,r);if(i&&(s.memoizedState=r,Ps=!0),s=s.queue,bT(DM.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Nn!==null&&Nn.memoizedState.tag&1){if(n.flags|=2048,Cp(9,EM.bind(null,n,s,r,e),void 0,null),Rn===null)throw Error(oe(349));tc&30||$M(n,e,r)}return r}function $M(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Pt.updateQueue,e===null?(e={lastEffect:null,stores:null},Pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function EM(t,e,n,s){e.value=n,e.getSnapshot=s,AM(e)&&RM(t)}function DM(t,e,n){return n(function(){AM(e)&&RM(t)})}function AM(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!si(t,n)}catch{return!0}}function RM(t){var e=yo(t,1);e!==null&&Qr(e,t,1,-1)}function ED(t){var e=gi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kp,lastRenderedState:t},e.queue=t,t=t.dispatch=t9.bind(null,Pt,t),[e.memoizedState,t]}function Cp(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Pt.updateQueue,e===null?(e={lastEffect:null,stores:null},Pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function OM(){return Or().memoizedState}function vx(t,e,n,s){var r=gi();Pt.flags|=t,r.memoizedState=Cp(1|e,n,void 0,s===void 0?null:s)}function K1(t,e,n,s){var r=Or();s=s===void 0?null:s;var i=void 0;if(pn!==null){var o=pn.memoizedState;if(i=o.destroy,s!==null&&gT(s,o.deps)){r.memoizedState=Cp(e,n,i,s);return}}Pt.flags|=t,r.memoizedState=Cp(1|e,n,i,s)}function DD(t,e){return vx(8390656,8,t,e)}function bT(t,e){return K1(2048,8,t,e)}function PM(t,e){return K1(4,2,t,e)}function FM(t,e){return K1(4,4,t,e)}function MM(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function LM(t,e,n){return n=n!=null?n.concat([t]):null,K1(4,4,MM.bind(null,e,t),n)}function wT(){}function zM(t,e){var n=Or();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&gT(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function BM(t,e){var n=Or();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&gT(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function VM(t,e,n){return tc&21?(si(n,e)||(n=G3(),Pt.lanes|=n,nc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ps=!0),t.memoizedState=n)}function JG(t,e){var n=it;it=n!==0&&4>n?n:4,t(!0);var s=f2.transition;f2.transition={};try{t(!1),e()}finally{it=n,f2.transition=s}}function WM(){return Or().memoizedState}function e9(t,e,n){var s=ba(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},UM(t))jM(e,n);else if(n=CM(t,e,n,s),n!==null){var r=ms();Qr(n,t,s,r),HM(n,e,s)}}function t9(t,e,n){var s=ba(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(UM(t))jM(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,si(a,o)){var l=e.interleaved;l===null?(r.next=r,hT(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=CM(t,e,r,s),n!==null&&(r=ms(),Qr(n,t,s,r),HM(n,e,s))}}function UM(t){var e=t.alternate;return t===Pt||e!==null&&e===Pt}function jM(t,e){jf=hy=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function HM(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,QC(t,n)}}var dy={readContext:Rr,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},n9={readContext:Rr,useCallback:function(t,e){return gi().memoizedState=[t,e===void 0?null:e],t},useContext:Rr,useEffect:DD,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,vx(4194308,4,MM.bind(null,e,t),n)},useLayoutEffect:function(t,e){return vx(4194308,4,t,e)},useInsertionEffect:function(t,e){return vx(4,2,t,e)},useMemo:function(t,e){var n=gi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=gi();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=e9.bind(null,Pt,t),[s.memoizedState,t]},useRef:function(t){var e=gi();return t={current:t},e.memoizedState=t},useState:ED,useDebugValue:wT,useDeferredValue:function(t){return gi().memoizedState=t},useTransition:function(){var t=ED(!1),e=t[0];return t=JG.bind(null,t[1]),gi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Pt,r=gi();if(Tt){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=e(),Rn===null)throw Error(oe(349));tc&30||$M(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,DD(DM.bind(null,s,i,t),[t]),s.flags|=2048,Cp(9,EM.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=gi(),e=Rn.identifierPrefix;if(Tt){var n=so,s=no;n=(s&~(1<<32-Yr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Sp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=ZG++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},s9={readContext:Rr,useCallback:zM,useContext:Rr,useEffect:bT,useImperativeHandle:LM,useInsertionEffect:PM,useLayoutEffect:FM,useMemo:BM,useReducer:p2,useRef:OM,useState:function(){return p2(kp)},useDebugValue:wT,useDeferredValue:function(t){var e=Or();return VM(e,pn.memoizedState,t)},useTransition:function(){var t=p2(kp)[0],e=Or().memoizedState;return[t,e]},useMutableSource:NM,useSyncExternalStore:_M,useId:WM,unstable_isNewReconciler:!1},r9={readContext:Rr,useCallback:zM,useContext:Rr,useEffect:bT,useImperativeHandle:LM,useInsertionEffect:PM,useLayoutEffect:FM,useMemo:BM,useReducer:m2,useRef:OM,useState:function(){return m2(kp)},useDebugValue:wT,useDeferredValue:function(t){var e=Or();return pn===null?e.memoizedState=t:VM(e,pn.memoizedState,t)},useTransition:function(){var t=m2(kp)[0],e=Or().memoizedState;return[t,e]},useMutableSource:NM,useSyncExternalStore:_M,useId:WM,unstable_isNewReconciler:!1};function Ur(t,e){if(t&&t.defaultProps){e=Ft({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function WS(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Ft({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var X1={isMounted:function(t){return(t=t._reactInternals)?Mc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=ms(),r=ba(t),i=lo(s,r);i.payload=e,n!=null&&(i.callback=n),e=xa(t,i,r),e!==null&&(Qr(e,t,r,s),bx(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=ms(),r=ba(t),i=lo(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=xa(t,i,r),e!==null&&(Qr(e,t,r,s),bx(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ms(),s=ba(t),r=lo(n,s);r.tag=2,e!=null&&(r.callback=e),e=xa(t,r,s),e!==null&&(Qr(e,t,s,n),bx(e,t,s))}};function AD(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!gp(n,s)||!gp(r,i):!0}function GM(t,e,n){var s=!1,r=_a,i=e.contextType;return typeof i=="object"&&i!==null?i=Rr(i):(r=Ls(e)?Jl:rs.current,s=e.contextTypes,i=(s=s!=null)?Gu(t,r):_a),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=X1,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function RD(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&X1.enqueueReplaceState(e,e.state,null)}function US(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},dT(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Rr(i):(i=Ls(e)?Jl:rs.current,r.context=Gu(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(WS(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&X1.enqueueReplaceState(r,r.state,null),cy(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Yu(t,e){try{var n="",s=e;do n+=AH(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function g2(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function jS(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var i9=typeof WeakMap=="function"?WeakMap:Map;function qM(t,e,n){n=lo(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){py||(py=!0,ek=s),jS(t,e)},n}function KM(t,e,n){n=lo(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){jS(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){jS(t,e),typeof s!="function"&&(ya===null?ya=new Set([this]):ya.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function OD(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new i9;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=b9.bind(null,t,e,n),e.then(t,t))}function PD(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function FD(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=lo(-1,1),e.tag=2,xa(n,e,1))),n.lanes|=1),t)}var o9=Eo.ReactCurrentOwner,Ps=!1;function hs(t,e,n,s){e.child=t===null?kM(e,null,n,s):Ku(e,t.child,n,s)}function MD(t,e,n,s,r){n=n.render;var i=e.ref;return Lu(e,r),s=xT(t,e,n,s,i,r),n=yT(),t!==null&&!Ps?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,bo(t,e,r)):(Tt&&n&&iT(e),e.flags|=1,hs(t,e,s,r),e.child)}function LD(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!_T(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,XM(t,e,i,s,r)):(t=Tx(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:gp,n(o,s)&&t.ref===e.ref)return bo(t,e,r)}return e.flags|=1,t=wa(i,s),t.ref=e.ref,t.return=e,e.child=t}function XM(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(gp(i,s)&&t.ref===e.ref)if(Ps=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Ps=!0);else return e.lanes=t.lanes,bo(t,e,r)}return HS(t,e,n,s,r)}function YM(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ft(Tu,Ys),Ys|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ft(Tu,Ys),Ys|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,ft(Tu,Ys),Ys|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,ft(Tu,Ys),Ys|=s;return hs(t,e,r,n),e.child}function QM(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function HS(t,e,n,s,r){var i=Ls(n)?Jl:rs.current;return i=Gu(e,i),Lu(e,r),n=xT(t,e,n,s,i,r),s=yT(),t!==null&&!Ps?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,bo(t,e,r)):(Tt&&s&&iT(e),e.flags|=1,hs(t,e,n,r),e.child)}function zD(t,e,n,s,r){if(Ls(n)){var i=!0;ry(e)}else i=!1;if(Lu(e,r),e.stateNode===null)Sx(t,e),GM(e,n,s),US(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Rr(c):(c=Ls(n)?Jl:rs.current,c=Gu(e,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&RD(e,o,s,c),Qo=!1;var d=e.memoizedState;o.state=d,cy(e,s,o,r),l=e.memoizedState,a!==s||d!==l||Ms.current||Qo?(typeof u=="function"&&(WS(e,n,u,s),l=e.memoizedState),(a=Qo||AD(e,n,a,s,d,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,TM(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ur(e.type,a),o.props=c,h=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Rr(l):(l=Ls(n)?Jl:rs.current,l=Gu(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&RD(e,o,s,l),Qo=!1,d=e.memoizedState,o.state=d,cy(e,s,o,r);var p=e.memoizedState;a!==h||d!==p||Ms.current||Qo?(typeof f=="function"&&(WS(e,n,f,s),p=e.memoizedState),(c=Qo||AD(e,n,c,s,d,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),o.props=s,o.state=p,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),s=!1)}return GS(t,e,n,s,i,r)}function GS(t,e,n,s,r,i){QM(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&CD(e,n,!1),bo(t,e,i);s=e.stateNode,o9.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=Ku(e,t.child,null,i),e.child=Ku(e,null,a,i)):hs(t,e,a,i),e.memoizedState=s.state,r&&CD(e,n,!0),e.child}function ZM(t){var e=t.stateNode;e.pendingContext?kD(t,e.pendingContext,e.pendingContext!==e.context):e.context&&kD(t,e.context,!1),fT(t,e.containerInfo)}function BD(t,e,n,s,r){return qu(),aT(r),e.flags|=256,hs(t,e,n,s),e.child}var qS={dehydrated:null,treeContext:null,retryLane:0};function KS(t){return{baseLanes:t,cachePool:null,transitions:null}}function JM(t,e,n){var s=e.pendingProps,r=Dt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),ft(Dt,r&1),t===null)return BS(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Z1(o,s,0,null),t=Ul(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=KS(n),e.memoizedState=qS,t):vT(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return a9(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=wa(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=wa(a,i):(i=Ul(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?KS(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=qS,s}return i=t.child,t=i.sibling,s=wa(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function vT(t,e){return e=Z1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _0(t,e,n,s){return s!==null&&aT(s),Ku(e,t.child,null,n),t=vT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function a9(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=g2(Error(oe(422))),_0(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Z1({mode:"visible",children:s.children},r,0,null),i=Ul(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Ku(e,t.child,null,o),e.child.memoizedState=KS(o),e.memoizedState=qS,i);if(!(e.mode&1))return _0(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(oe(419)),s=g2(i,s,void 0),_0(t,e,o,s)}if(a=(o&t.childLanes)!==0,Ps||a){if(s=Rn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,yo(t,r),Qr(s,t,r,-1))}return NT(),s=g2(Error(oe(421))),_0(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=w9.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,tr=ga(r.nextSibling),or=e,Tt=!0,Gr=null,t!==null&&(kr[Cr++]=no,kr[Cr++]=so,kr[Cr++]=ec,no=t.id,so=t.overflow,ec=e),e=vT(e,s.children),e.flags|=4096,e)}function VD(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),VS(t.return,e,n)}function x2(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function eL(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(hs(t,e,s.children,n),s=Dt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&VD(t,n,e);else if(t.tag===19)VD(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(ft(Dt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&uy(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),x2(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&uy(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}x2(e,!0,n,null,i);break;case"together":x2(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),nc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(oe(153));if(e.child!==null){for(t=e.child,n=wa(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=wa(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function l9(t,e,n){switch(e.tag){case 3:ZM(e),qu();break;case 5:IM(e);break;case 1:Ls(e.type)&&ry(e);break;case 4:fT(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;ft(ay,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(ft(Dt,Dt.current&1),e.flags|=128,null):n&e.child.childLanes?JM(t,e,n):(ft(Dt,Dt.current&1),t=bo(t,e,n),t!==null?t.sibling:null);ft(Dt,Dt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return eL(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ft(Dt,Dt.current),s)break;return null;case 22:case 23:return e.lanes=0,YM(t,e,n)}return bo(t,e,n)}var tL,XS,nL,sL;tL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};XS=function(){};nL=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Fl(Ni.current);var i=null;switch(n){case"input":r=xS(t,r),s=xS(t,s),i=[];break;case"select":r=Ft({},r,{value:void 0}),s=Ft({},s,{value:void 0}),i=[];break;case"textarea":r=wS(t,r),s=wS(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=ny)}SS(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(cp.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(cp.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&yt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};sL=function(t,e,n,s){n!==s&&(e.flags|=4)};function ef(t,e){if(!Tt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function qn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function c9(t,e,n){var s=e.pendingProps;switch(oT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qn(e),null;case 1:return Ls(e.type)&&sy(),qn(e),null;case 3:return s=e.stateNode,Xu(),bt(Ms),bt(rs),mT(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(I0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gr!==null&&(sk(Gr),Gr=null))),XS(t,e),qn(e),null;case 5:pT(e);var r=Fl(vp.current);if(n=e.type,t!==null&&e.stateNode!=null)nL(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(oe(166));return qn(e),null}if(t=Fl(Ni.current),I0(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[vi]=e,s[bp]=i,t=(e.mode&1)!==0,n){case"dialog":yt("cancel",s),yt("close",s);break;case"iframe":case"object":case"embed":yt("load",s);break;case"video":case"audio":for(r=0;r<vf.length;r++)yt(vf[r],s);break;case"source":yt("error",s);break;case"img":case"image":case"link":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"input":YE(s,i),yt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},yt("invalid",s);break;case"textarea":ZE(s,i),yt("invalid",s)}SS(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&T0(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&T0(s.textContent,a,t),r=["children",""+a]):cp.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&yt("scroll",s)}switch(n){case"input":x0(s),QE(s,i,!0);break;case"textarea":x0(s),JE(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=ny)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=D3(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[vi]=e,t[bp]=s,tL(t,e,!1,!1),e.stateNode=t;e:{switch(o=kS(n,s),n){case"dialog":yt("cancel",t),yt("close",t),r=s;break;case"iframe":case"object":case"embed":yt("load",t),r=s;break;case"video":case"audio":for(r=0;r<vf.length;r++)yt(vf[r],t);r=s;break;case"source":yt("error",t),r=s;break;case"img":case"image":case"link":yt("error",t),yt("load",t),r=s;break;case"details":yt("toggle",t),r=s;break;case"input":YE(t,s),r=xS(t,s),yt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Ft({},s,{value:void 0}),yt("invalid",t);break;case"textarea":ZE(t,s),r=wS(t,s),yt("invalid",t);break;default:r=s}SS(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?O3(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&A3(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&up(t,l):typeof l=="number"&&up(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(cp.hasOwnProperty(i)?l!=null&&i==="onScroll"&&yt("scroll",t):l!=null&&HC(t,i,l,o))}switch(n){case"input":x0(t),QE(t,s,!1);break;case"textarea":x0(t),JE(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Na(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Ou(t,!!s.multiple,i,!1):s.defaultValue!=null&&Ou(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=ny)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qn(e),null;case 6:if(t&&e.stateNode!=null)sL(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(oe(166));if(n=Fl(vp.current),Fl(Ni.current),I0(e)){if(s=e.stateNode,n=e.memoizedProps,s[vi]=e,(i=s.nodeValue!==n)&&(t=or,t!==null))switch(t.tag){case 3:T0(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&T0(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[vi]=e,e.stateNode=s}return qn(e),null;case 13:if(bt(Dt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Tt&&tr!==null&&e.mode&1&&!(e.flags&128))vM(),qu(),e.flags|=98560,i=!1;else if(i=I0(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(oe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[vi]=e}else qu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;qn(e),i=!1}else Gr!==null&&(sk(Gr),Gr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Dt.current&1?gn===0&&(gn=3):NT())),e.updateQueue!==null&&(e.flags|=4),qn(e),null);case 4:return Xu(),XS(t,e),t===null&&xp(e.stateNode.containerInfo),qn(e),null;case 10:return uT(e.type._context),qn(e),null;case 17:return Ls(e.type)&&sy(),qn(e),null;case 19:if(bt(Dt),i=e.memoizedState,i===null)return qn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)ef(i,!1);else{if(gn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=uy(t),o!==null){for(e.flags|=128,ef(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ft(Dt,Dt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Yt()>Qu&&(e.flags|=128,s=!0,ef(i,!1),e.lanes=4194304)}else{if(!s)if(t=uy(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ef(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Tt)return qn(e),null}else 2*Yt()-i.renderingStartTime>Qu&&n!==1073741824&&(e.flags|=128,s=!0,ef(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Yt(),e.sibling=null,n=Dt.current,ft(Dt,s?n&1|2:n&1),e):(qn(e),null);case 22:case 23:return IT(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Ys&1073741824&&(qn(e),e.subtreeFlags&6&&(e.flags|=8192)):qn(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function u9(t,e){switch(oT(e),e.tag){case 1:return Ls(e.type)&&sy(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Xu(),bt(Ms),bt(rs),mT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return pT(e),null;case 13:if(bt(Dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));qu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return bt(Dt),null;case 4:return Xu(),null;case 10:return uT(e.type._context),null;case 22:case 23:return IT(),null;case 24:return null;default:return null}}var $0=!1,Qn=!1,h9=typeof WeakSet=="function"?WeakSet:Set,pe=null;function Cu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Mt(t,e,s)}else n.current=null}function YS(t,e,n){try{n()}catch(s){Mt(t,e,s)}}var WD=!1;function d9(t,e){if(RS=Jx,t=lM(),rT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var f;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(l=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++c===r&&(a=o),d===i&&++u===s&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(OS={focusedElem:t,selectionRange:n},Jx=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,m=p.memoizedState,x=e.stateNode,y=x.getSnapshotBeforeUpdate(e.elementType===e.type?g:Ur(e.type,g),m);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(w){Mt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return p=WD,WD=!1,p}function Hf(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&YS(e,n,i)}r=r.next}while(r!==s)}}function Y1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function QS(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rL(t){var e=t.alternate;e!==null&&(t.alternate=null,rL(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[vi],delete e[bp],delete e[MS],delete e[KG],delete e[XG])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function iL(t){return t.tag===5||t.tag===3||t.tag===4}function UD(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||iL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ZS(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ny));else if(s!==4&&(t=t.child,t!==null))for(ZS(t,e,n),t=t.sibling;t!==null;)ZS(t,e,n),t=t.sibling}function JS(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(JS(t,e,n),t=t.sibling;t!==null;)JS(t,e,n),t=t.sibling}var Bn=null,Hr=!1;function Ho(t,e,n){for(n=n.child;n!==null;)oL(t,e,n),n=n.sibling}function oL(t,e,n){if(Ii&&typeof Ii.onCommitFiberUnmount=="function")try{Ii.onCommitFiberUnmount(W1,n)}catch{}switch(n.tag){case 5:Qn||Cu(n,e);case 6:var s=Bn,r=Hr;Bn=null,Ho(t,e,n),Bn=s,Hr=r,Bn!==null&&(Hr?(t=Bn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bn.removeChild(n.stateNode));break;case 18:Bn!==null&&(Hr?(t=Bn,n=n.stateNode,t.nodeType===8?u2(t.parentNode,n):t.nodeType===1&&u2(t,n),pp(t)):u2(Bn,n.stateNode));break;case 4:s=Bn,r=Hr,Bn=n.stateNode.containerInfo,Hr=!0,Ho(t,e,n),Bn=s,Hr=r;break;case 0:case 11:case 14:case 15:if(!Qn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&YS(n,e,o),r=r.next}while(r!==s)}Ho(t,e,n);break;case 1:if(!Qn&&(Cu(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Mt(n,e,a)}Ho(t,e,n);break;case 21:Ho(t,e,n);break;case 22:n.mode&1?(Qn=(s=Qn)||n.memoizedState!==null,Ho(t,e,n),Qn=s):Ho(t,e,n);break;default:Ho(t,e,n)}}function jD(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new h9),e.forEach(function(s){var r=v9.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Br(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Bn=a.stateNode,Hr=!1;break e;case 3:Bn=a.stateNode.containerInfo,Hr=!0;break e;case 4:Bn=a.stateNode.containerInfo,Hr=!0;break e}a=a.return}if(Bn===null)throw Error(oe(160));oL(i,o,r),Bn=null,Hr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Mt(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)aL(e,t),e=e.sibling}function aL(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Br(e,t),pi(t),s&4){try{Hf(3,t,t.return),Y1(3,t)}catch(g){Mt(t,t.return,g)}try{Hf(5,t,t.return)}catch(g){Mt(t,t.return,g)}}break;case 1:Br(e,t),pi(t),s&512&&n!==null&&Cu(n,n.return);break;case 5:if(Br(e,t),pi(t),s&512&&n!==null&&Cu(n,n.return),t.flags&32){var r=t.stateNode;try{up(r,"")}catch(g){Mt(t,t.return,g)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&$3(r,i),kS(a,o);var c=kS(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?O3(r,h):u==="dangerouslySetInnerHTML"?A3(r,h):u==="children"?up(r,h):HC(r,u,h,c)}switch(a){case"input":yS(r,i);break;case"textarea":E3(r,i);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Ou(r,!!i.multiple,f,!1):d!==!!i.multiple&&(i.defaultValue!=null?Ou(r,!!i.multiple,i.defaultValue,!0):Ou(r,!!i.multiple,i.multiple?[]:"",!1))}r[bp]=i}catch(g){Mt(t,t.return,g)}}break;case 6:if(Br(e,t),pi(t),s&4){if(t.stateNode===null)throw Error(oe(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(g){Mt(t,t.return,g)}}break;case 3:if(Br(e,t),pi(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{pp(e.containerInfo)}catch(g){Mt(t,t.return,g)}break;case 4:Br(e,t),pi(t);break;case 13:Br(e,t),pi(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(CT=Yt())),s&4&&jD(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Qn=(c=Qn)||u,Br(e,t),Qn=c):Br(e,t),pi(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(pe=t,u=t.child;u!==null;){for(h=pe=u;pe!==null;){switch(d=pe,f=d.child,d.tag){case 0:case 11:case 14:case 15:Hf(4,d,d.return);break;case 1:Cu(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){s=d,n=d.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Mt(s,n,g)}}break;case 5:Cu(d,d.return);break;case 22:if(d.memoizedState!==null){GD(h);continue}}f!==null?(f.return=d,pe=f):GD(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=R3("display",o))}catch(g){Mt(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Mt(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Br(e,t),pi(t),s&4&&jD(t);break;case 21:break;default:Br(e,t),pi(t)}}function pi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(iL(n)){var s=n;break e}n=n.return}throw Error(oe(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(up(r,""),s.flags&=-33);var i=UD(t);JS(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=UD(t);ZS(t,a,o);break;default:throw Error(oe(161))}}catch(l){Mt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function f9(t,e,n){pe=t,lL(t)}function lL(t,e,n){for(var s=(t.mode&1)!==0;pe!==null;){var r=pe,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||$0;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Qn;a=$0;var c=Qn;if($0=o,(Qn=l)&&!c)for(pe=r;pe!==null;)o=pe,l=o.child,o.tag===22&&o.memoizedState!==null?qD(r):l!==null?(l.return=o,pe=l):qD(r);for(;i!==null;)pe=i,lL(i),i=i.sibling;pe=r,$0=a,Qn=c}HD(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,pe=i):HD(t)}}function HD(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qn||Y1(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Qn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Ur(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&$D(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$D(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&pp(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}Qn||e.flags&512&&QS(e)}catch(d){Mt(e,e.return,d)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function GD(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function qD(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Y1(4,e)}catch(l){Mt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Mt(e,r,l)}}var i=e.return;try{QS(e)}catch(l){Mt(e,i,l)}break;case 5:var o=e.return;try{QS(e)}catch(l){Mt(e,o,l)}}}catch(l){Mt(e,e.return,l)}if(e===t){pe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,pe=a;break}pe=e.return}}var p9=Math.ceil,fy=Eo.ReactCurrentDispatcher,ST=Eo.ReactCurrentOwner,Ar=Eo.ReactCurrentBatchConfig,qe=0,Rn=null,an=null,Wn=0,Ys=0,Tu=Ka(0),gn=0,Tp=null,nc=0,Q1=0,kT=0,Gf=null,As=null,CT=0,Qu=1/0,Ki=null,py=!1,ek=null,ya=null,E0=!1,na=null,my=0,qf=0,tk=null,kx=-1,Cx=0;function ms(){return qe&6?Yt():kx!==-1?kx:kx=Yt()}function ba(t){return t.mode&1?qe&2&&Wn!==0?Wn&-Wn:QG.transition!==null?(Cx===0&&(Cx=G3()),Cx):(t=it,t!==0||(t=window.event,t=t===void 0?16:J3(t.type)),t):1}function Qr(t,e,n,s){if(50<qf)throw qf=0,tk=null,Error(oe(185));um(t,n,s),(!(qe&2)||t!==Rn)&&(t===Rn&&(!(qe&2)&&(Q1|=n),gn===4&&ea(t,Wn)),zs(t,s),n===1&&qe===0&&!(e.mode&1)&&(Qu=Yt()+500,q1&&Xa()))}function zs(t,e){var n=t.callbackNode;QH(t,e);var s=Zx(t,t===Rn?Wn:0);if(s===0)n!==null&&nD(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&nD(n),e===1)t.tag===0?YG(KD.bind(null,t)):yM(KD.bind(null,t)),GG(function(){!(qe&6)&&Xa()}),n=null;else{switch(q3(s)){case 1:n=YC;break;case 4:n=j3;break;case 16:n=Qx;break;case 536870912:n=H3;break;default:n=Qx}n=gL(n,cL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function cL(t,e){if(kx=-1,Cx=0,qe&6)throw Error(oe(327));var n=t.callbackNode;if(zu()&&t.callbackNode!==n)return null;var s=Zx(t,t===Rn?Wn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=gy(t,s);else{e=s;var r=qe;qe|=2;var i=hL();(Rn!==t||Wn!==e)&&(Ki=null,Qu=Yt()+500,Wl(t,e));do try{x9();break}catch(a){uL(t,a)}while(!0);cT(),fy.current=i,qe=r,an!==null?e=0:(Rn=null,Wn=0,e=gn)}if(e!==0){if(e===2&&(r=_S(t),r!==0&&(s=r,e=nk(t,r))),e===1)throw n=Tp,Wl(t,0),ea(t,s),zs(t,Yt()),n;if(e===6)ea(t,s);else{if(r=t.current.alternate,!(s&30)&&!m9(r)&&(e=gy(t,s),e===2&&(i=_S(t),i!==0&&(s=i,e=nk(t,i))),e===1))throw n=Tp,Wl(t,0),ea(t,s),zs(t,Yt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(oe(345));case 2:bl(t,As,Ki);break;case 3:if(ea(t,s),(s&130023424)===s&&(e=CT+500-Yt(),10<e)){if(Zx(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){ms(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=FS(bl.bind(null,t,As,Ki),e);break}bl(t,As,Ki);break;case 4:if(ea(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-Yr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Yt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*p9(s/1960))-s,10<s){t.timeoutHandle=FS(bl.bind(null,t,As,Ki),s);break}bl(t,As,Ki);break;case 5:bl(t,As,Ki);break;default:throw Error(oe(329))}}}return zs(t,Yt()),t.callbackNode===n?cL.bind(null,t):null}function nk(t,e){var n=Gf;return t.current.memoizedState.isDehydrated&&(Wl(t,e).flags|=256),t=gy(t,e),t!==2&&(e=As,As=n,e!==null&&sk(e)),t}function sk(t){As===null?As=t:As.push.apply(As,t)}function m9(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!si(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ea(t,e){for(e&=~kT,e&=~Q1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yr(e),s=1<<n;t[n]=-1,e&=~s}}function KD(t){if(qe&6)throw Error(oe(327));zu();var e=Zx(t,0);if(!(e&1))return zs(t,Yt()),null;var n=gy(t,e);if(t.tag!==0&&n===2){var s=_S(t);s!==0&&(e=s,n=nk(t,s))}if(n===1)throw n=Tp,Wl(t,0),ea(t,e),zs(t,Yt()),n;if(n===6)throw Error(oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bl(t,As,Ki),zs(t,Yt()),null}function TT(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(Qu=Yt()+500,q1&&Xa())}}function sc(t){na!==null&&na.tag===0&&!(qe&6)&&zu();var e=qe;qe|=1;var n=Ar.transition,s=it;try{if(Ar.transition=null,it=1,t)return t()}finally{it=s,Ar.transition=n,qe=e,!(qe&6)&&Xa()}}function IT(){Ys=Tu.current,bt(Tu)}function Wl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,HG(n)),an!==null)for(n=an.return;n!==null;){var s=n;switch(oT(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&sy();break;case 3:Xu(),bt(Ms),bt(rs),mT();break;case 5:pT(s);break;case 4:Xu();break;case 13:bt(Dt);break;case 19:bt(Dt);break;case 10:uT(s.type._context);break;case 22:case 23:IT()}n=n.return}if(Rn=t,an=t=wa(t.current,null),Wn=Ys=e,gn=0,Tp=null,kT=Q1=nc=0,As=Gf=null,Pl!==null){for(e=0;e<Pl.length;e++)if(n=Pl[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Pl=null}return t}function uL(t,e){do{var n=an;try{if(cT(),wx.current=dy,hy){for(var s=Pt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}hy=!1}if(tc=0,Nn=pn=Pt=null,jf=!1,Sp=0,ST.current=null,n===null||n.return===null){gn=1,Tp=e,an=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Wn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=PD(o);if(f!==null){f.flags&=-257,FD(f,o,a,i,e),f.mode&1&&OD(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){OD(i,c,e),NT();break e}l=Error(oe(426))}}else if(Tt&&a.mode&1){var m=PD(o);if(m!==null){!(m.flags&65536)&&(m.flags|=256),FD(m,o,a,i,e),aT(Yu(l,a));break e}}i=l=Yu(l,a),gn!==4&&(gn=2),Gf===null?Gf=[i]:Gf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=qM(i,l,e);_D(i,x);break e;case 1:a=l;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ya===null||!ya.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var w=KM(i,a,e);_D(i,w);break e}}i=i.return}while(i!==null)}fL(n)}catch(v){e=v,an===n&&n!==null&&(an=n=n.return);continue}break}while(!0)}function hL(){var t=fy.current;return fy.current=dy,t===null?dy:t}function NT(){(gn===0||gn===3||gn===2)&&(gn=4),Rn===null||!(nc&268435455)&&!(Q1&268435455)||ea(Rn,Wn)}function gy(t,e){var n=qe;qe|=2;var s=hL();(Rn!==t||Wn!==e)&&(Ki=null,Wl(t,e));do try{g9();break}catch(r){uL(t,r)}while(!0);if(cT(),qe=n,fy.current=s,an!==null)throw Error(oe(261));return Rn=null,Wn=0,gn}function g9(){for(;an!==null;)dL(an)}function x9(){for(;an!==null&&!WH();)dL(an)}function dL(t){var e=mL(t.alternate,t,Ys);t.memoizedProps=t.pendingProps,e===null?fL(t):an=e,ST.current=null}function fL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=u9(n,e),n!==null){n.flags&=32767,an=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{gn=6,an=null;return}}else if(n=c9(n,e,Ys),n!==null){an=n;return}if(e=e.sibling,e!==null){an=e;return}an=e=t}while(e!==null);gn===0&&(gn=5)}function bl(t,e,n){var s=it,r=Ar.transition;try{Ar.transition=null,it=1,y9(t,e,n,s)}finally{Ar.transition=r,it=s}return null}function y9(t,e,n,s){do zu();while(na!==null);if(qe&6)throw Error(oe(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(oe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(ZH(t,i),t===Rn&&(an=Rn=null,Wn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||E0||(E0=!0,gL(Qx,function(){return zu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ar.transition,Ar.transition=null;var o=it;it=1;var a=qe;qe|=4,ST.current=null,d9(t,n),aL(n,t),LG(OS),Jx=!!RS,OS=RS=null,t.current=n,f9(n),UH(),qe=a,it=o,Ar.transition=i}else t.current=n;if(E0&&(E0=!1,na=t,my=r),i=t.pendingLanes,i===0&&(ya=null),GH(n.stateNode),zs(t,Yt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(py)throw py=!1,t=ek,ek=null,t;return my&1&&t.tag!==0&&zu(),i=t.pendingLanes,i&1?t===tk?qf++:(qf=0,tk=t):qf=0,Xa(),null}function zu(){if(na!==null){var t=q3(my),e=Ar.transition,n=it;try{if(Ar.transition=null,it=16>t?16:t,na===null)var s=!1;else{if(t=na,na=null,my=0,qe&6)throw Error(oe(331));var r=qe;for(qe|=4,pe=t.current;pe!==null;){var i=pe,o=i.child;if(pe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(pe=c;pe!==null;){var u=pe;switch(u.tag){case 0:case 11:case 15:Hf(8,u,i)}var h=u.child;if(h!==null)h.return=u,pe=h;else for(;pe!==null;){u=pe;var d=u.sibling,f=u.return;if(rL(u),u===c){pe=null;break}if(d!==null){d.return=f,pe=d;break}pe=f}}}var p=i.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(g!==null)}}pe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,pe=o;else e:for(;pe!==null;){if(i=pe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Hf(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,pe=x;break e}pe=i.return}}var y=t.current;for(pe=y;pe!==null;){o=pe;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,pe=b;else e:for(o=y;pe!==null;){if(a=pe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Y1(9,a)}}catch(v){Mt(a,a.return,v)}if(a===o){pe=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,pe=w;break e}pe=a.return}}if(qe=r,Xa(),Ii&&typeof Ii.onPostCommitFiberRoot=="function")try{Ii.onPostCommitFiberRoot(W1,t)}catch{}s=!0}return s}finally{it=n,Ar.transition=e}}return!1}function XD(t,e,n){e=Yu(n,e),e=qM(t,e,1),t=xa(t,e,1),e=ms(),t!==null&&(um(t,1,e),zs(t,e))}function Mt(t,e,n){if(t.tag===3)XD(t,t,n);else for(;e!==null;){if(e.tag===3){XD(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ya===null||!ya.has(s))){t=Yu(n,t),t=KM(e,t,1),e=xa(e,t,1),t=ms(),e!==null&&(um(e,1,t),zs(e,t));break}}e=e.return}}function b9(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=ms(),t.pingedLanes|=t.suspendedLanes&n,Rn===t&&(Wn&n)===n&&(gn===4||gn===3&&(Wn&130023424)===Wn&&500>Yt()-CT?Wl(t,0):kT|=n),zs(t,e)}function pL(t,e){e===0&&(t.mode&1?(e=w0,w0<<=1,!(w0&130023424)&&(w0=4194304)):e=1);var n=ms();t=yo(t,e),t!==null&&(um(t,e,n),zs(t,n))}function w9(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),pL(t,n)}function v9(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(oe(314))}s!==null&&s.delete(e),pL(t,n)}var mL;mL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ms.current)Ps=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ps=!1,l9(t,e,n);Ps=!!(t.flags&131072)}else Ps=!1,Tt&&e.flags&1048576&&bM(e,oy,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Sx(t,e),t=e.pendingProps;var r=Gu(e,rs.current);Lu(e,n),r=xT(null,e,s,t,r,n);var i=yT();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ls(s)?(i=!0,ry(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,dT(e),r.updater=X1,e.stateNode=r,r._reactInternals=e,US(e,s,t,n),e=GS(null,e,s,!0,i,n)):(e.tag=0,Tt&&i&&iT(e),hs(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Sx(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=k9(s),t=Ur(s,t),r){case 0:e=HS(null,e,s,t,n);break e;case 1:e=zD(null,e,s,t,n);break e;case 11:e=MD(null,e,s,t,n);break e;case 14:e=LD(null,e,s,Ur(s.type,t),n);break e}throw Error(oe(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Ur(s,r),HS(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Ur(s,r),zD(t,e,s,r,n);case 3:e:{if(ZM(e),t===null)throw Error(oe(387));s=e.pendingProps,i=e.memoizedState,r=i.element,TM(t,e),cy(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=Yu(Error(oe(423)),e),e=BD(t,e,s,n,r);break e}else if(s!==r){r=Yu(Error(oe(424)),e),e=BD(t,e,s,n,r);break e}else for(tr=ga(e.stateNode.containerInfo.firstChild),or=e,Tt=!0,Gr=null,n=kM(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qu(),s===r){e=bo(t,e,n);break e}hs(t,e,s,n)}e=e.child}return e;case 5:return IM(e),t===null&&BS(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,PS(s,r)?o=null:i!==null&&PS(s,i)&&(e.flags|=32),QM(t,e),hs(t,e,o,n),e.child;case 6:return t===null&&BS(e),null;case 13:return JM(t,e,n);case 4:return fT(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Ku(e,null,s,n):hs(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Ur(s,r),MD(t,e,s,r,n);case 7:return hs(t,e,e.pendingProps,n),e.child;case 8:return hs(t,e,e.pendingProps.children,n),e.child;case 12:return hs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,ft(ay,s._currentValue),s._currentValue=o,i!==null)if(si(i.value,o)){if(i.children===r.children&&!Ms.current){e=bo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=lo(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),VS(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(oe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),VS(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}hs(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Lu(e,n),r=Rr(r),s=s(r),e.flags|=1,hs(t,e,s,n),e.child;case 14:return s=e.type,r=Ur(s,e.pendingProps),r=Ur(s.type,r),LD(t,e,s,r,n);case 15:return XM(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Ur(s,r),Sx(t,e),e.tag=1,Ls(s)?(t=!0,ry(e)):t=!1,Lu(e,n),GM(e,s,r),US(e,s,r,n),GS(null,e,s,!0,t,n);case 19:return eL(t,e,n);case 22:return YM(t,e,n)}throw Error(oe(156,e.tag))};function gL(t,e){return U3(t,e)}function S9(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(t,e,n,s){return new S9(t,e,n,s)}function _T(t){return t=t.prototype,!(!t||!t.isReactComponent)}function k9(t){if(typeof t=="function")return _T(t)?1:0;if(t!=null){if(t=t.$$typeof,t===qC)return 11;if(t===KC)return 14}return 2}function wa(t,e){var n=t.alternate;return n===null?(n=Ir(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Tx(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")_T(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case mu:return Ul(n.children,r,i,e);case GC:o=8,r|=8;break;case fS:return t=Ir(12,n,e,r|2),t.elementType=fS,t.lanes=i,t;case pS:return t=Ir(13,n,e,r),t.elementType=pS,t.lanes=i,t;case mS:return t=Ir(19,n,e,r),t.elementType=mS,t.lanes=i,t;case I3:return Z1(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case C3:o=10;break e;case T3:o=9;break e;case qC:o=11;break e;case KC:o=14;break e;case Yo:o=16,s=null;break e}throw Error(oe(130,t==null?t:typeof t,""))}return e=Ir(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function Ul(t,e,n,s){return t=Ir(7,t,s,e),t.lanes=n,t}function Z1(t,e,n,s){return t=Ir(22,t,s,e),t.elementType=I3,t.lanes=n,t.stateNode={isHidden:!1},t}function y2(t,e,n){return t=Ir(6,t,null,e),t.lanes=n,t}function b2(t,e,n){return e=Ir(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function C9(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jv(0),this.expirationTimes=Jv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jv(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function $T(t,e,n,s,r,i,o,a,l){return t=new C9(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ir(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},dT(i),t}function T9(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pu,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function xL(t){if(!t)return _a;t=t._reactInternals;e:{if(Mc(t)!==t||t.tag!==1)throw Error(oe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ls(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(t.tag===1){var n=t.type;if(Ls(n))return xM(t,n,e)}return e}function yL(t,e,n,s,r,i,o,a,l){return t=$T(n,s,!0,t,r,i,o,a,l),t.context=xL(null),n=t.current,s=ms(),r=ba(n),i=lo(s,r),i.callback=e??null,xa(n,i,r),t.current.lanes=r,um(t,r,s),zs(t,s),t}function J1(t,e,n,s){var r=e.current,i=ms(),o=ba(r);return n=xL(n),e.context===null?e.context=n:e.pendingContext=n,e=lo(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=xa(r,e,o),t!==null&&(Qr(t,r,o,i),bx(t,r,o)),o}function xy(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function YD(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ET(t,e){YD(t,e),(t=t.alternate)&&YD(t,e)}function I9(){return null}var bL=typeof reportError=="function"?reportError:function(t){console.error(t)};function DT(t){this._internalRoot=t}eb.prototype.render=DT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(oe(409));J1(t,e,null,null)};eb.prototype.unmount=DT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;sc(function(){J1(null,t,null,null)}),e[xo]=null}};function eb(t){this._internalRoot=t}eb.prototype.unstable_scheduleHydration=function(t){if(t){var e=Y3();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jo.length&&e!==0&&e<Jo[n].priority;n++);Jo.splice(n,0,t),n===0&&Z3(t)}};function AT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function tb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function QD(){}function N9(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=xy(o);i.call(c)}}var o=yL(e,s,t,0,null,!1,!1,"",QD);return t._reactRootContainer=o,t[xo]=o.current,xp(t.nodeType===8?t.parentNode:t),sc(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=xy(l);a.call(c)}}var l=$T(t,0,!1,null,null,!1,!1,"",QD);return t._reactRootContainer=l,t[xo]=l.current,xp(t.nodeType===8?t.parentNode:t),sc(function(){J1(e,l,n,s)}),l}function nb(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=xy(o);a.call(l)}}J1(e,o,t,r)}else o=N9(n,e,t,r,s);return xy(o)}K3=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wf(e.pendingLanes);n!==0&&(QC(e,n|1),zs(e,Yt()),!(qe&6)&&(Qu=Yt()+500,Xa()))}break;case 13:sc(function(){var s=yo(t,1);if(s!==null){var r=ms();Qr(s,t,1,r)}}),ET(t,1)}};ZC=function(t){if(t.tag===13){var e=yo(t,134217728);if(e!==null){var n=ms();Qr(e,t,134217728,n)}ET(t,134217728)}};X3=function(t){if(t.tag===13){var e=ba(t),n=yo(t,e);if(n!==null){var s=ms();Qr(n,t,e,s)}ET(t,e)}};Y3=function(){return it};Q3=function(t,e){var n=it;try{return it=t,e()}finally{it=n}};TS=function(t,e,n){switch(e){case"input":if(yS(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=G1(s);if(!r)throw Error(oe(90));_3(s),yS(s,r)}}}break;case"textarea":E3(t,n);break;case"select":e=n.value,e!=null&&Ou(t,!!n.multiple,e,!1)}};M3=TT;L3=sc;var _9={usingClientEntryPoint:!1,Events:[dm,bu,G1,P3,F3,TT]},tf={findFiberByHostInstance:Ol,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$9={bundleType:tf.bundleType,version:tf.version,rendererPackageName:tf.rendererPackageName,rendererConfig:tf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Eo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=V3(t),t===null?null:t.stateNode},findFiberByHostInstance:tf.findFiberByHostInstance||I9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var D0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!D0.isDisabled&&D0.supportsFiber)try{W1=D0.inject($9),Ii=D0}catch{}}fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_9;fr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!AT(e))throw Error(oe(200));return T9(t,e,null,n)};fr.createRoot=function(t,e){if(!AT(t))throw Error(oe(299));var n=!1,s="",r=bL;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=$T(t,1,!1,null,null,n,!1,s,r),t[xo]=e.current,xp(t.nodeType===8?t.parentNode:t),new DT(e)};fr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(oe(188)):(t=Object.keys(t).join(","),Error(oe(268,t)));return t=V3(e),t=t===null?null:t.stateNode,t};fr.flushSync=function(t){return sc(t)};fr.hydrate=function(t,e,n){if(!tb(e))throw Error(oe(200));return nb(null,t,e,!0,n)};fr.hydrateRoot=function(t,e,n){if(!AT(t))throw Error(oe(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=bL;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=yL(e,null,t,1,n??null,r,!1,i,o),t[xo]=e.current,xp(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new eb(e)};fr.render=function(t,e,n){if(!tb(e))throw Error(oe(200));return nb(null,t,e,!1,n)};fr.unmountComponentAtNode=function(t){if(!tb(t))throw Error(oe(40));return t._reactRootContainer?(sc(function(){nb(null,null,t,!1,function(){t._reactRootContainer=null,t[xo]=null})}),!0):!1};fr.unstable_batchedUpdates=TT;fr.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!tb(n))throw Error(oe(200));if(t==null||t._reactInternals===void 0)throw Error(oe(38));return nb(t,e,n,!1,s)};fr.version="18.3.1-next-f1338f8080-20240426";function wL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wL)}catch(t){console.error(t)}}wL(),w3.exports=fr;var E9=w3.exports,vL,ZD=E9;vL=ZD.createRoot,ZD.hydrateRoot;/**
 * @remix-run/router v1.19.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ip(){return Ip=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ip.apply(this,arguments)}var sa;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(sa||(sa={}));const JD="popstate";function D9(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return rk("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:yy(r)}return R9(e,n,null,t)}function Bt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function SL(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function A9(){return Math.random().toString(36).substr(2,8)}function eA(t,e){return{usr:t.state,key:t.key,idx:e}}function rk(t,e,n,s){return n===void 0&&(n=null),Ip({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ih(e):e,{state:n,key:e&&e.key||s||A9()})}function yy(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Ih(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function R9(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=sa.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Ip({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=sa.Pop;let m=u(),x=m==null?null:m-c;c=m,l&&l({action:a,location:g.location,delta:x})}function d(m,x){a=sa.Push;let y=rk(g.location,m,x);c=u()+1;let b=eA(y,c),w=g.createHref(y);try{o.pushState(b,"",w)}catch(v){if(v instanceof DOMException&&v.name==="DataCloneError")throw v;r.location.assign(w)}i&&l&&l({action:a,location:g.location,delta:1})}function f(m,x){a=sa.Replace;let y=rk(g.location,m,x);c=u();let b=eA(y,c),w=g.createHref(y);o.replaceState(b,"",w),i&&l&&l({action:a,location:g.location,delta:0})}function p(m){let x=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof m=="string"?m:yy(m);return y=y.replace(/ $/,"%20"),Bt(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let g={get action(){return a},get location(){return t(r,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(JD,h),l=m,()=>{r.removeEventListener(JD,h),l=null}},createHref(m){return e(r,m)},createURL:p,encodeLocation(m){let x=p(m);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:d,replace:f,go(m){return o.go(m)}};return g}var tA;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(tA||(tA={}));function O9(t,e,n){return n===void 0&&(n="/"),P9(t,e,n,!1)}function P9(t,e,n,s){let r=typeof e=="string"?Ih(e):e,i=Zu(r.pathname||"/",n);if(i==null)return null;let o=kL(t);F9(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=q9(i);a=H9(o[l],c,s)}return a}function kL(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Bt(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let c=va([s,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(Bt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),kL(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:U9(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of CL(i.path))r(i,o,l)}),e}function CL(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=CL(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function F9(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:j9(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const M9=/^:[\w-]+$/,L9=3,z9=2,B9=1,V9=10,W9=-2,nA=t=>t==="*";function U9(t,e){let n=t.split("/"),s=n.length;return n.some(nA)&&(s+=W9),e&&(s+=z9),n.filter(r=>!nA(r)).reduce((r,i)=>r+(M9.test(i)?L9:i===""?B9:V9),s)}function j9(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function H9(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=by({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h&&c&&n&&!s[s.length-1].route.index&&(h=by({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:va([i,h.pathname]),pathnameBase:Q9(va([i,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(i=va([i,h.pathnameBase]))}return o}function by(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=G9(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((c,u,h)=>{let{paramName:d,isOptional:f}=u;if(d==="*"){let g=a[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[h];return f&&!p?c[d]=void 0:c[d]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function G9(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),SL(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function q9(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return SL(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Zu(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function K9(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Ih(t):t;return{pathname:n?n.startsWith("/")?n:X9(n,e):e,search:Z9(s),hash:J9(r)}}function X9(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function w2(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Y9(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function TL(t,e){let n=Y9(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function IL(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=Ih(t):(r=Ip({},t),Bt(!r.pathname||!r.pathname.includes("?"),w2("?","pathname","search",r)),Bt(!r.pathname||!r.pathname.includes("#"),w2("#","pathname","hash",r)),Bt(!r.search||!r.search.includes("#"),w2("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!s&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;r.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=K9(r,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const va=t=>t.join("/").replace(/\/\/+/g,"/"),Q9=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Z9=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,J9=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function e7(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const NL=["post","put","patch","delete"];new Set(NL);const t7=["get",...NL];new Set(t7);/**
 * React Router v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Np(){return Np=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Np.apply(this,arguments)}const sb=H.createContext(null),_L=H.createContext(null),Ya=H.createContext(null),rb=H.createContext(null),Lc=H.createContext({outlet:null,matches:[],isDataRoute:!1}),$L=H.createContext(null);function n7(t,e){let{relative:n}=e===void 0?{}:e;pm()||Bt(!1);let{basename:s,navigator:r}=H.useContext(Ya),{hash:i,pathname:o,search:a}=ib(t,{relative:n}),l=o;return s!=="/"&&(l=o==="/"?s:va([s,o])),r.createHref({pathname:l,search:a,hash:i})}function pm(){return H.useContext(rb)!=null}function mm(){return pm()||Bt(!1),H.useContext(rb).location}function EL(t){H.useContext(Ya).static||H.useLayoutEffect(t)}function s7(){let{isDataRoute:t}=H.useContext(Lc);return t?g7():r7()}function r7(){pm()||Bt(!1);let t=H.useContext(sb),{basename:e,future:n,navigator:s}=H.useContext(Ya),{matches:r}=H.useContext(Lc),{pathname:i}=mm(),o=JSON.stringify(TL(r,n.v7_relativeSplatPath)),a=H.useRef(!1);return EL(()=>{a.current=!0}),H.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){s.go(c);return}let h=IL(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:va([e,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[e,s,o,i,t])}function ib(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=H.useContext(Ya),{matches:r}=H.useContext(Lc),{pathname:i}=mm(),o=JSON.stringify(TL(r,s.v7_relativeSplatPath));return H.useMemo(()=>IL(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function i7(t,e){return o7(t,e)}function o7(t,e,n,s){pm()||Bt(!1);let{navigator:r}=H.useContext(Ya),{matches:i}=H.useContext(Lc),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=mm(),u;if(e){var h;let m=typeof e=="string"?Ih(e):e;l==="/"||(h=m.pathname)!=null&&h.startsWith(l)||Bt(!1),u=m}else u=c;let d=u.pathname||"/",f=d;if(l!=="/"){let m=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(m.length).join("/")}let p=O9(t,{pathname:f}),g=h7(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:va([l,r.encodeLocation?r.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?l:va([l,r.encodeLocation?r.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,n,s);return e&&g?H.createElement(rb.Provider,{value:{location:Np({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:sa.Pop}},g):g}function a7(){let t=m7(),e=e7(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},e),n?H.createElement("pre",{style:r},n):null,null)}const l7=H.createElement(a7,null);class c7 extends H.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?H.createElement(Lc.Provider,{value:this.props.routeContext},H.createElement($L.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function u7(t){let{routeContext:e,match:n,children:s}=t,r=H.useContext(sb);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),H.createElement(Lc.Provider,{value:e},s)}function h7(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||Bt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:f}=n,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,d)=>{let f,p=!1,g=null,m=null;n&&(f=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||l7,l&&(c<0&&d===0?(p=!0,m=null):c===d&&(p=!0,m=h.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,d+1)),y=()=>{let b;return f?b=g:p?b=m:h.route.Component?b=H.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,H.createElement(u7,{match:h,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?H.createElement(c7,{location:n.location,revalidation:n.revalidation,component:g,error:f,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var DL=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(DL||{}),wy=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(wy||{});function d7(t){let e=H.useContext(sb);return e||Bt(!1),e}function f7(t){let e=H.useContext(_L);return e||Bt(!1),e}function p7(t){let e=H.useContext(Lc);return e||Bt(!1),e}function AL(t){let e=p7(),n=e.matches[e.matches.length-1];return n.route.id||Bt(!1),n.route.id}function m7(){var t;let e=H.useContext($L),n=f7(wy.UseRouteError),s=AL(wy.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function g7(){let{router:t}=d7(DL.UseNavigateStable),e=AL(wy.UseNavigateStable),n=H.useRef(!1);return EL(()=>{n.current=!0}),H.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Np({fromRouteId:e},i)))},[t,e])}function wl(t){Bt(!1)}function x7(t){let{basename:e="/",children:n=null,location:s,navigationType:r=sa.Pop,navigator:i,static:o=!1,future:a}=t;pm()&&Bt(!1);let l=e.replace(/^\/*/,"/"),c=H.useMemo(()=>({basename:l,navigator:i,static:o,future:Np({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=Ih(s));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:p="default"}=s,g=H.useMemo(()=>{let m=Zu(u,l);return m==null?null:{location:{pathname:m,search:h,hash:d,state:f,key:p},navigationType:r}},[l,u,h,d,f,p,r]);return g==null?null:H.createElement(Ya.Provider,{value:c},H.createElement(rb.Provider,{children:n,value:g}))}function y7(t){let{children:e,location:n}=t;return i7(ik(e),n)}new Promise(()=>{});function ik(t,e){e===void 0&&(e=[]);let n=[];return H.Children.forEach(t,(s,r)=>{if(!H.isValidElement(s))return;let i=[...e,r];if(s.type===H.Fragment){n.push.apply(n,ik(s.props.children,i));return}s.type!==wl&&Bt(!1),!s.props.index||!s.props.children||Bt(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=ik(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vy(){return vy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},vy.apply(this,arguments)}function RL(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function b7(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function w7(t,e){return t.button===0&&(!e||e==="_self")&&!b7(t)}const v7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],S7=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],k7="6";try{window.__reactRouterVersion=k7}catch{}const C7=H.createContext({isTransitioning:!1}),T7="startTransition",sA=bH[T7];function I7(t){let{basename:e,children:n,future:s,window:r}=t,i=H.useRef();i.current==null&&(i.current=D9({window:r,v5Compat:!0}));let o=i.current,[a,l]=H.useState({action:o.action,location:o.location}),{v7_startTransition:c}=s||{},u=H.useCallback(h=>{c&&sA?sA(()=>l(h)):l(h)},[l,c]);return H.useLayoutEffect(()=>o.listen(u),[o,u]),H.createElement(x7,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}const N7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$7=H.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,unstable_viewTransition:h}=e,d=RL(e,v7),{basename:f}=H.useContext(Ya),p,g=!1;if(typeof c=="string"&&_7.test(c)&&(p=c,N7))try{let b=new URL(window.location.href),w=c.startsWith("//")?new URL(b.protocol+c):new URL(c),v=Zu(w.pathname,f);w.origin===b.origin&&v!=null?c=v+w.search+w.hash:g=!0}catch{}let m=n7(c,{relative:r}),x=D7(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:r,unstable_viewTransition:h});function y(b){s&&s(b),b.defaultPrevented||x(b)}return H.createElement("a",vy({},d,{href:p||m,onClick:g||i?s:y,ref:n,target:l}))}),nf=H.forwardRef(function(e,n){let{"aria-current":s="page",caseSensitive:r=!1,className:i="",end:o=!1,style:a,to:l,unstable_viewTransition:c,children:u}=e,h=RL(e,S7),d=ib(l,{relative:h.relative}),f=mm(),p=H.useContext(_L),{navigator:g,basename:m}=H.useContext(Ya),x=p!=null&&A7(d)&&c===!0,y=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,b=f.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;r||(b=b.toLowerCase(),w=w?w.toLowerCase():null,y=y.toLowerCase()),w&&m&&(w=Zu(w,m)||w);const v=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let S=b===y||!o&&b.startsWith(y)&&b.charAt(v)==="/",T=w!=null&&(w===y||!o&&w.startsWith(y)&&w.charAt(y.length)==="/"),k={isActive:S,isPending:T,isTransitioning:x},I=S?s:void 0,_;typeof i=="function"?_=i(k):_=[i,S?"active":null,T?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let D=typeof a=="function"?a(k):a;return H.createElement($7,vy({},h,{"aria-current":I,className:_,ref:n,style:D,to:l,unstable_viewTransition:c}),typeof u=="function"?u(k):u)});var ok;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(ok||(ok={}));var rA;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(rA||(rA={}));function E7(t){let e=H.useContext(sb);return e||Bt(!1),e}function D7(t,e){let{target:n,replace:s,state:r,preventScrollReset:i,relative:o,unstable_viewTransition:a}=e===void 0?{}:e,l=s7(),c=mm(),u=ib(t,{relative:o});return H.useCallback(h=>{if(w7(h,n)){h.preventDefault();let d=s!==void 0?s:yy(c)===yy(u);l(t,{replace:d,state:r,preventScrollReset:i,relative:o,unstable_viewTransition:a})}},[c,l,u,s,r,n,t,i,o,a])}function A7(t,e){e===void 0&&(e={});let n=H.useContext(C7);n==null&&Bt(!1);let{basename:s}=E7(ok.useViewTransitionState),r=ib(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Zu(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=Zu(n.nextLocation.pathname,s)||n.nextLocation.pathname;return by(r.pathname,o)!=null||by(r.pathname,i)!=null}function rc(t,e){var n=Sy();return rc=function(s,r){s=s-153;var i=n[s];return i},rc(t,e)}(function(t,e){for(var n=rc,s=t();;)try{var r=parseInt(n(178))/1+-parseInt(n(173))/2*(parseInt(n(183))/3)+-parseInt(n(185))/4*(-parseInt(n(164))/5)+parseInt(n(184))/6*(parseInt(n(179))/7)+-parseInt(n(162))/8*(parseInt(n(166))/9)+parseInt(n(160))/10+-parseInt(n(157))/11*(parseInt(n(171))/12);if(r===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Sy,624589);var R7=function(){var t=!0;return function(e,n){var s=t?function(){var r=rc;if(n){var i=n[r(177)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){R7(this,function(){var t=rc,e=new RegExp(t(155)),n=new RegExp(t(188),"i"),s=iA(t(182));!e.test(s+t(174))||!n.test(s+t(176))?s("0"):iA()})()})();function O7(){var t=rc;return z.jsx("nav",{className:t(153),children:z.jsxs("ul",{className:t(175),children:[z.jsx("li",{children:z.jsx(nf,{to:"/",className:"text-white hover:text-gray-400",end:!0,children:t(161)})}),z.jsx("li",{children:z.jsx(nf,{to:t(181),className:t(169),children:t(186)})}),z.jsx("li",{children:z.jsx(nf,{to:t(158),className:t(169),children:"Projects"})}),z.jsx("li",{children:z.jsx(nf,{to:t(154),className:t(169),children:t(165)})}),z.jsx("li",{children:z.jsx(nf,{to:"/mini-projects",className:t(169),children:"Mini-Projects"})})]})})}function Sy(){var t=["/work-experience","init","6AMytJI","18KLxtBb","175748BaeIAr","Work Experience","while (true) {}","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","bg-gray-900 fixed w-full z-10 top-0","/contact","function *\\( *\\)","call","14687409avELeM","/projects","length","8221190SyqyPH","About Me","472FgpJrz","stateObject","125BDkuqO","Contact","38826hfZnTN","string","constructor","text-white hover:text-gray-400","debu","12DuVSeC","action","58246KZxJMM","chain","flex justify-center space-x-6 py-4","input","apply","130030jvXLfE","518014iJmsvc","gger"];return Sy=function(){return t},Sy()}function iA(t){function e(n){var s=rc;if(typeof n===s(167))return(function(r){})[s(168)](s(187))[s(177)]("counter");(""+n/n)[s(159)]!==1||n%20===0?(function(){return!0})[s(168)](s(170)+"gger")[s(156)](s(172)):(function(){return!1})[s(168)]("debu"+s(180))[s(177)](s(163)),e(++n)}try{if(t)return e;e(0)}catch{}}function P7(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...s)=>t(...s);return new Proxy(n,{get:(s,r)=>r==="create"?t:(e.has(r)||e.set(r,t(r)),e.get(r))})}function _p(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const ak=t=>Array.isArray(t);function OL(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function $p(t){return typeof t=="string"||Array.isArray(t)}function oA(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function RT(t,e,n,s){if(typeof e=="function"){const[r,i]=oA(s);e=e(n!==void 0?n:t.custom,r,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,i]=oA(s);e=e(n!==void 0?n:t.custom,r,i)}return e}function ob(t,e,n){const s=t.getProps();return RT(s,e,n!==void 0?n:s.custom,t)}const OT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],PT=["initial",...OT],gm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Qa=new Set(gm),co=t=>t*1e3,uo=t=>t/1e3,F7={type:"spring",stiffness:500,damping:25,restSpeed:10},M7=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),L7={type:"keyframes",duration:.8},z7={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},B7=(t,{keyframes:e})=>e.length>2?L7:Qa.has(t)?t.startsWith("scale")?M7(e[1]):F7:z7;function V7({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function FT(t,e){return t[e]||t.default||t}const W7={skipAnimations:!1,useManualTiming:!1},U7=t=>t!==null;function ab(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(U7),i=e&&n!=="loop"&&e%2===1?0:r.length-1;return!i||s===void 0?r[i]:s}const ss=t=>t;function j7(t){let e=new Set,n=new Set,s=!1,r=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){i.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,h=!1)=>{const f=h&&s?e:n;return u&&i.add(c),f.has(c)||f.add(c),c},cancel:c=>{n.delete(c),i.delete(c)},process:c=>{if(o=c,s){r=!0;return}s=!0,[e,n]=[n,e],n.clear(),e.forEach(a),s=!1,r&&(r=!1,l.process(c))}};return l}const A0=["read","resolveKeyframes","update","preRender","render","postRender"],H7=40;function PL(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=A0.reduce((x,y)=>(x[y]=j7(i),x),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:d}=o,f=()=>{const x=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(x-r.timestamp,H7),1),r.timestamp=x,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),u.process(r),h.process(r),d.process(r),r.isProcessing=!1,n&&e&&(s=!1,t(f))},p=()=>{n=!0,s=!0,r.isProcessing||t(f)};return{schedule:A0.reduce((x,y)=>{const b=o[y];return x[y]=(w,v=!1,S=!1)=>(n||p(),b.schedule(w,v,S)),x},{}),cancel:x=>{for(let y=0;y<A0.length;y++)o[A0[y]].cancel(x)},state:r,steps:o}}const{schedule:st,cancel:wo,state:Vn,steps:v2}=PL(typeof requestAnimationFrame<"u"?requestAnimationFrame:ss,!0),FL=t=>/^0[^.\s]+$/u.test(t);function G7(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||FL(t):!0}let lk=ss;const ML=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),LL=t=>e=>typeof e=="string"&&e.startsWith(t),zL=LL("--"),q7=LL("var(--"),MT=t=>q7(t)?K7.test(t.split("/*")[0].trim()):!1,K7=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,X7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Y7(t){const e=X7.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function BL(t,e,n=1){const[s,r]=Y7(t);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return ML(o)?parseFloat(o):o}return MT(r)?BL(r,e,n+1):r}const $a=(t,e,n)=>n>e?e:n<t?t:n,Nh={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Kf={...Nh,transform:t=>$a(0,1,t)},R0={...Nh,default:1},Xf=t=>Math.round(t*1e5)/1e5,LT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,Q7=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,Z7=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function xm(t){return typeof t=="string"}function J7(t){return t==null}const ym=t=>({test:e=>xm(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Ko=ym("deg"),_i=ym("%"),Se=ym("px"),eq=ym("vh"),tq=ym("vw"),aA={..._i,parse:t=>_i.parse(t)/100,transform:t=>_i.transform(t*100)},nq=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),lA=t=>t===Nh||t===Se,cA=(t,e)=>parseFloat(t.split(", ")[e]),uA=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/u);if(r)return cA(r[1],e);{const i=s.match(/^matrix\((.+)\)$/u);return i?cA(i[1],t):0}},sq=new Set(["x","y","z"]),rq=gm.filter(t=>!sq.has(t));function iq(t){const e=[];return rq.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const Ju={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:uA(4,13),y:uA(5,14)};Ju.translateX=Ju.x;Ju.translateY=Ju.y;const VL=t=>e=>e.test(t),oq={test:t=>t==="auto",parse:t=>t},WL=[Nh,Se,_i,Ko,tq,eq,oq],hA=t=>WL.find(VL(t)),jl=new Set;let ck=!1,uk=!1;function UL(){if(uk){const t=Array.from(jl).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=iq(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var a;(a=s.getValue(i))===null||a===void 0||a.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}uk=!1,ck=!1,jl.forEach(t=>t.complete()),jl.clear()}function jL(){jl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(uk=!0)})}function aq(){jL(),UL()}class zT{constructor(e,n,s,r,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(jl.add(this),ck||(ck=!0,st.read(jL),st.resolveKeyframes(UL))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const o=r==null?void 0:r.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(s&&n){const l=s.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),jl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,jl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const BT=(t,e)=>n=>!!(xm(n)&&Z7.test(n)&&n.startsWith(t)||e&&!J7(n)&&Object.prototype.hasOwnProperty.call(n,e)),HL=(t,e,n)=>s=>{if(!xm(s))return s;const[r,i,o,a]=s.match(LT);return{[t]:parseFloat(r),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},lq=t=>$a(0,255,t),S2={...Nh,transform:t=>Math.round(lq(t))},Ml={test:BT("rgb","red"),parse:HL("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+S2.transform(t)+", "+S2.transform(e)+", "+S2.transform(n)+", "+Xf(Kf.transform(s))+")"};function cq(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const hk={test:BT("#"),parse:cq,transform:Ml.transform},Iu={test:BT("hsl","hue"),parse:HL("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+_i.transform(Xf(e))+", "+_i.transform(Xf(n))+", "+Xf(Kf.transform(s))+")"},Xn={test:t=>Ml.test(t)||hk.test(t)||Iu.test(t),parse:t=>Ml.test(t)?Ml.parse(t):Iu.test(t)?Iu.parse(t):hk.parse(t),transform:t=>xm(t)?t:t.hasOwnProperty("red")?Ml.transform(t):Iu.transform(t)};function uq(t){var e,n;return isNaN(t)&&xm(t)&&(((e=t.match(LT))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(Q7))===null||n===void 0?void 0:n.length)||0)>0}const GL="number",qL="color",hq="var",dq="var(",dA="${}",fq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ep(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const a=e.replace(fq,l=>(Xn.test(l)?(s.color.push(i),r.push(qL),n.push(Xn.parse(l))):l.startsWith(dq)?(s.var.push(i),r.push(hq),n.push(l)):(s.number.push(i),r.push(GL),n.push(parseFloat(l))),++i,dA)).split(dA);return{values:n,split:a,indexes:s,types:r}}function KL(t){return Ep(t).values}function XL(t){const{split:e,types:n}=Ep(t),s=e.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=e[o],r[o]!==void 0){const a=n[o];a===GL?i+=Xf(r[o]):a===qL?i+=Xn.transform(r[o]):i+=r[o]}return i}}const pq=t=>typeof t=="number"?0:t;function mq(t){const e=KL(t);return XL(t)(e.map(pq))}const Ea={test:uq,parse:KL,createTransformer:XL,getAnimatableNone:mq},gq=new Set(["brightness","contrast","saturate","opacity"]);function xq(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(LT)||[];if(!s)return t;const r=n.replace(s,"");let i=gq.has(e)?1:0;return s!==n&&(i*=100),e+"("+i+r+")"}const yq=/\b([a-z-]*)\(.*?\)/gu,dk={...Ea,getAnimatableNone:t=>{const e=t.match(yq);return e?e.map(xq).join(" "):t}},fA={...Nh,transform:Math.round},VT={borderWidth:Se,borderTopWidth:Se,borderRightWidth:Se,borderBottomWidth:Se,borderLeftWidth:Se,borderRadius:Se,radius:Se,borderTopLeftRadius:Se,borderTopRightRadius:Se,borderBottomRightRadius:Se,borderBottomLeftRadius:Se,width:Se,maxWidth:Se,height:Se,maxHeight:Se,size:Se,top:Se,right:Se,bottom:Se,left:Se,padding:Se,paddingTop:Se,paddingRight:Se,paddingBottom:Se,paddingLeft:Se,margin:Se,marginTop:Se,marginRight:Se,marginBottom:Se,marginLeft:Se,rotate:Ko,rotateX:Ko,rotateY:Ko,rotateZ:Ko,scale:R0,scaleX:R0,scaleY:R0,scaleZ:R0,skew:Ko,skewX:Ko,skewY:Ko,distance:Se,translateX:Se,translateY:Se,translateZ:Se,x:Se,y:Se,z:Se,perspective:Se,transformPerspective:Se,opacity:Kf,originX:aA,originY:aA,originZ:Se,zIndex:fA,backgroundPositionX:Se,backgroundPositionY:Se,fillOpacity:Kf,strokeOpacity:Kf,numOctaves:fA},bq={...VT,color:Xn,backgroundColor:Xn,outlineColor:Xn,fill:Xn,stroke:Xn,borderColor:Xn,borderTopColor:Xn,borderRightColor:Xn,borderBottomColor:Xn,borderLeftColor:Xn,filter:dk,WebkitFilter:dk},WT=t=>bq[t];function YL(t,e){let n=WT(t);return n!==dk&&(n=Ea),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const wq=new Set(["auto","none","0"]);function vq(t,e,n){let s=0,r;for(;s<t.length&&!r;){const i=t[s];typeof i=="string"&&!wq.has(i)&&Ep(i).values.length&&(r=t[s]),s++}if(r&&n)for(const i of e)t[i]=YL(n,r)}class QL extends zT{constructor(e,n,s,r,i){super(e,n,s,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),MT(c))){const u=BL(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!nq.has(s)||e.length!==2)return;const[r,i]=e,o=hA(r),a=hA(i);if(o!==a)if(lA(o)&&lA(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)G7(e[r])&&s.push(r);s.length&&vq(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ju[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n||!n.current)return;const i=n.getValue(s);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Ju[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function ZL(t){let e;return()=>(e===void 0&&(e=t()),e)}let Ix;function Sq(){Ix=void 0}const ho={now:()=>(Ix===void 0&&ho.set(Vn.isProcessing||W7.useManualTiming?Vn.timestamp:performance.now()),Ix),set:t=>{Ix=t,queueMicrotask(Sq)}},pA=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Ea.test(t)||t==="0")&&!t.startsWith("url("));function kq(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Cq(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=pA(r,e),a=pA(i,e);return!o||!a?!1:kq(t)||n==="spring"&&s}const Tq=40;class JL{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ho.now(),this.options={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Tq?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&aq(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=ho.now(),this.hasAttemptedResolve=!0;const{name:s,type:r,velocity:i,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!Cq(e,s,r,i))if(o)this.options.duration=0;else{l==null||l(ab(e,this.options,n)),a==null||a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,n);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}function e4(t,e){return e?t*(1e3/e):0}const Iq=5;function t4(t,e,n){const s=Math.max(e-Iq,0);return e4(n-t(s),e-s)}const k2=.001,Nq=.01,_q=10,$q=.05,Eq=1;function Dq({duration:t=800,bounce:e=.25,velocity:n=0,mass:s=1}){let r,i,o=1-e;o=$a($q,Eq,o),t=$a(Nq,_q,uo(t)),o<1?(r=c=>{const u=c*o,h=u*t,d=u-n,f=fk(c,o),p=Math.exp(-h);return k2-d/f*p},i=c=>{const h=c*o*t,d=h*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-h),g=fk(Math.pow(c,2),o);return(-r(c)+k2>0?-1:1)*((d-f)*p)/g}):(r=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-k2+u*h},i=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=Rq(r,i,a);if(t=co(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:t}}}const Aq=12;function Rq(t,e,n){let s=n;for(let r=1;r<Aq;r++)s=s-t(s)/e(s);return s}function fk(t,e){return t*Math.sqrt(1-e*e)}const Oq=["duration","bounce"],Pq=["stiffness","damping","mass"];function mA(t,e){return e.some(n=>t[n]!==void 0)}function Fq(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!mA(t,Pq)&&mA(t,Oq)){const n=Dq(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function n4({keyframes:t,restDelta:e,restSpeed:n,...s}){const r=t[0],i=t[t.length-1],o={done:!1,value:r},{stiffness:a,damping:l,mass:c,duration:u,velocity:h,isResolvedFromDuration:d}=Fq({...s,velocity:-uo(s.velocity||0)}),f=h||0,p=l/(2*Math.sqrt(a*c)),g=i-r,m=uo(Math.sqrt(a/c)),x=Math.abs(g)<5;n||(n=x?.01:2),e||(e=x?.005:.5);let y;if(p<1){const b=fk(m,p);y=w=>{const v=Math.exp(-p*m*w);return i-v*((f+p*m*g)/b*Math.sin(b*w)+g*Math.cos(b*w))}}else if(p===1)y=b=>i-Math.exp(-m*b)*(g+(f+m*g)*b);else{const b=m*Math.sqrt(p*p-1);y=w=>{const v=Math.exp(-p*m*w),S=Math.min(b*w,300);return i-v*((f+p*m*g)*Math.sinh(S)+b*g*Math.cosh(S))/b}}return{calculatedDuration:d&&u||null,next:b=>{const w=y(b);if(d)o.done=b>=u;else{let v=0;p<1&&(v=b===0?co(f):t4(y,b,w));const S=Math.abs(v)<=n,T=Math.abs(i-w)<=e;o.done=S&&T}return o.value=o.done?i:w,o}}}function gA({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],d={done:!1,value:h},f=k=>a!==void 0&&k<a||l!==void 0&&k>l,p=k=>a===void 0?l:l===void 0||Math.abs(a-k)<Math.abs(l-k)?a:l;let g=n*e;const m=h+g,x=o===void 0?m:o(m);x!==m&&(g=x-h);const y=k=>-g*Math.exp(-k/s),b=k=>x+y(k),w=k=>{const I=y(k),_=b(k);d.done=Math.abs(I)<=c,d.value=d.done?x:_};let v,S;const T=k=>{f(d.value)&&(v=k,S=n4({keyframes:[d.value,p(d.value)],velocity:t4(b,k,d.value),damping:r,stiffness:i,restDelta:c,restSpeed:u}))};return T(0),{calculatedDuration:null,next:k=>{let I=!1;return!S&&v===void 0&&(I=!0,w(k),T(k)),v!==void 0&&k>=v?S.next(k-v):(!I&&w(k),d)}}}const s4=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Mq=1e-7,Lq=12;function zq(t,e,n,s,r){let i,o,a=0;do o=e+(n-e)/2,i=s4(o,s,r)-t,i>0?n=o:e=o;while(Math.abs(i)>Mq&&++a<Lq);return o}function bm(t,e,n,s){if(t===e&&n===s)return ss;const r=i=>zq(i,0,1,t,n);return i=>i===0||i===1?i:s4(r(i),e,s)}const Bq=bm(.42,0,1,1),Vq=bm(0,0,.58,1),r4=bm(.42,0,.58,1),Wq=t=>Array.isArray(t)&&typeof t[0]!="number",i4=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,o4=t=>e=>1-t(1-e),UT=t=>1-Math.sin(Math.acos(t)),a4=o4(UT),Uq=i4(UT),l4=bm(.33,1.53,.69,.99),jT=o4(l4),jq=i4(jT),Hq=t=>(t*=2)<1?.5*jT(t):.5*(2-Math.pow(2,-10*(t-1))),xA={linear:ss,easeIn:Bq,easeInOut:r4,easeOut:Vq,circIn:UT,circInOut:Uq,circOut:a4,backIn:jT,backInOut:jq,backOut:l4,anticipate:Hq},yA=t=>{if(Array.isArray(t)){lk(t.length===4);const[e,n,s,r]=t;return bm(e,n,s,r)}else if(typeof t=="string")return lk(xA[t]!==void 0),xA[t];return t},Gq=(t,e)=>n=>e(t(n)),fo=(...t)=>t.reduce(Gq),Dp=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},At=(t,e,n)=>t+(e-t)*n;function C2(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function qq({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,i=0,o=0;if(!e)r=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=C2(l,a,t+1/3),i=C2(l,a,t),o=C2(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function ky(t,e){return n=>n>0?e:t}const T2=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},Kq=[hk,Ml,Iu],Xq=t=>Kq.find(e=>e.test(t));function bA(t){const e=Xq(t);if(!e)return!1;let n=e.parse(t);return e===Iu&&(n=qq(n)),n}const wA=(t,e)=>{const n=bA(t),s=bA(e);if(!n||!s)return ky(t,e);const r={...n};return i=>(r.red=T2(n.red,s.red,i),r.green=T2(n.green,s.green,i),r.blue=T2(n.blue,s.blue,i),r.alpha=At(n.alpha,s.alpha,i),Ml.transform(r))},pk=new Set(["none","hidden"]);function Yq(t,e){return pk.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Qq(t,e){return n=>At(t,e,n)}function HT(t){return typeof t=="number"?Qq:typeof t=="string"?MT(t)?ky:Xn.test(t)?wA:eK:Array.isArray(t)?c4:typeof t=="object"?Xn.test(t)?wA:Zq:ky}function c4(t,e){const n=[...t],s=n.length,r=t.map((i,o)=>HT(i)(i,e[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function Zq(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=HT(t[r])(t[r],e[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function Jq(t,e){var n;const s=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],a=t.indexes[o][r[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;s[i]=l,r[o]++}return s}const eK=(t,e)=>{const n=Ea.createTransformer(e),s=Ep(t),r=Ep(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?pk.has(t)&&!r.values.length||pk.has(e)&&!s.values.length?Yq(t,e):fo(c4(Jq(s,r),r.values),n):ky(t,e)};function u4(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?At(t,e,n):HT(t)(t,e)}function tK(t,e,n){const s=[],r=n||u4,i=t.length-1;for(let o=0;o<i;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||ss:e;a=fo(l,a)}s.push(a)}return s}function nK(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const i=t.length;if(lk(i===e.length),i===1)return()=>e[0];if(i===2&&t[0]===t[1])return()=>e[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=tK(e,s,r),a=o.length,l=c=>{let u=0;if(a>1)for(;u<t.length-2&&!(c<t[u+1]);u++);const h=Dp(t[u],t[u+1],c);return o[u](h)};return n?c=>l($a(t[0],t[i-1],c)):l}function sK(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=Dp(0,e,s);t.push(At(n,1,r))}}function rK(t){const e=[0];return sK(e,t.length-1),e}function iK(t,e){return t.map(n=>n*e)}function oK(t,e){return t.map(()=>e||r4).splice(0,t.length-1)}function Cy({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=Wq(s)?s.map(yA):yA(s),i={done:!1,value:e[0]},o=iK(n&&n.length===e.length?n:rK(e),t),a=nK(o,e,{ease:Array.isArray(r)?r:oK(e,r)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const vA=2e4;function aK(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<vA;)e+=n,s=t.next(e);return e>=vA?1/0:e}const lK=t=>{const e=({timestamp:n})=>t(n);return{start:()=>st.update(e,!0),stop:()=>wo(e),now:()=>Vn.isProcessing?Vn.timestamp:ho.now()}},cK={decay:gA,inertia:gA,tween:Cy,keyframes:Cy,spring:n4},uK=t=>t/100;class GT extends JL{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:r,keyframes:i}=this.options,o=(r==null?void 0:r.KeyframeResolver)||zT,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(i,a,n,s,r),this.resolver.scheduleResolve()}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=this.options,a=cK[n]||Cy;let l,c;a!==Cy&&typeof e[0]!="number"&&(l=fo(uK,u4(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});i==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=aK(u));const{calculatedDuration:h}=u,d=h+r,f=d*(s+1)-r;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:d,totalDuration:f}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:k}=this.options;return{done:!0,value:k[k.length-1]}}const{finalKeyframe:r,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:h}=s;if(this.startTime===null)return i.next(0);const{delay:d,repeat:f,repeatType:p,repeatDelay:g,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const x=this.currentTime-d*(this.speed>=0?1:-1),y=this.speed>=0?x<0:x>u;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let b=this.currentTime,w=i;if(f){const k=Math.min(this.currentTime,u)/h;let I=Math.floor(k),_=k%1;!_&&k>=1&&(_=1),_===1&&I--,I=Math.min(I,f+1),!!(I%2)&&(p==="reverse"?(_=1-_,g&&(_-=g/h)):p==="mirror"&&(w=o)),b=$a(0,1,_)*h}const v=y?{done:!1,value:l[0]}:w.next(b);a&&(v.value=a(v.value));let{done:S}=v;!y&&c!==null&&(S=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&S);return T&&r!==void 0&&(v.value=ab(l,this.options,r)),m&&m(v.value),T&&this.finish(),v}get duration(){const{resolved:e}=this;return e?uo(e.calculatedDuration):0}get time(){return uo(this.currentTime)}set time(e){e=co(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=uo(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=lK,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),n&&n();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const h4=new Set(["opacity","clipPath","filter","transform"]),d4=t=>Array.isArray(t)&&typeof t[0]=="number";function f4(t){return!!(!t||typeof t=="string"&&t in qT||d4(t)||Array.isArray(t)&&t.every(f4))}const Sf=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,qT={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Sf([0,.65,.55,1]),circOut:Sf([.55,0,1,.45]),backIn:Sf([.31,.01,.66,-.59]),backOut:Sf([.33,1.53,.69,.99])};function hK(t){return p4(t)||qT.easeOut}function p4(t){if(t)return d4(t)?Sf(t):Array.isArray(t)?t.map(hK):qT[t]}function dK(t,e,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:a,times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=p4(a);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:s,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}const fK=ZL(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Ty=10,pK=2e4;function mK(t){return t.type==="spring"||!f4(t.ease)}function gK(t,e){const n=new GT({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const r=[];let i=0;for(;!s.done&&i<pK;)s=n.sample(i),r.push(s.value),i+=Ty;return{times:void 0,keyframes:r,duration:i-Ty,ease:"linear"}}class SA extends JL{constructor(e){super(e);const{name:n,motionValue:s,element:r,keyframes:i}=this.options;this.resolver=new QL(i,(o,a)=>this.onKeyframesResolved(o,a),n,s,r),this.resolver.scheduleResolve()}initPlayback(e,n){var s;let{duration:r=300,times:i,ease:o,type:a,motionValue:l,name:c,startTime:u}=this.options;if(!(!((s=l.owner)===null||s===void 0)&&s.current))return!1;if(mK(this.options)){const{onComplete:d,onUpdate:f,motionValue:p,element:g,...m}=this.options,x=gK(e,m);e=x.keyframes,e.length===1&&(e[1]=e[0]),r=x.duration,i=x.times,o=x.ease,a="keyframes"}const h=dK(l.owner.current,c,e,{...this.options,duration:r,times:i,ease:o});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(h.timeline=this.pendingTimeline,this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:d}=this.options;l.set(ab(e,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return uo(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return uo(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=co(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return ss;const{animation:s}=n;s.timeline=e,s.onfinish=null}return ss}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:r,type:i,ease:o,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:h,element:d,...f}=this.options,p=new GT({...f,keyframes:s,duration:r,type:i,ease:o,times:a,isGenerator:!0}),g=co(this.time);c.setWithVelocity(p.sample(g-Ty).value,p.sample(g).value,Ty)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:r,repeatType:i,damping:o,type:a}=e;return fK()&&s&&h4.has(s)&&n&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate&&!r&&i!=="mirror"&&o!==0&&a!=="inertia"}}function xK(t,e){let n;const s=()=>{const{currentTime:r}=e,o=(r===null?0:r.value)/100;n!==o&&t(o),n=o};return st.update(s,!0),()=>wo(s)}const yK=ZL(()=>window.ScrollTimeline!==void 0);class bK{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}then(e,n){return Promise.all(this.animations).then(e).catch(n)}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e){const n=this.animations.map(s=>{if(yK()&&s.attachTimeline)s.attachTimeline(e);else return s.pause(),xK(r=>{s.time=s.duration*r},e)});return()=>{n.forEach((s,r)=>{s&&s(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const KT=(t,e,n,s={},r,i,o)=>a=>{const l=FT(s,t)||{},c=l.delay||s.delay||0;let{elapsed:u=0}=s;u=u-co(c);let h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-u,onUpdate:f=>{e.set(f),l.onUpdate&&l.onUpdate(f)},onComplete:()=>{a(),l.onComplete&&l.onComplete(),o&&o()},onStop:o,name:t,motionValue:e,element:i?void 0:r};V7(l)||(h={...h,...B7(t,h)}),h.duration&&(h.duration=co(h.duration)),h.repeatDelay&&(h.repeatDelay=co(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let d=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(d=!0)),d&&!i&&e.get()!==void 0){const f=ab(h.keyframes,l);if(f!==void 0)return st.update(()=>{h.onUpdate(f),h.onComplete()}),new bK([])}return!i&&SA.supports(h)?new SA(h):new GT(h)},wK=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),vK=t=>ak(t)?t[t.length-1]||0:t;function lb(t,e){t.indexOf(e)===-1&&t.push(e)}function cb(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class XT{constructor(){this.subscriptions=[]}add(e){return lb(this.subscriptions,e),()=>cb(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const kA=30,SK=t=>!isNaN(parseFloat(t));class m4{constructor(e,n={}){this.version="11.5.4",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const i=ho.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=ho.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=SK(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new XT);const s=this.events[e].add(n);return e==="change"?()=>{s(),st.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ho.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>kA)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,kA);return e4(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ap(t,e){return new m4(t,e)}function kK(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Ap(n))}function CK(t,e){const n=ob(t,e);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const a=vK(i[o]);kK(t,o,a)}}const ub=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),TK="framerAppearId",g4="data-"+ub(TK);function x4(t){return t.props[g4]}function y4(t){if(Qa.has(t))return"transform";if(h4.has(t))return ub(t)}class IK extends m4{constructor(){super(...arguments),this.output=[],this.counts=new Map}add(e){const n=y4(e);if(!n)return;const s=this.counts.get(n)||0;this.counts.set(n,s+1),s===0&&(this.output.push(n),this.update());let r=!1;return()=>{if(r)return;r=!0;const i=this.counts.get(n)-1;this.counts.set(n,i),i===0&&(cb(this.output,n),this.update())}}update(){this.set(this.output.length?this.output.join(", "):"auto")}}const ts=t=>!!(t&&t.getVelocity);function NK(t){return!!(ts(t)&&t.add)}function mk(t,e){var n;if(!t.applyWillChange)return;let s=t.getValue("willChange");if(!s&&!(!((n=t.props.style)===null||n===void 0)&&n.willChange)&&(s=new IK("auto"),t.addValue("willChange",s)),NK(s))return s.add(e)}function _K({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function b4(t,e,{delay:n=0,transitionOverride:s,type:r}={}){var i;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;s&&(o=s);const c=[],u=r&&t.animationState&&t.animationState.getState()[r];for(const h in l){const d=t.getValue(h,(i=t.latestValues[h])!==null&&i!==void 0?i:null),f=l[h];if(f===void 0||u&&_K(u,h))continue;const p={delay:n,...FT(o||{},h)};let g=!1;if(window.MotionHandoffAnimation){const x=x4(t);if(x){const y=window.MotionHandoffAnimation(x,h,st);y!==null&&(p.startTime=y,g=!0)}}d.start(KT(h,d,f,t.shouldReduceMotion&&Qa.has(h)?{type:!1}:p,t,g,mk(t,h)));const m=d.animation;m&&c.push(m)}return a&&Promise.all(c).then(()=>{st.update(()=>{a&&CK(t,a)})}),c}function gk(t,e,n={}){var s;const r=ob(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const o=r?()=>Promise.all(b4(t,r,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:d}=i;return $K(t,e,u+c,h,d,n)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function $K(t,e,n=0,s=0,r=1,i){const o=[],a=(t.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(t.variantChildren).sort(EK).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(gk(c,e,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function EK(t,e){return t.sortNodePosition(e)}function DK(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>gk(t,i,n));s=Promise.all(r)}else if(typeof e=="string")s=gk(t,e,n);else{const r=typeof e=="function"?ob(t,e,n.custom):e;s=Promise.all(b4(t,r,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}const AK=[...OT].reverse(),RK=OT.length;function OK(t){return e=>Promise.all(e.map(({animation:n,options:s})=>DK(t,n,s)))}function PK(t){let e=OK(t),n=CA(),s=!0;const r=l=>(c,u)=>{var h;const d=ob(t,u,l==="exit"?(h=t.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:p,...g}=d;c={...c,...g,...p}}return c};function i(l){e=l(t)}function o(l){const c=t.getProps(),u=t.getVariantContext(!0)||{},h=[],d=new Set;let f={},p=1/0;for(let m=0;m<RK;m++){const x=AK[m],y=n[x],b=c[x]!==void 0?c[x]:u[x],w=$p(b),v=x===l?y.isActive:null;v===!1&&(p=m);let S=b===u[x]&&b!==c[x]&&w;if(S&&s&&t.manuallyAnimateOnMount&&(S=!1),y.protectedKeys={...f},!y.isActive&&v===null||!b&&!y.prevProp||_p(b)||typeof b=="boolean")continue;let k=FK(y.prevProp,b)||x===l&&y.isActive&&!S&&w||m>p&&w,I=!1;const _=Array.isArray(b)?b:[b];let D=_.reduce(r(x),{});v===!1&&(D={});const{prevResolvedValues:A={}}=y,L={...A,...D},B=F=>{k=!0,d.has(F)&&(I=!0,d.delete(F)),y.needsAnimating[F]=!0;const R=t.getValue(F);R&&(R.liveStyle=!1)};for(const F in L){const R=D[F],O=A[F];if(f.hasOwnProperty(F))continue;let E=!1;ak(R)&&ak(O)?E=!OL(R,O):E=R!==O,E?R!=null?B(F):d.add(F):R!==void 0&&d.has(F)?B(F):y.protectedKeys[F]=!0}y.prevProp=b,y.prevResolvedValues=D,y.isActive&&(f={...f,...D}),s&&t.blockInitialAnimation&&(k=!1),k&&(!S||I)&&h.push(..._.map(F=>({animation:F,options:{type:x}})))}if(d.size){const m={};d.forEach(x=>{const y=t.getBaseTarget(x),b=t.getValue(x);b&&(b.liveStyle=!0),m[x]=y??null}),h.push({animation:m})}let g=!!h.length;return s&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(g=!1),s=!1,g?e(h):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(d=>{var f;return(f=d.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const h=o(l);for(const d in n)n[d].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=CA(),s=!0}}}function FK(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!OL(e,t):!1}function hl(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function CA(){return{animate:hl(!0),whileInView:hl(),whileHover:hl(),whileTap:hl(),whileDrag:hl(),whileFocus:hl(),exit:hl()}}class Za{constructor(e){this.isMounted=!1,this.node=e}update(){}}class MK extends Za{constructor(e){super(e),e.animationState||(e.animationState=PK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();_p(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let LK=0;class zK extends Za{constructor(){super(...arguments),this.id=LK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const BK={animation:{Feature:MK},exit:{Feature:zK}},w4=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function hb(t,e="page"){return{point:{x:t[`${e}X`],y:t[`${e}Y`]}}}const VK=t=>e=>w4(e)&&t(e,hb(e));function ro(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function po(t,e,n,s){return ro(t,e,VK(n),s)}const TA=(t,e)=>Math.abs(t-e);function WK(t,e){const n=TA(t.x,e.x),s=TA(t.y,e.y);return Math.sqrt(n**2+s**2)}class v4{constructor(e,n,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=N2(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,f=WK(h.offset,{x:0,y:0})>=3;if(!d&&!f)return;const{point:p}=h,{timestamp:g}=Vn;this.history.push({...p,timestamp:g});const{onStart:m,onMove:x}=this.handlers;d||(m&&m(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=I2(d,this.transformPagePoint),st.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=N2(h.type==="pointercancel"?this.lastMoveEventInfo:I2(d,this.transformPagePoint),this.history);this.startEvent&&f&&f(h,m),p&&p(h,m)},!w4(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.contextWindow=r||window;const o=hb(e),a=I2(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=Vn;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,N2(a,this.history)),this.removeListeners=fo(po(this.contextWindow,"pointermove",this.handlePointerMove),po(this.contextWindow,"pointerup",this.handlePointerUp),po(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wo(this.updatePoint)}}function I2(t,e){return e?{point:e(t.point)}:t}function IA(t,e){return{x:t.x-e.x,y:t.y-e.y}}function N2({point:t},e){return{point:t,delta:IA(t,S4(e)),offset:IA(t,UK(e)),velocity:jK(e,.1)}}function UK(t){return t[0]}function S4(t){return t[t.length-1]}function jK(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=S4(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>co(e)));)n--;if(!s)return{x:0,y:0};const i=uo(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function k4(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const NA=k4("dragHorizontal"),_A=k4("dragVertical");function C4(t){let e=!1;if(t==="y")e=_A();else if(t==="x")e=NA();else{const n=NA(),s=_A();n&&s?e=()=>{n(),s()}:(n&&n(),s&&s())}return e}function T4(){const t=C4(!0);return t?(t(),!1):!0}function Nu(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}const I4=1e-4,HK=1-I4,GK=1+I4,N4=.01,qK=0-N4,KK=0+N4;function ur(t){return t.max-t.min}function XK(t,e,n){return Math.abs(t-e)<=n}function $A(t,e,n,s=.5){t.origin=s,t.originPoint=At(e.min,e.max,t.origin),t.scale=ur(n)/ur(e),t.translate=At(n.min,n.max,t.origin)-t.originPoint,(t.scale>=HK&&t.scale<=GK||isNaN(t.scale))&&(t.scale=1),(t.translate>=qK&&t.translate<=KK||isNaN(t.translate))&&(t.translate=0)}function Yf(t,e,n,s){$A(t.x,e.x,n.x,s?s.originX:void 0),$A(t.y,e.y,n.y,s?s.originY:void 0)}function EA(t,e,n){t.min=n.min+e.min,t.max=t.min+ur(e)}function YK(t,e,n){EA(t.x,e.x,n.x),EA(t.y,e.y,n.y)}function DA(t,e,n){t.min=e.min-n.min,t.max=t.min+ur(e)}function Qf(t,e,n){DA(t.x,e.x,n.x),DA(t.y,e.y,n.y)}function QK(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?At(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?At(n,t,s.max):Math.min(t,n)),t}function AA(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function ZK(t,{top:e,left:n,bottom:s,right:r}){return{x:AA(t.x,n,r),y:AA(t.y,e,s)}}function RA(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function JK(t,e){return{x:RA(t.x,e.x),y:RA(t.y,e.y)}}function eX(t,e){let n=.5;const s=ur(t),r=ur(e);return r>s?n=Dp(e.min,e.max-s,t.min):s>r&&(n=Dp(t.min,t.max-r,e.min)),$a(0,1,n)}function tX(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const xk=.35;function nX(t=xk){return t===!1?t=0:t===!0&&(t=xk),{x:OA(t,"left","right"),y:OA(t,"top","bottom")}}function OA(t,e,n){return{min:PA(t,e),max:PA(t,n)}}function PA(t,e){return typeof t=="number"?t:t[e]||0}const FA=()=>({translate:0,scale:1,origin:0,originPoint:0}),_u=()=>({x:FA(),y:FA()}),MA=()=>({min:0,max:0}),Kt=()=>({x:MA(),y:MA()});function vr(t){return[t("x"),t("y")]}function _4({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function sX({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function rX(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function _2(t){return t===void 0||t===1}function yk({scale:t,scaleX:e,scaleY:n}){return!_2(t)||!_2(e)||!_2(n)}function vl(t){return yk(t)||$4(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function $4(t){return LA(t.x)||LA(t.y)}function LA(t){return t&&t!=="0%"}function Iy(t,e,n){const s=t-n,r=e*s;return n+r}function zA(t,e,n,s,r){return r!==void 0&&(t=Iy(t,r,s)),Iy(t,n,s)+e}function bk(t,e=0,n=1,s,r){t.min=zA(t.min,e,n,s,r),t.max=zA(t.max,e,n,s,r)}function E4(t,{x:e,y:n}){bk(t.x,e.translate,e.scale,e.originPoint),bk(t.y,n.translate,n.scale,n.originPoint)}const BA=.999999999999,VA=1.0000000000001;function iX(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let i,o;for(let a=0;a<r;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Eu(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,E4(t,o)),s&&vl(i.latestValues)&&Eu(t,i.latestValues))}e.x<VA&&e.x>BA&&(e.x=1),e.y<VA&&e.y>BA&&(e.y=1)}function $u(t,e){t.min=t.min+e,t.max=t.max+e}function WA(t,e,n,s,r=.5){const i=At(t.min,t.max,r);bk(t,e,n,i,s)}function Eu(t,e){WA(t.x,e.x,e.scaleX,e.scale,e.originX),WA(t.y,e.y,e.scaleY,e.scale,e.originY)}function D4(t,e){return _4(rX(t.getBoundingClientRect(),e))}function oX(t,e,n){const s=D4(t,n),{scroll:r}=e;return r&&($u(s.x,r.offset.x),$u(s.y,r.offset.y)),s}const A4=({current:t})=>t?t.ownerDocument.defaultView:null,aX=new WeakMap;class lX{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Kt(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(hb(u,"page").point)},i=(u,h)=>{var d;const{drag:f,dragPropagation:p,onDragStart:g}=this.getProps();if(f&&!p&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=C4(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),vr(x=>{let y=this.getAxisMotionValue(x).get()||0;if(_i.test(y)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[x];w&&(y=ur(w)*(parseFloat(y)/100))}}this.originPoint[x]=y}),g&&st.postRender(()=>g(u,h)),(d=this.removeWillChange)===null||d===void 0||d.call(this),this.removeWillChange=mk(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:d,dragDirectionLock:f,onDirectionLock:p,onDrag:g}=this.getProps();if(!d&&!this.openGlobalLock)return;const{offset:m}=h;if(f&&this.currentDirection===null){this.currentDirection=cX(m),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,m),this.updateAxis("y",h.point,m),this.visualElement.render(),g&&g(u,h)},a=(u,h)=>this.stop(u,h),l=()=>vr(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new v4(e,{onSessionStart:r,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:A4(this.visualElement)})}stop(e,n){var s;(s=this.removeWillChange)===null||s===void 0||s.call(this);const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&st.postRender(()=>o(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!O0(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=QK(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&Nu(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=ZK(r.layoutBox,n):this.constraints=!1,this.elastic=nX(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&vr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=tX(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Nu(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=oX(s,r.root,this.visualElement.getTransformPagePoint());let o=JK(r.layout.layoutBox,i);if(n){const a=n(sX(o));this.hasMutatedConstraints=!!a,a&&(o=_4(a))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=vr(u=>{if(!O0(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:s?e[u]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return s.start(KT(e,s,0,n,this.visualElement,!1,mk(this.visualElement,e)))}stopAnimation(){vr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){vr(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){vr(n=>{const{drag:s}=this.getProps();if(!O0(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];i.set(e[n]-At(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!Nu(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};vr(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=eX({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),vr(o=>{if(!O0(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(At(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;aX.set(this.visualElement,this);const e=this.visualElement.current,n=po(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Nu(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),st.read(s);const o=ro(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(vr(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=xk,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function O0(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function cX(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class uX extends Za{constructor(e){super(e),this.removeGroupControls=ss,this.removeListeners=ss,this.controls=new lX(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ss}unmount(){this.removeGroupControls(),this.removeListeners()}}const UA=t=>(e,n)=>{t&&st.postRender(()=>t(e,n))};class hX extends Za{constructor(){super(...arguments),this.removePointerDownListener=ss}onPointerDown(e){this.session=new v4(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:A4(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:UA(e),onStart:UA(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&st.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=po(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const YT=H.createContext(null);function dX(){const t=H.useContext(YT);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:s}=t,r=H.useId();H.useEffect(()=>s(r),[]);const i=H.useCallback(()=>n&&n(r),[r,n]);return!e&&n?[!1,i]:[!0]}const R4=H.createContext({}),O4=H.createContext({}),Nx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function jA(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const sf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Se.test(t))t=parseFloat(t);else return t;const n=jA(t,e.target.x),s=jA(t,e.target.y);return`${n}% ${s}%`}},fX={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=Ea.parse(t);if(r.length>5)return s;const i=Ea.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=At(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),i(r)}},Ny={};function pX(t){Object.assign(Ny,t)}const{schedule:QT,cancel:B3e}=PL(queueMicrotask,!1);class mX extends H.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;pX(gX),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Nx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,o=s.projection;return o&&(o.isPresent=i,r||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||st.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),QT.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function P4(t){const[e,n]=dX(),s=H.useContext(R4);return z.jsx(mX,{...t,layoutGroup:s,switchLayoutGroup:H.useContext(O4),isPresent:e,safeToRemove:n})}const gX={borderRadius:{...sf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:sf,borderTopRightRadius:sf,borderBottomLeftRadius:sf,borderBottomRightRadius:sf,boxShadow:fX},F4=["TopLeft","TopRight","BottomLeft","BottomRight"],xX=F4.length,HA=t=>typeof t=="string"?parseFloat(t):t,GA=t=>typeof t=="number"||Se.test(t);function yX(t,e,n,s,r,i){r?(t.opacity=At(0,n.opacity!==void 0?n.opacity:1,bX(s)),t.opacityExit=At(e.opacity!==void 0?e.opacity:1,0,wX(s))):i&&(t.opacity=At(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<xX;o++){const a=`border${F4[o]}Radius`;let l=qA(e,a),c=qA(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||GA(l)===GA(c)?(t[a]=Math.max(At(HA(l),HA(c),s),0),(_i.test(c)||_i.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=At(e.rotate||0,n.rotate||0,s))}function qA(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const bX=M4(0,.5,a4),wX=M4(.5,.95,ss);function M4(t,e,n){return s=>s<t?0:s>e?1:n(Dp(t,e,s))}function KA(t,e){t.min=e.min,t.max=e.max}function gr(t,e){KA(t.x,e.x),KA(t.y,e.y)}function XA(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function YA(t,e,n,s,r){return t-=e,t=Iy(t,1/n,s),r!==void 0&&(t=Iy(t,1/r,s)),t}function vX(t,e=0,n=1,s=.5,r,i=t,o=t){if(_i.test(e)&&(e=parseFloat(e),e=At(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=At(i.min,i.max,s);t===i&&(a-=e),t.min=YA(t.min,e,n,a,r),t.max=YA(t.max,e,n,a,r)}function QA(t,e,[n,s,r],i,o){vX(t,e[n],e[s],e[r],e.scale,i,o)}const SX=["x","scaleX","originX"],kX=["y","scaleY","originY"];function ZA(t,e,n,s){QA(t.x,e,SX,n?n.x:void 0,s?s.x:void 0),QA(t.y,e,kX,n?n.y:void 0,s?s.y:void 0)}function JA(t){return t.translate===0&&t.scale===1}function L4(t){return JA(t.x)&&JA(t.y)}function eR(t,e){return t.min===e.min&&t.max===e.max}function CX(t,e){return eR(t.x,e.x)&&eR(t.y,e.y)}function tR(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function z4(t,e){return tR(t.x,e.x)&&tR(t.y,e.y)}function nR(t){return ur(t.x)/ur(t.y)}function sR(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class TX{constructor(){this.members=[]}add(e){lb(this.members,e),e.scheduleRender()}remove(e){if(cb(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function IX(t,e,n){let s="";const r=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:d,skewX:f,skewY:p}=n;c&&(s=`perspective(${c}px) ${s}`),u&&(s+=`rotate(${u}deg) `),h&&(s+=`rotateX(${h}deg) `),d&&(s+=`rotateY(${d}deg) `),f&&(s+=`skewX(${f}deg) `),p&&(s+=`skewY(${p}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const NX=(t,e)=>t.depth-e.depth;class _X{constructor(){this.children=[],this.isDirty=!1}add(e){lb(this.children,e),this.isDirty=!0}remove(e){cb(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(NX),this.isDirty=!1,this.children.forEach(e)}}function _x(t){const e=ts(t)?t.get():t;return wK(e)?e.toValue():e}function $X(t,e){const n=ho.now(),s=({timestamp:r})=>{const i=r-n;i>=e&&(wo(s),t(i-e))};return st.read(s,!0),()=>wo(s)}function EX(t){return t instanceof SVGElement&&t.tagName!=="svg"}function DX(t,e,n){const s=ts(t)?t:Ap(t);return s.start(KT("",s,e,n)),s.animation}const Sl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},kf=typeof window<"u"&&window.MotionDebug!==void 0,$2=["","X","Y","Z"],AX={visibility:"hidden"},rR=1e3;let RX=0;function E2(t,e,n,s){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),s&&(s[t]=0))}function B4(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=x4(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",st,!(r||i))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&B4(s)}function V4({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=RX++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,kf&&(Sl.totalNodes=Sl.resolvedTargetDeltas=Sl.recalculatedProjection=0),this.nodes.forEach(FX),this.nodes.forEach(VX),this.nodes.forEach(WX),this.nodes.forEach(MX),kf&&window.MotionDebug.record(Sl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new _X)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new XT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=EX(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let h;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=$X(d,250),Nx.hasAnimatedSinceResize&&(Nx.hasAnimatedSinceResize=!1,this.nodes.forEach(oR))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||qX,{onLayoutAnimationStart:m,onLayoutAnimationComplete:x}=u.getProps(),y=!this.targetLayout||!z4(this.targetLayout,p)||f,b=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,b);const w={...FT(g,"layout"),onPlay:m,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else d||oR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,wo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(UX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&B4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(iR);return}this.isUpdating||this.nodes.forEach(zX),this.isUpdating=!1,this.nodes.forEach(BX),this.nodes.forEach(OX),this.nodes.forEach(PX),this.clearAllSnapshots();const a=ho.now();Vn.delta=$a(0,1e3/60,a-Vn.timestamp),Vn.timestamp=a,Vn.isProcessing=!0,v2.update.process(Vn),v2.preRender.process(Vn),v2.render.process(Vn),Vn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,QT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(LX),this.sharedNodes.forEach(jX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,st.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){st.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Kt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!L4(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||vl(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),KX(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return Kt();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(XX))){const{scroll:u}=this.root;u&&($u(l.x,u.offset.x),$u(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=Kt();if(gr(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:d}=u;u!==this.root&&h&&d.layoutScroll&&(h.wasRoot&&gr(l,o),$u(l.x,h.offset.x),$u(l.y,h.offset.y))}return l}applyTransform(o,a=!1){const l=Kt();gr(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Eu(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),vl(u.latestValues)&&Eu(l,u.latestValues)}return vl(this.latestValues)&&Eu(l,this.latestValues),l}removeTransform(o){const a=Kt();gr(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!vl(c.latestValues))continue;yk(c.latestValues)&&c.updateSnapshot();const u=Kt(),h=c.measurePageBox();gr(u,h),ZA(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return vl(this.latestValues)&&ZA(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Vn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=Vn.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Kt(),this.relativeTargetOrigin=Kt(),Qf(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),gr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Kt(),this.targetWithTransforms=Kt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),YK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gr(this.target,this.layout.layoutBox),E4(this.target,this.targetDelta)):gr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Kt(),this.relativeTargetOrigin=Kt(),Qf(this.relativeTargetOrigin,this.target,f.target),gr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}kf&&Sl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||yk(this.parent.latestValues)||$4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Vn.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;gr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;iX(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Kt());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(XA(this.prevProjectionDelta.x,this.projectionDelta.x),XA(this.prevProjectionDelta.y,this.projectionDelta.y)),Yf(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!sR(this.projectionDelta.x,this.prevProjectionDelta.x)||!sR(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),kf&&Sl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=_u(),this.projectionDelta=_u(),this.projectionDeltaWithTransform=_u()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=_u();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=Kt(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,g=f!==p,m=this.getStack(),x=!m||m.members.length<=1,y=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(GX));this.animationProgress=0;let b;this.mixTargetDelta=w=>{const v=w/1e3;aR(h.x,o.x,v),aR(h.y,o.y,v),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qf(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),HX(this.relativeTarget,this.relativeTargetOrigin,d,v),b&&CX(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=Kt()),gr(b,this.relativeTarget)),g&&(this.animationValues=u,yX(u,c,this.latestValues,v,y,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=v},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(wo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=st.update(()=>{Nx.hasAnimatedSinceResize=!0,this.currentAnimation=DX(0,rR,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(rR),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&W4(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Kt();const h=ur(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const d=ur(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}gr(a,l),Eu(a,u),Yf(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new TX),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&E2("z",o,c,this.animationValues);for(let u=0;u<$2.length;u++)E2(`rotate${$2[u]}`,o,c,this.animationValues),E2(`skew${$2[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return AX;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=_x(o==null?void 0:o.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=_x(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!vl(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=IX(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in Ny){if(d[g]===void 0)continue;const{correct:m,applyTo:x}=Ny[g],y=c.transform==="none"?d[g]:m(d[g],h);if(x){const b=x.length;for(let w=0;w<b;w++)c[x[w]]=y}else c[g]=y}return this.options.layoutId&&(c.pointerEvents=h===this?_x(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(iR),this.root.sharedNodes.clear()}}}function OX(t){t.updateLayout()}function PX(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?vr(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=ur(d);d.min=s[h].min,d.max=d.min+f}):W4(i,n.layoutBox,s)&&vr(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=ur(s[h]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+f)});const a=_u();Yf(a,s,n.layoutBox);const l=_u();o?Yf(l,t.applyTransform(r,!0),n.measuredBox):Yf(l,s,n.layoutBox);const c=!L4(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const p=Kt();Qf(p,n.layoutBox,d.layoutBox);const g=Kt();Qf(g,s,f.layoutBox),z4(p,g)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=g,t.relativeTargetOrigin=p,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function FX(t){kf&&Sl.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function MX(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function LX(t){t.clearSnapshot()}function iR(t){t.clearMeasurements()}function zX(t){t.isLayoutDirty=!1}function BX(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function oR(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function VX(t){t.resolveTargetDelta()}function WX(t){t.calcProjection()}function UX(t){t.resetSkewAndRotation()}function jX(t){t.removeLeadSnapshot()}function aR(t,e,n){t.translate=At(e.translate,0,n),t.scale=At(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function lR(t,e,n,s){t.min=At(e.min,n.min,s),t.max=At(e.max,n.max,s)}function HX(t,e,n,s){lR(t.x,e.x,n.x,s),lR(t.y,e.y,n.y,s)}function GX(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const qX={duration:.45,ease:[.4,0,.1,1]},cR=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),uR=cR("applewebkit/")&&!cR("chrome/")?Math.round:ss;function hR(t){t.min=uR(t.min),t.max=uR(t.max)}function KX(t){hR(t.x),hR(t.y)}function W4(t,e,n){return t==="position"||t==="preserve-aspect"&&!XK(nR(e),nR(n),.2)}function XX(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const YX=V4({attachResizeListener:(t,e)=>ro(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),D2={current:void 0},U4=V4({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!D2.current){const t=new YX({});t.mount(window),t.setOptions({layoutScroll:!0}),D2.current=t}return D2.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),QX={pan:{Feature:hX},drag:{Feature:uX,ProjectionNode:U4,MeasureLayout:P4}};function dR(t,e){const n=e?"pointerenter":"pointerleave",s=e?"onHoverStart":"onHoverEnd",r=(i,o)=>{if(i.pointerType==="touch"||T4())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e);const l=a[s];l&&st.postRender(()=>l(i,o))};return po(t.current,n,r,{passive:!t.getProps()[s]})}class ZX extends Za{mount(){this.unmount=fo(dR(this.node,!0),dR(this.node,!1))}unmount(){}}class JX extends Za{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=fo(ro(this.node.current,"focus",()=>this.onFocus()),ro(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const j4=(t,e)=>e?t===e?!0:j4(t,e.parentElement):!1;function A2(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,hb(n))}class eY extends Za{constructor(){super(...arguments),this.removeStartListeners=ss,this.removeEndListeners=ss,this.removeAccessibleListeners=ss,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const s=this.node.getProps(),i=po(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u,globalTapTarget:h}=this.node.getProps(),d=!h&&!j4(this.node.current,a.target)?u:c;d&&st.update(()=>d(a,l))},{passive:!(s.onTap||s.onPointerUp)}),o=po(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(s.onTapCancel||s.onPointerCancel)});this.removeEndListeners=fo(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||A2("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&st.postRender(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=ro(this.node.current,"keyup",o),A2("down",(a,l)=>{this.startPress(a,l)})},n=ro(this.node.current,"keydown",e),s=()=>{this.isPressing&&A2("cancel",(i,o)=>this.cancelPress(i,o))},r=ro(this.node.current,"blur",s);this.removeAccessibleListeners=fo(n,r)}}startPress(e,n){this.isPressing=!0;const{onTapStart:s,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),s&&st.postRender(()=>s(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!T4()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:s}=this.node.getProps();s&&st.postRender(()=>s(e,n))}mount(){const e=this.node.getProps(),n=po(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),s=ro(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=fo(n,s)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const wk=new WeakMap,R2=new WeakMap,tY=t=>{const e=wk.get(t.target);e&&e(t)},nY=t=>{t.forEach(tY)};function sY({root:t,...e}){const n=t||document;R2.has(n)||R2.set(n,{});const s=R2.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(nY,{root:t,...e})),s[r]}function rY(t,e,n){const s=sY(e);return wk.set(t,n),s.observe(t),()=>{wk.delete(t),s.unobserve(t)}}const iY={some:0,all:1};class oY extends Za{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:iY[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return rY(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(aY(e,n))&&this.startObserver()}unmount(){}}function aY({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const lY={inView:{Feature:oY},tap:{Feature:eY},focus:{Feature:JX},hover:{Feature:ZX}},cY={layout:{ProjectionNode:U4,MeasureLayout:P4}},H4=H.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),db=H.createContext({}),ZT=typeof window<"u",uY=ZT?H.useLayoutEffect:H.useEffect,G4=H.createContext({strict:!1});let fR=!1;function hY(t,e,n,s,r){var i;const{visualElement:o}=H.useContext(db),a=H.useContext(G4),l=H.useContext(YT),c=H.useContext(H4).reducedMotion,u=H.useRef();s=s||a.renderer,!u.current&&s&&(u.current=s(t,{visualState:e,parent:o,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const h=u.current,d=H.useContext(O4);h&&!h.projection&&r&&(h.type==="html"||h.type==="svg")&&fY(u.current,n,r,d),H.useInsertionEffect(()=>{h&&h.update(n,l)});const f=n[g4],p=H.useRef(!!f&&!window.MotionHandoffIsComplete&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,f)));return uY(()=>{h&&(h.updateFeatures(),QT.render(h.render),p.current&&h.animationState&&h.animationState.animateChanges())}),H.useEffect(()=>{h&&(!p.current&&h.animationState&&h.animationState.animateChanges(),p.current=!1,fR||(fR=!0,queueMicrotask(dY)))}),h}function dY(){window.MotionHandoffIsComplete=!0}function fY(t,e,n,s){const{layoutId:r,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:q4(t.parent)),t.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!o||a&&Nu(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function q4(t){if(t)return t.options.allowProjection!==!1?t.projection:q4(t.parent)}function pY(t,e,n){return H.useCallback(s=>{s&&t.mount&&t.mount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):Nu(n)&&(n.current=s))},[e])}function fb(t){return _p(t.animate)||PT.some(e=>$p(t[e]))}function K4(t){return!!(fb(t)||t.variants)}function mY(t,e){if(fb(t)){const{initial:n,animate:s}=t;return{initial:n===!1||$p(n)?n:void 0,animate:$p(s)?s:void 0}}return t.inherit!==!1?e:{}}function gY(t){const{initial:e,animate:n}=mY(t,H.useContext(db));return H.useMemo(()=>({initial:e,animate:n}),[pR(e),pR(n)])}function pR(t){return Array.isArray(t)?t.join(" "):t}const mR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},eh={};for(const t in mR)eh[t]={isEnabled:e=>mR[t].some(n=>!!e[n])};function xY(t){for(const e in t)eh[e]={...eh[e],...t[e]}}const yY=Symbol.for("motionComponentSymbol");function bY({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:r}){t&&xY(t);function i(a,l){let c;const u={...H.useContext(H4),...a,layoutId:wY(a)},{isStatic:h}=u,d=gY(a),f=s(a,h);if(!h&&ZT){vY();const p=SY(u);c=p.MeasureLayout,d.visualElement=hY(r,f,u,e,p.ProjectionNode)}return z.jsxs(db.Provider,{value:d,children:[c&&d.visualElement?z.jsx(c,{visualElement:d.visualElement,...u}):null,n(r,a,pY(f,d.visualElement,l),f,h,d.visualElement)]})}const o=H.forwardRef(i);return o[yY]=r,o}function wY({layoutId:t}){const e=H.useContext(R4).id;return e&&t!==void 0?e+"-"+t:t}function vY(t,e){H.useContext(G4).strict}function SY(t){const{drag:e,layout:n}=eh;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const kY=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function JT(t){return typeof t!="string"||t.includes("-")?!1:!!(kY.indexOf(t)>-1||/[A-Z]/u.test(t))}function X4(t,{style:e,vars:n},s,r){Object.assign(t.style,e,r&&r.getProjectionStyles(s));for(const i in n)t.style.setProperty(i,n[i])}const Y4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Q4(t,e,n,s){X4(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(Y4.has(r)?r:ub(r),e.attrs[r])}function Z4(t,{layout:e,layoutId:n}){return Qa.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Ny[t]||t==="opacity")}function eI(t,e,n){var s;const{style:r}=t,i={};for(const o in r)(ts(r[o])||e.style&&ts(e.style[o])||Z4(o,t)||((s=n==null?void 0:n.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(i[o]=r[o]);return n&&r&&typeof r.willChange=="string"&&(n.applyWillChange=!1),i}function J4(t,e,n){const s=eI(t,e,n);for(const r in t)if(ts(t[r])||ts(e[r])){const i=gm.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=t[r]}return s}function CY(t){const e=H.useRef(null);return e.current===null&&(e.current=t()),e.current}function TY({applyWillChange:t=!1,scrapeMotionValuesFromProps:e,createRenderState:n,onMount:s},r,i,o,a){const l={latestValues:NY(r,i,o,a?!1:t,e),renderState:n()};return s&&(l.mount=c=>s(r,c,l)),l}const ez=t=>(e,n)=>{const s=H.useContext(db),r=H.useContext(YT),i=()=>TY(t,e,s,r,n);return n?i():CY(i)};function IY(t,e){const n=y4(e);n&&lb(t,n)}function gR(t,e,n){const s=Array.isArray(e)?e:[e];for(let r=0;r<s.length;r++){const i=RT(t,s[r]);if(i){const{transitionEnd:o,transition:a,...l}=i;n(l,o)}}}function NY(t,e,n,s,r){var i;const o={},a=[],l=s&&((i=t.style)===null||i===void 0?void 0:i.willChange)===void 0,c=r(t,{});for(const m in c)o[m]=_x(c[m]);let{initial:u,animate:h}=t;const d=fb(t),f=K4(t);e&&f&&!d&&t.inherit!==!1&&(u===void 0&&(u=e.initial),h===void 0&&(h=e.animate));let p=n?n.initial===!1:!1;p=p||u===!1;const g=p?h:u;return g&&typeof g!="boolean"&&!_p(g)&&gR(t,g,(m,x)=>{for(const y in m){let b=m[y];if(Array.isArray(b)){const w=p?b.length-1:0;b=b[w]}b!==null&&(o[y]=b)}for(const y in x)o[y]=x[y]}),l&&(h&&u!==!1&&!_p(h)&&gR(t,h,m=>{for(const x in m)IY(a,x)}),a.length&&(o.willChange=a.join(","))),o}const tI=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),tz=()=>({...tI(),attrs:{}}),nz=(t,e)=>e&&typeof t=="number"?e.transform(t):t,_Y={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},$Y=gm.length;function EY(t,e,n){let s="",r=!0;for(let i=0;i<$Y;i++){const o=gm[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=nz(a,VT[o]);if(!l){r=!1;const u=_Y[o]||o;s+=`${u}(${c}) `}n&&(e[o]=c)}}return s=s.trim(),n?s=n(e,r?"":s):r&&(s="none"),s}function nI(t,e,n){const{style:s,vars:r,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(Qa.has(l)){o=!0;continue}else if(zL(l)){r[l]=c;continue}else{const u=nz(c,VT[l]);l.startsWith("origin")?(a=!0,i[l]=u):s[l]=u}}if(e.transform||(o||n?s.transform=EY(e,t.transform,n):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;s.transformOrigin=`${l} ${c} ${u}`}}function xR(t,e,n){return typeof t=="string"?t:Se.transform(e+n*t)}function DY(t,e,n){const s=xR(e,t.x,t.width),r=xR(n,t.y,t.height);return`${s} ${r}`}const AY={offset:"stroke-dashoffset",array:"stroke-dasharray"},RY={offset:"strokeDashoffset",array:"strokeDasharray"};function OY(t,e,n=1,s=0,r=!0){t.pathLength=1;const i=r?AY:RY;t[i.offset]=Se.transform(-s);const o=Se.transform(e),a=Se.transform(n);t[i.array]=`${o} ${a}`}function sI(t,{attrX:e,attrY:n,attrScale:s,originX:r,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h){if(nI(t,c,h),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:f,dimensions:p}=t;d.transform&&(p&&(f.transform=d.transform),delete d.transform),p&&(r!==void 0||i!==void 0||f.transform)&&(f.transformOrigin=DY(p,r!==void 0?r:.5,i!==void 0?i:.5)),e!==void 0&&(d.x=e),n!==void 0&&(d.y=n),s!==void 0&&(d.scale=s),o!==void 0&&OY(d,o,a,l,!1)}const rI=t=>typeof t=="string"&&t.toLowerCase()==="svg",PY={useVisualState:ez({scrapeMotionValuesFromProps:J4,createRenderState:tz,onMount:(t,e,{renderState:n,latestValues:s})=>{st.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),st.render(()=>{sI(n,s,rI(e.tagName),t.transformTemplate),Q4(e,n)})}})},FY={useVisualState:ez({applyWillChange:!0,scrapeMotionValuesFromProps:eI,createRenderState:tI})};function sz(t,e,n){for(const s in e)!ts(e[s])&&!Z4(s,n)&&(t[s]=e[s])}function MY({transformTemplate:t},e){return H.useMemo(()=>{const n=tI();return nI(n,e,t),Object.assign({},n.vars,n.style)},[e])}function LY(t,e){const n=t.style||{},s={};return sz(s,n,t),Object.assign(s,MY(t,e)),s}function zY(t,e){const n={},s=LY(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}const BY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function _y(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||BY.has(t)}let rz=t=>!_y(t);function VY(t){t&&(rz=e=>e.startsWith("on")?!_y(e):t(e))}try{VY(require("@emotion/is-prop-valid").default)}catch{}function WY(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(rz(r)||n===!0&&_y(r)||!e&&!_y(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}function UY(t,e,n,s){const r=H.useMemo(()=>{const i=tz();return sI(i,e,rI(s),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};sz(i,t.style,t),r.style={...i,...r.style}}return r}function jY(t=!1){return(n,s,r,{latestValues:i},o)=>{const l=(JT(n)?UY:zY)(s,i,o,n),c=WY(s,typeof n=="string",t),u=n!==H.Fragment?{...c,...l,ref:r}:{},{children:h}=s,d=H.useMemo(()=>ts(h)?h.get():h,[h]);return H.createElement(n,{...u,children:d})}}function HY(t,e){return function(s,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...JT(s)?PY:FY,preloadedFeatures:t,useRender:jY(r),createVisualElement:e,Component:s};return bY(o)}}const vk={current:null},iz={current:!1};function GY(){if(iz.current=!0,!!ZT)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>vk.current=t.matches;t.addListener(e),e()}else vk.current=!1}function qY(t,e,n){for(const s in e){const r=e[s],i=n[s];if(ts(r))t.addValue(s,r);else if(ts(i))t.addValue(s,Ap(r,{owner:t}));else if(i!==r)if(t.hasValue(s)){const o=t.getValue(s);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=t.getStaticValue(s);t.addValue(s,Ap(o!==void 0?o:r,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const yR=new WeakMap,KY=[...WL,Xn,Ea],XY=t=>KY.find(VL(t)),bR=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],YY=PT.length;class QY{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},a={}){this.applyWillChange=!1,this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=zT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.isRenderScheduled=!1,this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.isRenderScheduled=!1,this.scheduleRender=()=>{this.isRenderScheduled||(this.isRenderScheduled=!0,st.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=fb(n),this.isVariantNode=K4(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const d in h){const f=h[d];l[d]!==void 0&&ts(f)&&f.set(l[d],!1)}}mount(e){this.current=e,yR.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),iz.current||GY(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:vk.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){yR.delete(this.current),this.projection&&this.projection.unmount(),wo(this.notifyUpdate),wo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=Qa.has(e),r=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&st.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{r(),i(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in eh){const n=eh[e];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[e]&&r&&s(this.props)&&(this.features[e]=new r(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Kt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<bR.length;s++){const r=bR[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=e[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=qY(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const s=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(s.initial=this.props.initial),s}const n={};for(let s=0;s<YY;s++){const r=PT[s],i=this.props[r];($p(i)||i===!1)&&(n[r]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Ap(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(ML(r)||FL(r))?r=parseFloat(r):!XY(r)&&Ea.test(n)&&(r=YL(e,n)),this.setBaseTarget(e,ts(r)?r.get():r)),ts(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const o=RT(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(r=o[e])}if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!ts(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new XT),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class oz extends QY{constructor(){super(...arguments),this.KeyframeResolver=QL}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}}function ZY(t){return window.getComputedStyle(t)}class JY extends oz{constructor(){super(...arguments),this.type="html",this.applyWillChange=!0,this.renderInstance=X4}readValueFromInstance(e,n){if(Qa.has(n)){const s=WT(n);return s&&s.default||0}else{const s=ZY(e),r=(zL(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return D4(e,n)}build(e,n,s){nI(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return eI(e,n,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ts(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}class eQ extends oz{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Kt}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Qa.has(n)){const s=WT(n);return s&&s.default||0}return n=Y4.has(n)?n:ub(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return J4(e,n,s)}build(e,n,s){sI(e,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,s,r){Q4(e,n,s,r)}mount(e){this.isSVGTag=rI(e.tagName),super.mount(e)}}const tQ=(t,e)=>JT(t)?new eQ(e):new JY(e,{allowProjection:t!==H.Fragment}),nQ=HY({...BK,...lY,...QX,...cY},tQ),sQ=P7(nQ);(function(t,e){for(var n=Da,s=t();;)try{var r=-parseInt(n(477))/1+parseInt(n(478))/2*(parseInt(n(483))/3)+parseInt(n(485))/4*(-parseInt(n(493))/5)+parseInt(n(467))/6*(-parseInt(n(472))/7)+-parseInt(n(488))/8*(-parseInt(n(468))/9)+-parseInt(n(476))/10+parseInt(n(465))/11*(parseInt(n(481))/12);if(r===e)break;s.push(s.shift())}catch{s.push(s.shift())}})($y,749152);function $y(){var t=["About Me","44342364GTFAoa","debu","417DXAnlR","apply","2304bnPuuO","string","length","96fwuqrH","#1a202c","input","test","style","7815BaHKCB","constructor","action","gger","while (true) {}","function *\\( *\\)","setProperty","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","11BsUKAW","mt-20 p-6 text-center text-white","14274vvXaQv","1026009DCZzRe","call","counter","text-4xl font-bold mb-4","2408ygEHPm","stateObject","init","I'm a machine learning engineer passionate about leveraging technology for a better future. I also enjoy music, especially classical piano, in my spare time.","11384930KVptQX","1477889mkzzBw","302SValaY","documentElement"];return $y=function(){return t},$y()}var rQ=function(){var t=!0;return function(e,n){var s=t?function(){var r=Da;if(n){var i=n[r(484)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();function Da(t,e){var n=$y();return Da=function(s,r){s=s-459;var i=n[s];return i},Da(t,e)}(function(){rQ(this,function(){var t=Da,e=new RegExp(t(461)),n=new RegExp(t(464),"i"),s=wR(t(474));!e[t(491)](s+t(463))||!n[t(491)](s+t(490))?s("0"):wR()})()})();function iQ(){var t=Da;return H.useEffect(()=>{var e=Da;document[e(479)][e(492)][e(462)]("--primary-color",e(489))},[]),z.jsxs("div",{className:t(466),children:[z.jsx(sQ.h1,{className:t(471),animate:{scale:[1,1.05,1]},transition:{duration:2,repeat:1/0},children:t(480)}),z.jsx("p",{className:"text-lg",children:t(475)})]})}function wR(t){function e(n){var s=Da;if(typeof n===s(486))return(function(r){})[s(494)](s(460))[s(484)](s(470));(""+n/n)[s(487)]!==1||n%20===0?(function(){return!0}).constructor(s(482)+s(459))[s(469)](s(495)):(function(){return!1})[s(494)]("debu"+s(459))[s(484)](s(473)),e(++n)}try{if(t)return e;e(0)}catch{}}const oQ="/assets/noblis_logo_dark_mode-u6tRUWOk.png",aQ="/assets/BU_logo-BbOsLxua.png",lQ="/assets/state_dept_logo-CbhS8uLj.png",rn=th;(function(t,e){const n=th,s=t();for(;;)try{if(parseInt(n(428))/1*(parseInt(n(389))/2)+parseInt(n(401))/3+parseInt(n(415))/4+-parseInt(n(407))/5*(-parseInt(n(405))/6)+parseInt(n(396))/7*(-parseInt(n(374))/8)+-parseInt(n(381))/9*(-parseInt(n(382))/10)+-parseInt(n(426))/11===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Ey,358600);const cQ=function(){let t=!0;return function(e,n){const s=t?function(){if(n){const r=n.apply(e,arguments);return n=null,r}}:function(){};return t=!1,s}}();function th(t,e){const n=Ey();return th=function(s,r){return s=s-372,n[s]},th(t,e)}(function(){cQ(this,function(){const t=th,e=new RegExp(t(433)),n=new RegExp(t(380),"i"),s=vR(t(420));!e[t(379)](s+t(427))||!n[t(379)](s+t(395))?s("0"):vR()})()})();function Ey(){const t=["Machine Learning Research Intern","1909590zMemdY","debu","June 2019 - August 2020","call","1722414wTSjza","mt-20 p-6 text-white","5szdaYP","roles","counter","div","mt-2 list-disc list-inside","Designed NLP model leveraging BERT for social media content moderation and analytics","September 2022 - Present","space-y-6","642396UAvWHh"," Logo","June 2024 - Present","Led research leveraging ML for malware attribution, presented results to C-suite and external clients","Managed graders","init","text-3xl font-bold","map","logo","title","Technical director for our LLM lab, managing new employees and upskilling developers to leverage LLMs in workflows across NRO, NASA, IRS, and other clients, resulting in increased automation","19102347sWXHJk","chain","490678gztwVm","bg-gray-800 p-6 rounded-lg","Led project implementing ViT for climate predictions leading to NOAA contract","apply","Automated data reorganization processes with Python and VBA, reducing processing times from months to days","function *\\( *\\)","length","company","September 2022 - December 2022","12488NzIFGW","space-y-8","string","Led tutorials and lectures in C++ and JavaScript","Developed full-stack LLM chatbot, fine-tuned LLaMA 3.1, and deployed in production on client hardware","test","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","13077fLRXSy","4580bDpHaW","action","Information Services Center, U.S. Embassy of Ottawa","Designed and implemented improved vision transformer architectures in PyTorch for meteorological predictions","text-sm text-gray-400","constructor","Principal Investigator","2uDpdop","description","img","Developed unit tests for assignments","Work Experience","Noblis","input","651sKadtu","gger","Machine Learning Engineer","flex items-center mb-4"];return Ey=function(){return t},Ey()}const uQ=[{company:rn(394),logo:oQ,roles:[{title:rn(398),duration:rn(417),description:[rn(430),rn(378),rn(425)]},{title:rn(388),duration:rn(413),description:[rn(418),rn(385),"Authored CVPR 2024 submission advancing multimodal object detection for computer vision"]},{title:rn(400),duration:"June 2022 - September 2022",description:["Optimized Python object detection pipeline for orchestrated networks of autonomous vehicles, reduced bandwidth usage by 87%"]}]},{company:"Boston University",logo:aQ,roles:[{title:"TA for ENG EC500, Software at Scale",duration:rn(373),description:[rn(377),rn(392),rn(419)]},{title:"Spark! Innovation Fellow",duration:"September 2022 - December 2022",description:[rn(412)]}]},{company:"State Department",logo:lQ,roles:[{title:rn(384),duration:rn(403),description:[rn(432)]}]}];function hQ(){const t=rn;return z.jsxs(t(410),{className:t(406),children:[z.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:t(393)}),z.jsx("div",{className:t(375),children:uQ.map((e,n)=>z.jsxs(t(410),{className:t(429),children:[z.jsxs("div",{className:t(399),children:[e[t(423)]&&z.jsx(t(391),{src:e[t(423)],alt:e[t(372)]+t(416),className:"w-12 h-12 mr-4 object-contain"}),z.jsx("h2",{className:t(421),children:e.company})]}),z.jsx(t(410),{className:t(414),children:e[t(408)].map((s,r)=>z.jsxs(t(410),{children:[z.jsx("h3",{className:"text-2xl font-semibold",children:s[t(424)]}),z.jsx("p",{className:t(386),children:s.duration}),z.jsx("ul",{className:t(411),children:s[t(390)][t(422)]((i,o)=>z.jsx("li",{children:i},o))})]},r))})]},n))})]})}function vR(t){function e(n){const s=th;if(typeof n===s(376))return(function(r){})[s(387)]("while (true) {}")[s(431)](s(409));(""+n/n)[s(434)]!==1||n%20===0?(function(){return!0})[s(387)]("debu"+s(397))[s(404)](s(383)):(function(){return!1})[s(387)](s(402)+"gger").apply("stateObject"),e(++n)}try{if(t)return e;e(0)}catch{}}const dQ="/assets/rps_splash-DWuzWn6E.webp",fQ="/assets/langcraft_splash-CCEZf5wB.png",wr=ic;(function(t,e){const n=ic,s=t();for(;;)try{if(-parseInt(n(452))/1+-parseInt(n(479))/2+parseInt(n(445))/3+-parseInt(n(489))/4*(parseInt(n(475))/5)+-parseInt(n(487))/6+-parseInt(n(461))/7+-parseInt(n(464))/8*(-parseInt(n(462))/9)===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Dy,979799);const pQ=function(){let t=!0;return function(e,n){const s=t?function(){const r=ic;if(n){const i=n[r(446)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){pQ(this,function(){const t=ic,e=new RegExp(t(488)),n=new RegExp(t(460),"i"),s=SR(t(490));!e[t(482)](s+"chain")||!n[t(482)](s+t(453))?s("0"):SR()})()})();const mQ=[{title:wr(443),description:wr(471),image:dQ,link:wr(447)},{title:wr(467),description:wr(478),image:fQ,link:wr(444)},{title:wr(466),description:"Achieved 2nd best accuracy in this machine learning competition using fine-tuned GPT-3 with RAG on web-scraped news.",image:"",link:wr(459)},{title:wr(474),description:wr(448),image:"",link:wr(449)}];function Dy(){const t=["4FYJYvF","init","div","grid grid-cols-1 md:grid-cols-2 gap-6","Rock Paper Infinity","https://github.com/user04f8/MineCompile","1465434sgATtQ","apply","https://rockpaperinfinity.com/","A trading bot that was the winning submission for Iddo Drori's deep learning stock market competition.","https://github.com/user04f8/TradeBot","Projects","while (true) {}","447938PeqFwS","input","gger","w-full h-48 object-cover rounded","string","debu","call","https://github.com/user04f8/autocast","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","9036713bcwZvs","100026pFYydl","length","3056XQaTTa","map","NeurIPS Autocast","MineCompile","constructor","noopener noreferrer","mt-20 p-6 text-white","Developed and deployed AI-powered game available at rockpaperinfinity.com in React powered by LLM backend.","stateObject","description","TradeBot","1956905hdFBNE","bg-gray-800 p-6 rounded-lg","image","A framework built in Python for auto-generating Minecraft datapack components; includes mal (MetaAutoLang), a language with parser and interpreter for code generation.","1489108tRbjQJ","title","text-2xl font-semibold mt-4","test","text-4xl font-bold mb-6 text-center","mt-2","text-blue-500 underline mt-2 block","link","5276370WvkiVO","function *\\( *\\)"];return Dy=function(){return t},Dy()}function ic(t,e){const n=Dy();return ic=function(s,r){return s=s-443,n[s]},ic(t,e)}function gQ(){const t=wr;return z.jsxs(t(491),{className:t(470),children:[z.jsx("h1",{className:t(483),children:t(450)}),z.jsx(t(491),{className:t(492),children:mQ[t(465)]((e,n)=>z.jsxs(t(491),{className:t(476),children:[e[t(477)]&&z.jsx("img",{src:e[t(477)],alt:e[t(480)],className:t(455)}),z.jsx("h2",{className:t(481),children:e[t(480)]}),z.jsx("p",{className:t(484),children:e[t(473)]}),z.jsx("a",{href:e[t(486)],target:"_blank",rel:t(469),className:t(485),children:"Visit Project"})]},n))})]})}function SR(t){function e(n){const s=ic;if(typeof n===s(456))return(function(r){})[s(468)](s(451))[s(446)]("counter");(""+n/n)[s(463)]!==1||n%20===0?(function(){return!0})[s(468)]("debu"+s(454))[s(458)]("action"):(function(){return!1})[s(468)](s(457)+s(454))[s(446)](s(472)),e(++n)}try{if(t)return e;e(0)}catch{}}var az={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},kR=ze.createContext&&ze.createContext(az),xQ=["attr","size","title"];function yQ(t,e){if(t==null)return{};var n=bQ(t,e),s,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)s=i[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function bQ(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function Ay(){return Ay=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ay.apply(this,arguments)}function CR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Ry(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?CR(Object(n),!0).forEach(function(s){wQ(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CR(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function wQ(t,e,n){return e=vQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vQ(t){var e=SQ(t,"string");return typeof e=="symbol"?e:e+""}function SQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lz(t){return t&&t.map((e,n)=>ze.createElement(e.tag,Ry({key:n},e.attr),lz(e.child)))}function li(t){return e=>ze.createElement(kQ,Ay({attr:Ry({},t.attr)},e),lz(t.child))}function kQ(t){var e=n=>{var{attr:s,size:r,title:i}=t,o=yQ(t,xQ),a=r||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),ze.createElement("svg",Ay({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,o,{className:l,style:Ry(Ry({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),i&&ze.createElement("title",null,i),t.children)};return kR!==void 0?ze.createElement(kR.Consumer,null,n=>e(n)):e(az)}function CQ(t){return li({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(t)}function TQ(t){return li({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"},child:[]}]})(t)}function IQ(t){return li({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(t)}function NQ(t){return li({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 76v360c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12V284.1L276.5 440.6c-20.6 17.2-52.5 2.8-52.5-24.6V284.1L52.5 440.6C31.9 457.8 0 443.4 0 416V96c0-27.4 31.9-41.7 52.5-24.6L224 226.8V96c0-27.4 31.9-41.7 52.5-24.6L448 226.8V76c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12z"},child:[]}]})(t)}function _Q(t){return li({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"},child:[]}]})(t)}function $Q(t){return li({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"},child:[]}]})(t)}function EQ(t){return li({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M500.33 0h-47.41a12 12 0 0 0-12 12.57l4 82.76A247.42 247.42 0 0 0 256 8C119.34 8 7.9 119.53 8 256.19 8.1 393.07 119.1 504 256 504a247.1 247.1 0 0 0 166.18-63.91 12 12 0 0 0 .48-17.43l-34-34a12 12 0 0 0-16.38-.55A176 176 0 1 1 402.1 157.8l-101.53-4.87a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12h200.33a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12z"},child:[]}]})(t)}function DQ(t){return li({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(t)}function AQ(t){return li({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(t)}function RQ(t){return li({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"},child:[]}]})(t)}function OQ(t){return li({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"},child:[]}]})(t)}function Oy(){var t=["noopener noreferrer","test","https://www.linkedin.com/in/nathan-clark-409719207/","gger","nc9241@gmail.com","LinkedIn","apply","https://github.com/user04f8","GitHub","2310kPERkn","constructor","1436676FZEyxp","function *\\( *\\)","2804472pODhiS","input","3447185FqiWDT","while (true) {}","5948202WQynYu","691410lfEetH","chain","_blank","flex items-center justify-center space-x-2 text-lg hover:text-gray-400","call","space-y-4","div","1YnuHlE","Contact Me","mt-20 p-6 text-center text-white","text-4xl font-bold mb-6","960ypucKh","span","string","stateObject","15563160wHVDuE","debu"];return Oy=function(){return t},Oy()}(function(t,e){for(var n=nh,s=t();;)try{var r=-parseInt(n(202))/1*(parseInt(n(223))/2)+parseInt(n(195))/3+parseInt(n(206))/4*(parseInt(n(221))/5)+-parseInt(n(194))/6+parseInt(n(192))/7+-parseInt(n(225))/8+parseInt(n(210))/9;if(r===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Oy,502781);var PQ=function(){var t=!0;return function(e,n){var s=t?function(){if(n){var r=n.apply(e,arguments);return n=null,r}}:function(){};return t=!1,s}}();(function(){PQ(this,function(){var t=nh,e=new RegExp(t(224)),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=TR("init");!e[t(213)](s+t(196))||!n[t(213)](s+t(191))?s("0"):TR()})()})();function nh(t,e){var n=Oy();return nh=function(s,r){s=s-191;var i=n[s];return i},nh(t,e)}function FQ(){var t=nh;return z.jsxs(t(201),{className:t(204),children:[z.jsx("h1",{className:t(205),children:t(203)}),z.jsxs(t(201),{className:t(200),children:[z.jsxs("a",{href:"mailto:nc9241+fromwebsite@gmail.com",className:"flex items-center justify-center space-x-2 text-lg hover:text-gray-400",children:[z.jsx(IQ,{}),z.jsx(t(207),{children:t(216)})]}),z.jsxs("a",{href:t(219),target:t(197),rel:"noopener noreferrer",className:t(198),children:[z.jsx(CQ,{}),z.jsx("span",{children:t(220)})]}),z.jsxs("a",{href:t(214),target:t(197),rel:t(212),className:"flex items-center justify-center space-x-2 text-lg hover:text-gray-400",children:[z.jsx(TQ,{}),z.jsx(t(207),{children:t(217)})]})]})]})}function TR(t){function e(n){var s=nh;if(typeof n===s(208))return(function(r){}).constructor(s(193))[s(218)]("counter");(""+n/n).length!==1||n%20===0?(function(){return!0})[s(222)]("debu"+s(215))[s(199)]("action"):(function(){return!1})[s(222)](s(211)+"gger").apply(s(209)),e(++n)}try{if(t)return e;e(0)}catch{}}function vo(t,e){const n=Py();return vo=function(s,r){return s=s-148,n[s]},vo(t,e)}const fn=vo;function Py(){const t=["push","constructor","floor","FarthestFirst","string","init","distance","Manual","assignPointsToClusters","69mBdGgc","Farthest First","pow","3743288AIDPZr","filter","point","sort","Unknown initialization method","min","action","5043355izUUJk","call","Random","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","getCentroids","2060538SJovJk","apply","reduce","parse","random","map","test","gger","input","length","12IPMVRJ","sqrt","KMeansPlusPlus","euclideanDistance","points","stringify","kMeansPlusPlusInitialization","KMeans++","forEach","hasConverged","debu","farthestFirstInitialization","4970eeBfHX","stateObject","iterate","784130XwCDGk","randomInitialization","cluster","centroids","1677664zaHRgl","slice","1654520sSTePK","initializationMethod","27wdjFCv","initializeCentroids","counter"];return Py=function(){return t},Py()}(function(t,e){const n=vo,s=t();for(;;)try{if(parseInt(n(201))/1*(parseInt(n(178))/2)+-parseInt(n(156))/3+parseInt(n(204))/4+parseInt(n(151))/5+-parseInt(n(166))/6*(parseInt(n(187))/7)+-parseInt(n(185))/8+parseInt(n(189))/9*(-parseInt(n(181))/10)===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Py,511445);const MQ=function(){let t=!0;return function(e,n){const s=t?function(){const r=vo;if(n){const i=n[r(157)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){MQ(this,function(){const t=vo,e=new RegExp("function *\\( *\\)"),n=new RegExp(t(154),"i"),s=NR(t(197));!e.test(s+"chain")||!n[t(162)](s+t(164))?s("0"):NR()})()})();var Tr=(t=>{const e=vo;return t[e(153)]=e(153),t[e(195)]=e(202),t[e(168)]="KMeans++",t.Manual=e(199),t})(Tr||{});class IR{constructor(e,n,s){const r=vo;this.k=e,this[r(170)]=n,this[r(188)]=s,this[r(184)]=[]}[fn(190)](){const e=fn;switch(this[e(188)]){case"Random":this.randomInitialization();break;case e(202):this[e(177)]();break;case e(173):this[e(172)]();break;case e(199):break;default:throw new Error(e(148))}}[fn(182)](){const e=fn,n=[...this[e(170)]][e(207)](()=>.5-Math.random());this[e(184)]=n[e(186)](0,this.k).map(s=>({x:s.x,y:s.y}))}[fn(177)](){const e=fn,n=[],s=this[e(170)][Math[e(194)](Math[e(160)]()*this[e(170)][e(165)])];for(n[e(192)]({x:s.x,y:s.y});n[e(165)]<this.k;){const r=this.points.map(o=>{const a=e,l=Math[a(149)](...n[a(161)](c=>this[a(169)](o,c)));return{point:o,distance:l}}),i=r[e(158)]((o,a)=>a[e(198)]>o[e(198)]?a:o);n.push({x:i[e(206)].x,y:i[e(206)].y})}this[e(184)]=n}[fn(172)](){const e=fn,n=[],s=this[e(170)][Math[e(194)](Math[e(160)]()*this.points.length)];for(n[e(192)]({x:s.x,y:s.y});n[e(165)]<this.k;){const r=this.points[e(161)](c=>{const u=e;return Math[u(149)](...n[u(161)](d=>Math.pow(this[u(169)](c,d),2)))}),i=r[e(158)]((c,u)=>c+u,0),o=r[e(161)](c=>c/i);let a=0;const l=Math[e(160)]();for(let c=0;c<o[e(165)];c++)if(a+=o[c],l<a){const u=this[e(170)][c];n[e(192)]({x:u.x,y:u.y});break}}this[e(184)]=n}euclideanDistance(e,n){const s=fn;return Math[s(167)](Math[s(203)](e.x-n.x,2)+Math.pow(e.y-n.y,2))}[fn(200)](){const e=fn;this[e(170)][e(174)](n=>{const s=e;let r=1/0,i=-1;this[s(184)][s(174)]((o,a)=>{const l=this.euclideanDistance(n,o);l<r&&(r=l,i=a)}),n.cluster=i})}updateCentroids(){const e=fn;this.centroids=this[e(184)][e(161)]((n,s)=>{const r=e,i=this[r(170)][r(205)](c=>c[r(183)]===s),o=i[r(165)];if(o===0)return this[r(184)][s];const a=i[r(158)]((c,u)=>c+u.x,0),l=i.reduce((c,u)=>c+u.y,0);return{x:a/o,y:l/o}})}[fn(175)](e,n){const s=fn;for(let r=0;r<e[s(165)];r++)if(this[s(169)](e[r],n[r])>1e-6)return!1;return!0}[fn(180)](){const e=fn,n=JSON[e(159)](JSON[e(171)](this[e(184)]));return this.assignPointsToClusters(),this.updateCentroids(),this[e(175)](n,this[e(184)])}[fn(155)](){return this[fn(184)]}getPoints(){return this[fn(170)]}}function NR(t){function e(n){const s=vo;if(typeof n===s(196))return(function(r){})[s(193)]("while (true) {}")[s(157)](s(191));(""+n/n)[s(165)]!==1||n%20===0?(function(){return!0})[s(193)](s(176)+s(163))[s(152)](s(150)):(function(){return!1})[s(193)](s(176)+s(163))[s(157)](s(179)),e(++n)}try{if(t)return e;e(0)}catch{}}(function(t,e){const n=oc,s=t();for(;;)try{if(parseInt(n(195))/1*(parseInt(n(231))/2)+-parseInt(n(204))/3+-parseInt(n(238))/4*(parseInt(n(192))/5)+parseInt(n(219))/6+parseInt(n(218))/7+-parseInt(n(198))/8*(-parseInt(n(248))/9)+-parseInt(n(215))/10*(parseInt(n(251))/11)===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Fy,223173);const LQ=function(){let t=!0;return function(e,n){const s=t?function(){const r=oc;if(n){const i=n[r(203)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){LQ(this,function(){const t=oc,e=new RegExp(t(209)),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=_R(t(210));!e[t(196)](s+t(245))||!n[t(196)](s+t(242))?s("0"):_R()})()})();function Fy(){const t=["apply","364653ctPXoQ","gger","label","flex flex-col md:flex-row md:items-center md:justify-between mb-4","text-sm text-gray-600","function *\\( *\\)","init","div","border rounded px-2 py-1","distribution","Play","8470Swqkmp","length","bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition-colors duration-200 mb-2 flex items-center","1974385rDMDlE","527346MkPUqA","call","values","target","debu","Step","mr-2","Initialization Method:","Click on the visualization to add centroids. Added Centroids: ","border rounded px-2 py-1 w-24","button","bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 w-full max-w-3xl","56766wlhvwG","map","bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors duration-200 mb-2 flex items-center","Gaussian","option","number","border rounded px-2 py-1 w-20","1390408WRAOrb","while (true) {}","flex flex-wrap justify-center space-x-4","Manual","input","Number of Points:","Reset","chain","counter","stateObject","1025397LqVZZy","Pause","select","979Bglapy","numPoints","initMethod","Converge","flex items-center space-x-4 mb-4 md:mb-0","flex flex-col items-center mb-6","font-semibold text-gray-700","5qLSCMt","bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-colors duration-200 mb-2 flex items-center","value","10KEXyPs","test","gaussian","8jDNCpx","string","bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors duration-200 mb-2 flex items-center","Number of Clusters (k):","constructor"];return Fy=function(){return t},Fy()}function oc(t,e){const n=Fy();return oc=function(s,r){return s=s-188,n[s]},oc(t,e)}const zQ=({initializationMethod:t,onInitializationMethodChange:e,onNewDataset:n,onStep:s,onConverge:r,onReset:i,onPlay:o,onPause:a,isPlaying:l,k:c,setK:u,manualCentroids:h,numPoints:d,setNumPoints:f,distribution:p,setDistribution:g})=>{const m=oc;return z.jsx(m(211),{className:m(190),children:z.jsxs(m(211),{className:m(230),children:[z.jsxs(m(211),{className:m(207),children:[z.jsxs(m(211),{className:m(189),children:[z.jsx(m(206),{htmlFor:"numPoints",className:"font-semibold text-gray-700",children:m(243)}),z.jsx(m(242),{type:m(236),id:m(252),value:d,onChange:x=>f(Number(x[m(222)][m(194)])),className:m(228),min:10})]}),z.jsxs("div",{className:m(189),children:[z.jsx(m(206),{htmlFor:m(213),className:"font-semibold text-gray-700",children:"Distribution:"}),z.jsxs(m(250),{id:"distribution",value:p,onChange:x=>g(x[m(222)].value),className:m(212),children:[z.jsx(m(235),{value:"uniform",children:"Uniform"}),z.jsx(m(235),{value:m(197),children:m(234)})]})]})]}),z.jsxs("div",{className:m(207),children:[z.jsxs(m(211),{className:m(189),children:[z.jsx(m(206),{htmlFor:"k",className:"font-semibold text-gray-700",children:m(201)}),z.jsx(m(242),{type:m(236),id:"k",value:t===Tr[m(241)]?h[m(216)]:c,onChange:x=>u(Number(x.target[m(194)])),className:m(237),min:1,disabled:t===Tr.Manual})]}),z.jsxs("div",{className:"flex items-center space-x-4",children:[z.jsx(m(206),{htmlFor:m(253),className:m(191),children:m(226)}),z.jsx(m(250),{id:m(253),value:t,onChange:x=>e(x[m(222)][m(194)]),className:m(212),children:Object[m(221)](Tr)[m(232)](x=>z.jsx(m(235),{value:x,children:x},x))})]})]}),t===Tr.Manual&&z.jsxs("p",{className:m(208),children:[m(227),h[m(216)]]}),z.jsxs("div",{className:m(240),children:[z.jsxs("button",{onClick:n,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors duration-200 mb-2 flex items-center",children:[z.jsx(OQ,{className:m(225)}),"New Dataset"]}),z.jsxs(m(229),{onClick:s,className:m(193),children:[z.jsx(RQ,{className:m(225)}),m(224)]}),l?z.jsxs("button",{onClick:a,className:"bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition-colors duration-200 mb-2 flex items-center",children:[z.jsx(_Q,{className:"mr-2"}),m(249)]}):z.jsxs(m(229),{onClick:o,className:m(217),children:[z.jsx($Q,{className:m(225)}),m(214)]}),z.jsxs(m(229),{onClick:r,className:m(200),children:[z.jsx(NQ,{className:m(225)}),m(188)]}),z.jsxs(m(229),{onClick:i,className:m(233),children:[z.jsx(EQ,{className:m(225)}),m(244)]})]})]})})};function _R(t){function e(n){const s=oc;if(typeof n===s(199))return(function(r){}).constructor(s(239))[s(203)](s(246));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(202)](s(223)+s(205))[s(220)]("action"):(function(){return!1})[s(202)](s(223)+"gger").apply(s(247)),e(++n)}try{if(t)return e;e(0)}catch{}}function ac(t,e){const n=My();return ac=function(s,r){return s=s-279,n[s]},ac(t,e)}const Ts=ac;(function(t,e){const n=ac,s=t();for(;;)try{if(parseInt(n(314))/1*(parseInt(n(316))/2)+parseInt(n(279))/3+parseInt(n(299))/4*(parseInt(n(302))/5)+-parseInt(n(298))/6*(-parseInt(n(295))/7)+parseInt(n(311))/8*(-parseInt(n(284))/9)+parseInt(n(310))/10+-parseInt(n(291))/11===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(My,634990);const BQ=function(){let t=!0;return function(e,n){const s=t?function(){const r=ac;if(n){const i=n[r(293)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();function My(){const t=["#652074","#61726B","test","5352723BhhrdB","debu","chain","gger","counter","#746F6C","function *\\( *\\)","32362814SGfQzF","#492073","apply","stateObject","565453MtuFFF","#4E6174","#f032e6","42WxXCvz","24JHqyZH","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#20436C","974735BxCLZB","while (true) {}","#3cb44b","length","#206672","#6F6D20","#68616E","#e6194b","7274430ARurrf","16cLxtBK","#911eb4","action","29vhNfFm","call","82016mYEYzz","#d2f53c","3344244oxWHqb","constructor"];return My=function(){return t},My()}(function(){BQ(this,function(){const t=ac,e=new RegExp(t(290)),n=new RegExp(t(300),"i"),s=$R("init");!e[t(283)](s+t(286))||!n.test(s+"input")?s("0"):$R()})()})();const Du=[Ts(309),Ts(304),"#0082c8","#f58231",Ts(312),"#46f0f0",Ts(297),Ts(317),"#fabebe","#008080",Ts(292),Ts(289),Ts(281),"#686973",Ts(306),Ts(307),Ts(296),Ts(308),Ts(301),Ts(282)];function $R(t){function e(n){const s=ac;if(typeof n=="string")return(function(r){})[s(280)](s(303))[s(293)](s(288));(""+n/n)[s(305)]!==1||n%20===0?(function(){return!0})[s(280)](s(285)+s(287))[s(315)](s(313)):(function(){return!1})[s(280)](s(285)+"gger")[s(293)](s(294)),e(++n)}try{if(t)return e;e(0)}catch{}}(function(t,e){const n=Aa,s=t();for(;;)try{if(-parseInt(n(490))/1*(parseInt(n(491))/2)+parseInt(n(511))/3*(parseInt(n(475))/4)+-parseInt(n(478))/5*(-parseInt(n(501))/6)+parseInt(n(485))/7*(-parseInt(n(488))/8)+-parseInt(n(476))/9+parseInt(n(480))/10+parseInt(n(487))/11===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Ly,585571);function Aa(t,e){const n=Ly();return Aa=function(s,r){return s=s-475,n[s]},Aa(t,e)}const VQ=function(){let t=!0;return function(e,n){const s=t?function(){const r=Aa;if(n){const i=n[r(482)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){VQ(this,function(){const t=Aa,e=new RegExp("function *\\( *\\)"),n=new RegExp(t(515),"i"),s=ER(t(495));!e[t(499)](s+t(510))||!n[t(499)](s+t(509))?s("0"):ER()})()})();const WQ=({points:t,centroids:e,onCentroidAdd:n,initializationMethod:s})=>{const r=Aa,i=40,o=a=>{const l=Aa;if(s!==Tr[l(477)]||!n)return;const c=a.currentTarget,u=c.getBoundingClientRect(),h=600/u[l(514)],d=600/u[l(496)],f=(a[l(497)]-u.left-i)*h,p=(a[l(483)]-u[l(507)]-i)*d;n({x:f/(600-2*i),y:p/(600-2*i)})};return z.jsx(r(504),{className:r(486),children:z.jsxs(r(489),{viewBox:r(508),className:r(502),onClick:o,children:[z.jsx(r(494),{width:r(513),height:r(513),fill:"white"}),t[r(481)]((a,l)=>z.jsx(r(479),{cx:i+a.x*(600-2*i),cy:i+a.y*(600-2*i),r:4,fill:a[r(506)]!==void 0?Du[a.cluster%Du.length]:r(500)},l)),e[r(481)]((a,l)=>z.jsx(r(479),{className:r(484),cx:i+a.x*(600-2*i),cy:i+a.y*(600-2*i),r:10,fill:Du[l%Du[r(492)]],stroke:"#000",strokeWidth:2},l))]})})};function Ly(){const t=["length","constructor","rect","init","height","clientX","while (true) {}","test","#aaaaaa","6054JvcLDA","border border-gray-400 w-full h-auto max-w-3xl bg-white rounded-lg shadow-md","stateObject","div","gger","cluster","top","0 0 600 600","input","chain","21iIImac","action","600","width","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","232132wwtnyH","8423136UxNSYS","Manual","2465bMavTC","circle","4466050uBKlbN","map","apply","clientY","centroid","147fEmYGJ","flex justify-center items-center w-full","12212563hehuLg","65432Aovypa","svg","383636qouvWZ","4eaDjJj"];return Ly=function(){return t},Ly()}function ER(t){function e(n){const s=Aa;if(typeof n=="string")return(function(r){})[s(493)](s(498))[s(482)]("counter");(""+n/n).length!==1||n%20===0?(function(){return!0})[s(493)]("debu"+s(505)).call(s(512)):(function(){return!1})[s(493)]("debu"+s(505))[s(482)](s(503)),e(++n)}try{if(t)return e;e(0)}catch{}}(function(t,e){const n=lc,s=t();for(;;)try{if(-parseInt(n(175))/1+-parseInt(n(171))/2+parseInt(n(192))/3*(-parseInt(n(189))/4)+parseInt(n(188))/5+parseInt(n(184))/6*(-parseInt(n(166))/7)+-parseInt(n(182))/8+-parseInt(n(164))/9*(-parseInt(n(170))/10)===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(zy,677825);const UQ=function(){let t=!0;return function(e,n){const s=t?function(){const r=lc;if(n){const i=n[r(162)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){UQ(this,function(){const t=lc,e=new RegExp(t(180)),n=new RegExp(t(160),"i"),s=DR(t(177));!e[t(181)](s+t(190))||!n[t(181)](s+t(183))?s("0"):DR()})()})();const jQ=({k:t})=>{const e=lc;return z.jsx(e(178),{className:"flex justify-center mt-4 flex-wrap",children:Array[e(172)]({length:t}).map((n,s)=>z.jsxs(e(178),{className:e(163),children:[z.jsx(e(178),{className:e(179),style:{backgroundColor:Du[s%Du.length],border:e(168)}}),z.jsxs(e(191),{className:e(161),children:[e(169),s+1]})]},s))})};function lc(t,e){const n=zy();return lc=function(s,r){return s=s-160,n[s]},lc(t,e)}function zy(){const t=["1367160DfyMMT","206004gwATfk","chain","span","30OXqKLM","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","text-gray-200","apply","flex items-center mr-4 mb-2","125379bYfKOF","length","1106gVKcnW","string","1px solid black","Cluster ","2330iXruyE","1217728tgQQaR","from","stateObject","gger","352450IYvOhU","counter","init","div","w-4 h-4 mr-1 rounded","function *\\( *\\)","test","9887696keRTfT","input","4908VcBnuS","while (true) {}","debu","constructor"];return zy=function(){return t},zy()}function DR(t){function e(n){const s=lc;if(typeof n===s(167))return(function(r){})[s(187)](s(185))[s(162)](s(176));(""+n/n)[s(165)]!==1||n%20===0?(function(){return!0})[s(187)]("debu"+s(174)).call("action"):(function(){return!1})[s(187)](s(186)+"gger")[s(162)](s(173)),e(++n)}try{if(t)return e;e(0)}catch{}}function cz(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=cz(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function ra(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=cz(t))&&(s&&(s+=" "),s+=e);return s}const Rp=t=>typeof t=="number"&&!isNaN(t),Hl=t=>typeof t=="string",nr=t=>typeof t=="function",$x=t=>Hl(t)||nr(t)?t:null,Sk=t=>H.isValidElement(t)||Hl(t)||nr(t)||Rp(t);function HQ(t,e,n){n===void 0&&(n=300);const{scrollHeight:s,style:r}=t;requestAnimationFrame(()=>{r.minHeight="initial",r.height=s+"px",r.transition=`all ${n}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(e,n)})})}function pb(t){let{enter:e,exit:n,appendPosition:s=!1,collapse:r=!0,collapseDuration:i=300}=t;return function(o){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:d,playToast:f}=o;const p=s?`${e}--${l}`:e,g=s?`${n}--${l}`:n,m=H.useRef(0);return H.useLayoutEffect(()=>{const x=h.current,y=p.split(" "),b=w=>{w.target===h.current&&(f(),x.removeEventListener("animationend",b),x.removeEventListener("animationcancel",b),m.current===0&&w.type!=="animationcancel"&&x.classList.remove(...y))};x.classList.add(...y),x.addEventListener("animationend",b),x.addEventListener("animationcancel",b)},[]),H.useEffect(()=>{const x=h.current,y=()=>{x.removeEventListener("animationend",y),r?HQ(x,u,i):u()};d||(c?y():(m.current=1,x.className+=` ${g}`,x.addEventListener("animationend",y)))},[d]),ze.createElement(ze.Fragment,null,a)}}function AR(t,e){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:e}:{}}const fs=new Map;let Op=[];const kk=new Set,GQ=t=>kk.forEach(e=>e(t)),uz=()=>fs.size>0;function hz(t,e){var n;if(e)return!((n=fs.get(e))==null||!n.isToastActive(t));let s=!1;return fs.forEach(r=>{r.isToastActive(t)&&(s=!0)}),s}function dz(t,e){Sk(t)&&(uz()||Op.push({content:t,options:e}),fs.forEach(n=>{n.buildToast(t,e)}))}function RR(t,e){fs.forEach(n=>{e!=null&&e!=null&&e.containerId?(e==null?void 0:e.containerId)===n.id&&n.toggle(t,e==null?void 0:e.id):n.toggle(t,e==null?void 0:e.id)})}function qQ(t){const{subscribe:e,getSnapshot:n,setProps:s}=H.useRef(function(i){const o=i.containerId||1;return{subscribe(a){const l=function(u,h,d){let f=1,p=0,g=[],m=[],x=[],y=h;const b=new Map,w=new Set,v=()=>{x=Array.from(b.values()),w.forEach(k=>k())},S=k=>{m=k==null?[]:m.filter(I=>I!==k),v()},T=k=>{const{toastId:I,onOpen:_,updateId:D,children:A}=k.props,L=D==null;k.staleId&&b.delete(k.staleId),b.set(I,k),m=[...m,k.props.toastId].filter(B=>B!==k.staleId),v(),d(AR(k,L?"added":"updated")),L&&nr(_)&&_(H.isValidElement(A)&&A.props)};return{id:u,props:y,observe:k=>(w.add(k),()=>w.delete(k)),toggle:(k,I)=>{b.forEach(_=>{I!=null&&I!==_.props.toastId||nr(_.toggle)&&_.toggle(k)})},removeToast:S,toasts:b,clearQueue:()=>{p-=g.length,g=[]},buildToast:(k,I)=>{if((Z=>{let{containerId:ee,toastId:te,updateId:ne}=Z;const ie=ee?ee!==u:u!==1,ce=b.has(te)&&ne==null;return ie||ce})(I))return;const{toastId:_,updateId:D,data:A,staleId:L,delay:B}=I,F=()=>{S(_)},R=D==null;R&&p++;const O={...y,style:y.toastStyle,key:f++,...Object.fromEntries(Object.entries(I).filter(Z=>{let[ee,te]=Z;return te!=null})),toastId:_,updateId:D,data:A,closeToast:F,isIn:!1,className:$x(I.className||y.toastClassName),bodyClassName:$x(I.bodyClassName||y.bodyClassName),progressClassName:$x(I.progressClassName||y.progressClassName),autoClose:!I.isLoading&&(E=I.autoClose,V=y.autoClose,E===!1||Rp(E)&&E>0?E:V),deleteToast(){const Z=b.get(_),{onClose:ee,children:te}=Z.props;nr(ee)&&ee(H.isValidElement(te)&&te.props),d(AR(Z,"removed")),b.delete(_),p--,p<0&&(p=0),g.length>0?T(g.shift()):v()}};var E,V;O.closeButton=y.closeButton,I.closeButton===!1||Sk(I.closeButton)?O.closeButton=I.closeButton:I.closeButton===!0&&(O.closeButton=!Sk(y.closeButton)||y.closeButton);let G=k;H.isValidElement(k)&&!Hl(k.type)?G=H.cloneElement(k,{closeToast:F,toastProps:O,data:A}):nr(k)&&(G=k({closeToast:F,toastProps:O,data:A}));const Y={content:G,props:O,staleId:L};y.limit&&y.limit>0&&p>y.limit&&R?g.push(Y):Rp(B)?setTimeout(()=>{T(Y)},B):T(Y)},setProps(k){y=k},setToggle:(k,I)=>{b.get(k).toggle=I},isToastActive:k=>m.some(I=>I===k),getSnapshot:()=>y.newestOnTop?x.reverse():x}}(o,i,GQ);fs.set(o,l);const c=l.observe(a);return Op.forEach(u=>dz(u.content,u.options)),Op=[],()=>{c(),fs.delete(o)}},setProps(a){var l;(l=fs.get(o))==null||l.setProps(a)},getSnapshot(){var a;return(a=fs.get(o))==null?void 0:a.getSnapshot()}}}(t)).current;s(t);const r=H.useSyncExternalStore(e,n,n);return{getToastToRender:function(i){if(!r)return[];const o=new Map;return r.forEach(a=>{const{position:l}=a.props;o.has(l)||o.set(l,[]),o.get(l).push(a)}),Array.from(o,a=>i(a[0],a[1]))},isToastActive:hz,count:r==null?void 0:r.length}}function KQ(t){const[e,n]=H.useState(!1),[s,r]=H.useState(!1),i=H.useRef(null),o=H.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:c,onClick:u,closeOnClick:h}=t;var d,f;function p(){n(!0)}function g(){n(!1)}function m(b){const w=i.current;o.canDrag&&w&&(o.didMove=!0,e&&g(),o.delta=t.draggableDirection==="x"?b.clientX-o.start:b.clientY-o.start,o.start!==b.clientX&&(o.canCloseOnClick=!1),w.style.transform=`translate3d(${t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`},0)`,w.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function x(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",x);const b=i.current;if(o.canDrag&&o.didMove&&b){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return r(!0),t.closeToast(),void t.collapseAll();b.style.transition="transform 0.2s, opacity 0.2s",b.style.removeProperty("transform"),b.style.removeProperty("opacity")}}(f=fs.get((d={id:t.toastId,containerId:t.containerId,fn:n}).containerId||1))==null||f.setToggle(d.id,d.fn),H.useEffect(()=>{if(t.pauseOnFocusLoss)return document.hasFocus()||g(),window.addEventListener("focus",p),window.addEventListener("blur",g),()=>{window.removeEventListener("focus",p),window.removeEventListener("blur",g)}},[t.pauseOnFocusLoss]);const y={onPointerDown:function(b){if(t.draggable===!0||t.draggable===b.pointerType){o.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",x);const w=i.current;o.canCloseOnClick=!0,o.canDrag=!0,w.style.transition="none",t.draggableDirection==="x"?(o.start=b.clientX,o.removalDistance=w.offsetWidth*(t.draggablePercent/100)):(o.start=b.clientY,o.removalDistance=w.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent)/100)}},onPointerUp:function(b){const{top:w,bottom:v,left:S,right:T}=i.current.getBoundingClientRect();b.nativeEvent.type!=="touchend"&&t.pauseOnHover&&b.clientX>=S&&b.clientX<=T&&b.clientY>=w&&b.clientY<=v?g():p()}};return a&&l&&(y.onMouseEnter=g,t.stacked||(y.onMouseLeave=p)),h&&(y.onClick=b=>{u&&u(b),o.canCloseOnClick&&c()}),{playToast:p,pauseToast:g,isRunning:e,preventExitTransition:s,toastRef:i,eventHandlers:y}}function XQ(t){let{delay:e,isRunning:n,closeToast:s,type:r="default",hide:i,className:o,style:a,controlledProgress:l,progress:c,rtl:u,isIn:h,theme:d}=t;const f=i||l&&c===0,p={...a,animationDuration:`${e}ms`,animationPlayState:n?"running":"paused"};l&&(p.transform=`scaleX(${c})`);const g=ra("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":u}),m=nr(o)?o({rtl:u,type:r,defaultClassName:g}):ra(g,o),x={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{h&&s()}};return ze.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},ze.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${r}`}),ze.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:m,style:p,...x}))}let YQ=1;const fz=()=>""+YQ++;function QQ(t){return t&&(Hl(t.toastId)||Rp(t.toastId))?t.toastId:fz()}function Zf(t,e){return dz(t,e),e.toastId}function By(t,e){return{...e,type:e&&e.type||t,toastId:QQ(e)}}function P0(t){return(e,n)=>Zf(e,By(t,n))}function Le(t,e){return Zf(t,By("default",e))}Le.loading=(t,e)=>Zf(t,By("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),Le.promise=function(t,e,n){let s,{pending:r,error:i,success:o}=e;r&&(s=Hl(r)?Le.loading(r,n):Le.loading(r.render,{...n,...r}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,h,d)=>{if(h==null)return void Le.dismiss(s);const f={type:u,...a,...n,data:d},p=Hl(h)?{render:h}:h;return s?Le.update(s,{...f,...p}):Le(p.render,{...f,...p}),d},c=nr(t)?t():t;return c.then(u=>l("success",o,u)).catch(u=>l("error",i,u)),c},Le.success=P0("success"),Le.info=P0("info"),Le.error=P0("error"),Le.warning=P0("warning"),Le.warn=Le.warning,Le.dark=(t,e)=>Zf(t,By("default",{theme:"dark",...e})),Le.dismiss=function(t){(function(e){var n;if(uz()){if(e==null||Hl(n=e)||Rp(n))fs.forEach(s=>{s.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){const s=fs.get(e.containerId);s?s.removeToast(e.id):fs.forEach(r=>{r.removeToast(e.id)})}}else Op=Op.filter(s=>e!=null&&s.options.toastId!==e)})(t)},Le.clearWaitingQueue=function(t){t===void 0&&(t={}),fs.forEach(e=>{!e.props.limit||t.containerId&&e.id!==t.containerId||e.clearQueue()})},Le.isActive=hz,Le.update=function(t,e){e===void 0&&(e={});const n=((s,r)=>{var i;let{containerId:o}=r;return(i=fs.get(o||1))==null?void 0:i.toasts.get(s)})(t,e);if(n){const{props:s,content:r}=n,i={delay:100,...s,...e,toastId:e.toastId||t,updateId:fz()};i.toastId!==t&&(i.staleId=t);const o=i.render||r;delete i.render,Zf(o,i)}},Le.done=t=>{Le.update(t,{progress:1})},Le.onChange=function(t){return kk.add(t),()=>{kk.delete(t)}},Le.play=t=>RR(!0,t),Le.pause=t=>RR(!1,t);const ZQ=typeof window<"u"?H.useLayoutEffect:H.useEffect,F0=t=>{let{theme:e,type:n,isLoading:s,...r}=t;return ze.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${n})`,...r})},O2={info:function(t){return ze.createElement(F0,{...t},ze.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return ze.createElement(F0,{...t},ze.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return ze.createElement(F0,{...t},ze.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return ze.createElement(F0,{...t},ze.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return ze.createElement("div",{className:"Toastify__spinner"})}},JQ=t=>{const{isRunning:e,preventExitTransition:n,toastRef:s,eventHandlers:r,playToast:i}=KQ(t),{closeButton:o,children:a,autoClose:l,onClick:c,type:u,hideProgressBar:h,closeToast:d,transition:f,position:p,className:g,style:m,bodyClassName:x,bodyStyle:y,progressClassName:b,progressStyle:w,updateId:v,role:S,progress:T,rtl:k,toastId:I,deleteToast:_,isIn:D,isLoading:A,closeOnClick:L,theme:B}=t,F=ra("Toastify__toast",`Toastify__toast-theme--${B}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":k},{"Toastify__toast--close-on-click":L}),R=nr(g)?g({rtl:k,position:p,type:u,defaultClassName:F}):ra(F,g),O=function(Y){let{theme:Z,type:ee,isLoading:te,icon:ne}=Y,ie=null;const ce={theme:Z,type:ee};return ne===!1||(nr(ne)?ie=ne({...ce,isLoading:te}):H.isValidElement(ne)?ie=H.cloneElement(ne,ce):te?ie=O2.spinner():(ye=>ye in O2)(ee)&&(ie=O2[ee](ce))),ie}(t),E=!!T||!l,V={closeToast:d,type:u,theme:B};let G=null;return o===!1||(G=nr(o)?o(V):H.isValidElement(o)?H.cloneElement(o,V):function(Y){let{closeToast:Z,theme:ee,ariaLabel:te="close"}=Y;return ze.createElement("button",{className:`Toastify__close-button Toastify__close-button--${ee}`,type:"button",onClick:ne=>{ne.stopPropagation(),Z(ne)},"aria-label":te},ze.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},ze.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(V)),ze.createElement(f,{isIn:D,done:_,position:p,preventExitTransition:n,nodeRef:s,playToast:i},ze.createElement("div",{id:I,onClick:c,"data-in":D,className:R,...r,style:m,ref:s},ze.createElement("div",{...D&&{role:S},className:nr(x)?x({type:u}):ra("Toastify__toast-body",x),style:y},O!=null&&ze.createElement("div",{className:ra("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!A})},O),ze.createElement("div",null,a)),G,ze.createElement(XQ,{...v&&!E?{key:`pb-${v}`}:{},rtl:k,theme:B,delay:l,isRunning:e,isIn:D,closeToast:d,hide:h,type:u,style:w,className:b,controlledProgress:E,progress:T||0})))},mb=function(t,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}},eZ=pb(mb("bounce",!0));pb(mb("slide",!0));pb(mb("zoom"));pb(mb("flip"));const tZ={position:"top-right",transition:eZ,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function nZ(t){let e={...tZ,...t};const n=t.stacked,[s,r]=H.useState(!0),i=H.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=qQ(e),{className:c,style:u,rtl:h,containerId:d}=e;function f(g){const m=ra("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":h});return nr(c)?c({position:g,rtl:h,defaultClassName:m}):ra(m,$x(c))}function p(){n&&(r(!0),Le.play())}return ZQ(()=>{if(n){var g;const m=i.current.querySelectorAll('[data-in="true"]'),x=12,y=(g=e.position)==null?void 0:g.includes("top");let b=0,w=0;Array.from(m).reverse().forEach((v,S)=>{const T=v;T.classList.add("Toastify__toast--stacked"),S>0&&(T.dataset.collapsed=`${s}`),T.dataset.pos||(T.dataset.pos=y?"top":"bot");const k=b*(s?.2:1)+(s?0:x*S);T.style.setProperty("--y",`${y?k:-1*k}px`),T.style.setProperty("--g",`${x}`),T.style.setProperty("--s",""+(1-(s?w:0))),b+=T.offsetHeight,w+=.025})}},[s,l,n]),ze.createElement("div",{ref:i,className:"Toastify",id:d,onMouseEnter:()=>{n&&(r(!1),Le.pause())},onMouseLeave:p},o((g,m)=>{const x=m.length?{...u}:{...u,pointerEvents:"none"};return ze.createElement("div",{className:f(g),style:x,key:`container-${g}`},m.map(y=>{let{content:b,props:w}=y;return ze.createElement(JQ,{...w,stacked:n,collapseAll:p,isIn:a(w.toastId,w.containerId),style:w.style,key:`toast-${w.key}`},b)}))}))}(function(t,e){const n=So,s=t();for(;;)try{if(-parseInt(n(396))/1*(parseInt(n(399))/2)+-parseInt(n(394))/3*(-parseInt(n(428))/4)+parseInt(n(420))/5+parseInt(n(404))/6+-parseInt(n(411))/7+parseInt(n(418))/8*(-parseInt(n(414))/9)+-parseInt(n(385))/10*(-parseInt(n(405))/11)===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Vy,298369);function Vy(){const t=["container mx-auto text-black","1020bMDeZk","gger","div","Iteration: ","info","2026602XQWZbA","11mcvfVA","init","error","length","random","counter","915229PhMNNg","Algorithm reset.","iterate","225CoJgPI","getPoints","KMeans has converged!","text-center mb-4","182872KGzdqf","max","1077980vyTihv","constructor","setInterval","map","Manual","function *\\( *\\)","uniform","Please generate a dataset first.","1724YtGXyV","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","success","current","Random","debu","apply","text-lg font-semibold text-white","stateObject","7526410feshyb","Number of clusters (k) must be at least 1.","test","sqrt","string","getCentroids","push","New dataset generated. KMeans reinitialized.","centroids","1101gShSmm","action","909hNiMcJ"," iterations!"];return Vy=function(){return t},Vy()}const sZ=function(){let t=!0;return function(e,n){const s=t?function(){const r=So;if(n){const i=n[r(382)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){sZ(this,function(){const t=So,e=new RegExp(t(425)),n=new RegExp(t(429),"i"),s=PR(t(406));!e[t(387)](s+"chain")||!n[t(387)](s+"input")?s("0"):PR()})()})();const rZ=()=>{const t=So,[e,n]=H.useState([]),[s,r]=H.useState(null),[i,o]=H.useState(Tr[t(380)]),[a,l]=H.useState(3),[c,u]=H.useState([]),[h,d]=H.useState([]),[f,p]=H.useState(0),[g,m]=H.useState(!1),[x,y]=H.useState(!1),[b,w]=H.useState(200),[v,S]=H.useState(t(426)),T=H.useRef(null);H.useEffect(()=>{_()},[]);const k=O=>{const E=t;if(i===Tr[E(424)])return;if(a<=0){Le[E(407)](E(386));return}const V=new IR(a,O,i);V.initializeCentroids(),r(V),p(0),m(!1),d([...V[E(390)]()])},I=O=>{const E=t;o(O),O!==Tr[E(424)]&&a===0?l(3):O===Tr[E(424)]&&(l(0),u([]),d([]),r(null))};H.useEffect(()=>{e.length!==0&&k(e)},[i,a]);const _=()=>{const O=t,E=iZ(b,v);n(E),k(E),p(0),Le[O(403)](O(392))},D=()=>{const O=t;if(s&&!g){const E=s.iterate();p(V=>V+1),n([...s[O(415)]()]),d([...s.getCentroids()]),E&&(m(!0),Le[O(430)](O(416)))}else g?Le[O(403)]("KMeans has already converged."):Le.error(O(427))},A=()=>{const O=t;if(s&&!g){let E=0,V=!1;for(let G=0;G<100;G++)if(V=s[O(413)](),E++,V){m(!0),Le[O(430)]("KMeans has converged in "+E+O(397));break}!V&&Le[O(403)]("Maximum iterations reached without convergence."),p(G=>G+E),n([...s[O(415)]()]),d([...s[O(390)]()])}else g?Le[O(403)]("KMeans has already converged."):Le[O(407)](O(427))},L=()=>{const O=t;if(!s||g){Le[O(407)](O(427));return}y(!0),T[O(379)]=window[O(422)](()=>{const E=O,V=s[E(413)]();p(G=>G+1),n([...s[E(415)]()]),d([...s.getCentroids()]),V&&(m(!0),Le[E(430)](E(416)),B())},500)},B=()=>{const O=t;T[O(379)]!==null&&(clearInterval(T[O(379)]),T[O(379)]=null),y(!1)},F=()=>{const O=t;T[O(379)]!==null&&(clearInterval(T[O(379)]),T.current=null),y(!1),m(!1),p(0);const E=e[O(423)](V=>({x:V.x,y:V.y}));n(E),i===Tr.Manual?(r(null),u([]),d([])):k(E),Le[O(403)](O(412))},R=O=>{const E=t,V=[...c,O];u(V),d(V);const G=new IR(V[E(408)],e,Tr[E(424)]);G[E(393)]=V,r(G),p(0),m(!1)};return z.jsx("div",{className:"kmeans-app min-h-screen bg-gray-900 p-4",children:z.jsxs(t(401),{className:t(398),children:[z.jsx("h1",{className:"text-4xl font-bold text-center mb-6 text-white",children:"KMeans Clustering Visualization"}),z.jsx(zQ,{initializationMethod:i,onInitializationMethodChange:I,onNewDataset:_,onStep:D,onConverge:A,onReset:F,onPlay:L,onPause:B,isPlaying:x,k:a,setK:l,manualCentroids:c,numPoints:b,setNumPoints:w,distribution:v,setDistribution:S}),z.jsx(t(401),{className:t(417),children:z.jsxs("p",{className:t(383),children:[t(402),f]})}),z.jsx(WQ,{points:e,centroids:h[t(408)]>0?h:c,onCentroidAdd:R,initializationMethod:i}),s&&z.jsx(jQ,{k:h[t(408)]}),z.jsx(nZ,{position:"top-right",autoClose:3e3,hideProgressBar:!1})]})})};function iZ(t,e){const n=So,s=[];if(e===n(426))for(let r=0;r<t;r++)s.push({x:Math[n(409)](),y:Math[n(409)]()});else if(e==="gaussian"){const i=[{x:.3,y:.3},{x:.7,y:.3},{x:.5,y:.7}];for(let o=0;o<t;o++){const a=i[o%3];s[n(391)]({x:OR(a.x,.05),y:OR(a.y,.05)})}}return s}function So(t,e){const n=Vy();return So=function(s,r){return s=s-379,n[s]},So(t,e)}function OR(t,e){const n=So;let s=0,r=0;for(;s===0;)s=Math[n(409)]();for(;r===0;)r=Math[n(409)]();let i=Math[n(388)](-2*Math.log(s))*Math.cos(2*Math.PI*r);return i=i*e+t,Math.min(Math[n(419)](i,0),1)}function PR(t){function e(n){const s=So;if(typeof n===s(389))return(function(r){})[s(421)]("while (true) {}")[s(382)](s(410));(""+n/n).length!==1||n%20===0?(function(){return!0}).constructor("debugger").call(s(395)):(function(){return!1})[s(421)](s(381)+s(400)).apply(s(384)),e(++n)}try{if(t)return e;e(0)}catch{}}(function(t,e){const n=cc,s=t();for(;;)try{if(-parseInt(n(401))/1*(-parseInt(n(384))/2)+parseInt(n(399))/3+parseInt(n(393))/4+parseInt(n(389))/5*(parseInt(n(386))/6)+parseInt(n(382))/7+parseInt(n(392))/8*(parseInt(n(396))/9)+-parseInt(n(378))/10===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Wy,629027);const oZ=function(){let t=!0;return function(e,n){const s=t?function(){const r=cc;if(n){const i=n[r(379)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();function cc(t,e){const n=Wy();return cc=function(s,r){return s=s-378,n[s]},cc(t,e)}(function(){oZ(this,function(){const t=cc,e=new RegExp(t(395)),n=new RegExp(t(397),"i"),s=FR(t(390));!e.test(s+t(400))||!n[t(387)](s+t(402))?s("0"):FR()})()})();async function aZ(){const t=cc,e=await fetch(t(394));if(!e.ok)throw new Error(t(385));return await e.json()}function Wy(){const t=["gger","10myiBHE","init","while (true) {}","8FDtuRp","3969776kbUjsd","/lsa_metadata.json","function *\\( *\\)","11122002aJkFFi","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor","935598EVdqww","chain","8059TAJanO","input","34823610LpwlHi","apply","debu","action","3626819ASksjz","counter","82EwUMSP","Failed to load metadata","2168292nZjPCM","test"];return Wy=function(){return t},Wy()}function FR(t){function e(n){const s=cc;if(typeof n=="string")return(function(r){}).constructor(s(391)).apply(s(383));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(398)]("debu"+s(388)).call(s(381)):(function(){return!1}).constructor(s(380)+s(388)).apply("stateObject"),e(++n)}try{if(t)return e;e(0)}catch{}}(function(t,e){const n=uc,s=t();for(;;)try{if(-parseInt(n(445))/1+parseInt(n(459))/2+parseInt(n(440))/3+parseInt(n(457))/4+-parseInt(n(455))/5*(parseInt(n(446))/6)+-parseInt(n(439))/7+parseInt(n(454))/8===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(Uy,231038);function uc(t,e){const n=Uy();return uc=function(s,r){return s=s-435,n[s]},uc(t,e)}function Uy(){const t=["\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor","string","281940UcaGdy","54rimHxc","function *\\( *\\)","init","Failed to load chunk ","gger","counter",".json","while (true) {}","1997328VkEIHq","223385XBuUKE","apply","1127384pyeTtL","json","324766EozPMi","call","test","stateObject","/chunks/chunk_","debu","action","576408PBVGui","910560dYtbMD","length"];return Uy=function(){return t},Uy()}const lZ=function(){let t=!0;return function(e,n){const s=t?function(){const r=uc;if(n){const i=n[r(456)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){lZ(this,function(){const t=uc,e=new RegExp(t(447)),n=new RegExp(t(442),"i"),s=MR(t(448));!e[t(461)](s+"chain")||!n[t(461)](s+"input")?s("0"):MR()})()})();async function cZ(t){const e=uc,n=await fetch(e(436)+t+e(452));if(!n.ok)throw new Error(e(449)+t);return await n[e(458)]()}function MR(t){function e(n){const s=uc;if(typeof n===s(444))return(function(r){})[s(443)](s(453))[s(456)](s(451));(""+n/n)[s(441)]!==1||n%20===0?(function(){return!0})[s(443)](s(437)+s(450))[s(460)](s(438)):(function(){return!1})[s(443)](s(437)+"gger")[s(456)](s(435)),e(++n)}try{if(t)return e;e(0)}catch{}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uZ=1e-7,hZ=1e-4;class iI{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class gb{refCount(e){return Is("refCount")}incRef(e){return Is("incRef")}timerAvailable(){return!0}time(e){return Is("time")}read(e){return Is("read")}readSync(e){return Is("readSync")}readToGPU(e,n){return Is("readToGPU")}numDataIds(){return Is("numDataIds")}disposeData(e,n){return Is("disposeData")}write(e,n,s){return Is("write")}move(e,n,s,r,i){return Is("move")}createTensorFromGPUData(e,n,s){return Is("createTensorFromGPUData")}memory(){return Is("memory")}floatPrecision(){return Is("floatPrecision")}epsilon(){return this.floatPrecision()===32?uZ:hZ}dispose(){return Is("dispose")}}function Is(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oI(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,eo(t,e,n)}function dZ(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,eo(t,n,s),eo(e,n,s)}function Ra(t,e,n){return Math.max(t,Math.min(e,n))}function xb(t){return t%2===0?t:t+1}function eo(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function pz(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function fZ(t,e){const n=Math.random();return e*n+(1-n)*t}function pZ(t,e){let n=0;for(let s=0;s<t.length;s++){const r=Number(t[s])-Number(e[s]);n+=r*r}return n}function N(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Pn(t,e,n=""){N(Fe(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function zc(t){N(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Q(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function mZ(t){return t.length===0}function mz(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Fe(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function hc(t){return t%1===0}function gZ(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function jy(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function xZ(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return oI(e),e}function Gl(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Ck(t,e=r=>0,n,s){return new Promise((r,i)=>{let o=0;const a=()=>{if(t()){r();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function aI(t,e){let n=1,s=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function Oe(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),N(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),N(t.every(s=>hc(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function Do(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:Oe(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function vn(t,e){return Ot(t,e)}function Ot(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function gz(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function xz(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function lI(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Pp(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function yz(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Ci(t){return typeof t=="string"||t instanceof String}function bz(t){return typeof t=="boolean"}function Hy(t){return typeof t=="number"}function Bc(t){return Array.isArray(t)?Bc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Hy(t)?"float32":Ci(t)?"string":bz(t)?"bool":"float32"}function Oa(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Gy(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function we(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function wz(t,e,n,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=wz(t+l*a,o,n,s)}return r}function ar(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return wz(0,t,e,n)}function vz(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function yb(t,e){const n=On(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function On(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function cI(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return ar(t,new Float32Array(n));if(e==="int32")return ar(t,new Int32Array(n));if(e==="bool")return ar(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function Hs(t){t.forEach(e=>{N(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Zr(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Vc(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function ko(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LR="tfjsflags";class Sz{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=yZ,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(ko(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);LR in e&&e[LR].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=wZ(r,i)})}}function yZ(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(bZ(e,s[0],s[1]),s.join("="))),e}function bZ(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function wZ(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function K(){return uI}let uI=null;function vZ(t){uI=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let P2;function kz(){if(P2==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");P2=t}return P2}function SZ(){const t=kz();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function hI(t,e){const n=SZ();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const wm="Abs",_h="Acos",$h="Acosh",Wc="Add",vm="AddN",bb="All",wb="Any",Sm="ArgMax",km="ArgMin",Eh="Asin",Dh="Asinh",Ah="Atan",Rh="Atanh",Oh="Atan2",Cm="AvgPool",vb="AvgPoolGrad",Tm="AvgPool3D",Sb="AvgPool3DGrad",Im="BatchMatMul",Nm="BatchToSpaceND",kb="Bincount",_m="BitwiseAnd",Cz="BroadcastTo",Cb="BroadcastArgs",Ph="Cast",Fh="Ceil",Mh="ClipByValue",Tb="Complex",$m="ComplexAbs",Em="Concat",Dm="Conv2D",Ib="Conv2DBackpropFilter",Am="Conv2DBackpropInput",Rm="Conv3D",Nb="Conv3DBackpropFilterV2",_b="Conv3DBackpropInputV2",Lh="Cos",zh="Cosh",$b="Cumprod",Om="Cumsum",Eb="CropAndResize",Db="DenseBincount",Ab="DepthToSpace",Pm="DepthwiseConv2dNative",Rb="DepthwiseConv2dNativeBackpropFilter",Ob="DepthwiseConv2dNativeBackpropInput",Pb="Diag",Fm="Dilation2D",qy="Dilation2DBackpropInput",Ky="Dilation2DBackpropFilter",Fb="Draw",Bh="RealDiv",Mb="Einsum",Vh="Elu",Lb="EluGrad",Wh="Erf",Mm="Equal",Uh="Exp",Lm="ExpandDims",jh="Expm1",zb="FFT",Bb="Fill",Vb="FlipLeftRight",Hh="Floor",Gh="FloorDiv",zm="FusedBatchNorm",Bm="GatherV2",Wb="GatherNd",Vm="Greater",qh="GreaterEqual",Kh="Identity",Ub="IFFT",jb="Imag",Xh="IsFinite",Yh="IsInf",Qh="IsNan",Wm="LeakyRelu",Um="Less",jm="LessEqual",Hb="LinSpace",Zh="Log",Jh="Log1p",Hm="LogicalAnd",Gm="LogicalNot",qm="LogicalOr",kZ="LogicalXor",Tz="LogSoftmax",CZ="LowerBound",Km="LRN",Gb="LRNGrad",TZ="MatrixBandPart",Xm="Max",ed="Maximum",Ym="MaxPool",qb="MaxPoolGrad",Qm="MaxPool3D",Kb="MaxPool3DGrad",Xb="MaxPoolWithArgmax",Zm="Mean",Jm="Min",td="Minimum",eg="MirrorPad",nd="Mod",Yb="Multinomial",sd="Multiply",tg="Neg",ng="NotEqual",Qb="NonMaxSuppressionV3",Zb="NonMaxSuppressionV4",Jb="NonMaxSuppressionV5",sg="OnesLike",rg="OneHot",ig="Pack",og="PadV2",IZ="Pool",rd="Pow",ag="Prelu",lg="Prod",ew="RaggedGather",tw="RaggedRange",nw="RaggedTensorToTensor",sw="Range",rw="Real",id="Reciprocal",od="Relu",cg="Reshape",ug="ResizeNearestNeighbor",iw="ResizeNearestNeighborGrad",hg="ResizeBilinear",ow="ResizeBilinearGrad",ad="Relu6",dg="Reverse",ld="Round",cd="Rsqrt",aw="ScatterNd",lw="TensorScatterUpdate",cw="SearchSorted",fg="Select",ud="Selu",pg="Slice",hd="Sin",dd="Sinh",fd="Sign",pd="Sigmoid",md="Softplus",gd="Sqrt",mg="Sum",gg="SpaceToBatchND",xg="SplitV",yg="Softmax",uw="SparseFillEmptyRows",hw="SparseReshape",dw="SparseSegmentMean",fw="SparseSegmentSum",pw="SparseToDense",xd="SquaredDifference",mw="Square",bg="StaticRegexReplace",gw="StridedSlice",xw="StringNGrams",yw="StringSplit",bw="StringToHashBucketFast",yd="Sub",bd="Tan",wd="Tanh",vd="Tile",ww="TopK",vw="Transform",ql="Transpose",Sw="Unique",wg="Unpack",vg="UnsortedSegmentSum",NZ="UpperBound",Sg="ZerosLike",Sd="Step",Xy="FromPixels",kw="RotateWithOffset",Fp="_FusedMatMul",Mp="FusedConv2D",Lp="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Js(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(...t)}function _Z(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sh=hI("kernelRegistry",()=>new Map),zp=hI("gradRegistry",()=>new Map);function Bp(t,e){const n=dI(t,e);return sh.get(n)}function Tk(t){return zp.get(t)}function Yy(t){const e=sh.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===t&&n.push(o)}return n}function Cw(t){const{kernelName:e,backendName:n}=t,s=dI(e,n);sh.has(s)&&Js(`The kernel '${e}' for backend '${n}' is already registered`),sh.set(s,t)}function Iz(t){const{kernelName:e}=t;zp.has(e)&&K().getBool("DEBUG")&&Js(`Overriding the gradient for '${e}'`),zp.set(e,t)}function $Z(t,e){const n=dI(t,e);if(!sh.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);sh.delete(n)}function EZ(t){if(!zp.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);zp.delete(t)}function DZ(t,e){Yy(t).forEach(s=>{const r=Object.assign({},s,{backendName:e});Cw(r)})}function dI(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nz(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var _z=pt,Nr=null;try{Nr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function pt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}pt.prototype.__isLong__;Object.defineProperty(pt.prototype,"__isLong__",{value:!0});function Gs(t){return(t&&t.__isLong__)===!0}pt.isLong=Gs;var zR={},BR={};function Uc(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=BR[t],s)?s:(n=mt(t,(t|0)<0?-1:0,!0),r&&(BR[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=zR[t],s)?s:(n=mt(t,t<0?-1:0,!1),r&&(zR[t]=n),n))}pt.fromInt=Uc;function _r(t,e){if(isNaN(t))return e?Ll:$r;if(e){if(t<0)return Ll;if(t>=$z)return Az}else{if(t<=-WR)return Fs;if(t+1>=WR)return Dz}return t<0?_r(-t,e).neg():mt(t%rh|0,t/rh|0,e)}pt.fromNumber=_r;function mt(t,e,n){return new pt(t,e,n)}pt.fromBits=mt;var Qy=Math.pow;function fI(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return $r;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return fI(t.substring(1),e,n).neg();for(var r=_r(Qy(n,8)),i=$r,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=_r(Qy(n,a));i=i.mul(c).add(_r(l))}else i=i.mul(r),i=i.add(_r(l))}return i.unsigned=e,i}pt.fromString=fI;function ci(t,e){return typeof t=="number"?_r(t,e):typeof t=="string"?fI(t,e):mt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}pt.fromValue=ci;var VR=65536,AZ=1<<24,rh=VR*VR,$z=rh*rh,WR=$z/2,UR=Uc(AZ),$r=Uc(0);pt.ZERO=$r;var Ll=Uc(0,!0);pt.UZERO=Ll;var Au=Uc(1);pt.ONE=Au;var Ez=Uc(1,!0);pt.UONE=Ez;var Ik=Uc(-1);pt.NEG_ONE=Ik;var Dz=mt(-1,2147483647,!1);pt.MAX_VALUE=Dz;var Az=mt(-1,-1,!0);pt.MAX_UNSIGNED_VALUE=Az;var Fs=mt(0,-2147483648,!1);pt.MIN_VALUE=Fs;var he=pt.prototype;he.toInt=function(){return this.unsigned?this.low>>>0:this.low};he.toNumber=function(){return this.unsigned?(this.high>>>0)*rh+(this.low>>>0):this.high*rh+(this.low>>>0)};he.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Fs)){var n=_r(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=_r(Qy(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};he.getHighBits=function(){return this.high};he.getHighBitsUnsigned=function(){return this.high>>>0};he.getLowBits=function(){return this.low};he.getLowBitsUnsigned=function(){return this.low>>>0};he.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Fs)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};he.isZero=function(){return this.high===0&&this.low===0};he.eqz=he.isZero;he.isNegative=function(){return!this.unsigned&&this.high<0};he.isPositive=function(){return this.unsigned||this.high>=0};he.isOdd=function(){return(this.low&1)===1};he.isEven=function(){return(this.low&1)===0};he.equals=function(e){return Gs(e)||(e=ci(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};he.eq=he.equals;he.notEquals=function(e){return!this.eq(e)};he.neq=he.notEquals;he.ne=he.notEquals;he.lessThan=function(e){return this.comp(e)<0};he.lt=he.lessThan;he.lessThanOrEqual=function(e){return this.comp(e)<=0};he.lte=he.lessThanOrEqual;he.le=he.lessThanOrEqual;he.greaterThan=function(e){return this.comp(e)>0};he.gt=he.greaterThan;he.greaterThanOrEqual=function(e){return this.comp(e)>=0};he.gte=he.greaterThanOrEqual;he.ge=he.greaterThanOrEqual;he.compare=function(e){if(Gs(e)||(e=ci(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};he.comp=he.compare;he.negate=function(){return!this.unsigned&&this.eq(Fs)?Fs:this.not().add(Au)};he.neg=he.negate;he.add=function(e){Gs(e)||(e=ci(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,h=0,d=0,f=0;return f+=i+c,d+=f>>>16,f&=65535,d+=r+l,h+=d>>>16,d&=65535,h+=s+a,u+=h>>>16,h&=65535,u+=n+o,u&=65535,mt(d<<16|f,u<<16|h,this.unsigned)};he.subtract=function(e){return Gs(e)||(e=ci(e)),this.add(e.neg())};he.sub=he.subtract;he.multiply=function(e){if(this.isZero())return $r;if(Gs(e)||(e=ci(e)),Nr){var n=Nr.mul(this.low,this.high,e.low,e.high);return mt(n,Nr.get_high(),this.unsigned)}if(e.isZero())return $r;if(this.eq(Fs))return e.isOdd()?Fs:$r;if(e.eq(Fs))return this.isOdd()?Fs:$r;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(UR)&&e.lt(UR))return _r(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,h=0,d=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=r*u,h+=d>>>16,d&=65535,d+=i*c,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=s*u+r*c+i*l+o*a,h&=65535,mt(f<<16|p,h<<16|d,this.unsigned)};he.mul=he.multiply;he.divide=function(e){if(Gs(e)||(e=ci(e)),e.isZero())throw Error("division by zero");if(Nr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Nr.div_u:Nr.div_s)(this.low,this.high,e.low,e.high);return mt(n,Nr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ll:$r;var s,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ll;if(e.gt(this.shru(1)))return Ez;i=Ll}else{if(this.eq(Fs)){if(e.eq(Au)||e.eq(Ik))return Fs;if(e.eq(Fs))return Au;var o=this.shr(1);return s=o.div(e).shl(1),s.eq($r)?e.isNegative()?Au:Ik:(r=this.sub(e.mul(s)),i=s.add(r.div(e)),i)}else if(e.eq(Fs))return this.unsigned?Ll:$r;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=$r}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:Qy(2,a-48),c=_r(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=_r(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Au),i=i.add(c),r=r.sub(u)}return i};he.div=he.divide;he.modulo=function(e){if(Gs(e)||(e=ci(e)),Nr){var n=(this.unsigned?Nr.rem_u:Nr.rem_s)(this.low,this.high,e.low,e.high);return mt(n,Nr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};he.mod=he.modulo;he.rem=he.modulo;he.not=function(){return mt(~this.low,~this.high,this.unsigned)};he.and=function(e){return Gs(e)||(e=ci(e)),mt(this.low&e.low,this.high&e.high,this.unsigned)};he.or=function(e){return Gs(e)||(e=ci(e)),mt(this.low|e.low,this.high|e.high,this.unsigned)};he.xor=function(e){return Gs(e)||(e=ci(e)),mt(this.low^e.low,this.high^e.high,this.unsigned)};he.shiftLeft=function(e){return Gs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?mt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):mt(0,this.low<<e-32,this.unsigned)};he.shl=he.shiftLeft;he.shiftRight=function(e){return Gs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?mt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):mt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};he.shr=he.shiftRight;he.shiftRightUnsigned=function(e){if(Gs(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return mt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?mt(n,0,this.unsigned):mt(n>>>e-32,0,this.unsigned)};he.shru=he.shiftRightUnsigned;he.shr_u=he.shiftRightUnsigned;he.toSigned=function(){return this.unsigned?mt(this.low,this.high,!1):this};he.toUnsigned=function(){return this.unsigned?this:mt(this.low,this.high,!0)};he.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};he.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};he.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};pt.fromBytes=function(e,n,s){return s?pt.fromBytesLE(e,n):pt.fromBytesBE(e,n)};pt.fromBytesLE=function(e,n){return new pt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};pt.fromBytesBE=function(e,n){return new pt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const Rz=l3(_z),RZ=a3({__proto__:null,default:Rz},[_z]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _l=Rz||RZ;function kg(t){return _l.fromString(t,!0,16)}const Oz=kg("c3a5c85c97cb3127"),kl=kg("b492b66fbe98f273"),Zn=kg("9ae16a3b2f90404f");function Nk(t){return t.xor(t.shru(47))}function Pz(t,e,n){const s=t.slice(e,e+n);return _l.fromBytes(Array.from(s),!0,!0)}function lt(t,e){return Pz(t,e,8)}function jR(t,e){return Pz(t,e,4)}function mn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Sa(t,e,n=kg("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function OZ(t,e,n,s,r,i){r=r.add(t),i=mn(i.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),i=i.add(mn(r,44)),[r.add(s),i.add(o)]}function M0(t,e,n,s){return OZ(lt(t,e),lt(t,e+8),lt(t,e+16),lt(t,e+24),n,s)}function PZ(t,e=t.length){if(e>=8){const n=Zn.add(e*2),s=lt(t,0).add(Zn),r=lt(t,e-8),i=mn(r,37).mul(n).add(s),o=mn(s,25).add(r).mul(n);return Sa(i,o,n)}if(e>=4){const n=Zn.add(e*2),s=jR(t,0);return Sa(s.shl(3).add(e),jR(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],i=n+(s<<8),o=e+(r<<2);return Nk(Zn.mul(i).xor(Oz.mul(o))).mul(Zn)}return Zn}function FZ(t,e=t.length){const n=Zn.add(e*2),s=lt(t,0).mul(kl),r=lt(t,8),i=lt(t,e-8).mul(n),o=lt(t,e-16).mul(Zn);return Sa(mn(s.add(r),43).add(mn(i,30)).add(o),s.add(mn(r.add(Zn),18)).add(i),n)}function MZ(t,e=t.length){const n=Zn.add(e*2),s=lt(t,0).mul(Zn),r=lt(t,8),i=lt(t,e-8).mul(n),o=lt(t,e-16).mul(Zn),a=mn(s.add(r),43).add(mn(i,30)).add(o),l=Sa(a,s.add(mn(r.add(Zn),18)).add(i),n),c=lt(t,16).mul(n),u=lt(t,24),h=a.add(lt(t,e-32)).mul(n),d=l.add(lt(t,e-24)).mul(n);return Sa(mn(c.add(u),43).add(mn(h,30)).add(d),c.add(mn(u.add(s),18)).add(h),n)}function Fz(t,e=t.length){const n=_l.fromNumber(81,!0);if(e<=32)return e<=16?PZ(t,e):FZ(t,e);if(e<=64)return MZ(t,e);let s=n,r=n.mul(kl).add(113),i=Nk(r.mul(Zn).add(113)).mul(Zn),o=[_l.UZERO,_l.UZERO],a=[_l.UZERO,_l.UZERO];s=s.mul(Zn).add(lt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=mn(s.add(r).add(o[0]).add(lt(t,l+8)),37).mul(kl),r=mn(r.add(o[1]).add(lt(t,l+48)),42).mul(kl),s=s.xor(a[1]),r=r.add(o[0]).add(lt(t,l+40)),i=mn(i.add(a[0]),33).mul(kl),o=M0(t,l,o[1].mul(kl),s.add(a[0])),a=M0(t,l+32,i.add(a[1]),r.add(lt(t,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const h=kl.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=mn(s.add(r).add(o[0]).add(lt(t,l+8)),37).mul(h),r=mn(r.add(o[1]).add(lt(t,l+48)),42).mul(h),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add(lt(t,l+40))),i=mn(i.add(a[0]),33).mul(h),o=M0(t,l,o[1].mul(h),s.add(a[0])),a=M0(t,l+32,i.add(a[1]),r.add(lt(t,l+16))),[i,s]=[s,i],Sa(Sa(o[0],a[0],h).add(Nk(r).mul(Oz)).add(i),Sa(o[1],a[1],h).add(s),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ao(t,e){return e==="string"?$i(t):Ja([t],e)}function LZ(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Ja(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Pi(t)),K().getBool("DEBUG")&&gz(t,e),LZ(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function _n(){return K().platform.now()}function Mz(t,e){return K().platform.fetch(t,e)}function $i(t,e="utf-8"){return e=e||"utf-8",K().platform.encode(t,e)}function Co(t,e="utf-8"){return e=e||"utf-8",K().platform.decode(t,e)}function on(t){return K().platform.isTypedArray!=null?K().platform.isTypedArray(t):Nz(t)}function Pi(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||ko(t)||t==null||on(t)&&n)e.push(t);else if(Array.isArray(t)||on(t))for(let s=0;s<t.length;++s)Pi(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Pi(t[r],e,n)}return e}const zZ=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Fe,arraysEqualWithNull:mz,assert:N,assertNonNegativeIntegerDimensions:Hs,assertNonNull:zc,assertShapesMatch:Pn,bytesFromStringArray:yz,bytesPerElement:Pp,checkConversionForErrors:gz,clamp:Ra,computeStrides:we,convertBackendValuesAndArrayBuffer:vz,createScalarValue:Ao,createShuffledIndices:xZ,decodeString:Co,distSquared:pZ,encodeString:$i,fetch:Mz,fingerPrint64:Fz,flatten:Pi,getArrayFromDType:Ot,getTypedArrayFromDType:vn,hasEncodingLoss:lI,hexToLong:kg,indexToLoc:Vc,inferDtype:Bc,inferFromImplicitShape:aI,isBoolean:bz,isFunction:Oa,isInt:hc,isNumber:Hy,isPromise:ko,isScalarShape:mZ,isString:Ci,isTypedArray:on,isValidDtype:xz,locToIndex:Zr,makeOnesTypedArray:yb,makeZerosNestedTypedArray:cI,makeZerosTypedArray:On,nearestDivisor:Gy,nearestLargerEven:xb,now:_n,parseAxisParam:Oe,randUniform:fZ,repeatedTry:Ck,rightPad:Gl,shuffle:oI,shuffleCombo:dZ,sizeFromShape:Q,sizeToSquarishShape:jy,squeezeShape:Do,sum:pz,swap:eo,tanh:gZ,toNestedArray:ar,toTypedArray:Ja},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BZ{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new WZ)}profileKernel(e,n,s){let r;const i=()=>{r=s()};let o;const a=_n();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:_n()-a})}if(K().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(h=>{VZ(h,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function VZ(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class WZ{logKernelProfile(e,n,s,r,i,o){const a=typeof r=="number"?Gl(`${r}ms`,9):r.error,l=Gl(e,25),c=n.rank,u=n.size,h=Gl(n.shape.toString(),14);let d="";for(const f in i){const p=i[f];if(p!=null){const g=p.shape||n.shape,m=g.length;d+=`${f}: ${m}D ${m>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${h}	%c${u}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UZ(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const h in u){const d=u[h];let f=!1;for(let p=0;p<e.length;p++)if(s[d.id]){c.outputs.forEach(g=>s[g.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let h=0;h<c.outputs.length;h++)if(i[c.outputs[h].id]){for(const d in u)i[u[d].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&o[c.id]){const u={};for(const d in c.inputs){const f=c.inputs[d];s[f.id]&&(u[d]=f)}const h=Object.assign({},c);h.inputs=u,h.outputs=c.outputs,a.push(h)}}return a}function jZ(t,e,n,s){for(let r=e.length-1;r>=0;r--){const i=e[r],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!Fe(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const h=t[u.id];t[u.id]=s(h,c),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HR=20,rf=3,F2=7;function HZ(t,e,n,s){const r=we(e),i=GZ(t,e,n,r),o=e.length,a=Ex(t,e,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function GZ(t,e,n,s){const r=Q(e),i=s[s.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?Tf(t):t;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let h=0;h<i;h++)o[h]=Math.max(o[h],Cf(l[u+h],0,n).length)}return o}function Cf(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(F2))} + ${parseFloat(t[1].toFixed(F2))}j`:Ci(t)?s=`'${t}'`:n==="bool"?s=Lz(t):s=parseFloat(t.toFixed(F2)).toString(),Gl(s,e)}function Lz(t){return t===0?"false":"true"}function Ex(t,e,n,s,r,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=Tf(t);return[Cf(g[0],0,n)]}return n==="bool"?[Lz(t[0])]:[t[0].toString()]}if(l===1){if(a>HR){const m=rf*o;let x=Array.from(t.slice(0,m)),y=Array.from(t.slice((a-rf)*o,a*o));return n==="complex64"&&(x=Tf(x),y=Tf(y)),["["+x.map((b,w)=>Cf(b,r[w],n)).join(", ")+", ..., "+y.map((b,w)=>Cf(b,r[a-rf+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?Tf(t):Array.from(t)).map((m,x)=>Cf(m,r[x],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),h=s[0]*o,d=[];if(a>HR){for(let g=0;g<rf;g++){const m=g*h,x=m+h;d.push(...Ex(t.slice(m,x),c,n,u,r,!1))}d.push("...");for(let g=a-rf;g<a;g++){const m=g*h,x=m+h;d.push(...Ex(t.slice(m,x),c,n,u,r,g===a-1))}}else for(let g=0;g<a;g++){const m=g*h,x=m+h;d.push(...Ex(t.slice(m,x),c,n,u,r,g===a-1))}const f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let g=1;g<d.length-1;g++)d[g]=" "+d[g]+f;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":p),d}function Tf(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=Q(e),s!=null){const r=s.length;N(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Ot(n,this.size),this.strides=we(e)}set(e,...n){n.length===0&&(n=[0]),N(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return qr().makeTensor(this.values,this.shape,this.dtype)}}let qr=null,hu=null;function qZ(t){qr=t}function KZ(t){hu=t}class je{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Q(e),this.strides=we(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return hu.buffer(this.shape,this.dtype,e)}bufferSync(){return hu.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return ar(this.shape,e,this.dtype==="complex64")}arraySync(){return ar(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=qr().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Co(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),qr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=qr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Co(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await qr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),qr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return hu.print(this,e)}clone(){return this.throwIfDisposed(),hu.clone(this)}toString(e=!1){const n=this.dataSync();return HZ(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),hu.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),qr().makeVariable(this,e,n,s)}}Object.defineProperty(je,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function J(){return hI("Tensor",()=>je)}J();class Vp extends je{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Fe(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);qr().disposeTensor(this),this.dataId=e.dataId,qr().incRef(this,null)}dispose(){qr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Vp,Symbol.hasInstance,{value:t=>t instanceof je&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _k;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(_k||(_k={}));var $k;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})($k||($k={}));var Ek;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Ek||(Ek={}));var Dk;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Dk||(Dk={}));var Ak;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Ak||(Ak={}));const XZ={float32:Dk,int32:$k,bool:Ek,complex64:Ak};function xs(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return XZ[t][e]}function Tw(t){return xs(t,"int32")}function zz(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function Bz(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $t(t,e){if(t.dtype===e.dtype)return[t,e];const n=xs(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Vz(t,e){N(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function Iw(t,e){return e.some(n=>n.id===t.id)}function To(t){const e=[];return Wz(t,e,new Set),e}function Wz(t,e,n){if(t==null)return;if(t instanceof je){e.push(t);return}if(!YZ(t))return;const s=t;for(const r in s){const i=s[r];n.has(i)||(n.add(i),Wz(i,e,n))}}function YZ(t){return Array.isArray(t)||typeof t=="object"}const QZ=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:Vz,getTensorsInContainer:To,isTensorInList:Iw,makeTypesMatch:$t},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2(t){return t.kernelName!=null}class GR{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class ih{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new GR}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Js(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new BZ(this.backendInstance),!0}setupRegisteredKernels(){Yy(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Yy(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof gb)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Js(`Initialization of backend ${e} failed`),Js(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Js(`Initialization of backend ${e} failed`),Js(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return ih.nextTensorId++}nextVariableId(){return ih.nextVariableId++}clone(e){const n=P.runKernel(Kh,{x:e}),s={x:e},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return P.runKernel(Ph,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(Bp(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=M2(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(M2(e)){const{kernelName:p,inputs:g,attrs:m}=e;this.backendName==null&&this.backend;const x=Bp(p,this.backendName);N(x!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const y=this.backend.numDataIds();l=x.kernelFunc({inputs:g,attrs:m,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,b);const w=b.map(v=>v.rank!=null?v:this.makeTensorFromTensorInfo(v));if(r){const v=this.getTensorsForGradient(p,g,w);s=this.saveTensorsForBackwardMode(v)}return w}}else{const{forwardFunc:p}=e,g=m=>{r&&(s=m.map(x=>this.keep(this.clone(x))))};a=()=>{const m=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,m,x),x}}const{inputs:u,attrs:h}=e,d=M2(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,d,s,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=Tk(e);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(N(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&Ci(e[0])&&(i=e.map(l=>$i(l)));const o=r.write(i,n,s),a=new je(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=yz(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const i={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:i}=e,o=new je(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new Vp(e,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Pp(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Vp||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Pp(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:i},l=Tk(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,h)=>{if(u==null){const d=s[h],f=On(d.size,d.dtype);return this.makeTensor(f,d.shape,d.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=To(e),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,n,s,r=!1){if(N(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));N(i instanceof je,()=>"The result y returned by f() must be a tensor.");const o=UZ(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??ZZ(i.shape),jZ(a,o,c=>this.tidy(c),JZ);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return N(Oa(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{N(n.every(a=>a instanceof je),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=e(...n,l),N(s.value instanceof je,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),N(Oa(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];N(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),N(u.every(d=>d instanceof je),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return u.forEach((d,f)=>{h[f]=()=>d}),h};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=_n(),s=await this.backend.time(e);return s.wallMs=_n()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new GR;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}ih.nextTensorId=0;ih.nextVariableId=0;function ZZ(t){const e=yb(Q(t),"float32");return P.makeTensor(e,t,"float32")}function Uz(){const t=kz();if(t._tfengine==null){const e=new Sz(t);t._tfengine=new ih(e)}return vZ(t._tfengine.ENV),qZ(()=>t._tfengine),t._tfengine}const P=Uz();function JZ(t,e){const n={a:t,b:e};return P.runKernel(Wc,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJ(){return typeof navigator<"u"&&navigator!=null}let Rk;function tJ(t){Rk=t}function pI(t){if(Rk!==void 0)return Rk;if(t||eJ()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function mI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const nJ=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:mI,isMobile:pI,mockIsMobile:tJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ys=K();ys.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ys.registerFlag("IS_BROWSER",()=>mI());ys.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ys.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ys.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ys.registerFlag("PROD",()=>!1);ys.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ys.getBool("DEBUG"));ys.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ys.registerFlag("IS_TEST",()=>!1);ys.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ys.getBool("DEBUG"));ys.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ys.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ys.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fi(t,e){let n=t;if(on(t))return e==="string"?[]:[t.length];if(zz(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(Bz(t))return[t.buffer.size/(e==null?4:Pp(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||on(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&K().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&jz(t,s,[]),s}function jz(t,e,n){if(n=n||[],!Array.isArray(t)&&!on(t)){N(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}N(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),N(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)jz(t[r],s,n.concat(r))}function qR(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function $(t,e,n,s="numeric"){if(t instanceof J())return qR(s,t.dtype,e,n),t;let r=Bc(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),qR(s,r,e,n),t==null||!on(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Fi(t,r);!on(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Ja(t,r):Pi(t,[],!0);return P.makeTensor(a,i,r)}function Wp(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>$(i,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gI="__op";function M(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+gI;const r=(...i)=>{P.startScope(n);try{const o=s(...i);return ko(o)&&console.error("Cannot return a Promise inside of tidy."),P.endScope(o),o}catch(o){throw P.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sJ(t,e){const n=$(t,"real","complex"),s=$(e,"imag","complex");Pn(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return P.runKernel(Tb,r)}const Io=M({complex_:sJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function el(t,e,n,s){if(s==null)s=Bc(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Bz(t)||zz(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return P.backend.createTensorFromGPUData(t,e||n,s)}if(!on(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Hs(e);const r=Q(e),i=Q(n);N(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==Q(e.slice(o)):!0;N(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!on(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Ja(t,s):Pi(t,[],!0),P.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bs(t,e,n){const s=Fi(t,n);return el(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dc={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ui{static join(e){return new ui(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>on(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+r.byteLength;this.shards.push({buffer:r,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],h=e+a-c.start,d=a,p=Math.min(n,c.end)-c.start,g=new Uint8Array(c.buffer,h,p-h);if(o.set(g,d),a+=g.length,n<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=rJ(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function rJ(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,i=e(t[r]);if(i===0)return r;i<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iJ(){K().set("PROD",!0)}function oJ(){K().set("DEBUG",!0)}function aJ(){K().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function lJ(t){K().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function cJ(){P.disposeVariables()}function jr(){return P}function Ok(){return P.memory()}function uJ(t){return P.profile(t)}function q(t,e){return P.tidy(t,e)}function Ce(t){To(t).forEach(n=>n.dispose())}function ln(t){return P.keep(t)}function hJ(t){return P.time(t)}function dJ(t){return P.setBackend(t)}function fJ(){return P.ready()}function Hz(){return P.backendName}function pJ(t){P.removeBackend(t)}function mJ(t){return P.findBackend(t)}function gJ(t){return P.findBackendFactory(t)}function xI(t,e,n=1){return P.registerBackend(t,e,n)}function yI(){return P.backend}function xJ(t,e){K().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pa=4;async function Pk(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async h=>{const d=await l.bytes(),f=d.reduce((m,x)=>m+x.length,0)+Pa*d.length,p=new Uint8Array(f);let g=0;for(let m=0;m<d.length;m++){const x=d[m],y=new Uint8Array(new Uint32Array([x.length]).buffer);p.set(y,g),g+=Pa,p.set(x,g),g+=x.length}h(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(s);return{data:wJ(i),specs:n}}function bI(t,e){const n=new ui(t),s={};let r=0;for(const i of e){const o=yJ(i,(a,l)=>n.slice(r+a,r+l));s[i.name]=Gz(i,n.slice(r,r+o)),r+=o}return s}function yJ(t,e){const n=Q(t.shape);let s;if("quantization"in t){const r=t.quantization;s=dc[r.dtype]}else if(t.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=Pa+new Uint32Array(e(r,r+Pa))[0];return r}else s=dc[t.dtype];return n*s}async function bJ(t,e){const n=Q(t.shape);let s;if("quantization"in t){const r=t.quantization;s=dc[r.dtype]}else if(t.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=Pa+new Uint32Array(await e(r,r+Pa))[0];return r}else s=dc[t.dtype];return n*s}function Gz(t,e){const n=t.name,s=t.dtype,r=t.shape,i=Q(r);let o,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=dc[l.dtype],u=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(u.length);for(let h=0;h<u.length;h++){const d=u[h];o[h]=d*l.scale+l.min}}else if(l.dtype==="float16")o=IJ()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(u.length);for(let h=0;h<u.length;h++){const d=u[h];o[h]=Math.round(d*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*c}else if(s==="string"){const l=Q(t.shape);o=[];for(let c=0;c<l;c++){const u=new Uint32Array(e.slice(a,a+Pa))[0];a+=Pa;const h=new Uint8Array(e.slice(a,a+u));o.push(h),a+=u}}else{const l=dc[s];if(s==="float32")o=new Float32Array(e);else if(s==="int32")o=new Int32Array(e);else if(s==="bool")o=new Uint8Array(e);else if(s==="complex64"){o=new Float32Array(e);const c=new Float32Array(o.length/2),u=new Float32Array(o.length/2);for(let p=0;p<c.length;p++)c[p]=o[p*2],u[p]=o[p*2+1];const h=Bs(c,r,"float32"),d=Bs(u,r,"float32"),f=Io(h,d);return h.dispose(),d.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*l}return Bs(o,r,s)}async function KR(t,e,n){let s=new Uint8Array(e);for(;s.byteLength<n;){const{done:r,value:i}=await t.read();if(r&&i==null){const a=n-s.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(s.length+i.byteLength);o.set(s,0),o.set(new Uint8Array(i),s.length),s=o}return s.buffer}async function qz(t,e){const n={},s=t.getReader();let r=new ArrayBuffer(0);for(const i of e){const o=await bJ(i,async(c,u)=>(r=await KR(s,r,u),r.slice(c,u)));r=await KR(s,r,o);const a=r.slice(0,o);r=r.slice(o);const l=Gz(i,a);if(n[i.name]=l,Hz()==="webgpu"){const c=yI();"uploadToGPU"in c&&Q(l.shape)>=K().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return n}function wJ(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const wI=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function XR(t){return wI?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function vJ(t){if(wI)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function SJ(t){if(wI){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function Kz(t){return ui.join(t)}function YR(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function Xz(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function vI(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function SI(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),vI(t,n,s)}function Cg(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:XR(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:XR(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new ui(t.weightData).byteLength}}function Zy(t){const e=[];for(const n of t)e.push(...n.weights);return e}function kJ(){const t=n=>{let s=n<<13,r=0;for(;!(s&8388608);)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function CJ(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function TJ(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function IJ(){const t=kJ(),e=CJ(),n=TJ();return s=>{const r=new ArrayBuffer(4*s.length),i=new Uint32Array(r);for(let o=0;o<s.length;o++){const a=s[o],l=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ct{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Ct.instance==null&&(Ct.instance=new Ct),Ct.instance}static registerSaveRouter(e){Ct.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Ct.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Ct.getHandlers(e,"save")}static getLoadHandlers(e,n){return Ct.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Ct.getInstance().loadRouters:Ct.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&r.push(a)}),r}}const NJ=t=>Ct.registerSaveRouter(t),_J=t=>Ct.registerLoadRouter(t),Yz=t=>Ct.getSaveHandlers(t),Qz=(t,e)=>Ct.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fk="tensorflowjs",Mk=1,zl="models_store",ia="model_info_store";function Zz(){if(!K().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Lk(t){const e=t.result;e.createObjectStore(zl,{keyPath:"modelPath"}),e.createObjectStore(ia,{keyPath:"modelPath"})}class fc{constructor(e){if(this.indexedDB=Zz(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const i=this.indexedDB.open(Fk,Mk);i.onupgradeneeded=()=>Lk(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(zl,"readonly"),c=a.objectStore(zl).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=ui.join(n.weightData);const a=Cg(n),l=o.transaction(ia,"readwrite");let c=l.objectStore(ia),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return r(d)}let h;u.onsuccess=()=>{h=o.transaction(zl,"readwrite");const d=h.objectStore(zl);let f;try{f=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(ia);const g=c.delete(this.modelPath);g.onsuccess=()=>(o.close(),r(f.error)),g.onerror=m=>(o.close(),r(f.error))}},u.onerror=d=>(o.close(),r(u.error)),l.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}fc.URL_SCHEME="indexeddb://";const Jz=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(fc.URL_SCHEME)?$J(t.slice(fc.URL_SCHEME.length)):null;Ct.registerSaveRouter(Jz);Ct.registerLoadRouter(Jz);function $J(t){return new fc(t)}function EJ(t){return t.startsWith(fc.URL_SCHEME)?t.slice(fc.URL_SCHEME.length):t}class DJ{constructor(){this.indexedDB=Zz()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(Fk,Mk);s.onupgradeneeded=()=>Lk(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(ia,"readonly"),a=i.objectStore(ia).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=EJ(e),new Promise((n,s)=>{const r=this.indexedDB.open(Fk,Mk);r.onupgradeneeded=()=>Lk(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(ia,"readwrite"),a=o.objectStore(ia),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),h=()=>{c=i.transaction(zl,"readwrite");const f=c.objectStore(zl).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=h,u.onerror=d=>(h(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const to="/",du="tensorflowjs_models",eB="info",AJ="model_topology",RJ="weight_specs",OJ="weight_data",PJ="model_metadata";function tB(t){return{info:[du,t,eB].join(to),topology:[du,t,AJ].join(to),weightSpecs:[du,t,RJ].join(to),weightData:[du,t,OJ].join(to),modelMetadata:[du,t,PJ].join(to)}}function nB(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function FJ(t){const e=t.split(to);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(to)}function MJ(t){return t.startsWith(pc.URL_SCHEME)?t.slice(pc.URL_SCHEME.length):t}class pc{constructor(e){if(!K().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=tB(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Cg(e),i=ui.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,vJ(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw nB(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=SJ(o),n}}pc.URL_SCHEME="localstorage://";const sB=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(pc.URL_SCHEME)?LJ(t.slice(pc.URL_SCHEME.length)):null;Ct.registerSaveRouter(sB);Ct.registerLoadRouter(sB);function LJ(t){return new pc(t)}class zJ{constructor(){N(K().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),N(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=du+to,s=to+eB;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=FJ(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=MJ(e);const n=tB(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return nB(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bu="://";class Yn{constructor(){this.managers={}}static getInstance(){return Yn.instance==null&&(Yn.instance=new Yn),Yn.instance}static registerManager(e,n){N(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Bu)&&(e=e.slice(0,e.indexOf(Bu))),N(e.length>0,()=>"scheme must not be an empty string.");const s=Yn.getInstance();N(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=Yn.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(Yn.getInstance().managers)}}function Dx(t){if(t.indexOf(Bu)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Yn.getSchemes().join(",")}`);return{scheme:t.split(Bu)[0],path:t.split(Bu)[1]}}async function rB(t,e,n=!1){N(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=Ct.getLoadHandlers(t);N(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),N(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const r=s[0],i=Ct.getSaveHandlers(e);N(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),N(i.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const o=i[0],a=Dx(t).scheme,l=Dx(t).path,c=a===Dx(t).scheme,u=await r.load();n&&c&&await Yn.getManager(a).removeModel(l);const h=await o.save(u);return n&&!c&&await Yn.getManager(a).removeModel(l),h.modelArtifactsInfo}async function BJ(){const t=Yn.getSchemes(),e={};for(const n of t){const s=await Yn.getManager(n).listModels();for(const r in s){const i=n+Bu+r;e[i]=s[r]}}return e}async function VJ(t){const e=Dx(t);return Yn.getManager(e.scheme).removeModel(e.path)}async function WJ(t,e){return rB(t,e,!1)}async function UJ(t,e){return rB(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jJ{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!K().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return Nz(e)}}if(K().get("IS_BROWSER")){K().setPlatform("browser",new jJ);try{Yn.registerManager(pc.URL_SCHEME,new zJ)}catch{}try{Yn.registerManager(fc.URL_SCHEME,new DJ)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HJ={importFetch:()=>require("node-fetch")};let L2;class GJ{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return K().global.fetch!=null?K().global.fetch(e,n):(L2==null&&(L2=HJ.importFetch()),L2(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}K().get("IS_NODE")&&!K().get("IS_BROWSER")&&K().setPlatform("node",new GJ);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function De(t,e="float32",n){return e=e||"float32",Hs(t),new nn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qJ(t,e){const n=$(t,"x","cast");if(!xz(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return P.runKernel(Ph,s,r)}const ae=M({cast_:qJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KJ(t){const n={x:$(t,"x","clone","string_or_numeric")};return P.runKernel(Kh,n)}const Ei=M({clone_:KJ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kI(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Uz();const XJ={buffer:De,cast:ae,clone:Ei,print:kI};KZ(XJ);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJ(t,e){let n=$(t,"a","add"),s=$(e,"b","add");[n,s]=$t(n,s);const r={a:n,b:s};return P.runKernel(Wc,r)}const se=M({add_:YJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QJ(t,e){let n=$(t,"a","floorDiv"),s=$(e,"b","floorDiv");[n,s]=$t(n,s);const r={a:n,b:s};return P.runKernel(Gh,r)}const Nw=M({floorDiv_:QJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(t,e){let n=$(t,"a","div"),s=$(e,"b","div");if([n,s]=$t(n,s),n.dtype==="int32"&&s.dtype==="int32")return Nw(n,s);const r={a:n,b:s},i={};return P.runKernel(Bh,r,i)}const ge=M({div_:ZJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JJ(t,e){let n=$(t,"a","mul"),s=$(e,"b","mul");[n,s]=$t(n,s);const r={a:n,b:s};return P.runKernel(sd,r)}const W=M({mul_:JJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(t){const e=$(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return P.runKernel($m,n)}else{const n={x:e};return P.runKernel(wm,n)}}const Xt=M({abs_:eee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tee(t){const n={x:$(t,"x","acos")};return P.runKernel(_h,n)}const CI=M({acos_:tee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(t){const n={x:$(t,"x","acosh")};return P.runKernel($h,n)}const TI=M({acosh_:nee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function see(t){N(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),N(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((r,i)=>$(r,`tensors${i}`,"addN")),n=e[0];e.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!Fe(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return P.runKernel(vm,s)}const iB=M({addN_:see});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(t,e=null,n=!1){const r={x:$(t,"x","all","bool")},i={axis:e,keepDims:n};return P.runKernel(bb,r,i)}const _w=M({all_:ree});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iee(t,e=null,n=!1){const r={x:$(t,"x","any","bool")},i={axis:e,keepDims:n};return P.runKernel(wb,r,i)}const Up=M({any_:iee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(t,e=0){const s={x:$(t,"x","argMax")},r={axis:e};return P.runKernel(Sm,s,r)}const mc=M({argMax_:oee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(t,e=0){const s={x:$(t,"x","argMin")},r={axis:e};return P.runKernel(km,s,r)}const II=M({argMin_:aee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lee(t){const n={x:$(t,"x","asin")};return P.runKernel(Eh,n)}const NI=M({asin_:lee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cee(t){const n={x:$(t,"x","asinh")};return P.runKernel(Dh,n)}const _I=M({asinh_:cee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(t){const n={x:$(t,"x","atan")};return P.runKernel(Ah,n)}const $I=M({atan_:uee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hee(t,e){let n=$(t,"a","atan2"),s=$(e,"b","atan2");[n,s]=$t(n,s);const r={a:n,b:s};return P.runKernel(Oh,r)}const EI=M({atan2_:hee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dee(t){const n={x:$(t,"x","atanh")};return P.runKernel(Rh,n)}const DI=M({atanh_:dee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tg(t,e,n,s,r="NHWC",i){const o=t[3],a=[...e,o],l=Oo(r);return Cn(t,a,n,i,s,null,null,l)}function Fr(t,e,n,s,r,i,o="channelsLast"){const[a,l]=jp(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Cn(t,c,n,s,r,i,!1,o)}function Ro(t,e,n,s,r,i,o="NDHWC"){const[a,l,c]=zk(e);let u,h;if(o==="NDHWC")h="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")h="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return tl(t,u,n,s,r,!1,h,i)}function Cn(t,e,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,h]=t;else if(a==="channelsFirst")[l,h,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[d,f,,p]=e,[g,m]=jp(n),[x,y]=jp(s),b=Vu(d,x),w=Vu(f,y),{padInfo:v,outHeight:S,outWidth:T}=mee(r,c,u,g,m,b,w,i,a),k=o?p*h:p;let I;return a==="channelsFirst"?I=[l,k,S,T]:a==="channelsLast"&&(I=[l,S,T,k]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:h,outHeight:S,outWidth:T,outChannels:k,padInfo:v,strideHeight:g,strideWidth:m,filterHeight:d,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:x,dilationWidth:y,inShape:t,outShape:I,filterShape:e}}function tl(t,e,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,h,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,h,d]=t;else if(o==="channelsFirst")[l,d,c,u,h]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,g,,m]=e,[x,y,b]=zk(n),[w,v,S]=zk(s),T=Vu(f,w),k=Vu(p,v),I=Vu(g,S),{padInfo:_,outDepth:D,outHeight:A,outWidth:L}=gee(r,c,u,h,x,y,b,T,k,I,a),B=i?m*d:m;let F;return o==="channelsFirst"?F=[l,B,D,A,L]:o==="channelsLast"&&(F=[l,D,A,L,B]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:h,inChannels:d,outDepth:D,outHeight:A,outWidth:L,outChannels:B,padInfo:_,strideDepth:x,strideHeight:y,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:g,effectiveFilterDepth:T,effectiveFilterHeight:k,effectiveFilterWidth:I,dilationDepth:w,dilationHeight:v,dilationWidth:S,inShape:t,outShape:F,filterShape:e}}function fee(t,e,n,s,r){s==null&&(s=AI(t,e,n));const i=t[0],o=t[1],a=Hp((i-e+2*s)/n+1,r),l=Hp((o-e+2*s)/n+1,r);return[a,l]}function pee(t,e,n,s,r,i){r==null&&(r=AI(t,e[0],s[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(o[a]=Hp((t[a]-e[a]+2*r)/s[a]+1,i));return o}function AI(t,e,n,s=1){const r=Vu(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function jp(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function zk(t){return typeof t=="number"?[t,t,t]:t}function Vu(t,e){return e<=1?t:t+(t-1)*(e-1)}function mee(t,e,n,s,r,i,o,a,l){let c,u,h;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=fee([e,n],i,s,t,a);u=f[0],h=f[1]}else if(t==="same"){u=Math.ceil(e/s),h=Math.ceil(n/r);const d=Math.max(0,(u-1)*s+i-e),f=Math.max(0,(h-1)*r+o-n),p=Math.floor(d/2),g=d-p,m=Math.floor(f/2),x=f-m;c={top:p,bottom:g,left:m,right:x,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/s),h=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const d=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];c={top:d,bottom:f,left:p,right:g,type:d===0&&f===0&&p===0&&g===0?"VALID":"EXPLICIT"},u=Hp((e-i+d+f)/s+1,a),h=Hp((n-o+p+g)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:h}}function gee(t,e,n,s,r,i,o,a,l,c,u){let h,d,f,p;if(t==="valid"&&(t=0),typeof t=="number"){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const m=pee([e,n,s,1],[a,l,c],1,[r,i,o],t,u);d=m[0],f=m[1],p=m[2]}else if(t==="same"){d=Math.ceil(e/r),f=Math.ceil(n/i),p=Math.ceil(s/o);const g=(d-1)*r+a-e,m=(f-1)*i+l-n,x=(p-1)*o+c-s,y=Math.floor(g/2),b=g-y,w=Math.floor(m/2),v=m-w,S=Math.floor(x/2),T=x-S;h={top:w,bottom:v,left:S,right:T,front:y,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}function Hp(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Fa(t){const[e,n,s]=jp(t);return e===1&&n===1&&s===1}function Fn(t,e){return Fa(t)||Fa(e)}function gc(t){return jp(t).every(e=>e>0)}function Oo(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function ls(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")N(hc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{N(hc(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t,e){const s={x:$(t,"x","reshape","string_or_numeric")},r={shape:e};return P.runKernel(cg,s,r)}const U=M({reshape_:xee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(t,e,n,s,r){const i=$(t,"x","avgPool","float32"),o=1;N(Fn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),N(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),ls("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let h=P.runKernel(Cm,c,u);return h=ae(h,i.dtype),l?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Ig=M({avgPool_:yee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bee(t,e,n,s,r,i="NDHWC"){const o=$(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),N(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),N(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),N(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),ls("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let h=P.runKernel(Tm,c,u);return h=ae(h,a.dtype),l?U(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const RI=M({avgPool3d_:bee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wee(t,e=0){N(t.length>=1,()=>"Pass at least one tensor to concat");const n=Wp(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Ei(n[0]);const s=n,r={axis:e};return P.runKernel(Em,s,r)}const Vt=M({concat_:wee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vee(t,e,n=!1,s=!1){let r=$(t,"a","matMul"),i=$(e,"b","matMul");[r,i]=$t(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return P.runKernel(Im,o,a)}const Re=M({matMul_:vee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(t){const n={x:$(t,"x","sigmoid","float32")};return P.runKernel(pd,n)}const Jr=M({sigmoid_:See});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(t,e,n){const s=$(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:n};return P.runKernel(pg,r,i)}const Be=M({slice_:kee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(t){const n={x:$(t,"x","tanh","float32")};return P.runKernel(wd,n)}const Ma=M({tanh_:Cee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(t,e,n,s,r,i){const o=$(t,"forgetBias","basicLSTMCell"),a=$(e,"lstmKernel","basicLSTMCell"),l=$(n,"lstmBias","basicLSTMCell"),c=$(s,"data","basicLSTMCell"),u=$(r,"c","basicLSTMCell"),h=$(i,"h","basicLSTMCell"),d=Vt([c,h],1),f=Re(d,a),p=se(f,l),g=p.shape[0],m=p.shape[1]/4,x=[g,m],y=Be(p,[0,0],x),b=Be(p,[0,m],x),w=Be(p,[0,m*2],x),v=Be(p,[0,m*3],x),S=se(W(Jr(y),Ma(b)),W(u,Jr(se(o,w)))),T=W(Ma(S),Jr(v));return[S,T]}const oB=M({basicLSTMCell_:Tee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iee(t,e,n){const s=$(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);N(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),N(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),N(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},o={blockShape:e,crops:n};return P.runKernel(Nm,i,o)}const Ng=M({batchToSpaceND_:Iee});function Nee(t){let e;return t.rank===0||t.rank===1?e=U(t,[1,1,1,t.size]):t.rank===2?e=U(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(t,e,n,s,r,i){i==null&&(i=.001);const o=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let u;s!=null&&(u=$(s,"offset","batchNorm")),N(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:Nee(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=P.runKernel(zm,d,f);return U(p,o.shape)}const kd=M({batchNorm_:_ee});function $ee(t,e,n,s,r,i){const o=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let u;return s!=null&&(u=$(s,"offset","batchNorm")),N(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),N(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),N(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&N(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&N(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),kd(o,a,l,u,c,i)}const OI=M({batchNorm2d_:$ee});function Eee(t,e,n,s,r,i){const o=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let u;return s!=null&&(u=$(s,"offset","batchNorm")),N(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),N(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),N(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&N(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&N(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),kd(o,a,l,u,c,i)}const PI=M({batchNorm3d_:Eee});function Dee(t,e,n,s,r,i){const o=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let u;return s!=null&&(u=$(s,"offset","batchNorm")),N(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),N(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),N(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&N(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&N(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),kd(o,a,l,u,c,i)}const FI=M({batchNorm4d_:Dee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(t,e,n){const s=$(t,"x","bincount"),r=$(e,"weights","bincount");N(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),N(n>=0,()=>`size must be non-negative, but got ${n}.`),N(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return P.runKernel(kb,i,o)}const MI=M({bincount_:Aee});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ree(t,e){const n=$(t,"x","bitwiseAnd"),s=$(e,"y","bitwiseAnd");if(!Fe(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return P.runKernel(_m,r)}const aB=M({bitwiseAnd_:Ree});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oee(t,e){const n=$(t,"s0","broadcastArgs","int32"),s=$(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return P.runKernel(Cb,r)}const lB=M({broadcastArgs_:Oee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t,e){let n=$(t,"broadcastTo","x");const s=n.shape;if(Hs(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=U(n,c)}const r=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Ei(n);const a={x:n},l={reps:i};return P.runKernel(vd,a,l)}const Kl=M({broadcastTo_:Pee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(t){const n={x:$(t,"x","ceil","float32")};return P.runKernel(Fh,n)}const LI=M({ceil_:Fee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jc(t,e,n){Hs(t),n=n||Bc(e);const s={shape:t,value:e,dtype:n};return P.runKernel(Bb,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(t,e,n){const s=$(t,"x","clipByValue");if(N(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return jc(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:n};return P.runKernel(Mh,r,i)}const bs=M({clipByValue_:Mee});function Lee(t){return Vt(t,0)}const zI=M({concat1d_:Lee});function zee(t,e){return Vt(t,e)}const BI=M({concat2d_:zee});function Bee(t,e){return Vt(t,e)}const VI=M({concat3d_:Bee});function Vee(t,e){return Vt(t,e)}const WI=M({concat4d_:Vee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(t,e,n,s,r="NHWC",i=[1,1],o){const a=$(t,"x","conv2d","float32"),l=$(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),N(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),N(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),ls("conv2d",s,o);const h=r==="NHWC"?c.shape[3]:c.shape[1];N(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),N(Fn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),N(gc(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),N(gc(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=P.runKernel(Dm,d,f);return u?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const No=M({conv2d_:Wee});function Uee(t,e,n,s,r="NWC",i=1,o){const a=$(t,"x","conv1d"),l=$(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1]])),N(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),N(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),ls("conv1d",s,o),N(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),N(Fn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),N(gc(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),N(gc(n),()=>"Error in conv1D: Stride should be larger than 0."),N(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const h=U(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=U(c,[c.shape[0],1,c.shape[1],c.shape[2]]),m=No(d,h,[1,n],s,"NHWC",[1,i],o);return u?U(m,[m.shape[2],m.shape[3]]):U(m,[m.shape[0],m.shape[2],m.shape[3]])}const $w=M({conv1d_:Uee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(t,e,n,s,r,i="NHWC",o){N(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),N(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),N(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),N(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],h=i==="NHWC"?l.shape[3]:l.shape[1];N(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),N(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),ls("conv2dDerInput",r,o);const d={dy:l,filter:n},f={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},p=P.runKernel(Am,d,f);return c?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const UI=M({conv2DBackpropInput_:jee});function Hee(t,e,n,s,r,i){const o=$(t,"x","conv2dTranspose"),a=$(e,"filter","conv2dTranspose");return UI(n,o,a,s,r,"NHWC",i)}const Ew=M({conv2dTranspose_:Hee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gee(t,e,n,s,r="NDHWC",i=[1,1,1]){const o=$(t,"x","conv3d"),a=$(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),N(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),N(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),N(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),N(Fn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),N(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),N(gc(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),N(gc(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},h={strides:n,pad:s,dataFormat:r,dilations:i},d=P.runKernel(Rm,u,h);return c?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const jI=M({conv3d_:Gee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(t,e,n,s,r){N(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];N(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),N(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),N(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),N(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),N(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},h={pad:r,strides:s,inputShape:i},d=P.runKernel(_b,u,h);return a?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const cB=M({conv3DBackpropInput_:qee});function Kee(t,e,n,s,r){const i=$(t,"x","conv3dTranspose"),o=$(e,"filter","conv3dTranspose");return cB(n,i,o,s,r)}const HI=M({conv3dTranspose_:Kee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(t){const n={x:$(t,"x","cos","float32")};return P.runKernel(Lh,n)}const _g=M({cos_:Xee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yee(t){const n={x:$(t,"x","cosh","float32")};return P.runKernel(zh,n)}const Dw=M({cosh_:Yee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t,e=0,n=!1,s=!1){const i={x:$(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return P.runKernel($b,i,o)}const Gp=M({cumprod_:Qee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t,e=0,n=!1,s=!1){const i={x:$(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return P.runKernel(Om,i,o)}const Aw=M({cumsum_:Zee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(t,e,n,s=!1){const r=$(t,"x","denseBincount"),i=$(e,"weights","denseBincount");N(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),N(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),N(n>=0,()=>`size must be non-negative, but got ${n}.`),N(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return P.runKernel(Db,o,a)}const Jy=M({denseBincount_:Jee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(t,e,n="NHWC"){const s=$(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];N(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),N(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),N(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),N(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return P.runKernel(Ab,a,l)}const GI=M({depthToSpace_:ete});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(t,e,n,s,r="NHWC",i=[1,1],o){const a=$(t,"x","depthwiseConv2d","float32"),l=$(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),N(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),N(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=r==="NHWC"?c.shape[3]:c.shape[1];N(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),ls("depthwiseConv2d",s,o);const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=P.runKernel(Pm,d,f);return u?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Cd=M({depthwiseConv2d_:tte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(t){const n={x:$(t,"x","diag")};return P.runKernel(Pb,n)}const uB=M({diag_:nte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ste(t,e,n,s,r=[1,1],i="NHWC"){const o=$(t,"x","dilation2d"),a=$(e,"filter","dilation2d");N(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),N(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),N(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),N(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},h={strides:n,pad:s,dilations:r},d=P.runKernel(Fm,u,h);return c?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const qI=M({dilation2d_:ste});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xc(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=t[i]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function sn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],i=e.length-s-1,o=e[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function Te(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let i=t[t.length-r-1];i==null&&(i=1);let o=e[e.length-r-1];if(o==null&&(o=1),i===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=i}return s}const rte=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Te,getBroadcastDims:xc,getReductionAxes:sn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ite(t,e){let n=$(t,"a","equal","string_or_numeric"),s=$(e,"b","equal","string_or_numeric");[n,s]=$t(n,s),Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(Mm,r)}const Vs=M({equal_:ite});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(t,e,n){const s=$(e,"a","where"),r=$(n,"b","where"),i=$(t,"condition","where","bool"),o=Te(Te(i.shape,s.shape),r.shape),a=Kl(i,o),l=Kl(s,o),c=Kl(r,o),u={condition:a,t:l,e:c};return P.runKernel(fg,u)}const wn=M({where_:ote});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ate(t){const n={x:$(t,"x","zerosLike")};return P.runKernel(Sg,n)}const Ve=M({zerosLike_:ate});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(t,e){let n=$(t,"a","div"),s=$(e,"b","div");[n,s]=$t(n,s);const r=ge(n,s),i=Ve(r),o=Vs(s,i);return wn(o,i,r)}const KI=M({divNoNan_:lte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(t,e){const n=$(t,"t1","dot"),s=$(e,"t2","dot");N((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(N(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=U(n,[1,-1]),a=U(s,[-1,1]),l=Re(o,a);return U(l,[])}else if(n.rank===1&&s.rank===2){const o=U(n,[1,-1]),a=U(s,[s.shape[0],s.shape[1]]),l=Re(o,a);return U(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=U(s,[-1,1]),a=Re(n,o);return U(a,[a.size])}else{const o=U(s,[s.shape[0],s.shape[1]]);return Re(n,o)}}const XI=M({dot_:cte});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ute(t,...e){const n=e.map((r,i)=>$(r,`tensors${i}`,"einsum")),s={equation:t};return P.runKernel(Mb,n,s)}const $l=M({einsum_:ute});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(t){const n={x:$(t,"x","elu","float32")};return P.runKernel(Vh,n)}const Td=M({elu_:hte});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(t,e){const n=$(t,"x","ensureShape","string_or_numeric");if(!mz(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const hB=M({ensureShape_:dte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fte(t){let e=$(t,"x","erf");N(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=ae(e,"float32"));const n={x:e};return P.runKernel(Wh,n)}const Rw=M({erf_:fte});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YI(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function dB(t,e,n){const s=t.length+e.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[i++]):r.push(e[o++]);return r}function Tn(t,e){const n=[],s=t.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&n.push(t[i]);const r=e.map(i=>t[i]);return[n,r]}function Wt(t,e){const n=e.map(s=>1);return dB(t,n,e)}function Mn(t,e,n){N(YI(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Et(t,e){if(YI(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function nl(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Ht(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(t,e=null,n=!1){const r={x:$(t,"x","max")},i={reductionIndices:e,keepDims:n};return P.runKernel(Xm,r,i)}const lr=M({max_:pte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(t,e=null,n=!1){const r={x:$(t,"x","min")},i={axis:e,keepDims:n};return P.runKernel(Jm,r,i)}const oh=M({min_:mte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gte(t,e){let n=$(t,"base","pow"),s=$(e,"exp","pow");[n,s]=$t(n,s);const r={a:n,b:s};return P.runKernel(rd,r)}const Mi=M({pow_:gte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function be(t,e){if((on(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&on(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return el(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xte(t){const n={x:$(t,"x","sqrt","float32")};return P.runKernel(gd,n)}const Sn=M({sqrt_:xte});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(t){const e=$(t,"x","square"),n={};return P.runKernel("Square",{x:e},n)}const rt=M({square_:yte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bte(t,e=null,n=!1){let s=$(t,"x","sum");s.dtype==="bool"&&(s=ae(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return P.runKernel(mg,r,i)}const fe=M({sum_:bte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(t,e="euclidean",n=null,s=!1){t=$(t,"x","norm");const r=fB(t,e,n);let i=r.shape;if(s){const o=Oe(n,t.shape);i=Wt(r.shape,o)}return U(r,i)}function fB(t,e,n=null){if(t.rank===0)return Xt(t);if(t.rank!==1&&n===null)return fB(U(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return fe(Xt(t),n);if(e===1/0)return lr(Xt(t),n);if(e===-1/0)return oh(Xt(t),n);if(e==="euclidean"||e===2)return Sn(fe(Mi(Xt(t),be(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return lr(fe(Xt(t),n[0]),n[1]-1);if(e===1/0)return lr(fe(Xt(t),n[1]),n[0]);if(e===-1/0)return oh(fe(Xt(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Sn(fe(rt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Id=M({norm_:wte});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vte(t,e=null,n=!1){return Id(t,"euclidean",e,n)}const QI=M({euclideanNorm_:vte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ste(t){const n={x:$(t,"x","exp")};return P.runKernel(Uh,n)}const ws=M({exp_:Ste});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kte(t,e=0){const n=$(t,"x","expandDims","string_or_numeric");N(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return P.runKernel(Lm,s,r)}const $n=M({expandDims_:kte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(t){const n={x:$(t,"x","expm1")};return P.runKernel(jh,n)}const ZI=M({expm1_:Cte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tte(t,e){const n=$(t,"x","tile","string_or_numeric");N(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return P.runKernel(vd,s,r)}const sr=M({tile_:Tte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ite(t,e,n,s="float32"){e==null&&(e=t);const r=De([t,e],s),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=U(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return sr($n(o,0),[n[0],1,1]);if(n.length===2)return sr($n($n(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return sr($n($n($n(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Ow=M({eye_:Ite});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t){const n={x:$(t,"x","floor","float32")};return P.runKernel(Hh,n)}const Nd=M({floor_:Nte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _te(t,e,n=0,s=0){const r=$(t,"x","gather"),i=$(e,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return P.runKernel(Bm,o,a)}const _d=M({gather_:_te});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(t,e){let n=$(t,"a","greater","string_or_numeric"),s=$(e,"b","greater","string_or_numeric");[n,s]=$t(n,s),Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(Vm,r)}const cs=M({greater_:$te});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(t,e){let n=$(t,"a","greaterEqual","string_or_numeric"),s=$(e,"b","greaterEqual","string_or_numeric");[n,s]=$t(n,s),Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(qh,r)}const Po=M({greaterEqual_:Ete});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dte(t){const n={input:$(t,"input","imag")};return P.runKernel(jb,n)}const $g=M({imag_:Dte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(t){const n={x:$(t,"x","isFinite")};return P.runKernel(Xh,n)}const JI=M({isFinite_:Ate});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rte(t){const n={x:$(t,"x","isInf")};return P.runKernel(Yh,n)}const eN=M({isInf_:Rte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(t){const n={x:$(t,"x","isNaN")};return P.runKernel(Qh,n)}const tN=M({isNaN_:Ote});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(t,e=.2){const s={x:$(t,"x","leakyRelu")},r={alpha:e};return P.runKernel(Wm,s,r)}const Eg=M({leakyRelu_:Pte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t,e){let n=$(t,"a","less","string_or_numeric"),s=$(e,"b","less","string_or_numeric");[n,s]=$t(n,s),Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(Um,r)}const ah=M({less_:Fte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(t,e){let n=$(t,"a","lessEqual","string_or_numeric"),s=$(e,"b","lessEqual","string_or_numeric");[n,s]=$t(n,s),Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(jm,r)}const sl=M({lessEqual_:Mte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return P.runKernel(Hb,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t,e=5,n=1,s=1,r=.5){const i=$(t,"x","localResponseNormalization");N(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),N(hc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=U(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:s,beta:r},u=P.runKernel(Km,l,c);return a?U(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const nN=M({localResponseNormalization_:Lte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t){const n={x:$(t,"x","log","float32")};return P.runKernel(Zh,n)}const Ws=M({log_:zte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bte(t){const n={x:$(t,"x","log1p")};return P.runKernel(Jh,n)}const Dg=M({log1p_:Bte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t){return N(Oa(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const s=$(e,"x","tf.grad","string_or_numeric"),r=n!=null?$(n,"dy","tf.grad"):null;return P.tidy(()=>{const{value:i,grads:o}=P.gradients(()=>t(s),[s],r);return r!=null&&Pn(i.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Pw(o),o[0]})}}function Wte(t){return N(Oa(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{N(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=Wp(e,"args","tf.grads","string_or_numeric"),r=n!=null?$(n,"dy","tf.grads"):null;return P.tidy(()=>{const{value:i,grads:o}=P.gradients(()=>t(...s),s,r);return r!=null&&Pn(i.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Pw(o),o})}}function Ute(t){return N(Oa(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{N(e instanceof je,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),N(n==null||n instanceof je,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=P.gradients(()=>t(e),[e],n);return Pw(s),{grad:s[0],value:r}}}function jte(t){return N(Oa(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{N(Array.isArray(e)&&e.every(r=>r instanceof je),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),N(n==null||n instanceof je,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=P.gradients(()=>t(...e),e,n);return n!=null&&Pn(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Pw(s.grads),s}}function mB(t,e){N(Oa(t),()=>"The f passed in variableGrads(f) must be a function"),N(e==null||Array.isArray(e)&&e.every(c=>c instanceof Vp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in P.registeredVariables)e.push(P.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),N(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=P.gradients(t,e,null,i);N(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),N(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function Li(t){return P.customGrad(t)}function Pw(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(t){const n={x:$(t,"x","neg")};return P.runKernel(tg,n)}const ct=M({neg_:Hte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(t){const n={x:$(t,"x","softplus")};return P.runKernel(md,n)}const Hc=M({softplus_:Gte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qte(t){const e=$(t,"x","logSigmoid");return Li(s=>({value:ct(Hc(ct(s))),gradFunc:o=>W(o,Jr(ct(s)))}))(e)}const sN=M({logSigmoid_:qte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kte(t,e){let n=$(t,"a","sub"),s=$(e,"b","sub");[n,s]=$t(n,s);const r={a:n,b:s};return P.runKernel(yd,r)}const de=M({sub_:Kte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xte(t,e=-1){const n=$(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Li((r,i)=>{const a=lr(r,e,!0),l=de(r,a),c=de(ae(l,"float32"),Ws(fe(ws(l),e,!0)));return i([c]),{value:c,gradFunc:(h,d)=>{const[f]=d,p=!0,g=ws(f);return de(h,W(fe(h,e,p),g))}}})(n)}const Fw=M({logSoftmax_:Xte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(t,e=null,n=!1){const s=$(t,"x","logSumExp"),r=Oe(e,s.shape),i=lr(s,r,!0),o=de(s,i),a=ws(o),l=fe(a,r),c=Ws(l),u=se(U(i,c.shape),c);if(n){const h=Wt(u.shape,r);return U(u,h)}return u}const Ag=M({logSumExp_:Yte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qte(t,e){const n=$(t,"a","logicalAnd","bool"),s=$(e,"b","logicalAnd","bool");Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(Hm,r)}const Pr=M({logicalAnd_:Qte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(t){const n={x:$(t,"x","logicalNot","bool")};return P.runKernel(Gm,n)}const Rg=M({logicalNot_:Zte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jte(t,e){const n=$(t,"a","logicalOr","bool"),s=$(e,"b","logicalOr","bool");Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(qm,r)}const Mw=M({logicalOr_:Jte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t,e){const n=$(t,"a","logicalXor","bool"),s=$(e,"b","logicalXor","bool");return Te(n.shape,s.shape),Pr(Mw(t,e),Rg(Pr(t,e)))}const rN=M({logicalXor_:ene});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L0=2147483648;function tne(t,e,n="left"){const s=$(t,"sortedSequence","searchSorted"),r=$(e,"values","searchSorted"),i=s.shape[s.shape.length-1],o=r.shape[r.shape.length-1],a=U(s,[-1,i]),l=U(r,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Q(l.shape)>=L0)throw new Error(`values tensor size must less than ${L0}`);if(a.shape[1]>=L0)throw new Error(`trailing dim_size must less than ${L0} for int32 output type, was ${a.shape[1]}`);const c={sortedSequence:a,values:l},u={side:n};return P.runKernel(cw,c,u)}const Lw=M({searchSorted_:tne});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gB(t,e){return Lw(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t,e,n,s,r){const i=$(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),N(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),N(Fn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),ls("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},h=P.runKernel(Ym,c,u);return l?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Og=M({maxPool_:nne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sne(t,e=[1,1,1],n,s,r,i="NDHWC"){const o=$(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),N(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),N(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),ls("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},h=P.runKernel(Qm,c,u);return l?U(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const iN=M({maxPool3d_:sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(t,e,n,s,r=!1){const o={x:$(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:s,includeBatchInIndex:r},l=P.runKernel(Xb,o,a);return{result:l[0],indexes:l[1]}}const xB=M({maxPoolWithArgmax_:rne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t,e){let n=$(t,"a","maximum"),s=$(e,"b","maximum");[n,s]=$t(n,s),n.dtype==="bool"&&(n=ae(n,"int32"),s=ae(s,"int32")),Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(ed,r)}const Vi=M({maximum_:ine});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t,e=null,n=!1){const r={x:$(t,"x","mean")},i={axis:e,keepDims:n};return P.runKernel(Zm,r,i)}const It=M({mean_:one});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qt(t,e="float32"){if(Hs(t),e==="complex64"){const s=Qt(t,"float32"),r=Qt(t,"float32");return Io(s,r)}const n=On(Q(t),e);return P.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ps(t,e="float32"){if(Hs(t),e==="complex64"){const s=ps(t,"float32"),r=Qt(t,"float32");return Io(s,r)}const n=yb(Q(t),e);return P.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=$(t,"x","meshgrid",t instanceof je?t.dtype:"float32");if(e===void 0)return[s];let r=$(e,"y","meshgrid",e instanceof je?e.dtype:"float32");const i=Q(s.shape),o=Q(r.shape);return n==="xy"?(s=U(s,[1,-1]),r=U(r,[-1,1]),[Re(ps([o,1],s.dtype),s),Re(r,ps([1,i],r.dtype))]):(s=U(s,[-1,1]),r=U(r,[1,-1]),[Re(s,ps([1,o],s.dtype)),Re(ps([i,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(t,e){let n=$(t,"a","minimum"),s=$(e,"b","minimum");[n,s]=$t(n,s),n.dtype==="bool"&&(n=ae(n,"int32"),s=ae(s,"int32")),Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(td,r)}const La=M({minimum_:ane});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(t,e,n){N(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=$(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");N(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)N(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),N(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:n},o={x:s};return P.runKernel(eg,o,i)}const oN=M({mirrorPad_:lne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(t,e){let n=$(t,"a","mod"),s=$(e,"b","mod");[n,s]=$t(n,s);const r={a:n,b:s};return P.runKernel(nd,r)}const aN=M({mod_:cne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(t,e=null,n=!1){t=$(t,"x","moments");const s=Oe(e,t.shape),r=It(t,s,n);let i=r.shape;n||(i=Wt(r.shape,s));const o=rt(de(ae(t,"float32"),U(r,i))),a=It(o,s,n);return{mean:r,variance:a}}const Pg=M({moments_:une});function hne(t,e,n,s){const r=$(e,"data","multiRNNCell"),i=Wp(n,"c","multiRNNCell"),o=Wp(s,"h","multiRNNCell");let a=r;const l=[];for(let h=0;h<t.length;h++){const d=t[h](a,i[h],o[h]);l.push(d[0]),l.push(d[1]),a=d[1]}const c=[],u=[];for(let h=0;h<l.length;h+=2)c.push(l[h]),u.push(l[h+1]);return[c,u]}const bB=M({multiRNNCell_:hne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t,e,n,s=!1){const r=$(t,"logits","multinomial"),i=r.size,o=r.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?U(r,[1,-1]):r},c={numSamples:e,seed:n,normalized:s},u=P.runKernel(Yb,l,c);return o===1?U(u,[u.size]):u}const wB=M({multinomial_:dne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t,e){let n=$(t,"a","notEqual","string_or_numeric"),s=$(e,"b","notEqual","string_or_numeric");[n,s]=$t(n,s),Te(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(ng,r)}const yc=M({notEqual_:fne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:$(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return P.runKernel(rg,o,a)}const lh=M({oneHot_:pne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t){const n={x:$(t,"x","onesLike")};return P.runKernel(sg,n)}const Us=M({onesLike_:mne});function gne(t,e){const n=$(t,"v1","outerProduct"),s=$(e,"v2","outerProduct");N(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=U(n,[-1,1]),i=U(s,[1,-1]);return Re(r,i)}const vB=M({outerProduct_:gne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t,e,n=0){const s=$(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},i={x:s};return P.runKernel(og,i,r)}const Fo=M({pad_:xne});function yne(t,e,n=0){return N(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Fo(t,[e],n)}const SB=M({pad1d_:yne});function bne(t,e,n=0){return N(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fo(t,e,n)}const kB=M({pad2d_:bne});function wne(t,e,n=0){return N(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fo(t,e,n)}const CB=M({pad3d_:wne});function vne(t,e,n=0){return N(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fo(t,e,n)}const TB=M({pad4d_:vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(t,e,n){const s=$(t,"x","spaceToBatchND");N(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),N(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),N(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:n};return P.runKernel(gg,r,i)}const Fg=M({spaceToBatchND_:Sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(t,e,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=$(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),N(Fn(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=Fr(l.shape,e,i,r,s),h=[u.dilationHeight,u.dilationWidth];let d;s==="same"?d=Tne([u.filterHeight,u.filterWidth],h):d=[[0,0],[0,0]];const f=h[0]===1&&h[1]===1,[p,g]=Cne([u.inHeight,u.inWidth],h,d),m=f?s:"valid",x=f?l:Fg(l,h,p),b=(n==="avg"?()=>Ig(x,e,i,m,o):()=>Og(x,e,i,m,o))(),w=f?b:Ng(b,h,g);return c?U(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function Cne(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=t.concat(s,r),o=e.map((u,h)=>(u-i[h]%u)%u),a=r.map((u,h)=>u+o[h]),l=e.map((u,h)=>[s[h],a[h]]),c=e.map((u,h)=>[0,o[h]]);return[l,c]}function Tne(t,e){const s=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const lN=M({pool_:kne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t,e){const n=$(t,"x","prelu"),s=$(e,"alpha","prelu"),r={x:n,alpha:s};return P.runKernel(ag,r)}const Mg=M({prelu_:Ine});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(t,e=null,n=!1){let s=$(t,"x","prod");s.dtype==="bool"&&(s=ae(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return P.runKernel(lg,r,i)}const cN=M({prod_:Nne});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(t,e,n,s){const r=t.map((u,h)=>$(u,`tensors${h}`,"raggedGather","int32")),i=$(e,"paramsDenseValues","raggedGather"),o=$(n,"indices","raggedGather","int32"),a={paramsNestedSplits:r,paramsDenseValues:i,indices:o},l={outputRaggedRank:s},c=P.runKernel(ew,a,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const IB=M({raggedGather_:_ne});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ne(t,e,n){const s=$(t,"starts","raggedRange"),r=$(e,"limits","raggedRange",s.dtype),i=$(n,"deltas","raggedRange",s.dtype),o={starts:s,limits:r,deltas:i},a=P.runKernel(tw,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const NB=M({raggedRange_:$ne});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(t,e,n,s,r){const i=$(t,"shape","raggedTensorToTensor","int32"),o=$(e,"values","raggedTensorToTensor"),a=$(n,"defaultValue","raggedTensorToTensor",o.dtype),l=s.map((h,d)=>$(h,`tensors${d}`,"raggedTensorToTensor","int32")),c={shape:i,values:o,defaultValue:a,rowPartitionTensors:l},u={rowPartitionTypes:r};return P.runKernel(nw,c,u)}const _B=M({raggedTensorToTensor_:Ene});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dne(t,e,n){Hs(t);const s=Q(t);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<s;i++)r[i]=e();return P.makeTensor(r,t,n)}const $B=M({rand_:Dne});var uN={exports:{}};uN.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var h=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=h|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),h=c&&c.state,d=u.next;return d.int32=function(){return u.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&i(h,u),d.state=function(){return i(u,{})}),d}function a(){var l=4022871197,c=function(u){u=String(u);for(var h=0;h<u.length;h++){l+=u.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(Pc,t)})(uN);var Ane=uN.exports,hN={exports:{}};hN.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xor128=o})(Pc,t)})(hN);var Rne=hN.exports,dN={exports:{}};dN.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xorwow=o})(Pc,t)})(dN);var One=dN.exports,fN={exports:{}};fN.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,h=l.i,d,f;return d=u[h],d^=d>>>7,f=d^d<<24,d=u[h+1&7],f^=d^d>>>10,d=u[h+3&7],f^=d^d>>>3,d=u[h+4&7],f^=d^d<<7,d=u[h+7&7],d=d^d<<13,f^=d^d<<9,u[h]=f,l.i=h+1&7,f};function c(u,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],u.x=f,u.i=0,d=256;d>0;--d)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.x&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xorshift7=o})(Pc,t)})(fN);var Pne=fN.exports,pN={exports:{}};pN.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,h=l.X,d=l.i,f,p;return l.w=u=u+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(u^u>>>16)|0};function c(u,h){var d,f,p,g,m,x=[],y=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,y=Math.max(y,h.length)),p=0,g=-32;g<y;++g)h&&(f^=h.charCodeAt((g+32)%h.length)),g===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(m=m+1640531527|0,d=x[g&127]^=f+m,p=d==0?p+1:0);for(p>=128&&(x[(h&&h.length||0)&127]=-1),p=127,g=4*128;g>0;--g)f=x[p+34&127],d=x[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,x[p]=f^d;u.w=m,u.X=x,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.X&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xor4096=o})(Pc,t)})(pN);var Fne=pN.exports,mN={exports:{}};mN.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.tychei=o})(Pc,t)})(mN);var Mne=mN.exports,EB={exports:{}};const Lne={},zne=Object.freeze(Object.defineProperty({__proto__:null,default:Lne},Symbol.toStringTag,{value:"Module"})),Bne=sH(zne);(function(t){(function(e,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,h=r-1,d;function f(w,v,S){var T=[];v=v==!0?{entropy:!0}:v||{};var k=x(m(v.entropy?[w,b(n)]:w??y(),3),T),I=new p(T),_=function(){for(var D=I.g(i),A=l,L=0;D<c;)D=(D+L)*r,A*=r,L=I.g(1);for(;D>=u;)D/=2,A/=2,L>>>=1;return(D+L)/A};return _.int32=function(){return I.g(4)|0},_.quick=function(){return I.g(4)/4294967296},_.double=_,x(b(I.S),n),(v.pass||S||function(D,A,L,B){return B&&(B.S&&g(B,I),D.state=function(){return g(I,{})}),L?(s[a]=D,A):D})(_,k,"global"in v?v.global:this==s,v.state)}function p(w){var v,S=w.length,T=this,k=0,I=T.i=T.j=0,_=T.S=[];for(S||(w=[S++]);k<r;)_[k]=k++;for(k=0;k<r;k++)_[k]=_[I=h&I+w[k%S]+(v=_[k])],_[I]=v;(T.g=function(D){for(var A,L=0,B=T.i,F=T.j,R=T.S;D--;)A=R[B=h&B+1],L=L*r+R[h&(R[B]=R[F=h&F+A])+(R[F]=A)];return T.i=B,T.j=F,L})(r)}function g(w,v){return v.i=w.i,v.j=w.j,v.S=w.S.slice(),v}function m(w,v){var S=[],T=typeof w,k;if(v&&T=="object")for(k in w)try{S.push(m(w[k],v-1))}catch{}return S.length?S:T=="string"?w:w+"\0"}function x(w,v){for(var S=w+"",T,k=0;k<S.length;)v[h&k]=h&(T^=v[h&k]*19)+S.charCodeAt(k++);return b(v)}function y(){try{var w;return d&&(w=d.randomBytes)?w=w(r):(w=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(w)),b(w)}catch{var v=e.navigator,S=v&&v.plugins;return[+new Date,e,S,e.screen,b(n)]}}function b(w){return String.fromCharCode.apply(0,w)}if(x(s.random(),n),t.exports){t.exports=f;try{d=Bne}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:Pc,[],Math)})(EB);var Vne=EB.exports,Wne=Ane,Une=Rne,jne=One,Hne=Pne,Gne=Fne,qne=Mne,Gc=Vne;Gc.alea=Wne;Gc.xor128=Une;Gc.xorwow=jne;Gc.xorshift7=Hne;Gc.xor4096=Gne;Gc.tychei=qne;var $d=Gc;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kne=.001,DB=.1;function Xne(t,e,n){return n==null&&(n=gN()),Bk(t,e,(s,r)=>xN(s,r,n))}function gN(){return P.backend.floatPrecision()===32?Kne:DB}function Bk(t,e,n){let s=!0;if((on(t)||on(e))&&(s=!1),on(t)&&on(e)&&(s=!0),s){const o=t.constructor.name,a=e.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(t)&&Array.isArray(e)){const o=Fi(t),a=Fi(e);if(!Fe(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const r=on(t)?t:Pi(t),i=on(e)?e:Pi(e);if(r.length!==i.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${i.length}.
Actual:   ${r}.
Expected: ${i}.`);for(let o=0;o<i.length;++o){const a=r[o],l=i[o];if(!n(a,l))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${l}.
Actual:   ${r}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function Yne(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function Qne(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Ci(t)||Ci(t[0])||Ci(e)||Ci(e[0])?Bk(t,n,(s,r)=>s==r):Bk(t,e,(s,r)=>xN(s,r,0))}function Zne(t,e,n){if(n==null&&(n=gN()),!xN(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function xN(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Jne(t,e,n){for(let s=0;s<t.length;s++)if(t[s]<e||t[s]>n)throw new Error(`Value out of range:${t[s]} low: ${e}, high: ${n}`)}function ese(t,e){const n=new Float32Array(t),s=new Float32Array(e);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let r=0;r<s.length;r++)if(n[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${n[r]} instead`)}function AB(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?AB(n):t[e]=$i(n)}return t}function tse(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",s=>n(e)),e.load()})}async function nse(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const sse=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:DB,createVideoElement:tse,encodeStrings:AB,expectArrayBuffersEqual:ese,expectArraysClose:Xne,expectArraysEqual:Qne,expectNumbersClose:Zne,expectPromiseToFail:Yne,expectValuesInRange:Jne,play:nse,testEpsilon:gN},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yN{constructor(e,n,s,r,i){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=$d.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class rse{constructor(e,n,s,r){this.alpha=e,this.beta=1/n,this.dtype=s;const i=r||Math.random();this.randu=$d.alea(i.toString()),this.randn=new yN(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,r,i,o;for(;;){do r=this.randn.nextValue(),o=1+this.c*r;while(o<=0);if(o*=o*o,e=r*r,n=1-.331*e*e,s=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<s)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class ise{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=$d.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t,e,n=1,s="float32",r){if(Hs(t),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const i=new rse(e,n,s,r),o=De(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const RB=M({randomGamma_:ose});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ase(t,e=0,n=1,s,r){if(Hs(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new yN(e,n,s,!1,r),o=De(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const zw=M({randomNormal_:ase});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return zw(t,0,1,e,n)}const OB=M({randomStandardNormal_:lse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cse(t,e=0,n=1,s="float32",r){Hs(t);const i=De(t,s),o=new ise(e,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const rl=M({randomUniform_:cse});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function use(t,e,n,s){return rl(t,e,n,"int32",s)}const PB=M({randomUniformInt_:use});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bc(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return P.runKernel(sw,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hse(t){const n={input:$(t,"input","real")};return P.runKernel(rw,n)}const ch=M({real_:hse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dse(t){const n={x:$(t,"x","reciprocal")};return P.runKernel(id,n)}const bN=M({reciprocal_:dse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t){const n={x:$(t,"x","relu")};return P.runKernel(od,n)}const hi=M({relu_:fse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pse(t){const n={x:$(t,"x","relu6")};return P.runKernel(ad,n)}const Bw=M({relu6_:pse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mse(t,e){const s={x:$(t,"x","reverse")},r={dims:e};return P.runKernel(dg,s,r)}const hr=M({reverse_:mse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(t){const e=$(t,"x","reverse");return N(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),hr(e,0)}const FB=M({reverse1d_:gse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xse(t,e){const n=$(t,"x","reverse");return N(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),hr(n,e)}const MB=M({reverse2d_:xse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t,e){const n=$(t,"x","reverse");return N(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),hr(n,e)}const LB=M({reverse3d_:yse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bse(t,e){const n=$(t,"x","reverse");return N(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),hr(n,e)}const zB=M({reverse4d_:bse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t){const n={x:$(t,"x","round")};return P.runKernel(ld,n)}const Vw=M({round_:wse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vse(t){const n={x:$(t,"x","rsqrt","float32")};return P.runKernel(cd,n)}const Ww=M({rsqrt_:vse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sse(t){const n={x:$(t,"x","selu")};return P.runKernel(ud,n)}const Uw=M({selu_:Sse});function kse(t,e,n,s,r,i=[1,1],o="NHWC"){const a=$(t,"x","separableConv2d"),l=$(e,"depthwiseFilter","separableConv2d"),c=$(n,"pointwiseFilter","separableConv2d");let u=a,h=!1;if(a.rank===3&&(h=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");N(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),N(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),N(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),N(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),N(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=l.shape[2],f=l.shape[3];N(c.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${c.shape[2]}.`);const p=Cd(u,l,s,r,o,i),m=No(p,c,1,"valid",o);return h?U(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const jw=M({separableConv2d_:kse});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Cse(t,e){const n=$(t,"x","setdiff1d"),s=$(e,"y","setdiff1d");N(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),N(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),N(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),i=await s.data(),o=new Set(i);let a=0;for(let u=0;u<r.length;u++)o.has(r[u])||a++;const l=new nn([a],n.dtype),c=new nn([a],"int32");for(let u=0,h=0;u<r.length;u++)o.has(r[u])||(l.values[h]=r[u],c.values[h]=u,h++);return[l.toTensor(),c.toTensor()]}const BB=Cse;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tse(t){const n={x:$(t,"x","sign")};return P.runKernel(fd,n)}const wN=M({sign_:Tse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ise(t){const n={x:$(t,"x","sin","float32")};return P.runKernel(hd,n)}const Hw=M({sin_:Ise});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nse(t){const n={x:$(t,"x","sinh")};return P.runKernel(dd,n)}const Gw=M({sinh_:Nse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _se(t,e,n){const s=$(t,"x","slice1d");return N(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Be(s,[e],[n])}const Lg=M({slice1d_:_se});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $se(t,e,n){const s=$(t,"x","slice2d");return N(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Be(s,e,n)}const qw=M({slice2d_:$se});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t,e,n){const s=$(t,"x","slice3d");return N(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Be(s,e,n)}const zg=M({slice3d_:Ese});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(t,e,n){const s=$(t,"x","slice4d");return N(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Be(s,e,n)}const uh=M({slice4d_:Dse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ase(t,e=-1){const n=$(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return P.runKernel(yg,s,r)}const Bg=M({softmax_:Ase});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rse(t){N(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return P.runKernel(zb,e)}const Vg=M({fft_:Rse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ose(t){N(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return P.runKernel(Ub,e)}const hh=M({ifft_:Ose});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pse(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=U(t,[n,e]);s=hh(r)}else{const r=[n,2*(e-1)],i=U(ch(t),[n,e]),o=U($g(t),[n,e]),a=hr(Be(i,[0,1],[n,e-2]),1),l=W(hr(Be(o,[0,1],[n,e-2]),1),be(-1)),c=Vt([i,a],1),u=Vt([o,l],1),h=U(Io(c,u),[r[0],r[1]]);s=hh(h)}if(s=ch(s),t.rank===3&&t.shape[0]!==0){const r=s,i=t.shape[0];s=U(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const Kw=M({irfft_:Pse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(t,e,n=0){const r={x:$(t,"x","split")},i={numOrSizeSplits:e,axis:n};return P.runKernel(xg,r,i)}const gs=M({split_:Fse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mse(t,e){N(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(m=>0),g=t.shape.map(m=>m);g[t.shape.length-1]=e,r=Be(t,p,g),n=e}else if(e!=null&&e>n){const p=t.shape.map(g=>g);p[t.shape.length-1]=e-n,r=Vt([t,Qt(p)],t.shape.length-1),n=e}else r=t;const i=Ve(r),o=U(Io(r,i),[s,n]),a=Vg(o),l=Math.floor(n/2)+1,c=ch(a),u=$g(a),h=gs(c,[l,n-l],c.shape.length-1),d=gs(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,U(Io(h[0],d[0]),f)}const Wg=M({rfft_:Mse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lse(t,e){let n=$(t,"a","squaredDifference"),s=$(e,"b","squaredDifference");[n,s]=$t(n,s),Te(n.shape,s.shape);const r={a:n,b:s},i={};return P.runKernel(xd,r,i)}const Xw=M({squaredDifference_:Lse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zse(t,e){const n=$(t,"x","squeeze","string_or_numeric");return U(n,Do(n.shape,e).newShape)}const il=M({squeeze_:zse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bse(t,e=0){const n=Wp(t,"tensors","stack","string_or_numeric");N(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&N(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return P.runKernel(ig,s,r)}const is=M({stack_:Bse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vse(t,e=0){const s={x:$(t,"x","step")},r={alpha:e};return P.runKernel(Sd,s,r)}const qc=M({step_:Vse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(t,e,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:$(t,"x","stridedSlice","string_or_numeric")},h={begin:e,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return P.runKernel(gw,u,h)}const vN=M({stridedSlice_:Wse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Use(t){const n={x:$(t,"x","tan","float32")};return P.runKernel(bd,n)}const SN=M({tan_:Use});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xn(t,e){zc(t);const n=Fi(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return el(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ka(t,e,n){if(zc(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Fi(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return el(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kN(t,e,n){if(zc(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Fi(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return el(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VB(t,e,n){if(zc(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Fi(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return el(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WB(t,e,n){if(zc(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Fi(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return el(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(t,e,n){if(zc(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Fi(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,el(t,e,s,n)}function CN(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(i+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function Yw(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}CN(n,e,t)}function ol(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=n.length;let o=1;for(let h=r;h<i;++h)o*=n[h];const a=r<1?1:r,l=Q(e.shape)/a,c=[...we(n.slice(0,r)),1],u=Q(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}const jse=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:ol,validateInput:Yw,validateUpdateShape:CN},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(t,e,n){const s=$(t,"tensor","tensorScatterupdate"),r=$(e,"indices","tensorScatterupdate","int32"),i=$(n,"updates","tensorScatterupdate");if(Yw(i,r,s.shape),s.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${i.dtype}.`);const o={tensor:s,indices:r,updates:i},a={};return P.runKernel(lw,o,a)}const jB=M({tensorScatterUpdate_:Hse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gse(t,e=1,n=!0){const s=$(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},o={k:e,sorted:n},[a,l]=P.runKernel(ww,i,o);return{values:a,indices:l}}const TN=M({topk_:Gse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qse(t,e=0,n=1,s,r){if(Hs(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new yN(e,n,s,!0,r),o=De(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Qw=M({truncatedNormal_:qse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kse(t,e=0){const n=$(t,"x","unique","string_or_numeric");N(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[i,o]=P.runKernel(Sw,s,r);return{values:i,indices:o}}const IN=M({unique_:Kse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xse(t,e,n){const s=$(t,"x","unsortedSegmentSum"),r=$(e,"segmentIds","unsortedSegmentSum","int32");N(hc(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return P.runKernel(vg,i,o)}const Zw=M({unsortedSegmentSum_:Xse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yse(t,e=0){const n=$(t,"x","unstack","string_or_numeric");N(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return P.runKernel(wg,s,r)}const dr=M({unstack_:Yse});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HB(t,e){return Lw(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NN(t,e=!0,n,s){return P.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jw(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const s=De(t,"int32"),r=De([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*t.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Qse(t){const e=$(t,"condition","whereAsync","bool"),n=await e.data(),s=Jw(e.shape,n);return t!==e&&e.dispose(),s}const _N=Qse;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Zse(t,e,n){const s=$(t,"tensor","boolMask"),r=$(e,"mask","boolMask","bool"),i=n??0,o=r.rank,a=s.shape;N(o>0,()=>"mask cannot be scalar"),Pn(a.slice(i,i+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=i;g<i+o;g++)l*=a[g];const c=a.slice(0,i).concat([l],a.slice(i+o)),u=U(s,c),h=U(r,[-1]),d=await _N(h),f=il(d,[1]),p=_d(u,f,i);return t!==s&&s.dispose(),e!==r&&r.dispose(),f.dispose(),u.dispose(),h.dispose(),d.dispose(),p}const GB=Zse;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jse(t,e,n){const s=$(t,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),N(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{N(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?q(()=>{let o=ch(s),a=$g(s);return o=P.runKernel(ql,{x:o},i),a=P.runKernel(ql,{x:a},i),n&&(a=ct(a)),Io(o,a)}):P.runKernel(ql,r,i)}const Me=M({transpose_:Jse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(t,e,n,s,r=!0){const i=$(t,"v","movingAverage"),o=$(e,"x","movingAverage"),a=$(n,"decay","movingAverage");Vz(i,o),N(Fe(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=be(1),c=de(l,a);let u=W(de(o,i),c);if(r){N(s!=null,()=>"When using zeroDebias: true, step is required.");const h=$(s,"step","movingAverage");u=ge(u,de(l,Mi(a,h)))}return se(i,u)}const qB=M({movingAverage_:ere});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(t,e,n){Hs(n);const s=$(t,"indices","scatterND","int32"),r=$(e,"updates","scatterND");Yw(r,s,n);const i={indices:s,updates:r},o={shape:n};return P.runKernel(aw,i,o)}const KB=M({scatterND_:tre});function nre(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const r=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sre(t,e,n,s=0){Hs(n);const r=$(t,"sparseIndices","sparseToDense","int32"),i=$(e,"sparseValues","sparseToDense","string_or_numeric"),o=$(s,"defaultValue","sparseToDense",i.dtype);nre(r,i,n,o);const a={sparseIndices:r,sparseValues:i,defaultValue:o},l={outputShape:n};return P.runKernel(pw,a,l)}const XB=M({sparseToDense_:sre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rre(t,e){const n=$(e,"indices","gatherND","int32"),r={params:$(t,"x","gatherND","string_or_numeric"),indices:n};return P.runKernel(Wb,r)}const YB=M({gatherND_:rre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(t,e){if(e==null)return t.shape.slice();if(Fe(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ore(t,e,n,s){const r=$(t,"x","dropout");if(N(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),N(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof je?r.clone():r;const i=ire(r,n),o=1-e,a=ge(Nd(se(rl(i,0,1,"float32",s),o)),o);return W(r,a)}const $N=M({dropout_:ore});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EN(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function ev(t,e,n){const s=1-t%2,r=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+s-1);r[i]=e-n*Math.cos(o)}return xn(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function are(t,e,n=1){const s=$(t,"predictions","inTopK"),r=$(e,"targets","inTopK");N(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),N(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Pn(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=s.shape[s.shape.length-1];N(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await s.data(),a=await r.data(),[l,c]=[o.length/i,i],u=vn("bool",l);for(let h=0;h<l;h++){const d=h*c,f=o.subarray(d,d+c),p=[];for(let g=0;g<f.length;g++)p.push({value:f[g],index:g});p.sort((g,m)=>m.value-g.value),u[h]=0;for(let g=0;g<n;g++)if(p[g].index===a[h]){u[h]=1;break}}return t!==s&&s.dispose(),e!==r&&r.dispose(),Bs(u,r.shape,"bool")}const QB=are;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lre(t,e,n,s,r,i="NHWC",o){let a=t;t.rank===3&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]])),N(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),N(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),N(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];N(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),N(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),ls("conv2dDerFilter",r,o);const h={x:a,dy:l},d={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return P.runKernel(Ib,h,d)}const DN=M({conv2DBackpropFilter_:lre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return W(t,qc(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function nv(t,e){let n=e;const s=sn(t.shape,e.shape);return s.length>0&&(n=fe(n,s)),U(n,t.shape)}function sv(t,e,n,s){if(e==="linear")return t;if(e==="relu")return hi(t);if(e==="elu")return Td(t);if(e==="relu6")return Bw(t);if(e==="prelu")return Mg(t,n);if(e==="leakyrelu")return Eg(t,s);if(e==="sigmoid")return Jr(t);throw new Error(`Unknown fused activation ${e}.`)}const rv=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",rv(P.state.gradientDepth,l)===!1){N(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=No(t,e,n,s,r,i,o);return a!=null&&(S=se(S,a)),sv(S,l,c,u)}const h=$(t,"x","conv2d","float32"),d=$(e,"filter","conv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=U(h,[1,h.shape[0],h.shape[1],h.shape[2]])),N(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),N(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),ls("fused conv2d",s,o);const g=r==="NHWC"?f.shape[3]:f.shape[1];N(d.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${d.shape[2]}.`),N(Fn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const m=Cn(f.shape,d.shape,n,i,s,o);let x;a!=null&&(x=$(a,"bias","fused conv2d"),[x]=$t(x,h),r==="NHWC"?Te(m.outShape,x.shape):(N(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),N(x.shape.length===0||x.shape[0]===m.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${m.outChannels})`)));let y;if(c!=null){const S=c.shape;if(N(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)N(S[0]===1||S[0]===m.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${m.outChannels}).`);else if(S.length===3)try{Te(S,m.outShape)}catch{const k=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${m.outShape}).`;throw Error(k)}y=$(c,"prelu weights","fused conv2d")}const b=(S,T)=>{N(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[k,I,_,D]=T,A=tv(S,_,l);N(Fa(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const L=UI(I.shape,A,k,n,s),B=DN(I,A,k.shape,n,s),F=[L,B];if(D!=null){const R=nv(D,A);F.push(R)}return F},w={x:f,filter:d,bias:x,preluActivationWeights:y},v={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Li((T,k,I)=>{let _=P.runKernel(Mp,w,v);return I([k,T,_]),p&&(_=U(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:b}})(f,d):Li((T,k,I,_)=>{let D=P.runKernel(Mp,w,v);return _([k,T,D,I]),p&&(D=U(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:b}})(f,d,x)}const ZB=M({fusedConv2d_:cre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(t,e,n,s,r,i=[1,1],o){let a=t;t.rank===3&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return P.runKernel(Rb,c,u)}const JB=M({depthwiseConv2dNativeBackpropFilter_:ure});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t,e,n,s,r,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:t},h=P.runKernel(Ob,c,u);return l?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const eV=M({depthwiseConv2dNativeBackpropInput_:hre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dre({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(rv(P.state.gradientDepth,l)===!1){let v=Cd(t,e,n,s,r,i,o);return a!=null&&(v=se(v,a)),sv(v,l,c,u)}const h=$(t,"x","depthwiseConv2d","float32"),d=$(e,"filter","depthwiseConv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=U(h,[1,h.shape[0],h.shape[1],h.shape[2]])),N(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),N(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),N(f.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),i==null&&(i=[1,1]),N(Fn(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),ls("fused depthwiseConv2d",s,o);const g=Cn(f.shape,d.shape,n,i,s,o,!0);let m;a!=null&&(m=$(a,"bias","fused conv2d"),[m]=$t(m,h),Te(g.outShape,m.shape));let x;c!=null&&(x=$(c,"prelu weights","fused depthwiseConv2d"));const y=(v,S)=>{N(Fa(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[T,k,I,_]=S,D=tv(v,I,l),A=eV(k.shape,D,T,n,s,i,o),L=JB(k,D,T.shape,n,s,i,o);if(_!=null){const B=nv(m,D);return[A,L,B]}return[A,L]},b={x:f,filter:d,bias:m,preluActivationWeights:x},w={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Li((S,T,k)=>{let I=P.runKernel(Lp,b,w);return k([T,S,I]),p&&(I=U(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:y}})(f,d):Li((S,T,k,I)=>{let _=P.runKernel(Lp,b,w);return I([T,S,_,k]),p&&(_=U(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:y}})(f,d,m)}const fre=M({fusedDepthwiseConv2d_:dre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(rv(P.state.gradientDepth,i)===!1){let D=Re(t,e,n,s);return r!=null&&(D=se(D,r)),sv(D,i,o,a)}let l=$(t,"a","fused matMul"),c=$(e,"b","fused matMul");[l,c]=$t(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=s?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),g=c.shape.slice(0,-2),m=Q(p),x=Q(g);N(u===h,()=>`Error in fused matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const b=Te(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,f]),w=n?U(l,[m,u,d]):U(l,[m,d,u]),v=s?U(c,[x,f,h]):U(c,[x,h,f]);let S;r!=null&&(S=$(r,"bias","fused matMul"),[S]=$t(S,l),Te(b,S.shape));let T;o!=null&&(T=$(o,"prelu weights","fused matMul"));const k=(D,A)=>{const[L,B,F,R]=A,O=tv(U(D,F.shape),F,i);let E,V;if(!n&&!s?(E=Re(O,B,!1,!0),V=Re(L,O,!0,!1)):!n&&s?(E=Re(O,B,!1,!1),V=Re(O,L,!0,!1)):n&&!s?(E=Re(B,O,!1,!0),V=Re(L,O,!1,!1)):(E=Re(B,O,!0,!0),V=Re(O,L,!0,!0)),r!=null){const G=nv(R,O);return[E,V,G]}else return[E,V]},I={a:w,b:v,bias:S,preluActivationWeights:T},_={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?Li((A,L,B)=>{const F=P.runKernel(Fp,I,_);return B([A,L,F]),{value:U(F,b),gradFunc:k}})(w,v):Li((A,L,B,F)=>{const R=P.runKernel(Fp,I,_);return F([A,L,R,B]),{value:U(R,b),gradFunc:k}})(w,v,S)}const Vk=M({fusedMatMul_:pre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tV=Object.freeze(Object.defineProperty({__proto__:null,conv2d:ZB,depthwiseConv2d:fre,matMul:Vk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mre(t){return ev(t,.54,.46)}const gre=M({hammingWindow_:mre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xre(t){return ev(t,.5,.5)}const nV=M({hannWindow_:xre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yre(t,e,n,s=!1,r=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(Be(t,i,e)),i+=n;if(s)for(;i<t.size;){const a=i+e-t.size,l=Vt([Be(t,i,e-a),jc([a],r)]);o.push(l),i+=n}return o.length===0?ka([],[0,e]):U(Vt(o),[o.length,e])}const sV=M({frame_:yre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bre(t,e,n,s,r=nV){s==null&&(s=EN(e));const i=sV(t,e,n),o=W(i,r(e));return Wg(o,s)}const wre=M({stft_:bre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(t,e,n,s,r="bilinear",i=0){const o=$(t,"image","cropAndResize"),a=$(e,"boxes","cropAndResize","float32"),l=$(n,"boxInd","cropAndResize","int32"),c=a.shape[0];N(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),N(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),N(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),N(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),N(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),N(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},h={method:r,extrapolationValue:i,cropSize:s};return P.runKernel(Eb,u,h)}const Sre=M({cropAndResize_:vre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kre(t){const e=$(t,"image","flipLeftRight","float32");N(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return P.runKernel(Vb,n,{})}const Cre=M({flipLeftRight_:kre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tre(t){const e=$(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];N(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),N(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,sr(e,r)}const Ire=M({grayscaleToRGB_:Tre});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nre(t){const e=$(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];N(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),N(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=ae(e,"float32"),o=xn([.2989,.587,.114]);let a;switch(e.rank){case 2:a=$l("ij,j->i",i,o);break;case 3:a=$l("ijk,k->ij",i,o);break;case 4:a=$l("ijkl,l->ijk",i,o);break;case 5:a=$l("ijklm,m->ijkl",i,o);break;case 6:a=$l("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=$n(a,-1),ae(a,r)}const _re=M({rgbToGrayscale_:Nre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(t,e,n=0,s=.5){const r=$(t,"image","rotateWithOffset","float32");N(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:e,fillValue:n,center:s};return P.runKernel(kw,i,o)}const Ere=M({rotateWithOffset_:$re});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ed(t,e,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),N(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),N(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),N(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),N(e.rank===1,()=>"scores must be a 1D tensor"),N(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),N(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=$(t,"boxes","nonMaxSuppression","float32"),o=$(e,"scores","nonMaxSuppression","float32"),a=Ed(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return P.runKernel(Qb,{boxes:i,scores:o},l)}const Are=M({nonMaxSuppression_:Dre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(t,e,n){const s=Ore(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Ore(t,e,n){return Fre(t,e,n||Pre)}function Pre(t,e){return t>e?1:t<e?-1:0}function Fre(t,e,n){let s=0,r=t.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(e,t[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iv(t,e,n,s,r){return AN(t,e,n,s,r,0)}function ov(t,e,n,s,r,i){return AN(t,e,n,s,r,0,!1,i,!0)}function av(t,e,n,s,r,i){return AN(t,e,n,s,r,i,!0)}function AN(t,e,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let m=0;m<e.length;m++)e[m]>r&&c.push({score:e[m],boxIndex:m,suppressBeginIndex:0});c.sort(QR);const u=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&c.length>0;){const m=c.pop(),{score:x,boxIndex:y,suppressBeginIndex:b}=m;if(x<r)break;let w=!1;for(let v=h.length-1;v>=b;--v){const S=Mre(t,y,h[v]);if(S>=s){w=!0;break}if(m.score=m.score*Lre(s,u,S),m.score<=r)break}m.suppressBeginIndex=h.length,w||(m.score===x?(h.push(y),d.push(m.score)):m.score>r&&Rre(c,m,QR))}const f=h.length,p=n-f;a&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const g={selectedIndices:h};return o&&(g.selectedScores=d),l&&(g.validOutputs=f),g}function Mre(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),f=(a-i)*(l-o),p=(h-c)*(d-u);if(f<=0||p<=0)return 0;const g=Math.max(i,c),m=Math.max(o,u),x=Math.min(a,h),y=Math.min(l,d),b=Math.max(x-g,0)*Math.max(y-m,0);return b/(f+p-b)}function Lre(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function QR(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function zre(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=$(t,"boxes","nonMaxSuppressionAsync"),o=$(e,"scores","nonMaxSuppressionAsync"),a=Ed(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:h}=iv(c,u,n,s,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),xn(h,"int32")}const Bre=zre;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=$(t,"boxes","nonMaxSuppression"),a=$(e,"scores","nonMaxSuppression"),l=Ed(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},h=P.runKernel(Jb,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}const Wre=M({nonMaxSuppressionWithScore_:Vre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ure(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=$(t,"boxes","nonMaxSuppressionAsync"),a=$(e,"scores","nonMaxSuppressionAsync"),l=Ed(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],h=c[1],{selectedIndices:d,selectedScores:f}=av(u,h,n,s,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:xn(d,"int32"),selectedScores:xn(f)}}const jre=Ure;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=$(t,"boxes","nonMaxSuppression"),a=$(e,"scores","nonMaxSuppression"),l=Ed(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,d={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:h,padToMaxOutputSize:i},p=P.runKernel(Zb,d,f);return{selectedIndices:p[0],validOutputs:p[1]}}const Gre=M({nonMaxSuppressionPadded_:Hre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function qre(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=$(t,"boxes","nonMaxSuppressionAsync"),a=$(e,"scores","nonMaxSuppressionAsync"),l=Ed(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:g}=ov(d,f,c,u,h,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:xn(p,"int32"),validOutputs:be(g,"int32")}}const Kre=qre;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t,e,n=!1,s=!1){const r=$(t,"images","resizeBilinear");N(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),N(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),N(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=U(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=P.runKernel(hg,a,l);return o?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const rV=M({resizeBilinear_:Xre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(t,e,n=!1,s=!1){const r=$(t,"images","resizeNearestNeighbor");N(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),N(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),N(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),N(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=U(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=P.runKernel(ug,a,l);return o?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const iV=M({resizeNearestNeighbor_:Yre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t,e="binary",n=!1,s=.5){const r=$(t,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=W(xn([s]),255),u,h,d,f;if(N(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),N(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),N(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),N(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,h,d]=gs(r,[1,1,1],-1);const m=W(u,i),x=W(h,o),y=W(d,a);f=se(se(m,x),y)}else f=t;if(e==="otsu"){const m=MI(ae(Vw(f),"int32"),Bs([]),256);c=Zre(m,l)}const p=n?sl(f,c):cs(f,c);return ae(W(p,255),"int32")}function Zre(t,e){let n=xn([-1]),s=xn([0]),r=xn([0]),i,o,a,l,c,u;for(let h=0;h<t.size-1;h++){i=Be(t,0,h+1),o=Be(t,h+1),c=ge(fe(i),e),u=ge(fe(o),e);const d=fe(W(i,bc(0,i.size)));a=ge(d,fe(i));const f=jc(o.shape,i.size),p=se(bc(0,o.size),f),g=W(o,p);l=ge(fe(g),fe(o));const m=de(a,l),x=de(a,l),y=W(c,u);r=W(W(y,m),x);const b=cs(r,s);s=wn(b,r,s),n=wn(b,xn([h]),n)}return n}const Jre=M({threshold_:Qre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eie(t,e,n="nearest",s="constant",r=0,i){const o=$(t,"image","transform","float32"),a=$(e,"transforms","transform","float32");N(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),N(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),N(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return P.runKernel(vw,l,c)}const tie=M({transform_:eie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nie(t,e,n){const s=$(t,"a","bandPart");N(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);let a,l;typeof e=="number"?(N(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),N(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=$(e<0?i:e,"numLower","bandPart")):(N(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=wn(ah(e,0),i,La(e,i))),typeof n=="number"?(N(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),N(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=$(n<0?o:n,"numUpper","bandPart")):(N(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=wn(ah(n,0),o,La(n,o)));const c=U(bc(0,i,1,"int32"),[-1,1]),u=bc(0,o,1,"int32"),h=de(c,u),d=Pr(sl(h,a),Po(h,ct(l))),f=Qt([i,o],s.dtype);return U(is(dr(U(s,[-1,i,o])).map(p=>wn(d,p,f))),r)}const sie=M({bandPart_:nie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rie(t){let e;if(Array.isArray(t)){e=!1,N(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let i=1;i<t.length;++i)N(t[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${r})`)}else e=!0,t=gs(t,t.shape[0],0).map(r=>il(r,[0]));N(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(P.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=W(fe(W(n[o],i)),n[o]);i=de(i,a)}return ge(i,Id(i,"euclidean"))}));return e?is(n,0):n}const iie=M({gramSchmidt_:rie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oie(t,e=!1){if(N(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return ZR(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=dr(U(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=ZR(l,e);r.push(c),i.push(u)});const o=U(is(r,0),t.shape),a=U(is(i,0),t.shape);return[o,a]}}function ZR(t,e=!1){return P.tidy(()=>{N(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=Ow(n),i=Ei(t);const o=ka([[1]],[1,1]);let a=Ei(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,h=a,d=r;[a,i,r]=P.tidy(()=>{const f=Be(i,[c,c],[n-c,1]),p=Id(f),g=Be(i,[c,c],[1,1]),m=wn(cs(g,0),ka([[-1]]),ka([[1]])),x=de(g,W(m,p)),y=ge(f,x);y.shape[0]===1?a=Ei(o):a=Vt([o,Be(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const b=ct(ge(Re(m,x),p)),w=Be(i,[c,0],[n-c,s]),v=W(b,a),S=Me(a);if(c===0)i=de(w,Re(v,Re(S,w)));else{const I=de(w,Re(v,Re(S,w)));i=Vt([Be(i,[0,0],[c,s]),I],0)}const T=Me(v),k=Be(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=de(k,Re(Re(k,a),T));else{const I=de(k,Re(Re(k,a),T));r=Vt([Be(r,[0,0],[n,c]),I],1)}return[a,i,r]}),Ce([u,h,d])}return!e&&n>s&&(r=Be(r,[0,0],[n,s]),i=Be(i,[0,0],[s,s])),[r,i]})}const aie=M({qr_:oie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Jn;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Jn||(Jn={}));function lie(t,e,n=Jn.SUM_BY_NONZERO_WEIGHTS){const s=$(t,"losses","computeWeightedLoss");let r=null;e!=null&&(r=$(e,"weights","computeWeightedLoss"));const i=r==null?s:W(s,r);if(n===Jn.NONE)return i;if(n===Jn.SUM)return fe(i);if(n===Jn.MEAN){if(r==null)return It(i);{const o=s.size/r.size,a=ge(fe(i),fe(r));return o>1?ge(a,be(o)):a}}if(n===Jn.SUM_BY_NONZERO_WEIGHTS){if(r==null)return ge(fe(i),be(s.size));{const o=W(r,ps(s.shape)),a=ae(fe(yc(o,be(0))),"float32");return ge(fe(i),a)}}throw Error(`Unknown reduction: ${n}`)}const Mo=M({computeWeightedLoss_:lie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(t,e,n,s=Jn.SUM_BY_NONZERO_WEIGHTS){const r=$(t,"labels","absoluteDifference"),i=$(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=$(n,"weights","absoluteDifference")),Pn(r.shape,i.shape,"Error in absoluteDifference: ");const a=Xt(de(r,i));return Mo(a,o,s)}const uie=M({absoluteDifference_:cie});function hie(t,e,n,s,r=Jn.SUM_BY_NONZERO_WEIGHTS){const i=$(t,"labels","cosineDistance"),o=$(e,"predictions","cosineDistance");let a=null;s!=null&&(a=$(s,"weights","cosineDistance")),Pn(i.shape,o.shape,"Error in cosineDistance: ");const l=be(1),c=de(l,fe(W(i,o),n,!0));return Mo(c,a,r)}const die=M({cosineDistance_:hie});function fie(t,e,n,s=Jn.SUM_BY_NONZERO_WEIGHTS){let r=$(t,"labels","hingeLoss");const i=$(e,"predictions","hingeLoss");let o=null;n!=null&&(o=$(n,"weights","hingeLoss")),Pn(r.shape,i.shape,"Error in hingeLoss: ");const a=be(1);r=de(W(be(2),r),a);const l=hi(de(a,W(r,i)));return Mo(l,o,s)}const pie=M({hingeLoss_:fie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mie(t,e,n,s=1,r=Jn.SUM_BY_NONZERO_WEIGHTS){const i=$(t,"labels","huberLoss"),o=$(e,"predictions","huberLoss");let a=null;n!=null&&(a=$(n,"weights","huberLoss")),Pn(i.shape,o.shape,"Error in huberLoss: ");const l=be(s),c=Xt(de(o,i)),u=La(c,l),h=de(c,u),d=se(W(be(.5),rt(u)),W(l,h));return Mo(d,a,r)}const gie=M({huberLoss_:mie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xie(t,e,n,s=1e-7,r=Jn.SUM_BY_NONZERO_WEIGHTS){const i=$(t,"labels","logLoss"),o=$(e,"predictions","logLoss");let a=null;n!=null&&(a=$(n,"weights","logLoss")),Pn(i.shape,o.shape,"Error in logLoss: ");const l=be(1),c=be(s),u=ct(W(i,Ws(se(o,c)))),h=W(de(l,i),Ws(se(de(l,o),c))),d=de(u,h);return Mo(d,a,r)}const yie=M({logLoss_:xie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(t,e,n,s=Jn.SUM_BY_NONZERO_WEIGHTS){const r=$(t,"labels","meanSquaredError"),i=$(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=$(n,"weights","meanSquaredError")),Pn(r.shape,i.shape,"Error in meanSquaredError: ");const a=Xw(r,i);return Mo(a,o,s)}const wie=M({meanSquaredError_:bie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(t,e){const n=$(t,"labels","sigmoidCrossEntropyWithLogits"),s=$(e,"logits","sigmoidCrossEntropyWithLogits");Pn(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=hi(s),i=W(s,n),o=Dg(ws(ct(Xt(s))));return se(de(r,i),o)}function Sie(t,e,n,s=0,r=Jn.SUM_BY_NONZERO_WEIGHTS){let i=$(t,"multiClassLabels","sigmoidCrossEntropy");const o=$(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=$(n,"weights","sigmoidCrossEntropy")),Pn(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=be(s),u=be(1),h=be(.5);i=se(W(i,de(u,c)),W(h,c))}const l=vie(i,o);return Mo(l,a,r)}const kie=M({sigmoidCrossEntropy_:Sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cie(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Li((r,i,o)=>{const l=Ag(i,[n],!0),c=de(ae(i,"float32"),l);o([r,c]);const u=ct(W(c,r));return{value:fe(u,[n]),gradFunc:(f,p)=>{const[g,m]=p,x=Wt(f.shape,[n]);return[W(U(f,x),de(ae(g,"float32"),ws(m))),W(U(f,x),de(ws(m),ae(g,"float32")))]}}})(t,e)}function Tie(t,e,n,s=0,r=Jn.SUM_BY_NONZERO_WEIGHTS){let i=$(t,"onehotLabels","softmaxCrossEntropy");const o=$(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=$(n,"weights","softmaxCrossEntropy")),Pn(i.shape,o.shape,"Error in softmaxCrossEntropy: "),s>0){const c=be(s),u=be(1),h=be(i.shape[1]);i=se(W(i,de(u,c)),ge(c,h))}const l=Cie(i,o);return Mo(l,a,r)}const Iie=M({softmaxCrossEntropy_:Tie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(t,e,n,s){const r=$(t,"indices","sparseFillEmptyRows","int32"),i=$(e,"values","sparseFillEmptyRows"),o=$(n,"denseShape","sparseFillEmptyRows","int32"),a=$(s,"defaultValue","sparseFillEmptyRows",i.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:r,values:i,denseShape:o,defaultValue:a},c=P.runKernel(uw,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const _ie=M({sparseFillEmptyRows_:Nie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t,e,n){const s=$(t,"inputIndices","sparseReshape","int32"),r=$(e,"inputShape","sparseReshape","int32"),i=$(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:s,inputShape:r,newShape:i},a=P.runKernel(hw,o);return{outputIndices:a[0],outputShape:a[1]}}const Eie=M({sparseReshape_:$ie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(t,e,n){const s=$(t,"data","sparseSegmentMean"),r=$(e,"indices","sparseSegmentMean","int32"),i=$(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return P.runKernel(dw,o)}const Aie=M({sparseSegmentMean_:Die});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(t,e,n){const s=$(t,"data","sparseSegmentSum"),r=$(e,"indices","sparseSegmentSum","int32"),i=$(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return P.runKernel(fw,o)}const Oie=M({sparseSegmentSum_:Rie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(t,e,n,s,r,i,o,a){const l=$(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=$(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:s,leftPad:r,rightPad:i,padWidth:o,preserveShortSequences:a},h={data:l,dataSplits:c},d=P.runKernel(xw,h,u);return{nGrams:d[0],nGramsSplits:d[1]}}const Fie=M({stringNGrams_:Pie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mie(t,e,n=!0){const s=$(t,"input","stringSplit","string"),r=$(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const i={skipEmpty:n},o={input:s,delimiter:r},a=P.runKernel(yw,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const Lie=M({stringSplit_:Mie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zie(t,e){const n=$(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return P.runKernel(bw,r,s)}const Bie=M({stringToHashBucketFast_:zie});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vie(t,e,n,s=!0){const r=$(t,"input","staticRegexReplace","string"),i={pattern:e,rewrite:n,replaceGlobal:s};return P.runKernel(bg,{x:r},i)}const Wie=M({staticRegexReplace_:Vie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oV={fft:Vg,ifft:hh,rfft:Wg,irfft:Kw},aV={hammingWindow:gre,hannWindow:nV,frame:sV,stft:wre},Er={flipLeftRight:Cre,grayscaleToRGB:Ire,resizeNearestNeighbor:iV,resizeBilinear:rV,rgbToGrayscale:_re,rotateWithOffset:Ere,cropAndResize:Sre,nonMaxSuppression:Are,nonMaxSuppressionAsync:Bre,nonMaxSuppressionWithScore:Wre,nonMaxSuppressionWithScoreAsync:jre,nonMaxSuppressionPadded:Gre,nonMaxSuppressionPaddedAsync:Kre,threshold:Jre,transform:tie},RN={bandPart:sie,gramSchmidt:iie,qr:aie},lV={absoluteDifference:uie,computeWeightedLoss:Mo,cosineDistance:die,hingeLoss:pie,huberLoss:gie,logLoss:yie,meanSquaredError:wie,sigmoidCrossEntropy:kie,softmaxCrossEntropy:Iie},cV={sparseFillEmptyRows:_ie,sparseReshape:Eie,sparseSegmentMean:Aie,sparseSegmentSum:Oie},uV={stringNGrams:Fie,stringSplit:Lie,stringToHashBucketFast:Bie,staticRegexReplace:Wie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uie=new Map,Wk=new Map;class Kc{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class er{constructor(){this.classNameMap={}}static getMap(){return er.instance==null&&(er.instance=new er),er.instance}static register(e){er.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function re(t,e,n){N(t.className!=null,()=>"Class being registered does not have the static className property defined."),N(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),N(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return er.register(t),Uie.set(r,t),Wk.set(t,r),t}function jie(t){return Wk.has(t)?Wk.get(t):t.className}const Hie=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Kc,SerializationMap:er,getRegisteredName:jie,registerClass:re},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lo extends Kc{minimize(e,n=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Ce(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return mB(e,n)}dispose(){this.iterations_!=null&&Ce(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:be(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Lo,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ON extends Lo{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=P.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:q(()=>Ve(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:q(()=>Ve(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;q(()=>{const u=se(W(l,this.rho),W(rt(a),1-this.rho)),h=W(ge(Sn(se(c,this.epsilon)),Sn(se(l,this.epsilon))),a),d=se(W(c,this.rho),W(rt(h),1-this.rho));l.assign(u),c.assign(d);const f=se(W(h,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ce(this.accumulatedGrads.map(e=>e.variable)),Ce(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PN extends Lo{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=P.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:q(()=>jc(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;q(()=>{const l=se(a,rt(o));a.assign(l);const c=se(W(ge(o,Sn(se(l,P.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ce(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FN extends Lo{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],q(()=>{this.accBeta1=be(n).variable(),this.accBeta2=be(s).variable()}),r==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);q(()=>{const s=de(1,this.accBeta1),r=de(1,this.accBeta2);n.forEach((i,o)=>{const a=P.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:q(()=>Ve(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:q(()=>Ve(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,h=this.accumulatedSecondMoment[o].variable,d=se(W(u,this.beta1),W(c,1-this.beta1)),f=se(W(h,this.beta2),W(rt(c),1-this.beta2)),p=ge(d,s),g=ge(f,r);u.assign(d),h.assign(f);const m=se(W(ge(p,se(Sn(g),this.epsilon)),-this.learningRate),a);a.assign(m)}),this.accBeta1.assign(W(this.accBeta1,this.beta1)),this.accBeta2.assign(W(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ce(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ce(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),q(()=>{this.accBeta1.assign(Mi(this.beta1,this.iterations_+1)),this.accBeta2.assign(Mi(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MN extends Lo{static get className(){return"Adamax"}constructor(e,n,s,r=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],q(()=>{this.iteration=be(0).variable(),this.accBeta1=be(n).variable()}),r==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);q(()=>{const s=de(1,this.accBeta1),r=ge(-this.learningRate,se(W(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=P.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Ve(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Ve(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,h=this.accumulatedWeightedInfNorm[o].variable,d=se(W(u,this.beta1),W(c,1-this.beta1)),f=W(h,this.beta2),p=Xt(c),g=Vi(f,p);u.assign(d),h.assign(g);const m=se(W(ge(r,s),ge(d,se(g,this.epsilon))),a);a.assign(m)}),this.iteration.assign(se(this.iteration,1)),this.accBeta1.assign(W(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ce(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ce(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lv extends Lo{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=P.registeredVariables[s];q(()=>{const a=se(W(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=ln(be(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LN extends lv{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=be(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=P.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:q(()=>Ve(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&q(()=>{let l;const c=se(W(this.m,o),a);this.useNesterov?l=se(W(this.c,se(a,W(c,this.m))),i):l=se(W(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ce(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zN extends Lo{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=P.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=P.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:q(()=>Ve(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:q(()=>Ve(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:q(()=>Ve(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;q(()=>{const u=se(W(l,this.decay),W(rt(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[r].variable,d=se(W(h,this.decay),W(a,1-this.decay)),f=ge(W(a,this.learningRate),Sn(de(u,se(rt(d),this.epsilon)))),p=se(W(c,this.momentum),f);l.assign(u),h.assign(d),c.assign(p);const g=de(i,p);i.assign(g)}else{const h=se(W(l,this.decay),W(rt(a),1-this.decay)),d=se(W(c,this.momentum),ge(W(a,this.learningRate),Sn(se(h,this.epsilon))));l.assign(h),c.assign(d);const f=de(i,d);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ce(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ce(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ce(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gie=[ON,PN,FN,MN,LN,zN,lv];function qie(){for(const t of Gie)re(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kie="model",Xie=".json",Yie=".weights.bin";function JR(t){return new Promise(e=>setTimeout(e)).then(t)}class wc{constructor(e){if(!K().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(wc.URL_SCHEME)&&(e=e.slice(wc.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Kie),this.modelJsonFileName=e+Xie,this.weightDataFileName=e+Yie}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=ui.join(e.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=Xz(e,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await JR(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await JR(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Cg(e)}}}}wc.URL_SCHEME="downloads://";class Qie{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=r=>{const i=JSON.parse(r.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=SI(i,c=>this.loadWeights(c));e(l)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const o of e)n.push(...o.weights),s.push(...o.paths);const r=this.checkManifestAndWeightFiles(e),i=s.map(o=>this.loadWeightsFile(o,r[o]));return Promise.all(i).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((s,r)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;s(a)},i.onerror=o=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(i=>YR(i.name)),r={};for(const i of e)i.paths.forEach(o=>{const a=YR(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);r[o]=this.weightsFiles[s.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const Zie=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(wc.URL_SCHEME)?Jie(t.slice(wc.URL_SCHEME.length)):null;Ct.registerSaveRouter(Zie);function Jie(t="model"){return new wc(t)}function eoe(t){return new Qie(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eO(t,e,n,s){o(t),n=n??0,s=s??1,a(n,s);let r=0;const i=l=>(l.then(c=>{const u=n+ ++r/t.length*(s-n);return e(u),c}),l);function o(l){N(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){N(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),N(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),N(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hV(t,e){e==null&&(e={});const n=e.fetchFunc==null?K().platform.fetch:e.fetchFunc,s=t.map(h=>n(h,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(s):await eO(s,e.onProgress,0,.5)).map(h=>h.arrayBuffer());return e.onProgress==null?await Promise.all(a):await eO(a,e.onProgress,.5,1)}function toe(t,e){var n;const s=e.fetchFunc==null?K().platform.fetch:e.fetchFunc;let r=0,i;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var a;r<t.length;){i||(i=(await s(t[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await i.read();if(l){r++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,r/t.length);continue}o.enqueue(c);return}o.close()}})}async function dV(t,e="",n,s){return fV(o=>hV(o,{requestInit:s}))(t,e,n)}function fV(t){return async(e,n="",s)=>{const r=e.map(()=>!1),i={},o=s!=null?s.map(()=>!1):[],a=[];if(e.forEach((f,p)=>{let g=0;f.weights.forEach(m=>{const x="quantization"in m?m.quantization.dtype:m.dtype,y=dc[x]*Q(m.shape),b=()=>{r[p]=!0,i[p]==null&&(i[p]=[]),i[p].push({manifestEntry:m,groupOffset:g,sizeBytes:y})};s!=null?s.forEach((w,v)=>{w===m.name&&(b(),o[v]=!0)}):b(),a.push(m.name),g+=y})}),!o.every(f=>f)){const f=s.filter((p,g)=>!o[g]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=r.reduce((f,p,g)=>(p&&f.push(g),f),[]),c=[];l.forEach(f=>{e[f].paths.forEach(p=>{const g=n+(n.endsWith("/")?"":"/")+p;c.push(g)})});const u=await t(c),h={};let d=0;return l.forEach(f=>{const p=e[f].paths.length,g=new ui(u.slice(d,d+p));i[f].forEach(x=>{const y=g.slice(x.groupOffset,x.groupOffset+x.sizeBytes),b=bI(y,[x.manifestEntry]);for(const w in b)h[w]=b[w]}),d+=p}),h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const noe="application/octet-stream",soe="application/json";class BN{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(N(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=K().platform.fetch,N(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&N(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=Xz(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:soe}),"model.json"),e.weightData!=null){const o=ui.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:noe}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:Cg(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return SI(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=Zy(e.weightsManifest),r=()=>toe(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=roe(n),i=this.weightPathPrefix||s,o=[],a=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(c)):o.push(i+c+r);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const n=await this.getWeightUrls(e),s=Zy(e),r=await hV(n,this.loadOptions);return[s,r]}}BN.URL_SCHEME_REGEX=/^https?:\/\//;function roe(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function Uk(t){return t.match(BN.URL_SCHEME_REGEX)!=null}const pV=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>Uk(s)):n=Uk(t),n)return VN(t,e)}return null};Ct.registerSaveRouter(pV);Ct.registerLoadRouter(pV);function VN(t,e){return new BN(t,e)}function mV(t,e){return VN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z2{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class gV{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class ioe{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function ooe(t,e,n,s){const r=arguments;return new ioe(e1(...r))}function e1(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new z2(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new z2({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new z2({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function aoe(t){return new gV(t)}function loe(t){return new gV(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WN=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:ui,browserFiles:eoe,browserHTTPRequest:mV,concatenateArrayBuffers:Kz,copyModel:WJ,decodeWeights:bI,decodeWeightsStream:qz,encodeWeights:Pk,fromMemory:ooe,fromMemorySync:e1,getLoadHandlers:Qz,getModelArtifactsForJSON:SI,getModelArtifactsForJSONSync:vI,getModelArtifactsInfoForJSON:Cg,getSaveHandlers:Yz,getWeightSpecs:Zy,http:VN,isHTTPScheme:Uk,listModels:BJ,loadWeights:dV,moveModel:UJ,registerLoadRouter:_J,registerSaveRouter:NJ,removeModel:VJ,weightsLoaderFactory:fV,withSaveHandler:aoe,withSaveHandlerSync:loe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(t,e,n){const s=$(t,"labels","confusionMatrix"),r=$(e,"predictions","confusionMatrix");N(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),N(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),N(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),N(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),N(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const i=lh(ae(s,"int32"),n),o=lh(ae(r,"int32"),n),a=Me(i),l=Re(a,o);return ae(l,"int32")}const uoe=M({confusionMatrix_:coe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hoe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:uoe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dl,tO=!1;function xV(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Bp(Xy,P.backendName)!=null){const p={pixels:t},g={numChannels:e};return P.runKernel(Xy,p,g)}const[c,u]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let h;if(o)h=t.getContext("2d").getImageData(0,0,c,u).data;else if(s||n)h=t.data;else if(i||r||a){if(dl==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")dl=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else dl=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});dl.canvas.width=c,dl.canvas.height=u,dl.drawImage(t,0,0,c,u),h=dl.getImageData(0,0,c,u).data}let d;if(e===4)d=new Int32Array(h);else{const p=c*u;d=new Int32Array(p*e);for(let g=0;g<p;g++)for(let m=0;m<e;++m)d[g*e+m]=h[g*4+m]}return kN(d,[u,c,e],"int32")}function doe(t){return t!=null&&t.data instanceof Uint8Array}function foe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function poe(t){return t!=null&&t.width!==0&&t.height!==0}function moe(t){return foe()&&!(t instanceof ImageBitmap)&&poe(t)&&!doe(t)}async function goe(t,e=3){let n=null;if(K().getBool("WRAP_TO_IMAGEBITMAP")&&moe(t)){let s;try{s=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===t.width&&s.height===t.height?n=s:n=t}else n=t;return xV(n,e)}function yV(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function xoe(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function yoe(t,e){let n=$(t,"img","toPixels");if(!(t instanceof je)){const c=n;n=ae(c,"int32"),c.dispose()}yV(n);const[s,r]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2],o=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let c=0;c<s*r;++c){const u=[0,0,0,255];for(let d=0;d<i;d++){const f=o[c*i+d];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);i===1?(u[0]=f*a,u[1]=f*a,u[2]=f*a):u[d]=f*a}const h=c*4;l[h+0]=Math.round(u[0]),l[h+1]=Math.round(u[1]),l[h+2]=Math.round(u[2]),l[h+3]=Math.round(u[3])}if(e!=null){tO||Bp(Fb,P.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),tO=!0),e.width=r,e.height=s;const c=e.getContext("2d"),u=new ImageData(l,r,s);c.putImageData(u,0,0)}return n!==t&&n.dispose(),l}function boe(t,e,n){let s=$(t,"img","draw");if(!(t instanceof je)){const o=s;s=ae(o,"int32"),o.dispose()}yV(s),xoe(n==null?void 0:n.imageOptions);const r={image:s},i={canvas:e,options:n};P.runKernel(Fb,r,i)}const bV=M({fromPixels_:xV}),woe=Object.freeze(Object.defineProperty({__proto__:null,draw:boe,fromPixels:bV,fromPixelsAsync:goe,toPixels:yoe},Symbol.toStringTag,{value:"Module"}));function cv(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(Q(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let o=1;for(let h=0;h<r.length-1;++h)o*=r[h];const a=t.shape,l=r.slice();l.pop();let c=1;for(let h=i;h<n;++h)c*=a[h],l.push(a[h]);const u=[...we(t.shape).map(h=>h/c),1].slice(0,i);return[l,o,c,u]}const voe=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:cv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jk=-2,Soe=-1;function UN(t,e,n){const s=t.shape.length;N(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),N(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)N(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function koe(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function jN(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function wV(t,e,n,s){const r=[...t];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function vV(t,e,n){return n<=t?n:n-(e-1)}function SV(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function Coe(t,e,n,s,r,i,o,a,l){const c=t.length;let u=new Array(c),h=new Array(c),d=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=kV(o,f,p,s,t),h=CV(a,f,p,r,t),d=wV(i,f,p,t)}else for(let f=0;f<c;f++)u[f]=IV(o,s,i,t,f,l),h[f]=NV(a,r,i,t,f,l),d[f]=TV(i,f,l);return{begin:u,end:h,strides:d}}function kV(t,e,n,s,r){const i=[...r],o=SV(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=vV(e,n,a);let c=s[l];t&1<<l&&(c=0),i[a]=c}return i}function CV(t,e,n,s,r){const i=[...r],o=SV(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=vV(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=Ra(0,i[a],r[a])}return i}function TV(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function IV(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=Ra(0,o,l-1),o}function NV(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=Ra(0,o,l):o=Ra(-1,o,l-1),o}function HN(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function GN(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function uv(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{N(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(N(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,i]}function qN(t,e,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<h.dims;b++)u&&1<<b&a&&h.numAddAxisAfterEllipsis++,1<<b&o&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Toe(h,d);let f=!0,p=!0,g=!0;const m=[],x=[];for(let b=0;b<t.length;++b){if(d.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const w=!!(d.shrinkAxisMask&1<<b),v=t[b];if(v===-1){m.push(w?1:-1);continue}const S=[d.beginMask&1<<b,d.endMask&1<<b],T=[d.strides[b]>0?0:-1,d.strides[b]>0?v:v-1];if(w&&d.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&d.strides[b]===1;const k=!!(d.beginMask&1<<b&&d.endMask&1<<b);if(d.beginValid&&d.endValid){if(w){const A=d.begin[b]<0?v+d.begin[b]:d.begin[b];if(d.begin[b]=A,d.end[b]=d.begin[b]+1,A<0||A>=v)throw Error(`slice index ${d.begin[b]} of dimension ${b} out of bounds.`)}else d.begin[b]=nO(d.begin[b],0,d.strides[b],v,S,T),d.end[b]=nO(d.end[b],1,d.strides[b],v,S,T);const D=d.strides[b]===1&&d.begin[b]===0&&d.end[b]===v;f=f&&D,p=p&&(b===0&&d.strides[b]===1||D)}else f=f&&d.strides[b]===1&&k,p=p&&(b===0&&d.strides[b]===1||k);let I,_=!1;if(d.beginValid&&d.endValid?(I=d.end[b]-d.begin[b],_=!0):w?(I=1,_=!0):k&&v>=0&&(d.strides[b]<0?I=-v:I=v,_=!0),_){let D;I===0||I<0!=d.strides[b]<0?D=0:D=Math.trunc(I/d.strides[b])+(I%d.strides[b]!==0?1:0),m.push(D)}else m.push(-1)}for(let b=0;b<d.finalShapeGatherIndices.length;++b){const w=d.finalShapeGatherIndices[b];w>=0?x.push(m[w]):w===jk&&x.push(1)}return{finalShapeSparse:x.filter((b,w)=>d.finalShapeGatherIndices[w]!==jk),finalShape:x,isIdentity:f,sliceDim0:p,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function Toe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(jk),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Soe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function nO(t,e,n,s,r,i){if(r[e])return n>0?i[e]:i[e+1&1];{const o=t<0?s+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const _V=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:UN,computeFlatOffset:GN,computeOutShape:jN,getNormalizedAxes:Coe,isSliceContinous:HN,maskToAxes:koe,parseSliceParams:uv,sliceInfo:qN,startForAxis:IV,startIndicesWithElidedDims:kV,stopForAxis:NV,stopIndicesWithElidedDims:CV,stridesForAxis:TV,stridesWithElidedDims:wV},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const $V="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EV{static sgd(e){return new lv(e)}static momentum(e,n,s=!1){return new LN(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,i=!1){return new zN(e,n,s,r,i)}static adam(e=.001,n=.9,s=.999,r=null){return new FN(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new ON(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,i=0){return new MN(e,n,s,r,i)}static adagrad(e,n=.1){return new PN(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cl=EV;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ioe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function KN(){return new Promise(t=>Ioe(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XN(t,e){const n=t[0].length;t.forEach((r,i)=>{N(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),N(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,i)=>{for(let o=0;o<n;o++)N(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Di(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Kr;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Kr||(Kr={}));function DV(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${i} but shape[${r+t}] = ${a}`)}else s[o]=i}return s}function AV(t){const e={FIRST_DIM_SIZE:Kr.FIRST_DIM_SIZE,VALUE_ROWIDS:Kr.VALUE_ROWIDS,ROW_LENGTHS:Kr.ROW_LENGTHS,ROW_SPLITS:Kr.ROW_SPLITS,ROW_LIMITS:Kr.ROW_LIMITS,ROW_STARTS:Kr.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function RV(t){return t.length===0?0:t[0]===Kr.FIRST_DIM_SIZE?t.length-1:t.length}function OV(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=t[r],o=e[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${i} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YN=30;function hv(t){return t<=YN?t:Gy(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QN(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ug(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(i+1))}return r}function jg(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function Hg(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?s?r.push(e[i-1]*t[i]):r.push(t[i]/e[i-1]):r.push(t[i]);return r}function ZN(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function JN(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dv=1.7580993408473768,fv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_=.3275911,t_=.254829592,n_=-.284496736,s_=1.421413741,r_=-1.453152027,i_=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _o(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function PV(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function FV(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function MV(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function o_(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function LV(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function zV(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const i=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function BV(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B2="->",Noe=/->/g,sO=",",rO="...";function a_(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Noe,"").length)/B2.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${B2}").`);const[s,r]=t.split(B2);N(s.indexOf(rO)===-1,()=>`The ellipsis notation ("${rO}") is not supported yet.`);const i=s.split(sO),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<r.length;++d){const f=r[d];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<s.length;++d){const f=s[d];a.indexOf(f)===-1&&f!==sO&&a.push(f)}const l=new Array(i.length);for(let d=0;d<o;++d){if(new Set(i[d].split("")).size!==i[d].length)throw new Error(`Found duplicate axes in input component ${i[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<i[d].length;++f)l[d].push(a.indexOf(i[d][f]))}const c=a.length,u=r.length,h=[];for(let d=u;d<c;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function l_(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function c_(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=i[o]:N(s[e[r][o]]===i[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function u_(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=_oe(e,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function h_(t){return t.every((e,n)=>e===n)}function _oe(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function d_(t,e,n=0){let s=[];if(typeof e=="number")N(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);N(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}N(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VV(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function WV(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function UV(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jV(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function HV(t,e){return`size ${t} must be non-negative, not ${e}`}function GV(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function qV(t,e){const n=Q(t),s=Q(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function KV(t,e){const n=Q(t),s=Q(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hk(){return"segment ids must be >= 0"}function XV(){return"segment ids are not increasing"}function YV(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function QV(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZV(t,e){let n=!1,s;for(t<=YN?(s=t,n=!0):s=Gy(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=Gy(t,s+1);return s}function JV(t,e,n){const s=[],r=t.length;for(let i=0;i<r;i++)i!==e?s.push(t[i]):s.push(n);return s}function f_(t,e,n,s){const r=e.shape.length,i=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let h=0;h<s;++h)if(t.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${t.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let h=0;h<s;++h)a.push(t.shape[h]),l*=t.shape[h];for(let h=s;h<n;h++)a.push(t.shape[h]),c*=t.shape[h];for(let h=s;h<r;h++)a.push(e.shape[h]);for(let h=n+1;h<i;h++)a.push(t.shape[h]),u*=t.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const $oe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:f_,computeOutShape:JV,segOpComputeOptimalWindowSize:ZV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $o(t){try{return t.map(e=>Co(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function e5(t){return t.map(e=>$i(e))}const t5=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:t_,ERF_A2:n_,ERF_A3:s_,ERF_A4:r_,ERF_A5:i_,ERF_P:e_,PARALLELIZE_THRESHOLD:YN,get RowPartitionType(){return Kr},SELU_SCALE:fv,SELU_SCALEALPHA:dv,applyActivation:sv,assertAndGetBroadcastShape:Te,assertAxesAreInnerMostDims:Mn,assertParamsConsistent:XN,assignToTypedArray:LV,axesAreInnerMostDims:YI,calculateShapes:ol,checkEinsumDimSizes:c_,checkPadOnDimRoundingMode:ls,combineLocations:dB,combineRaggedTensorToTensorShapes:DV,complexWithEvenIndex:FV,complexWithOddIndex:MV,computeConv2DInfo:Cn,computeConv3DInfo:tl,computeDefaultPad:AI,computeDilation2DInfo:Tg,computeOptimalWindowSize:hv,computeOutAndReduceShapes:Tn,computeOutShape:Di,computePool2DInfo:Fr,computePool3DInfo:Ro,convertConv2DDataFormat:Oo,decodeEinsumEquation:a_,eitherStridesOrDilationsAreOne:Fn,expandShapeToKeepDim:Wt,exponent:BV,exponents:zV,fromStringArrayToUint8:e5,fromUint8ToStringArray:$o,getAxesPermutation:Et,getBroadcastDims:xc,getComplexWithIndex:o_,getEinsumComputePath:u_,getEinsumPermutation:l_,getFusedBiasGradient:nv,getFusedDyActivation:tv,getImageCenter:QN,getInnerMostAxes:Ht,getPermuted:jg,getRaggedRank:RV,getReductionAxes:sn,getReshaped:Ug,getReshapedPermuted:Hg,getRowPartitionTypesHelper:AV,getSliceBeginCoords:ZN,getSliceSize:JN,getSparseFillEmptyRowsIndicesDenseShapeMismatch:VV,getSparseFillEmptyRowsNegativeIndexErrorMessage:WV,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:UV,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:GV,getSparseReshapeInputOutputMismatchErrorMessage:KV,getSparseReshapeInputOutputMultipleErrorMessage:qV,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:jV,getSparseReshapeNegativeOutputDimErrorMessage:HV,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:QV,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Hk,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:XV,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:YV,getUndoAxesPermutation:nl,isIdentityPermutation:h_,log:_Z,mergeRealAndImagArrays:_o,prepareAndValidate:cv,prepareSplitSize:d_,segment_util:$oe,shouldFuse:rv,slice_util:_V,splitRealAndImagArrays:PV,stridesOrDilationsArePositive:gc,tupleValuesAreOne:Fa,upcastType:xs,validateDefaultValueShape:OV,validateInput:Yw,validateUpdateShape:CN,warn:Js},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:iv,nonMaxSuppressionV4Impl:ov,nonMaxSuppressionV5Impl:av,whereImpl:Jw},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */qie();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n5={kernelName:wm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(t,qc(ae(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Doe={kernelName:_h,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=rt(ae(n,"float32")),r=Sn(de(be(1),s));return ct(ge(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aoe={kernelName:$h,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Sn(de(rt(ae(n,"float32")),1));return ge(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Roe={kernelName:Wc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Te(n.shape,s.shape);return{a:()=>{let a=t;const l=sn(n.shape,r);return l.length>0&&(a=fe(a,l)),U(a,n.shape)},b:()=>{let a=t;const l=sn(s.shape,r);return l.length>0&&(a=fe(a,l)),U(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ooe={kernelName:vm,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Poe={kernelName:Sm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Foe={kernelName:km,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Moe={kernelName:Eh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,Sn(de(be(1),rt(ae(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Loe={kernelName:Dh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Sn(se(be(1),rt(ae(n,"float32"))));return ge(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zoe={kernelName:Oh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Te(n.shape,s.shape);return{a:()=>{const a=se(rt(n),rt(s));let l=W(t,ge(s,a));const c=sn(n.shape,r);return c.length>0&&(l=fe(l,c)),U(l,n.shape)},b:()=>{const a=se(rt(n),rt(s));let l=ct(W(t,ge(n,a)));const c=sn(s.shape,r);return c.length>0&&(l=fe(l,c)),U(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Boe={kernelName:Ah,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,se(rt(ae(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Voe={kernelName:Rh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,de(be(1),rt(ae(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Woe(t,e,n,s,r,i){const o=$(t,"dy","avgPool3dGrad"),a=$(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),N(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),N(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),ls("avgPool3dGrad",r,i);const h={dy:l,input:c},d={filterSize:n,strides:s,pad:r,dimRoundingMode:i},f=P.runKernel(Sb,h,d);return u?U(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Uoe=M({avgPool3dGrad_:Woe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const joe={kernelName:Tm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>Uoe(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hoe(t,e,n,s,r){const i=$(t,"dy","avgPoolGrad"),o=$(e,"input","avgPoolGrad");N(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),N(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),N(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},h={filterSize:n,strides:s,pad:r},d=P.runKernel(vb,u,h);return c?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Goe=M({avgPoolGrad_:Hoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe={kernelName:Cm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>Goe(t,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Koe={kernelName:Im,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>Re(t,r,!1,!0),b:()=>Re(s,t,!0,!1)}:!i&&o?{a:()=>Re(t,r,!1,!1),b:()=>Re(t,s,!0,!1)}:i&&!o?{a:()=>Re(r,t,!1,!0),b:()=>Re(s,t,!1,!1)}:{a:()=>Re(r,t,!0,!0),b:()=>Re(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xoe={kernelName:Nm,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>Fg(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe={kernelName:Cz,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>fe(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qoe={kernelName:Ph,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zoe={kernelName:Fh,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Joe={kernelName:Mh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>wn(Pr(Po(s,r),sl(s,i)),t,Ve(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eae={kernelName:$m,inputsToSave:["x"],gradFunc:n5.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tae={kernelName:Em,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,i=Oe(r,e[0].shape)[0],o=s.map(l=>l[i]);return gs(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nae={kernelName:Dm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return N(Fa(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>UI(s.shape,t,r,o,a,l),filter:()=>DN(s,t,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sae={kernelName:Am,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>No(t,r,i,o,a,1,l),filter:()=>DN(t,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rae(t,e,n,s,r){let i=t;t.rank===4&&(i=U(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),N(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),N(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),N(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),N(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),N(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return P.runKernel(Nb,a,l)}const iae=M({conv3DBackpropFilter_:rae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oae={kernelName:Rm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i}=n;N(Fa(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>cB(o.shape,t,a,r,i),filter:()=>iae(o,t,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aae={kernelName:Lh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(ct(Hw(ae(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lae={kernelName:zh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(Gw(ae(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cae={kernelName:Om,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=Et([r],s.rank);let l=Aw(t,r,i,!o);return a!=null&&(l=Me(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae={kernelName:Pm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];N(Fa(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return N(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),N(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),N(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),N(Fn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),ls("depthwiseConv2d",i,o),{x:()=>eV(l.shape,t,c,r,i,a,o),filter:()=>JB(l,t,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hae={kernelName:Fm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,i={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>P.runKernel(qy,i,n),filter:()=>P.runKernel(Ky,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dae={kernelName:Vh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>P.runKernel(Lb,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fae={kernelName:Wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=W(ws(ct(rt(n))),2/Math.sqrt(Math.PI));return{x:()=>W(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pae={kernelName:Uh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mae={kernelName:Lm,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>U(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gae={kernelName:jh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(t,ws(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xae={kernelName:Hh,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yae={kernelName:Gh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Te(n.shape,s.shape);return{a:()=>{const a=ge(t,ae(s,"float32")),l=sn(n.shape,r);return l.length>0?U(fe(a,l),n.shape):a},b:()=>{let a=W(t,ae(n,"float32"));const l=sn(s.shape,r);l.length>0&&(a=U(fe(a,l),s.shape));const c=rt(s);return ct(ge(a,ae(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bae={kernelName:zm,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=e,l=a??be(1),c=sn(i.shape,r.shape),u=[];if(i.rank===1){for(let w=0;w<r.shape.length-1;++w)u.push(r.shape[w]);u.push(1)}const h=de(r,i),d=W(t,l),f=Ww(se(o,be(s))),p=W(W(W(f,f),f),be(-.5));return{x:()=>i.rank===1?U(W(W(t,sr(U(f,[1,1,1,i.shape[0]]),u)),l),r.shape):U(W(W(t,f),l),r.shape),mean:()=>{let w=W(W(f,be(-1)),d);return i.rank===1&&(w=fe(w,c)),U(w,i.shape)},variance:()=>{let w=W(W(p,h),d);return i.rank===1&&(w=fe(w,c)),U(w,i.shape)},scale:()=>{const w=W(h,f);let v=W(t,w);return i.rank===1&&(v=fe(v,c)),U(v,i.shape)},offset:()=>{let w=t;return i.rank===1&&(w=fe(w,c)),U(w,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wae={kernelName:Bm,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:i,batchDims:o}=n,a=Oe(i,s.shape)[0],l=(c,u,h)=>()=>{const d=c.shape,f=u.size,p=d.slice(0,a),g=p.length,m=d.slice(i,d.length).slice(1),x=m.length,y=iO(0,g),b=iO(g+1,g+1+x),w=oO([p,[f],m]),v=U(h,w),S=U(u,[f]),T=oO([[g],y,b]),k=Me(v,T);let I=Zw(k,S,c.shape[a]);const _=nl(T);return I=Me(I,_),I};if(o===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>is(u.map((f,p)=>l(f,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function iO(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function oO(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vae={kernelName:qh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Ve(n),b:()=>Ve(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sae={kernelName:Kh,gradFunc:t=>({x:()=>ae(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kae={kernelName:Xh,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cae={kernelName:Yh,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tae={kernelName:Qh,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iae={kernelName:Wm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,i=cs(s,0);return{x:()=>wn(i,t,W(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nae={kernelName:Jh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,se(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ae={kernelName:Zh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,ae(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ae={kernelName:Tz,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=ws(s);return de(t,W(fe(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eae(t,e,n,s=5,r=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return P.runKernel(Gb,a,l)}const Dae=M({localResponseNormalizationBackprop_:Eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aae={kernelName:Km,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>Dae(s,r,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s5(t,e,n,s){return e.rank<n.rank&&(e=U(e,Wt(e.shape,s))),t.rank<n.rank&&(t=U(t,Wt(t.shape,s))),{x:()=>W(t,ae(Vs(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aO={kernelName:Xm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,i=e[0],o=e[1],a=Oe(r,i.shape),l=s5(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rae={kernelName:ed,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>W(t,ae(Po(n,s),"float32")),b:()=>W(t,ae(ah(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oae(t,e,n,s,r,i,o){const a=$(t,"dy","maxPool3dGrad"),l=$(e,"input","maxPool3dGrad"),c=$(n,"output","maxPool3dGrad");let u=a,h=l,d=c,f=!1;l.rank===4&&(f=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=U(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=U(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),N(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),N(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),N(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),ls("maxPool3dGrad",i,o);const p={dy:u,input:h,output:d},g={filterSize:s,strides:r,pad:i,dimRoundingMode:o},m=P.runKernel(Kb,p,g);return f?U(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const Pae=M({maxPool3dGrad_:Oae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fae={kernelName:Qm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>Pae(t,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(t,e,n,s,r,i,o){const a=$(t,"dy","maxPoolGrad"),l=$(e,"input","maxPoolGrad"),c=$(n,"output","maxPoolGrad");N(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),N(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),N(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),ls("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},h={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return P.runKernel(qb,u,h)}const Lae=M({maxPoolGrad_:Mae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zae={kernelName:Ym,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>Lae(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bae={kernelName:Zm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,i=Oe(r,s.shape),a=Tn(s.shape,i)[1],l=Q(a);return{x:()=>{const u=s.shape.slice();i.forEach(f=>{u[f]=1});const h=U(t,u);return ge(W(h,ps(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vae={kernelName:Jm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[i,o]=e,a=Oe(r,i.shape),l=s5(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wae={kernelName:td,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>W(t,ae(sl(n,s),"float32")),b:()=>W(t,ae(cs(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uae={kernelName:eg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>Be(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jae={kernelName:nd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Te(n.shape,s.shape);return{a:()=>{const a=sn(n.shape,r);return a.length>0?U(fe(t,a),n.shape):t},b:()=>{const a=W(t,ct(Nd(ge(n,s)))),l=sn(s.shape,r);return l.length>0?U(fe(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hae={kernelName:sd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Te(n.shape,s.shape);return{a:()=>{const a=W(t,ae(s,"float32")),l=sn(n.shape,r);return l.length>0?U(fe(a,l),n.shape):a},b:()=>{const a=W(t,ae(n,"float32")),l=sn(s.shape,r);return l.length>0?U(fe(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gae={kernelName:tg,gradFunc:t=>({x:()=>ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qae={kernelName:rg,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Qt(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kae={kernelName:sg,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xae={kernelName:ig,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return dr(t,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lO={kernelName:og,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>Be(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yae={kernelName:rd,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,i=n,o=s,a=Te(i.shape,o.shape);return{a:()=>{const u=ae(o,"float32");let h=W(t,W(u,Mi(i,de(u,be(1)))));const d=sn(i.shape,a);return d.length>0&&(h=fe(h,d)),U(h,i.shape)},b:()=>{const u=cs(i,0),h=wn(u,Ws(i),Ve(i));let d=W(t,W(r,h));const f=sn(o.shape,a);return f.length>0&&(d=fe(d,f)),U(d,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qae={kernelName:ag,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=cs(n,0);return{x:()=>wn(r,t,W(t,s)),alpha:()=>{let i=wn(r,Ve(t),W(t,n));const o=sn(s.shape,t.shape);return o.length>0&&(i=fe(i,o)),U(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zae(t,e,n){const s=t.shape.slice();s[n]=1;const r=U(e,s),i=Gp(t,n,!0,!1),o=Gp(t,n,!0,!0),a=W(i,o);return W(r,a)}function Jae(t,e,n){const s=t.shape.length,r=s-n.length,i=Et(n,s);let o=t;i!=null&&(o=Me(t,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((d,f)=>d*f,1);a.push(c);const u=o.reshape(a);let h=Zae(u,e,r);if(h=h.reshape(o.shape),i!=null){const d=nl(i);h=Me(h,d)}return h}const ele={kernelName:lg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>Jae(s,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tle={kernelName:Bh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Te(n.shape,s.shape);return{a:()=>{const a=ge(t,ae(s,"float32")),l=sn(n.shape,r);return l.length>0?U(fe(a,l),n.shape):a},b:()=>{let a=W(t,ae(n,"float32"));const l=sn(s.shape,r);l.length>0&&(a=U(fe(a,l),s.shape));const c=rt(s);return ct(ge(a,ae(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nle={kernelName:id,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,ct(rt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sle={kernelName:ad,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=W(sl(n,6),qc(n));return{x:()=>W(t,ae(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rle={kernelName:od,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(t,ae(qc(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ile={kernelName:cg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>U(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ole={kernelName:hg,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>P.runKernel(ow,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ale={kernelName:ug,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>P.runKernel(iw,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lle={kernelName:dg,gradFunc:(t,e,n)=>{const{dims:s}=n,r=Oe(s,t.shape);return{x:()=>hr(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cle={kernelName:ld,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ule={kernelName:cd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(ge(t,W(Mi(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hle={kernelName:fg,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>ae(Ve(n),"float32"),t:()=>W(t,ae(n,t.dtype)),e:()=>W(t,ae(Rg(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dle={kernelName:ud,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=cs(n,be(0)),r=be(dv),i=be(fv),o=W(t,i),a=W(W(t,r),ws(ae(n,"float32")));return wn(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fle={kernelName:pd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(t,W(n,de(be(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ple={kernelName:fd,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mle={kernelName:hd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(_g(ae(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gle={kernelName:dd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(Dw(ae(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xle={kernelName:pg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:i}=n,o=s.shape,[a,l]=uv(s,r,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>Fo(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yle={kernelName:yg,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,i=!0,o=W(t,s);return{logits:()=>de(o,W(fe(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ble={kernelName:md,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(t,Jr(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cO={kernelName:gg,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>Ng(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uO={kernelName:xg,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>Vt(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wle={kernelName:gd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,W(Sn(ae(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vle={kernelName:mw,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(t,W(ae(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sle={kernelName:xd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=be(2);return{a:()=>W(t,W(r,de(n,s))),b:()=>W(t,W(r,de(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle={kernelName:Sd,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cle={kernelName:yd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Te(n.shape,s.shape);return{a:()=>{let a=t;const l=sn(n.shape,r);return l.length>0&&(a=fe(a,l)),U(a,n.shape)},b:()=>{let a=t;const l=sn(s.shape,r);return l.length>0&&(a=fe(a,l)),U(ct(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tle={kernelName:mg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:i}=n;Oe(i,s.shape).forEach(c=>{r[c]=1});const a=U(t,r),l=W(a,ps(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile={kernelName:bd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,rt(_g(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nle={kernelName:wd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>W(de(be(1),rt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _le={kernelName:vd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=Ve(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=se(o,Be(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=se(o,Be(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=se(o,Be(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=se(o,Be(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $le={kernelName:ql,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,i=nl(r);return{x:()=>Me(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ele={kernelName:wg,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>is(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dle={kernelName:vg,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ale(t,n)}}};function Ale(t,e){const n=Vi(e,Ve(e)),s=_d(t,n);let r=Po(e,be(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=$n(r,a+1);r=Pr(r,ps(s.shape,"bool"));const o=Ve(s);return wn(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rle={kernelName:Sg,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole=[n5,Doe,Aoe,Roe,Ooe,Poe,Foe,Moe,Loe,zoe,Boe,Voe,joe,qoe,Koe,Xoe,Yoe,Qoe,Zoe,Joe,eae,tae,sae,nae,oae,aae,lae,cae,uae,hae,tle,dae,fae,pae,mae,gae,yae,xae,bae,wae,vae,Sae,kae,Cae,Tae,Iae,Nae,_ae,$ae,Aae,aO,aO,Rae,Fae,zae,Bae,Vae,Wae,Uae,jae,Hae,Gae,qae,Kae,Xae,lO,lO,Yae,Qae,ele,nle,sle,rle,ile,ole,ale,lle,cle,ule,hle,dle,fle,ple,mle,gle,xle,yle,ble,cO,cO,uO,uO,wle,Sle,vle,kle,Cle,Tle,Ile,Nle,_le,$le,Ele,Dle,Rle];for(const t of Ole)Iz(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.abs=function(){return this.throwIfDisposed(),Xt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.acos=function(){return this.throwIfDisposed(),CI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.acosh=function(){return this.throwIfDisposed(),TI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.add=function(t){return this.throwIfDisposed(),se(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.all=function(t,e){return this.throwIfDisposed(),_w(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.any=function(t,e){return this.throwIfDisposed(),Up(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.argMax=function(t){return this.throwIfDisposed(),mc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.argMin=function(t){return this.throwIfDisposed(),II(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.asScalar=function(){return this.throwIfDisposed(),N(this.size===1,()=>"The array must have only 1 element."),U(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.asType=function(t){return this.throwIfDisposed(),ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as1D=function(){return this.throwIfDisposed(),U(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as2D=function(t,e){return this.throwIfDisposed(),U(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),U(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),U(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),U(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.asin=function(){return this.throwIfDisposed(),NI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.asinh=function(){return this.throwIfDisposed(),_I(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.atan=function(){return this.throwIfDisposed(),$I(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.atan2=function(t){return this.throwIfDisposed(),EI(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.atanh=function(){return this.throwIfDisposed(),DI(this)};J().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),Ig(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Ng(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),kd(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Kl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cast=function(t){return this.throwIfDisposed(),ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.ceil=function(){return this.throwIfDisposed(),LI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),bs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof je&&(t=[t]),Vt([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.conv1d=function(t,e,n,s,r,i){return this.throwIfDisposed(),$w(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),Ew(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.conv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),No(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cos=function(){return this.throwIfDisposed(),_g(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cosh=function(){return this.throwIfDisposed(),Dw(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Gp(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Aw(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),GI(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.depthwiseConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),Cd(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),qI(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.divNoNan=function(t){return this.throwIfDisposed(),KI(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.div=function(t){return this.throwIfDisposed(),ge(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.dot=function(t){return this.throwIfDisposed(),XI(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.elu=function(){return this.throwIfDisposed(),Td(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.equal=function(t){return this.throwIfDisposed(),Vs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.erf=function(){return this.throwIfDisposed(),Rw(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),QI(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.exp=function(){return this.throwIfDisposed(),ws(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.expandDims=function(t){return this.throwIfDisposed(),$n(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.expm1=function(){return this.throwIfDisposed(),ZI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.fft=function(){return this.throwIfDisposed(),Vg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.flatten=function(){return this.throwIfDisposed(),U(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.floor=function(){return this.throwIfDisposed(),Nd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.floorDiv=function(t){return this.throwIfDisposed(),Nw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.gather=function(t,e,n){return this.throwIfDisposed(),_d(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Po(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.greater=function(t){return this.throwIfDisposed(),cs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.ifft=function(){return this.throwIfDisposed(),hh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.irfft=function(){return this.throwIfDisposed(),Kw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.isFinite=function(){return this.throwIfDisposed(),JI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.isInf=function(){return this.throwIfDisposed(),eN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.isNaN=function(){return this.throwIfDisposed(),tN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Eg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.lessEqual=function(t){return this.throwIfDisposed(),sl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.less=function(t){return this.throwIfDisposed(),ah(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),nN(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logSigmoid=function(){return this.throwIfDisposed(),sN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Fw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Ag(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.log=function(){return this.throwIfDisposed(),Ws(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.log1p=function(){return this.throwIfDisposed(),Dg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Pr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logicalNot=function(){return this.throwIfDisposed(),Rg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logicalOr=function(t){return this.throwIfDisposed(),Mw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logicalXor=function(t){return this.throwIfDisposed(),rN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Re(this,t,e,n)};J().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),Og(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.max=function(t,e){return this.throwIfDisposed(),lr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.maximum=function(t){return this.throwIfDisposed(),Vi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.mean=function(t,e){return this.throwIfDisposed(),It(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.min=function(t,e){return this.throwIfDisposed(),oh(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.minimum=function(t){return this.throwIfDisposed(),La(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),oN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.mod=function(t){return this.throwIfDisposed(),aN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.mul=function(t){return this.throwIfDisposed(),W(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.neg=function(){return this.throwIfDisposed(),ct(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Id(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.notEqual=function(t){return this.throwIfDisposed(),yc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),lh(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.onesLike=function(){return this.throwIfDisposed(),Us(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.pad=function(t,e){return this.throwIfDisposed(),Fo(this,t,e)};J().prototype.pool=function(t,e,n,s,r,i){return this.throwIfDisposed(),lN(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.pow=function(t){return this.throwIfDisposed(),Mi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.prelu=function(t){return this.throwIfDisposed(),Mg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.prod=function(t,e){return this.throwIfDisposed(),cN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.reciprocal=function(){return this.throwIfDisposed(),bN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.relu=function(){return this.throwIfDisposed(),hi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.relu6=function(){return this.throwIfDisposed(),Bw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.reshapeAs=function(t){return this.throwIfDisposed(),U(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.reshape=function(t){return this.throwIfDisposed(),U(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),rV(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),iV(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.reverse=function(t){return this.throwIfDisposed(),hr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.rfft=function(){return this.throwIfDisposed(),Wg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.round=function(){return this.throwIfDisposed(),Vw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.rsqrt=function(){return this.throwIfDisposed(),Ww(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.selu=function(){return this.throwIfDisposed(),Uw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.separableConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),jw(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sigmoid=function(){return this.throwIfDisposed(),Jr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sign=function(){return this.throwIfDisposed(),wN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sin=function(){return this.throwIfDisposed(),Hw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sinh=function(){return this.throwIfDisposed(),Gw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.slice=function(t,e){return this.throwIfDisposed(),Be(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.softmax=function(t){return this.throwIfDisposed(),Bg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.softplus=function(){return this.throwIfDisposed(),Hc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Fg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.split=function(t,e){return this.throwIfDisposed(),gs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sqrt=function(){return this.throwIfDisposed(),Sn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.square=function(){return this.throwIfDisposed(),rt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Xw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.squeeze=function(t){return this.throwIfDisposed(),il(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof je?[this,t]:[this,...t];return is(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.step=function(t){return this.throwIfDisposed(),qc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.stridedSlice=function(t,e,n,s,r,i,o,a){return this.throwIfDisposed(),vN(this,t,e,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sub=function(t){return this.throwIfDisposed(),de(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sum=function(t,e){return this.throwIfDisposed(),fe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.tan=function(){return this.throwIfDisposed(),SN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.tanh=function(){return this.throwIfDisposed(),Ma(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.tile=function(t){return this.throwIfDisposed(),sr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.toBool=function(){return this.throwIfDisposed(),ae(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.toFloat=function(){return this.throwIfDisposed(),ae(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.toInt=function(){return this.throwIfDisposed(),ae(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.topk=function(t,e){return this.throwIfDisposed(),TN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.transpose=function(t){return this.throwIfDisposed(),Me(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.unique=function(t){return this.throwIfDisposed(),IN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Zw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.unstack=function(t){return this.throwIfDisposed(),dr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.where=function(t,e){return this.throwIfDisposed(),wn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.zerosLike=function(){return this.throwIfDisposed(),Ve(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yi extends Error{constructor(e){super(e),Object.setPrototypeOf(this,yi.prototype)}}class Dr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Dr.prototype)}}class j extends Error{constructor(e){super(e),Object.setPrototypeOf(this,j.prototype)}}class Ee extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ee.prototype)}}class p_ extends Error{constructor(e){super(e),Object.setPrototypeOf(this,p_.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class r5{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vc(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function bi(t,e){if(!t)throw new p_(e)}function hO(t,e){let n=0;for(const s of t)s===e&&n++;return n}function ds(t){return t.length===1?t[0]:t}function Ze(t){return Array.isArray(t)?t:[t]}function Yi(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function El(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let xr={};function m_(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function Gk(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>Gk(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:Gk(s))}}}function Gg(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in xr)o=xr[i];else if(o=e[i],o==null)throw new j(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new j(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in xr?[a,l]=xr.className:o in e&&([a,l]=e[o]),a==null)throw new j(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(xr))c[f]=xr[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const h=Object.assign({},xr);for(const f of Object.keys(n))xr[f]=n[f];Gk(i.config);const d=l(a,i.config,n,r);return xr=Object.assign({},h),d}else{const c=Object.assign({},xr);for(const h of Object.keys(n))xr[h]=n[h];const u=new a(i.config);return xr=Object.assign({},c),u}}}function Ple(t,e){return t<e?-1:t>e?1:0}function z0(t,e){return-1*Ple(t,e)}function Ca(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function Fle(t){if(t==null)throw new j(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Xc(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new j(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function g_(t,e,n=0,s=1/0){return bi(n>=0),bi(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function yn(t,e){Array.isArray(t)?(N(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>yn(n,`element ${s+1} of ${e}`))):N(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${i5(t)}.`)}function i5(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>i5(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function Mle(t,e,n){let s=n!=null?n():_n(),r;return(...o)=>{const a=n!=null?n():_n();return a-s<e||(s=a,r=t(...o)),r}}function o5(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Lle=0;function a5(){return Lle++}const B0={};function pv(t=""){return t in B0||(B0[t]=0),B0[t]+=1,t+B0[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zle=["channelsFirst","channelsLast"],Ble=["nearest","bilinear"],Vle=["valid","same","causal"],Wle=["max","avg"],Ule=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ou=new Map;function Gt(t){Xc(zle,"DataFormat",t)}function jle(t){Xc(Ble,"InterpolationFormat",t)}function mr(t){Xc(Vle,"PaddingMode",t)}function l5(t){Xc(Wle,"PoolMode",t)}const Jf=[],dO="/";function Xl(t,e){Jf.push(t);try{const n=e();return Jf.pop(),n}catch(n){throw Jf.pop(),n}}function Hle(){return Jf.length===0?"":Jf.join(dO)+dO}function c5(t){if(!h5(t))throw new Error("Not a valid tensor name: '"+t+"'");return Hle()+t}function u5(t){if(!h5(t))throw new Error("Not a valid tensor name: '"+t+"'");ou.has(t)||ou.set(t,0);const e=ou.get(t);if(ou.set(t,ou.get(t)+1),e>0){const n=`${t}_${e}`;return ou.set(n,1),n}else return t}const Gle=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function h5(t){return!!t.match(Gle)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qle(t){return t===parseInt(t.toString(),10)}function Ta(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function dh(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function za(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function ri(t,e){if(e<t)throw new j(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let V2;function cn(){return V2==null&&(V2=yI().epsilon()),V2}function ii(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ai(t,e){return ae(t,e)}function qg(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),U(t,n)}function Kle(t,e){return q(()=>{if(t.shape.length!==2)throw new j(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=qg(t,1);return qk(n,[1,e,1])})}function Xle(t){const e=[Ta(t.shape)];return U(t,e)}function Yle(t){if(t.rank<=1)throw new j(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Ta(t.shape,1)];return U(t,e)}function Yl(t,e,n){return q(()=>{switch(t.rank){case 1:return Lg(t,e,n);case 2:return qw(t,[e,0],[n,t.shape[1]]);case 3:return zg(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return uh(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Be(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Be(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new j(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function W2(t,e,n){return q(()=>{switch(t.rank){case 1:return Lg(t,e,n);case 2:return qw(t,[0,e],[t.shape[0],n]);case 3:return zg(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return uh(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new j(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function V0(t,e,n,s){return q(()=>{switch(t.rank){case 1:return Lg(t,e,n);case 2:switch(s){case 1:return Yl(t,e,n);case 2:return W2(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Yl(t,e,n);case 2:return zg(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return W2(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Yl(t,e,n);case 2:return uh(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return uh(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return W2(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}default:throw new j(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function x_(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Vt(t,e)}function fO(t,e){switch(t.rank){case 1:return zI([t,e]);case 2:return BI([t,e],0);case 3:return VI([t,e],0);case 4:return WI([t,e],0);default:throw new j(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function qk(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new j(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return sr(t,e)}function mv(t,e=0,n=1,s,r){return zw(t,e,n,s,r)}function Ri(t,e,n,s){if(t.rank<2||e.rank<2)throw new Ee(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new Ee(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return Vk({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Kk(t.rank,s,ii()):null,activation:n});{const r=t.shape.slice(),i=r.pop();t=U(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(p,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=U(Me(e,u),[l,-1]);const h=[...r,...c];return U(Vk({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Kk(t.rank,s,ii()):null,activation:n}),h)}}function d5(t,e,n){return q(()=>(Array.isArray(e)?e=xn(e,"int32"):e=ae(e,"int32"),_d(t,e,n)))}function Kg(t){return W(t,t)}function Kk(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new j(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1,1,1]):U(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,1,1,s[0]]):U(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1,1]):U(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,1,s[0]]):U(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1]):U(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,s[0]]):U(e,[1].concat(s))}else if(t<3)return e;throw new j(`Unsupported input rank by biasAdd: ${e.rank}`)}function di(t,e,n){return q(()=>(n==null&&(n=ii()),Gt(n),se(t,Kk(t.rank,e,n))))}function Qle(t,e=1){if(e!==1)throw new Ee(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Td(t)}function Zle(t){return q(()=>ge(t,se(Xt(t),1)))}function f5(t,e,n,s){return q(()=>$N(t,e,n,s))}function Jle(t){return q(()=>{const e=se(.5,W(.2,t));return bs(e,0,1)})}function Xg(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ece=["fanIn","fanOut","fanAvg"],tce=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nce(t){Xc(ece,"FanMode",t)}function sce(t){Xc(tce,"Distribution",t)}class Mr extends Kc{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class y_ extends Mr{apply(e,n){return Qt(e,n)}}y_.className="Zeros";re(y_);class gv extends Mr{apply(e,n){return ps(e,n)}}gv.className="Ones";re(gv);class b_ extends Mr{constructor(e){if(super(),typeof e!="object")throw new j(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new j(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return q(()=>W(be(this.value),ps(e,n)))}getConfig(){return{value:this.value}}}b_.className="Constant";re(b_);class w_ extends Mr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return rl(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}w_.className="RandomUniform";re(w_);class v_ extends Mr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ee(`randomNormal does not support dType ${n}.`);return mv(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}v_.className="RandomNormal";re(v_);class S_ extends Mr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ee(`truncatedNormal does not support dType ${n}.`);return Qw(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}S_.className="TruncatedNormal";re(S_);class k_ extends Mr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return q(()=>{if(e.length!==2||e[0]!==e[1])throw new j("Identity matrix initializer can only be used for 2D square matrices.");return W(this.gain,Ow(e[0]))})}getConfig(){return{gain:this.gain}}}k_.className="Identity";re(k_);function rce(t,e="channelsLast"){let n,s;if(Gt(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Ta(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Ta(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Ta(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class vs extends Mr{constructor(e){if(super(),e.scale<0)throw new j(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,nce(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,sce(this.distribution),this.seed=e.seed}apply(e,n){const s=rce(e),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ee(`${this.getClassName()} does not support dType ${n}.`);return Qw(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return rl(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}vs.className="VarianceScaling";re(vs);class xv extends vs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return vs.className}}xv.className="GlorotUniform";re(xv);class yv extends vs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return vs.className}}yv.className="GlorotNormal";re(yv);class bv extends vs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return vs.className}}bv.className="HeNormal";re(bv);class wv extends vs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return vs.className}}wv.className="HeUniform";re(wv);class vv extends vs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return vs.className}}vv.className="LeCunNormal";re(vv);class Sv extends vs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return vs.className}}Sv.className="LeCunUniform";re(Sv);class C_ extends Mr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return q(()=>{if(e.length<2)throw new Ee("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=Q(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],a=mv(o,0,1,n,this.seed),l=RN.qr(a,!1);let c=l[0];const h=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=W(c,h.sign()),s<r&&(c=c.transpose()),W(be(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}C_.className="Orthogonal";re(C_);const pO={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function mO(t,e={}){return Gg(t,er.getMap().classNameMap,e,"initializer")}function _t(t){return m_(t)}function wt(t){if(typeof t=="string"){const e=t in pO?pO[t]:t;if(e==="GlorotNormal")return new yv;if(e==="GlorotUniform")return new xv;if(e==="HeNormal")return new bv;if(e==="HeUniform")return new wv;if(e==="LeCunNormal")return new vv;if(e==="LeCunUniform")return new Sv;{const n={};return n.className=e,n.config={},mO(n)}}else return t instanceof Mr?t:mO(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xk(t){return Array.isArray(t)&&Array.isArray(t[0])}function t1(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function ke(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new j(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ge(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new j(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function n1(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const gO="Variable";class p5{constructor(e,n="float32",s=gO,r=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=a5(),s=s??gO,this.originalName=c5(s),this.name=u5(this.originalName),this.trainable_=r,this.constraint=i,this.val=NN(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),ice(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function ice(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Yk(t){return t.map(e=>e.read())}function T_(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zt{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class oi{constructor(e,n,s,r,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=a5(),o!=null&&(this.originalName=c5(o),this.name=u5(this.originalName)),this.rank=n.length}}let oce=0;class kv{constructor(e,n){this.callArgs=n,this.id=oce++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let ace=0;class Pe extends Kc{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=ace++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=Yi(s)+"_"+pv(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Dr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new j(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return ds(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return ds(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new yi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new yi(`Layer ${this.name} is not connected, no input to return.`);return ds(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new yi(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new yi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return ds(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Ze(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Ze(this.inputSpec);if(n.length!==s.length)throw new j(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new j(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),h=o.axes[c],d=u>=0?l[u]:l[l.length+u];if(h!=null&&[h,null].indexOf(d)===-1)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${h} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Ze(e),r=uce(e),i=hce(e);if(r===i)throw new j("Arguments to apply() must be all SymbolicTensors or all Tensors");return Xl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of Ze(e))o.push(a.shape);this.build(ds(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=Ze(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=ds(l),this.activityRegularizer!=null)throw new Ee("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=lce(e),a=this.computeOutputShape(o);let l;const c=cce(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,h)=>new oi(c,u,this,Ze(e),n,this.name,h)):l=new oi(c,a,this,Ze(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Ee("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new yi(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new yi(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Dr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return n1(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Yk(e?this.trainableWeights:this.weights)}setWeights(e){q(()=>{const n=this.weights;if(n.length!==e.length)throw new j(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=Yk(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=e[i];if(!Fe(o.shape,l.shape))throw new j(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}T_(s)})}addWeight(e,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new j(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():wt("zeros"));const c=r.apply(n,s),u=new p5(c,s,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Ze(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=Ze(n),o=Ze(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,s,r,i,o,a=null){const l=Ze(e);n=Ze(n),s=Ze(s),r=Ze(r),i=t1(i),o=t1(o);const c=[],u=[],h=[];for(const d of l)c.push(d.sourceLayer),u.push(d.nodeIndex),h.push(d.tensorIndex);new kv({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:h,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function lce(t){t=Ze(t);const e=[];for(const n of t)e.push(n.shape);return ds(e)}function cce(t){return"float32"}function m5(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=m5(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function uce(t){let e=!0;for(const n of Ze(t))if(!(n instanceof oi)){e=!1;break}return e}function hce(t){let e=!0;for(const n of Ze(t))if(n instanceof oi){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Dd extends Pe{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:pv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new j("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new j("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new j("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new oi(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new j(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Dd.className="InputLayer";re(Dd);function g5(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new j("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Dd({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dce(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return ae(e,t.dtype)}catch{throw new j(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class oa{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof oa)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=dce(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new j(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof oi){if(this.id2Value[e.id]==null)throw new j(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new j(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof oi){if(this.id2Value[e.id]==null)throw new j(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new j(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Ce(this.id2Mask)}}const s1=new r5,r1=new r5;function fce(t){s1!=null&&s1.setMaxEntries(t),r1!=null&&r1.setMaxEntries(t)}function If(t,e,n,s){const r=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let h=s1.get(u),d;if(h==null){const p=pce(o,e);h=p.sorted,d=p.recipientCounts,s1.put(u,h),r1.put(u,d)}d={},r||Object.assign(d,r1.get(u));const f=new oa(e);for(let p=0;p<h.length;++p){const g=h[p],m=g.sourceLayer;if(m instanceof Dd)continue;const x=[],y=[],b=[];let w=!1;for(const I of g.inputs){const _=f.getValue(I),D=f.getMask(I);x.push(_),y.push(D),D!=null&&(w=!0),r||(d[I.name]--,d[I.name]===0&&!e.hasKey(I)&&a.indexOf(I.name)===-1&&!_.isDisposed&&I.sourceLayer.stateful!==!0&&b.push(_))}w&&(n=n||{},n.mask=y[0]);const v=Ze(m.apply(x,n));let S=null;m.supportsMasking&&(S=m.computeMask(x,y));const T=gce(g),k=Array.isArray(T)?T:[T];for(let I=0;I<k.length;++I){f.hasKey(k[I])||f.add(k[I],v[I],Array.isArray(S)?S[0]:S);const _=a.indexOf(k[I].name);_!==-1&&(l[_]=v[I])}r||Ce(b)}return f.disposeMasks(),i?l:l[0]}function pce(t,e){N(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=xO(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:o,recipientMap:a}=xO(i,e);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:mce(s)}}function mce(t){const e={};for(const n in t)e[n]=t[n].size;return e}function xO(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function gce(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xce=K();xce.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,fce);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function I_(t,e){return q(()=>Sn(fe(W(t,t),e,!0)))}class Yg extends Kc{getConfig(){return{}}}class N_ extends Yg{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return q(()=>{const n=I_(e,this.axis),s=bs(n,0,this.maxValue);return W(e,ge(s,se(cn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}N_.className="MaxNorm";re(N_);class __ extends Yg{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return q(()=>ge(e,se(cn(),I_(e,this.axis))))}getConfig(){return{axis:this.axis}}}__.className="UnitNorm";re(__);class $_ extends Yg{apply(e){return hi(e)}}$_.className="NonNeg";re($_);class E_ extends Yg{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return q(()=>{const n=I_(e,this.axis),s=se(W(this.rate,bs(n,this.minValue,this.maxValue)),W(1-this.rate,n));return W(e,ge(s,se(cn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}E_.className="MinMaxNorm";re(E_);const yO={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function un(t){return m_(t)}function bO(t,e={}){return Gg(t,er.getMap().classNameMap,e,"constraint")}function hn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in yO?yO[t]:t,config:{}};return bO(n)}else return t instanceof Yg?t:bO(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yce(t){return new N_(t)}function bce(t){return new __(t)}function wce(){return new $_}function vce(t){return new E_(t)}const Sce=Object.freeze(Object.defineProperty({__proto__:null,maxNorm:yce,minMaxNorm:vce,nonNeg:wce,unitNorm:bce},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kce(){return new y_}function Cce(){return new gv}function Tce(t){return new b_(t)}function Ice(t){return new w_(t)}function Nce(t){return new v_(t)}function _ce(t){return new S_(t)}function $ce(t){return new k_(t)}function Ece(t){return new vs(t)}function Dce(t){return new xv(t)}function Ace(t){return new yv(t)}function Rce(t){return new bv(t)}function Oce(t){return new wv(t)}function Pce(t){return new vv(t)}function Fce(t){return new Sv(t)}function Mce(t){return new C_(t)}const Lce=Object.freeze(Object.defineProperty({__proto__:null,constant:Tce,glorotNormal:Ace,glorotUniform:Dce,heNormal:Rce,heUniform:Oce,identity:$ce,leCunNormal:Pce,leCunUniform:Fce,ones:Cce,orthogonal:Mce,randomNormal:Nce,randomUniform:Ice,truncatedNormal:_ce,varianceScaling:Ece,zeros:kce},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Xo(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const i=t[r];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)t[n[i]]=r[i][0];Ce(s)}}function x5(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var wO;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(wO||(wO={}));const zce=125;class fh{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class y5{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class Bce extends fh{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=q(()=>se(this.totals[r],W(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:q(()=>{const r=W(ge(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),ln(n[s])}))}}class b5 extends fh{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class w5 extends fh{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||KN,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=zce),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Hy(this.yieldEvery)&&(this.maybeWait=Mle(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await Xo(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await Xo(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await Xo(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await Xo(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await Xo(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Hy(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Xo(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Xo(e),await this.trainEnd(e))}}function v5(t,e){return t==null&&(t={}),t instanceof fh?[t]:Array.isArray(t)&&t[0]instanceof fh?t:Ze(t).map(s=>new w5(s,e))}class Xs{constructor(){}static registerCallbackConstructor(e,n){N(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Xs.checkForDuplicate(n),Xs.constructors[e]==null&&(Xs.constructors[e]=[]),Xs.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Xs.constructors)Xs.constructors[+n].forEach(r=>{if(r===e)throw new j("Duplicate callback constructor.")})}static clear(){Xs.constructors={}}static createCallbacks(e){const n=[];for(const s in Xs.constructors){const r=+s;e>=r&&n.push(...Xs.constructors[r])}return n.map(s=>new s)}}Xs.constructors={};function S5(t,e,n,s,r,i,o,a,l){const c=new b5,u=[new Bce,...Xs.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const h=new y5(u);return h.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ei(t,e={},n=!1){return Gg(t,er.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function i1(t,e){return q(()=>{t.dtype!=="float32"&&(t=ae(t,"float32"));const n=fe(Kg(t),e,!0),s=jc(n.shape,cn()),r=Sn(Vi(n,s));return ge(t,r)})}function Yc(t,e){return q(()=>It(Kg(de(e,t)),-1))}function Cv(t,e){return q(()=>It(Xt(de(e,t)),-1))}function Ad(t,e){return q(()=>{const n=de(t,e),s=bs(Xt(t),cn(),Number.MAX_VALUE),r=Xt(ge(n,s));return W(100,It(r,-1))})}function Vce(t,e){return q(()=>{const n=bs(e,cn(),Number.MAX_VALUE),s=Ws(se(1,n)),r=bs(t,cn(),Number.MAX_VALUE),i=Ws(se(1,r));return It(Kg(de(s,i)),-1)})}function Wce(t,e){return q(()=>{const n=Vi(0,de(1,W(t,e)));return It(Kg(n),-1)})}function Uce(t,e){return q(()=>{const n=Vi(0,de(1,W(t,e)));return It(n,-1)})}function jce(t,e){return q(()=>{const n=fe(W(t,e),-1),s=lr(W(de(1,t),e),-1);return Vi(0,se(1,de(s,n)))})}function Hce(t,e){return q(()=>{const n=Math.log(2),s=de(e,t),r=de(se(s,Hc(W(-2,s))),n);return It(r,-1)})}function qp(t,e,n=!1){return q(()=>{if(n)e=Bg(e);else{const s=fe(e,e.shape.length-1,!0);e=ge(e,s)}return e=bs(e,cn(),1-cn()),ct(fe(W(ae(t,"float32"),Ws(e)),e.shape.length-1))})}function o1(t,e,n=!1){return q(()=>{const s=ae(Nd(Xle(t)),"int32");e=bs(e,cn(),1-cn());const r=e.shape,i=U(lh(s,r[r.length-1]),r);return qp(i,e,n)})}function Gce(t,e){if(!Fe(t.shape,e.shape))throw new j(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return q(()=>{const n=hi(e),s=ct(Xt(e));return se(de(n,W(e,t)),Dg(ws(s)))})}function Tv(t,e){return q(()=>{let n;return n=bs(e,cn(),1-cn()),n=Ws(ge(n,de(1,n))),It(Gce(t,n),-1)})}function qce(t,e){return q(()=>{const n=bs(t,cn(),1),s=bs(e,cn(),1);return fe(W(t,Ws(ge(n,s))),-1)})}function Kce(t,e){return q(()=>{const n=Ws(se(cn(),e));return It(de(e,W(t,n)),-1)})}function D_(t,e){return q(()=>{const n=i1(t,-1),s=i1(e,-1),r=W(n,s);return ct(fe(r,-1))})}const a1={meanSquaredError:Yc,meanAbsoluteError:Cv,meanAbsolutePercentageError:Ad,meanSquaredLogarithmicError:Vce,squaredHinge:Wce,hinge:Uce,categoricalHinge:jce,logcosh:Hce,categoricalCrossentropy:qp,sparseCategoricalCrossentropy:o1,binaryCrossentropy:Tv,kullbackLeiblerDivergence:qce,poisson:Kce,cosineProximity:D_};function U2(t){if(typeof t=="string"){if(t in a1)return a1[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new j(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function A_(t,e){return q(()=>{const n=W(.5,Us(e)),s=Ai(cs(e,n),t.dtype);return It(Vs(t,s),-1)})}function R_(t,e){return q(()=>Ai(Vs(mc(t,-1),mc(e,-1)),"float32"))}function k5(t,e){return q(()=>ae(fe(Pr(Vs(t,1),Vs(e,1))),"float32"))}function Xce(t,e){return q(()=>ae(fe(Pr(Vs(t,1),Vs(e,0))),"float32"))}function Yce(t,e){return q(()=>ae(fe(Pr(Vs(t,0),Vs(e,1))),"float32"))}function C5(t,e){return q(()=>{const n=k5(t,e),s=Yce(t,e),r=se(n,s);return ae(wn(cs(r,0),ge(n,r),0),"float32")})}function Qce(t,e){return q(()=>{const n=k5(t,e),s=Xce(t,e),r=se(n,s);return ae(wn(cs(r,0),ge(n,r),0),"float32")})}function T5(t,e){return Tv(t,e)}function I5(t,e){return t.rank===e.rank&&(t=il(t,[t.rank-1])),e=mc(e,-1),e.dtype!==t.dtype&&(e=ae(e,t.dtype)),ae(Vs(t,e),"float32")}function Zce(t,e){return q(()=>{const n=t.sub(e).square().sum(),s=t.sub(t.mean()).square().sum();return be(1).sub(n.div(s))})}const Jce=Yc,eue=Yc,tue=Cv,nue=Cv,sue=Ad,rue=Ad,O_=qp,iue=D_,N5=o1,l1={binaryAccuracy:A_,categoricalAccuracy:R_,precision:C5,categoricalCrossentropy:O_,sparseCategoricalCrossentropy:N5,mse:Jce,MSE:eue,mae:tue,MAE:nue,mape:sue,MAPE:rue,cosine:iue};function oue(t){if(typeof t=="string"&&t in l1)return l1[t];if(typeof t!="string"&&t!=null)return t;throw new j(`Unknown metric ${t}`)}function W0(t){if(bi(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(a1))if(a1[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(l1))if(l1[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aue(t){const e={Adagrad:()=>Cl.adagrad(.01),Adadelta:()=>Cl.adadelta(1,.95,cn()),Adam:()=>Cl.adam(.001,.9,.999,cn()),Adamax:()=>Cl.adamax(.002,.9,.999,cn(),0),RMSProp:()=>Cl.rmsprop(.001,.9,0,cn()),SGD:()=>Cl.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new j(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vO=1*1024*1024;function SO(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Qk(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>vO&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${vO}.`)}}function Qk(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!Qk(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!Qk(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lue(t,e,n,s=console.log){const r=uue(t),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}s("_".repeat(e)),c1(i,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?hue(a[u],n,s):due(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=cue(t),c=n1(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function cue(t){let e;return t.collectedTrainableWeights!=null?e=n1(t.collectedTrainableWeights):e=n1(t.trainableWeights),e}function uue(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function c1(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function hue(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,r,s,t.countParams().toString()];c1(a,e,n)}function due(t,e,n,s){let r,i;try{i=t.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const h of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(h)===-1))for(let d=0;d<h.inboundLayers.length;++d){const f=h.inboundLayers[d].name,p=h.nodeIndices[d],g=h.tensorIndices[d];o.push(`${f}[${p}][${g}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,t.countParams().toString(),c];c1(u,e,s);for(let h=1;h<o.length;++h)c1(["","","","",o[h]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _5(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Kp(t,e){if(t===null)return null;if(typeof t=="string")return El(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];_5(e,r,i)?n.push(i):n.push(Kp(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=El(s);n[i]=Kp(r,i)}}return n}}function Zk(t,e){if(t==null)return null;if(typeof t=="string")return Yi(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];_5(e,r,i)?n.push(i):n.push(Zk(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],i=Yi(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=Zk(r,s)}return n}}/** @license See the LICENSE file. */const Iv="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fue=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Wr extends Pe{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=pv(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Ca(this.inputs).length!==this.inputs.length)throw new j(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);Ca(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const b=y.sourceLayer,w=y.nodeIndex,v=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(v)}for(const y of this.inputs){const b=y.sourceLayer,w=y.nodeIndex,v=y.tensorIndex;bi(w===0,"input layer has >1 nodes"),bi(v===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(v)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const b=this.inputLayers[y];if(!(b instanceof Dd))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},s={},r={},i={},o={},a=[],l=(y,b,w,v,S,T)=>{(v==null||S==null||T==null)&&(v=y.sourceLayer,S=y.nodeIndex,T=y.tensorIndex);const k=v.inboundNodes[S];if(w.indexOf(k)!==-1)throw new Dr(`The tensor ${y.name} at layer "${v.name}" is part of a cycle.`);if(b.indexOf(k)!==-1)return;this.containerNodes.add(Wr.nodeKey(v,S)),v.id in o||(o[v.id]=Object.keys(o).length),w.indexOf(k)===-1&&w.push(k);const I=k.inboundLayers.length;for(let _=0;_<I;_++){const D=k.inputTensors[_],A=k.inboundLayers[_],L=k.nodeIndices[_],B=k.tensorIndices[_];l(D,b,w,A,L,B)}for(b.push(k);w.indexOf(k)>=0;)w.splice(w.indexOf(k),1);a.push(k)},c=[],u=[];for(const y of this.outputs)l(y,c,u);const h=a.slice().reverse();for(const y of h){s[y.id]=y,y.id in n||(n[y.id]=0);let b=n[y.id];const w=r[y.outboundLayer.id]==null?0:r[y.outboundLayer.id];b=Math.max(b,w),r[y.outboundLayer.id]=b,i[y.outboundLayer.id]=y.outboundLayer,n[y.id]=b;for(let v=0;v<y.inboundLayers.length;v++){const S=y.inboundLayers[v],T=y.nodeIndices[v],k=S.inboundNodes[T],I=n[k.id]==null?0:n[k.id];n[k.id]=Math.max(b+1,I),s[k.id]=k}}const d={};for(const y in n){const b=n[y];b in d||(d[b]=[]),d[b].push(s[y])}const f={};for(const y in r){const b=r[y];b in f||(f[b]=[]),f[b].push(i[y])}let p=Object.keys(f).map(y=>parseInt(y,10)).sort(z0);this.layers=[];for(const y of p){const b=f[y];b.sort((w,v)=>{const S=o[w.id],T=o[v.id];return S<T?-1:S>T?1:0});for(const w of b)w instanceof Wr&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=f,p=Object.keys(d).map(y=>parseInt(y,10)).sort(z0);const g=this.inputs.slice(),m=[];for(const y of p)for(const b of d[y]){const w=b.outboundLayer;if(w!=null){for(const v of b.inputTensors)if(g.indexOf(v)===-1)throw new Dr(`Graph disconnected: cannot obtain value for tensor ${v} at layer "${w.name}". The following previous layers were accessed without issue: ${m}`);for(const v of b.outputTensors)g.push(v);m.push(w.name)}}this.nodesByDepth=d;const x=this.layers.map(y=>y.name);for(const y of x){const b=x.filter(w=>w===y).length;if(b!==1)throw new Dr(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new j("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const i=fue(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new j(`Duplicate weight name: ${u}`);s[u]=c,r++}const o=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],e[a]]);else if(n)throw new j(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new j(`${a.length} of ${r} weights are not set: ${a}`)}T_(o)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${Iv}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=Zk(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return q(()=>{e=Ze(e);const s=new oa;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return If(this.outputs,s,n)})}computeMask(e,n){return q(()=>{e=Ze(e);let s;return n==null?s=vc(null,e.length):s=Ze(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=t1(e);if(n.length!==this.inputLayers.length)throw new j(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(z0);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(u.id)!==-1)continue;const h=[];for(let g=0;g<c.inboundLayers.length;g++){const m=c.inboundLayers[g],x=c.nodeIndices[g],y=c.tensorIndices[g],b=`${m.name}_${x}_${y}`,w=s[b];h.push(w)}const d=u.computeOutputShape(ds(h)),f=t1(d),p=u.inboundNodes.indexOf(c);for(let g=0;g<f.length;g++){const m=`${u.name}_${p}_${g}`;s[m]=f[g]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],h=`${l.name}_${c}_${u}`;o.push(h)}for(let a=0;a<o.length;a++){const l=o[a];bi(l in s),i.push(s[l])}return ds(i)}runInternalGraph(e,n){n==null&&(n=vc(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],h=n[l];s[c.id]=[u,h]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(z0);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const h=u.outboundLayer,d=u.inputTensors,f=u.outputTensors,p=new Array;for(const g of d)g.id in s&&p.push(s[g.id]);if(p.length===d.length){let g={},m,x,y,b;if(u.callArgs!=null&&(g=u.callArgs),p.length===1){const[w,v]=p[0];g.mask==null&&(g.mask=v),y=Ze(h.call(w,g)),b=Ze(h.computeMask(w,v)),m=[w],x=[v]}else m=p.map(w=>w[0]),x=p.map(w=>w[1]),g.mask==null&&(g.mask=x),y=Ze(h.call(m,g)),b=Ze(h.computeMask(m,x));if(h.activityRegularizer)throw new Ee("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<f.length;++w){const v=f[w],S=y[w],T=b[w];s[v.id]=[S,T]}}}}const i=[],o=[],a=[];for(const l of this.outputs){bi(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Wr?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=Wr.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new j("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new j(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new j(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return q(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Wr.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let h=0;h<o.inboundNodes.length;h++){const d=o.inboundNodes[h],f=Wr.nodeKey(o,h);let p={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const g=[];for(let m=0;m<d.inboundLayers.length;m++){const x=d.inboundLayers[m],y=d.nodeIndices[m],b=d.tensorIndices[m],w=Wr.nodeKey(x,y);let v=n[w];v==null&&(v=0),g.push([x.name,v,b,p])}c.push(g)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Wr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.inputLayersTensorIndices[o];r.push([a.name,u,h])}e.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Wr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.outputLayersTensorIndices[o];i.push([a.name,u,h])}return e.outputLayers=i,e}static fromConfig(e,n,s={},r=!1){const i={},o={};function a(m,x){m.name in o?o[m.name].push(x):o[m.name]=[x]}function l(m,x){const y=[];let b;for(const w of x){const v=w[0],S=w[1],T=w[2];if(b=w[3]==null?{}:w[3],!(v in i)){a(m,x);return}const k=i[v];if(k.inboundNodes.length<=S){a(m,x);return}const I=k.inboundNodes[S];y.push(I.outputTensors[T])}y.length>0&&m.apply(ds(y),b)}function c(m){const x=m.name,y=ei(m,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(r),i[x]=y,m.inboundNodes.forEach(w=>{if(!(w instanceof Array))throw new j(`Corrupted configuration, expected array for nodeData: ${w}`);a(y,w)})}const u=n.name,h=n.layers;for(const m of h)c(m);for(;!Fle(o);)for(const m of h){const x=i[m.name];if(x.name in o){const y=o[x.name];delete o[x.name];for(const b of y)l(x,b)}}const d=[],f=[],p=n.inputLayers;for(const m of p){const x=m[0],y=m[1],b=m[2];bi(x in i);const v=i[x].inboundNodes[y].outputTensors;d.push(v[b])}const g=n.outputLayers;for(const m of g){const x=m[0],y=m[1],b=m[2];bi(x in i);const v=i[x].inboundNodes[y].outputTensors;f.push(v[b])}return new e({inputs:d,outputs:f,name:u})}get stateful(){if(this._stateful)throw new j("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){q(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pue(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(i=>{i in t?r.push(t[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function $5(t,e){return pue(t,e,"classWeight")}async function E5(t,e,n,s){if(n!=null){const r=q(()=>{if(t.shape.length===1)return Ei(t);if(t.shape.length===2){if(t.shape[1]>1)return mc(t,1);if(t.shape[1]===1)return U(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());Ce(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),xn(o,"float32")}else return null}function mue(t,e){return W(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const gue=32;function D5(t,e){let n,s;const r=e;n=r.xs,s=r.ys,N(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=kO("input",t.inputNames,n),o=kO("output",t.outputNames,s),a=i[0].shape[0];N(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),N(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)N(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)N(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function kO(t,e,n){if(n instanceof je)return[n];if(Array.isArray(n))return N(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new j(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function xue(t){if(t.length===3)throw new Ee("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function yue(t,e,n){const s=n.batchesPerEpoch!=null;if(N(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),N(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),N(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),N(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),N(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(CO(n.validationData))N(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const m=xue(n.validationData);i=m.xs,o=m.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(m=>"val_"+m)):c=l.slice();const u=v5(n.callbacks,n.yieldEvery),h=n.verbose==null?1:n.verbose,{callbackList:d,history:f}=S5(u,h,n.epochs,null,null,bue(e,n),null,r,c);d.setModel(t),t.history=f,await d.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;p<n.epochs;){const m={};await d.onEpochBegin(p);let x=0,y=0;for(s||(g=await e.iterator());!s||x<n.batchesPerEpoch;){const b=await g.next();if(s&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:w,ys:v}=D5(t,b.value),S={};S.batch=y,S.size=w[0].shape[0],await d.onBatchBegin(y,S);const T=[];if(n.classWeight!=null){const _=$5(n.classWeight,t.outputNames);for(let D=0;D<_.length;++D)T.push(await E5(v[D],null,_[D]))}const k=w.concat(v).concat(T),I=a(k);Ce(k);for(let _=0;_<l.length;++_){const D=l[_],A=I[_];S[D]=A,ln(A)}await d.onBatchEnd(y,S),x5(S),y++,x++}if(s?x>=n.batchesPerEpoch:b.done){if(r){let w;CO(n.validationData)?w=Ze(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):w=Ze(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?gue:n.validationBatchSize,verbose:0}));for(let v=0;v<t.metricsNames.length;++v)m[`val_${t.metricsNames[v]}`]=w[v]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(p,m),p++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function bue(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function CO(t){return typeof t.iterator=="function"}function wue(t){return typeof t.next=="function"}async function vue(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let i=[];if(n.verbose>0)throw new Ee("Verbose mode is not implemented yet.");N(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=wue(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=q(()=>{if(c.value){const{xs:u,ys:h}=D5(t,c.value),d=u.concat(h),f=q(()=>r(d));if(Ce(d),l===0)for(let g=0;g<f.length;++g)i.push(be(0));const p=d[0].shape[0];for(let g=0;g<f.length;++g){const m=f[g],x=i[g];i[g]=q(()=>se(i[g],W(p,m))),l>0&&Ce(x)}Ce(f),a+=p,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=ge(i[c],a),Ce(u)}return ds(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function j2(t){N(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function of(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>Yl(s,e,n-e)):Yl(t,e,n-e)}function Jk(t,e){return q(()=>t==null?null:Array.isArray(t)?t.map(n=>Jk(n,e)):d5(t,e.dtype==="int32"?e:ae(e,"int32")))}function H2(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function A5(t){const e=[];t instanceof je&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(qg(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Vr(t,e){if(t==null)return;const n=[];if(e instanceof je)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const i=e[r];n.push(i.id)}const s=[];if(t instanceof je)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const i=t[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sue(t){return t instanceof je}function eC(t){return Array.isArray(t)}function TO(t){return!Sue(t)&&!eC(t)}function IO(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(eC(t)&&t.length>0)o=!0;else if(TO(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new j(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(TO(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new j(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(eC(t)){if(t=t,t.length!==e.length)throw new j(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new j(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=A5(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new j(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new j(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function kue(t,e,n){const s=Ca(t.map(i=>i.shape[0]));s.sort();const r=Ca(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new j(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>1)throw new j(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!Fe(s,r))throw new j(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function Cue(t,e,n){const s=[Yc,Tv,qp];for(let r=0;r<t.length;++r){const i=t[r],o=e[r],a=n[r];if(o!=null){if(o===qp&&i.shape[i.shape.length-1]===1)throw new j(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const h=l[u],d=c[u];if(d!=null&&h!==d)throw new j(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function NO(t,e,n,s=!0,r=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new j(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new j(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new j(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new j(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function Tue(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const Iue="layers-model";class mo extends Wr{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new j("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");lue(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=aue(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Lo))throw new j("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new j(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(U2(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new j(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>U2(a))}else{const o=U2(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Xl("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=Tue(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};Xl("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let h,d,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const m=this.internalOutputShapes[o];m[m.length-1]===1||this.lossFunctions[o]===Tv?["accuracy","acc"].indexOf(p)!==-1?d=A_:["crossentropy","ce"].indexOf(p)!==-1&&(d=T5):this.lossFunctions[o]===o1?["accuracy","acc"].indexOf(p)!==-1?d=I5:["crossentropy","ce"].indexOf(p)!==-1&&(d=N5):["accuracy","acc"].indexOf(p)!==-1?d=R_:["crossentropy","ce"].indexOf(p)!==-1&&(d=O_);let x;["accuracy","acc"].indexOf(p)!==-1?x="acc":["crossentropy","ce"].indexOf(p)!==-1&&(x="ce"),f=d,h=u+x}else f=oue(p),h=u+W0(p);let g;Xl(h,()=>{g=f}),i(o,h,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;j2(r);const o=this.standardizeUserDataXY(e,n,!0,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return ds(c)}finally{Vr(o[0],e),Vr(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),vue(this,e,n)}checkNumSamples(e,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new j(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new j(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new j("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new oa;if(e instanceof je&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new j(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new j(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=If(i,o);return s?a:a[0]}retrieveSymbolicTensors(e){const n=vc(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(e[o])}),new j(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return q(()=>{const r=this.checkNumSamples(e);if(s)throw new Ee("Verbose predictLoop() is not implemented yet.");const i=H2(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)q(()=>{const c=i[a][0],u=i[a][1],h=of(e,c,u),d=[];if(Array.isArray(h))for(let p=0;p<h.length;++p)d.push({key:this.inputs[p],value:h[p]});else d.push({key:this.inputs[0],value:h});const f=new oa(d);return If(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return ds(o.map(a=>Vt(a,0)))})}predict(e,n={}){const s=A5(e);NO(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return j2(r),this.predictLoop(s,r)}finally{Vr(s,e)}}predictOnBatch(e){NO(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new Dr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===o1?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=IO(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=IO(n,this.feedOutputNames,i,!1,"target"),kue(e,n),Cue(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new j(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=$5(r,this.outputNames);c=[];for(let h=0;h<u.length;++h)c.push(await E5(l[h],null,u[h]))}return[a,l,c]}testLoop(e,n,s,r=0,i){return q(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new Ee("Verbose mode is not implemented yet.");if(i!=null)throw new Ee("steps mode in testLoop() is not implemented yet");{const l=H2(o,s),c=xn(ri(0,o));for(let u=0;u<l.length;++u){const h=l[u][0],d=l[u][1],f=Yl(c,h,d-h),p=Jk(n,f),g=e(p);if(u===0)for(let m=0;m<g.length;++m)a.push(be(0));for(let m=0;m<g.length;++m){const x=g[m];a[m]=se(a[m],W(d-h,x))}}for(let u=0;u<a.length;++u)a[u]=ge(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(hO(e,r)>1){const o=hO(e.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const h=[];for(let g=0;g<this.inputs.length;++g)h.push({key:this.inputs[g],value:s[g]});const d=new oa(h),f=If(this.outputs,d,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const m=this.lossFunctions[g];let x=m(r[g],f[g]);i[g]!=null&&(x=mue(x,i[g]));const y=It(x);n.push(y),g===0?p=x:p=se(p,x)}for(let g=0;g<this.metricsTensors.length;++g){let m;if(this.outputs.length>1&&g<this.outputs.length)m=n[g];else{const x=this.metricsTensors[g][0],y=this.metricsTensors[g][1];m=It(x(r[y],f[y]))}ln(m),o.push(m)}return p=It(p),this.calculateLosses().forEach(g=>{p=se(p,g)}),p},l=this.collectedTrainableWeights.map(h=>h.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>q(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new oa(o),l=If(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],h=It(u(i[c],l[c]));c===0?s=h:s=se(s,h),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],h=this.metricsTensors[c][1],d=It(u(i[h],l[h]));n.push(d)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,o,a,l,c,u,h,d;try{const f=s.batchSize==null?32:s.batchSize;j2(f);const g=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,f);r=g[0],i=g[1],d=g[2];let m=!1,x;if(s.validationData!=null&&s.validationData.length>0){if(m=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Ee("validationData including sample weights is not supported yet."):new j(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const _=await this.standardizeUserData(l,c,null,null,!0,f);u=_[0],h=_[1],x=u.concat(h)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){m=!0;const I=Math.floor(r[0].shape[0]*(1-s.validationSplit)),_=r[0].shape[0];u=of(r,I,_),o=r,r=of(r,0,I),h=of(i,I,_),a=i,i=of(i,0,I),x=u.concat(h)}else s.validationSteps!=null&&(m=!0);const y=r.concat(i).concat(d);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),w=this.getDedupedMetricsNames();let v,S;m?(this.makeTestFunction(),v=this.testFunction,S=w.slice().concat(w.map(I=>"val_"+I))):(v=null,x=[],S=w.slice());const T=v5(s.callbacks,s.yieldEvery);return await this.fitLoop(b,y,w,f,s.epochs,s.verbose,T,v,x,s.shuffle,S,s.initialEpoch,null,null)}finally{this.isTraining=!1,Vr(r,e),Vr(i,n),Vr(o,e),Vr(a,n),Vr(u,l),Vr(h,c),d!=null&&Ce(d)}}async fitLoop(e,n,s,r,i,o,a,l,c,u,h,d,f,p){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),d==null&&(d=0);let g=!1;if(l!=null&&c!=null&&(g=!0),p!=null&&(g=!0,f==null))throw new j("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(n,r,f,"steps_per_epoch");let x;m!=null&&(x=ri(0,m)),o==null&&(o=1);const{callbackList:y,history:b}=S5(a,o,i,d,m,f,r,g,h);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let w=d;w<i;++w){await y.onEpochBegin(w);const v={};if(f!=null)throw new Ee("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Ee("batch shuffling is not implemneted yet");u&&oI(x);const S=xn(x),T=H2(m,r);for(let k=0;k<T.length;++k){const I={};if(await y.onBatchBegin(k,I),q(()=>{const _=T[k][0],D=T[k][1],A=Yl(S,_,D-_);I.batch=k,I.size=D-_;const L=Jk(n,A),B=e(L);for(let F=0;F<s.length;++F){const R=s[F],O=B[F];I[R]=O,ln(O)}if(k===T.length-1&&g){const F=this.testLoop(l,c,r);for(let R=0;R<s.length;++R){const O=s[R],E=F[R];ln(E),v["val_"+O]=E}}}),await y.onBatchEnd(k,I),x5(I),this.stopTraining_)break}S.dispose()}if(await y.onEpochEnd(w,v),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return yue(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return Ce(a),Vr(s[0],e),Vr(s[1],n),ds(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Ok().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Ok().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Yi(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Yi(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=Yi(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Yi(W0(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Yi(W0(e)));{const e={};for(const n in this.metrics)e[n]=Yi(W0(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Kp(e.optimizer_config),s=ei(n);let r;if(typeof e.loss=="string")r=El(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>El(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=El(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>El(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=El(e.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=Yz(e);if(c.length===0)throw new j(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new j(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new j("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await Pk(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:Iue,generatedBy:`TensorFlow.js tfjs-layers v${Iv}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:h}=await Pk(await this.optimizer.getWeights(),c);s.specs.push(...h),s.data=Kz([s.data,u])}return this.userDefinedMetadata!=null&&(SO(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){SO(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}mo.className="Model";re(mo);class R5 extends mo{}R5.className="Functional";re(R5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Nue(t,e){"modelTopology"in t||(t={modelTopology:t}),t=t;let n=t.modelTopology;n.model_config!=null&&(n=n.model_config);const s=Kp(n),r=ei(s,e);if(t.weightsManifest!=null){const i=await dV(t.weightsManifest,t.pathPrefix,r.weights.map(a=>a.originalName)),o={};for(const a of r.weights)o[a.originalName]=i[a.originalName];r.loadWeights(o),Ce(i)}return r}async function _ue(t,e){if(e==null&&(e={}),typeof t=="string"){const n=Qz(t,e);if(n.length===0)n.push(mV(t,e));else if(n.length>1)throw new j(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return $ue(t,void 0,e)}async function $ue(t,e,n){if(n==null&&(n={}),t.load==null)throw new j("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await t.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const i=n.strict==null?!0:n.strict,o=s.weightData!=null&&s.weightSpecs!=null&&i,a=ei(Kp(r),e,o),l=s.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),s.userDefinedMetadata!=null&&a.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new j("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:u}=Eue(s.weightData,s.weightSpecs);a.loadWeights(c,i),a.optimizer!=null&&u.length>0&&await a.optimizer.setWeights(u),Ce(c),Ce(u.map(h=>h.tensor))}return a}function Eue(t,e){const n=bI(t,e),s={},r=[];return e.forEach(i=>{i.group==="optimizer"?r.push({name:i.name,tensor:n[i.name]}):s[i.name]=n[i.name]}),{modelWeights:s,optimizerWeights:r}}class Sc extends mo{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:pv("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new j(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Sc||e instanceof mo;let s;if(n){if(s=e,s.outputs.length!==1)throw new j("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new j("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new j("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=g5({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new j(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new j("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=m5(this.outputs[0])}this.inboundNodes=[],new kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:vc(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ge(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new mo({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Dr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Dr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Dr("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Dr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new j("Legacy serialization format not supported yet.");i=n}else N(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof Sc))throw new Ee(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=ei(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new j("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new j("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Sc.className="Sequential";re(Sc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Due(t){return new mo(t)}function Aue(t){return new Sc(t)}function O5(t){return g5(t)}function Rue(t,e){Xs.registerCallbackConstructor(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let jn=class extends Kc{getConfig(){return{}}};class P5 extends jn{apply(e,n=1){return Qle(e,n)}}P5.className="elu";re(P5);class F5 extends jn{apply(e){return Uw(e)}}F5.className="selu";re(F5);class M5 extends jn{apply(e){return hi(e)}}M5.className="relu";re(M5);class L5 extends jn{apply(e){return q(()=>La(6,hi(e)))}}L5.className="relu6";re(L5);class z5 extends jn{apply(e){return e}}z5.className="linear";re(z5);class B5 extends jn{apply(e){return Jr(e)}}B5.className="sigmoid";re(B5);class V5 extends jn{apply(e){return Jle(e)}}V5.className="hardSigmoid";re(V5);class W5 extends jn{apply(e){return Hc(e)}}W5.className="softplus";re(W5);class U5 extends jn{apply(e){return Zle(e)}}U5.className="softsign";re(U5);class j5 extends jn{apply(e){return Ma(e)}}j5.className="tanh";re(j5);let P_=class extends jn{apply(e,n=-1){return Bg(e,n)}};P_.className="softmax";re(P_);class H5 extends jn{apply(e,n=-1){return Fw(e,n)}}H5.className="logSoftmax";re(H5);class G5 extends jn{apply(e){return q(()=>q(()=>{const n=Math.sqrt(2),s=W(.5,se(1,Rw(ge(e,n))));return W(e,s)}))}}G5.className="gelu";re(G5);class q5 extends jn{apply(e){return q(()=>W(.5,W(e,se(1,Ma(W(Sn(ge(2,Math.PI)),se(e,W(.044715,Mi(e,3)))))))))}}q5.className="gelu_new";re(q5);class K5 extends jn{apply(e){return q(()=>W(e,Ma(Hc(e))))}}K5.className="mish";re(K5);class X5 extends jn{apply(e,n=1){return q(()=>W(Jr(W(e,n)),e))}}X5.className="swish";re(X5);function Ba(t){return t.getClassName()}function G2(t,e={}){return Gg(t,er.getMap().classNameMap,e,"activation")}function Va(t){if(t==null){const e={};return e.className="linear",e.config={},G2(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},G2(e)}else return t instanceof jn?t:G2(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function F_(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class Y5 extends Kc{}class Qg extends Y5{constructor(e){super(),F_(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return q(()=>{let n=Qt([1]);return this.hasL1&&(n=se(n,fe(W(this.l1,Xt(e))))),this.hasL2&&(n=se(n,fe(W(this.l2,Kg(e))))),U(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}Qg.className="L1L2";re(Qg);function Oue(t){return F_(t),new Qg({l1:t!=null?t.l1:null,l2:0})}function Pue(t){return F_(t),new Qg({l2:t!=null?t.l2:null,l1:0})}const _O={l1l2:"L1L2"};function at(t){return m_(t)}function $O(t,e={}){return Gg(t,er.getMap().classNameMap,e,"regularizer")}function St(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in _O?_O[t]:t,config:{}};return $O(n)}else return t instanceof Y5?t:$O(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class M_ extends Pe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=ke(e);let s=hi(e);return this.maxValue!=null&&(s=bs(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}M_.className="ReLU";re(M_);class L_ extends Pe{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=ke(e);return Eg(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}L_.className="LeakyReLU";re(L_);class z_ extends Pe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=wt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=St(e.alphaRegularizer),this.alphaConstraint=hn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new j(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ge(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Zt({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=ke(e),Mg(e,this.alpha.read())}getConfig(){const e={alphaInitializer:_t(this.alphaInitializer),alphaRegularizer:at(this.alphaRegularizer),alphaConstraint:un(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}z_.className="PReLU";re(z_);let B_=class extends Pe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ee(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=ke(e);return Td(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};B_.className="ELU";re(B_);class V_ extends Pe{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=ke(e);return W(s,ae(cs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}V_.className="ThresholdedReLU";re(V_);class W_ extends Pe{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new P_().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return q(()=>{let s=ke(e);const r=n.mask;if(r!=null){const i=W(de(ps(s.shape),ae(r,s.dtype)),be(-1e9));s=se(s,i)}return this.axis instanceof Array?this.axis.length>1?ws(de(s,Ag(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}W_.className="Softmax";re(W_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wu(t,e,n){if(typeof t=="number")return vc(t,e);if(t.length!==e)throw new j(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!qle(r))throw new j(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function ti(t,e,n,s,r=1){if(t==null)return t;const i=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+s-1)/s)}function wi(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+za([n-e,0]);else if(s==="same")t=t*e;else throw new j(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function U_(t,e){return q(()=>(Gt(e),e==="channelsFirst"?Me(t,[0,2,3,1]):t))}function Q5(t,e){return q(()=>(Gt(e),e==="channelsFirst"?Me(t,[0,2,3,4,1]):t))}function Fue(t,e,n,s=1,r="valid",i,o=1){return q(()=>{if(i==null&&(i=ii()),Gt(i),t.shape.length!==3)throw new j(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new j(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new j(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=Me(t,[0,2,1])),r==="causal")throw new Ee("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=$w(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=di(a,n)),a})}function EO(t,e,n,s=[1,1],r="valid",i,o,a=null){return q(()=>{if(i==null&&(i=ii()),Gt(i),t.rank!==3&&t.rank!==4)throw new j(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new j(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=U_(t,i);if(r==="causal")throw new Ee("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=ZB({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=Me(l,[0,3,1,2])),l})}function Mue(t,e,n,s=[1,1,1],r="valid",i,o){return q(()=>{if(i==null&&(i=ii()),Gt(i),t.rank!==4&&t.rank!==5)throw new j(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new j(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=Q5(t,i);if(r==="causal")throw new Ee("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=jI(a,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=di(a,n)),i==="channelsFirst"&&(a=Me(a,[0,4,1,2,3])),a})}class Nv extends Pe{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Nv.verifyArgs(n),this.rank=e,yn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ee(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Wu(n.kernelSize,e,"kernelSize"),this.strides=Wu(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,mr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Gt(this.dataFormat),this.activation=Va(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=wt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=hn(n.biasConstraint),this.biasRegularizer=St(n.biasRegularizer),this.activityRegularizer=St(n.activityRegularizer),this.dilationRate=Wu(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new j(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new j(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new j(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(bi("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!g_(e.kernelSize,"number",1,3))throw new j(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ba(this.activation),useBias:this.useBias,biasInitializer:_t(this.biasInitializer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),biasConstraint:un(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Rd extends Nv{constructor(e,n){super(e,n),this.kernel=null,Rd.verifyArgs(n),this.filters=n.filters,yn(this.filters,"filters"),this.kernelInitializer=wt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=hn(n.kernelConstraint),this.kernelRegularizer=St(n.kernelRegularizer)}build(e){e=Ge(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return q(()=>{e=ke(e);let s;const r=this.bias==null?null:this.bias.read(),i=o5(this.activation.getClassName());if(i!=null&&this.rank===2)s=EO(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=Fue(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=EO(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Mue(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ee("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Ge(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const o=ti(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:_t(this.kernelInitializer),kernelRegularizer:at(this.kernelRegularizer),kernelConstraint:un(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new j(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Od extends Rd{constructor(e){super(2,e),Od.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!g_(e.kernelSize,"number",1,2))throw new j(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Od.className="Conv2D";re(Od);class Pd extends Rd{constructor(e){super(3,e),Pd.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new j(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Pd.className="Conv3D";re(Pd);class j_ extends Od{constructor(e){if(super(e),this.inputSpec=[new Zt({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new j(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ge(e),e.length!==4)throw new j("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Zt({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return q(()=>{let s=ke(e);if(s.shape.length!==4)throw new j(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],h=this.kernelSize[1],d=this.strides[0],f=this.strides[1],p=wi(l,d,u,this.padding),g=wi(c,f,h,this.padding),m=[i,p,g,this.filters];this.dataFormat!=="channelsLast"&&(s=Me(s,[0,2,3,1]));let x=Ew(s,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=Me(x,[0,3,1,2])),this.bias!=null&&(x=di(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=Ge(e);const n=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=wi(n[r],l,o,this.padding),n[i]=wi(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}j_.className="Conv2DTranspose";re(j_);class H_ extends Pd{constructor(e){if(super(e),this.inputSpec=[new Zt({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new j(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ge(e),e.length!==5)throw new j("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Zt({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return q(()=>{let s=ke(e);if(s.shape.length!==5)throw new j(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],h=r[a],d=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],m=this.strides[1],x=this.strides[2],y=wi(c,g,d,this.padding),b=wi(u,m,f,this.padding),w=wi(h,x,p,this.padding),v=[i,y,b,w,this.filters];this.dataFormat!=="channelsLast"&&(s=Me(s,[0,2,3,4,1]));let S=HI(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=Me(S,[0,4,1,2,3])),this.bias!==null&&(S=di(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=Ge(e);const n=e.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],h=this.strides[1],d=this.strides[2];return n[s]=this.filters,n[r]=wi(n[r],u,a,this.padding),n[i]=wi(n[i],h,l,this.padding),n[o]=wi(n[o],d,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}H_.className="Conv3DTranspose";re(H_);class Z5 extends Rd{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new j("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new j("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new j(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=wt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=St(n.depthwiseRegularizer),this.depthwiseConstraint=hn(n.depthwiseConstraint),this.pointwiseInitializer=wt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=St(n.pointwiseRegularizer),this.pointwiseConstraint=hn(n.pointwiseConstraint)}build(e){if(e=Ge(e),e.length<this.rank+2)throw new j(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new j(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Zt({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return q(()=>{e=ke(e);let s;if(this.rank===1)throw new Ee("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Me(e,[0,2,3,1])),s=jw(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=di(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Me(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=_t(this.depthwiseInitializer),e.pointwiseInitializer=_t(this.pointwiseInitializer),e.depthwiseRegularizer=at(this.depthwiseRegularizer),e.pointwiseRegularizer=at(this.pointwiseRegularizer),e.depthwiseConstraint=un(this.depthwiseConstraint),e.pointwiseConstraint=un(this.pointwiseConstraint),e}}Z5.className="SeparableConv";class G_ extends Z5{constructor(e){super(2,e)}}G_.className="SeparableConv2D";re(G_);class Zg extends Rd{constructor(e){super(1,e),Zg.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!g_(e.kernelSize,"number",1,1))throw new j(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Zg.className="Conv1D";re(Zg);class q_ extends Pe{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return q(()=>{if(e=ke(e),this.dataFormat==="channelsLast"){const s=V0(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return V0(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=V0(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return V0(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}q_.className="Cropping2D";re(q_);class K_ extends Pe{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Gt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,jle(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return q(()=>{let s=ke(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Me(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?Er.resizeNearestNeighbor(s,[i,o]):Er.resizeBilinear(s,[i,o]);return Me(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?Er.resizeNearestNeighbor(s,[i,o]):Er.resizeBilinear(s,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}K_.className="UpSampling2D";re(K_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lue(t,e,n=[1,1],s="valid",r,i){return q(()=>{r==null&&(r=ii()),Gt(r);let o=U_(t,r);if(t.rank!==4)throw new j(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new j(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=Cd(o,e,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=Me(o,[0,3,1,2])),o})}class X_ extends Nv{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=wt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=hn(e.depthwiseConstraint),this.depthwiseRegularizer=St(e.depthwiseRegularizer)}build(e){if(e=Ge(e),e.length<4)throw new j(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new j(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return q(()=>{e=ke(e);let s=Lue(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=di(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Ge(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=ti(n,this.kernelSize[0],this.padding,this.strides[0]),o=ti(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=_t(this.depthwiseInitializer),e.depthwiseRegularizer=at(this.depthwiseRegularizer),e.depthwiseConstraint=un(this.depthwiseRegularizer),e}}X_.className="DepthwiseConv2D";re(X_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function J5(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new j("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function eW(t,e,n,s=!1,r,i,o=!1,a=!1){return q(()=>{const l=e.shape.length;if(l<3)throw new j(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(ri(2,l));e=Me(e,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=ae(ae(r,"bool"),"float32"),r.rank===l-1&&(r=$n(r,-1)),r=Me(r,c)),s&&(e=hr(e,0),r!=null&&(r=hr(r,0)));const u=[];let h,d=n;const f=e.shape[0],p=dr(e);let g;r!=null&&(g=dr(r));for(let x=0;x<f;++x){const y=p[x],b=q(()=>t(y,d));if(r==null)h=b[0],d=b[1];else{const w=q(()=>{const v=g[x],S=de(Us(v),v),T=se(W(b[0],v),W(d[0],S)),k=d.map((I,_)=>se(W(b[1][_],v),W(I,S)));return{output:T,newStates:k}});h=w.output,d=w.newStates}a&&u.push(h)}let m;return a&&(m=is(u,1)),[h,m,d]})}class fi extends Pe{constructor(e){super(e);let n;if(e.cell==null)throw new j("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new Ev({cells:e.cell}):n=e.cell,n.stateSize==null)throw new j("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Zt({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ri(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Xk(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[r].concat(i)}else return r}computeMask(e,n){return q(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ee("Constants support is not implemented in RNN yet.");Xk(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Zt({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Fe(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new j(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new Zt({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){q(()=>{if(!this.stateful)throw new yi("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new j("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Qt([s,r])):this.states_=[Qt([s,this.cell.stateSize])];else if(e==null)Ce(this.states_),this.keptStates!=null&&(Ce(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Qt([s,r])):this.states_[0]=Qt([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new j(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Ce(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!Fe(i.shape,a))throw new j(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>ln(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=J5(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new Zt({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof oi){const c=[e].concat(o),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return q(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;e=ke(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new j(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=eW((p,g)=>{const m=this.cell.call([p].concat(g),a);return[m[0],m.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],h=c[1],d=c[2];this.stateful&&this.resetStates(d,r);const f=this.returnSequences?h:u;return this.returnState?[f].concat(d):f})}getInitialState(e){return q(()=>{let n=Qt(e.shape);return n=fe(n,[1,2]),n=qg(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?qk(n,[1,s]):n):this.cell.stateSize>1?[qk(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===fi.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,i=ei(r,s);return new e(Object.assign(n,{cell:i}))}}fi.className="RNN";re(fi);class Jg extends Pe{}class _v extends Jg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,yn(this.units,"units"),this.activation=Va(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=wt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=wt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=wt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=St(e.kernelRegularizer),this.recurrentRegularizer=St(e.recurrentRegularizer),this.biasRegularizer=St(e.biasRegularizer),this.kernelConstraint=hn(e.kernelConstraint),this.recurrentConstraint=hn(e.recurrentConstraint),this.biasConstraint=hn(e.biasConstraint),this.dropout=dh([1,za([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=dh([1,za([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ge(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return q(()=>{if(e=e,e.length!==2)throw new j(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Wa({ones:()=>Us(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Wa({ones:()=>Us(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=Ri(W(e,o),this.kernel.read()):i=Ri(e,this.kernel.read()),this.bias!=null&&(i=di(i,this.bias.read())),a!=null&&(s=W(s,a));let l=se(i,Ri(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Ba(this.activation),useBias:this.useBias,kernelInitializer:_t(this.kernelInitializer),recurrentInitializer:_t(this.recurrentInitializer),biasInitializer:_t(this.biasInitializer),kernelRegularizer:at(this.kernelRegularizer),recurrentRegularizer:at(this.recurrentRegularizer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),kernelConstraint:un(this.kernelConstraint),recurrentConstraint:un(this.recurrentConstraint),biasConstraint:un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}_v.className="SimpleRNNCell";re(_v);class Y_ extends fi{constructor(e){e.cell=new _v(e),super(e)}call(e,n){return q(()=>{this.cell.dropoutMask!=null&&(Ce(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ce(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return new e(n)}}Y_.className="SimpleRNN";re(Y_);class $v extends Jg{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new j("GRUCell does not support reset_after parameter set to true.");this.units=e.units,yn(this.units,"units"),this.activation=Va(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Va(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=wt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=wt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=wt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=St(e.kernelRegularizer),this.recurrentRegularizer=St(e.recurrentRegularizer),this.biasRegularizer=St(e.biasRegularizer),this.kernelConstraint=hn(e.kernelConstraint),this.recurrentConstraint=hn(e.recurrentConstraint),this.biasConstraint=hn(e.biasConstraint),this.dropout=dh([1,za([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=dh([1,za([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ge(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return q(()=>{if(e=e,e.length!==2)throw new j(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Wa({ones:()=>Us(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Wa({ones:()=>Us(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=W(e,i[0]));let u=Ri(e,this.kernel.read());this.useBias&&(u=di(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=W(r,o[0]));const h=this.recurrentKernel.read(),[d,f]=gs(h,[2*this.units,this.units],h.rank-1),p=Ri(r,d),[g,m,x]=gs(u,3,u.rank-1),[y,b]=gs(p,2,p.rank-1);a=this.recurrentActivation.apply(se(g,y)),l=this.recurrentActivation.apply(se(m,b));const w=Ri(W(l,r),f);c=this.activation.apply(se(x,w));const v=se(W(a,r),W(se(1,ct(a)),c));return[v,v]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Ba(this.activation),recurrentActivation:Ba(this.recurrentActivation),useBias:this.useBias,kernelInitializer:_t(this.kernelInitializer),recurrentInitializer:_t(this.recurrentInitializer),biasInitializer:_t(this.biasInitializer),kernelRegularizer:at(this.kernelRegularizer),recurrentRegularizer:at(this.recurrentRegularizer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),kernelConstraint:un(this.kernelConstraint),recurrentConstraint:un(this.recurrentConstraint),biasConstraint:un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}$v.className="GRUCell";re($v);class Q_ extends fi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new $v(e),super(e)}call(e,n){return q(()=>{this.cell.dropoutMask!=null&&(Ce(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ce(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}Q_.className="GRU";re(Q_);class e0 extends Jg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,yn(this.units,"units"),this.activation=Va(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Va(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=wt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=wt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=wt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=St(e.kernelRegularizer),this.recurrentRegularizer=St(e.recurrentRegularizer),this.biasRegularizer=St(e.biasRegularizer),this.kernelConstraint=hn(e.kernelConstraint),this.recurrentConstraint=hn(e.recurrentConstraint),this.biasConstraint=hn(e.biasConstraint),this.dropout=dh([1,za([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=dh([1,za([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ge(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends Mr{apply(l,c){const u=i.apply([o]),h=new gv().apply([o]),d=i.apply([o*2]);return fO(fO(u,h),d)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return q(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new j(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Wa({ones:()=>Us(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Wa({ones:()=>Us(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,h;0<this.dropout&&this.dropout<1&&(e=W(e,o[0]));let d=Ri(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=W(r,a[0])),d=se(d,Ri(r,this.recurrentKernel.read())),this.useBias&&(d=di(d,this.bias.read()));const[f,p,g,m]=gs(d,4,d.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=se(W(c,i),W(l,this.activation.apply(g))),h=this.recurrentActivation.apply(m);const x=W(h,this.activation.apply(u));return[x,x,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Ba(this.activation),recurrentActivation:Ba(this.recurrentActivation),useBias:this.useBias,kernelInitializer:_t(this.kernelInitializer),recurrentInitializer:_t(this.recurrentInitializer),biasInitializer:_t(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:at(this.kernelRegularizer),recurrentRegularizer:at(this.recurrentRegularizer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),kernelConstraint:un(this.kernelConstraint),recurrentConstraint:un(this.recurrentConstraint),biasConstraint:un(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}e0.className="LSTMCell";re(e0);class Z_ extends fi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new e0(e),super(e)}call(e,n){return q(()=>{this.cell.dropoutMask!=null&&(Ce(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ce(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}Z_.className="LSTM";re(Z_);class Ev extends Jg{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return q(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){Xk(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{Xl(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const i of n.cells)r.push(ei(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return Yk(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}T_(n)}}Ev.className="StackedRNNCells";re(Ev);function Wa(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):f5(e(),n),a=()=>Xg(o,e,s);return!r||r<=1?ln(a().clone()):Array(r).fill(void 0).map(a).map(c=>ln(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var zue=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class tW extends fi{constructor(e){if(e.unroll)throw new Ee("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ee("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Zt({ndim:5})]}call(e,n){return q(()=>{if(this.cell.dropoutMask!=null&&(Ce(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ce(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new j("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return q(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=Qt(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){q(()=>{if(!this.stateful)throw new yi("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new j("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Qt(i)):this.states_=[Qt(i)];else if(e==null)Ce(this.states_),this.keptStates!=null&&(Ce(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Qt(i)):this.states_[0]=Qt(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new j(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Ce(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!Fe(l.shape,c))throw new j(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>ln(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],h=ti(c,r[0],i,o[0],a[0]),d=ti(u,r[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[s,h,d]:[h,d,s]]}}tW.className="ConvRNN2D";class Dv extends e0{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,yn(this.filters,"filters"),this.kernelSize=Wu(s,2,"kernelSize"),this.kernelSize.forEach(l=>yn(l,"kernelSize")),this.strides=Wu(r||1,2,"strides"),this.strides.forEach(l=>yn(l,"strides")),this.padding=i||"valid",mr(this.padding),this.dataFormat=o||"channelsLast",Gt(this.dataFormat),this.dilationRate=Wu(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>yn(l,"dilationRate"))}build(e){var n;e=Ge(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new j(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends Mr{apply(d,f){const p=c.apply([u]),g=ps([u]),m=c.apply([u*2]);return x_([p,g,m])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return q(()=>{if(e.length!==3)throw new j(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Wa({ones:()=>Us(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(G,Y,Z)=>!Y||!Y[Z]?G:W(Y[Z],G);let u=c(r,l,0),h=c(r,l,1),d=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Wa({ones:()=>Us(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=c(i,p,0),m=c(i,p,1),x=c(i,p,2),y=c(i,p,3);const b=3,[w,v,S,T]=gs(this.kernel.read(),a,b),[k,I,_,D]=this.useBias?gs(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,w,k,this.padding),h=this.inputConv(h,v,I,this.padding),d=this.inputConv(d,S,_,this.padding),f=this.inputConv(f,T,D,this.padding);const[A,L,B,F]=gs(this.recurrentKernel.read(),a,b);g=this.recurrentConv(g,A),m=this.recurrentConv(m,L),x=this.recurrentConv(x,B),y=this.recurrentConv(y,F);const R=this.recurrentActivation.apply(se(u,g)),O=this.recurrentActivation.apply(se(h,m)),E=se(W(O,o),W(R,this.activation.apply(se(d,x)))),V=W(this.recurrentActivation.apply(se(f,y)),this.activation.apply(E));return[V,V,E]})}getConfig(){const e=super.getConfig(),n=zue(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const i=No(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?di(i,s,this.dataFormat):i}recurrentConv(e,n){return No(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}Dv.className="ConvLSTM2DCell";re(Dv);class J_ extends tW{constructor(e){const n=new Dv(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}J_.className="ConvLSTM2D";re(J_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Av extends Pe{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return q(()=>{this.invokeCallHook(e,n);const s=ke(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return Xg(()=>f5(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}Av.className="Dropout";re(Av);class e$ extends Av{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}e$.className="SpatialDropout1D";re(e$);class t$ extends Pe{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,yn(this.units,"units"),this.activation=Va(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=wt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=wt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=hn(e.kernelConstraint),this.biasConstraint=hn(e.biasConstraint),this.kernelRegularizer=St(e.kernelRegularizer),this.biasRegularizer=St(e.biasRegularizer),this.activityRegularizer=St(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ge(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ge(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return q(()=>{this.invokeCallHook(e,n);const s=ke(e),r=o5(this.activation.getClassName());let i;return r!=null?i=Ri(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=Ri(s,this.kernel.read()),this.bias!=null&&(i=di(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:Ba(this.activation),useBias:this.useBias,kernelInitializer:_t(this.kernelInitializer),biasInitializer:_t(this.biasInitializer),kernelRegularizer:at(this.kernelRegularizer),biasRegularizer:at(this.biasRegularizer),activityRegularizer:at(this.activityRegularizer),kernelConstraint:un(this.kernelConstraint),biasConstraint:un(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}t$.className="Dense";re(t$);class n$ extends Pe{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ge(e);for(const n of e.slice(1))if(n==null)throw new j(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Ta(e,1)]}call(e,n){return q(()=>{this.invokeCallHook(e,n);let s=ke(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=Me(s,r)}return Yle(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}n$.className="Flatten";re(n$);class s$ extends Pe{constructor(e){super(e),this.supportsMasking=!0,this.activation=Va(e.activation)}call(e,n){return q(()=>{this.invokeCallHook(e,n);const s=ke(e);return this.activation.apply(s)})}getConfig(){const e={activation:Ba(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}s$.className="Activation";re(s$);class r$ extends Pe{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return q(()=>(e=ke(e),Kle(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}r$.className="RepeatVector";re(r$);class i$ extends Pe{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new j("Can only specifiy one unknown dimension.");else i*=c}const a=Ta(e);if(o!==null){if(i===0||a%i!==0)throw new j(s);r[o]=a/i}else if(a!==i)throw new j(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return q(()=>{this.invokeCallHook(e,n);const s=ke(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return U(s,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}i$.className="Reshape";re(i$);class o$ extends Pe{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=ri(1,e.dims.length+1);if(!Fe(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Zt({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ge(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return Me(ke(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}o$.className="Permute";re(o$);class a$ extends Pe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=ke(e);return Up(yc(s,this.maskValue),-1)}call(e,n){return q(()=>{this.invokeCallHook(e,n);const s=ke(e),o=Up(yc(s,this.maskValue),-1,!0);return W(s,ae(o,s.dtype))})}}a$.className="Masking";re(a$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class l$ extends Pe{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ze(e.inputLength))}this.inputDim=e.inputDim,yn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,yn(this.outputDim,"outputDim"),this.embeddingsInitializer=wt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=St(e.embeddingsRegularizer),this.activityRegularizer=St(e.activityRegularizer),this.embeddingsConstraint=hn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return q(()=>this.maskZero?(e=ke(e),yc(e,Ve(e))):null)}computeOutputShape(e){if(e=Ge(e),this.inputLength==null)return[...e,this.outputDim];const n=Ze(this.inputLength);if(n.length!==e.length-1)throw new j(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=e[r+1];if(i!=null&&o!=null&&i!==o)throw new j(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return q(()=>{this.invokeCallHook(e,n);let s=ke(e);s.dtype!=="int32"&&(s=Ai(s,"int32"));const r=d5(this.embeddings.read(),U(s,[s.size]));return U(r,Ge(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:_t(this.embeddingsInitializer),embeddingsRegularizer:at(this.embeddingsRegularizer),activityRegularizer:at(this.activityRegularizer),embeddingsConstraint:un(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}l$.className="Embedding";re(l$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Qc extends Pe{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ee}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const i=e[e.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new j("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ge(e)]),e=e,e.length<2)throw new j(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=Ca(n),n.length>1)throw new j(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&Ca(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return q(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=za(r);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=qg(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,h=u[0],d=u.slice(1).concat([h]);let f=U(l,[h].concat(Ta(u.slice(1))));f=Me(f,[1,0]),f=U(f,d),s.push(f),i=!0}else if(c>1){const u=ri(1,c).concat([0]);s.push(Me(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],h=[u].concat(l.slice(0,l.length-1));o=U(Me(U(o,[-1,u]),[1,0]),h)}else if(a>1){const l=[a-1].concat(ri(0,a-1));o=Me(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Ca(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return q(()=>{if(n==null)return null;if(!Array.isArray(n))throw new j("`mask` should be an Array");if(!Array.isArray(e))throw new j("`inputs` should be an Array");if(n.length!==e.length)throw new j(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:$n(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Pr(s,n[r]);return s})}}class c$ extends Qc{constructor(e){super(e)}mergeFunction(e){return q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=se(n,e[s]);return n})}}c$.className="Add";re(c$);class u$ extends Qc{constructor(e){super(e)}mergeFunction(e){return q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=W(n,e[s]);return n})}}u$.className="Multiply";re(u$);class h$ extends Qc{constructor(e){super(e)}mergeFunction(e){return q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=se(n,e[s]);return W(1/e.length,n)})}}h$.className="Average";re(h$);class d$ extends Qc{constructor(e){super(e)}mergeFunction(e){return q(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Vi(n,e[s]);return n})}}d$.className="Maximum";re(d$);class f$ extends Qc{constructor(e){super(e)}mergeFunction(e){return q(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=La(n,e[s]);return n})}}f$.className="Minimum";re(f$);class p$ extends Qc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new j("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(Fe(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new j("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return q(()=>x_(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new j("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new j("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new j("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new j(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return q(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(ae(Us(e[o]),"bool")):n[o].rank<e[o].rank?r.push($n(n[o],-1)):r.push(n[o]);const i=Vt(r,this.axis);return _w(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}p$.className="Concatenate";re(p$);function af(t,e){for(;t<0;)t+=e;return t}function Bue(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ee("batchDot is not implemented for tensors of 4D or higher rank yet");if(N(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),N(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ee("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return q(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);e=U(e,e.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=U(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=fe(W(t,e),i[0]):a=fe(W(Me(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=Re(t,e,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=il(a,c)}return a.shape.length===1&&(a=$n(a,1)),a})}class m$ extends Qc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){N(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Ee("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new j(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new j(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>af(i,e[o].shape.length)):r=[af(this.axes,n.shape.length),af(this.axes,s.shape.length)],this.normalize&&(n=i1(n,r[0]),s=i1(s,r[1])),Bue(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[af(this.axes,e.length),af(this.axes,n.length)],s}computeOutputShape(e){N(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Ee("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}m$.className="Dot";re(m$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class g$ extends Pe{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return q(()=>{this.invokeCallHook(e,n);const s=ke(e);return Xg(()=>se(mv(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}g$.className="GaussianNoise";re(g$);class x$ extends Pe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return q(()=>{this.invokeCallHook(e,n);const s=ke(e);return this.rate>0&&this.rate<1?Xg(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return W(s,mv(s.shape,1,i))},()=>s,n.training||!1):s})}}x$.className="GaussianDropout";re(x$);class y$ extends Pe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||ke(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return q(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Xg(()=>{const i=ke(e),l=-1.6732632423543772*1.0507009873554805;let c=Po(rl(s),this.rate);c=Ai(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-u*l*this.rate,d=se(W(i,c),W(se(c,-1),l));return se(W(d,u),h)},()=>ke(e),n.training||!1)}return e})}}y$.className="AlphaDropout";re(y$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xp(t,e,n,s,r,i=.001){let o;if(t.rank===2)o=OI(t,e,n,s,r,i);else if(t.rank===3)o=PI(t,e,n,s,r,i);else if(t.rank===4)o=FI(t,e,n,s,r,i);else throw new Ee(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function Vue(t,e,n,s,r=.001){return q(()=>{const i=Pg(t,s),o=i.mean,a=i.variance;return[Xp(t,o,a,n,e,r),o,a]})}function Wue(t,e,n,s,r=.001){return q(()=>{const i=Pg(t,s),o=i.mean,a=i.variance,l=[];for(const p of ri(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=U(o,l),u=U(a,l),h=e==null?null:U(e,l),d=n==null?null:U(n,l);return[Xp(t,c,u,d,h,r),o,a]})}function Uue(t,e,n,s,r=.001){return Fe(s.slice().sort(),ri(0,t.rank-1))?Vue(t,e,n,s,r):Wue(t,e,n,s,r)}class b$ extends Pe{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=wt(e.betaInitializer||"zeros"),this.gammaInitializer=wt(e.gammaInitializer||"ones"),this.movingMeanInitializer=wt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=wt(e.movingVarianceInitializer||"ones"),this.betaConstraint=hn(e.betaConstraint),this.gammaConstraint=hn(e.gammaConstraint),this.betaRegularizer=St(e.betaRegularizer),this.gammaRegularizer=St(e.gammaRegularizer)}build(e){e=Ge(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new j(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Zt({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return q(()=>{const s=n.training==null?!1:n.training,r=ke(e),i=r.shape,o=i.length,a=ri(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=vc(1,o);c[l]=i[l];const u=a.slice();u.sort();const h=!Fe(u,ri(0,o).slice(0,o-1)),d=()=>{if(h){const y=U(this.movingMean.read(),c),b=U(this.movingVariance.read(),c),w=this.center?U(this.beta.read(),c):null,v=this.scale?U(this.gamma.read(),c):null;return Xp(r,y,b,w,v,this.epsilon)}else return Xp(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return d();const[f,p,g]=Uue(r,this.gamma.read(),this.beta.read(),a,this.epsilon),m=(y,b,w)=>{q(()=>{const v=1-w,S=y.read(),T=W(de(S,b),v);y.write(de(S,T))})};return(()=>{m(this.movingMean,p,this.momentum),m(this.movingVariance,g,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:_t(this.betaInitializer),gammaInitializer:_t(this.gammaInitializer),movingMeanInitializer:_t(this.movingMeanInitializer),movingVarianceInitializer:_t(this.movingVarianceInitializer),betaRegularizer:at(this.betaRegularizer),gammaRegularizer:at(this.gammaRegularizer),betaConstraint:un(this.betaConstraint),gammaConstraint:un(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}b$.className="BatchNormalization";re(b$);class w$ extends Pe{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=wt(e.betaInitializer||"zeros"),this.gammaInitializer=wt(e.gammaInitializer||"ones"),this.betaRegularizer=St(e.betaRegularizer),this.gammaRegularizer=St(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ge(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Ca(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=ke(e),r=s.shape,i=r.length;return q(()=>{let{mean:a,variance:l}=Pg(s,this.axis,!0);const c=vc(1,i);for(const g of this.axis)c[g]=r[g];const u=g=>g!=null&&g.shape.length!==i?U(g,c):g;let h=this.scale?u(this.gamma.read()):null,d=this.center?u(this.beta.read()):null;const f=[],p=[];for(let g=0;g<i;++g)this.axis.indexOf(g)!==-1?(f.push(r[g]),p.push(1)):(f.push(1),p.push(r[g]));return a=sr(a,f),l=sr(l,f),h!=null&&(h=sr(h,p)),d!=null&&(d=sr(d,p)),Xp(s,a,l,d,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:_t(this.betaInitializer),gammaInitializer:_t(this.gammaInitializer),betaRegularizer:at(this.betaRegularizer),gammaRegularizer:at(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}w$.className="LayerNormalization";re(w$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jue(t,e,n){return q(()=>{if(t.rank!==4)throw new j(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new j("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=ii()),n!=="channelsLast"&&n!=="channelsFirst")throw new j(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Fo(t,s)})}class v$ extends Pe{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?ii():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new j(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new j(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new j(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new Zt({ndim:4})]}computeOutputShape(e){e=Ge(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return q(()=>jue(ke(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}v$.className="ZeroPadding2D";re(v$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rv(t,e,n,s,r,i){return q(()=>{Gt(r),l5(i),mr(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=ii()),i==null&&(i="max"),t=U_(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=Og(t,e,n,a):o=Ig(t,e,n,a),r==="channelsFirst"&&(o=Me(o,[0,3,1,2])),o})}function nW(t,e,n,s,r,i){return q(()=>{Gt(r),l5(i),mr(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=ii()),i==null&&(i="max"),t=Q5(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=iN(t,e,n,a):o=RI(t,e,n,a),r==="channelsFirst"&&(o=Me(o,[0,4,1,2,3])),o})}class sW extends Pe{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new j(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(yn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new j(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);yn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,mr(this.padding),this.inputSpec=[new Zt({ndim:3})]}computeOutputShape(e){e=Ge(e);const n=ti(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return q(()=>{this.invokeCallHook(e,n),e=qg(ke(e),2);const s=this.poolingFunction(ke(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return il(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class S$ extends sW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Gt(i),mr(r),Rv(e,n,s,r,i,"max")}}S$.className="MaxPooling1D";re(S$);class k$ extends sW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Gt(i),mr(r),Rv(e,n,s,r,i,"avg")}}k$.className="AveragePooling1D";re(k$);class rW extends Pe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new j(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];yn(this.poolSize,"poolSize"),yn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Gt(this.dataFormat),mr(this.padding),this.inputSpec=[new Zt({ndim:4})]}computeOutputShape(e){e=Ge(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=ti(n,this.poolSize[0],this.padding,this.strides[0]),s=ti(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return q(()=>(this.invokeCallHook(e,n),this.poolingFunction(ke(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class C$ extends rW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Gt(i),mr(r),Rv(e,n,s,r,i,"max")}}C$.className="MaxPooling2D";re(C$);class T$ extends rW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Gt(i),mr(r),Rv(e,n,s,r,i,"avg")}}T$.className="AveragePooling2D";re(T$);class iW extends Pe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new j(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];yn(this.poolSize,"poolSize"),yn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Gt(this.dataFormat),mr(this.padding),this.inputSpec=[new Zt({ndim:5})]}computeOutputShape(e){e=Ge(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=ti(n,this.poolSize[0],this.padding,this.strides[0]),s=ti(s,this.poolSize[1],this.padding,this.strides[1]),r=ti(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return q(()=>(this.invokeCallHook(e,n),this.poolingFunction(ke(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class I$ extends iW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Gt(i),mr(r),nW(e,n,s,r,i,"max")}}I$.className="MaxPooling3D";re(I$);class N$ extends iW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Gt(i),mr(r),nW(e,n,s,r,i,"avg")}}N$.className="AveragePooling3D";re(N$);class oW extends Pe{constructor(e){super(e),this.inputSpec=[new Zt({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ee}}class _$ extends oW{constructor(e){super(e||{})}call(e,n){return q(()=>{const s=ke(e);return It(s,1)})}}_$.className="GlobalAveragePooling1D";re(_$);class $$ extends oW{constructor(e){super(e||{})}call(e,n){return q(()=>{const s=ke(e);return lr(s,1)})}}$$.className="GlobalMaxPooling1D";re($$);class aW extends Pe{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Gt(this.dataFormat),this.inputSpec=[new Zt({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ee}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class E$ extends aW{call(e,n){return q(()=>{const s=ke(e);return this.dataFormat==="channelsLast"?It(s,[1,2]):It(s,[2,3])})}}E$.className="GlobalAveragePooling2D";re(E$);class D$ extends aW{call(e,n){return q(()=>{const s=ke(e);return this.dataFormat==="channelsLast"?lr(s,[1,2]):lr(s,[2,3])})}}D$.className="GlobalMaxPooling2D";re(D$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lW extends Pe{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,i=ei(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class A$ extends lW{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ge(e),e.length<3)throw new j(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ge(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return q(()=>(e=ke(e),eW((o,a)=>[ke(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}A$.className="TimeDistributed";re(A$);function Hue(t){Xc(Ule,"BidirectionalMergeMode",t)}const Gue="concat";class R$ extends lW{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=ei(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=ei(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Gue:e.mergeMode,Hue(this.mergeMode),e.weights)throw new Ee("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):ds(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=J5(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new j("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(h=>new Zt({shape:h.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new Ee("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof oi;for(const c of o)if(c instanceof oi!==l)throw new j("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return q(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=hr(i,1));let a;return this.mergeMode==="concat"?a=x_([r,i]):this.mergeMode==="sum"?a=se(r,i):this.mergeMode==="ave"?a=W(.5,se(r,i)):this.mergeMode==="mul"?a=W(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Xl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Xl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=ei(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ee("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}R$.className="Bidirectional";re(R$);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class O$ extends Pe{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return q(()=>(e=ke(e),e.dtype!=="float32"&&(e=Ai(e,"float32")),se(W(e,this.scale),this.offset)))}}O$.className="Rescaling";re(O$);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:que,cropAndResize:Kue}=Er;class P$ extends Pe{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,i,o,a,l){return q(()=>{let c,u=!1;const h=n/o,d=s/a,f=(r+n)/o,p=(i+s)/a,g=[h,d,f,p],m=[];e.rank===3?(u=!0,c=is([e])):c=e;for(let v=0;v<c.shape[0];v++)m.push(g);const x=Bs(m,[m.length,4]),y=bc(0,m.length,1,"int32"),w=Kue(c,x,y,[r,i],"nearest");return Ai(u?ke(dr(w)):w,l)})}upsize(e,n,s,r){return q(()=>{const i=que(e,[n,s]);return Ai(i,r)})}call(e,n){return q(()=>{const s=ke(e),r=s.dtype,i=s.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ge(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}P$.className="CenterCrop";re(P$);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xue(t,e,n,s){let r=ke(t);if(r.dtype!=="int32"&&(r=Ai(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=$n(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=$n(r,-1)),r.rank>2)throw new j(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=Jy(a,s,n,o):l=Jy(a,[],n,o),e!=="tfIdf")return l;if(s)return W(l,s);throw new j("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class F$ extends Pe{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ge(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return q(()=>{e=ke(e),e.dtype!=="int32"&&(e=Ai(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new j(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=ke(n.countWeights)}const r=lr(e),i=oh(e),o=cs(this.numTokens,r).bufferSync().get(0),a=Po(i,0).bufferSync().get(0);if(!(o&&a))throw new j(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Xue(e,this.outputMode,this.numTokens,s)})}}F$.className="CategoryEncoding";re(F$);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Yue=["bilinear","nearest"],DO=new Set(Yue);class M$ extends Pe{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(DO.has(e.interpolation))this.interpolation=e.interpolation;else throw new j(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ge(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return q(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Er.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Er.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...DO]} are supported`)})}}M$.className="Resizing";re(M$);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cW{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}cW.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uW extends Pe{constructor(e){super(e),this.randomGenerator=new cW(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}uW.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Que=["bilinear","nearest"],AO=new Set(Que);class L$ extends uW{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new j(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new j(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new j(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(AO.has(s))this.interpolation=s;else throw new j(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ge(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return q(()=>{const s=ke(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=rl([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Er.resizeBilinear(e,o);case"nearest":return Er.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...AO]} are supported`)}})}}L$.className="RandomWidth";re(L$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zue(t){return new Dd(t)}function Jue(t){return new B_(t)}function ehe(t){return new M_(t)}function the(t){return new L_(t)}function nhe(t){return new z_(t)}function she(t){return new W_(t)}function rhe(t){return new V_(t)}function ihe(t){return new Zg(t)}function ohe(t){return new Od(t)}function ahe(t){return new j_(t)}function lhe(t){return new Pd(t)}function che(t){return new H_(t)}function uhe(t){return new G_(t)}function hhe(t){return new q_(t)}function dhe(t){return new K_(t)}function fhe(t){return new X_(t)}function phe(t){return new s$(t)}function mhe(t){return new t$(t)}function ghe(t){return new Av(t)}function xhe(t){return new e$(t)}function yhe(t){return new n$(t)}function bhe(t){return new r$(t)}function whe(t){return new i$(t)}function vhe(t){return new o$(t)}function She(t){return new l$(t)}function khe(t){return new c$(t)}function Che(t){return new h$(t)}function The(t){return new p$(t)}function Ihe(t){return new d$(t)}function Nhe(t){return new f$(t)}function _he(t){return new u$(t)}function $he(t){return new m$(t)}function Ehe(t){return new b$(t)}function Dhe(t){return new w$(t)}function Ahe(t){return new v$(t)}function z$(t){return new k$(t)}function Rhe(t){return z$(t)}function Ohe(t){return z$(t)}function B$(t){return new T$(t)}function Phe(t){return B$(t)}function Fhe(t){return B$(t)}function V$(t){return new N$(t)}function Mhe(t){return V$(t)}function Lhe(t){return V$(t)}function zhe(t){return new _$(t)}function Bhe(t){return new E$(t)}function hW(t){return new $$(t)}function dW(t){return new D$(t)}function fW(t){return new S$(t)}function pW(t){return new C$(t)}function Vhe(t){return new I$(t)}function Whe(t){return new Q_(t)}function Uhe(t){return new $v(t)}function jhe(t){return new Z_(t)}function Hhe(t){return new e0(t)}function Ghe(t){return new Y_(t)}function qhe(t){return new _v(t)}function Khe(t){return new J_(t)}function Xhe(t){return new Dv(t)}function Yhe(t){return new fi(t)}function Qhe(t){return new Ev(t)}function Zhe(t){return new R$(t)}function Jhe(t){return new A$(t)}const ede=hW,tde=dW,nde=fW,sde=pW;function rde(t){return new g$(t)}function ide(t){return new x$(t)}function ode(t){return new y$(t)}function ade(t){return new a$(t)}function lde(t){return new O$(t)}function cde(t){return new P$(t)}function ude(t){return new M$(t)}function hde(t){return new F$(t)}function dde(t){return new L$(t)}const fde=Object.freeze(Object.defineProperty({__proto__:null,Layer:Pe,RNN:fi,RNNCell:Jg,activation:phe,add:khe,alphaDropout:ode,average:Che,averagePooling1d:z$,averagePooling2d:B$,averagePooling3d:V$,avgPool1d:Rhe,avgPool2d:Phe,avgPool3d:Mhe,avgPooling1d:Ohe,avgPooling2d:Fhe,avgPooling3d:Lhe,batchNormalization:Ehe,bidirectional:Zhe,categoryEncoding:hde,centerCrop:cde,concatenate:The,conv1d:ihe,conv2d:ohe,conv2dTranspose:ahe,conv3d:lhe,conv3dTranspose:che,convLstm2d:Khe,convLstm2dCell:Xhe,cropping2D:hhe,dense:mhe,depthwiseConv2d:fhe,dot:$he,dropout:ghe,elu:Jue,embedding:She,flatten:yhe,gaussianDropout:ide,gaussianNoise:rde,globalAveragePooling1d:zhe,globalAveragePooling2d:Bhe,globalMaxPool1d:ede,globalMaxPool2d:tde,globalMaxPooling1d:hW,globalMaxPooling2d:dW,gru:Whe,gruCell:Uhe,input:O5,inputLayer:Zue,layerNormalization:Dhe,leakyReLU:the,lstm:jhe,lstmCell:Hhe,masking:ade,maxPool1d:nde,maxPool2d:sde,maxPooling1d:fW,maxPooling2d:pW,maxPooling3d:Vhe,maximum:Ihe,minimum:Nhe,multiply:_he,permute:vhe,prelu:nhe,randomWidth:dde,reLU:ehe,repeatVector:bhe,rescaling:lde,reshape:whe,resizing:ude,rnn:Yhe,separableConv2d:uhe,simpleRNN:Ghe,simpleRNNCell:qhe,softmax:she,spatialDropout1d:xhe,stackedRNNCells:Qhe,thresholdedReLU:rhe,timeDistributed:Jhe,upSampling2d:dhe,zeroPadding2d:Ahe},Symbol.toStringTag,{value:"Module"}));function pde(t,e){return A_(t,e)}function mde(t,e){return T5(t,e)}function gde(t,e){return I5(t,e)}function xde(t,e){return R_(t,e)}function yde(t,e){return O_(t,e)}function bde(t,e){return C5(t,e)}function wde(t,e){return Qce(t,e)}function vde(t,e){return D_(t,e)}function Sde(t,e){return Cv(t,e)}function kde(t,e){return Ad(t,e)}function Cde(t,e){return Ad(t,e)}function Tde(t,e){return Ad(t,e)}function Ide(t,e){return Yc(t,e)}function Nde(t,e){return Yc(t,e)}function _de(t,e){return Yc(t,e)}function $de(t,e){return Zce(t,e)}const Ede=Object.freeze(Object.defineProperty({__proto__:null,MAPE:Cde,MSE:Nde,binaryAccuracy:pde,binaryCrossentropy:mde,categoricalAccuracy:xde,categoricalCrossentropy:yde,cosineProximity:vde,mape:Tde,meanAbsoluteError:Sde,meanAbsolutePercentageError:kde,meanSquaredError:Ide,mse:_de,precision:bde,r2Score:$de,recall:wde,sparseCategoricalAccuracy:gde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Dde=Object.freeze(Object.defineProperty({__proto__:null,modelFromJSON:Nue},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ade(t){return new Qg(t)}function Rde(t){return Oue(t)}function Ode(t){return Pue(t)}const Pde=Object.freeze(Object.defineProperty({__proto__:null,l1:Rde,l1l2:Ade,l2:Ode},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mW extends fh{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof mo))throw new Error("model must be a LayersModel, not some other Container");this.model=e}}function U0(t,e){return t<e}function RO(t,e){return t>e}class gW extends mW{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new Ee("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=U0:this.mode==="max"?this.monitorFunc=RO:this.monitor.indexOf("acc")!==-1?this.monitorFunc=RO:this.monitorFunc=U0,this.monitorFunc===U0&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===U0?1/0:-1/0}async onEpochEnd(e,n){await Xo(n);const s=this.getMonitorValue(n);s!=null&&(this.monitorFunc(s-this.minDelta,this.best)?(this.best=s,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});const n=e[this.monitor];return n==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),n}}function Fde(t){return new gW(t)}const Mde={earlyStopping:Fde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lde=K();Lde.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var _s;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(_s||(_s={}));var OO;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(OO||(OO={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W$={};function zde(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};W$[t]=n}function xW(t){return W$[t]}function Bde(t){delete W$[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C(t,e,n,s,r){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd,c=a<0?e.inputNames.length+a:a;if(i.type==="tensor")return En(e.inputNames[c],n,s,r);if(i.type==="tensors"){const d=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((p,g)=>{var m;return((m=d[g])===null||m===void 0?void 0:m.op)!=="NoOp"}).map(p=>En(p,n,s,r))}const u=En(e.inputNames[c],n,s,r),h=u.dataSync();return i.type==="number"?h[0]:ar(u.shape,h)}const o=e.attrParams[t];return o&&o.value}function En(t,e,n,s){const[r,i]=Es(t,n);if(s!=null){const a=s.getHashTableHandleByName(r);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!e[u1(r,a)]);return o!==void 0?e[u1(r,o)][i]:void 0}function PO(t,e,n){return e[u1(t,n.currentContextId)]}function Qi(t,e){const[n,s,r]=Es(t,e);return[u1(n,e&&e.currentContextId),s,r]}function u1(t,e){return e?`${t}-${e}`:t}function Es(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const i=e.parseNodeNameCache.get(t);if(i!=null)return i}const s=t.split(":");let r;if(s.length===1)r=[t,0,void 0];else{const i=s[0],o=s.length===3?s[1]:void 0,a=Number(s[s.length-1]);r=[i,a,o]}return n&&e.parseNodeNameCache.set(t,r),r}function Ax(t,e,n){let s=C("pad",t,e,n);if(s==="explicit"){s=C("explicitPaddings",t,e,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)r[i][0]=s[i*2],r[i][1]=s[i*2+1];return r}return s}function Zi(t){return t.kept?t:Ei(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vde=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Wde=Object.freeze(Object.defineProperty({__proto__:null,json:Vde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],jde=Object.freeze(Object.defineProperty({__proto__:null,json:Ude},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hde=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Gde=Object.freeze(Object.defineProperty({__proto__:null,json:Hde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qde=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Kde=Object.freeze(Object.defineProperty({__proto__:null,json:qde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xde=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Yde=Object.freeze(Object.defineProperty({__proto__:null,json:Xde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qde=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Zde=Object.freeze(Object.defineProperty({__proto__:null,json:Qde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jde=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],efe=Object.freeze(Object.defineProperty({__proto__:null,json:Jde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tfe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],nfe=Object.freeze(Object.defineProperty({__proto__:null,json:tfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],rfe=Object.freeze(Object.defineProperty({__proto__:null,json:sfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ife=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],ofe=Object.freeze(Object.defineProperty({__proto__:null,json:ife},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const afe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],lfe=Object.freeze(Object.defineProperty({__proto__:null,json:afe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cfe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],ufe=Object.freeze(Object.defineProperty({__proto__:null,json:cfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hfe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],dfe=Object.freeze(Object.defineProperty({__proto__:null,json:hfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],pfe=Object.freeze(Object.defineProperty({__proto__:null,json:ffe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],gfe=Object.freeze(Object.defineProperty({__proto__:null,json:mfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xfe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],yfe=Object.freeze(Object.defineProperty({__proto__:null,json:xfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bfe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],wfe=Object.freeze(Object.defineProperty({__proto__:null,json:bfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vfe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Sfe=Object.freeze(Object.defineProperty({__proto__:null,json:vfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kfe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Cfe=Object.freeze(Object.defineProperty({__proto__:null,json:kfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FO{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[Wde,jde,Gde,Kde,Yde,Zde,efe,nfe,rfe,ofe,lfe,ufe,dfe,pfe,gfe,yfe,wfe,Sfe,Cfe],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,n={}){const s=e.node,r=[],i=[],o=[],a=s.reduce((g,m)=>(g[m.name]=this.mapNode(m),m.op.startsWith("Placeholder")?r.push(g[m.name]):m.op==="Const"?i.push(g[m.name]):(m.input==null||m.input.length===0)&&o.push(g[m.name]),g),{});let l=[];const c=[];let u={},h={};n!=null&&(u=this.mapSignatureEntries(n.inputs),h=this.mapSignatureEntries(n.outputs));const d=Object.keys(a);d.forEach(g=>{const m=a[g];m.inputNames.forEach((x,y)=>{const[b,,w]=Qi(x),v=a[b];if(v.outputs!=null){const S=v.outputs.indexOf(w);if(S!==-1){const T=`${b}:${S}`;m.inputNames[y]=T}}m.inputs.push(v),v.children.push(m)})}),Object.keys(h).length===0?d.forEach(g=>{const m=a[g];m.children.length===0&&c.push(m)}):Object.keys(h).forEach(g=>{const[m]=Qi(g),x=a[m];x!=null&&(x.signatureKey=h[g],c.push(x))}),Object.keys(u).length>0?Object.keys(u).forEach(g=>{const[m]=Qi(g),x=a[m];x&&(x.signatureKey=u[g],l.push(x))}):l=r;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((g,m)=>(g[m.signature.name]=this.mapFunction(m),g),{}));const p={nodes:a,inputs:l,outputs:c,weights:i,placeholders:r,signature:n,functions:f};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=xW(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,i)=>(r[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,i)=>{const o=i.type;let a;switch(i.type){case"string":a=tC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=tC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=lC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=lC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=sC(e.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=sC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=aC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=aC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=nC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=nC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=uC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=uC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=oC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=oC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=cC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=cC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=rC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=rC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=iC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=iC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=MO(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=MO(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return r[i.name]={value:a,type:o},r},{})),s}mapFunction(e){const n=e.nodeDef,s=[],r=[];let i={};n!=null&&(i=n.reduce((h,d)=>(h[d.name]=this.mapNode(d),d.op==="Const"&&r.push(h[d.name]),h),{}));const o=[],a=[];e.signature.inputArg.forEach(h=>{const[d]=Qi(h.name),f={name:d,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:U$(h.type),type:"dtype"}},children:[]};f.signatureKey=h.name,o.push(f),i[d]=f}),Object.keys(i).forEach(h=>{const d=i[h];d.inputNames.forEach((f,p)=>{const[g,,m]=Qi(f),x=i[g];if(x.outputs!=null){const y=x.outputs.indexOf(m);if(y!==-1){const b=`${g}:${y}`;d.inputNames[p]=b}}d.inputs.push(x),x.children.push(d)})});const c=e.ret;e.signature.outputArg.forEach(h=>{const[d,f]=Qi(c[h.name]),p=i[d];p!=null&&(p.defaultOutput=f,a.push(p))});const u=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:a,weights:r,placeholders:s,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function Tfe(t){const e=K().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function yW(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):Tfe(t);return e?n:n.toLowerCase()}function tC(t,e,n,s=!1){const r=t[e];return r!=null?yW(r.s,s):n}function nC(t,e,n){const s=t[e];return s?s.b:n}function sC(t,e,n){const s=t[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function U$(t){switch(typeof t=="string"&&(t=_s[t]),t){case _s.DT_FLOAT:case _s.DT_HALF:return"float32";case _s.DT_INT32:case _s.DT_INT64:case _s.DT_INT8:case _s.DT_UINT8:return"int32";case _s.DT_BOOL:return"bool";case _s.DT_DOUBLE:return"float32";case _s.DT_STRING:return"string";case _s.DT_COMPLEX64:case _s.DT_COMPLEX128:return"complex64";default:return null}}function MO(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function rC(t,e,n){const s=t[e];return s&&s.type?U$(s.type):n}function iC(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(r=>U$(r)):n}function bW(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function oC(t,e,n){const s=t[e];return s&&s.shape?bW(s.shape):n}function aC(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function lC(t,e,n,s=!1){const r=t[e];return r&&r.list&&r.list.s?r.list.s.map(i=>yW(i,s)):n}function cC(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>bW(r)):n}function uC(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ife{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,i)=>(r[i]=this.getAttr(i),r),{}))}getInput(e){return En(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return En(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return sC(this.node.rawAttrs,e,n);if(s.s!=null)return tC(this.node.rawAttrs,e,n);if(s.b!=null)return nC(this.node.rawAttrs,e,n);if(s.shape!=null)return oC(this.node.rawAttrs,e,n);if(s.type!=null)return rC(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return aC(this.node.rawAttrs,e,n);if(s.list.s!=null)return lC(this.node.rawAttrs,e,n);if(s.list.shape!=null)return cC(this.node.rawAttrs,e,n);if(s.list.b!=null)return uC(this.node.rawAttrs,e,n);if(s.list.type!=null)return iC(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ln=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:gI,abs:Xt,acos:CI,acosh:TI,add:se,addN:iB,all:_w,any:Up,argMax:mc,argMin:II,asin:NI,asinh:_I,atan:$I,atan2:EI,atanh:DI,avgPool:Ig,avgPool3d:RI,basicLSTMCell:oB,batchNorm:kd,batchNorm2d:OI,batchNorm3d:PI,batchNorm4d:FI,batchToSpaceND:Ng,bincount:MI,bitwiseAnd:aB,booleanMaskAsync:GB,broadcastArgs:lB,broadcastTo:Kl,buffer:De,cast:ae,ceil:LI,clipByValue:bs,clone:Ei,complex:Io,concat:Vt,concat1d:zI,concat2d:BI,concat3d:VI,concat4d:WI,conv1d:$w,conv2d:No,conv2dTranspose:Ew,conv3d:jI,conv3dTranspose:HI,cos:_g,cosh:Dw,cosineWindow:ev,cumprod:Gp,cumsum:Aw,denseBincount:Jy,depthToSpace:GI,depthwiseConv2d:Cd,diag:uB,dilation2d:qI,div:ge,divNoNan:KI,dot:XI,dropout:$N,einsum:$l,elu:Td,enclosingPowerOfTwo:EN,ensureShape:hB,equal:Vs,erf:Rw,euclideanNorm:QI,exp:ws,expandDims:$n,expm1:ZI,eye:Ow,fft:Vg,fill:jc,floor:Nd,floorDiv:Nw,fused:tV,gather:_d,gatherND:YB,greater:cs,greaterEqual:Po,ifft:hh,imag:$g,image:Er,inTopKAsync:QB,irfft:Kw,isFinite:JI,isInf:eN,isNaN:tN,leakyRelu:Eg,less:ah,lessEqual:sl,linalg:RN,linspace:pB,localResponseNormalization:nN,log:Ws,log1p:Dg,logSigmoid:sN,logSoftmax:Fw,logSumExp:Ag,logicalAnd:Pr,logicalNot:Rg,logicalOr:Mw,logicalXor:rN,losses:lV,lowerBound:gB,matMul:Re,max:lr,maxPool:Og,maxPool3d:iN,maxPoolWithArgmax:xB,maximum:Vi,mean:It,meshgrid:yB,min:oh,minimum:La,mirrorPad:oN,mod:aN,moments:Pg,movingAverage:qB,mul:W,multiRNNCell:bB,multinomial:wB,neg:ct,norm:Id,notEqual:yc,oneHot:lh,ones:ps,onesLike:Us,op:M,outerProduct:vB,pad:Fo,pad1d:SB,pad2d:kB,pad3d:CB,pad4d:TB,pool:lN,pow:Mi,prelu:Mg,print:kI,prod:cN,raggedGather:IB,raggedRange:NB,raggedTensorToTensor:_B,rand:$B,randomGamma:RB,randomNormal:zw,randomStandardNormal:OB,randomUniform:rl,randomUniformInt:PB,range:bc,real:ch,reciprocal:bN,relu:hi,relu6:Bw,reshape:U,reverse:hr,reverse1d:FB,reverse2d:MB,reverse3d:LB,reverse4d:zB,rfft:Wg,round:Vw,rsqrt:Ww,scalar:be,scatterND:KB,searchSorted:Lw,selu:Uw,separableConv2d:jw,setdiff1dAsync:BB,sigmoid:Jr,sign:wN,signal:aV,sin:Hw,sinh:Gw,slice:Be,slice1d:Lg,slice2d:qw,slice3d:zg,slice4d:uh,softmax:Bg,softplus:Hc,spaceToBatchND:Fg,sparse:cV,sparseToDense:XB,spectral:oV,split:gs,sqrt:Sn,square:rt,squaredDifference:Xw,squeeze:il,stack:is,step:qc,stridedSlice:vN,string:uV,sub:de,sum:fe,tan:SN,tanh:Ma,tensor:Bs,tensor1d:xn,tensor2d:ka,tensor3d:kN,tensor4d:VB,tensor5d:WB,tensor6d:UB,tensorScatterUpdate:jB,tile:sr,topk:TN,transpose:Me,truncatedNormal:Qw,unique:IN,unsortedSegmentSum:Zw,unstack:dr,upperBound:HB,variable:NN,where:wn,whereAsync:_N,zeros:Qt,zerosLike:Ve},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nfe=(t,e,n,s=Ln)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(C("a",t,e,n),C("b",t,e,n))];case"AddN":return[s.addN(C("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(C("a",t,e,n),C("b",t,e,n))];case"Mul":return[s.mul(C("a",t,e,n),C("b",t,e,n))];case"RealDiv":case"Div":return[s.div(C("a",t,e,n),C("b",t,e,n))];case"DivNoNan":return[s.divNoNan(C("a",t,e,n),C("b",t,e,n))];case"FloorDiv":return[s.floorDiv(C("a",t,e,n),C("b",t,e,n))];case"Sub":return[s.sub(C("a",t,e,n),C("b",t,e,n))];case"Minimum":return[s.minimum(C("a",t,e,n),C("b",t,e,n))];case"Maximum":return[s.maximum(C("a",t,e,n),C("b",t,e,n))];case"Pow":return[s.pow(C("a",t,e,n),C("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(C("a",t,e,n),C("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _fe=(t,e,n,s=Ln)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(C("x",t,e,n))];case"Acos":return[s.acos(C("x",t,e,n))];case"Acosh":return[s.acosh(C("x",t,e,n))];case"Asin":return[s.asin(C("x",t,e,n))];case"Asinh":return[s.asinh(C("x",t,e,n))];case"Atan":return[s.atan(C("x",t,e,n))];case"Atan2":return[s.atan2(C("x",t,e,n),C("y",t,e,n))];case"Atanh":return[s.atanh(C("x",t,e,n))];case"Ceil":return[s.ceil(C("x",t,e,n))];case"Complex":return[s.complex(C("real",t,e,n),C("imag",t,e,n))];case"Cos":return[s.cos(C("x",t,e,n))];case"Cosh":return[s.cosh(C("x",t,e,n))];case"Elu":return[s.elu(C("x",t,e,n))];case"Erf":return[s.erf(C("x",t,e,n))];case"Exp":return[s.exp(C("x",t,e,n))];case"Expm1":return[s.expm1(C("x",t,e,n))];case"Floor":return[s.floor(C("x",t,e,n))];case"Log":return[s.log(C("x",t,e,n))];case"Log1p":return[s.log1p(C("x",t,e,n))];case"Imag":return[s.imag(C("x",t,e,n))];case"Neg":return[s.neg(C("x",t,e,n))];case"Reciprocal":return[s.reciprocal(C("x",t,e,n))];case"Real":return[s.real(C("x",t,e,n))];case"Relu":return[s.relu(C("x",t,e,n))];case"Round":return[s.round(C("x",t,e,n))];case"Selu":return[s.selu(C("x",t,e,n))];case"Sigmoid":return[s.sigmoid(C("x",t,e,n))];case"Sin":return[s.sin(C("x",t,e,n))];case"Sign":return[s.sign(C("x",t,e,n))];case"Sinh":return[s.sinh(C("x",t,e,n))];case"Softplus":return[s.softplus(C("x",t,e,n))];case"Sqrt":return[s.sqrt(C("x",t,e,n))];case"Square":return[s.square(C("x",t,e,n))];case"Tanh":return[s.tanh(C("x",t,e,n))];case"Tan":return[s.tan(C("x",t,e,n))];case"ClipByValue":return[s.clipByValue(C("x",t,e,n),C("clipValueMin",t,e,n),C("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(C("x",t,e,n))];case"Rsqrt":return[s.rsqrt(En(t.inputNames[0],e,n))];case"LeakyRelu":return[s.leakyRelu(C("x",t,e,n),C("alpha",t,e,n))];case"Prelu":return[s.prelu(C("x",t,e,n),C("alpha",t,e,n))];case"IsNan":return[s.isNaN(En(t.inputNames[0],e,n))];case"IsInf":return[s.isInf(En(t.inputNames[0],e,n))];case"IsFinite":return[s.isFinite(En(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sr(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){N(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const r=t[s],i=e[s];N(r<0||i<0||r===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function LO(t){return!(typeof t=="number"||t.some(e=>e<0))}function lf(t,e,n){let s=hC(t,n);const r=!LO(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(i=>{s=hC(i.shape,s)}),!LO(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function hC(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const r=t[s],i=e[s];if(r>=0&&i>=0&&r!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=r>=0?r:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $fe{constructor(e,n,s,r,i,o,a){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=be(0),ln(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Sr(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,ln(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,r)=>this.write(s,n[r]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Bs([],[0].concat(this.elementShape));const s=this.readMany(e);return Sr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),is(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Bs([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return Sr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Vt(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,dr(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=s===0?0:n.size/s,o=[];q(()=>{n=U(n,[1,s,i]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:r[l-1],0],h=[1,e[l],i];o[l]=U(Be(n,u,h),this.elementShape)}return o});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kc{get id(){return this.idTensor.id}constructor(e,n,s,r=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(i=>{if(s!==i.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${i.dtype}`);Sr(n,i.shape,"TensorList shape mismatch: "),ln(i)}),this.idTensor=be(0),this.maxNumElements=r,ln(this.idTensor)}copy(){return new kc([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);Sr(e,this.elementShape,"TensorList shape mismatch: ");const r=lf(this.elementShape,this.tensors,e);return q(()=>{const i=this.tensors.map(o=>U(o,r));return is(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=lf(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Sr(r.shape,e,"TensorList shape mismatch: "),U(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Sr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");ln(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new kc([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Sr(this.tensors[e].shape,n,"TensorList shape mismatch: ");const r=lf(this.elementShape,this.tensors,n);return U(this.tensors[e],r)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Sr(this.elementShape,n.shape,"TensorList shape mismatch: "),ln(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Sr(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=lf(this.elementShape,this.tensors,s);return e.length===0?Bs([],[0].concat(r)):q(()=>{const i=e.map(o=>U(this.tensors[o],r));return is(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Sr(this.elementShape,n,"TensorList shape mismatch: ");const s=lf(this.elementShape,this.tensors,n);return this.size()===0?Bs([],[0].concat(s)):q(()=>{const r=this.tensors.map(i=>U(i,s));return Vt(r,0)})}}function Efe(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const r=t.shape.slice(1);Sr(r,e,"TensorList shape mismatch: ");const i=dr(t);return new kc(i,e,s)}function Dfe(t,e,n,s){return new kc([],t,e,s)}function Afe(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const i=new kc([],n,t.dtype,s),o=dr(t,0);return e.forEach((a,l)=>{i.setItem(a,o[l])}),i}function Rfe(t,e,n){let s=0;const r=e.map(u=>(s+=u,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=hC(i,n),a=s===0?0:t.size/s,l=q(()=>{const u=[];t=U(t,[1,s,a]);for(let h=0;h<e.length;++h){const f=[0,h===0?0:r[h-1],0],p=[1,e[h],a];u[h]=U(Be(t,f,p),o)}return t.dispose(),u}),c=new kc([],n,t.dtype,e.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ofe=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=C("thenBranch",t,e,n),r=C("elseBranch",t,e,n),i=C("cond",t,e,n),o=C("args",t,e,n);return(await i.data())[0]?n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=C("body",t,e,n),r=C("cond",t,e,n),i=C("args",t,e,n),o=await n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(u=>u.id);let l=await o[0].data();o.forEach(u=>{!u.kept&&a.indexOf(u.id)===-1&&u.dispose()});let c=i;for(;l[0];){const u=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const h=c.map(f=>f.id);u.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&h.indexOf(f.id)===-1&&f.dispose()});const d=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await d[0].data(),d.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&h.indexOf(f.id)===-1&&f.dispose()})}return c}case"LoopCond":{const s=C("pred",t,e,n);return[Zi(s)]}case"Switch":{const s=C("pred",t,e,n);let r=C("data",t,e,n);return r.kept||(r=Zi(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=t.inputNames.find(r=>En(r,e,n)!==void 0);if(s){const r=En(s,e,n);return[Zi(r)]}return}case"Enter":{const s=C("frameName",t,e,n),r=C("tensor",t,e,n);return n.enterFrame(s),[Zi(r)]}case"Exit":{const s=C("tensor",t,e,n);return n.exitFrame(),[Zi(s)]}case"NextIteration":{const s=C("tensor",t,e,n);return n.nextIteration(),[Zi(s)]}case"TensorArrayV3":{const s=C("size",t,e,n),r=C("dtype",t,e,n),i=C("elementShape",t,e,n),o=C("dynamicSize",t,e,n),a=C("clearAfterRead",t,e,n),l=C("identicalElementShapes",t,e,n),c=C("name",t,e,n),u=new $fe(c,r,s,i,l,o,a);return n.addTensorArray(u),[u.idTensor,be(1)]}case"TensorArrayWriteV3":{const s=C("tensorArrayId",t,e,n),r=C("index",t,e,n),i=C("tensor",t,e,n),o=n.getTensorArray(s.id);return o.write(r,i),[o.idTensor]}case"TensorArrayReadV3":{const s=C("tensorArrayId",t,e,n),r=C("index",t,e,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=C("tensorArrayId",t,e,n),r=C("indices",t,e,n),i=C("dtype",t,e,n);return[n.getTensorArray(s.id).gather(r,i)]}case"TensorArrayScatterV3":{const s=C("tensorArrayId",t,e,n),r=C("indices",t,e,n),i=C("tensor",t,e,n),o=n.getTensorArray(s.id);return o.scatter(r,i),[o.idTensor]}case"TensorArrayConcatV3":{const s=C("tensorArrayId",t,e,n),r=n.getTensorArray(s.id),i=C("dtype",t,e,n);return[r.concat(i)]}case"TensorArraySplitV3":{const s=C("tensorArrayId",t,e,n),r=C("tensor",t,e,n),i=C("lengths",t,e,n),o=n.getTensorArray(s.id);return o.split(i,r),[o.idTensor]}case"TensorArraySizeV3":{const s=C("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return[be(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=C("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=C("tensorListId",t,e,n),r=C("index",t,e,n),i=C("tensor",t,e,n),o=n.getTensorList(s.id);return o.setItem(r,i),[o.idTensor]}case"TensorListGetItem":{const s=C("tensorListId",t,e,n),r=C("index",t,e,n),i=C("elementShape",t,e,n),o=C("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(r,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=C("indices",t,e,n),r=C("tensor",t,e,n),i=C("elementShape",t,e,n),o=C("numElements",t,e,n),a=Afe(r,s,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=C("elementShape",t,e,n),r=C("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=C(i,t,e,n),a=t.op==="TensorListReserve"?-1:o,l=Dfe(s,r,o,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=C("tensorListId",t,e,n),r=C("indices",t,e,n),i=C("elementShape",t,e,n),o=C("elementDType",t,e,n);return[n.getTensorList(s.id).gather(r,o,i)]}case"TensorListStack":{const s=C("tensorListId",t,e,n),r=C("elementShape",t,e,n),i=C("elementDType",t,e,n),o=C("numElements",t,e,n);return[n.getTensorList(s.id).stack(r,i,o)]}case"TensorListFromTensor":{const s=C("tensor",t,e,n),r=C("elementShape",t,e,n),i=C("elementDType",t,e,n),o=Efe(s,r,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=C("tensorListId",t,e,n),r=n.getTensorList(s.id),i=C("dtype",t,e,n),o=C("elementShape",t,e,n);return[r.concat(i,o)]}case"TensorListPushBack":{const s=C("tensorListId",t,e,n),r=C("tensor",t,e,n),i=n.getTensorList(s.id);return i.pushBack(r),[i.idTensor]}case"TensorListPopBack":{const s=C("tensorListId",t,e,n),r=C("elementShape",t,e,n),i=C("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(r,i)]}case"TensorListSplit":{const s=C("tensor",t,e,n),r=C("elementShape",t,e,n),i=C("lengths",t,e,n),o=Rfe(s,i,r);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const s=C("tensorListId",t,e,n),r=n.getTensorList(s.id);return[be(r.size(),"int32")]}case"TensorListResize":{const s=C("tensorListId",t,e,n),r=C("size",t,e,n),o=n.getTensorList(s.id).resize(r);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zO(t,e,n){const[s,r]=C("fusedOps",t,e,n),i=s==="biasadd",o=!i,a=r==="prelu",l=s==="fusedbatchnorm",c=C("numArgs",t,e,n);if(i){if(a&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=C("strides",t,e,n),h=Ax(t,e,n),d=C("dataFormat",t,e,n).toUpperCase(),f=C("dilations",t,e,n);let[p,g]=C("args",t,e,n);o&&(g=p,p=void 0);const m=C("leakyreluAlpha",t,e,n);return{stride:u,pad:h,dataFormat:d,dilations:f,biasArg:p,preluArg:g,activationFunc:r,leakyreluAlpha:m}}const Pfe=(t,e,n,s=Ln)=>{switch(t.op){case"Conv1D":{const r=C("stride",t,e,n),i=C("pad",t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),a=C("dilation",t,e,n);return[s.conv1d(C("x",t,e,n),C("filter",t,e,n),r,i,o,a)]}case"Conv2D":{const r=C("strides",t,e,n),i=Ax(t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),a=C("dilations",t,e,n);return[s.conv2d(C("x",t,e,n),C("filter",t,e,n),[r[1],r[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:h}=zO(t,e,n);return[s.fused.conv2d({x:C("x",t,e,n),filter:C("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:h}=zO(t,e,n);return[s.fused.depthwiseConv2d({x:C("x",t,e,n),filter:C("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=C("outputShape",t,e,n),i=C("strides",t,e,n),o=Ax(t,e,n);return[s.conv2dTranspose(C("x",t,e,n),C("filter",t,e,n),r,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=C("strides",t,e,n),i=Ax(t,e,n),o=C("dilations",t,e,n),a=C("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(C("input",t,e,n),C("filter",t,e,n),[r[1],r[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),a=C("dilations",t,e,n);return[s.conv3d(C("x",t,e,n),C("filter",t,e,n),[r[1],r[2],r[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[s.avgPool(C("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[s.maxPool(C("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n),a=C("includeBatchInIndex",t,e,n),{result:l,indexes:c}=s.maxPoolWithArgmax(C("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i,a);return[l,c]}case"AvgPool3D":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[s.avgPool3d(C("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[s.maxPool3d(C("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("dilations",t,e,n),a=r[1],l=r[2],c=o[1],u=o[2];return[s.dilation2d(C("x",t,e,n),C("filter",t,e,n),[a,l],i,[c,u],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ffe=(t,e,n,s=Ln)=>{switch(t.op){case"Fill":{const r=C("shape",t,e,n),i=C("dtype",t,e,n),o=C("value",t,e,n);return[s.fill(r,o,i)]}case"LinSpace":{const r=C("start",t,e,n),i=C("stop",t,e,n),o=C("num",t,e,n);return[s.linspace(r,i,o)]}case"Multinomial":{const r=C("logits",t,e,n),i=C("numSamples",t,e,n),o=C("seed",t,e,n);return[s.multinomial(r,i,o)]}case"OneHot":{const r=C("indices",t,e,n),i=C("depth",t,e,n),o=C("onValue",t,e,n),a=C("offValue",t,e,n),l=C("dtype",t,e,n);return[s.oneHot(r,i,o,a,l)]}case"Ones":return[s.ones(C("shape",t,e,n),C("dtype",t,e,n))];case"OnesLike":return[s.onesLike(C("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(C("shape",t,e,n),C("dtype",t,e,n),C("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(C("shape",t,e,n),C("minval",t,e,n),C("maxval",t,e,n),C("dtype",t,e,n))];case"RandomUniformInt":return[s.randomUniformInt(C("shape",t,e,n),C("minval",t,e,n),C("maxval",t,e,n),C("seed",t,e,n))];case"Range":{const r=C("start",t,e,n),i=C("stop",t,e,n),o=C("step",t,e,n);return[s.range(r,i,o,C("dtype",t,e,n))]}case"TruncatedNormal":{const r=C("shape",t,e,n),i=C("mean",t,e,n),o=C("stdDev",t,e,n),a=C("seed",t,e,n);return[s.truncatedNormal(r,i,o,C("dtype",t,e,n),a)]}case"Zeros":return[s.zeros(C("shape",t,e,n),C("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2(t,e,n){const s=C("boxes",t,e,n),r=C("scores",t,e,n),i=C("maxOutputSize",t,e,n),o=C("iouThreshold",t,e,n),a=C("scoreThreshold",t,e,n),l=C("softNmsSigma",t,e,n);return{boxes:s,scores:r,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const Mfe=async(t,e,n,s,r=Ln)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=q2(t,e,n),h=await r.image.nonMaxSuppressionWithScoreAsync(i,o,a,l,c,u);return[h.selectedIndices,h.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=q2(t,e,n),u=C("padToMaxOutputSize",t,e,n),h=await r.image.nonMaxSuppressionPaddedAsync(i,o,a,l,c,u);return[h.selectedIndices,h.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=q2(t,e,n);return[await r.image.nonMaxSuppressionAsync(i,o,a,l,c)]}case"Where":{const i=r.cast(C("condition",t,e,n),"bool"),o=[await r.whereAsync(i)];return i.dispose(),o}case"ListDiff":return r.setdiff1dAsync(C("x",t,e,n),C("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lfe=(t,e,n,s=Ln)=>{switch(t.op){case"LowerBound":{const r=C("sortedSequence",t,e,n),i=C("values",t,e,n);return[s.lowerBound(r,i)]}case"TopKV2":{const r=C("x",t,e,n),i=C("k",t,e,n),o=C("sorted",t,e,n),a=s.topk(r,i,o);return[a.values,a.indices]}case"UpperBound":{const r=C("sortedSequence",t,e,n),i=C("values",t,e,n);return[s.upperBound(r,i)]}case"Unique":{const r=C("x",t,e,n),i=s.unique(r);return[i.values,i.indices]}case"UniqueV2":{const r=C("x",t,e,n),i=C("axis",t,e,n),o=s.unique(r,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zfe=(t,e,n,s=Ln)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=C("default",t,e,n);return[En(t.name,e,n)||r];case"Placeholder":return[En(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=C("x",t,e,n);return[Zi(u)]}case"IdentityN":return C("x",t,e,n).map(u=>Zi(u));case"Snapshot":const i=C("x",t,e,n);return[Zi(i)];case"Shape":return[s.tensor1d(C("x",t,e,n).shape,"int32")];case"ShapeN":return C("x",t,e,n).map(u=>s.tensor1d(u.shape));case"Size":return[s.scalar(C("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(C("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const o=C("x",t,e,n),a=C("data",t,e,n),l=C("message",t,e,n),c=C("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bfe{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=be(0),this.tensorMap=new Map,ln(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return be(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),q(()=>{const r=dr(n),i=s.length,o=r.length;N(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const l=s[a],c=r[a];ln(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return q(()=>{const r=[];for(let i=0;i<s.length;i++){const o=s[i],a=this.findWithDefault(o,n);r.push(a)}return is(r)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vfe=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(t.name);if(r!=null)return[r];{const i=C("keyDType",t,e,n),o=C("valueDType",t,e,n),a=new Bfe(i,o);return s.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=C("tableHandle",t,e,n,s),i=C("keys",t,e,n),o=C("values",t,e,n);return[await s.getHashTableById(r.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const r=C("tableHandle",t,e,n,s),i=C("keys",t,e,n),o=C("defaultValue",t,e,n);return[await s.getHashTableById(r.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=C("tableHandle",t,e,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wfe=(t,e,n,s=Ln)=>{switch(t.op){case"ResizeBilinear":{const r=C("images",t,e,n),i=C("size",t,e,n),o=C("alignCorners",t,e,n),a=C("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(r,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const r=C("images",t,e,n),i=C("size",t,e,n),o=C("alignCorners",t,e,n),a=C("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(r,[i[0],i[1]],o,a)]}case"CropAndResize":{const r=C("image",t,e,n),i=C("boxes",t,e,n),o=C("boxInd",t,e,n),a=C("cropSize",t,e,n),l=C("method",t,e,n),c=C("extrapolationValue",t,e,n);return[s.image.cropAndResize(r,i,o,a,l,c)]}case"ImageProjectiveTransformV3":{const r=C("images",t,e,n),i=C("transforms",t,e,n),o=C("outputShape",t,e,n),a=C("fillValue",t,e,n),l=C("interpolation",t,e,n),c=C("fillMode",t,e,n);return[s.image.transform(r,i,l.toLowerCase(),c.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ufe=(t,e,n,s=Ln)=>{switch(t.op){case"Equal":return[s.equal(C("a",t,e,n),C("b",t,e,n))];case"NotEqual":return[s.notEqual(C("a",t,e,n),C("b",t,e,n))];case"Greater":return[s.greater(C("a",t,e,n),C("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(C("a",t,e,n),C("b",t,e,n))];case"Less":return[s.less(C("a",t,e,n),C("b",t,e,n))];case"LessEqual":return[s.lessEqual(C("a",t,e,n),C("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(C("a",t,e,n),C("b",t,e,n))];case"LogicalNot":return[s.logicalNot(C("a",t,e,n))];case"LogicalOr":return[s.logicalOr(C("a",t,e,n),C("b",t,e,n))];case"Select":case"SelectV2":return[s.where(C("condition",t,e,n),C("a",t,e,n),C("b",t,e,n))];case"BitwiseAnd":return[s.bitwiseAnd(C("a",t,e,n),C("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jfe=(t,e,n,s=Ln)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(C("a",t,e,n),C("b",t,e,n),C("transposeA",t,e,n),C("transposeB",t,e,n))];case"Einsum":return[s.einsum(C("equation",t,e,n),...C("tensors",t,e,n))];case"Transpose":return[s.transpose(C("x",t,e,n),C("perm",t,e,n))];case"_FusedMatMul":const[r,i]=C("fusedOps",t,e,n),o=r==="biasadd",a=i==="prelu",l=C("numArgs",t,e,n),c=C("leakyreluAlpha",t,e,n);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,h]=C("args",t,e,n);return[s.fused.matMul({a:C("a",t,e,n),b:C("b",t,e,n),transposeA:C("transposeA",t,e,n),transposeB:C("transposeB",t,e,n),bias:u,activation:i,preluActivationWeights:h,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(C("a",t,e,n),C("numLower",t,e,n),C("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hfe=(t,e,n,s=Ln)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(C("x",t,e,n),C("axis",t,e,n),C("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(C("x",t,e,n),C("mean",t,e,n),C("variance",t,e,n),C("offset",t,e,n),C("scale",t,e,n),C("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(C("x",t,e,n),C("mean",t,e,n),C("variance",t,e,n),C("offset",t,e,n),C("scale",t,e,n),C("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(C("x",t,e,n),C("radius",t,e,n),C("bias",t,e,n),C("alpha",t,e,n),C("beta",t,e,n))];case"Softmax":return[s.softmax(C("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gfe=(t,e,n,s=Ln)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:i}=s.raggedGather(C("paramsNestedSplits",t,e,n),C("paramsDenseValues",t,e,n),C("indices",t,e,n),C("outputRaggedRank",t,e,n));return r.concat(i)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:i}=s.raggedRange(C("starts",t,e,n),C("limits",t,e,n),C("splits",t,e,n));return[r,i]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(C("shape",t,e,n),C("values",t,e,n),C("defaultValue",t,e,n),C("rowPartitionTensors",t,e,n),C("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qfe=(t,e,n,s=Ln)=>{switch(t.op){case"Max":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.max(C("x",t,e,n),a,l)]}case"Mean":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.mean(C("x",t,e,n),a,l)]}case"Min":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.min(C("x",t,e,n),a,l)]}case"Sum":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.sum(C("x",t,e,n),a,l)]}case"All":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.all(C("x",t,e,n),a,l)]}case"Any":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.any(C("x",t,e,n),a,l)]}case"ArgMax":{const a=C("axis",t,e,n);return[s.argMax(C("x",t,e,n),a)]}case"ArgMin":{const a=C("axis",t,e,n);return[s.argMin(C("x",t,e,n),a)]}case"Prod":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.prod(C("x",t,e,n),a,l)]}case"Cumprod":{const a=C("axis",t,e,n),l=C("exclusive",t,e,n),c=C("reverse",t,e,n);return[s.cumprod(C("x",t,e,n),a,l,c)]}case"Cumsum":{const a=C("axis",t,e,n),l=C("exclusive",t,e,n),c=C("reverse",t,e,n);return[s.cumsum(C("x",t,e,n),a,l,c)]}case"Bincount":const r=C("x",t,e,n),i=C("weights",t,e,n),o=C("size",t,e,n);return[s.bincount(r,i,o)];case"DenseBincount":{const a=C("x",t,e,n),l=C("weights",t,e,n),c=C("size",t,e,n),u=C("binaryOutput",t,e,n);return[s.denseBincount(a,l,c,u)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe=(t,e,n,s=Ln)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=C("n",t,e,n),i=C("axis",t,e,n);let o=C("tensors",t,e,n);return o=o.slice(0,r),[s.concat(o,i)]}case"Gather":{const r=C("x",t,e,n),i=C("indices",t,e,n);return[s.gather(r,s.cast(i,"int32"),0)]}case"GatherV2":{const r=C("axis",t,e,n),i=C("batchDims",t,e,n),o=C("x",t,e,n),a=C("indices",t,e,n);return[s.gather(o,s.cast(a,"int32"),r,i)]}case"Reverse":{const r=C("dims",t,e,n),i=[];for(let a=0;a<r.length;a++)r[a]&&i.push(a);const o=C("x",t,e,n);return[s.reverse(o,i)]}case"ReverseV2":{const r=C("axis",t,e,n),i=C("x",t,e,n);return[s.reverse(i,r)]}case"Slice":{const r=C("begin",t,e,n),i=C("size",t,e,n);return[s.slice(C("x",t,e,n),r,i)]}case"StridedSlice":{const r=C("begin",t,e,n),i=C("end",t,e,n),o=C("strides",t,e,n),a=C("beginMask",t,e,n),l=C("endMask",t,e,n),c=C("ellipsisMask",t,e,n),u=C("newAxisMask",t,e,n),h=C("shrinkAxisMask",t,e,n),d=C("x",t,e,n);return[s.stridedSlice(d,r,i,o,a,l,c,u,h)]}case"Pack":return q(()=>{const r=C("axis",t,e,n),i=C("tensors",t,e,n),o=i[0].shape,a=s.squeeze(i[0]).shape,l=i.map(c=>{const u=Fe(c.shape,o);if(!u&&!Fe(s.squeeze(c).shape,a))throw new Error("the input tensors shape does not match");return u?c:s.reshape(c,o)});return[s.stack(l,r)]});case"Unpack":{const r=C("axis",t,e,n),i=C("tensor",t,e,n);return s.unstack(i,r)}case"Tile":{const r=C("reps",t,e,n);return[s.tile(C("x",t,e,n),r)]}case"Split":case"SplitV":{const r=C("axis",t,e,n),i=C("numOrSizeSplits",t,e,n),o=C("x",t,e,n);return s.split(o,i,r)}case"ScatterNd":{const r=C("indices",t,e,n),i=C("values",t,e,n),o=C("shape",t,e,n);return[s.scatterND(r,i,o)]}case"GatherNd":{const r=C("x",t,e,n),i=C("indices",t,e,n);return[s.gatherND(r,i)]}case"SparseToDense":{const r=C("sparseIndices",t,e,n),i=C("outputShape",t,e,n),o=C("sparseValues",t,e,n),a=C("defaultValue",t,e,n);return[s.sparseToDense(r,o,i,o.dtype===a.dtype?a:s.cast(a,o.dtype))]}case"TensorScatterUpdate":{const r=C("indices",t,e,n),i=C("values",t,e,n),o=C("tensor",t,e,n);return[s.tensorScatterUpdate(o,r,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xfe=(t,e,n,s=Ln)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows(C("indices",t,e,n),C("values",t,e,n),C("denseShape",t,e,n),C("defaultValue",t,e,n));return[r,i,o,a]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=s.sparse.sparseReshape(C("inputIndices",t,e,n),C("inputShape",t,e,n),C("newShape",t,e,n));return[r,i]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(C("data",t,e,n),C("indices",t,e,n),C("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(C("data",t,e,n),C("indices",t,e,n),C("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yfe=(t,e,n,s=Ln)=>{switch(t.op){case"FFT":return[s.fft(C("x",t,e,n))];case"IFFT":return[s.ifft(C("x",t,e,n))];case"RFFT":return[s.rfft(C("x",t,e,n))];case"IRFFT":return[s.irfft(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qfe=(t,e,n,s=Ln)=>{switch(t.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(C("input",t,e,n),C("pattern",t,e,n),C("rewrite",t,e,n),C("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=s.string.stringNGrams(C("data",t,e,n),C("dataSplits",t,e,n),C("separator",t,e,n),C("nGramWidths",t,e,n),C("leftPad",t,e,n),C("rightPad",t,e,n),C("padWidth",t,e,n),C("preserveShortSequences",t,e,n));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:o}=s.string.stringSplit(C("input",t,e,n),C("delimiter",t,e,n),C("skipEmpty",t,e,n));return[r,i,o]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(C("input",t,e,n),C("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zfe=(t,e,n,s=Ln)=>{switch(t.op){case"Cast":return[s.cast(C("x",t,e,n),C("dtype",t,e,n))];case"ExpandDims":{const r=C("axis",t,e,n);return[s.expandDims(C("x",t,e,n),r)]}case"Squeeze":{const r=C("axis",t,e,n);return[s.squeeze(C("x",t,e,n),r)]}case"Reshape":return[s.reshape(C("x",t,e,n),C("shape",t,e,n))];case"EnsureShape":return[s.ensureShape(C("x",t,e,n),C("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(C("x",t,e,n),C("padding",t,e,n),C("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(C("x",t,e,n),C("padding",t,e,n),C("constantValue",t,e,n))];case"SpaceToBatchND":{const r=C("blockShape",t,e,n),i=C("paddings",t,e,n);return[s.spaceToBatchND(C("x",t,e,n),r,i)]}case"BatchToSpaceND":{const r=C("blockShape",t,e,n),i=C("crops",t,e,n);return[s.batchToSpaceND(C("x",t,e,n),r,i)]}case"DepthToSpace":{const r=C("blockSize",t,e,n),i=C("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(C("x",t,e,n),r,i)]}case"BroadcastTo":return[s.broadcastTo(C("x",t,e,n),C("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(C("s0",t,e,n),C("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BO(t,e,n,s,r=q){const i=((o,a,l)=>{switch(o.category){case"arithmetic":return r(()=>Nfe(o,a,l));case"basic_math":return r(()=>_fe(o,a,l));case"control":return Ofe(o,a,l);case"convolution":return r(()=>Pfe(o,a,l));case"creation":return r(()=>Ffe(o,a,l));case"dynamic":return Mfe(o,a,l);case"evaluation":return r(()=>Lfe(o,a,l));case"image":return r(()=>Wfe(o,a,l));case"graph":return r(()=>zfe(o,a,l));case"logical":return r(()=>Ufe(o,a,l));case"matrices":return r(()=>jfe(o,a,l));case"normalization":return r(()=>Hfe(o,a,l));case"ragged":return r(()=>Gfe(o,a,l));case"reduction":return r(()=>qfe(o,a,l));case"slice_join":return r(()=>Kfe(o,a,l));case"sparse":return r(()=>Xfe(o,a,l));case"spectral":return r(()=>Yfe(o,a,l));case"string":return r(()=>Qfe(o,a,l));case"transformation":return r(()=>Zfe(o,a,l));case"hash_table":return Vfe(o,a,l,s);case"custom":const c=xW(o.op);if(c&&c.customExecutor)return c.customExecutor(new Ife(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return ko(i)?i.then(o=>[].concat(o)):[].concat(i)}class VO{constructor(e={},n={},s={},r={},i){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WO(t,e,n,s){const r=new Set,i=[];let o=null,a=null;const l=new Set,c=new Set(Object.keys(t).map(d=>Es(d)[0]));s=s||[];const u=new Set(s.map(d=>Es(d.name)[0])),h=[...e];for(;h.length>0;){const d=h.pop();if((Dl(d)||ope(d)||ape(d))&&o==null&&(o=d,a=o.children.map(f=>f.name).filter(f=>r.has(f))),r.add(d.name),n[d.name]==null&&!c.has(d.name)&&!u.has(d.name)){if(d.inputs.length===0){i.push(d.name);continue}d.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),h.push(f))})}}return{inputs:t,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:a}}function Jfe(t,e){const{usedNodes:n,inputs:s}=e,r=Object.keys(s).map(m=>Es(m)[0]).map(m=>t.nodes[m]),i=t.initNodes||[],o=m=>n.has(typeof m=="string"?m:m.name);function a(m){return[...new Map(m.map(x=>[x.name,x])).values()]}const l=a([...r,...t.weights,...i]).filter(o),c=a([...l,...Object.values(t.nodes)]).filter(o),u=new Map(c.map(m=>[m.name,m])),h={};for(const m of c){h[m.name]=h[m.name]||0;for(const x of m.children)o(x)||(h[x.name]=Number.POSITIVE_INFINITY),h[x.name]=(h[x.name]||0)+1}const d=Object.entries(h).filter(([,m])=>m===0).map(([m])=>m),f=[...d];for(;d.length>0;){const m=d.pop(),x=u.get(m);for(const y of x.children.filter(o))--h[y.name]===0&&(f.push(y.name),d.push(y.name))}const p=f.map(m=>u.get(m)),g=epe(p,l);return tpe(g,l),g}function epe(t,e){const n=new Map(t.map(o=>[o.name,o])),s=e.map(o=>o.name),r=new Set(s);for(;s.length>0;){const o=s.pop(),a=n.get(o);for(const l of a.children)!n.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return t.filter(o=>r.has(o.name))}class j0 extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function tpe(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),s=new Set(e.map(a=>a.name)),r=a=>s.has(typeof a=="string"?a:a.name),i=new Set(t.map(a=>a.name)),o=a=>i.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(o)){if(!n.has(l.name))throw new j0(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new j0(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!r(a))for(const l of a.inputs){if(!n.has(l.name))throw new j0(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new j0(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function npe(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,s=t.map((a,l)=>Dl(a)?n:l),r=a=>{const l=s[e.get(a.name)];return l??-1},i=t.map((a,l)=>a.children.map(r).reduce((c,u)=>Math.max(c,u),s[l])),o=new Map;for(let a=0;a<t.length;++a){const l=i[a];if(l===n)continue;const c=t[a],u=t[l];o.has(u.name)||o.set(u.name,[]),o.get(u.name).push(c)}return o}const spe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),rpe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),ipe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Dl(t){return spe.has(t.op)}function ope(t){return rpe.has(t.op)}function ape(t){return ipe.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h1{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new h1(e.functions[s],this)})}getCompilationKey(e,n){const s=e.map(i=>i.name).sort(),r=n.map(i=>i.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,n){const s=WO(e,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:o}=s;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const c=n.map(h=>h.name),u=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${u}]. Missing the following inputs: [${r}]`)}const a=Jfe(this.graph,s),l=npe(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return ln(n),n}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(d=>this.graph.nodes[Es(d)[0]]),i=n.map(d=>Es(d)[0]),o=new Set(i);let a=i.map(d=>this.graph.nodes[d]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(r,a);let c=this.compiledMap.get(l);c==null&&(c=this.compile(e,a),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=K().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const u={},h={};return q(()=>{const d=new VO(this.weightMap,u,h,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(x=>{const[y,b]=Es(x,d),w=[];w[b]=e[x],f[y]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[y]=this.cloneTensorList(w))});const p=this.getFrozenTensorIds(f),{orderedNodes:g,nodeLiveUntilMap:m}=c;for(const x of g){if(f[x.name])continue;const y=BO(x,f,d,this._resourceManager);if(ko(y))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);f[x.name]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[x.name]=this.cloneTensorList(y)),this.checkTensorForDisposalWithNodeLiveUntilInfo(x,f,d,p,o,m.get(x.name))}return this.parent==null&&d.dispose(p),n.map(x=>En(x,f,d))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(e,n,s,r,i,o,a){if(!(Dl(n)||o.has(e))){for(const l of s[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(Dl(l))continue;const c=PO(l.name,s,r);if(c!=null)for(const u of c){if(!u||u.kept||i.has(u.id))continue;const h=a[u.id];h===1?(u.dispose(),delete a[u.id]):h!=null&&a[u.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,s,r,i,o){function a(l){return Dl(l)||i.has(l.name)}if(!(Dl(e)||o==null))for(const l of o){if(a(l))continue;const c=PO(l.name,n,s);for(const u of c)!u||u.kept||r.has(u.id)||u.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,s=!1,r={},i={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=K().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const o=new VO(this.weightMap,r,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,n,s),l=n.map(d=>En(d,a,o)),c=l.map(d=>d.id),u=Object.keys(e).map(d=>e[d].id),h=new Set([...c,...u,...this.weightIds]);return Object.values(a).forEach(d=>{d.forEach(f=>{f&&!f.isDisposed&&!h.has(f.id)&&f.dispose()})}),this.parent==null&&o.dispose(h),l}async executeFunctionAsync(e,n,s){const r=e.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,r){const i=Object.keys(e),o=i.map(w=>this.graph.nodes[Es(w)[0]]),a=s.map(w=>Es(w)[0]),l=new Set(a);let c=a.map(w=>this.graph.nodes[w]);c.length===0&&(c=this._outputs);const{usedNodes:u,missingInputs:h,dynamicNode:d,syncInputs:f}=WO(e,c,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map(w=>({node:w,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[v,S]=Es(w),T=[];T[S]=e[w],g[v]=T});const m={},x=this.getFrozenTensorIds(g),y={};for(;p.length>0;){const w=this.processStack(o,p,n,g,y,x,l,m,u);await Promise.all(w)}d==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=c.filter(w=>!Dl(w)&&!En(w.name,g,n)).map(w=>w.name);if(b.length>0){let w="";throw d!=null&&(w=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${i}]. Consider providing the following inputs: [${h}]. ${w}`)}return g}processStack(e,n,s,r,i,o,a,l,c){const u=[];for(;n.length>0;){const h=n.pop();s.currentContext=h.contexts;let d="";if(h.node.op==="Enter"&&C("isConstant",h.node,r,s)&&([d]=Qi(h.node.name,s)),r[h.node.name]==null){const f=BO(h.node,r,s,this._resourceManager);d||([d]=Qi(h.node.name,s));const p=s.currentContext;ko(f)?u.push(f.then(g=>(r[d]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(g)),s.currentContext=p,this.checkTensorForDisposal(d,h.node,r,s,o,a,l),this.processChildNodes(h.node,n,s,r,i,c),g))):(r[d]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(f)),this.checkTensorForDisposal(d,h.node,r,s,o,a,l),this.processChildNodes(h.node,n,s,r,i,c))}else this.processChildNodes(h.node,n,s,r,i,c)}return u}processChildNodes(e,n,s,r,i,o){e.children.forEach(a=>{const[l]=Qi(a.name,s);i[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(c=>!!En(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})):a.inputNames.every(c=>!!En(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[r]=Es(n),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===s.shape.length&&s.shape.every((l,c)=>o[c]===-1||o[c]===l);N(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&N(s.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var n,s;const r={};for(const i in e){const o=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[i];o!=null?r[o.name]=e[i]:r[i]=e[i]}return r}checkInputs(e){const n=Object.keys(e).filter(s=>{const[r]=Es(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var s,r;const i=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return i!=null?i.name:n},{})}checkOutputs(e){e.forEach(n=>{const[s]=Es(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class lpe{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cpe="?tfjs-format=file",upe="model.json";class j${get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},s=WN){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new lpe}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return ko(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await qz(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(r=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new h1(FO.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=FO.Instance.transformGraph(e.modelInitializer);this.initializer=new h1(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof je?[e]:e,s={};return n.forEach((r,i)=>s[this.structuredOutputKeys[i]]=r),s}return e}predict(e,n){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,n){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var n;if(!(e instanceof je)&&!Array.isArray(e)){const i=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(i!=null)for(const o in i){const a=i[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((i,o)=>{var a,l,c;const u=(c=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[o])===null||c===void 0?void 0:c.resourceId;return u!=null?i[o]=this.resourceIdToCapturedInput[u]:i[o]=e[r++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const i=s[r],o=n[i];this.resourceIdToCapturedInput[o.resourceId]=e[r]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Ce(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function hpe(t,e={},n=WN){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=fpe(t));const s=new j$(t,e,n);return await s.load(),s}function dpe(t){if(t==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(t instanceof Array){const[s,r]=t;if(!s)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const i=Zy(s.weightsManifest),o=vI(s,i,r);e=e1(o)}else if("load"in t)e=t;else if("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t)e=e1(t);else throw new Error("Unknown model format");const n=new j$(e);return n.load(),n}function fpe(t){return t.endsWith("/")||(t=t+"/"),`${t}${upe}${cpe}`}/** @license See the LICENSE file. */const wW="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function ppe(t,e){return d1(t,e)}function d1(t,e,n=new Map,s=new Set){if(t==null)return null;if(typeof Blob=="function"&&t instanceof Blob)return t.slice();if(s.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse)if(ph(t)){const i=Array.isArray(t)?[]:{};s.add(t);for(const o in t){const a=t[o],l=d1(a,e,n,s);i[o]=l}return s.delete(t),t.__proto__&&(i.__proto__=t.__proto__),i}else throw new Error(`Can't recurse into non-iterable type: ${t}`);else return n.set(t,r.value),r.value}function mpe(t,e=SW){return vW(t,e)}function vW(t,e,n=new Set){const s=t[0];if(n.has(s))throw new Error("Circular references are not supported.");const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse)if(ph(s)){const i=Array.isArray(s)?[]:{};n.add(s);for(const o in s){const a=t.map(c=>c[o]),l=vW(a,e,n);i[o]=l}return n.delete(s),i}else throw new Error(`Can't recurse into non-iterable type: ${s}`);else return r.value}function SW(t){return t===null?null:ph(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function kW(t,e){const n=new Map;d1(t,e,n);for(const r of Array.from(n.keys())){const i=n.get(r);if(ko(i)){const o=await i;n.set(r,o)}}return d1(t,e,n)}function ph(t){let e=!1;if(K().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:n}=require("string_decoder");e=t instanceof n}return t!=null&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||typeof t=="object"&&!(t instanceof je)&&!(t instanceof Promise)&&!e)}function gpe(t){return t==null||xpe(t)||Array.isArray(t)||typeof t=="object"&&t instanceof je||on(t)}function xpe(t){return t===null||typeof t!="object"&&typeof t!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function ype(t){return ppe(t,bpe)}function bpe(t){return t instanceof je?{value:t.clone(),recurse:!1}:ph(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class CW{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,n){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=n}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const n of e)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+e),s=this.get(n);return this.set(n,this.pop()),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Ov extends CW{constructor(){super(Ov.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=this.capacity*2,n=new Array(e),s=this.length();for(let r=0;r<s;r++)n[r]=this.get(this.wrap(this.begin+r));this.data=n,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=s}}Ov.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function TW(t){return new Spe(t)}function H$(t){return new kpe(t)}function wpe(t,e){return new IW(t,e)}function vpe(t,e=aa.FAIL){return new Ape(t,e)}class kn{async toArray(){const e=[];let n=await this.next();for(;!n.done;)e.push(n.value),n=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),n=[];let s=await e.next();for(;!s.done;)n.push(s.value),s=await e.next();return n}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let n=await this.next(),s=e(n.value);for(;!n.done&&s;)n=await this.next(),s=e(n.value)}handleErrors(e){return new Epe(this,e)}filter(e){return new _pe(this,e)}map(e){return new $pe(this,e)}mapAsync(e){return new UO(this,e)}serialMapAsync(e){return new UO(this,e).serial()}flatmap(e){return new Dpe(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(n=>n===!0)}rowMajorBatch(e,n=!0){return new Npe(this,e,n)}columnMajorBatch(e,n=!0,s=SW){return this.rowMajorBatch(e,n).map(i=>mpe(i,s))}concatenate(e,n){return new IW(TW([this,e]),n)}take(e){return e<0||e==null?this:new Ipe(this,e)}skip(e){return e<0||e==null?this:new Tpe(this,e)}prefetch(e){return new NW(this,e)}shuffle(e,n){return new Rpe(this,e,n)}serial(){return new Cpe(this)}}class Spe extends kn{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:ype(e),done:!1}}}class kpe extends kn{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}}class Cpe extends kn{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class Tpe extends kn{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;Ce(e.value)}return this.upstream.next()}}class Ipe extends kn{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class Npe extends kn{constructor(e,n,s=!0){super(),this.upstream=e,this.batchSize=n,this.enableSmallLastBatch=s,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const n=await this.upstream.next();if(n.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(n.value)}return{value:e,done:!1}}}class _pe extends kn{constructor(e,n){super(),this.upstream=e,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;Ce(e.value)}}}class $pe extends kn{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=To(e.value),s=this.transform(e.value),r=To(s);for(const i of n)Iw(i,r)||i.dispose();return{value:s,done:!1}}}class Epe extends kn{constructor(e,n){super(),this.upstream=e,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}}class UO extends kn{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=To(e.value),s=await this.transform(e.value),r=To(s);for(const i of n)Iw(i,r)||i.dispose();return{value:s,done:!1}}}class G$ extends kn{constructor(){super(),this.outputQueue=new Ov,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class Dpe extends G${constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const n=To(e.value),s=this.transform(e.value),r=To(s);this.outputQueue.pushAll(s);for(const i of n)Iw(i,r)||i.dispose();return!0}}class IW extends kn{constructor(e,n){super(),this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){const s=await this.moreIterators.next();if(s.done)return{value:null,done:!0};this.iterator=s.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(e)):n}}var aa;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(aa||(aa={}));class Ape extends kn{constructor(e,n=aa.FAIL){super(),this.iterators=e,this.mismatchMode=n,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let n=0,s=0;function r(o){return o instanceof kn?{value:o.next().then(l=>(n++,l.done&&s++,l.value)),recurse:!1}:{value:null,recurse:!0}}const i=await kW(this.iterators,r);if(n===s)return{value:null,done:!0};if(s>0)switch(this.mismatchMode){case aa.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case aa.SHORTEST:return{value:null,done:!0};case aa.LONGEST:}return this.count++,{value:i,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class NW extends kn{constructor(e,n){super(),this.upstream=e,this.bufferSize=n,this.buffer=new CW(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class Rpe extends NW{constructor(e,n,s){super(e,n),this.upstream=e,this.windowSize=n,this.upstreamExhausted=!1,this.random=$d.alea(s||_n().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),n=await this.buffer.shuffleExcise(e);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Fd{constructor(){this.size=null}batch(e,n=!0){const s=this;N(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return this.size===1/0||this.size==null?r=this.size:n?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),$s(async()=>(await s.iterator()).columnMajorBatch(e,n,Fpe),r)}concatenate(e){const n=this;let s;return this.size===1/0||e.size===1/0?s=1/0:this.size!=null&&e.size!=null?s=this.size+e.size:s=null,$s(async()=>(await n.iterator()).concatenate(await e.iterator()),s)}filter(e){const n=this;let s;return this.size===1/0?s=1/0:s=null,$s(async()=>(await n.iterator()).filter(r=>q(()=>e(r))),s)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const n=this;return $s(async()=>(await n.iterator()).map(s=>q(()=>e(s))),this.size)}mapAsync(e){const n=this;return $s(async()=>(await n.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return $s(async()=>(await n.iterator()).prefetch(e),this.size)}repeat(e){const n=this;let s;return this.size!=null&&e>0?s=this.size*e:e===0?s=0:this.size!=null&&(e===void 0||e<0)?s=1/0:s=null,$s(async()=>{const r=H$(async()=>({value:await n.iterator(),done:!1}));return wpe(r.take(e))},s)}skip(e){const n=this;let s;return this.size!=null&&e>=0&&this.size>=e?s=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?s=0:s=null,$s(async()=>(await n.iterator()).skip(e),s)}shuffle(e,n,s=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,i=$d.alea(n||_n().toString());return $s(async()=>{let o=i.int32();return s&&(o+=i.int32()),(await r.iterator()).shuffle(e,o.toString())},this.size)}take(e){const n=this;let s;return this.size!=null&&this.size>e?s=e:this.size!=null&&this.size<=e?s=this.size:s=null,$s(async()=>(await n.iterator()).take(e),s)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}Fd.MAX_BUFFER_SIZE=1e4;function $s(t,e=null){return new class extends Fd{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function Ope(t){return $s(async()=>TW(t),t.length)}function Ppe(t){if(!ph(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let n=0;n<t.length;n++)e=e==null?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(const n in t)e=e==null?t[n].size:Math.min(e,t[n].size);return $s(async()=>{const n=await kW(t,s=>{if(s instanceof Fd)return{value:s.iterator(),recurse:!1};if(ph(s))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return vpe(n,aa.SHORTEST)},e)}function Fpe(t){if(t===null)return null;const e=t[0];return gpe(e)?{value:Mpe(t),recurse:!1}:{value:null,recurse:!0}}function Mpe(t){if(t.length===0)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof je?is(t):Bs(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class _W extends Fd{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(r=>(r.endsWith("\r")&&(r=r.slice(0,-1)),r))}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const H0='"',cf=Symbol("out"),jO=Symbol("field"),G0=Symbol("quote"),K2=Symbol("quoteafterquote"),HO=Symbol("quoteinquote");class $W extends Fd{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&N(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);const n=this.fullColumnNames.reduce((r,i)=>(r[i]=r[i]+1||1,r),{}),s=Object.keys(n).filter(r=>n[r]>1);if(N(s.length===0,()=>"Duplicate column names found: "+s.toString()),this.columnConfigs){for(const r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const n=await(await this.base.iterator()).next();if(n.done)throw new Error("No data was found for CSV parsing.");const s=n.value;return this.parseRow(s,!1)}else return null}constructor(e,n){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new _W(e),n||(n={}),this.hasHeader=n.hasHeader!==!1,this.fullColumnNames=n.columnNames,this.columnConfigs=n.columnConfigs,this.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(N(n.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=n.delimiter?n.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(n=>this.makeDataElement(n))}makeDataElement(e){const n=this.parseRow(e),s={},r={};for(let i=0;i<this.fullColumnNames.length;i++){const o=this.fullColumnNames[i],a=this.columnConfigs?this.columnConfigs[o]:null;if(!(this.configuredColumnsOnly&&!a)){const l=n[i];let c=null;if(l==="")if(a&&a.default!==void 0)c=a.default;else{if(a&&(a.required||a.isLabel))throw new Error(`Required column ${o} is empty in this line: ${e}`);c=void 0}else{const u=Number(l);if(isNaN(u))a&&a.dtype==="bool"?c=this.getBoolean(l):c=l;else if(!a||!a.dtype)c=u;else switch(a.dtype){case"float32":c=u;break;case"int32":c=Math.floor(u);break;case"bool":c=this.getBoolean(l);break;default:c=u}}a&&a.isLabel?r[o]=c:s[o]=c}}return Object.keys(r).length===0?s:{xs:s,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,n=!0){const s=[];let r=0;const i=e.length;let o=cf;for(let a=0;a<i;a++)switch(o){case cf:switch(e.charAt(a)){case H0:r=a+1,o=G0;break;case this.delimiter:if(r=a+1,this.delimiter===" "&&this.delimWhitespace)break;s.push(""),o=cf;break;default:o=jO,r=a;break}break;case jO:switch(e.charAt(a)){case this.delimiter:s.push(e.substring(r,a)),o=cf,r=a+1;break}break;case G0:switch(e.charAt(a)){case H0:o=K2;break}break;case K2:switch(e.charAt(a)){case this.delimiter:s.push(e.substring(r,a-1)),o=cf,r=a+1;break;case H0:o=G0;break;default:o=HO;break}break;case HO:switch(e.charAt(a)){case H0:o=G0;break}break}if(o===K2?s.push(e.substring(r,i-1)):s.push(e.substring(r)),n&&s.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${s}`);return s}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class q$ extends kn{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;const n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=e.includeSpectrogram!==!1,this.includeWaveform=e.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!K().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const n=new q$(e);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(s){throw new Error(`Error thrown while initializing video stream: ${s.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,n;const s=await this.getAudioData();if(this.includeSpectrogram){const r=this.flattenQueue(s.freqDataQueue);e=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const r=this.flattenQueue(s.timeDataQueue);n=this.getTensorFromAudioDataArray(r,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:n},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const e=[],n=[];let s=0;return new Promise(r=>{const i=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:n}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++s===this.numFrames&&(clearInterval(i),r({freqDataQueue:e,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){const n=e[0].length,s=new Float32Array(e.length*n);return e.forEach((r,i)=>s.set(r,i*n)),s}getTensorFromAudioDataArray(e,n){const s=new Float32Array(Q(n));return s.set(e,s.length-e.length),Bs(s,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class K$ extends kn{constructor(e,n){if(super(),this.webcamVideoElement=e,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=xn([0],"int32"),this.webcamConfig.centerCrop){const s=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,i=(1-s)/2,o=(1-r)/2,a=i+s,l=r+o;this.cropBox=ka([o,i,l,a],[1,4])}else this.cropBox=ka([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,n={}){if(!K().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=n.resizeWidth,e.height=n.resizeHeight}const s=new K$(e,n);return await s.start(),s}async start(){this.webcamConfig.facingMode&&N(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=bV(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{e.dispose()}else return{value:e,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(e){return q(()=>{const n=$n(ae(e,"float32"),0);let s;s=Er.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=s.shape;return U(s,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class EW{}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class DW extends kn{split(e){return new Lpe(this,e)}}class Lpe extends DW{constructor(e,n){super(),this.upstream=e,this.impl=new zpe(e,n)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class zpe extends G${constructor(e,n){super(),this.upstream=e,this.separator=n,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const n=e.value.split(this.separator);n[0]=this.carryover+n[0];for(const s of n.slice(0,-1))this.outputQueue.push(s);return this.carryover=n[n.length-1],!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Bpe extends kn{decodeUTF8(){return new Vpe(this)}}class Vpe extends DW{constructor(e){super(),this.upstream=e,this.impl=new Wpe(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class Wpe extends G${constructor(e){if(super(),this.upstream=e,K().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:n}=require("string_decoder");this.decoder=new n("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const e=await this.upstream.next();let n;if(e.done)return!1;n=e.value;let s;return K().get("IS_BROWSER")?s=this.decoder.decode(n,{stream:!0}):s=this.decoder.write(Buffer.from(n.buffer)),this.outputQueue.push(s),!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class AW extends Bpe{constructor(e,n={}){super(),this.file=e,this.options=n,N(e instanceof Uint8Array||(K().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=n.offset||0,this.chunkSize=n.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((n,s)=>{const r=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)n(new Uint8Array(this.file.slice(this.offset,r)));else{const i=new FileReader;i.onload=a=>{let l=i.result;if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),!(l instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));n(l)},i.onabort=a=>s(new Error("Aborted")),i.onerror=a=>s(new Error(a.type));const o=this.file.slice(this.offset,r);i.readAsArrayBuffer(o)}this.offset=r}),done:!1}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */async function Upe(t,e={},n){let s,r;typeof t=="string"?s=t:(s=t.url,r=jpe(t));const i=await Mz(s,r);if(i.ok){const o=new Uint8Array(await i.arrayBuffer());return new AW(o,e)}else throw new Error(i.statusText)}const jpe=t=>({method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function RW(t){return typeof t=="string"&&t.slice(0,7)==="file://"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class OW extends EW{constructor(e,n={}){super(),this.input=e,this.options=n}async iterator(){if(RW(this.input)&&K().get("IS_NODE")){const e=require("fs");this.input=e.readFileSync(this.input.slice(7))}return new AW(this.input,this.options)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class PW extends EW{constructor(e,n={}){super(),this.url=e,this.fileOptions=n}async iterator(){return RW(this.url)?new OW(this.url,this.fileOptions).iterator():Upe(this.url,this.fileOptions)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function Hpe(t,e={}){return new $W(new PW(t),e)}function Gpe(t){const e=H$(t);return $s(async()=>e)}function qpe(t){return $s(async()=>{const e=await t();return H$(()=>e.next())})}async function Kpe(t,e){return K$.create(t,e)}async function Xpe(t){return q$.create(t)}/** @license See the LICENSE file. */const FW="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ype=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:$W,Dataset:Fd,FileDataSource:OW,TextLineDataset:_W,URLDataSource:PW,array:Ope,csv:Hpe,func:Gpe,generator:qpe,microphone:Xpe,version_data:FW,webcam:Kpe,zip:Ppe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function me(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&N(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qpe=Jw;class t0 extends gb{nextDataId(){return t0.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new iI(this,jr())}write(e,n,s){this.firstUse&&(this.firstUse=!1,K().get("IS_NODE")&&Js(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Ci(s[0])){const i=s.map(o=>$i(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,i){this.data.set(e,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return _o(r,i)}return vz(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Co(r));return De(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return De(e.shape,e.dtype,n)}makeOutput(e,n,s){return jr().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=_n();return e(),{kernelMs:_n()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){me([e],"where");const n=this.readSync(e.dataId);return Qpe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}t0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Zpe=t=>{const{x:e}=t.inputs,n=t.backend;me(e,"abs");let s=new Float32Array(Q(e.shape));const r=n.data.get(e.dataId).values;return s=MW(r),n.makeOutput(s,e.shape,e.dtype)},Jpe={kernelName:wm,backendName:"cpu",kernelFunc:Zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qt(t){return(e,n,s,r,i)=>{const o=Te(e,n),a=o.length,l=we(o),c=Q(o),u=vn(i,c),h=e.length,d=n.length,f=we(e),p=we(n),g=xc(e,o),m=xc(n,o);if(g.length+m.length===0)for(let x=0;x<u.length;++x)u[x]=t(s[x%s.length],r[x%r.length]);else for(let x=0;x<u.length;++x){const y=Vc(x,a,l),b=y.slice(-h);g.forEach(T=>b[T]=0);const w=Zr(b,h,f),v=y.slice(-d);m.forEach(T=>v[T]=0);const S=Zr(v,d,p);u[x]=t(s[w],r[S])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rs(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const eme={kernelName:Tb,backendName:"cpu",kernelFunc:Rs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f1(t,e,n="float32"){if(n==="complex64"){const r=f1(t,e,"float32"),i=f1(t,e,"float32");return Rs({inputs:{real:r,imag:i},backend:t})}const s=On(Q(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zi(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const tme={kernelName:Kh,backendName:"cpu",kernelFunc:zi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cc(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const nme={kernelName:rw,backendName:"cpu",kernelFunc:Cc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Ja([0],n),[i,o]=qt((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Ua(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return zi({inputs:{x:r},backend:n});const u=f1(n,r.shape,r.dtype),h=Ua({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),d=Rs({inputs:{real:h,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),d}if(r.dtype==="complex64"){const u=Cc({inputs:{input:r},backend:n}),h=Ua({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),h}if(!lI(r.dtype,i)){const u=zi({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=LW(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const sme={kernelName:Ph,backendName:"cpu",kernelFunc:Ua};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dn(t,e,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;me([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,h=o.dtype==="string"?$o(c):c,d=o.dtype==="string"?$o(u):u,f=s||o.dtype,[p,g]=e(o.shape,a.shape,h,d,f);return l.makeTensorInfo(g,f,p)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=Ua({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,f=l.data.get(h.dataId).values,p=l.data.get(d.dataId).values,g=Ua({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),m=l.data.get(g.dataId),x=m.complexTensorInfos.real,y=m.complexTensorInfos.imag,b=l.data.get(x.dataId).values,w=l.data.get(y.dataId).values,[v,S,T]=n(o.shape,a.shape,f,p,b,w),k=l.makeTensorInfo(T,"float32",v),I=l.makeTensorInfo(T,"float32",S),_=Rs({inputs:{real:k,imag:I},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(k),l.disposeIntermediateTensorInfo(I),_}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,h=s||o.dtype,[d,f]=e(o.shape,a.shape,c,u,h);return l.makeTensorInfo(f,h,d)}}}function X$(t){return(e,n,s,r,i,o)=>{const a=Te(e,n),l=Q(a),c=a.length,u=we(a),h=vn("float32",l),d=vn("float32",l),f=xc(e,a),p=xc(n,a),g=_o(s,r),m=_o(i,o),x=e.length,y=we(e),b=n.length,w=we(n);if(f.length+p.length===0)for(let v=0;v<h.length;v++){const S=v%g.length,T=v%m.length,k=t(g[S*2],g[S*2+1],m[T*2],m[T*2+1]);h[v]=k.real,d[v]=k.imag}else for(let v=0;v<h.length;v++){const S=Vc(v,c,u),T=S.slice(-x);f.forEach(A=>T[A]=0);const k=Zr(T,x,y),I=S.slice(-b);p.forEach(A=>I[A]=0);const _=Zr(I,b,w),D=t(g[k*2],g[k*2+1],m[_*2],m[_*2+1]);h[v]=D.real,d[v]=D.imag}return[h,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zW=qt((t,e)=>t+e),rme=X$((t,e,n,s)=>({real:t+n,imag:e+s})),mh=dn(Wc,zW,rme),ime={kernelName:Wc,backendName:"cpu",kernelFunc:mh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$(t,e,n,s,r){const i=Q(s),o=On(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function BW(t,e,n,s=!1){const r=t.shape[0],i=t.shape[1],o=De([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VW=qt((t,e)=>t&e),ome=dn(_m,VW),ame={kernelName:_m,backendName:"cpu",kernelFunc:ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wi(t){return(e,n,s)=>{const r=Ot(n,e.length);for(let i=0;i<e.length;++i)r[i]=t(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Je(t,e,n){const s=Wi(e);return al(t,s,n)}function al(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;me(o,t);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=$o(l)}else c=l;const u=n||o.dtype,h=e(c,u,r);return a.makeTensorInfo(o.shape,u,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WW=Wi(t=>Math.ceil(t)),lme=al(Fh,WW),cme={kernelName:Fh,backendName:"cpu",kernelFunc:lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(t,e,n,s){const r=Ot(n,Q(e));if(s&&n!=="string"){let i=0;t.forEach(o=>{const a=Q(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?$o(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let h=0;h<o.shape[1];++h)r[u+h]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jW=qt((t,e)=>t===e?1:0),HW=dn(Mm,jW,null,"bool"),ume={kernelName:Mm,backendName:"cpu",kernelFunc:HW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GW=Wi(t=>Math.exp(t)),qW=al(Uh,GW,"float32"),hme={kernelName:Uh,backendName:"cpu",kernelFunc:qW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KW=Wi(t=>Math.expm1(t)),dme=al(jh,KW),fme={kernelName:jh,backendName:"cpu",kernelFunc:dme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XW=Wi(t=>Math.floor(t)),pme=al(Hh,XW),mme={kernelName:Hh,backendName:"cpu",kernelFunc:pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YW=qt((t,e)=>Math.floor(t/e)),gme=dn(Gh,YW,null,"int32"),xme={kernelName:Gh,backendName:"cpu",kernelFunc:gme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(t,e,n,s,r,i,o,a,l){const c=De([s,i],n);for(let u=0;u<s;u++){const h=[];let d=0;for(let f=0;f<r;f++){const p=t[u*r+f];d+=p*o[f],h.push(p)}if(d<0||d>=l/i)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=e.get(...e.indexToLoc(d*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,e,n){const s=De(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JW=qt((t,e)=>t>e?1:0),yme=dn(Vm,JW,null,"bool"),bme={kernelName:Vm,backendName:"cpu",kernelFunc:yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e6=qt((t,e)=>t>=e?1:0),wme=dn(qh,e6,null,"bool"),vme={kernelName:qh,backendName:"cpu",kernelFunc:wme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t6=qt((t,e)=>t<e?1:0),Sme=dn(Um,t6,null,"bool"),kme={kernelName:Um,backendName:"cpu",kernelFunc:Sme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n6=qt((t,e)=>t<=e?1:0),Cme=dn(jm,n6,null,"bool"),Tme={kernelName:jm,backendName:"cpu",kernelFunc:Cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6(t,e,n){const s=(e-t)/(n-1),r=On(n,"float32");r[0]=t;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r6=Wi(t=>Math.log(t)),Ime=al(Zh,r6),Nme={kernelName:Zh,backendName:"cpu",kernelFunc:Ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6(t,e,n,s){const r=vn(s,Q(n));for(let i=0;i<r.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6=qt((t,e)=>Math.max(t,e)),_me=dn(ed,o6),$me={kernelName:ed,backendName:"cpu",kernelFunc:_me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a6=qt((t,e)=>Math.min(t,e)),Eme=dn(td,a6),Dme={kernelName:td,backendName:"cpu",kernelFunc:Eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q$=qt((t,e)=>t*e),Ame=X$((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),Pv=dn(sd,Q$,Ame),Rme={kernelName:sd,backendName:"cpu",kernelFunc:Pv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l6(t,e,n){const s=Ao(-1,n);return Q$([],e,s,t,n)}function Ome(t){const{inputs:e,backend:n}=t,{x:s}=e;me(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=l6(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const Pme={kernelName:tg,backendName:"cpu",kernelFunc:Ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c6=qt((t,e)=>t!==e?1:0),Fme=dn(ng,c6,null,"bool"),Mme={kernelName:ng,backendName:"cpu",kernelFunc:Fme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$(t,e,n,s,r){const i=e.length,o=Q(e),a=we(e),l=we(r),c=vn(n,Q(r));for(let u=0;u<o;++u){const h=Vc(u,i,a),d=new Array(h.length);for(let p=0;p<d.length;p++)d[p]=h[s[p]];const f=Zr(d,i,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ss(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:i}=n;me(r,"transpose");const o=r.shape.length,a=new Array(o);for(let h=0;h<a.length;h++)a[h]=r.shape[i[h]];const l=s.data.get(r.dataId).values,c=Z$(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const Lme={kernelName:ql,backendName:"cpu",kernelFunc:Ss};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u6(t,e,n,s){const[r,i]=Tn(t,s),o=xs(e,"int32"),a=On(Q(r),o),l=Q(i);for(let c=0;c<a.length;++c){const u=c*l;let h=1;for(let d=0;d<l;++d)h*=n[u+d];a[c]=h}return{outVals:a,outShape:r,outDtype:o}}function zme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;me(r,"prod");const a=r.shape.length,l=Oe(i,r.shape),c=Et(l,a);let u=l,h=r;const d=[];c!=null&&(h=Ss({inputs:{x:r},backend:n,attrs:{perm:c}}),d.push(h),u=Ht(u.length,a));const f=n.data.get(h.dataId).values,{outVals:p,outShape:g,outDtype:m}=u6(h.shape,h.dtype,f,u);let x=g;return o&&(x=Wt(g,l)),d.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(x,m,p)}const Bme={kernelName:lg,backendName:"cpu",kernelFunc:zme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vme(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const i=Vc(r,e.length,we(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function Wme(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function Ume(t,e,n,s){const r=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);Wme(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let h=1;h<l+1;++h)a[c].push(h*u)}for(let c=0;c<t.length;++c){let u=t[c],h=t[c]+1;for(let d=0;d<n.length;++d){const f=n[d],p=d+e.length-1;if(p>=0){const g=a[p],m=g[g.length-1]-f[u];for(let x=u;x<h;++x)a[p].push(f[x+1]+m)}u=f[u],h=f[h]}h!==u&&(r.push([u,h]),i+=h-u)}return{outSplits:a,valueSlices:r,numValues:i}}function jme(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Ot("int32",s);e.push(r),t[n].forEach((i,o)=>r[o]=i)}return e}function GO(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function Hme(t,e,n,s,r,i){const o=GO(e,2)[1],a=GO(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let h=0;h<s;++h)r[l*a+h]=t[u*o+h];++l}}function Gme(t,e,n,s,r){const i=e.slice();i[0]=r;const o=Ot(n,Q(i)),a=t.length,l=a===0?0:a/e[0];return Hme(t,e,s,l,o,i),[o,i]}function h6(t,e,n,s,r,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Vme(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:h,numValues:d}=Ume(i,o,t,c),f=jme(u),p=Gme(n,s,r,h,d);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qO=2147483647;function d6(t,e,n,s,r,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(o[0]);for(let m=1;m<u.length;++m)if(u[m]!==u[m-1])throw new Error("starts, limits, and deltas must have the same shape");const h=u.length===0?1:u[0],d=Ot("int32",h+1);d[0]=0;for(let m=0;m<h;++m){const x=a?t[0]:t[m],y=l?s[0]:s[m],b=c?i[0]:i[m];if(b===0)throw new Error("Requires delta != 0");let w;if(b>0&&y<x||b<0&&y>x)w=0;else if(w=Math.ceil(Math.abs((y-x)/b)),w>qO)throw new Error(`Requires ((limit - start) / delta) <= ${qO}`);d[m+1]=d[m]+w}const f=d[h],p=Ot(n,f);let g=0;for(let m=0;m<h;++m){const x=d[m+1]-d[m];let y=a?t[0]:t[m];const b=c?i[0]:i[m];for(let w=0;w<x;++w)p[g++]=y,y+=b}return[d,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var yr=Kr;class p1{constructor(e,n,s,r,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=AV(u),this.raggedRank=RV(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===yr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===yr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case yr.VALUE_ROWIDS:return p1.getMaxWidthValueRowID(n);case yr.ROW_SPLITS:return p1.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${yr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return XO(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;OV(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=DV(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<e;++a)i.push(-1);return N(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,s,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let h=0;h<c;++h)o.push(u),u+=s;for(let h=0;h<l-c;++h)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const h=e[u];if(h===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=h,h>=n.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${n.length}`);c=n[h]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case yr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case yr.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${yr[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case yr.FIRST_DIM_SIZE:return e[0];case yr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case yr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${yr[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=XO(s,!1),o=Ot(this.valuesDType,Q(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(e+1);const l=Q(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;q(()=>{const g=U(u,p);u=Kl(g,a).dataSync()})}let h=0,d=0,f=0;for(let p=0;p<=c;++p){let g=p<c?n[p]:-1;if(g===f){++f;continue}if(d<f){const m=i.subarray(h*l),x=o.subarray(d*l),y=(f-d)*l;KO(x,m,y)}if(p>=c){const m=s.length;g=Math.floor(m/l)}if(g>f)if(this.defaultValue.length===1)o.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;){const m=o.slice(f*l);KO(m,u,l),++f}g<0?(h=p+1,d=f):(h=p,d=f,f=d+1)}}}function KO(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function XO(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function f6(t,e,n,s,r,i,o,a,l,c){return new p1(t,e,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p6(t,e,n,s){const r=t===e,i=t<e&&n<0,o=e<t&&n>1;if(r||i||o)return On(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=On(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m6=Wi(t=>1/Math.sqrt(t)),qme=al(cd,m6),Kme={kernelName:cd,backendName:"cpu",kernelFunc:qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bl(t,e,n,s,r,i,o,a,l,c){const u=[s/r,r],h=t.values,d=e.values;if(s===0)return De(n,e.dtype);const f=l instanceof nn?l:De(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const g=[];let m=0;for(let x=0;x<o;x++){const y=h[p*o+x];g.push(y),m+=y*a[x]}if(m<0||m>=s/r)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let x=0;x<r;x++)c?f.values[m*r+x]+=d[p*r+x]:f.values[m*r+x]=e.rank===0?d[0]:d[p*r+x]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xme=Wi(t=>1/(1+Math.exp(-t))),g6=Je(pd,t=>1/(1+Math.exp(-t))),Yme={kernelName:pd,backendName:"cpu",kernelFunc:g6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x6(t,e,n,s,r){const i=HN(s,e,n),o=Q(n),a=we(s);if(i){const h=GN(e,a);return r==="string"?t.slice(h,h+o):t.subarray(h,h+o)}const l=r==="string"?$o(t):t,c=De(s,r,l),u=De(n,r);for(let h=0;h<u.size;++h){const d=u.indexToLoc(h),f=d.map((p,g)=>p+e[g]);u.set(c.get(...f),...d)}return r==="string"?e5(u.values):u.values}function Tc(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s;me(r,"slice");const[a,l]=uv(r,i,o);UN(r,a,l);const c=n.data.get(r.dataId).values,u=x6(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const Qme={kernelName:pg,backendName:"cpu",kernelFunc:Tc};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y6(t,e,n,s,r,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),h=e[1];if(l===0){if(a!==0)throw new Error(VV(a));const m=Ot(n,0),x=Ot(r,0);return[m,[0,h],x,c,u]}let d=!0,f=0;const p=new Array(l).fill(0);for(let m=0;m<a;++m){const x=t[m*h];if(x<0)throw new Error(WV(m,x));if(x>=l)throw new Error(UV(m,x,l));++p[x],d=d&&x>=f,f=x}let g=!0;for(let m=0;m<l;++m){const x=p[m]===0;c[m]=x,g=g&&!x,p[m]=Math.max(p[m],1),m>0&&(p[m]+=p[m-1])}if(g&&d){const m=t,x=s;for(let y=0;y<a;++y)u[y]=y;return[m,[a,h],x,c,u]}else{const m=p[l-1],x=Ot(n,m*h),y=Ot(r,m),b=new Array(l).fill(0);for(let w=0;w<a;++w){const v=t[w*h],S=b[v],T=(v===0?0:p[v-1])+S;b[v]++;for(let k=0;k<h;++k)x[T*h+k]=t[w*h+k];y[T]=s[w],u[w]=T}for(let w=0;w<l;++w)if(b[w]===0){const S=w===0?0:p[w-1];x[S*h+0]=w;for(let T=1;T<h;++T)x[S*h+T]=0;y[S]=o}return[x,[m,h],y,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b6(t,e,n,s,r){const i=Q(s),o=e[0],a=r.length,l=[];let c=1,u=-1;for(let m=0;m<a;++m){const x=r[m];if(x===-1){if(u!==-1)throw new Error(jV(u,m));u=m,l.push(1)}else{if(x<0)throw new Error(HV(m,x));c*=x,l.push(x)}}if(u!==-1){if(c<=0)throw new Error(GV());const m=Math.trunc(i/c);if(c*m!==i)throw new Error(qV(s,l));l[u]=m}if(Q(l)!==i)throw new Error(KV(s,l));const d=s.length,f=[];if(d>0){f[d-1]=1;for(let m=d-2;m>=0;--m)f[m]=f[m+1]*s[m+1]}const p=[];if(a>0){p[a-1]=1;for(let m=a-2;m>=0;--m)p[m]=p[m+1]*l[m+1]}const g=Ot(n,o*a);for(let m=0;m<o;++m){let x=0;for(let y=0;y<d;++y)x+=t[m*d+y]*f[y];for(let y=0;y<a;++y)g[m*a+y]=Math.trunc(x/p[y]),x%=p[y]}return[g,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$(t,e,n,s,r,i=!1,o=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],h=a>0?r[a-1]+1:0;if(h<0)throw new Error(Hk());const d=e.slice();d[0]=h;const f=d.reduce((b,w)=>b*w,1),p=Ot(n,f);if(a===0)return h>0&&p.fill(o),[p,d];if(h<=0)throw new Error(Hk());let g=0,m=1,x=0,y=r[g];for(;;){let b=0;if(m<a){if(b=r[m],y===b){++m;continue}if(y>=b)throw new Error(XV())}if(y<0||y>=h)throw new Error(YV(y,h));y>x&&p.fill(o,x*c,y*c);for(let w=g;w<m;++w){const v=s[w];if(v<0||v>=l[0])throw new Error(QV(w,s[w],l[0]));for(let S=0;S<c;S++)p[y*c+S]+=t[v*c+S]}if(i)for(let w=0;w<c;w++)p[y*c+w]/=m-g;if(g=m,++m,x=y+1,y=b,m>a)break}return x<h&&p.fill(o,x*c,h*c),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zme=Wi(t=>Math.sqrt(t)),Jme=Je(gd,t=>Math.sqrt(t)),ege={kernelName:gd,backendName:"cpu",kernelFunc:Jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w6=qt((t,e)=>{const n=t-e;return n*n}),tge=dn(xd,w6),nge={kernelName:xd,backendName:"cpu",kernelFunc:tge};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v6=Wi((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),sge=al(bg,v6),rge={kernelName:bg,backendName:"cpu",kernelFunc:sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(t,e,n,s){const r=De(t,e.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(e.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ige{constructor(e,n,s,r,i,o){this.separator=$i(e),this.nGramWidths=n,this.leftPad=$i(s),this.rightPad=$i(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),h=o-(c+u),d=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let y=0;y<h;++y)f+=e[d+y].length;f+=u*this.rightPad.length;const p=c+u+h-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const g=s[r+a];let m=0;const x=y=>y.forEach(b=>g[m++]=b);for(let y=0;y<c;++y)x(this.leftPad),x(this.separator);for(let y=0;y<h-1;++y)x(e[d+y]),x(this.separator);if(h>0){x(e[d+h-1]);for(let y=0;y<u;++y)x(this.separator),x(this.rightPad)}else{for(let y=0;y<u-1;++y)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=Ot("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(h=>{u+=this.getNumNGrams(c,h)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(h=>{const d=n[l+1]-n[l],f=this.getNumNGrams(d,h);this.createNGrams(e,c,a,u,f,h),u+=f}),this.preserveShort&&u===o[l]){const h=n[l+1]-n[l];if(h===0)continue;const d=h+2*this.padWidth;this.createNGrams(e,c,a,u,1,d)}}return[a,o]}}function k6(t,e,n,s,r,i,o,a){return new ige(n,s,r,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oge(t,e,n,s){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)s.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&s.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function C6(t,e,n){const s=t.length,r=[];let i=0,o=0;const a=new Array(s);for(let d=0;d<s;++d){const f=r.length;oge(t[d],e,n,r);const p=r.length-f;a[d]=p,i+=p,o=Math.max(o,p)}const l=Ot("int32",i*2),c=new Array(i),u=[s,o];let h=0;for(let d=0;d<s;++d)for(let f=0;f<a[d];++f)l[h*2]=d,l[h*2+1]=f,c[h]=r[h],++h;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t,e){const n=Ot("int32",t.length);for(let s=0;s<t.length;++s)n[s]=Fz(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I6=qt((t,e)=>t-e),age=X$((t,e,n,s)=>({real:t-n,imag:e-s})),eE=dn(yd,I6,age),lge={kernelName:yd,backendName:"cpu",kernelFunc:eE};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=De(n,t.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nf=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function _6(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),d=Math.max(n,Math.floor(e-l*u/a+h)),f=Math.min(s,Math.floor(e+(a-l)*u/a+h));_6(t,e,d,f)}const r=t[e];let i=n,o=s;for(eo(t,n,e),Nf(t[s],r)>0&&eo(t,n,s);i<o;){for(eo(t,i,o),i++,o--;Nf(t[i],r)<0;)i=i+1;for(;Nf(t[o],r)>0;)o=o-1}Nf(t[n],r)===0?eo(t,n,o):(o=o+1,eo(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function $6(t,e,n,s,r){const i=e[e.length-1],[o,a]=[t.length/i,i],l=vn(n,o*s),c=vn("int32",o*s);for(let h=0;h<o;h++){const d=h*a,f=t.subarray(d,d+a);let p=new Array(f.length);f.forEach((y,b)=>p[b]={value:y,index:b}),s<p.length&&(_6(p,s),p=p.slice(0,s)),r&&p.sort(Nf);const g=h*s,m=l.subarray(g,g+s),x=c.subarray(g,g+s);for(let y=0;y<s;y++)m[y]=p[y].value,x[y]=p[y].index}const u=e.slice();return u[u.length-1]=s,[De(u,n,l),De(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(t,e,n,s){const r=Oe(e,n)[0],i=[1,n[0],1];for(let p=0;p<r;p++)i[0]*=n[p];i[1]=n[r];for(let p=r+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[r]),l=new nn(i,s,t),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[r];p++){let g;if(u)g=t[p].toString();else{const x=[];for(let y=0;y<i[0];y++)for(let b=0;b<i[2];b++)x.push(l.get(y,p,b));g=x.join(",")}const m=o.get(g);if(m!=null)a[p]=m;else{const x=o.size;o.set(g,x),a[p]=x,c.push(p)}}const h=i.slice();h[1]=o.size;const d=new nn(h,s);c.forEach((p,g)=>{for(let m=0;m<i[0];m++)for(let x=0;x<i[2];x++)d.set(l.get(m,p,x),m,g,x)});const f=n.slice();return f[r]=h[1],{outputValues:d.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D6=Object.freeze(Object.defineProperty({__proto__:null,addImpl:zW,bincountImpl:Y$,bincountReduceImpl:BW,bitwiseAndImpl:VW,castImpl:LW,ceilImpl:WW,concatImpl:UW,equalImpl:jW,expImpl:GW,expm1Impl:KW,floorDivImpl:YW,floorImpl:XW,gatherNdImpl:QW,gatherV2Impl:ZW,greaterEqualImpl:e6,greaterImpl:JW,lessEqualImpl:n6,lessImpl:t6,linSpaceImpl:s6,logImpl:r6,maxImpl:i6,maximumImpl:o6,minimumImpl:a6,multiplyImpl:Q$,negImpl:l6,notEqualImpl:c6,prodImpl:u6,raggedGatherImpl:h6,raggedRangeImpl:d6,raggedTensorToTensorImpl:f6,rangeImpl:p6,rsqrtImpl:m6,scatterImpl:Bl,sigmoidImpl:Xme,simpleAbsImpl:MW,sliceImpl:x6,sparseFillEmptyRowsImpl:y6,sparseReshapeImpl:b6,sparseSegmentReductionImpl:J$,sqrtImpl:Zme,squaredDifferenceImpl:w6,staticRegexReplaceImpl:v6,stridedSliceImpl:S6,stringNGramsImpl:k6,stringSplitImpl:C6,stringToHashBucketFastImpl:T6,subImpl:I6,tileImpl:N6,topKImpl:$6,transposeImpl:Z$,uniqueImpl:E6},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const A6="4.21.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xI("cpu",()=>new t0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R6=Je(Vh,t=>t>=0?t:Math.exp(t)-1),cge={kernelName:Vh,backendName:"cpu",kernelFunc:R6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s;me([r],"leakyRelu");const o=Q(r.shape),a=n.data.get(r.dataId).values,l=vn("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const uge={kernelName:Wm,backendName:"cpu",kernelFunc:O6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hge=qt((t,e)=>t<0?e*t:t);function P6(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;me([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=hge(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const dge={kernelName:ag,backendName:"cpu",kernelFunc:P6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F6=Je(od,t=>Math.max(0,t)),fge={kernelName:od,backendName:"cpu",kernelFunc:F6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M6=Je(ad,t=>Math.min(Math.max(0,t),6)),pge={kernelName:ad,backendName:"cpu",kernelFunc:M6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1(t,e,n,s,r){if(n==="linear")return zi({inputs:{x:e},backend:t});if(n==="relu")return F6({inputs:{x:e},backend:t});if(n==="elu")return R6({inputs:{x:e},backend:t});if(n==="relu6")return M6({inputs:{x:e},backend:t});if(n==="prelu")return P6({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return O6({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return g6({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ut(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=Q(r.shape),a=aI(i,o),l=Q(a);N(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;u.shape=a,h.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const mge={kernelName:cg,backendName:"cpu",kernelFunc:ut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;me([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],h=a?i.shape[c-1]:i.shape[c-2],d=o?r.shape[l-1]:r.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=r.shape.slice(0,-2),g=i.shape.slice(0,-2),m=Q(p),x=Q(g),b=Te(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,f]);N(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const w=o?[m,u,d]:[m,d,u],v=a?[x,f,h]:[x,h,f],S=ut({inputs:{x:r},backend:n,attrs:{shape:w}}),T=ut({inputs:{x:i},backend:n,attrs:{shape:v}}),k=o?S.shape[1]:S.shape[2],I=o?S.shape[2]:S.shape[1],_=a?T.shape[1]:T.shape[2],D=Math.max(m,x),A=n.data.get(S.dataId).values,L=n.data.get(T.dataId).values,B=we(S.shape),F=we(T.shape),[R,O,E]=o?[B[0],1,B[1]]:[B[0],B[1],1],[V,G,Y]=a?[1,F[1],F[0]]:[F[1],1,F[0]],Z=I*_,ee=De([D,I,_],S.dtype),te=ee.values,ne=n.blockSize;for(let ie=0;ie<D;ie++){const ce=ie%m,ye=ie%x;for(let ve=0;ve<I;ve+=ne){const Ie=Math.min(ve+ne,I);for(let $e=0;$e<_;$e+=ne){const Ne=Math.min($e+ne,_);for(let Xe=0;Xe<k;Xe+=ne){const gt=Math.min(Xe+ne,k);for(let et=ve;et<Ie;et++)for(let Ye=$e;Ye<Ne;Ye++){let ht=0;for(let xt=Xe;xt<gt;xt++){const Ui=A[ce*R+et*O+xt*E],In=L[xt*V+Ye*G+ye*Y];ht+=Ui*In}te[ie*Z+(et*_+Ye)]+=ht}}}}}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(T),n.makeTensorInfo(b,ee.dtype,ee.values)}const gge={kernelName:Im,backendName:"cpu",kernelFunc:L6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xge(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;let d,f,p;const g=[];d=L6({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=mh({inputs:{a:d,b:o},backend:n}),g.push(d),d=f),u&&(p=m1(n,d,u,a,h),g.push(d),d=p);for(const x of g)n.disposeIntermediateTensorInfo(x);return d}const yge={kernelName:Fp,backendName:"cpu",kernelFunc:xge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge=Je(_h,t=>Math.acos(t)),wge={kernelName:_h,backendName:"cpu",kernelFunc:bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vge=Je($h,t=>Math.acosh(t)),Sge={kernelName:$h,backendName:"cpu",kernelFunc:vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kge(t){const{inputs:e,backend:n}=t,s=e;me(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=De(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Cge={kernelName:vm,backendName:"cpu",kernelFunc:kge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;me(r,"all");const a=Oe(i,r.shape);let l=a;const c=Et(l,r.shape.length);let u=r;c!=null&&(u=Ss({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Ht(l.length,r.shape.length)),Mn("all",l,u.shape.length);const[h,d]=Tn(u.shape,l),f=Q(d),p=On(Q(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=g[y];for(let w=0;w<f;++w){const v=g[y+w];b=b&&v}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const x=Wt(h,a),y=ut({inputs:{x:m},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(m),y}return m}const Ige={kernelName:bb,backendName:"cpu",kernelFunc:Tge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;me(r,"any");const a=Oe(i,r.shape);let l=a;const c=Et(l,r.shape.length);let u=r;c!=null&&(u=Ss({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Ht(l.length,r.shape.length)),Mn("any",l,u.shape.length);const[h,d]=Tn(u.shape,l),f=Q(d),p=On(Q(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=g[y];for(let w=0;w<f;++w){const v=g[y+w];b=b||v}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const x=Wt(h,a),y=ut({inputs:{x:m},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(m),y}return m}const _ge={kernelName:wb,backendName:"cpu",kernelFunc:Nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;me(r,"argMax");let o=Oe(i,r.shape);const a=Et(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Ss({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Ht(o.length,l.shape.length)),o=[o[0]],Mn("argMax",o,l.shape.length);const[u,h]=Tn(l.shape,o),d=Q(u),f=On(d,"int32"),p=Q(h),g=n.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const x=m*p;let y=g[x],b=0;for(let w=0;w<p;++w){const v=g[x+w];v>y&&(y=v,b=w)}f[m]=b}return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(u,"int32",f)}const Ege={kernelName:Sm,backendName:"cpu",kernelFunc:$ge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;me(r,"argMin");let o=Oe(i,r.shape);const a=Et(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Ss({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Ht(o.length,l.shape.length)),o=[o[0]],Mn("argMin",o,l.shape.length);const[u,h]=Tn(l.shape,o),d=Q(u),f=On(d,"int32"),p=Q(h),g=n.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const x=m*p;let y=g[x],b=0;for(let w=0;w<p;++w){const v=g[x+w];v<y&&(y=v,b=w)}f[m]=b}return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(u,"int32",f)}const Age={kernelName:km,backendName:"cpu",kernelFunc:Dge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rge=Je(Eh,t=>Math.asin(t)),Oge={kernelName:Eh,backendName:"cpu",kernelFunc:Rge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pge=Je(Dh,t=>Math.asinh(t)),Fge={kernelName:Dh,backendName:"cpu",kernelFunc:Pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mge=Je(Ah,t=>Math.atan(t)),Lge={kernelName:Ah,backendName:"cpu",kernelFunc:Mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zge=qt((t,e)=>Math.atan2(t,e)),Bge=dn(Oh,zge),Vge={kernelName:Oh,backendName:"cpu",kernelFunc:Bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wge=Je(Rh,t=>Math.atanh(t)),Uge={kernelName:Rh,backendName:"cpu",kernelFunc:Wge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tE(t,e,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=De(r.outShape,n),m=g.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3];for(let w=0;w<r.batchSize;++w){const v=w*x,S=w*s[0];for(let T=0;T<r.inChannels;++T)for(let k=0;k<r.outHeight;++k){const I=k*o-d,_=Math.max(0,I),D=Math.min(r.inHeight,u+I),A=v+k*y;for(let L=0;L<r.outWidth;++L){const B=L*a-f,F=Math.max(0,B),R=Math.min(r.inWidth,h+B);let O=p,E=0,V=0;for(let Y=_;Y<D;Y+=l){const Z=S+Y*s[1];for(let ee=F;ee<R;ee+=c){const te=Z+ee*s[2],ne=t[te+T];i==="max"&&ne>O?O=ne:i==="avg"&&(E+=ne,V++)}if(isNaN(O))break}const G=A+L*b+T;m[G]=i==="avg"?E/V:O}}}return g}function z6(t,e,n,s,r=!1,i=!1){const o=De(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,h=s.effectiveFilterHeight,d=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,g=De(e,n,t);for(let m=0;m<s.batchSize;++m)for(let x=0;x<s.inChannels;++x)for(let y=0;y<s.outHeight;++y){const b=y*a-f;let w=b;for(;w<0;)w+=c;const v=Math.min(s.inHeight,h+b);for(let S=0;S<s.outWidth;++S){const T=S*l-p;let k=T;for(;k<0;)k+=u;const I=Math.min(s.inWidth,d+T);let _=Number.NEGATIVE_INFINITY,D=-1;for(let A=w;A<v;A+=c){const L=A-b;for(let B=k;B<I;B+=u){const F=B-T,R=g.get(m,A,B,x);R>_&&(_=R,r?D=i?((m*s.inHeight+A)*s.inWidth+B)*s.inChannels+x:(A*s.inWidth+B)*s.inChannels+x:D=L*d+F)}}o.set(D,m,y,S,x)}}return o}function B6(t,e,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,g=r.padInfo.front,m=r.padInfo.top,x=r.padInfo.left,y=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=De(r.outShape,n),w=b.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],T=r.outShape[3]*r.outShape[4],k=r.outShape[4];for(let I=0;I<r.batchSize;++I){const _=I*v,D=I*s[0];for(let A=0;A<r.inChannels;++A)for(let L=0;L<r.outDepth;++L){const B=L*o-g;let F=B;for(;F<0;)F+=c;const R=Math.min(r.inDepth,d+B),O=_+L*S;for(let E=0;E<r.outHeight;++E){const V=E*a-m;let G=V;for(;G<0;)G+=u;const Y=Math.min(r.inHeight,f+V),Z=O+E*T;for(let ee=0;ee<r.outWidth;++ee){const te=ee*l-x;let ne=te;for(;ne<0;)ne+=h;const ie=Math.min(r.inWidth,p+te),ce=Z+ee*k;let ye=y,ve=0,Ie=0;for(let Ne=F;Ne<R;Ne+=c){const Xe=D+Ne*s[1];for(let gt=G;gt<Y;gt+=u){const et=Xe+gt*s[2];for(let Ye=ne;Ye<ie;Ye+=h){const ht=et+Ye*s[3],xt=t[ht+A];if(i==="max"&&xt>ye?ye=xt:i==="avg"&&(ve+=xt,Ie++),isNaN(ye))break}if(isNaN(ye))break}if(isNaN(ye))break}const $e=ce+A;w[$e]=i==="avg"?ve/Math.max(Ie,1):ye}}}}return b}function jge(t,e){const n=De(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let m=0;m<e.inChannels;++m)for(let x=0;x<e.outDepth;++x){const y=x*s-d;let b=y;for(;b<0;)b+=o;const w=Math.min(e.inDepth,c+y);for(let v=0;v<e.outHeight;++v){const S=v*r-f;let T=S;for(;T<0;)T+=a;const k=Math.min(e.inHeight,u+S);for(let I=0;I<e.outWidth;++I){const _=I*i-p;let D=_;for(;D<0;)D+=l;const A=Math.min(e.inWidth,h+_);let L=Number.NEGATIVE_INFINITY,B=-1;for(let F=b;F<w;F+=o){const R=F-y;for(let O=T;O<k;O+=a){const E=O-S;for(let V=D;V<A;V+=l){const G=V-_,Y=t.get(g,F,O,V,m);Y>=L&&(L=Y,B=R*u*h+E*u+G)}}}n.set(B,g,x,v,I,m)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;me(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;N(Fn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Fr(r.shape,i,o,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&Fe(u.inShape,u.outShape))h=zi({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,f=we(r.shape),p=tE(d,r.shape,r.dtype,f,u,"avg");h=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return h}const Gge={kernelName:Cm,backendName:"cpu",kernelFunc:Hge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;me(r,"avgPool3d");const u=Ro(r.shape,i,o,1,a,l,c),h=n.data.get(r.dataId).values,d=B6(h,r.shape,r.dtype,we(r.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const Kge={kernelName:Tm,backendName:"cpu",kernelFunc:qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;me([r,i],"avgPool3DGrad");const u=Ro(i.shape,o,a,1,l,c),h=u.strideDepth,d=u.strideHeight,f=u.strideWidth,p=u.filterDepth,g=u.filterHeight,m=u.filterWidth,x=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,w=u.effectiveFilterDepth,v=u.effectiveFilterHeight,S=u.effectiveFilterWidth,T=w-1-u.padInfo.front,k=S-1-u.padInfo.left,I=v-1-u.padInfo.top,_=De(i.shape,"float32"),D=1/(p*g*m),A=n.bufferSync(r);for(let L=0;L<u.batchSize;++L)for(let B=0;B<u.inChannels;++B)for(let F=0;F<u.inDepth;++F)for(let R=0;R<u.inHeight;++R)for(let O=0;O<u.inWidth;++O){const E=F-T,V=R-I,G=O-k;let Y=0;for(let Z=0;Z<w;Z+=x){const ee=(E+Z)/h;if(!(ee<0||ee>=u.outDepth||Math.floor(ee)!==ee))for(let te=0;te<v;te+=y){const ne=(V+te)/d;if(!(ne<0||ne>=u.outHeight||Math.floor(ne)!==ne))for(let ie=0;ie<S;ie+=b){const ce=(G+ie)/f;if(ce<0||ce>=u.outWidth||Math.floor(ce)!==ce)continue;const ye=A.get(L,ee,ne,ce,B);Y+=ye}}}_.set(Y*D,L,F,R,O,B)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const Yge={kernelName:Sb,backendName:"cpu",kernelFunc:Xge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;me([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Fr(o.shape,a,l,1,c),h=u.strideHeight,d=u.strideWidth,f=u.filterHeight,p=u.filterWidth,g=u.dilationHeight,m=u.dilationWidth,x=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,w=x-1-u.padInfo.top,v=De(o.shape,"float32"),S=1/(f*p),T=n.data.get(r.dataId).values,k=De(r.shape,"float32",T);for(let I=0;I<u.batchSize;++I)for(let _=0;_<u.inChannels;++_)for(let D=0;D<u.inHeight;++D)for(let A=0;A<u.inWidth;++A){const L=D-w,B=A-b;let F=0;for(let R=0;R<x;R+=g){const O=(L+R)/h;if(!(O<0||O>=u.outHeight||Math.floor(O)!==O))for(let E=0;E<y;E+=m){const V=(B+E)/d;if(V<0||V>=u.outWidth||Math.floor(V)!==V)continue;const G=k.get(I,O,V,_);F+=G}}v.set(F*S,I,D,A,_)}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const Zge={kernelName:vb,backendName:"cpu",kernelFunc:Qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:i,offset:o,mean:a,variance:l}=e;N(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),me([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),m=p.length,x=f.length,y=d.length,b=h.length;let w=0,v=0,S=0,T=0;for(let k=0;k<u.length;++k)g[k]=p[w++]+(u[k]-h[v++])*f[S++]/Math.sqrt(d[T++]+c),w>=m&&(w=0),v>=b&&(v=0),S>=x&&(S=0),T>=y&&(T=0);return n.makeTensorInfo(r.shape,r.dtype,g)}const e0e={kernelName:zm,backendName:"cpu",kernelFunc:Jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;me([r],"batchToSpaceND");const a=i.reduce((x,y)=>x*y),l=Ug(r.shape,i,a),c=jg(l.length,i.length),u=Hg(r.shape,i,a),h=ZN(o,i.length),d=JN(u,o,i.length),f=ut({inputs:{x:r},backend:n,attrs:{shape:l}}),p=Ss({inputs:{x:f},backend:n,attrs:{perm:c}}),g=ut({inputs:{x:p},backend:n,attrs:{shape:u}}),m=Tc({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const n0e={kernelName:Nm,backendName:"cpu",kernelFunc:t0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=Y$(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const r0e={kernelName:kb,backendName:"cpu",kernelFunc:s0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0e(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=Te(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const o0e={kernelName:Cb,backendName:"cpu",kernelFunc:i0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a0e=Je(Mh,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),l0e={kernelName:Mh,backendName:"cpu",kernelFunc:a0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c0e=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(Q(e.shape)),r=n.data.get(e.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],h=l[c];s[c]=Math.hypot(u,h)}return n.makeOutput(s,e.shape,"float32")},u0e={kernelName:$m,backendName:"cpu",kernelFunc:c0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gh(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const h0e={kernelName:jb,backendName:"cpu",kernelFunc:gh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xh(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=Oe(r,e[0].shape)[0],o=e.map(g=>g.shape);XN(o,i);let a=Di(e.map(g=>g.shape),i);if(Q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(g=>Q(g.shape)>0);if(l.length===1)return zi({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(w=>Cc({inputs:{input:w},backend:n})),m=l.map(w=>gh({inputs:{input:w},backend:n})),x=xh({inputs:g,backend:n,attrs:{axis:i}}),y=xh({inputs:m,backend:n,attrs:{axis:i}}),b=Rs({inputs:{real:x,imag:y},backend:n});return g.forEach(w=>n.disposeIntermediateTensorInfo(w)),m.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),b}const c=l.map(g=>{const x=[-1,Q(g.shape.slice(i))];return ut({inputs:{x:g},backend:n,attrs:{shape:x}})}),u=c.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));a=Di(c.map(g=>g.shape),1);const h=c[0].shape[0]===1,d=UW(u,a,e[0].dtype,h),f=Di(l.map(g=>g.shape),i),p=n.makeTensorInfo(f,e[0].dtype,d);return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const d0e={kernelName:Em,backendName:"cpu",kernelFunc:xh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;me([r,i],"conv2d");const h=Oo(l),d=Cn(r.shape,i.shape,o,c,a,u,!1,h),f=d.filterHeight,p=d.filterWidth,g=d.dilationHeight,m=d.dilationWidth,x=d.padInfo.left,y=d.padInfo.top,b=d.dataFormat==="channelsLast",w=new nn(d.outShape,r.dtype),v=we(r.shape),S=we(i.shape),T=v[0],k=b?v[1]:v[2],I=b?v[2]:1,_=b?1:v[1],D=w.strides[0],A=b?w.strides[1]:w.strides[2],L=b?w.strides[2]:1,B=b?1:w.strides[1],F=n.data.get(r.dataId).values,R=n.data.get(i.dataId).values,O=w.values;for(let E=0;E<d.batchSize;++E){const V=E*T,G=E*D;for(let Y=0;Y<d.outHeight;++Y){const Z=G+Y*A,ee=Y*d.strideHeight-y;for(let te=0;te<f;++te){const ne=ee+te*g;if(ne<0||ne>=d.inHeight)continue;const ie=te*S[0],ce=V+ne*k;for(let ye=0;ye<d.outWidth;++ye){const ve=Z+ye*L,Ie=ye*d.strideWidth-x;for(let $e=0;$e<p;++$e){const Ne=Ie+$e*m;if(Ne<0||Ne>=d.inWidth)continue;const Xe=ie+$e*S[1],gt=ce+Ne*I;let et=Xe;for(let Ye=0;Ye<d.inChannels;++Ye){const ht=F[gt+Ye*_];for(let xt=0;xt<d.outChannels;++xt)O[ve+xt*B]+=ht*R[et+xt];et+=d.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,O)}const f0e={kernelName:Dm,backendName:"cpu",kernelFunc:V6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;me([r,i],"conv2dBackpropFilter");const h=Oo(l),d=Cn(r.shape,u,o,1,a,c,!1,h),{strideHeight:f,strideWidth:p,filterHeight:g,filterWidth:m}=d,x=d.dataFormat==="channelsLast",y=new nn(d.filterShape,"float32"),b=d.padInfo.left,w=d.padInfo.top,v=n.data.get(r.dataId).values,S=n.data.get(i.dataId).values,T=new nn(r.shape,r.dtype,v),k=new nn(i.shape,i.dtype,S);for(let I=0;I<g;++I){const _=Math.max(0,Math.ceil((w-I)/f)),D=Math.min(d.outHeight,(d.inHeight+w-I)/f);for(let A=0;A<m;++A){const L=Math.max(0,Math.ceil((b-A)/p)),B=Math.min(d.outWidth,(d.inWidth+b-A)/p);for(let F=0;F<d.inChannels;++F)for(let R=0;R<d.outChannels;++R){let O=0;for(let E=0;E<d.batchSize;++E)for(let V=_;V<D;++V){const G=I+V*f-w;for(let Y=L;Y<B;++Y){const Z=A+Y*p-b;x?O+=T.get(E,G,Z,F)*k.get(E,V,Y,R):O+=T.get(E,F,G,Z)*k.get(E,R,V,Y)}}y.set(O,I,A,F,R)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const m0e={kernelName:Ib,backendName:"cpu",kernelFunc:p0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;me([r,i],"conv2dBackpropInput");const h=we(i.shape),d=we(r.shape);let f=Oo(c);const p=Cn(o,i.shape,a,1,l,u,!1,f),g=new nn(p.inShape,"float32"),m=g.values,x=n.data.get(r.dataId).values,y=n.data.get(i.dataId).values,[b,w,v]=h,{batchSize:S,filterHeight:T,filterWidth:k,inChannels:I,inHeight:_,inWidth:D,outChannels:A,outHeight:L,outWidth:B,strideHeight:F,strideWidth:R}=p;f=p.dataFormat;const O=T-1-p.padInfo.top,E=k-1-p.padInfo.left,V=f==="channelsLast",G=g.strides[0],Y=V?g.strides[1]:g.strides[2],Z=V?g.strides[2]:1,ee=V?1:g.strides[1],te=d[0],ne=V?d[1]:d[2],ie=V?d[2]:1,ce=V?1:d[1];for(let ye=0;ye<S;++ye)for(let ve=0;ve<I;++ve)for(let Ie=0;Ie<_;++Ie){const $e=Ie-O,Ne=Math.max(0,Math.ceil($e/F)),Xe=Math.min(L,(T+$e)/F);for(let gt=0;gt<D;++gt){const et=gt-E,Ye=Math.max(0,Math.ceil(et/R)),ht=Math.min(B,(k+et)/R);let xt=0;for(let In=Ne;In<Xe;++In){const Vo=In*F-$e;for(let qs=Ye;qs<ht;++qs){const ul=qs*R-et,zr=te*ye+ne*In+ie*qs,ji=b*(T-1-Vo)+w*(k-1-ul)+v*ve;for(let Wo=0;Wo<A;++Wo){const Uo=x[zr+ce*Wo],jo=y[ji+Wo];xt+=Uo*jo}}}const Ui=G*ye+Y*Ie+Z*gt+ee*ve;m[Ui]=xt}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const x0e={kernelName:Am,backendName:"cpu",kernelFunc:g0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s;me([r,i],"conv3d");const c=tl(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:g,padInfo:m}=c,x=m.front,y=m.left,b=m.top,w=new nn(c.outShape,r.dtype),v=n.data.get(r.dataId).values,S=n.data.get(i.dataId).values,T=w.values,k=we(r.shape),I=we(i.shape);for(let _=0;_<c.batchSize;++_){const D=_*k[0],A=_*w.strides[0];for(let L=0;L<c.outDepth;++L){const B=A+L*w.strides[1],F=L*c.strideDepth-x;for(let R=0;R<u;++R){const O=F+R*f;if(O<0||O>=c.inDepth)continue;const E=R*I[0],V=D+O*k[1];for(let G=0;G<c.outHeight;++G){const Y=B+G*w.strides[2],Z=G*c.strideHeight-b;for(let ee=0;ee<h;++ee){const te=Z+ee*p;if(te<0||te>=c.inHeight)continue;const ne=E+ee*I[1],ie=V+te*k[2];for(let ce=0;ce<c.outWidth;++ce){const ye=Y+ce*c.outChannels,ve=ce*c.strideWidth-y;for(let Ie=0;Ie<d;++Ie){const $e=ve+Ie*g;if($e<0||$e>=c.inWidth)continue;const Ne=ne+Ie*I[2],Xe=ie+$e*c.inChannels;let gt=Ne;for(let et=0;et<c.inChannels;++et){const Ye=v[Xe+et];for(let ht=0;ht<c.outChannels;++ht)T[ye+ht]+=Ye*S[gt+ht];gt+=c.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const b0e={kernelName:Rm,backendName:"cpu",kernelFunc:y0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s;me([r,i],"conv3dBackpropFilterV2");const c=we(r.shape),u=we(i.shape),h=tl(r.shape,l,o,1,a),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,g=h.filterDepth,m=h.filterHeight,x=h.filterWidth,y=new nn(h.filterShape,"float32"),b=y.values,[w,v,S,T]=y.strides,k=n.data.get(i.dataId).values,[I,_,D,A]=u,L=n.data.get(r.dataId).values,[B,F,R,O]=c,E=h.padInfo.front,V=h.padInfo.left,G=h.padInfo.top;for(let Y=0;Y<g;++Y){const Z=Math.max(0,Math.ceil((E-Y)/d)),ee=Math.min(h.outDepth,(h.inDepth+E-Y)/d),te=Y*w;for(let ne=0;ne<m;++ne){const ie=Math.max(0,Math.ceil((G-ne)/f)),ce=Math.min(h.outHeight,(h.inHeight+G-ne)/f),ye=ne*v+te;for(let ve=0;ve<x;++ve){const Ie=Math.max(0,Math.ceil((V-ve)/p)),$e=Math.min(h.outWidth,(h.inWidth+V-ve)/p),Ne=ve*S+ye;for(let Xe=0;Xe<h.inChannels;++Xe){const gt=Xe*T+Ne;for(let et=0;et<h.outChannels;++et){let Ye=0;for(let ht=0;ht<h.batchSize;++ht){const xt=ht*B,Ui=ht*I;for(let In=Z;In<ee;++In){const qs=(Y+In*d-E)*F+xt,ul=In*_+Ui;for(let zr=ie;zr<ce;++zr){const Wo=(ne+zr*f-G)*R+qs,Uo=zr*D+ul;for(let jo=Ie;jo<$e;++jo){const Gv=(ve+jo*p-V)*O+Wo,qv=jo*A+Uo;Ye+=L[Gv+Xe]*k[qv+et]}}}}b[gt+et]=Ye}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const v0e={kernelName:Nb,backendName:"cpu",kernelFunc:w0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s;me([r],"conv3dBackpropInputV2");const c=we(r.shape),u=we(i.shape),h=tl(l,i.shape,a,1,o),d=new nn(h.inShape,"float32"),f=d.values,[p,g,m,x]=d.strides,y=n.data.get(r.dataId).values,[b,w,v,S]=c,T=n.data.get(i.dataId).values,[k,I,_,D]=u,{batchSize:A,filterDepth:L,filterHeight:B,filterWidth:F,inChannels:R,inDepth:O,inHeight:E,inWidth:V,outChannels:G,outDepth:Y,outHeight:Z,outWidth:ee,strideDepth:te,strideHeight:ne,strideWidth:ie}=h,ce=L-1-h.padInfo.front,ye=B-1-h.padInfo.top,ve=F-1-h.padInfo.left;for(let Ie=0;Ie<A;++Ie)for(let $e=0;$e<R;++$e)for(let Ne=0;Ne<O;++Ne){const Xe=Ne-ce,gt=Math.max(0,Math.ceil(Xe/te)),et=Math.min(Y,(L+Xe)/te);for(let Ye=0;Ye<E;++Ye){const ht=Ye-ye,xt=Math.max(0,Math.ceil(ht/ne)),Ui=Math.min(Z,(B+ht)/ne);for(let In=0;In<V;++In){const Vo=In-ve,qs=Math.max(0,Math.ceil(Vo/ie)),ul=Math.min(ee,(F+Vo)/ie);let zr=0;for(let ji=gt;ji<et;++ji){const Wo=ji*te-Xe;for(let Uo=xt;Uo<Ui;++Uo){const jo=Uo*ne-ht;for(let qd=qs;qd<ul;++qd){const Gv=qd*ie-Vo,qv=b*Ie+w*ji+v*Uo+S*qd,Qj=k*(L-1-Wo)+I*(B-1-jo)+_*(F-1-Gv)+D*$e;for(let p0=0;p0<G;++p0){const Zj=y[qv+p0],Jj=T[Qj+p0];zr+=Zj*Jj}}}}f[p*Ie+g*Ne+m*Ye+x*In+$e]=zr}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const k0e={kernelName:_b,backendName:"cpu",kernelFunc:S0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C0e=Je(Lh,t=>Math.cos(t)),T0e={kernelName:Lh,backendName:"cpu",kernelFunc:C0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I0e=Je(zh,t=>Math.cosh(t)),N0e={kernelName:zh,backendName:"cpu",kernelFunc:I0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _0e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,h,d,f]=r.shape,p=i.shape[0],[g,m]=a,x=De([p,g,m,f],"float32"),y=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,w=n.data.get(r.dataId).values,v=we(r.shape),S=we(x.shape);for(let T=0;T<p;T++){const k=T*4,I=y[k],_=y[k+1],D=y[k+2],A=y[k+3],L=b[T];if(L>=u)continue;const B=g>1?(D-I)*(h-1)/(g-1):0,F=m>1?(A-_)*(d-1)/(m-1):0;for(let R=0;R<g;R++){const O=g>1?I*(h-1)+R*B:.5*(I+D)*(h-1);if(O<0||O>h-1){for(let E=0;E<m;E++)for(let V=0;V<f;V++){const G=V+E*S[2]+R*S[1]+T*S[0];x.values[G]=c}continue}if(l==="bilinear"){const E=Math.floor(O),V=Math.ceil(O),G=O-E;for(let Y=0;Y<m;Y++){const Z=m>1?_*(d-1)+Y*F:.5*(_+A)*(d-1);if(Z<0||Z>d-1){for(let ie=0;ie<f;ie++){const ce=ie+Y*S[2]+R*S[1]+T*S[0];x.values[ce]=c}continue}const ee=Math.floor(Z),te=Math.ceil(Z),ne=Z-ee;for(let ie=0;ie<f;ie++){let ce=ie+ee*v[2]+E*v[1]+L*v[0];const ye=w[ce];ce=ie+te*v[2]+E*v[1]+L*v[0];const ve=w[ce];ce=ie+ee*v[2]+V*v[1]+L*v[0];const Ie=w[ce];ce=ie+te*v[2]+V*v[1]+L*v[0];const $e=w[ce],Ne=ye+(ve-ye)*ne,Xe=Ie+($e-Ie)*ne;ce=ie+Y*S[2]+R*S[1]+T*S[0],x.values[ce]=Ne+(Xe-Ne)*G}}}else for(let E=0;E<m;++E){const V=m>1?_*(d-1)+E*F:.5*(_+A)*(d-1);if(V<0||V>d-1){for(let Z=0;Z<f;Z++){const ee=Z+E*S[2]+R*S[1]+T*S[0];x.values[ee]=c}continue}const G=Math.round(V),Y=Math.round(O);for(let Z=0;Z<f;Z++){const ee=Z+G*v[2]+Y*v[1]+L*v[0],te=Z+E*S[2]+R*S[1]+T*S[0];x.values[te]=w[ee]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const $0e={kernelName:Eb,backendName:"cpu",kernelFunc:_0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;me(r,"cumprod");const l=Et([i],r.shape.length);let c=r;l!=null&&(c=Ss({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Ht(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=xs(c.dtype,"int32"),d=yb(Q(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(x,y)=>x+p-y-1:(x,y)=>x+y;for(let x=0;x<f.length;x+=p)for(let y=0;y<p;y++){const b=g(x,y);if(y===0)d[b]=o?1:f[b];else{const w=g(x,y-1);d[b]=o?f[w]*d[w]:f[b]*d[w]}}const m=n.makeTensorInfo(c.shape,h,d);if(l!=null){const x=nl(l),y=Ss({inputs:{x:m},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),y}return m}const D0e={kernelName:$b,backendName:"cpu",kernelFunc:E0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;me(r,"cumsum");const l=Et([i],r.shape.length);let c=r;l!=null&&(c=Ss({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Ht(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=xs(c.dtype,"int32"),d=On(Q(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(x,y)=>x+p-y-1:(x,y)=>x+y;for(let x=0;x<f.length;x+=p)for(let y=0;y<p;y++){const b=g(x,y);if(y===0)d[b]=o?0:f[b];else{const w=g(x,y-1);d[b]=o?f[w]+d[w]:f[b]+d[w]}}const m=n.makeTensorInfo(c.shape,h,d);if(l!=null){const x=nl(l),y=Ss({inputs:{x:m},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),y}return m}const R0e={kernelName:Om,backendName:"cpu",kernelFunc:A0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=Y$(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=BW(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const P0e={kernelName:Db,backendName:"cpu",kernelFunc:O0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s;N(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],h=l*i,d=c*i,f=u/(i*i),p=n.data.get(r.dataId).values,g=new Float32Array(a*h*d*f);let m=0;for(let x=0;x<a;++x)for(let y=0;y<h;++y){const b=Math.floor(y/i),w=y%i;for(let v=0;v<d;++v){const S=Math.floor(v/i),T=v%i,k=(w*i+T)*f;for(let I=0;I<f;++I){const D=I+k+u*(S+c*(b+l*x));g[m++]=p[D]}}}return n.makeTensorInfo([a,h,d,f],r.dtype,g)}const M0e={kernelName:Ab,backendName:"cpu",kernelFunc:F0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;me([r,i],"depthwiseConv2DNative");const u=we(r.shape),h=we(i.shape);let d=l;d==null&&(d=[1,1]),N(Fn(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const f=Cn(r.shape,i.shape,o,d,a,c,!0),{filterHeight:p,filterWidth:g,dilationHeight:m,dilationWidth:x,padInfo:y}=f,b=y.left,w=y.top,v=f.outChannels/f.inChannels,S=new nn(f.outShape,r.dtype),T=n.data.get(r.dataId).values,k=n.data.get(i.dataId).values,I=S.values;for(let _=0;_<f.batchSize;++_){const D=_*u[0],A=_*S.strides[0];for(let L=0;L<f.outHeight;++L){const B=A+L*S.strides[1],F=L*f.strideHeight-w;for(let R=0;R<p;++R){const O=F+R*m;if(O<0||O>=f.inHeight)continue;const E=R*h[0],V=D+O*u[1];for(let G=0;G<f.outWidth;++G){const Y=B+G*S.strides[2],Z=G*f.strideWidth-b;for(let ee=0;ee<g;++ee){const te=Z+ee*x;if(te<0||te>=f.inWidth)continue;const ne=E+ee*h[1],ie=V+te*f.inChannels;let ce=Y,ye=ne;for(let ve=0;ve<f.inChannels;++ve){const Ie=T[ie+ve];for(let $e=0;$e<v;++$e)I[ce+$e]+=Ie*k[ye+$e];ce+=v,ye+=v}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const L0e={kernelName:Pm,backendName:"cpu",kernelFunc:W6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;me([r,i],"depthwiseConv2dNativeBackpropFilter");const h=Cn(r.shape,u,o,a,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:g}=h,m=new nn(h.filterShape,"float32"),x=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,w=n.data.get(r.dataId).values,v=new nn(r.shape,r.dtype,w),S=n.data.get(i.dataId).values,T=new nn(i.shape,i.dtype,S);for(let k=0;k<p;++k){const I=Math.max(0,Math.ceil((y-k)/d)),_=Math.min(h.outHeight,(h.inHeight+y-k)/d);for(let D=0;D<g;++D){const A=Math.max(0,Math.ceil((x-D)/f)),L=Math.min(h.outWidth,(h.inWidth+x-D)/f);for(let B=0;B<h.outChannels;++B){const F=Math.trunc(B/b),R=B%b;let O=0;for(let E=0;E<h.batchSize;++E)for(let V=I;V<_;++V){const G=k+V*d-y;for(let Y=A;Y<L;++Y){const Z=D+Y*f-x;O+=v.get(E,G,Z,F)*T.get(E,V,Y,B)}}m.set(O,k,D,F,R)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const B0e={kernelName:Rb,backendName:"cpu",kernelFunc:z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;me([r,i],"depthwiseConv2DNativeBackpropInput");const h=we(r.shape),d=we(i.shape),f=Cn(u,i.shape,o,a,l,c,!0),p=new nn(f.inShape,"float32"),g=p.values,[m,x,y]=p.strides,b=n.data.get(r.dataId).values,[w,v,S]=h,T=n.data.get(i.dataId).values,[k,I,_]=d,{batchSize:D,filterHeight:A,filterWidth:L,inChannels:B,inHeight:F,inWidth:R,outChannels:O,outHeight:E,outWidth:V,strideHeight:G,strideWidth:Y}=f,Z=A-1-f.padInfo.top,ee=L-1-f.padInfo.left,te=O/B;for(let ne=0;ne<D;++ne)for(let ie=0;ie<B;++ie)for(let ce=0;ce<F;++ce){const ye=ce-Z,ve=Math.max(0,Math.ceil(ye/G)),Ie=Math.min(E,(A+ye)/G);for(let $e=0;$e<R;++$e){const Ne=$e-ee,Xe=Math.max(0,Math.ceil(Ne/Y)),gt=Math.min(V,(L+Ne)/Y);let et=0;for(let Ye=ve;Ye<Ie;++Ye){const ht=Ye*G-ye;for(let xt=Xe;xt<gt;++xt){const Ui=xt*Y-Ne,In=w*ne+v*Ye+S*xt,Vo=k*(A-1-ht)+I*(L-1-Ui)+_*ie;for(let qs=0;qs<te;++qs){const ul=ie*te+qs,zr=b[In+ul],ji=T[Vo+qs];et+=zr*ji}}}g[m*ne+x*ce+y*$e+ie]=et}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const W0e={kernelName:Ob,backendName:"cpu",kernelFunc:V0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U0e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=Q(s.shape),i=n.data.get(s.dataId).values,o=De([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const j0e={kernelName:Pb,backendName:"cpu",kernelFunc:U0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H0e={kernelName:Fm,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,h=l.data.get(r.dataId).values,d=r.shape.length,{batchSize:f,inHeight:p,inWidth:g,inChannels:m,outHeight:x,outWidth:y,padInfo:b,strideHeight:w,strideWidth:v,filterHeight:S,filterWidth:T,dilationHeight:k,dilationWidth:I,outShape:_}=Tg(s.shape,r.shape,i,o,"NHWC",a),D=Q(_),A=_.length,L=Ot(s.dtype,D);for(let F=0;F<f;++F)for(let R=0;R<x;++R){const O=R*w-b.top;for(let E=0;E<y;++E){const V=E*v-b.left;for(let G=0;G<m;++G){let Y=Number.MIN_SAFE_INTEGER;for(let ee=0;ee<S;++ee){const te=O+ee*k;if(te>=0&&te<p)for(let ne=0;ne<T;++ne){const ie=V+ne*I;if(ie>=0&&ie<g){const ce=Zr([F,te,ie,G],u,we(s.shape)),ye=Zr([ee,ne,G],d,we(r.shape)),ve=c[ce]+h[ye];ve>Y&&(Y=ve)}}}const Z=Zr([F,R,E,G],A,we(_));L[Z]=Y}}}return{dataId:l.write(Ja(L,s.dtype),_,s.dtype),shape:_,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G0e={kernelName:Ky,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=ar(s.shape,c.data.get(s.dataId).values),h=ar(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:x,padInfo:y,strideHeight:b,strideWidth:w,filterHeight:v,filterWidth:S,dilationHeight:T,dilationWidth:k,outShape:I}=Tg(s.shape,r.shape,o,a,"NHWC",l);N(i.rank===I.length,()=>`Error in ${Ky}, dy must have the same rank as output ${I.length}, but got ${i.rank}`);const _=ar(I,c.data.get(i.dataId).values),D=cI(r.shape,r.dtype);for(let L=0;L<d;++L)for(let B=0;B<m;++B){const F=B*b-y.top;for(let R=0;R<x;++R){const O=R*w-y.left;for(let E=0;E<g;++E){let V=Number.MIN_SAFE_INTEGER,G=0,Y=0;for(let Z=0;Z<v;++Z){const ee=F+Z*T;if(ee>=0&&ee<f)for(let te=0;te<S;++te){const ne=O+te*k;if(ne>=0&&ne<p){const ie=u[L][ee][ne][E]+h[Z][te][E];ie>V&&(V=ie,G=Z,Y=te)}}}D[G][Y][E]+=_[L][B][R][E]}}}return{dataId:c.write(Ja(D,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q0e={kernelName:qy,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=ar(s.shape,c.data.get(s.dataId).values),h=ar(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:x,padInfo:y,strideHeight:b,strideWidth:w,filterHeight:v,filterWidth:S,dilationHeight:T,dilationWidth:k,outShape:I}=Tg(s.shape,r.shape,o,a,"NHWC",l);N(i.rank===I.length,()=>`Error in ${qy}, dy must have the same rank as output ${I.length}, but got ${i.rank}`);const _=ar(I,c.data.get(i.dataId).values),D=cI(s.shape,s.dtype);for(let L=0;L<d;++L)for(let B=0;B<m;++B){const F=B*b-y.top;for(let R=0;R<x;++R){const O=R*w-y.left;for(let E=0;E<g;++E){let V=Number.MIN_SAFE_INTEGER,G=F<0?0:F,Y=O<0?0:O;for(let Z=0;Z<v;++Z){const ee=F+Z*T;if(ee>=0&&ee<f)for(let te=0;te<S;++te){const ne=O+te*k;if(ne>=0&&ne<p){const ie=u[L][ee][ne][E]+h[Z][te][E];ie>V&&(V=ie,G=ee,Y=ne)}}}D[L][G][Y][E]+=_[L][B][R][E]}}}return{dataId:c.write(Ja(D,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:i,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${u} type.`);const[d,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],g=n.data.get(r.dataId).values,m=r.dtype==="float32"?255:1,x=new Uint8ClampedArray(f*d*4);for(let b=0;b<d*f;++b){const w=[0,0,0,255*c];for(let S=0;S<p;S++){const T=g[b*p+S];if(r.dtype==="float32"){if(T<0||T>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${T}.`)}else if(r.dtype==="int32"&&(T<0||T>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${T}.`);p===1?(w[0]=T*m,w[1]=T*m,w[2]=T*m):w[S]=T*m}const v=b*4;x[v+0]=Math.round(w[0]),x[v+1]=Math.round(w[1]),x[v+2]=Math.round(w[2]),x[v+3]=Math.round(w[3])}i.width=f,i.height=d;const y=new ImageData(x,f,d);return h.putImageData(y,0,0),r}const X0e={kernelName:Fb,backendName:"cpu",kernelFunc:K0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;me(r,"sum");let a;r.dtype==="bool"?a=Ua({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=zi({inputs:{x:r},backend:n});const l=a.shape.length,c=Oe(i,a.shape),u=Et(c,l);let h=c,d=a;u!=null&&(d=Ss({inputs:{x:a},backend:n,attrs:{perm:u}}),h=Ht(h.length,l)),Mn("sum",h,d.shape.length);const[f,p]=Tn(d.shape,h),g=xs(d.dtype,"int32");let m=f1(n,f,g);const x=Q(p),y=n.data.get(m.dataId).values,b=n.data.get(d.dataId).values;for(let w=0;w<y.length;++w){const v=w*x;let S=0;for(let T=0;T<x;++T)S+=b[v+T];y[w]=S}if(o){const w=Wt(m.shape,c),v=m;m=ut({inputs:{x:m},backend:n,attrs:{shape:w}}),n.disposeIntermediateTensorInfo(v)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(d),m}const Y0e={kernelName:mg,backendName:"cpu",kernelFunc:n0};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0e(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=a_(r,i.length);c_(o.length,l,i);const{path:c,steps:u}=u_(a,l),h=u.length;let d=null,f=o.length;const p=[];for(let g=0;g<h;++g){for(const m of u[g]){const{permutationIndices:x,expandDims:y}=l_(f,l[m]);let b;h_(x)?b=i[m]:(b=Ss({inputs:{x:i[m]},backend:n,attrs:{perm:x}}),p.push(b));const w=b.shape.slice();for(let v=0;v<y.length;++v)w.splice(y[v],0,1);Fe(b.shape,w)||(b=ut({inputs:{x:b},backend:n,attrs:{shape:w}}),p.push(b)),d===null?d=b:(d=Pv({inputs:{a:b,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=n0({inputs:{x:d},backend:n,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const Z0e={kernelName:Mb,backendName:"cpu",kernelFunc:Q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0e(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;me([s,r],"eluGrad");const i=new Float32Array(Q(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const exe={kernelName:Lb,backendName:"cpu",kernelFunc:J0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const txe=e_,nxe=t_,sxe=n_,rxe=s_,ixe=r_,oxe=i_,axe=Je(Wh,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+txe*n);return e*(1-((((oxe*s+ixe)*s+rxe)*s+sxe)*s+nxe)*s*Math.exp(-n*n))}),lxe={kernelName:Wh,backendName:"cpu",kernelFunc:axe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(N(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),ut({inputs:{x:r},backend:n,attrs:{shape:a}})}const cxe={kernelName:Lm,backendName:"cpu",kernelFunc:g1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uxe=qt((t,e)=>t/e),nE=dn(Bh,uxe),dC={kernelName:Bh,backendName:"cpu",kernelFunc:nE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(t,e,n){const s=t.shape,r=s[0],i=s[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=Q(c),h=vn("float32",u),d=vn("float32",u);for(let m=0;m<r;m++){const x=Tc({inputs:{x:a},backend:n,attrs:{begin:[m,0],size:[1,i]}}),y=Tc({inputs:{x:l},backend:n,attrs:{begin:[m,0],size:[1,i]}}),b=Rs({inputs:{real:x,imag:y},backend:n}),{real:w,imag:v}=hxe(b,e,n),S=_o(w,v);for(let T=0;T<i;T++){const k=o_(S,T);h[m*i+T]=k.real,d[m*i+T]=k.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(c,"float32",h),p=n.makeTensorInfo(c,"float32",d),g=Rs({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}function hxe(t,e,n){const s=Q(t.shape),r=n.data.get(t.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(dxe(s)){const a=fC(i,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),h=n.makeTensorInfo([],"float32",Ao(s,"float32")),d=zi({inputs:{x:h},backend:n}),f=dC.kernelFunc({inputs:{a:c,b:h},backend:n}),p=dC.kernelFunc({inputs:{a:u,b:d},backend:n}),g=n.data.get(f.dataId).values,m=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:g,imag:m}}return a}else{const a=_o(i,o),l=fxe(a,s,e);return PV(l)}}function dxe(t){return(t&t-1)===0}function fC(t,e,n,s,r){if(n===1)return{real:t,imag:e};const i=_o(t,e),o=n/2,a=FV(i),l=a.real,c=a.imag,u=[l.length],h=r.makeTensorInfo(u,"float32",l),d=r.makeTensorInfo(u,"float32",c),f=Rs({inputs:{real:h,imag:d},backend:r}),p=MV(i),g=p.real,m=p.imag,x=[g.length],y=r.makeTensorInfo(x,"float32",g),b=r.makeTensorInfo(x,"float32",m),w=Rs({inputs:{real:y,imag:b},backend:r}),v=fC(l,c,o,s,r),S=v.real,T=v.imag,k=[S.length],I=r.makeTensorInfo(k,"float32",S),_=r.makeTensorInfo(k,"float32",T),D=Rs({inputs:{real:I,imag:_},backend:r}),A=fC(g,m,o,s,r),L=A.real,B=A.imag,F=[L.length],R=r.makeTensorInfo(F,"float32",L),O=r.makeTensorInfo(F,"float32",B),E=Rs({inputs:{real:R,imag:O},backend:r}),V=zV(n,s),G=[V.real.length],Y=r.makeTensorInfo(G,"float32",V.real),Z=r.makeTensorInfo(G,"float32",V.imag),ee=Rs({inputs:{real:Y,imag:Z},backend:r}),te=Pv({inputs:{a:ee,b:E},backend:r}),ne=mh({inputs:{a:D,b:te},backend:r}),ie=eE({inputs:{a:D,b:te},backend:r}),ce=Cc({inputs:{input:ne},backend:r}),ye=Cc({inputs:{input:ie},backend:r}),ve=gh({inputs:{input:ne},backend:r}),Ie=gh({inputs:{input:ie},backend:r}),$e=xh({inputs:[ce,ye],backend:r,attrs:{axis:0}}),Ne=xh({inputs:[ve,Ie],backend:r,attrs:{axis:0}}),Xe=r.data.get($e.dataId).values,gt=r.data.get(Ne.dataId).values;return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(O),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(ee),r.disposeIntermediateTensorInfo(te),r.disposeIntermediateTensorInfo(ne),r.disposeIntermediateTensorInfo(ie),r.disposeIntermediateTensorInfo(ce),r.disposeIntermediateTensorInfo(ve),r.disposeIntermediateTensorInfo(ye),r.disposeIntermediateTensorInfo(Ie),r.disposeIntermediateTensorInfo($e),r.disposeIntermediateTensorInfo(Ne),{real:Xe,imag:gt}}function fxe(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,o=0;for(let a=0;a<e;a++){const l=BV(r*a,e,n),c=o_(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),LV(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pxe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=Q(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=ut({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=U6(a,!1,n),c=ut({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const mxe={kernelName:zb,backendName:"cpu",kernelFunc:pxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sE(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:i}=n,o=i||Bc(r),a=Ot(o,Q(s));return xxe(a,r,o),e.makeTensorInfo(s,o,a)}const gxe={kernelName:Bb,backendName:"cpu",kernelFunc:sE};function xxe(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yxe={kernelName:Vb,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,i=vn(s.dtype,Q(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let d=0;d<o;d++){const f=d*l*a*c;for(let p=0;p<a;p++){const g=p*(l*c);for(let m=0;m<l;m++){const x=m*c;for(let y=0;y<c;y++){const b=Math.round(l-m-1),w=f+g+x+y;let v=u[w];if(b>=0&&b<l){const S=b*c,T=f+g+S+y;v=u[T]}i[w]=v}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let g=V6({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const m=g;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const x=ut({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=mh({inputs:{a:g,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else g=mh({inputs:{a:g,b:o},backend:n});n.disposeIntermediateTensorInfo(m)}if(f){const m=g;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=ut({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=m1(n,g,f,x,p),n.disposeIntermediateTensorInfo(x)}else g=m1(n,g,f,a,p);n.disposeIntermediateTensorInfo(m)}return g}const wxe={kernelName:Mp,backendName:"cpu",kernelFunc:bxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let g=W6({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const m=g;g=mh({inputs:{a:g,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(f){const m=g;g=m1(n,g,f,a,p),n.disposeIntermediateTensorInfo(m)}return g}const Sxe={kernelName:Lp,backendName:"cpu",kernelFunc:vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kxe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=Q(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,h]=cv(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const d=n.data.get(r.dataId).values,f=n.bufferSync(s),p=QW(d,f,s.dtype,c,a,u,h,s.shape,i);return n.makeTensorInfo(l,s.dtype,p.values)}const Cxe={kernelName:Wb,backendName:"cpu",kernelFunc:kxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Txe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s;me([r,i],"gatherV2");const l=Oe(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let w=0;w<c.length;++w){const v=c[w];N(v<=u-1&&v>=0,()=>`GatherV2: the index value ${v} is not in [0, ${u-1}]`)}let h=a;a==null&&(h=0);const d=Q(i.shape),f=f_(r,i,l,h),p=ut({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=ut({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),m=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],x=n.bufferSync(g),y=n.bufferSync(p),b=ZW(y,x,m);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const Ixe={kernelName:Bm,backendName:"cpu",kernelFunc:Txe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=Q(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=ut({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=U6(a,!0,n),c=ut({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const _xe={kernelName:Ub,backendName:"cpu",kernelFunc:Nxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $xe=Je(Xh,t=>Number.isFinite(t)?1:0,"bool"),Exe={kernelName:Xh,backendName:"cpu",kernelFunc:$xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dxe=Je(Yh,t=>Math.abs(t)===1/0?1:0,"bool"),Axe={kernelName:Yh,backendName:"cpu",kernelFunc:Dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rxe=Je(Qh,t=>Number.isNaN(t)?1:0,"bool"),Oxe={kernelName:Qh,backendName:"cpu",kernelFunc:Rxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=s6(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const Fxe={kernelName:Hb,backendName:"cpu",kernelFunc:Pxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mxe=Je(Jh,t=>Math.log1p(t)),Lxe={kernelName:Jh,backendName:"cpu",kernelFunc:Mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zxe=qt((t,e)=>t&&e),Bxe=dn(Hm,zxe,null,"bool"),Vxe={kernelName:Hm,backendName:"cpu",kernelFunc:Bxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wxe=Je(Gm,t=>t?0:1,"bool"),Uxe={kernelName:Gm,backendName:"cpu",kernelFunc:Wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jxe=qt((t,e)=>t||e),Hxe=dn(qm,jxe,null,"bool"),Gxe={kernelName:qm,backendName:"cpu",kernelFunc:Hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s;me(r,"LRN");const c=r.shape[3],u=c-1,h=n.data.get(r.dataId).values,d=Q(r.shape),f=new Float32Array(d);function p(g){const m=g%c;let x=g-m+Math.max(0,m-i);const y=g-m+Math.min(m+i,u);let b=0;for(;x<=y;x++){const w=h[x];b+=w*w}return b}for(let g=0;g<d;g++){const m=p(g),x=h[g]*Math.pow(o+a*m,-l);f[g]=x}return n.makeTensorInfo(r.shape,r.dtype,f)}const Kxe={kernelName:Km,backendName:"cpu",kernelFunc:qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;me(o,"LRNGrad");const h=Q(o.shape),d=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(r.dataId).values,g=n.data.get(i.dataId).values,m=new Float32Array(h),x=h;for(let y=0;y<x;y++){const b=y%d,w=y-b+Math.max(0,b-a),v=y-b+Math.min(d,b+a+1);let S=0;for(let T=w;T<v;T++)S+=Math.pow(p[T],2);S=c*S+l;for(let T=w;T<v;T++){let k=-2*c*u*p[T]*g[y]/S;y===T&&(k+=Math.pow(S,-u)),k*=f[y],m[T]+=k}}return n.makeTensorInfo(o.shape,r.dtype,m)}const Yxe={kernelName:Gb,backendName:"cpu",kernelFunc:Xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=Oe(i,l);let h=u;const d=Et(h,c);let f=a.data.get(r.dataId).values;if(d!=null){const w=new Array(c);for(let v=0;v<w.length;v++)w[v]=l[d[v]];f=Z$(f,l,r.dtype,d,w),h=Ht(h.length,c),l=w}me(r,"max"),Mn("max",h,c);const[p,g]=Tn(l,h),m=Q(g),x=i6(f,m,p,r.dtype),y=a.write(x,p,r.dtype);let b=p;return o&&(b=Wt(p,u)),{dataId:y,shape:b,dtype:r.dtype}}const Qxe={kernelName:Xm,backendName:"cpu",kernelFunc:j6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;me(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;N(Fn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Fr(r.shape,i,o,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&Fe(u.inShape,u.outShape))h=zi({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,f=we(r.shape),p=tE(d,r.shape,r.dtype,f,u,"max");h=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return h}const Jxe={kernelName:Ym,backendName:"cpu",kernelFunc:Zxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;me(r,"maxPool3d");const u=Ro(r.shape,i,o,1,a,l,c),h=n.data.get(r.dataId).values,d=B6(h,r.shape,r.dtype,we(r.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const tye={kernelName:Qm,backendName:"cpu",kernelFunc:eye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;me([r,i],"maxPool3DGrad");const u=Ro(i.shape,o,a,1,l,c),h=n.bufferSync(i),d=jge(h,u),f=u.strideDepth,p=u.strideHeight,g=u.strideWidth,m=u.dilationDepth,x=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,w=u.effectiveFilterHeight,v=u.effectiveFilterWidth,S=b-1-u.padInfo.front,T=v-1-u.padInfo.left,k=w-1-u.padInfo.top,I=De(i.shape,"float32"),_=n.bufferSync(r);for(let D=0;D<u.batchSize;++D)for(let A=0;A<u.inChannels;++A)for(let L=0;L<u.inDepth;++L)for(let B=0;B<u.inHeight;++B)for(let F=0;F<u.inWidth;++F){const R=L-S,O=B-k,E=F-T;let V=0;for(let G=0;G<b;G+=m){const Y=(R+G)/f;if(!(Y<0||Y>=u.outDepth||Math.floor(Y)!==Y))for(let Z=0;Z<w;Z+=x){const ee=(O+Z)/p;if(!(ee<0||ee>=u.outHeight||Math.floor(ee)!==ee))for(let te=0;te<v;te+=y){const ne=(E+te)/g;if(ne<0||ne>=u.outWidth||Math.floor(ne)!==ne)continue;const ie=b*w*v-1-d.get(D,Y,ee,ne,A),ce=G*w*v+Z*v+te,ye=ie===ce?1:0;if(ye===0)continue;const ve=_.get(D,Y,ee,ne,A);V+=ve*ye}}}I.set(V,D,L,B,F,A)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const sye={kernelName:Kb,backendName:"cpu",kernelFunc:nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;me([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=Fr(a.shape,l,c,1,u,h),f=n.data.get(a.dataId).values,p=De(d.outShape,a.dtype,z6(f,a.shape,a.dtype,d).values),g=d.strideHeight,m=d.strideWidth,x=d.dilationHeight,y=d.dilationWidth,b=d.effectiveFilterHeight,w=d.effectiveFilterWidth,v=w-1-d.padInfo.left,S=b-1-d.padInfo.top,T=De(a.shape,"float32"),k=n.data.get(r.dataId).values,I=De(r.shape,"float32",k);for(let _=0;_<d.batchSize;++_)for(let D=0;D<d.inChannels;++D)for(let A=0;A<d.inHeight;++A)for(let L=0;L<d.inWidth;++L){const B=A-S,F=L-v;let R=0;for(let O=0;O<b;O+=x){const E=(B+O)/g;if(!(E<0||E>=d.outHeight||Math.floor(E)!==E))for(let V=0;V<w;V+=y){const G=(F+V)/m;if(G<0||G>=d.outWidth||Math.floor(G)!==G)continue;const Y=b*w-1-p.get(_,E,G,D),Z=O*w+V,ee=Y===Z?1:0;if(ee===0)continue;const te=I.get(_,E,G,D);R+=te*ee}}T.set(R,_,A,L,D)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const iye={kernelName:qb,backendName:"cpu",kernelFunc:rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oye(t,e,n,s,r){const i=we(e),o=tE(t,e,n,i,r,"max"),a=z6(t,e,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aye={kernelName:Xb,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;me(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=Fr(s.shape,r,i,[1,1],o),[h,d]=oye(c,s.shape,s.dtype,a,u),f=l.write(h,u.outShape,s.dtype),p=l.write(d,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=Oe(i,r.shape),c=Tn(r.shape,a)[1],u=Q(c),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));h.push(d);const f=Ua({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});h.push(f);const p=nE({inputs:{a:f,b:d},backend:n});h.push(p);const g=n0({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return h.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}const cye={kernelName:Zm,backendName:"cpu",kernelFunc:lye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;me(r,"min");const a=Oe(i,r.shape);let l=a;const c=Et(l,r.shape.length);let u=r;c!=null&&(u=Ss({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Ht(l.length,r.shape.length)),Mn("min",l,u.shape.length);const[h,d]=Tn(u.shape,l),f=Q(d),p=On(Q(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=g[y];for(let w=0;w<f;++w){const v=g[y+w];(Number.isNaN(v)||v<b)&&(b=v)}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const x=Wt(h,a),y=ut({inputs:{x:m},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(m),y}return m}const hye={kernelName:Jm,backendName:"cpu",kernelFunc:uye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,mode:o}=s;me(r,"mirrorPad");const a=i.map((b,w)=>b[0]+r.shape[w]+b[1]),l=i.map(b=>b[0]),c=i.map((b,w)=>b[0]+r.shape[w]),u=o==="reflect"?0:1,h=n.data.get(r.dataId).values,d=r.shape.length,f=we(r.shape),p=Q(a),g=a.length,m=we(a),x=vn(r.dtype,p);for(let b=0;b<p;b++){let w=Vc(b,g,m);for(let S=0;S<g;S++)w[S]<l[S]?w[S]=l[S]*2-w[S]-u:w[S]>=c[S]&&(w[S]=(c[S]-1)*2-w[S]+u);w=w.map((S,T)=>S-l[T]);const v=Zr(w,d,f);x[b]=h[v]}return{dataId:n.write(x,a,r.dtype),shape:a,dtype:r.dtype}}const fye={kernelName:eg,backendName:"cpu",kernelFunc:dye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pye=qt((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),mye=dn(nd,pye),gye={kernelName:nd,backendName:"cpu",kernelFunc:mye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Oe([a],r.shape),c=j6({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Wt(c.shape,l),h=ut({inputs:{x:c},backend:n,attrs:{shape:u}}),d=eE({inputs:{a:r,b:h},backend:n}),f=qW({inputs:{x:d},backend:n}),p=n0({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),g=ut({inputs:{x:p},backend:n,attrs:{shape:u}}),m=nE({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const xye={kernelName:yg,backendName:"cpu",kernelFunc:H6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yye(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s;me(r,"multinomial");const l=a?r:H6({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,d=[c,i],f=On(Q(d),"int32");for(let p=0;p<c;++p){const g=p*u,m=new Float32Array(u-1);m[0]=h[g];for(let b=1;b<m.length;++b)m[b]=m[b-1]+h[g+b];const x=$d.alea(o.toString()),y=p*i;for(let b=0;b<i;++b){const w=x();f[y+b]=m.length;for(let v=0;v<m.length;v++)if(w<m[v]){f[y+b]=v;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",f)}const bye={kernelName:Yb,backendName:"cpu",kernelFunc:yye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wye=iv;function vye(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;me(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:h}=wye(c,u,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Sye={kernelName:Qb,backendName:"cpu",kernelFunc:vye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kye=ov;function Cye(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;me(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:f}=kye(u,h,o,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const Tye={kernelName:Zb,backendName:"cpu",kernelFunc:Cye};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iye=av;function Nye(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;me(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,d=o,f=a,p=l,g=c,{selectedIndices:m,selectedScores:x}=Iye(u,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const _ye={kernelName:Jb,backendName:"cpu",kernelFunc:Nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ye(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s;me(r,"oneHot");const c=Q(r.shape),u=new Float32Array(c*o);u.fill(l);const h=n.data.get(r.dataId).values;for(let d=0;d<c;++d)h[d]>=0&&h[d]<o&&(u[d*o+h[d]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const Eye={kernelName:rg,backendName:"cpu",kernelFunc:$ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Cc({inputs:{input:s},backend:n}),i=x1({inputs:{x:r},backend:n}),o=gh({inputs:{input:s},backend:n}),a=x1({inputs:{x:o},backend:n}),l=Rs({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return sE({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const Dye={kernelName:Sg,backendName:"cpu",kernelFunc:x1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Cc({inputs:{input:s},backend:n}),i=G6({inputs:{x:r},backend:n}),o=gh({inputs:{input:s},backend:n}),a=x1({inputs:{x:o},backend:n}),l=Rs({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return sE({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const Aye={kernelName:sg,backendName:"cpu",kernelFunc:G6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return g1({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Pn(i,u.shape,"All tensors passed to stack must have matching shapes"),N(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=g1({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(h),h}),c=xh({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const Rye={kernelName:ig,backendName:"cpu",kernelFunc:q6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;me(r,"pad");const a=i.map((y,b)=>y[0]+r.shape[b]+y[1]),l=i.map(y=>y[0]),c=n.data.get(r.dataId).values,u=Q(r.shape),h=r.shape.length,d=we(r.shape),f=Q(a),p=a.length,g=we(a),m=vn(r.dtype,f);o!==0&&m.fill(o);for(let y=0;y<u;y++){const w=Vc(y,h,d).map((S,T)=>S+l[T]),v=Zr(w,p,g);m[v]=c[y]}return{dataId:n.write(m,a,r.dtype),shape:a,dtype:r.dtype}}const K6={kernelName:og,backendName:"cpu",kernelFunc:Oye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pye=qt((t,e)=>Math.pow(t,e)),Fye=dn(rd,Pye),Mye={kernelName:rd,backendName:"cpu",kernelFunc:Fye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lye(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,a=r.map(m=>n.data.get(m.dataId).values),l=r.map(m=>m.shape),c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[h,d,f]=h6(a,l,c,i.shape,i.dtype,u,o.shape),p=h.map(m=>n.makeTensorInfo([m.length],"int32",m)),g=n.makeTensorInfo(f,i.dtype,d);return p.concat([g])}const zye={kernelName:ew,backendName:"cpu",kernelFunc:Lye};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bye(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=d6(o,s.shape,s.dtype,a,r.shape,l,i.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],s.dtype,u);return[h,d]}const Vye={kernelName:tw,backendName:"cpu",kernelFunc:Bye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wye(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,d=a.map(m=>n.data.get(m.dataId).values),f=a.map(m=>m.shape),[p,g]=f6(c,r.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,g)}const Uye={kernelName:nw,backendName:"cpu",kernelFunc:Wye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jye(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:i,step:o}=n,a=p6(s,r,o,i);return e.makeTensorInfo([a.length],i,a)}const Hye={kernelName:sw,backendName:"cpu",kernelFunc:jye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gye=Je(id,t=>1/t),qye={kernelName:id,backendName:"cpu",kernelFunc:Gye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kye(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;me(r,"resizeBilinear");const l=we(r.shape),[c,u]=a,[h,d,f,p]=r.shape,g=n.data.get(r.dataId).values,m=new Float32Array(Q([h,c,u,p])),x=[i&&c>1?d-1:d,i&&u>1?f-1:f],y=[i&&c>1?c-1:c,i&&u>1?u-1:u];let b=0;const w=x[0]/y[0],v=x[1]/y[1];for(let S=0;S<h;S++)for(let T=0;T<c;T++){let k;o?k=w*(T+.5)-.5:k=w*T;const I=Math.max(0,Math.floor(k)),_=k-I,D=Math.min(d-1,Math.ceil(k)),A=S*l[0]+I*l[1],L=S*l[0]+D*l[1];for(let B=0;B<u;B++){let F;o?F=v*(B+.5)-.5:F=v*B;const R=Math.max(0,Math.floor(F)),O=F-R,E=Math.min(f-1,Math.ceil(F)),V=A+R*l[2],G=L+R*l[2],Y=A+E*l[2],Z=L+E*l[2];for(let ee=0;ee<p;ee++){const te=g[V+ee],ne=g[G+ee],ie=g[Y+ee],ce=g[Z+ee],ye=te+(ie-te)*O,ve=ne+(ce-ne)*O,Ie=ye+(ve-ye)*_;m[b++]=Ie}}}return n.makeTensorInfo([h,c,u,p],"float32",m)}const Xye={kernelName:hg,backendName:"cpu",kernelFunc:Kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yye(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;me([i,r],"resizeBilinearGrad");const a=we(r.shape),[l,c,u,h]=r.shape,[,d,f]=i.shape,p=new Float32Array(l*c*u*h),g=[o&&d>1?c-1:c,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],x=g[0]/m[0],y=g[1]/m[1],b=n.data.get(i.dataId).values;let w=0;for(let v=0;v<l;v++){const S=v*a[0];for(let T=0;T<d;T++){const k=T*x,I=Math.floor(k),_=Math.min(Math.ceil(k),c-1),D=S+I*a[1],A=S+_*a[1],L=k-I,B=1-L;for(let F=0;F<f;F++){const R=F*y,O=Math.floor(R),E=Math.min(Math.ceil(R),u-1),V=R-O,G=1-V,Y=D+O*a[2],Z=D+E*a[2],ee=A+O*a[2],te=A+E*a[2],ne=B*G,ie=B*V,ce=L*G,ye=L*V;for(let ve=0;ve<h;ve++){const Ie=b[w++];p[Y+ve]+=Ie*ne,p[Z+ve]+=Ie*ie,p[ee+ve]+=Ie*ce,p[te+ve]+=Ie*ye}}}}return n.makeTensorInfo([l,u,c,h],"float32",p)}const Qye={kernelName:ow,backendName:"cpu",kernelFunc:Yye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zye(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;me(r,"resizeNearestNeighbor");const l=we(r.shape),[c,u]=a,[h,d,f,p]=r.shape,g=n.data.get(r.dataId).values,m=new Float32Array(h*c*u*p),x=[i&&c>1?d-1:d,i&&u>1?f-1:f],y=[i&&c>1?c-1:c,i&&u>1?u-1:u],b=x[0]/y[0],w=x[1]/y[1];let v=0;for(let S=0;S<h;S++){const T=S*l[0];for(let k=0;k<c;k++){const I=o?b*(k+.5):b*k;let _=Math.min(d-1,i?Math.round(I):Math.floor(I));o&&(_=Math.max(0,_));const D=T+_*l[1];for(let A=0;A<u;A++){const L=o?w*(A+.5):w*A;let B=Math.min(f-1,i?Math.round(L):Math.floor(L));o&&(B=Math.max(0,B));const F=D+B*l[2];for(let R=0;R<p;R++){const O=g[F+R];m[v++]=O}}}}return n.makeTensorInfo([h,c,u,p],r.dtype,m)}const Jye={kernelName:ug,backendName:"cpu",kernelFunc:Zye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;me([i,r],"resizeNearestNeighborGrad");const a=we(r.shape),l=we(i.shape),[c,u,h,d]=r.shape,[,f,p]=i.shape,g=new Float32Array(c*u*h*d),m=n.data.get(i.dataId).values,x=[o&&f>1?u-1:u,o&&p>1?h-1:h],y=[o&&f>1?f-1:f,o&&p>1?p-1:p],b=x[0]/y[0],w=x[1]/y[1],v=1/b,S=1/w,T=Math.ceil(v)*2+2,k=Math.ceil(S)*2+2;for(let I=0;I<c;I++){const _=I*a[0];for(let D=0;D<u;D++){const A=_+D*a[1],L=Math.floor(D*v),B=Math.floor(L-T/2);for(let F=0;F<h;F++){const R=A+F*a[2],O=Math.floor(F*S),E=Math.floor(O-k/2);for(let V=0;V<d;V++){let G=0;for(let Y=0;Y<T;Y++){const Z=Y+B;if(Z<0||Z>=f)continue;const ee=_+Z*l[1],te=Z*b,ne=Math.min(u-1,o?Math.round(te):Math.floor(te));if(D===ne)for(let ie=0;ie<k;ie++){const ce=ie+E;if(ce<0||ce>=p)continue;const ye=ee+ce*l[2],ve=ce*w,Ie=Math.min(h-1,o?Math.round(ve):Math.floor(ve));F===Ie&&(G+=m[ye+V])}}g[R+V]=G}}}}return n.makeTensorInfo(r.shape,r.dtype,g)}const t1e={kernelName:iw,backendName:"cpu",kernelFunc:e1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s;me(r,"reverse");const o=r.shape.length,a=Oe(i,r.shape);if(o===0)return zi({inputs:{x:r},backend:n});const l=new nn(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const h=l.indexToLoc(u),d=h.slice();a.forEach(f=>d[f]=r.shape[f]-1-d[f]),l.set(c.get(...d),...h)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const s1e={kernelName:dg,backendName:"cpu",kernelFunc:n1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1e={kernelName:kw,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=vn(s.dtype,Q(s.shape)),[c,u,h,d]=s.shape,[f,p]=QN(o,u,h),g=255,m=Math.sin(r),x=Math.cos(r),y=a.data.get(s.dataId).values;for(let w=0;w<c;w++){const v=w*h*u*d;for(let S=0;S<u;S++){const T=S*(h*d);for(let k=0;k<h;k++){const I=k*d;for(let _=0;_<d;_++){const D=[c,S,k,_],A=D[2],L=D[1];let B=(A-f)*x-(L-p)*m,F=(A-f)*m+(L-p)*x;B=Math.round(B+f),F=Math.round(F+p);let R=i;if(typeof i!="number"&&(_===3?R=g:R=i[_]),B>=0&&B<h&&F>=0&&F<u){const E=F*(h*d),V=B*d,G=v+E+V+_;R=y[G]}const O=v+T+I+_;l[O]=R}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1e=Je(ld,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),o1e={kernelName:ld,backendName:"cpu",kernelFunc:i1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=ol(i,r,o),d=!0,f=n.bufferSync(r),p=n.bufferSync(i),g=Bl(f,p,o,h,c,l,a,u,0,d);return n.makeTensorInfo(o,g.dtype,g.values)}const l1e={kernelName:aw,backendName:"cpu",kernelFunc:a1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c1e(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function u1e(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function h1e(t,e,n,s,r,i){const o=Ot("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?c1e(l,e[u+c]):u1e(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1e(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=h1e(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const f1e={kernelName:cw,backendName:"cpu",kernelFunc:d1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1e(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e;me([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=xs(r.dtype,i.dtype),h=On(Q(r.shape),u);let d=0;const f=o===0||o>1||r.shape.length===1?1:Q(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let g=0;g<f;g++)a[p]===1?h[d++]=l[p]:h[d++]=c[p];return n.makeTensorInfo(r.shape,u,h)}const m1e={kernelName:fg,backendName:"cpu",kernelFunc:p1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g1e=dv,x1e=fv,y1e=Je(ud,t=>t>=0?x1e*t:g1e*(Math.exp(t)-1)),b1e={kernelName:ud,backendName:"cpu",kernelFunc:y1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1e=Je(fd,t=>t<0?-1:t>0?1:0),v1e={kernelName:fd,backendName:"cpu",kernelFunc:w1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S1e=Je(hd,t=>Math.sin(t)),k1e={kernelName:hd,backendName:"cpu",kernelFunc:S1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C1e=Je(dd,t=>Math.sinh(t)),T1e={kernelName:dd,backendName:"cpu",kernelFunc:C1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I1e=11920928955078125e-23,YO=Math.log(I1e)+2,N1e=Je(md,t=>{const e=t>-YO,n=t<YO,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),_1e={kernelName:md,backendName:"cpu",kernelFunc:N1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;me([r],"spaceToBatchND");const a=Q(i),l=[[0,0]];l.push(...o);for(let S=1+i.length;S<r.shape.length;++S)l.push([0,0]);const c=K6.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=Ug(c.shape,i,a,!1),h=jg(u.length,i.length,!1),d=Hg(c.shape,i,a,!1),g=ut({inputs:{x:c},backend:n,attrs:{shape:u}}),y=Ss({inputs:{x:g},backend:n,attrs:{perm:h}}),v=ut({inputs:{x:y},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),v}const E1e={kernelName:gg,backendName:"cpu",kernelFunc:$1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1e(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[h,d,f,p,g]=y6(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const A1e={kernelName:uw,backendName:"cpu",kernelFunc:D1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1e(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,h]=b6(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const O1e={kernelName:hw,backendName:"cpu",kernelFunc:R1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=J$(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const F1e={kernelName:dw,backendName:"cpu",kernelFunc:P1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=J$(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const L1e={kernelName:fw,backendName:"cpu",kernelFunc:M1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1e(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=ol(i,r,a),f=!1,p=n.bufferSync(r);let g;switch(i.dtype){case"bool":{const m=n.bufferSync(i),x=!!n.data.get(o.dataId).values[0];g=Bl(p,m,a,d,u,c,l,h,x,f);break}case"float32":{const m=n.bufferSync(i),x=n.data.get(o.dataId).values[0];g=Bl(p,m,a,d,u,c,l,h,x,f);break}case"int32":{const m=n.bufferSync(i),x=n.data.get(o.dataId).values[0];g=Bl(p,m,a,d,u,c,l,h,x,f);break}case"string":{const m=n.bufferSync(i),x=Co(n.data.get(o.dataId).values[0]);g=Bl(p,m,a,d,u,c,l,h,x,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const B1e={kernelName:pw,backendName:"cpu",kernelFunc:z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=Oe(o,r.shape)[0],l=d_(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(h=>{const d=[...u];d[a]=h;const f=Tc({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});return c[a]+=h,f})}const W1e={kernelName:xg,backendName:"cpu",kernelFunc:V1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U1e={kernelName:mw,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;me(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j1e=Je(Sd,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),H1e={kernelName:Sd,backendName:"cpu",kernelFunc:j1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s;me(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:x,begin:y,end:b,strides:w}=qN(r.shape,i,o,a,l,c,u,h,d);let v;if(g)v=ut({inputs:{x:r},backend:n,attrs:{shape:p}});else if(m||x){N(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const S=jN(y,b,w),T=Tc({inputs:{x:r},backend:n,attrs:{begin:y,size:S}});v=ut({inputs:{x:T},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(T)}else{const S=n.bufferSync(r),T=S6(f,S,w,y);v=n.makeTensorInfo(p,T.dtype,T.values)}return v}const q1e={kernelName:gw,backendName:"cpu",kernelFunc:G1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=e,d=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[p,g]=k6(d,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}const X1e={kernelName:xw,backendName:"cpu",kernelFunc:K1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,h]=C6(a,l,r),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const Q1e={kernelName:yw,backendName:"cpu",kernelFunc:Y1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z1e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=T6(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const J1e={kernelName:bw,backendName:"cpu",kernelFunc:Z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ebe=Je(bd,t=>Math.tan(t)),tbe={kernelName:bd,backendName:"cpu",kernelFunc:ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nbe=Je(wd,t=>Math.tanh(t)),sbe={kernelName:wd,backendName:"cpu",kernelFunc:nbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rbe(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=ol(i,r,s.shape),h=!1,d=n.bufferSync(r),f=n.bufferSync(i),p=n.bufferSync(s),g=Bl(d,f,s.shape,u,l,a,o,c,p,h);return n.makeTensorInfo(s.shape,g.dtype,g.values)}const ibe={kernelName:lw,backendName:"cpu",kernelFunc:rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function obe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;me(r,"tile");const o=N6(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const abe={kernelName:vd,backendName:"cpu",kernelFunc:obe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s;me(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=$6(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const cbe={kernelName:ww,backendName:"cpu",kernelFunc:lbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ube(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,h,d,f]=r.shape,[p,g]=c??[h,d],m=[u,p,g,f],x=we(r.shape),y=x[0],b=x[1],w=x[2],v=we(m),S=v[0],T=v[1],k=v[2],I=vn(r.dtype,Q(m));I.fill(l);const _=s.data.get(r.dataId).values,D=s.data.get(i.dataId).values;for(let L=0;L<u;++L){const B=i.shape[0]===1?D:D.subarray(L*8,L*8+8);for(let F=0;F<p;++F)for(let R=0;R<g;++R)for(let O=0;O<f;++O){let E;const V=B[6]*R+B[7]*F+1;if(V===0)continue;const G=(B[0]*R+B[1]*F+B[2])/V,Y=(B[3]*R+B[4]*F+B[5])/V,Z=QO(G,d,a),ee=QO(Y,h,a);switch(o){case"nearest":E=gbe(_,h,d,y,b,w,L,ee,Z,O,l);break;case"bilinear":E=xbe(_,h,d,y,b,w,L,ee,Z,O,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const te=L*S+F*T+R*k+O;I[te]=E}return s.makeTensorInfo(m,r.dtype,I)}return{dataId:s.write(I,m,r.dtype),shape:r.shape,dtype:r.dtype}}const hbe={kernelName:vw,backendName:"cpu",kernelFunc:ube};function QO(t,e,n){switch(n){case"reflect":return dbe(t,e);case"wrap":return fbe(t,e);case"nearest":return mbe(t,e);case"constant":default:return pbe(t)}}function dbe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Ra(0,n,e-1)}function fbe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Ra(0,n,e-1)}function pbe(t,e){return t}function mbe(t,e){return Ra(0,t,e-1)}function _f(t,e,n,s,r,i,o,a,l,c,u){const h=o*s+a*r+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[h]:u}function gbe(t,e,n,s,r,i,o,a,l,c,u){const h=Math.round(a),d=Math.round(l);return _f(t,e,n,s,r,i,o,h,d,c,u)}function xbe(t,e,n,s,r,i,o,a,l,c,u){const h=Math.floor(a),d=Math.floor(l),f=h+1,p=d+1,g=(p-l)*_f(t,e,n,s,r,i,o,h,d,c,u)+(l-d)*_f(t,e,n,s,r,i,o,h,p,c,u),m=(p-l)*_f(t,e,n,s,r,i,o,f,d,c,u)+(l-d)*_f(t,e,n,s,r,i,o,f,p,c,u);return(f-a)*g+(a-h)*m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ybe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;me(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=E6(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const bbe={kernelName:Sw,backendName:"cpu",kernelFunc:ybe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wbe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=r.shape[f]);const u=new Array(o).fill(0),h=r.shape.slice();h[i]=1;const d=new Array(a);for(let f=0;f<d.length;f++){u[i]=f;const p=Tc({inputs:{x:r},backend:n,attrs:{begin:u,size:h}});d[f]=ut({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return d}const vbe={kernelName:wg,backendName:"cpu",kernelFunc:wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s;me(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],h=a-l;let d=i;for(let p=0;p<h;++p){const g=g1({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=g,u.push(g)}for(let p=0;p<o;++p){const g=Ao(p,"int32"),m=n.makeTensorInfo([],"int32",g),x=HW({inputs:{a:m,b:d},backend:n}),y=Ua({inputs:{x},backend:n,attrs:{dtype:"float32"}}),b=Pv({inputs:{a:y,b:r},backend:n}),w=n0({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(w),u.push(m),u.push(x),u.push(y),u.push(b),u.push(w)}const f=q6({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const kbe={kernelName:vg,backendName:"cpu",kernelFunc:Sbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cbe=[yge,Jpe,wge,Sge,ime,Cge,Ige,_ge,Ege,Age,Oge,Fge,Lge,Vge,Uge,Gge,Kge,Yge,Zge,gge,e0e,n0e,r0e,ame,o0e,sme,cme,l0e,eme,u0e,d0e,f0e,m0e,x0e,b0e,v0e,k0e,T0e,N0e,$0e,D0e,R0e,P0e,M0e,L0e,B0e,W0e,j0e,H0e,G0e,q0e,X0e,Z0e,cge,exe,ume,lxe,hme,cxe,fme,mxe,gxe,yxe,mme,xme,wxe,Sxe,Cxe,Ixe,bme,vme,tme,_xe,h0e,Exe,Axe,Oxe,uge,kme,Tme,Fxe,Nme,Lxe,Vxe,Uxe,Gxe,Kxe,Yxe,Qxe,$me,Jxe,tye,sye,iye,aye,cye,hye,Dme,fye,gye,bye,Rme,Pme,Sye,Tye,_ye,Mme,Eye,Aye,Rye,K6,Mye,dge,Bme,zye,Vye,Uye,Hye,nme,dC,qye,fge,pge,mge,Xye,Qye,Jye,t1e,s1e,r1e,o1e,Kme,l1e,f1e,m1e,b1e,Yme,v1e,k1e,T1e,Qme,xye,_1e,E1e,A1e,O1e,F1e,L1e,B1e,W1e,ege,U1e,nge,rge,H1e,q1e,X1e,Q1e,J1e,lge,Y0e,tbe,sbe,ibe,abe,cbe,hbe,Lme,bbe,vbe,kbe,Dye];for(const t of Cbe)Cw(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Al={},q0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function X6(t,e){Al[t]=e}function ai(t,e){if(!(t in Al)||e!=null){const s=Ibe(t,e);if(s!==null)Al[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Al[t];return n==null||n.isContextLost()?(delete Al[t],ai(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Al[t])}function Tbe(t){if(!K().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Ibe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Tbe(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Al[t]},!1),K().getBool("SOFTWARE_WEBGL_ENABLED")&&(q0.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",q0)||n.getContext("experimental-webgl",q0):n.getContext("webgl2",q0)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Yp;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Yp||(Yp={}));var rr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(rr||(rr={}));var Dn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Dn||(Dn={}));function s0(t,e){return[e,t]}function Nbe(t,e){return t*e}function K0(t){const e=Q(t),n=Math.ceil(e/4);return jy(n)}function Md(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function _be(t,e){const[n,s]=Md(t,e);return n*s*4}function rE(t,e){const n=t;let s,r,i,o,a,l,c,u,h,d;return K().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,h=e!=null?e.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ue(t,e){const n=e();return K().getBool("DEBUG")&&$be(t),n}function $be(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Q6(t,e))}const Ebe=596e-10,Dbe=65504;function Y6(t){return!!(K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||Ebe<Math.abs(t)&&Math.abs(t)<Dbe)}function Q6(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function $f(t,e){return zo(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Z6(t,e){const n=zo(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ue(t,()=>t.shaderSource(n,e)),ue(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function J6(t,e){const n=zo(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ue(t,()=>t.shaderSource(n,e)),ue(t,()=>t.compileShader(n)),K().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw iE(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Abe=/ERROR: [0-9]+:([0-9]+):/g;function iE(t,e){const n=Abe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),i=r.length.toString().length+2,o=r.map((h,d)=>Gl((d+1).toString(),i)+h);let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Gl(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function eU(t){return zo(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function tU(t,e){if(ue(t,()=>t.linkProgram(e)),!K().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Rx(t,e){if(ue(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function nU(t,e){const n=zo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ue(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function sU(t,e){const n=zo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ue(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),ue(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Rbe(){return K().getNumber("WEBGL_VERSION")===2?1:4}function rU(t){return zo(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function iU(t,e){const n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function oU(t){return zo(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function pC(t,e,n,s,r,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),ue(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,i,o)),ue(t,()=>t.enableVertexAttribArray(a)),!0)}function aU(t,e,n){dU(t,n),ue(t,()=>t.activeTexture(t.TEXTURE0+n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Obe(t,e){dU(t,e),ue(t,()=>t.activeTexture(t.TEXTURE0+e)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function lU(t,e,n){return zo(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function cU(t,e,n){return t.getUniformLocation(e,n)}function uU(t,e,n,s){ue(t,()=>aU(t,e,s)),ue(t,()=>t.uniform1i(n,s))}function Pbe(t){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),ue(t,()=>t.viewport(0,0,t.canvas.width,t.canvas.height)),ue(t,()=>t.scissor(0,0,t.canvas.width,t.canvas.height))}function Ox(t,e,n){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function mC(t,e){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Ef(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+hU(t,e))}function hU(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function zo(t,e,n){const s=ue(t,()=>e());if(s==null)throw new Error(n);return s}function dU(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Ic(t,e=2){return Q(t.slice(0,t.length-e))}function Nc(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Df(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Ic(t),...Nc(t)]),e}function fU(t,e=!1){let n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=K().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&K().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?xb(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Do(t).newShape);let r=Q(t),i=null;t.length<=1&&r<=n?i=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=Ic(t);let l=2,c=2;t.length&&([l,c]=Nc(t)),r=a*(l/2)*(c/2),i=jy(r).map(u=>u*2)}else i=jy(r);return i}function X0(t){return t%2===0}function Qp(t,e){if(t=t.slice(-2),e=e.slice(-2),Fe(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||X0(n)&&X0(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&X0(t[0])&&X0(e[0])}let Px,Fx;function pU(t){if(Px==null){const e=ai(t);Px=e.getParameter(e.MAX_TEXTURE_SIZE)}return Px}function Fbe(){Px=null}function Mbe(){Fx=null}function mU(t){if(Fx==null){const e=ai(t);Fx=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Fx)}function gU(t){if(t===0)return 0;let e;const n=ai(t);return ir(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:ir(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function ir(t,e){return t.getExtension(e)!=null}function gC(t){try{if(ai(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function xU(t){if(t===0)return!1;const e=ai(t);if(t===1){if(!ir(e,"OES_texture_float"))return!1}else if(!ir(e,"EXT_color_buffer_float"))return!1;return xC(e)}function yU(t){if(t===0)return!1;const e=ai(t);if(t===1){if(!ir(e,"OES_texture_float")||!ir(e,"WEBGL_color_buffer_float"))return!1}else{if(ir(e,"EXT_color_buffer_float"))return xC(e);const s="EXT_color_buffer_half_float";if(ir(e,s)){const r=e.getExtension(s);return Lbe(e,r)}return!1}return xC(e)}function xC(t){const e=rE(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function Lbe(t,e){const n=rE(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),a}function bU(t){return t!==2?!1:ai(t).fenceSync!=null}function Ld(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&N(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}const zbe=Object.freeze(Object.defineProperty({__proto__:null,assertNotComplex:Ld,bindCanvasToFramebuffer:Pbe,bindColorTextureToFramebuffer:Ox,bindTextureToProgramUniformSampler:uU,bindTextureUnit:aU,bindVertexBufferToProgramAttribute:pC,callAndCheck:ue,canBeRepresented:Y6,createFragmentShader:J6,createFramebuffer:oU,createProgram:eU,createStaticIndexBuffer:sU,createStaticVertexBuffer:nU,createTexture:rU,createVertexShader:Z6,getBatchDim:Ic,getExtensionOrThrow:$f,getFramebufferErrorMessage:hU,getMaxTexturesInShader:mU,getNumChannels:Rbe,getProgramUniformLocation:cU,getProgramUniformLocationOrThrow:lU,getRowsCols:Nc,getShapeAs3D:Df,getTextureShapeFromLogicalShape:fU,getWebGLDisjointQueryTimerVersion:gU,getWebGLErrorMessage:Q6,getWebGLMaxTextureSize:pU,hasExtension:ir,isCapableOfRenderingToFloatTexture:xU,isDownloadFloatTextureEnabled:yU,isReshapeFree:Qp,isWebGLFenceEnabled:bU,isWebGLVersionEnabled:gC,linkProgram:tU,logShaderSourceAndInfoLog:iE,resetMaxTextureSize:Fbe,resetMaxTexturesInShader:Mbe,unbindColorTextureFromFramebuffer:mC,unbindTextureUnit:Obe,validateFramebuffer:Ef,validateProgram:Rx,validateTextureSize:iU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xe=K();xe.registerFlag("HAS_WEBGL",()=>xe.getNumber("WEBGL_VERSION")>0);xe.registerFlag("WEBGL_VERSION",()=>gC(2)?2:gC(1)?1:0);xe.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);xe.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>xe.get("WEBGL_VERSION")===2);xe.registerFlag("WEBGL_CPU_FORWARD",()=>!0);xe.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);xe.registerFlag("WEBGL_PACK",()=>xe.getBool("HAS_WEBGL"));xe.registerFlag("WEBGL_PACK_NORMALIZATION",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_CLIP",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_REDUCE",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_LAZILY_UNPACK",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_CONV_IM2COL",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>pU(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>mU(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=xe.getNumber("WEBGL_VERSION");return t===0?0:gU(t)});xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>xe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!pI());xe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>xU(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>xe.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:xe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));xe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>yU(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_FENCE_API_ENABLED",()=>bU(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>xe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);xe.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});xe.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>pI()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});xe.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);xe.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);xe.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);xe.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);xe.registerFlag("WEBGL_EXP_CONV",()=>!1);xe.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>xe.getBool("IS_TEST"));xe.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);xe.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);xe.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);xe.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function us(){let t,e,n,s,r,i,o,a,l,c;return K().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=K().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zc(t,e,n="index"){const s=we(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r}`:`index -= ${t[i]} * ${r}`;return`${o}; ${a};`}).join("")}function Fv(t,e,n="index"){const s=we(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function Bbe(t,e){const n=t.length,s=t.map(i=>`${e}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function Vbe(t,e,n="index"){const s=t.map((i,o)=>o),r=Bbe(s,e);return r.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function oE(t){const e=we(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function aE(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const wU=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:vU}=t5;function Wbe(t,e,n){const s=[];if(t.forEach(f=>{const p=Q(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:g}=lE(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),i=t.map(f=>Ube(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=us(),l=Gbe(a);let c,u,h=Xbe(a);return e.isPacked?(c=jbe(e.logicalShape,o,n.enableShapeUniforms),u=Kbe(a)):(c=Hbe(e.logicalShape,o,n.enableShapeUniforms),u=qbe(a)),n.packedInputs&&(h+=Jbe),[h,l,u,r,c,i,n.userCode].join(`
`)}function zd(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return hwe(t,e);case 1:return fwe(t,e);case 2:return mwe(t,e);case 3:return xwe(t,e);case 4:return bwe(t,e);case 5:return wwe(t);case 6:return vwe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function SU(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return uwe(t);case 1:return dwe(t,e);case 2:return pwe(t,e);case 3:return gwe(t,e);default:return ywe(t,e)}}function Ube(t,e,n=!1,s){let r="";n?r+=SU(t,s):r+=zd(t,s);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?r+=Swe(t,e):r+=kwe(t,e)),r}function jbe(t,e,n){switch(t.length){case 0:return kU();case 1:return ewe(t,e,n);case 2:return lwe(t,e,n);case 3:return nwe(t,e,n);default:return rwe(t,e,n)}}function Hbe(t,e,n){switch(t.length){case 0:return kU();case 1:return twe(t,e,n);case 2:return cwe(t,e,n);case 3:return swe(t,e,n);case 4:return iwe(t,e,n);case 5:return owe(t,e);case 6:return awe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Gbe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function qbe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Kbe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Xbe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Ybe}
    ${Qbe}
    ${Zbe}
  `}const Ybe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Qbe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Zbe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Jbe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function kU(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function ewe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function twe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function nwe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function swe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Fv(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Zc(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function rwe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function iwe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Fv(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Zc(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function owe(t,e){const n=Zc(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function awe(t,e){const n=Zc(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function lwe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Fe(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function cwe(t,e,n){return Fe(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Jc(t){return`offset${t}`}function uwe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=us();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function hwe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=t.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Jc(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function dwe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,i=us();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function fwe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Bd(t)}
      }
    `;const r=t.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Jc(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function pwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=us();if(i!=null&&Fe(n,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function mwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape;if(i!=null&&Fe(n,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const d=i[0],f=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=Do(n),l=o;if(l.length<n.length){const d=Vd(t,l),f=["row","col"];return`
      ${zd(d,e)}
      float ${r}(int row, int col) {
        return ${r}(${Wd(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Bd(t)}
      }
    `;const c=i[0],u=i[1],h=Jc(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${h};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function gwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const d=n.slice(1),f=[1,2],p=Vd(t,d),g=["b","row","col"];return`
        ${SU(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${Wd(g,f)});
        }
      `}const a=us();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${h}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function xwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=Do(n),c=a;if(c.length<n.length){const g=Vd(t,c),m=["row","col","depth"];return`
        ${zd(g,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${Wd(m,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Bd(t)}
      }
    `;const u=t.shapeInfo.texShape,h=u[0],d=u[1],f=t.shapeInfo.flatOffset;if(d===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(d===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=Jc(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${s}, uv);
      }
  `}function ywe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=us();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],h=Math.ceil(i[o-1]/2);let d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let g=2;g<o-1;g++)f=`int b${g}, `+f,d*=i[o-g-1],p=`b${g} * ${d} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function bwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=Do(n);if(l.length<n.length){const y=Vd(t,l),b=["row","col","depth","depth2"];return`
      ${zd(y,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${Wd(b,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Bd(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1],p=`int stride2 = ${s}Shape[3];`,g=`int stride1 = ${s}Shape[2] * stride2;`,m=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===i&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;const x=Jc(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${m}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${x});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${x});
      return sampleTexture(${s}, uv);
    }
  `}function wwe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],i=e[3]*r,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=Do(e);if(l.length<e.length){const g=Vd(t,l),m=["row","col","depth","depth2","depth3"];return`
      ${zd(g)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Wd(m,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${Bd(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Jc(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function vwe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=Do(e);if(r.length<e.length){const m=Vd(t,r),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${zd(m)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Wd(x,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Bd(t)}
      }
    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];if(p===u&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Jc(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${g};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Bd(t){const e=t.name,n=Q(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Swe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=vU(t.shapeInfo.logicalShape,e.logicalShape),l=ot(o),c=o-i;let u;const h=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(y=>`coords.${h[y+c]} = 0;`).join(`
`);let d="";o<2&&i>0?d="coords":d=t.shapeInfo.logicalShape.map((y,b)=>`coords.${h[b+c]}`).join(", ");let f="return outputValue;";const g=Q(t.shapeInfo.logicalShape)===1,x=Q(e.logicalShape)===1;if(i===1&&!g&&!x)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!x)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const y=i-2,b=i-1;a.indexOf(y)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${d});
      ${f}
    }
  `}function kwe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Fe(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=ot(l),u=vU(t.shapeInfo.logicalShape,e.logicalShape),h=l-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":l<2&&u.length>=1?d="coords = 0;":d=u.map(g=>`coords.${f[g+h]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((g,m)=>`coords.${f[m+h]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${s}(${p});
    }
  `}function ot(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function lE(t,e,n){const{newShape:s,keptDims:r}=Do(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):s,l=!t&&i>1&&!Fe(e,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function Vd(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Wd(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwe(t,e,n,s){const r=n.map((u,h)=>{const d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:d}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=Wbe(r,o,e),l=J6(t.gl,a),c=t.createProgram(l);return K().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},CU(t,e,c)))}function CU(t,e,n){const s=[],r=[];let i,o,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),K().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const h of e.variableNames){const d={name:h,uniform:t.getUniformLocation(n,h,u),offset:t.getUniformLocation(n,`offset${h}`,u)};e.enableShapeUniforms&&(d.shape=t.getUniformLocation(n,`${h}Shape`,u),d.texShape=t.getUniformLocation(n,`${h}TexShape`,u)),s.push(d)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const h of e.customUniforms)r.push(t.getUniformLocation(n,h.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function ZO(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,i=e[s],o=i.shape;if(!Fe(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!Fe(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Twe(t,e,n,s,r){e.program.enableShapeUniforms||(ZO(e.inShapeInfos,n),ZO([e.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),K().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:h,shape:d,texShape:f}=e.variablesLocations[l];if(d){const{uniformShape:p}=lE(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(d,new Int32Array(p));break;case 2:t.gl.uniform2iv(d,new Int32Array(p));break;case 3:t.gl.uniform3iv(d,new Int32Array(p));break;case 4:t.gl.uniform4iv(d,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(Q(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&h!=null&&t.gl.uniform1i(h,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=we(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],h=r[l];if(c.type==="float")t.gl.uniform1fv(u,h);else if(c.type==="vec2")t.gl.uniform2fv(u,h);else if(c.type==="vec3")t.gl.uniform3fv(u,h);else if(c.type==="vec4")t.gl.uniform4fv(u,h);else if(c.type==="int")t.gl.uniform1iv(u,h);else if(c.type==="ivec2")t.gl.uniform2iv(u,h);else if(c.type==="ivec3")t.gl.uniform3iv(u,h);else if(c.type==="ivec4")t.gl.uniform4iv(u,h);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function Iwe(t,e,n){let s="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:h}=lE(t.packedInputs,o.shape,l);let d="",f="",p="";if(u.length===1&&t.packedInputs){const v=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${v[0]>1}_${v[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const v=we(u);p=`${v[0]===l[1]}_${v[v.length-1]===l[1]}`}const g=o.shape.length,m=u.length===2&&Fe(o.shape,l),x=Q(o.shape)===1,y=xc(o.shape,n.shape),b=!t.packedInputs&&g===n.shape.length&&Fe(l,n.texData.texShape),w=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${g}_${b}_${c?h:""}_${u.length}_${x}_${y}_${m}_${d}_${f}_${p}_${w}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=t.userCode;let i=t.constructor.name;return i+="_"+s+"_"+r+`${K().getNumber("WEBGL_VERSION")}`,i}function Hn(t){return K().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nwe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Yp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=us();this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Fv(["r","c","d"],e):Zc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _we{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Yp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=us();this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Fv(["r","c","d"],e):Zc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $we{constructor(e){this.variableNames=["A"],this.outTexUsage=rr.DOWNLOAD;const n=us();this.outputShape=e,this.userCode=`
      ${wU}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ewe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=rr.DOWNLOAD;const n=us();this.outputShape=e,this.userCode=`
      ${wU}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dwe={R:0,G:1,B:2,A:3};class JO{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=us();this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${Dwe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?aE():oE(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Awe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=us();this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?aE():oE(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(t){const e=us(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Z6(t,n)}function IU(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return nU(t,e)}function NU(t){const e=new Uint16Array([0,1,2,2,1,3]);return sU(t,e)}function r0(t,e,n,s,r,i){iU(e,n);const o=rU(t),a=t.TEXTURE_2D;return ue(t,()=>t.bindTexture(a,o)),ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),ue(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),ue(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),K().getNumber("WEBGL_VERSION")===1?ue(t,()=>t.texImage2D(a,0,s,e,n,0,r,i,null)):ue(t,()=>t.texStorage2D(a,1,s,e,n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function cE(t){return t.internalFormatFloat}function _U(t,e,n,s){const[r,i]=s0(e,n);return r0(t,r,i,cE(s),s.textureFormatFloat,t.FLOAT)}function uE(t){return t.internalFormatHalfFloat}function $U(t,e,n,s){const[r,i]=s0(e,n);return r0(t,r,i,uE(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function hE(t){return t.downloadTextureFormat}function EU(t,e,n,s){const[r,i]=s0(e,n);return r0(t,r,i,hE(s),t.RGBA,t.UNSIGNED_BYTE)}function dE(t){return t.internalFormatPackedFloat}function DU(t,e,n,s){const[r,i]=Md(e,n);return r0(t,r,i,dE(s),t.RGBA,t.FLOAT)}function fE(t){return t.internalFormatPackedHalfFloat}function AU(t,e,n,s){const[r,i]=Md(e,n);return r0(t,r,i,fE(s),t.RGBA,s.textureTypeHalfFloat)}function RU(t,e,n){return ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),pC(t,e,"clipSpacePos",n,3,20,0)&&pC(t,e,"uv",n,2,20,12)}function OU(t,e,n,s,r,i){ue(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*s*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(r),K().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,o)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,o)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function PU(t,e,n){ue(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?K().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):K().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function FU(t,e,n,s){const r=t.createBuffer();ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return ue(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function MU(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function LU(t,e,n,s){const[r,i]=s0(e,n),o=4,a=new Uint8Array(Nbe(e*n,o));return ue(t,()=>t.readPixels(0,0,r,i,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function zU(t,e,n,s,r,i,o,a){const l=t,c=new Float32Array(_be(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function BU(t,e,n){const s=new Float32Array(e*n*4);return ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}const Rwe=Object.freeze(Object.defineProperty({__proto__:null,bindVertexProgramAttributeStreams:RU,createBufferFromOutputTexture:FU,createFloat16MatrixTexture:$U,createFloat16PackedMatrixTexture:AU,createFloat32MatrixTexture:_U,createIndexBuffer:NU,createPackedMatrixTexture:DU,createUnsignedBytesMatrixTexture:EU,createVertexBuffer:IU,createVertexShader:TU,downloadByteEncodedFloatMatrixFromOutputTexture:LU,downloadFloat32MatrixFromBuffer:MU,downloadMatrixFromPackedOutputTexture:BU,downloadPackedMatrixFromBuffer:zU,getInternalFormatForFloat16MatrixTexture:uE,getInternalFormatForFloat16PackedMatrixTexture:fE,getInternalFormatForFloat32MatrixTexture:cE,getInternalFormatForPackedMatrixTexture:dE,getInternalFormatForUnsignedBytesMatrixTexture:hE,uploadDenseMatrixToTexture:OU,uploadPixelDataToTexture:PU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mx{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=K().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,X6(n,e)):this.gl=ai(n),e=this.gl,K().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>ue(i,()=>i.createVertexArray()),this.bindVertexArray=o=>ue(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>ue(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>ue(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ue(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>ue(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>ue(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>ue(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),K().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=$f(this.gl,i),ir(this.gl,o))this.textureHalfFloatExtension=$f(this.gl,o);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),ir(this.gl,r))this.colorBufferHalfFloatExtension=$f(this.gl,r);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",ir(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(ir(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=IU(this.gl),this.indexBuffer=NU(this.gl),this.framebuffer=oU(this.gl),this.textureConfig=rE(this.gl,this.textureHalfFloatExtension)}get debug(){return K().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;ue(e,()=>e.finish()),ue(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ue(e,()=>e.deleteFramebuffer(this.framebuffer)),ue(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),ue(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),ue(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),_U(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),$U(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),EU(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),PU(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),OU(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),AU(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),DU(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(mC(this.gl,this.framebuffer),this.outputTexture=null),ue(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>LU(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,i,o){return zU(this.gl,e,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return MU(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=FU(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(K().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>BU(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=TU(n));const s=eU(n);ue(n,()=>n.attachShader(s,this.vertexShader)),ue(n,()=>n.attachShader(s,e)),tU(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&Rx(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;ue(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),RU(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(ue(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Rx(this.gl,this.program),ue(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?lU(this.gl,e,n):cU(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),ue(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),uU(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,i]=Md(n,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Rx(this.gl,this.program),Ef(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ue(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ue(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=$f(this.gl,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await Ck(()=>this.disposed||this.isQueryAvailable(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=Owe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in K().platform&&(s=K().platform.setTimeoutCustom.bind(K().platform)),Ck(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Ox(this.gl,e,this.framebuffer),this.debug&&Ef(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Ox(this.gl,this.outputTexture,this.framebuffer),this.debug&&Ef(this.gl)):mC(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;Ox(r,e,this.framebuffer),this.debug&&Ef(r),this.outputTexture=e,ue(r,()=>r.viewport(0,0,n,s)),ue(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),ue(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Owe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Pwe,bincountImpl:VU,bincountReduceImpl:Fwe,bitwiseAndImpl:Mwe,castImpl:Lwe,ceilImpl:zwe,concatImpl:Bwe,equalImpl:Vwe,expImpl:Wwe,expm1Impl:Uwe,floorImpl:jwe,gatherNdImpl:Hwe,gatherV2Impl:Gwe,greaterImpl:qwe,greaterEqualImpl:Kwe,lessImpl:Xwe,lessEqualImpl:Ywe,linSpaceImpl:Qwe,logImpl:Zwe,maxImpl:Jwe,maximumImpl:eve,minimumImpl:tve,multiplyImpl:nve,negImpl:sve,notEqualImpl:rve,prodImpl:ive,raggedGatherImpl:ove,raggedRangeImpl:ave,raggedTensorToTensorImpl:lve,rangeImpl:cve,rsqrtImpl:uve,scatterImpl:hve,sigmoidImpl:dve,simpleAbsImpl:WU,sliceImpl:fve,sparseFillEmptyRowsImpl:pve,sparseReshapeImpl:mve,sparseSegmentReductionImpl:UU,sqrtImpl:gve,staticRegexReplaceImpl:xve,stridedSliceImpl:yve,stringNGramsImpl:bve,stringSplitImpl:wve,stringToHashBucketFastImpl:vve,subImpl:Sve,tileImpl:kve,topKImpl:Cve,transposeImpl:pE,uniqueImpl:Tve}=D6;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jU(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function es(t,e){return e===1?[t]:jU(t,e)}function Ive(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nve{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Hn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=es("rc",this.rank),s=ot(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HU{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${_ve(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?aE():oE(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function _ve(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Vbe(["r","c","d"],"inputShape"):Zc(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ve{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=tP(n,s),i=nP(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=eP(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return r===Dn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Dn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Dn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Dn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Dn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const i=tP(s,r),o=nP(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=eP(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=K().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Eve(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function eP(t,e,n,s,r){const i=Dve(e,s);let o;if(r){const[l,c]=Md(t[0],t[1]);o=l*c}else{const[l,c]=s0(t[0],t[1]);o=l*c}const a=Eve(n,i);return o*a}function Dve(t,e){switch(t){case Dn.PACKED_2X2_FLOAT32:return dE(e);case Dn.PACKED_2X2_FLOAT16:return fE(e);case Dn.UNPACKED_FLOAT32:return cE(e);case Dn.UNPACKED_FLOAT16:return uE(e);case Dn.PACKED_4X1_UNSIGNED_BYTE:return hE(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Ave(t){return K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Dn.PACKED_2X2_FLOAT32:Dn.UNPACKED_FLOAT32:t?Dn.PACKED_2X2_FLOAT16:Dn.UNPACKED_FLOAT16}function tP(t,e){if(t===rr.UPLOAD)return Dn.PACKED_2X2_FLOAT32;if(t===rr.RENDER||t==null)return Ave(e);if(t===rr.DOWNLOAD||t===rr.PIXELS)return Dn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function nP(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ti{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Lr="if (isnan(x)) return x;",Rve="return x;",sP="return abs(x);",Ove="return (x >= 0.0) ? x : (exp(x) - 1.0);",Pve=Lr+`
  return (x < 0.0) ? 0.0 : x;
`,Fve=Lr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Zo="return x;",Mve="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lve="return x;",zve=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Bve=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Vve=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Wve="return 1.0 / (1.0 + exp(-1.0 * x));";class la{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uve{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length);const n=e.length,s=es("rc",n),r=ot(n),i=Ive(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jve=Jw,Hve=1e-7,Gve=1e-4,Y0={};function qve(t){return t in Y0||(Y0[t]={}),Y0[t]}const Kve=K().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Xve=600;function Yve(){return K().global.screen==null?1024:K().global.screen.height*K().global.screen.width*window.devicePixelRatio*Xve/1024/1024}class i0 extends gb{nextDataId(){return i0.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!K().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Mx)n=e;else{const s=ai(K().getNumber("WEBGL_VERSION"),e);n=new Mx(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=ai(K().getNumber("WEBGL_VERSION"));n=new Mx(s),this.binaryCache=qve(K().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new $ve(this.gpgpu),this.numMBBeforeWarning=Yve(),this.texData=new iI(this,jr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,i,o){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const c=Df(n),u=new JO(c,!1,o),h=this.runWebGLProgram(u,[a],s,[[r,i]]);return h.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),h.dataId}write(e,n,s){if((K().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||K().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:rr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,i){if(K().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:rr.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let d;l?d=new la(a,Zo):d=new Ti(a,Zo);const f=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=_n());let h;if(r==="complex64"){const d=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);h=_o(d,f)}else h=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=_n()-u),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(g=>p.push(g))}const n=this.texData.get(e),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new la(r,Zo):p=new Ti(r,Zo);const g=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:o}],o),m=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),m}if(s!=null)return this.convertAndCacheOnCPU(e);if(K().getBool("DEBUG")&&!K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&K().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&K().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...K0(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=p[0],m=p[1];h=_o(g,m)}else if(c==null)h=this.getValuesFromTexture(e);else{const p=Q(r);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;ue(p,()=>p.deleteBuffer(c))}const d=this.convertAndCacheOnCPU(e,h),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&jr().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new la(i,Zo):f=new Ti(i,Zo);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),h=jr().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Co(r));return De(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return De(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!Y6(s))throw K().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),i=Q(n);if(K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),f=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...K0(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(d),p}const o=K().getBool("WEBGL_PACK")&&r===!0,a=o?Df(n):n,l=o?new Ewe(a):new $we(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=Pi(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=Pi(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=pz(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:_n(),endMs:null}}endTimer(e){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=_n(),e)}async getQueryTime(e){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=Kve){return K().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&Q(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Js("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return jve(e.shape,n)}packedUnaryOp(e,n,s){const r=new la(e.shape,n),i=this.compileAndRun(r,[e],s);return jr().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=WU(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,sP,e.dtype);const n=new Ti(e.shape,sP),s=this.compileAndRun(n,[e]);return jr().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Ci(s[0])){const i=s.map(o=>$i(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return jr().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new Uve(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Nve(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[Ic(e.shape),...Nc(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[Ic(n),...Nc(n)],o=new HU(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const d=Q(i),f=n[0]*n[1]*4;N(d<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Df(i);let l;r?l=new _we(a):l=new Nwe(a);const c=!0,u=[n??K0(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:h.dataId}}runWebGLProgram(e,n,s,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Yp.DENSE){const x=o??K0(e.outputShape);l.texShape=x.map(y=>y*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Q(a.shape)===0)return l.values=vn(a.dtype,0),a;const c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(x.dataId);if(y.texture==null){if(!e.packedInputs&&Q(x.shape)<=K().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!y.isPacked!=!!e.packedInputs)x=y.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),y=this.texData.get(x.dataId);else if(y.isPacked&&!Qp(y.shape,x.shape)){const b=x,w=x.shape;x.shape=y.shape,x=this.packedReshape(x,w),c.push(x),y=this.texData.get(x.dataId),b.shape=w}return{shape:x.shape,texData:y,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},d=Iwe(e,u,h),f=this.getAndSaveBinary(d,()=>Cwe(this.gpgpu,e,u,h)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),K().get("ENGINE_COMPILE_ONLY")||Twe(this.gpgpu,f,u,h,r),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),p&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const m=K().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const x=_n();x-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!K().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(e,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(K().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=q(()=>{if(!K().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=K().getBool("DEBUG");K().set("DEBUG",!1);const n=this.abs(be(1e-8)).dataSync()[0];if(K().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Hve:Gve}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=_n());let h=n.texShape;if(h==null&&(h=fU(s,l),n.texShape=h),i!=null){const d=Df(s);let f,p=h[1],g=h[0];const m=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!m)&&([p,g]=Md(h[0],h[1])),l?f=new Awe(d,m):f=new JO(d,m);const x=m?[g,p]:h,y=this.makeTensorInfo(x,r),b=this.texData.get(y.dataId);m?b.usage=rr.PIXELS:b.usage=rr.UPLOAD,b.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,g,i);const w=[[g,p]],S=this.runWebGLProgram(f,[y],r,w,!0),T=this.texData.get(S.dataId);n.texShape=T.texShape,n.isPacked=T.isPacked,n.usage=T.usage,K().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(n.texture=T.texture,n.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=_n()-u)}else{const d=this.acquireTexture(h,a,r,l);n.texture=d}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=Qve(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*Pp(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await KN(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(iE(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=CU(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=e,l=jr().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,i,o,a);return jr().makeTensorFromDataId(c,n,s,l)}}i0.nextDataId=0;function Qve(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/** @license See the LICENSE file. */const GU="4.21.0";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qU(){K().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */mI()&&xI("webgl",()=>new i0,2);const Zve={forceHalfFloat:qU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mE=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class _c{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Te(n,s),this.enableShapeUniforms=Hn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eu=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Ud{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Te(n,s);const i=this.outputShape.length;this.enableShapeUniforms=Hn(i);let o="";if(r)if(i===0||Q(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${ot(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=es("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function js(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Jve={kernelName:Kh,backendName:"webgl",kernelFunc:js};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ll(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=js({inputs:{x:s},backend:n}),l=js({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const e2e={kernelName:Tb,backendName:"webgl",kernelFunc:ll};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KU="return (a < 0.) ? b * a : a;",XU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function t2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s,o=n.makeTensorInfo([],"float32",Ao(i,"float32")),a=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ud(XU,r.shape,o.shape):new _c(KU,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const n2e={kernelName:Wm,backendName:"webgl",kernelFunc:t2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YU="return (a < 0.) ? b * a : a;",QU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function s2e(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,i=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ud(QU,s.shape,r.shape):new _c(YU,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const r2e={kernelName:ag,backendName:"webgl",kernelFunc:s2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jd="if (isnan(x)) return x;";function He({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const h=a.texData.get(o.dataId),d=n(h.values,l);return a.makeTensorInfo(o.shape,l,d)}const c=K().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new la(o.shape,e):u=new Ti(o.shape,t),a.runWebGLProgram(u,[o],l)}}function zn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),g=u.texData.get(c.dataId),[m,x]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[w,v]=b,S={dataId:w.dataId,dtype:w.dtype,shape:l.shape},T={dataId:v.dataId,dtype:v.dtype,shape:c.shape},k=new _c(t,l.shape,c.shape);return u.runWebGLProgram(k,[S,T],xs(w.dtype,v.dtype))}),y=ll({inputs:{real:m,imag:x},backend:u});return u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(x),y}const h=i||xs(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,g=u.texData.get(c.dataId).values,m=l.dtype==="string"?$o(p):p,x=l.dtype==="string"?$o(g):g,[y,b]=r(l.shape,c.shape,m,x,h),w=u.makeTensorInfo(b,h),v=u.texData.get(w.dataId);return v.values=y,w}const d=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return d?f=new Ud(e,l.shape,c.shape,n):f=new _c(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],h)}}function Zp(t,e=!1){if(t==="linear")return e?Lve:Rve;if(t==="relu")return e?Bve:Pve;if(t==="elu")return e?zve:Ove;if(t==="relu6")return e?Vve:Fve;if(t==="prelu")return e?QU:YU;if(t==="leakyrelu")return e?XU:KU;if(t==="sigmoid")return e?Wve:Mve;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZU{constructor(e,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Hn(this.outputShape.length);const u=r?e[1]:e[2],h=Math.ceil(u/2),d=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",x="";a&&(l?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:m=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",w="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(w=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${w};
        for (int i = 0; i < ${h}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rP={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class iP{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Te(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oP="return a * b;";function gE(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=xs(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new iP(rP.REAL,s.shape,r.shape),u=new iP(rP.IMAG,s.shape,r.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=ll({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=nve(s.shape,r.shape,a.values,l.values,i),h=n.makeTensorInfo(u,i),d=n.texData.get(h.dataId);return d.values=c,h}let o;return K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Ud(oP,s.shape,r.shape):o=new _c(oP,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const i2e={kernelName:sd,backendName:"webgl",kernelFunc:gE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o2e(t,e,n){const s=[Ic(t.shape),...Nc(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[Ic(e),...Nc(e)],o=new HU(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function le(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=n,a=Q(r.shape),l=aI(i,a),c=Q(l);N(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!Qp(r.shape,l)&&!(u.texture!==null&&Qp(u.shape,l))?o2e(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const a2e={kernelName:cg,backendName:"webgl",kernelFunc:le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aP{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const h=1/n;c=`sumValue += dot(values * ${hc(h)?h.toPrecision(2):h}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l2e{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,h=s%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c2e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=hv(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function tu(t,e,n,s){const r=c2e(t.shape);let i=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,h;n==="mean"?u=o===0?new aP({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new aP({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new l2e({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),h=i,i=s.runWebGLProgram(u,[i],e),h.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(h)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u2e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=ot(this.rank),i=h2e(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function h2e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d2e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=ot(this.rank),i=jU("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mv(t,e,n){const s=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new d2e(t.shape,e):new u2e(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2e(t,e,n,s){const r=e,i=t.shape.length,o=Oe(r,t.shape);let a=o;const l=Et(a,i),c=l!=null;let u=t;c&&(u=Mv(t,l,s),a=Ht(a.length,i)),Mn("sum",a,i);const[h,d]=Tn(u.shape,a);let f=h;n&&(f=Wt(h,o));const p=Q(d),m=Q(t.shape)/p,x=le({inputs:{x:u},attrs:{shape:[m,p]},backend:s}),y=Tw(t.dtype),b=tu(x,y,"sum",s),w=le({inputs:{x:b},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(b),c&&s.disposeIntermediateTensorInfo(u),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lv(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;return f2e(r,i,o,n)}const p2e={kernelName:mg,backendName:"webgl",kernelFunc:Lv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function os(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const h=o.texData.get(r.dataId).values,d=pE(h,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const f=o.texData.get(c.dataId);f.values=d}else c=Mv(r,i,o);return c}const m2e={kernelName:ql,backendName:"webgl",kernelFunc:os};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JU=1e3;function y1({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,h=n?t.shape[c-2]:t.shape[c-1],d=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],g=t.shape.slice(0,-2),m=e.shape.slice(0,-2),x=Q(g),y=Q(m),w=Te(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);N(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const v=n?[x,h,f]:[x,f,h],S=s?[y,p,d]:[y,d,p],T=le({inputs:{x:t},backend:r,attrs:{shape:v}}),k=le({inputs:{x:e},backend:r,attrs:{shape:S}}),I=[T,k],_=Math.max(x,y),D=n?T.shape[1]:T.shape[2],A=i!=null,L=o!=null,B=l==="leakyrelu",F=l!=null?Zp(l,!0):null,R=A||L||B||F!=null;let O;if((f===1||p===1)&&D>JU&&R===!1){let V=T,G=k;n&&(V=os({inputs:{x:T},backend:r,attrs:{perm:[0,2,1]}}),I.push(V)),s&&(G=os({inputs:{x:k},backend:r,attrs:{perm:[0,2,1]}}),I.push(G));const Y=p!==1,Z=p===1;let ee=V;Y&&(ee=le({inputs:{x:V},backend:r,attrs:{shape:[_,D,1]}}),I.push(ee));const te=p===1?2:1;let ne=G;Z&&(ne=le({inputs:{x:G},backend:r,attrs:{shape:[_,1,D]}}),I.push(ne));const ie=gE({inputs:{a:ee,b:ne},backend:r});O=Lv({inputs:{x:ie},backend:r,attrs:{axis:te,keepDims:!0}}),I.push(ie)}else{const V=xs(t.dtype,e.dtype),G=new ZU(v,S,[_,f,p],n,s,A,F,L,B),Y=[T,k];if(i!=null&&Y.push(i),L&&Y.push(o),B){const Z=r.makeTensorInfo([],"float32",Ao(a,"float32"));Y.push(Z),I.push(Z)}O=r.runWebGLProgram(G,Y,V)}const E=le({inputs:{x:O},backend:r,attrs:{shape:w}});I.push(O);for(const V of I)r.disposeIntermediateTensorInfo(V);return E}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2e(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;return y1({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:u})}const x2e={kernelName:Fp,backendName:"webgl",kernelFunc:g2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lP="return abs(x);";function y2e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=WU(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new la(s.shape,lP):r=new Ti(s.shape,lP),n.runWebGLProgram(r,[s],s.dtype)}const b2e={kernelName:wm,backendName:"webgl",kernelFunc:y2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2e=Lr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,v2e=He({opSnippet:w2e}),S2e={kernelName:_h,backendName:"webgl",kernelFunc:v2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k2e=Lr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,C2e=He({opSnippet:k2e}),T2e={kernelName:$h,backendName:"webgl",kernelFunc:C2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cP="return a + b;",I2e=zn({opSnippet:cP,packedOpSnippet:cP,supportsComplex:!0,cpuKernelImpl:Pwe}),N2e={kernelName:Wc,backendName:"webgl",kernelFunc:I2e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _2e{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $2e{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lx(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return js({inputs:{x:s[0]},backend:n});if(s.length>K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=Lx({inputs:s.slice(0,l),backend:n}),u=Lx({inputs:s.slice(l),backend:n});return Lx({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>xs(l,c)),i=s.map(l=>l.shape),a=K().getBool("WEBGL_PACK")?new $2e(s[0].shape,i):new _2e(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const E2e={kernelName:vm,backendName:"webgl",kernelFunc:Lx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Oe(i,r.shape);let c=l;const u=Et(c,a);let h=r;u!=null&&(h=os({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Ht(c.length,a)),Mn("all",c,a);const[d,f]=Tn(h.shape,c),p=Q(f),g=le({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=tu(g,g.dtype,"all",n);let x;if(o){const y=Wt(d,l);x=le({inputs:{x:m},backend:n,attrs:{shape:y}})}else x=le({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),x}const A2e={kernelName:bb,backendName:"webgl",kernelFunc:D2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Oe(i,r.shape);let c=l;const u=Et(c,a);let h=r;u!=null&&(h=os({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Ht(c.length,a)),Mn("any",c,a);const[d,f]=Tn(h.shape,c),p=Q(f),g=le({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=tu(g,g.dtype,"any",n);let x;if(o){const y=Wt(d,l);x=le({inputs:{x:m},backend:n,attrs:{shape:y}})}else x=le({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),x}const O2e={kernelName:wb,backendName:"webgl",kernelFunc:R2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P2e{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F2e{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,N(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=ot(l),u=es("coords",l);let h,d;if(o===1){d=l+1;const k=ot(d);h=`
        ${k} sourceLocR = ${k}(${u.join()}, 0);
        ++${u[l-1]};
        ${k} sourceLocG = ${k}(${u.join()}, 0);
        ++${u[l-2]};
        ${k} sourceLocA = ${k}(${u.join()}, 0);
        --${u[l-1]};
        ${k} sourceLocB = ${k}(${u.join()}, 0);
        --${u[l-2]};`}else d=l,h=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,d),p="."+f[d-1],g=f.map(k=>"int "+k),m=es("sourceLocR",d-1).concat("inIdx.r"),x=es("sourceLocG",d-1).concat("inIdx.g"),y=es("sourceLocB",d-1).concat("inIdx.b"),b=es("sourceLocA",d-1).concat("inIdx.a"),w=s==="max"?"greaterThan":"lessThan",v=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,S=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,T=r?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${T}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${v}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8(t,e,n,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=hv(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new P2e(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const h=e8(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}function t8(t,e,n,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],o=hv(i),a=new F2e(r,o,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=t8(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function n8(t,e,n,s){const r=[n];if(Mn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!K().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=Tn(l.shape,r),h=Q(u),d=le({inputs:{x:l},backend:t,attrs:{shape:[-1,h]}});i.push(d);const f=e8(t,d,s);i.push(f);const p=le({inputs:{x:f},backend:t,attrs:{shape:c}});return i.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}return t8(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=Oe(i,r.shape);const a=Et(o,r.shape.length);let l=r;const c=[];a!=null&&(l=os({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Ht(o.length,l.shape.length)),Mn("argMax",[o[0]],l.shape.length);const u=n8(n,l,o[0],"max");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const L2e={kernelName:Sm,backendName:"webgl",kernelFunc:M2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=Oe(i,r.shape);const a=Et(o,r.shape.length);let l=r;const c=[];a!=null&&(l=os({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Ht(o.length,l.shape.length)),Mn("argMin",[o[0]],l.shape.length);const u=n8(n,l,o[0],"min");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const B2e={kernelName:km,backendName:"webgl",kernelFunc:z2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V2e=Lr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,W2e=He({opSnippet:V2e}),U2e={kernelName:Eh,backendName:"webgl",kernelFunc:W2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j2e=Lr+"return log(x + sqrt(x * x + 1.0));",H2e=He({opSnippet:j2e}),G2e={kernelName:Dh,backendName:"webgl",kernelFunc:H2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q2e=Lr+`
  return atan(x);
`,K2e=He({opSnippet:q2e}),X2e={kernelName:Ah,backendName:"webgl",kernelFunc:K2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y2e=mE+`
  return atan(a, b);
`,Q2e=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+eu+`
  return result;
`,Z2e=zn({opSnippet:Y2e,packedOpSnippet:Q2e}),J2e={kernelName:Oh,backendName:"webgl",kernelFunc:Z2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eSe=Lr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,tSe=He({opSnippet:eSe}),nSe={kernelName:Rh,backendName:"webgl",kernelFunc:tSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jp{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,x=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(g||(y="-1.0 / 1e-20"),s){const k=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${k} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?m:x:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let w=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(w="avgValue / max(count, 1.0)");const v=Math.floor(o/4)*4,S=o%4,T=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${v}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${T}
          }

          int xC = xCCorner + ${v};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${T}
          }
        }
        setOutput(${w});
      }
    `}}class xE{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,m=e.padInfo.front,x=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let w="0.0";if(b||(w="-1.0 / 1e-20"),s){const _=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${m}, ${x}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${_} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const T=Math.floor(o/4)*4,k=o%4,I=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${m}, ${x}, ${y});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${T}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${I}
            }

            int xC = xCCorner + ${T};
            if (${k===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${k===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${k===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${I}
            }
          }
        }
        setOutput(${S});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ld(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;N(Fn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Fr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Fe(u.inShape,u.outShape))return js({inputs:{x:r},backend:n});const h=new Jp(u,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const rSe={kernelName:Cm,backendName:"webgl",kernelFunc:sSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],h=Ro(r.shape,i,o,u,a,l,c),d=new xE(h,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const oSe={kernelName:Tm,backendName:"webgl",kernelFunc:iSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aSe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,h=c-1-e.padInfo.left,d=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class lSe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=h-1-e.padInfo.front,g=d-1-e.padInfo.top,m=f-1-e.padInfo.left,x=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${m});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cSe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=Ro(o.shape,a,l,h,c,u),f=new lSe(d);return n.runWebGLProgram(f,[r],o.dtype)}const uSe={kernelName:Sb,backendName:"webgl",kernelFunc:cSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hSe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Ld([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Fr(o.shape,a,l,1,c),h=new aSe(u);return n.runWebGLProgram(h,[r],o.dtype)}const dSe={kernelName:vb,backendName:"webgl",kernelFunc:hSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fSe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;return y1({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const pSe={kernelName:Im,backendName:"webgl",kernelFunc:fSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mSe{constructor(e,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Te(e,n),Te(e,s);let a="0.0";r!=null&&(Te(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Te(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gSe{constructor(e,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Te(e,n),Te(e,s);let a="vec4(0.0)";r!=null&&(Te(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Te(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xSe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=t;N(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let h=null;a!=null&&(h=a.shape,c.push(a));const d=K().getBool("WEBGL_PACK_NORMALIZATION")?new gSe(s.shape,r.shape,i.shape,u,h,l):new mSe(s.shape,r.shape,i.shape,u,h,l);return e.runWebGLProgram(d,c,c[0].dtype)},ySe={kernelName:zm,backendName:"webgl",kernelFunc:xSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bSe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=ot(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=wSe(this.rank);let r;const i=e.map((o,a)=>`sourceLoc.${yC[a]} = start[${a}] + coords.${yC[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const yC=["x","y","z","w","u","v"];function wSe(t){if(t===1)return"sourceLoc";if(t<=6)return yC.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vSe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=ot(this.rank),s=es("coords",this.rank),r=es("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,h)=>`start[${h}]`).join()});`:e.map((u,h)=>`${r[h]} = ${s[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SSe(t,e,n,s){const r=s.texData.get(t.dataId),i=s.makeTensorInfo(n,t.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=GN(e,we(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function Hd(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s,[a,l]=uv(r,i,o);if(UN(r,a,l),Q(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const h=n.texData.get(r.dataId),d=fve(h.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,d)}const{isPacked:c}=n.texData.get(r.dataId),u=HN(r.shape,a,l);if(c||!u){const h=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vSe(l):new bSe(l),d=[a];return n.runWebGLProgram(h,[r],r.dtype,d)}return n.uploadToGPU(r.dataId),SSe(r,a,l,n)}const kSe={kernelName:pg,backendName:"webgl",kernelFunc:Hd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CSe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;N(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,b)=>y*b),l=Ug(r.shape,i,a),c=jg(l.length,i.length),u=Hg(r.shape,i,a),h=ZN(o,i.length),d=JN(u,o,i.length),f=[],p=le({inputs:{x:r},backend:n,attrs:{shape:l}}),g=os({inputs:{x:p},backend:n,attrs:{perm:c}}),m=le({inputs:{x:g},backend:n,attrs:{shape:u}}),x=Hd({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(g),f.push(m),f.forEach(y=>n.disposeIntermediateTensorInfo(y)),x},TSe={kernelName:Nm,backendName:"webgl",kernelFunc:CSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=VU(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const NSe={kernelName:kb,backendName:"webgl",kernelFunc:ISe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Se=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,$Se=`
  return float(int(a.r) & int(b.r));
`;function ESe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=K().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=K().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,h]=Mwe(s.shape,r.shape,l,c,s.dtype),d=n.makeTensorInfo(h,s.dtype),f=n.texData.get(d.dataId);return f.values=u,d}let a;return i?a=new Ud(_Se,s.shape,r.shape,!1):a=new _c($Se,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const DSe={kernelName:_m,backendName:"webgl",kernelFunc:ESe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ASe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=Te(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const RSe={kernelName:Cb,backendName:"webgl",kernelFunc:ASe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OSe="return float(a != b);",s8=zn({opSnippet:OSe,cpuKernelImpl:rve,dtype:"bool"}),PSe={kernelName:ng,backendName:"webgl",kernelFunc:s8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return js({inputs:{x:r.complexTensorInfos.real},backend:n})}const FSe={kernelName:rw,backendName:"webgl",kernelFunc:o0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MSe="return float(int(x));";function LSe(t,e){const n=new Ti(t.shape,MSe),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bC(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return js({inputs:{x:r},backend:n});const o=Qt(r.shape),a=bC({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=ll({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=o0({inputs:{input:r},backend:n}),a=bC({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!lI(r.dtype,i)){const o=js({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=Lwe(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return LSe(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",vn("bool",1)),l=s8({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const zSe={kernelName:Ph,backendName:"webgl",kernelFunc:bC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uP="return ceil(x);",BSe=He({opSnippet:uP,packedOpSnippet:uP,cpuKernelImpl:zwe}),VSe={kernelName:Fh,backendName:"webgl",kernelFunc:BSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WSe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class USe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:i,clipValueMax:o}=s;let a;K().getBool("WEBGL_PACK_CLIP")?a=new USe(r.shape):a=new WSe(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const HSe={kernelName:Mh,backendName:"webgl",kernelFunc:jSe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GSe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hP(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function qSe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),i=new GSe(s.shape),o=[hP(s,r.complexTensorInfos.real),hP(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const KSe={kernelName:$m,backendName:"webgl",kernelFunc:qSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XSe{constructor(e){this.outputShape=[],this.outputShape=Di(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YSe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Di(e,n);const s=this.outputShape,r=s.length,i=ot(r),o=es("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((g,m)=>`T${m}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const c=a[n],u=a.slice(-2),h=a.join();let d=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${u.join()}));
        }`;for(let g=1;g<l.length;g++){const m=l[g-1];d+=`
        if (${c} < ${l[g]}  && ${c} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${Q0(a,c,m)}),
            vec2(${Q0(u,c,m)}));
        }`}const f=l.length,p=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${Q0(a,c,p)}),
          vec2(${Q0(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Q0(t,e,n){const s=t.indexOf(e);return t.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zv(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return js({inputs:{x:r.complexTensorInfos.imag},backend:n})}const QSe={kernelName:jb,backendName:"webgl",kernelFunc:zv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Af(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(y=>o0({inputs:{input:y},backend:n})),p=t.map(y=>zv({inputs:{input:y},backend:n})),g=Af(f,e,n),m=Af(p,e,n),x=ll({inputs:{real:g,imag:m},backend:n});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),p.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),x}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(w=>{const S=[-1,Q(w.shape.slice(e))];return le({inputs:{x:w},backend:n,attrs:{shape:S}})}),p=f.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),g=Di(f.map(w=>w.shape),1),m=f[0].shape[0]===1,x=Bwe(p,g,s,m),y=Di(t.map(w=>w.shape),e),b=n.makeTensorInfo(y,s,x);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const i=t.filter(f=>Q(f.shape)>0),o=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new Ti(t[0].shape,Zo):new la(t[0].shape,Zo);return n.runWebGLProgram(f,t,s)}const a=K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let g=0;g<i.length;g+=a){const m=i.slice(g,g+a);f.push(Af(m,e,n))}const p=Af(f,e,n);for(const g of f)n.disposeIntermediateTensorInfo(g);return p}if(o){const f=new YSe(i.map(p=>p.shape),e);return n.runWebGLProgram(f,i,s)}const{tensors2D:l,outShape:c}=ZSe(i,e,n),u=new XSe(l.map(f=>f.shape)),h=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const d=le({inputs:{x:h},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(h),d}function ZSe(t,e,n){const s=Di(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>le({inputs:{x:i},attrs:{shape:[-1,Q(i.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=Oe(r,e[0].shape)[0],o=e.map(c=>c.shape);XN(o,i);const a=Di(e.map(c=>c.shape),i);if(Q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>Q(c.shape)>0);return l.length===1?js({inputs:{x:l[0]},backend:n}):Af(l,i,n)}const JSe={kernelName:Em,backendName:"webgl",kernelFunc:r8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i8{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,m=e.dataFormat==="channelsLast",x=m?1:2,y=m?2:3,b=m?3:1;let w="",v="";s&&(r?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:w=`
          float activation(float x) {
            ${s}
          }
        `,v="result = activation(result);");const S=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${v}
        setOutput(result);
      }
    `}}class eke{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.filterDepth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o8{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hn(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,h=u;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<u;m++)d+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let m=0;m<u;m++)d+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(h+1)/2;m++){const x=m*2;if(d+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<u&&(o%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?d+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<u)){const y=o%2===0?xb(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:d+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):y===1?d+=`
                     xC${x+1} = xTexelC${x};
                     `:d+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<u&&(o%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<u&&(d+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<u&&(d+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<u&&(d+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tke{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Hn(this.outputShape.length);const{dataFormat:s}=n,r=us(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let h=0;h<=1;h++)c+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function a8({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,h=l[0]*l[1]*l[2],d=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,g=!1;let m;const x=[];if(i!=null){const w=b1(i.shape,f);w!=null&&(i=le({inputs:{x:i},backend:s,attrs:{shape:w}}),x.push(i))}if(r!=null){const w=b1(r.shape,f);w!=null&&(r=le({inputs:{x:r},backend:s,attrs:{shape:w}}),x.push(r))}if(!((h===1||d===1)&&u>JU)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Fe(c.shape.slice(-3),l.slice(-3))){const w=l[0]*l[1]*(l[2]+1),v={dataId:t.dataId,shape:[1,w,n.inChannels],dtype:t.dtype},S=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,N(Qp(c.shape,v.shape),()=>`packed reshape ${c.shape} to ${v.shape} isn't free`);const T=le({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(T);const k=y1({a:v,b:T,backend:s,transposeA:p,transposeB:g,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),I=s.texData.get(k.dataId);N(I.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=S,I.shape=n.outShape,m=js({inputs:{x:k},backend:s}),m.shape=n.outShape,x.push(k)}else{const w=n.outHeight*n.outWidth,v=le({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,w,n.inChannels]:[n.batchSize,n.inChannels,w]}}),S=le({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),T=y1({a:f?v:S,b:f?S:v,transposeA:!f,transposeB:g,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});m=le({inputs:{x:T},backend:s,attrs:{shape:n.outShape}}),x.push(v),x.push(S),x.push(T)}for(const w of x)s.disposeIntermediateTensorInfo(w);return m}function l8({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:h,outHeight:d,dataFormat:f}=n,p=f==="channelsLast",g=l*c*u,m=d*h,x=[n.batchSize,g,m],y=!0,b=!1,w=[];if(i!=null){const E=b1(i.shape,p);E!=null&&(i=le({inputs:{x:i},backend:s,attrs:{shape:E}}),w.push(i))}if(r!=null){const E=b1(r.shape,p);E!=null&&(r=le({inputs:{x:r},backend:s,attrs:{shape:E}}),w.push(r))}const v=le({inputs:{x:e},backend:s,attrs:{shape:[1,g,Q(e.shape)/g]}});w.push(v);const S=new tke(x,n),T=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],k=s.runWebGLProgram(S,[t],"float32",T),I=le({inputs:{x:k},backend:s,attrs:{shape:x}});w.push(k),w.push(I);const _=r!=null,D=i!=null,A=a==="leakyrelu",L=a?Zp(a,!0):null,B=new ZU(p?I.shape:v.shape,p?v.shape:I.shape,p?[n.batchSize,m,n.outChannels]:[n.batchSize,n.outChannels,m],y,b,_,L,D,A),F=p?[I,v]:[v,I];if(r&&F.push(r),D&&F.push(i),A){const E=s.makeTensorInfo([],"float32",Ao(o,"float32"));F.push(E),w.push(E)}const R=s.runWebGLProgram(B,F,"float32"),O=le({inputs:{x:R},backend:s,attrs:{shape:n.outShape}});w.push(R);for(const E of w)s.disposeIntermediateTensorInfo(E);return O}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,h=Oo(l),d=Cn(r.shape,i.shape,o,c,a,u,!1,h);let f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=a8({x:r,filter:i,convInfo:d,backend:n});else if(d.strideWidth<=2&&h==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const g=new o8(d),m=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(g,[r,i],"float32",m)}else if(K().getBool("WEBGL_CONV_IM2COL"))f=l8({x:r,filter:i,convInfo:d,backend:n});else{const g=new i8(d);f=n.runWebGLProgram(g,[r,i],"float32")}const p=le({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),p}const ske={kernelName:Dm,backendName:"webgl",kernelFunc:nke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ike{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,u=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class oke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ake{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,h=Oo(l),d=Cn(r.shape,u,o,1,a,c,!1,h),f=new rke(d);return n.runWebGLProgram(f,[r,i],"float32")}const cke={kernelName:Ib,backendName:"webgl",kernelFunc:lke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uke{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Hn(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,h=Oo(c),d=Cn(o,i.shape,a,1,l,u,!1,h);if(K().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&h==="channelsLast"){const f=[[d.strideHeight,d.strideWidth]],p=new uke(d);return n.runWebGLProgram(p,[r,i],"float32",f)}else{const f=new ike(d);return n.runWebGLProgram(f,[r,i],"float32")}}const dke={kernelName:Am,backendName:"webgl",kernelFunc:hke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=tl(r.shape,i.shape,o,l,a),u=new eke(c);return n.runWebGLProgram(u,[r,i],"float32")}const pke={kernelName:Rm,backendName:"webgl",kernelFunc:fke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s,c=tl(r.shape,l,o,1,a),u=new oke(c);return n.runWebGLProgram(u,[r,i],"float32")}const gke={kernelName:Nb,backendName:"webgl",kernelFunc:mke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s,c=tl(l,i.shape,a,1,o),u=new ake(c);return n.runWebGLProgram(u,[r,i],"float32")}const yke={kernelName:_b,backendName:"webgl",kernelFunc:xke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bke=jd+`
  return cos(x);
`,wke=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${eu}
  return result;
`,vke=He({opSnippet:bke,packedOpSnippet:wke}),Ske={kernelName:Lh,backendName:"webgl",kernelFunc:vke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kke=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Cke=He({opSnippet:kke}),Tke={kernelName:zh,backendName:"webgl",kernelFunc:Cke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ike{constructor(e,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[h,d]=s;this.outputShape=[u,h,d,c];const f=r==="bilinear"?1:0,[p,g]=[`${a-1}.0`,`${l-1}.0`],[m,x,y]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,w,v]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${w};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${v};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nke=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new Ike(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},_ke={kernelName:Eb,backendName:"webgl",kernelFunc:Nke};var em;(function(t){t.Prod="*",t.Sum="+"})(em||(em={}));class dP{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===em.Prod?"1.0":"0.0",a=s?o:`getX(${fP(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${ot(i)} coords = getOutputCoords();
        int end = ${pP(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${pP(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${fP(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function fP(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function pP(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(t,e,n,s,r,i){const o=e.shape.length,a=Et([s],o);let l=e;a!=null&&(l=os({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=Ht(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let h=js({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const f=new dP(t,l.shape,!1,i),p=[[d]],g=h;h=n.runWebGLProgram(f,[h],h.dtype,p),n.disposeIntermediateTensorInfo(g)}if(r){const d=new dP(t,l.shape,r,i),f=h;h=n.runWebGLProgram(d,[h],h.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const d=nl(a),f=os({inputs:{x:h},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),f}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return c8(em.Prod,r,n,i,o,a)}const Eke={kernelName:$b,backendName:"webgl",kernelFunc:$ke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return c8(em.Sum,r,n,i,o,a)}const Ake={kernelName:Om,backendName:"webgl",kernelFunc:Dke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=VU(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=Fwe(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Oke={kernelName:Db,backendName:"webgl",kernelFunc:Rke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pke{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],h=l*i,d=c*i,f=u/(i*i),p=o==="NHWC"?[a,h,d,f]:[a,f,h,d],g=new Pke(p,i,o);return n.runWebGLProgram(g,[r],r.dtype)}const Mke={kernelName:Ab,backendName:"webgl",kernelFunc:Fke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u8{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hn(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h8{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Hn(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,d=h;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<h;x++)f+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let x=0;x<h;x++)f+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(d+1)/2;x++){const y=x*2;if(f+=`
          xC = xCCorner + ${y*c};
          `,l===1){if(y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,c===1&&y>0?f+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<h)){const b=a%2===0?xb(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:f+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?f+=`
                    xC${y+1} = xTexelC${y};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<h&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<h&&(f+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<h&&(f+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<h&&(f+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",g="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),N(Fn(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const h=Cn(r.shape,i.shape,o,u,a,c,!0);let d;K().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new h8(h):d=new u8(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[r,i],"float32",f)}const zke={kernelName:Pm,backendName:"webgl",kernelFunc:Lke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Vke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,h=Cn(r.shape,u,o,a,l,c,!0),d=new Bke(h);return n.runWebGLProgram(d,[r,i],"float32")}const Uke={kernelName:Rb,backendName:"webgl",kernelFunc:Wke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,h=Cn(u,i.shape,o,a,l,c,!0),d=new Vke(h);return n.runWebGLProgram(d,[r,i],"float32")}const Hke={kernelName:Ob,backendName:"webgl",kernelFunc:jke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gke{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qke(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],i=Q(s.shape),o=le({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new Gke(i),l=n.runWebGLProgram(a,[o],o.dtype),c=le({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const Kke={kernelName:Pb,backendName:"webgl",kernelFunc:qke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xke{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:h,left:d}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=Tg(r.shape,i.shape,o,a,"NHWC",l);let u;const h=new Xke(c);u=n.runWebGLProgram(h,[r,i],"float32");const d=le({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),d}const Qke={kernelName:Fm,backendName:"webgl",kernelFunc:Yke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zke(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=a_(r,i.length);c_(o.length,l,i);const{path:c,steps:u}=u_(a,l),h=u.length;let d=null,f=o.length;const p=[];for(let g=0;g<h;++g){for(const m of u[g]){const{permutationIndices:x,expandDims:y}=l_(f,l[m]);let b;h_(x)?b=i[m]:(b=os({inputs:{x:i[m]},backend:n,attrs:{perm:x}}),p.push(b));const w=b.shape.slice();for(let v=0;v<y.length;++v)w.splice(y[v],0,1);Fe(b.shape,w)||(b=le({inputs:{x:b},backend:n,attrs:{shape:w}}),p.push(b)),d===null?d=b:(d=gE({inputs:{a:b,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=Lv({inputs:{x:d},backend:n,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const Jke={kernelName:Mb,backendName:"webgl",kernelFunc:Zke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eCe="return (x >= 0.0) ? x : (exp(x) - 1.0);",tCe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,nCe=He({opSnippet:eCe,packedOpSnippet:tCe}),sCe={kernelName:Vh,backendName:"webgl",kernelFunc:nCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rCe="return (b >= 0.0) ? a : a * (b + 1.0);",iCe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,oCe=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,i=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ud(iCe,s.shape,r.shape):new _c(rCe,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},aCe={kernelName:Lb,backendName:"webgl",kernelFunc:oCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lCe=`
  return vec4(equal(a, b));
`,cCe="return float(a == b);",uCe=zn({opSnippet:cCe,packedOpSnippet:lCe,dtype:"bool",cpuKernelImpl:Vwe}),hCe={kernelName:Mm,backendName:"webgl",kernelFunc:uCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dCe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${e_};
  float a1 = ${t_};
  float a2 = ${n_};
  float a3 = ${s_};
  float a4 = ${r_};
  float a5 = ${i_};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,fCe=He({opSnippet:dCe}),pCe={kernelName:Wh,backendName:"webgl",kernelFunc:fCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mCe=jd+`
  return exp(x);
`,gCe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,d8=He({opSnippet:mCe,packedOpSnippet:gCe,cpuKernelImpl:Wwe,dtype:"float32"}),xCe={kernelName:Uh,backendName:"webgl",kernelFunc:d8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wC(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(N(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),le({inputs:{x:i},backend:s,attrs:{shape:a}})}const yCe={kernelName:Lm,backendName:"webgl",kernelFunc:wC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mP="return exp(x) - 1.0;",bCe=He({opSnippet:mP,packedOpSnippet:mP,cpuKernelImpl:Uwe}),wCe={kernelName:jh,backendName:"webgl",kernelFunc:bCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gP{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8(t,e,n){const s=n.texData.get(t.dataId),r=Q(t.shape),i=t.shape[t.shape.length-1],o=r/i,a=le({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new gP("real",l,e),u=new gP("imag",l,e),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=ll({inputs:{real:d,imag:f},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f);const g=le({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vCe(t){const{inputs:e,backend:n}=t,{input:s}=e;return f8(s,!1,n)}const SCe={kernelName:zb,backendName:"webgl",kernelFunc:vCe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kCe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a0(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||Bc(r),i==="string"){const o=Ot(i,Q(s));return o.fill(r),e.makeTensorInfo(s,i,o)}else{const o=new kCe(s,r),a=[[r]];return e.runWebGLProgram(o,[],i,a)}}const CCe={kernelName:Bb,backendName:"webgl",kernelFunc:a0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TCe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ICe={kernelName:Vb,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new TCe(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xP="return floor(x);",NCe=He({opSnippet:xP,packedOpSnippet:xP,cpuKernelImpl:jwe}),_Ce={kernelName:Hh,backendName:"webgl",kernelFunc:NCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ce=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,ECe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,DCe=zn({opSnippet:$Ce,packedOpSnippet:ECe,dtype:"int32"}),ACe={kernelName:Gh,backendName:"webgl",kernelFunc:DCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RCe{constructor(e){this.variableNames=["A"];const n=us(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OCe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=us(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PCe={kernelName:Xy,backendName:"webgl",kernelFunc:FCe};let au,X2=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function FCe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],h=[c,l,i];if(a||o){const g=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(au==null||g!==X2)&&(X2=g,au=document.createElement("canvas").getContext("2d",{willReadFrequently:X2})),au.canvas.width=l,au.canvas.height=c,au.drawImage(r,0,0,l,c),r=au.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=rr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),r);const f=K().getBool("WEBGL_PACK")?new OCe(h):new RCe(h),p=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s,g=Oo(u),m=Cn(r.shape,i.shape,l,h,c,d,!1,g);let x;const y=[],b=o!=null,w=a!=null,v=f==="leakyrelu",S=()=>{const k=[r,i],I=(_,D)=>{if(D==="NCHW"&&_.shape.length===1&&_.shape[0]!==1){const A=le({inputs:{x:_},backend:n,attrs:{shape:[_.shape[0],1,1]}});return y.push(A),A}return _};if(b&&k.push(I(o,u)),w&&k.push(I(a,u)),v){const _=n.makeTensorInfo([],"float32",Ao(p,"float32"));k.push(_),y.push(_)}return k};if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))x=a8({x:r,filter:i,convInfo:m,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(m.strideWidth<=2&&g==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const k=f?Zp(f,!0):null,I=new o8(m,b,k,w,v),_=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],D=S();x=n.runWebGLProgram(I,D,"float32",_)}else if(K().getBool("WEBGL_CONV_IM2COL"))x=l8({x:r,filter:i,convInfo:m,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const k=f?Zp(f,!1):null,I=new i8(m,b,k,w,v),_=S();x=n.runWebGLProgram(I,_,"float32")}const T=le({inputs:{x},backend:n,attrs:{shape:m.outShape}});return y.push(x),y.forEach(k=>n.disposeIntermediateTensorInfo(k)),T}const LCe={kernelName:Mp,backendName:"webgl",kernelFunc:MCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=s,p=[];let g=u;g==null&&(g=[1,1]),N(Fn(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const m=Cn(r.shape,i.shape,l,g,c,h,!0),x=K().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,y=d?Zp(d,x):null,b=[r,i],w=o!=null,v=a!=null,S=d==="leakyrelu";if(w&&b.push(o),v&&b.push(a),S){const _=n.makeTensorInfo([],"float32",Ao(f,"float32"));b.push(_),p.push(_)}let T;x?T=new h8(m,w,y,v,S):T=new u8(m,w,y,v,S);const k=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],I=n.runWebGLProgram(T,b,"float32",k);return p.forEach(_=>n.disposeIntermediateTensorInfo(_)),I}const BCe={kernelName:Lp,backendName:"webgl",kernelFunc:zCe};class VCe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=ot(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=r.shape,o=i[i.length-1],a=Q(s.shape),[l,c,u,h]=cv(s,r),d=le({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),f=le({inputs:{x:s},backend:n,attrs:{shape:[Q(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const x=n.readSync(r.dataId),y=n.bufferSync(s),b=Hwe(x,y,s.dtype,c,o,u,h,s.shape,a);return n.makeTensorInfo(l,s.dtype,b.values)}const p=new VCe(o,h,[c,u],s.shape),g=n.runWebGLProgram(p,[f,d],f.dtype),m=le({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}const UCe={kernelName:Wb,backendName:"webgl",kernelFunc:WCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jCe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=ot(this.rank),r=HCe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function HCe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s,l=Oe(o,r.shape)[0];if(K().get("DEBUG")){const y=n.readSync(i.dataId),b=r.shape[l];for(let w=0;w<y.length;++w){const v=y[w];N(v<=b-1&&v>=0,()=>`GatherV2: the index value ${v} is not in [0, ${b-1}]`)}}const c=f_(r,i,l,a),u=Q(i.shape),h=[],d=le({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=le({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const y=n.bufferSync(f),b=n.bufferSync(d),w=Gwe(b,y,p);return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(c.outputShape,w.dtype,w.values)}const g=new jCe(d.shape,p),m=n.runWebGLProgram(g,[d,f],d.dtype);h.push(m);const x=le({inputs:{x:m},backend:n,attrs:{shape:c.outputShape}});return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const GCe={kernelName:Bm,backendName:"webgl",kernelFunc:p8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qCe="return float(a > b);",KCe=`
  return vec4(greaterThan(a, b));
`,XCe=zn({opSnippet:qCe,packedOpSnippet:KCe,cpuKernelImpl:qwe,dtype:"bool"}),YCe={kernelName:Vm,backendName:"webgl",kernelFunc:XCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QCe="return float(a >= b);",ZCe=`
  return vec4(greaterThanEqual(a, b));
`,JCe=zn({opSnippet:QCe,packedOpSnippet:ZCe,dtype:"bool",cpuKernelImpl:Kwe}),eTe={kernelName:qh,backendName:"webgl",kernelFunc:JCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tTe(t){const{inputs:e,backend:n}=t,{input:s}=e;return f8(s,!0,n)}const nTe={kernelName:Ub,backendName:"webgl",kernelFunc:tTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sTe="return float(!isnan(x) && !isinf(x));",rTe=He({opSnippet:sTe,dtype:"bool"}),iTe={kernelName:Xh,backendName:"webgl",kernelFunc:rTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oTe="return float(isinf(x));",aTe=He({opSnippet:oTe,dtype:"bool"}),lTe={kernelName:Yh,backendName:"webgl",kernelFunc:aTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cTe="return float(isnan(x));",uTe=He({opSnippet:cTe,dtype:"bool"}),hTe={kernelName:Qh,backendName:"webgl",kernelFunc:uTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dTe="return float(a < b);",fTe=`
  return vec4(lessThan(a, b));
`,pTe=zn({opSnippet:dTe,packedOpSnippet:fTe,cpuKernelImpl:Xwe,dtype:"bool"}),mTe={kernelName:Um,backendName:"webgl",kernelFunc:pTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gTe="return float(a <= b);",xTe=`
  return vec4(lessThanEqual(a, b));
`,yTe=zn({opSnippet:gTe,packedOpSnippet:xTe,cpuKernelImpl:Ywe,dtype:"bool"}),bTe={kernelName:jm,backendName:"webgl",kernelFunc:yTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wTe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=Qwe(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const vTe={kernelName:Hb,backendName:"webgl",kernelFunc:wTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe=jd+`
  return x < 0.0 ? 0./0. : log(x);
`,kTe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,CTe=He({opSnippet:STe,packedOpSnippet:kTe,cpuKernelImpl:Zwe}),TTe={kernelName:Zh,backendName:"webgl",kernelFunc:CTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ITe=jd+`
  return log(1.0 + x);
`,NTe=He({opSnippet:ITe}),_Te={kernelName:Jh,backendName:"webgl",kernelFunc:NTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Te="return float(a >= 1.0 && b >= 1.0);",ETe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,DTe=zn({opSnippet:$Te,packedOpSnippet:ETe,dtype:"bool"}),ATe={kernelName:Hm,backendName:"webgl",kernelFunc:DTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RTe="return float(!(x >= 1.0));",OTe=He({opSnippet:RTe}),PTe={kernelName:Gm,backendName:"webgl",kernelFunc:OTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FTe="return float(a >= 1.0 || b >= 1.0);",MTe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,LTe=zn({opSnippet:FTe,packedOpSnippet:MTe,dtype:"bool"}),zTe={kernelName:qm,backendName:"webgl",kernelFunc:LTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BTe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VTe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WTe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=K().getBool("WEBGL_PACK_NORMALIZATION")?new VTe(r.shape,i,o,a,l):new BTe(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},UTe={kernelName:Km,backendName:"webgl",kernelFunc:WTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jTe{constructor(e,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HTe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,h=new jTe(r.shape,a,l,c,u);return n.runWebGLProgram(h,[r,i,o],r.dtype)},GTe={kernelName:Gb,backendName:"webgl",kernelFunc:HTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qTe(t,e,n,s){const r=Q(e),o=Q(t.shape)/r,a=le({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=tu(a,t.dtype,"max",s),c=le({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=Oe(i,r.shape);let c=l;const u=Et(c,a),h=u!=null,d=n.shouldExecuteOnCPU([r]);let f=r;if(h){if(d){const b=n.texData.get(f.dataId).values,w=new Array(a);for(let T=0;T<w.length;T++)w[T]=r.shape[u[T]];const v=pE(b,r.shape,r.dtype,u,w);f=n.makeTensorInfo(w,r.dtype);const S=n.texData.get(f.dataId);S.values=v}else f=Mv(r,u,n);c=Ht(c.length,a)}Mn("max",c,a);const[p,g]=Tn(f.shape,c);let m=p;o&&(m=Wt(p,l));let x;if(d){const b=n.texData.get(f.dataId).values,w=Jwe(b,Q(g),m,r.dtype);x=n.makeTensorInfo(m,r.dtype);const v=n.texData.get(x.dataId);v.values=w}else x=qTe(f,g,m,n);return h&&n.disposeIntermediateTensorInfo(f),x}const KTe={kernelName:Xm,backendName:"webgl",kernelFunc:m8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XTe=mE+`
  return max(a, b);
`,YTe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+eu+`
  return result;
`,QTe=zn({opSnippet:XTe,packedOpSnippet:YTe,cpuKernelImpl:eve}),ZTe={kernelName:ed,backendName:"webgl",kernelFunc:QTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ld(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;N(Fn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Fr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Fe(u.inShape,u.outShape))return js({inputs:{x:r},backend:n});const h=new Jp(u,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const eIe={kernelName:Ym,backendName:"webgl",kernelFunc:JTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],h=Ro(r.shape,i,o,u,a,c,l),d=new xE(h,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const nIe={kernelName:Qm,backendName:"webgl",kernelFunc:tIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sIe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class rIe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=l-1-e.padInfo.front,d=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=Ro(o.shape,a,l,h,c,u),f=new xE(d,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),g=new rIe(d),m=n.runWebGLProgram(g,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),m}const oIe={kernelName:Kb,backendName:"webgl",kernelFunc:iIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aIe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Ld([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=Fr(a.shape,l,c,1,u,h),f=!0,p=new Jp(d,"max",f),g=n.runWebGLProgram(p,[a],a.dtype),m=new sIe(d),x=n.runWebGLProgram(m,[r,g],a.dtype);return n.disposeIntermediateTensorInfo(g),x}const lIe={kernelName:qb,backendName:"webgl",kernelFunc:aIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cIe(t,e,n,s){let r=new Jp(n,"max",!1);const i=s.runWebGLProgram(r,[t],"float32");r=new Jp(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uIe={kernelName:Xb,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;N(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];N(Fn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Fr(s.shape,r,i,c,o),[h,d]=cIe(s,a,u,l);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hIe(t,e,n,s){const r=Q(e),o=Q(t.shape)/r,a=le({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=tu(a,"float32","mean",s),c=le({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dIe={kernelName:Zm,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:i}=e,o=n,a=s.shape.length,l=Oe(i,s.shape);let c=l;const u=Et(c,a),h=u!=null,d=o.shouldExecuteOnCPU([s]),f=[];let p=s;if(h){if(d){const w=o.texData.get(p.dataId).values,v=new Array(a);for(let k=0;k<v.length;k++)v[k]=s.shape[u[k]];const S=pE(w,s.shape,s.dtype,u,v);p=o.makeTensorInfo(v,s.dtype);const T=o.texData.get(p.dataId);T.values=S}else p=Mv(s,u,o);f.push(p),c=Ht(c.length,a)}Mn("sum",c,a);const[g,m]=Tn(p.shape,c);let x=g;r&&(x=Wt(g,l));const y=hIe(p,m,x,o);for(const b of f)o.disposeIntermediateTensorInfo(b);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Oe(i,r.shape);let c=l;const u=Et(c,a);let h=r;u!=null&&(h=os({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Ht(c.length,r.shape.length)),Mn("min",c,a);const[d,f]=Tn(h.shape,c),p=Q(f),g=le({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=tu(g,g.dtype,"min",n);let x;if(o){const y=Wt(d,l);x=le({inputs:{x:m},backend:n,attrs:{shape:y}})}else x=le({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),x}const pIe={kernelName:Jm,backendName:"webgl",kernelFunc:fIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mIe=mE+`
  return min(a, b);
`,gIe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+eu+`
  return result;
`,xIe=zn({opSnippet:mIe,packedOpSnippet:gIe,cpuKernelImpl:tve}),yIe={kernelName:td,backendName:"webgl",kernelFunc:xIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bIe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,h)=>u[0]+e[h]+u[1]);const r=e.length,i=ot(r),o=n.map(u=>u[0]).join(","),a=n.map((u,h)=>u[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wIe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+e[g]+p[1]);const r=e.length,i=ot(r),o=n.map(p=>p[0]).join(","),a=n.map((p,g)=>p[0]+e[g]).join(","),l=es("rc",r),c=es("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,d=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${h});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vIe=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:i}=n,o=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wIe(s.shape,r,i):new bIe(s.shape,r,i);return e.runWebGLProgram(o,[s],s.dtype)},SIe={kernelName:eg,backendName:"webgl",kernelFunc:vIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kIe=`if (b == 0.0) return NAN;
  return mod(a, b);`,CIe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+eu+`
  return result;
`,TIe=zn({opSnippet:kIe,packedOpSnippet:CIe}),IIe={kernelName:nd,backendName:"webgl",kernelFunc:TIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NIe{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ie=`
if (a == b) {
  return 1.0;
};
return a / b;`,$Ie=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,g8=zn({opSnippet:_Ie,packedOpSnippet:$Ie,checkOutOfBounds:!0}),EIe={kernelName:Bh,backendName:"webgl",kernelFunc:g8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yP="return a - b;",x8=zn({opSnippet:yP,packedOpSnippet:yP,supportsComplex:!0,cpuKernelImpl:Sve}),DIe={kernelName:yd,backendName:"webgl",kernelFunc:x8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=Oe([i],r.shape),a=m8({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=Wt(a.shape,o),c=le({inputs:{x:a},backend:n,attrs:{shape:l}}),u=x8({inputs:{a:r,b:c},backend:n}),h=d8({inputs:{x:u},backend:n}),d=Lv({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),f=le({inputs:{x:d},backend:n,attrs:{shape:l}}),p=g8({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}const AIe={kernelName:yg,backendName:"webgl",kernelFunc:y8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RIe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s,l=a?r:y8({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new NIe(c,u,i),d=[[o]],f=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),f}const OIe={kernelName:Yb,backendName:"webgl",kernelFunc:RIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PIe=Lr+`
  return -x;
`,FIe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function MIe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=sve(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new la(s.shape,FIe):r=new Ti(s.shape,PIe),n.runWebGLProgram(r,[s],s.dtype)}const LIe={kernelName:tg,backendName:"webgl",kernelFunc:MIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zIe=iv;function BIe(t){Js("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:h}=zIe(c,u,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const VIe={kernelName:Qb,backendName:"webgl",kernelFunc:BIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WIe=ov;function UIe(t){Js("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),h=n.readSync(i.dataId),{selectedIndices:d,validOutputs:f}=WIe(u,h,o,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const jIe={kernelName:Zb,backendName:"webgl",kernelFunc:UIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HIe=av;function GIe(t){Js("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),h=n.readSync(i.dataId),d=o,f=a,p=l,g=c,{selectedIndices:m,selectedScores:x}=HIe(u,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const qIe={kernelName:Jb,backendName:"webgl",kernelFunc:GIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KIe{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XIe=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=Q(r.shape),u=new KIe(c,o,a,l),h=le({inputs:{x:r},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],i);n.disposeIntermediateTensorInfo(h);const f=[...r.shape,o],p=le({inputs:{x:d},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(d),p},YIe={kernelName:rg,backendName:"webgl",kernelFunc:XIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=o0({inputs:{input:s},backend:n}),i=w1({inputs:{x:r},backend:n}),o=zv({inputs:{input:s},backend:n}),a=w1({inputs:{x:o},backend:n}),l=ll({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return a0({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const QIe={kernelName:Sg,backendName:"webgl",kernelFunc:w1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=o0({inputs:{input:s},backend:n}),i=b8({inputs:{x:r},backend:n}),o=zv({inputs:{input:s},backend:n}),a=w1({inputs:{x:o},backend:n}),l=ll({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return a0({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const ZIe={kernelName:sg,backendName:"webgl",kernelFunc:b8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JIe(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return wC({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Pn(i,u.shape,"All tensors passed to stack must have matching shapes"),N(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=wC({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(h),h}),c=r8({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const eNe={kernelName:ig,backendName:"webgl",kernelFunc:JIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tNe{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,i=ot(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nNe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,m)=>g[0]+e[m]+g[1]);const r=e.length,i=ot(r),o=n.map(g=>g[0]).join(","),a=n.map((g,m)=>g[0]+e[m]).join(","),l=es("rc",r),c=es("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,m=r===1?2:4;g<m;g++)p+=`
        ${d[g]}
        if (${f}) {
          result[${g}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${g}] = getChannel(getX(${c.join()}), ${h});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w8=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;if(Q(r.shape)===0){const c=i.map((u,h)=>u[0]+r.shape[h]+u[1]);return a0({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nNe(r.shape,i,o):new tNe(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},sNe={kernelName:og,backendName:"webgl",kernelFunc:w8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rNe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,iNe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+eu+`
  return result;
`,oNe=zn({opSnippet:rNe,packedOpSnippet:iNe}),aNe={kernelName:rd,backendName:"webgl",kernelFunc:oNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=Oe(i,r.shape);let u=c;const h=Et(u,a);let d=r;h!=null&&(d=os({inputs:{x:r},backend:n,attrs:{perm:h}}),u=Ht(u.length,a),l.push(d)),Mn("prod",u,a);let f;if(n.shouldExecuteOnCPU([d])){const p=n.texData.get(d.dataId).values,{outVals:g,outShape:m,outDtype:x}=ive(d.shape,d.dtype,p,u);f=n.makeTensorInfo(m,x,g)}else{const[p,g]=Tn(d.shape,u),m=Q(g),x=le({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),y=Tw(r.dtype),b=tu(x,y,"prod",n);f=le({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(x),l.push(b)}if(o){l.push(f);const p=Wt(f.shape,c);f=le({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const cNe={kernelName:lg,backendName:"webgl",kernelFunc:lNe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uNe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(x=>n.readSync(x.dataId)),c=r.map(x=>x.shape),u=n.readSync(i.dataId),h=n.readSync(o.dataId),[d,f,p]=ove(l,c,u,i.shape,i.dtype,h,o.shape,a),g=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),m=n.makeTensorInfo(p,i.dtype,f);return g.concat([m])}const hNe={kernelName:ew,backendName:"webgl",kernelFunc:uNe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dNe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=ave(o,s.shape,s.dtype,a,r.shape,l,i.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],s.dtype,u);return[h,d]}const fNe={kernelName:tw,backendName:"webgl",kernelFunc:dNe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pNe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),h=n.readSync(o.dataId),d=a.map(m=>n.readSync(m.dataId)),f=a.map(m=>m.shape),[p,g]=lve(c,r.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,g)}const mNe={kernelName:nw,backendName:"webgl",kernelFunc:pNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v8=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:i,dtype:o}=n,a=cve(s,r,i,o);return e.makeTensorInfo([a.length],o,a)},gNe={kernelName:sw,backendName:"webgl",kernelFunc:v8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xNe="return 1.0 / x;",yNe=He({opSnippet:xNe}),bNe={kernelName:id,backendName:"webgl",kernelFunc:yNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wNe=Lr+`
  return (x < 0.0) ? 0.0 : x;
`,vNe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,SNe=He({opSnippet:wNe,packedOpSnippet:vNe}),kNe={kernelName:od,backendName:"webgl",kernelFunc:SNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CNe=Lr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,TNe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,INe=He({opSnippet:CNe,packedOpSnippet:TNe}),NNe={kernelName:ad,backendName:"webgl",kernelFunc:INe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ne{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s];let d;i?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ne{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s];let d;i?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ENe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new $Ne(r.shape,l,c,i,o):new _Ne(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const DNe={kernelName:hg,backendName:"webgl",kernelFunc:ENe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ANe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RNe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new ANe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const ONe={kernelName:ow,backendName:"webgl",kernelFunc:RNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PNe{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s],d=r?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FNe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s],d=r?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MNe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new FNe(r.shape,l,c,i,o):new PNe(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const LNe={kernelName:ug,backendName:"webgl",kernelFunc:MNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zNe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BNe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new zNe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const VNe={kernelName:iw,backendName:"webgl",kernelFunc:BNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WNe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>r(l)).join(","),o=ot(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UNe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=es("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=ot(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${h(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return d(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",d(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",d(p)}function h(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",d(p)}function d(p){const g=e.map((y,b)=>f(b,p)),m=g.join(","),x=g.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${x}))`}function f(p,g){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s,o=r.shape.length,a=Oe(i,r.shape);if(o===0)return js({inputs:{x:r},backend:n});const l=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UNe(r.shape,a):new WNe(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const HNe={kernelName:dg,backendName:"webgl",kernelFunc:jNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GNe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qNe={kernelName:kw,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=new GNe(s.shape,i),[c,u]=QN(o,s.shape[1],s.shape[2]),h=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KNe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,XNe=He({opSnippet:KNe}),YNe={kernelName:ld,backendName:"webgl",kernelFunc:XNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QNe="return inversesqrt(x);",ZNe=He({opSnippet:QNe,cpuKernelImpl:uve}),JNe={kernelName:cd,backendName:"webgl",kernelFunc:ZNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yE{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=ot(i.length),u=ot(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const d=`getIndices(${h})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e_e{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=ot(i.length),u=ot(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const d=`getIndices(${h})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,x=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t_e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=ol(i,r,o),d=[h/c,c];if(h===0)return n.makeTensorInfo(o,r.dtype);const f=le({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=le({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;K().getBool("WEBGL_PACK")?m=new e_e(l,a,f.shape.length,p.shape.length,u,d):m=new yE(l,a,f.shape.length,p.shape.length,u,d);const x=n.runWebGLProgram(m,[p,f,g],p.dtype),y=le({inputs:{x},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(g),y}const n_e={kernelName:aw,backendName:"webgl",kernelFunc:t_e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s_e{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=K().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r_e(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=new s_e(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const i_e={kernelName:cw,backendName:"webgl",kernelFunc:r_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o_e{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=ot(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_e(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e,o=new o_e(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],xs(r.dtype,i.dtype))}const l_e={kernelName:fg,backendName:"webgl",kernelFunc:a_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c_e=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${dv};
  float scale = ${fv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,u_e=He({opSnippet:c_e}),h_e={kernelName:ud,backendName:"webgl",kernelFunc:u_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d_e=jd+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,f_e=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,p_e=He({opSnippet:d_e,packedOpSnippet:f_e,cpuKernelImpl:dve}),m_e={kernelName:pd,backendName:"webgl",kernelFunc:p_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_e=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,x_e=He({opSnippet:g_e}),y_e={kernelName:fd,backendName:"webgl",kernelFunc:x_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b_e=jd+`
  return sin(x);
`,w_e=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${eu}
  return result;
`,v_e=He({opSnippet:b_e,packedOpSnippet:w_e}),S_e={kernelName:hd,backendName:"webgl",kernelFunc:v_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k_e=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,C_e=He({opSnippet:k_e}),T_e={kernelName:dd,backendName:"webgl",kernelFunc:C_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_e=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,N_e=He({opSnippet:I_e}),__e={kernelName:md,backendName:"webgl",kernelFunc:N_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $_e=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;N(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,y)=>x*y),l=[[0,0]];l.push(...o);for(let x=1+i.length;x<r.shape.length;++x)l.push([0,0]);const c=[],u=w8({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),h=Ug(u.shape,i,a,!1),d=jg(h.length,i.length,!1),f=Hg(u.shape,i,a,!1),p=le({inputs:{x:u},backend:n,attrs:{shape:h}}),g=os({inputs:{x:p},backend:n,attrs:{perm:d}}),m=le({inputs:{x:g},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(g),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),m},E_e={kernelName:gg,backendName:"webgl",kernelFunc:$_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D_e(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[h,d,f,p,g]=pve(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const A_e={kernelName:uw,backendName:"webgl",kernelFunc:D_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_e(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,h]=mve(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const O_e={kernelName:hw,backendName:"webgl",kernelFunc:R_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=UU(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const F_e={kernelName:dw,backendName:"webgl",kernelFunc:P_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M_e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=UU(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const L_e={kernelName:fw,backendName:"webgl",kernelFunc:M_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_e(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=ol(i,r,a),f=!1;if(i.dtype==="string"){const x=n.bufferSync(r),y=n.bufferSync(i),b=Co(n.readSync(o.dataId)[0]),w=hve(x,y,a,d,u,c,l,h,b,f);return n.makeTensorInfo(a,w.dtype,w.values)}const p=new yE(c,l,r.shape.length,i.shape.length,h,[d,1],f),g=n.runWebGLProgram(p,[i,r,o],i.dtype),m=le({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),m}const B_e={kernelName:pw,backendName:"webgl",kernelFunc:z_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=Oe(o,r.shape)[0],l=d_(r,i,a),c=r.shape.length,u=new Array(c).fill(0),h=r.shape.slice();return l.map(d=>{const f=[...h];f[a]=d;const p=Hd({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,p})}const W_e={kernelName:xg,backendName:"webgl",kernelFunc:V_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bP="return sqrt(x);",U_e=He({opSnippet:bP,packedOpSnippet:bP,cpuKernelImpl:gve}),j_e={kernelName:gd,backendName:"webgl",kernelFunc:U_e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H_e="return x * x;",G_e=He({opSnippet:H_e}),q_e={kernelName:mw,backendName:"webgl",kernelFunc:G_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wP="return (a - b) * (a - b);",K_e=zn({opSnippet:wP,packedOpSnippet:wP}),X_e={kernelName:xd,backendName:"webgl",kernelFunc:K_e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(r.dataId),o=$o(i),a=xve(o,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const Q_e={kernelName:bg,backendName:"webgl",kernelFunc:Y_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_e({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=Lr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new Ti(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const J_e={kernelName:Sd,backendName:"webgl",kernelFunc:Z_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e$e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=ot(s.length),o=ot(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s,{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:x,begin:y,end:b,strides:w}=qN(r.shape,i,o,a,l,c,u,h,d);let v;if(g)v=le({inputs:{x:r},backend:n,attrs:{shape:p}});else if(m||x){N(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const T=jN(y,b,w),k=Hd({inputs:{x:r},backend:n,attrs:{begin:y,size:T}});v=le({inputs:{x:k},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(k)}else if(n.shouldExecuteOnCPU([r])){const k=n.readSync(r.dataId),I=De(r.shape,r.dtype,k),_=yve(f,I,w,y);v=n.makeTensorInfo(p,r.dtype,_.values)}else{const k=new e$e(y,w,f);v=n.runWebGLProgram(k,[r],r.dtype)}const S=le({inputs:{x:v},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(v),S}const n$e={kernelName:gw,backendName:"webgl",kernelFunc:t$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=e,d=n.readSync(u.dataId),f=n.readSync(h.dataId),[p,g]=bve(d,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}const r$e={kernelName:xw,backendName:"webgl",kernelFunc:s$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i$e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,h]=wve(a,l,r),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const o$e={kernelName:yw,backendName:"webgl",kernelFunc:i$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=vve(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const l$e={kernelName:bw,backendName:"webgl",kernelFunc:a$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c$e="return tan(x);",u$e=He({opSnippet:c$e}),h$e={kernelName:bd,backendName:"webgl",kernelFunc:u$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$e=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,f$e=He({opSnippet:d$e}),p$e={kernelName:wd,backendName:"webgl",kernelFunc:f$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$e(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=ol(o,i,r.shape),d=[h/c,c];if(h===0)return n.makeTensorInfo(r.shape,i.dtype);const f=le({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=le({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),g=le({inputs:{x:r},backend:n,attrs:{shape:d}}),m=new yE(l,a,f.shape.length,p.shape.length,u,d,!1,!0),x=n.runWebGLProgram(m,[p,f,g],g.dtype),y=le({inputs:{x},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),y}const g$e={kernelName:lw,backendName:"webgl",kernelFunc:m$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x$e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=ot(this.rank),i=y$e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function y$e(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(d=>Co(d)):l,u=De(r.shape,r.dtype,c),h=kve(u,i);return n.makeTensorInfo(h.shape,h.dtype,h.values)}const o=new x$e(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const b$e={kernelName:vd,backendName:"webgl",kernelFunc:S8};class w$e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class v$e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fl(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function vP(t){let e=1;for(;e<t;)e*=2;return e}function S$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s,a=K().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=K().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const _=n.readSync(r.dataId),[D,A]=Cve(_,c,r.dtype,i,o);return[n.makeTensorInfo(D.shape,D.dtype,D.values),n.makeTensorInfo(A.shape,A.dtype,A.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,a0({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const h=n.texData.get(r.dataId),d=h!==null&&h.isPacked,f=d?n.unpackTensor(r):r,g=Q(c)/u,m=le({inputs:{x:f},attrs:{shape:[g,u]},backend:n});d&&fl(n,f);const x=vP(i),y=vP(u);let b=null;const w=()=>b===null?[m,m]:[m,b],v=(_,D,A)=>{const L=w(),B=new w$e(A),R=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[_],[D]],O=b;b=n.runWebGLProgram(B,L,"int32",R),fl(n,O)};for(let _=1;_<x;_*=2){const D=_*2;for(let A=_;A>=1;A/=2)v(D,A,[g,y])}for(let _=y;_>x;_/=2){const D=w(),A=new v$e([g,_/2]),B=[[u],[b===null?1:0],[x]],F=b;b=n.runWebGLProgram(A,D,"int32",B),fl(n,F);const R=x/2,O=R*2;for(let E=R;E>=1;E/=2)v(O,E,b.shape)}let S=b;b=Hd({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,i]}}),fl(n,S);let T=p8({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});fl(n,m);const k=c.slice(0,-1);k.push(i),S=b,b=le({inputs:{x:b},attrs:{shape:k},backend:n}),fl(n,S);const I=T;return T=le({inputs:{x:T},attrs:{shape:k},backend:n}),fl(n,I),[T,b]}const k$e={kernelName:ww,backendName:"webgl",kernelFunc:S$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C$e{constructor(e,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,h,d,f]=r.shape,[p,g]=c??[h,d],m=[u,p,g,f],x=new C$e(h,d,o,a,l,m);return n.runWebGLProgram(x,[r,i],"float32")}const I$e={kernelName:vw,backendName:"webgl",kernelFunc:T$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N$e(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Ld(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=Tve(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const _$e={kernelName:Sw,backendName:"webgl",kernelFunc:N$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $$e(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let g=0;g<a;g++)g!==i&&(c[u++]=o.shape[g]);const h=[],d=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let g=0;g<p.length;g++){d[i]=g;const m=Hd({inputs:{x:o},backend:n,attrs:{begin:d,size:f}}),x=le({inputs:{x:m},backend:n,attrs:{shape:c}});p[g]=x,h.push(m)}return h.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const E$e={kernelName:wg,backendName:"webgl",kernelFunc:$$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D$e{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,h=s%4,d=`
        sumValue += dot(values, segFilter);
    `;let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=Et([c],a);let h=r;u!=null&&(h=os({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(h),c=Ht(1,a)[0]);const d=JV(h.shape,c,o),f=Q([h.shape[c]]),p=le({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(p);const g=Tw(r.dtype),m=(w,v,S,T,k)=>{const I=w.shape[0],_=w.shape[1],D=ZV(_,k),A={windowSize:D,inSize:_,batchSize:I,numSegments:k},L=new D$e(A,v),B=n.compileAndRun(L,[w,S],T);if(l.push(B),B.shape[1]===k)return B;const F=v8({backend:n,attrs:{start:0,stop:k,step:1,dtype:"float32"}}),R=S8({inputs:{x:F},backend:n,attrs:{reps:[_/D]}});return l.push(F),l.push(R),m(B,v,R,T,k)},x=m(p,"unsortedSegmentSum",i,g,o),y=le({inputs:{x},backend:n,attrs:{shape:d}});let b=y;if(u!=null){l.push(y);const w=nl(u);b=os({inputs:{x:b},backend:n,attrs:{perm:w}})}return l.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const R$e={kernelName:vg,backendName:"webgl",kernelFunc:A$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$e=[x2e,b2e,S2e,T2e,N2e,E2e,A2e,O2e,L2e,B2e,U2e,G2e,X2e,J2e,nSe,rSe,oSe,uSe,dSe,pSe,ySe,TSe,NSe,DSe,RSe,zSe,VSe,HSe,e2e,KSe,JSe,ske,cke,dke,pke,gke,yke,Ske,Tke,_ke,Eke,Ake,Oke,Mke,zke,Uke,Hke,Kke,Qke,Jke,sCe,aCe,hCe,pCe,xCe,yCe,wCe,SCe,CCe,ICe,_Ce,ACe,PCe,LCe,BCe,UCe,GCe,YCe,eTe,Jve,nTe,QSe,iTe,lTe,hTe,n2e,mTe,bTe,vTe,TTe,_Te,ATe,PTe,zTe,UTe,GTe,KTe,ZTe,eIe,nIe,oIe,lIe,uIe,dIe,pIe,yIe,SIe,IIe,OIe,i2e,LIe,VIe,jIe,qIe,PSe,YIe,ZIe,eNe,sNe,aNe,r2e,cNe,hNe,fNe,mNe,gNe,FSe,EIe,bNe,kNe,NNe,a2e,DNe,ONe,LNe,VNe,HNe,qNe,YNe,JNe,n_e,i_e,l_e,h_e,m_e,y_e,S_e,T_e,kSe,AIe,__e,E_e,A_e,O_e,F_e,L_e,B_e,W_e,j_e,q_e,X_e,Q_e,J_e,n$e,r$e,o$e,l$e,DIe,p2e,h$e,p$e,g$e,b$e,k$e,I$e,m2e,_$e,E$e,R$e,QIe];for(const t of O$e)Cw(t);/** @license See the LICENSE file. */const P$e="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F$e={"tfjs-core":$V,"tfjs-backend-cpu":A6,"tfjs-backend-webgl":GU,"tfjs-data":FW,"tfjs-layers":Iv,"tfjs-converter":wW,tfjs:P$e},Rl=Object.freeze(Object.defineProperty({__proto__:null,Abs:wm,Acos:_h,Acosh:$h,AdadeltaOptimizer:ON,AdagradOptimizer:PN,AdamOptimizer:FN,AdamaxOptimizer:MN,Add:Wc,AddN:vm,All:bb,Any:wb,ArgMax:Sm,ArgMin:km,Asin:Eh,Asinh:Dh,Atan:Ah,Atan2:Oh,Atanh:Rh,AvgPool:Cm,AvgPool3D:Tm,AvgPool3DGrad:Sb,AvgPoolGrad:vb,BatchMatMul:Im,BatchToSpaceND:Nm,Bincount:kb,BitwiseAnd:_m,BroadcastArgs:Cb,BroadcastTo:Cz,Callback:mW,CallbackList:y5,Cast:Ph,Ceil:Fh,ClipByValue:Mh,Complex:Tb,ComplexAbs:$m,Concat:Em,Conv2D:Dm,Conv2DBackpropFilter:Ib,Conv2DBackpropInput:Am,Conv3D:Rm,Conv3DBackpropFilterV2:Nb,Conv3DBackpropInputV2:_b,Cos:Lh,Cosh:zh,CropAndResize:Eb,Cumprod:$b,Cumsum:Om,CustomCallback:w5,DataStorage:iI,DenseBincount:Db,DepthToSpace:Ab,DepthwiseConv2dNative:Pm,DepthwiseConv2dNativeBackpropFilter:Rb,DepthwiseConv2dNativeBackpropInput:Ob,Diag:Pb,Dilation2D:Fm,Dilation2DBackpropFilter:Ky,Dilation2DBackpropInput:qy,Draw:Fb,get ENV(){return uI},EarlyStopping:gW,Einsum:Mb,Elu:Vh,EluGrad:Lb,Environment:Sz,Equal:Mm,Erf:Wh,Exp:Uh,ExpandDims:Lm,Expm1:jh,FFT:zb,Fill:Bb,FlipLeftRight:Vb,Floor:Hh,FloorDiv:Gh,FromPixels:Xy,FusedBatchNorm:zm,FusedConv2D:Mp,FusedDepthwiseConv2D:Lp,GPGPUContext:Mx,GatherNd:Wb,GatherV2:Bm,GraphModel:j$,Greater:Vm,GreaterEqual:qh,History:b5,IFFT:Ub,Identity:Kh,Imag:jb,InputSpec:Zt,IsFinite:Xh,IsInf:Yh,IsNan:Qh,KernelBackend:gb,LRN:Km,LRNGrad:Gb,LayerVariable:p5,LayersModel:mo,LeakyRelu:Wm,Less:Um,LessEqual:jm,LinSpace:Hb,Log:Zh,Log1p:Jh,LogSoftmax:Tz,LogicalAnd:Hm,LogicalNot:Gm,LogicalOr:qm,LogicalXor:kZ,LowerBound:CZ,MathBackendCPU:t0,MathBackendWebGL:i0,MatrixBandPart:TZ,Max:Xm,MaxPool:Ym,MaxPool3D:Qm,MaxPool3DGrad:Kb,MaxPoolGrad:qb,MaxPoolWithArgmax:Xb,Maximum:ed,Mean:Zm,Min:Jm,Minimum:td,MirrorPad:eg,Mod:nd,MomentumOptimizer:LN,Multinomial:Yb,Multiply:sd,Neg:tg,NonMaxSuppressionV3:Qb,NonMaxSuppressionV4:Zb,NonMaxSuppressionV5:Jb,NotEqual:ng,OP_SCOPE_SUFFIX:gI,OneHot:rg,OnesLike:sg,Optimizer:Lo,OptimizerConstructors:EV,Pack:ig,PadV2:og,Pool:IZ,Pow:rd,Prelu:ag,Prod:lg,RMSPropOptimizer:zN,RNN:fi,RaggedGather:ew,RaggedRange:tw,RaggedTensorToTensor:nw,Range:sw,get Rank(){return _k},Real:rw,RealDiv:Bh,Reciprocal:id,get Reduction(){return Jn},Relu:od,Relu6:ad,Reshape:cg,ResizeBilinear:hg,ResizeBilinearGrad:ow,ResizeNearestNeighbor:ug,ResizeNearestNeighborGrad:iw,Reverse:dg,RotateWithOffset:kw,Round:ld,Rsqrt:cd,SGDOptimizer:lv,ScatterNd:aw,SearchSorted:cw,Select:fg,Selu:ud,Sequential:Sc,Sigmoid:pd,Sign:fd,Sin:hd,Sinh:dd,Slice:pg,Softmax:yg,Softplus:md,SpaceToBatchND:gg,SparseFillEmptyRows:uw,SparseReshape:hw,SparseSegmentMean:dw,SparseSegmentSum:fw,SparseToDense:pw,SplitV:xg,Sqrt:gd,Square:mw,SquaredDifference:xd,StaticRegexReplace:bg,Step:Sd,StridedSlice:gw,StringNGrams:xw,StringSplit:yw,StringToHashBucketFast:bw,Sub:yd,Sum:mg,SymbolicTensor:oi,Tan:bd,Tanh:wd,Tensor:je,TensorBuffer:nn,TensorScatterUpdate:lw,Tile:vd,TopK:ww,Transform:vw,Transpose:ql,Unique:Sw,Unpack:wg,UnsortedSegmentSum:vg,UpperBound:NZ,Variable:Vp,ZerosLike:Sg,_FusedMatMul:Fp,abs:Xt,acos:CI,acosh:TI,add:se,addN:iB,all:_w,any:Up,argMax:mc,argMin:II,asin:NI,asinh:_I,atan:$I,atan2:EI,atanh:DI,avgPool:Ig,avgPool3d:RI,backend:yI,backend_util:t5,basicLSTMCell:oB,batchNorm:kd,batchNorm2d:OI,batchNorm3d:PI,batchNorm4d:FI,batchToSpaceND:Ng,bincount:MI,bitwiseAnd:aB,booleanMaskAsync:GB,broadcastArgs:lB,broadcastTo:Kl,broadcast_util:rte,browser:woe,buffer:De,callbacks:Mde,cast:ae,ceil:LI,clipByValue:bs,clone:Ei,complex:Io,concat:Vt,concat1d:zI,concat2d:BI,concat3d:VI,concat4d:WI,constraints:Sce,conv1d:$w,conv2d:No,conv2dTranspose:Ew,conv3d:jI,conv3dTranspose:HI,copyRegisteredKernels:DZ,cos:_g,cosh:Dw,cosineWindow:ev,cumprod:Gp,cumsum:Aw,customGrad:Li,data:Ype,denseBincount:Jy,deprecationWarn:lJ,depthToSpace:GI,depthwiseConv2d:Cd,deregisterOp:Bde,device_util:nJ,diag:uB,dilation2d:qI,disableDeprecationWarnings:aJ,dispose:Ce,disposeVariables:cJ,div:ge,divNoNan:KI,dot:XI,dropout:$N,einsum:$l,elu:Td,enableDebugMode:oJ,enableProdMode:iJ,enclosingPowerOfTwo:EN,engine:jr,ensureShape:hB,env:K,equal:Vs,erf:Rw,euclideanNorm:QI,exp:ws,expandDims:$n,expm1:ZI,eye:Ow,fft:Vg,fill:jc,findBackend:mJ,findBackendFactory:gJ,floor:Nd,floorDiv:Nw,forceHalfFloat:qU,fused:tV,gather:_d,gatherND:YB,gather_util:voe,getBackend:Hz,getGradient:Tk,getKernel:Bp,getKernelsForBackend:Yy,gpgpu_util:Rwe,grad:Vte,grads:Wte,greater:cs,greaterEqual:Po,ifft:hh,imag:$g,image:Er,inTopKAsync:QB,initializers:Lce,input:O5,io:WN,irfft:Kw,isFinite:JI,isInf:eN,isNaN:tN,keep:ln,kernel_impls:Eoe,layers:fde,leakyRelu:Eg,less:ah,lessEqual:sl,linalg:RN,linspace:pB,loadGraphModel:hpe,loadGraphModelSync:dpe,loadLayersModel:_ue,localResponseNormalization:nN,log:Ws,log1p:Dg,logSigmoid:sN,logSoftmax:Fw,logSumExp:Ag,logicalAnd:Pr,logicalNot:Rg,logicalOr:Mw,logicalXor:rN,losses:lV,lowerBound:gB,matMul:Re,math:hoe,max:lr,maxPool:Og,maxPool3d:iN,maxPoolWithArgmax:xB,maximum:Vi,mean:It,memory:Ok,meshgrid:yB,metrics:Ede,min:oh,minimum:La,mirrorPad:oN,mod:aN,model:Due,models:Dde,moments:Pg,movingAverage:qB,mul:W,multiRNNCell:bB,multinomial:wB,neg:ct,nextFrame:KN,norm:Id,notEqual:yc,oneHot:lh,ones:ps,onesLike:Us,op:M,outerProduct:vB,pad:Fo,pad1d:SB,pad2d:kB,pad3d:CB,pad4d:TB,pool:lN,pow:Mi,prelu:Mg,print:kI,prod:cN,profile:uJ,raggedGather:IB,raggedRange:NB,raggedTensorToTensor:_B,rand:$B,randomGamma:RB,randomNormal:zw,randomStandardNormal:OB,randomUniform:rl,randomUniformInt:PB,range:bc,ready:fJ,real:ch,reciprocal:bN,registerBackend:xI,registerCallbackConstructor:Rue,registerGradient:Iz,registerKernel:Cw,registerOp:zde,regularizers:Pde,relu:hi,relu6:Bw,removeBackend:pJ,reshape:U,reverse:hr,reverse1d:FB,reverse2d:MB,reverse3d:LB,reverse4d:zB,rfft:Wg,round:Vw,rsqrt:Ww,scalar:be,scatterND:KB,scatter_util:jse,searchSorted:Lw,selu:Uw,separableConv2d:jw,sequential:Aue,serialization:Hie,setBackend:dJ,setPlatform:xJ,setWebGLContext:X6,setdiff1dAsync:BB,shared:D6,sigmoid:Jr,sign:wN,signal:aV,sin:Hw,sinh:Gw,slice:Be,slice1d:Lg,slice2d:qw,slice3d:zg,slice4d:uh,slice_util:_V,softmax:Bg,softplus:Hc,spaceToBatchND:Fg,sparse:cV,sparseToDense:XB,spectral:oV,split:gs,sqrt:Sn,square:rt,squaredDifference:Xw,squeeze:il,stack:is,step:qc,stridedSlice:vN,string:uV,sub:de,sum:fe,sumOutType:Tw,tan:SN,tanh:Ma,tensor:Bs,tensor1d:xn,tensor2d:ka,tensor3d:kN,tensor4d:VB,tensor5d:WB,tensor6d:UB,tensorScatterUpdate:jB,tensor_util:QZ,test_util:sse,tidy:q,tile:sr,time:hJ,topk:TN,train:Cl,transpose:Me,truncatedNormal:Qw,unique:IN,unregisterGradient:EZ,unregisterKernel:$Z,unsortedSegmentSum:Zw,unstack:dr,upcastType:xs,upperBound:HB,util:zZ,valueAndGrad:Ute,valueAndGrads:jte,variable:NN,variableGrads:mB,version:F$e,version_converter:wW,version_core:$V,version_cpu:A6,version_layers:Iv,version_webgl:GU,webgl:Zve,webgl_util:zbe,where:wn,whereAsync:_N,zeros:Qt,zerosLike:Ve},Symbol.toStringTag,{value:"Module"}));(function(t,e){for(var n=$c,s=t();;)try{var r=-parseInt(n(454))/1*(parseInt(n(430))/2)+parseInt(n(456))/3*(-parseInt(n(441))/4)+-parseInt(n(437))/5*(parseInt(n(445))/6)+-parseInt(n(446))/7*(-parseInt(n(448))/8)+-parseInt(n(434))/9*(-parseInt(n(451))/10)+parseInt(n(431))/11+parseInt(n(450))/12;if(r===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(v1,348921);function $c(t,e){var n=v1();return $c=function(s,r){s=s-430;var i=n[s];return i},$c(t,e)}var M$e=function(){var t=!0;return function(e,n){var s=t?function(){var r=$c;if(n){var i=n[r(439)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){M$e(this,function(){var t=$c,e=new RegExp(t(438)),n=new RegExp(t(432),"i"),s=SP(t(453));!e[t(440)](s+t(452))||!n[t(440)](s+"input")?s("0"):SP()})()})();function L$e(t){var e=$c;return t[e(458)]()[e(455)](/[^a-z0-9\s]/g,"")[e(449)](/\s+/)[e(447)](Boolean)}function v1(){var t=["\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor","126BLeykH","string","length","4975RnUSmB","function *\\( *\\)","apply","test","380ftsCIT","gger","call","debu","3018OxKakq","149324zqzesS","filter","80mHGUTG","split","10750848bFGpoA","206780oNAcCX","chain","init","355IAsAtR","replace","5679dCEjIT","counter","toLowerCase","while (true) {}","3244PTQLrt","2269685bOYzBH"];return v1=function(){return t},v1()}function SP(t){function e(n){var s=$c;if(typeof n===s(435))return(function(r){}).constructor(s(459))[s(439)](s(457));(""+n/n)[s(436)]!==1||n%20===0?(function(){return!0}).constructor("debu"+s(442))[s(443)]("action"):(function(){return!1})[s(433)](s(444)+"gger").apply("stateObject"),e(++n)}try{if(t)return e;e(0)}catch{}}(function(t,e){const n=Ec,s=t();for(;;)try{if(parseInt(n(481))/1*(-parseInt(n(495))/2)+parseInt(n(478))/3+parseInt(n(477))/4*(parseInt(n(473))/5)+parseInt(n(496))/6*(-parseInt(n(487))/7)+parseInt(n(471))/8*(-parseInt(n(489))/9)+-parseInt(n(491))/10*(-parseInt(n(475))/11)+parseInt(n(470))/12===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(S1,588328);function Ec(t,e){const n=S1();return Ec=function(s,r){return s=s-468,n[s]},Ec(t,e)}const z$e=function(){let t=!0;return function(e,n){const s=t?function(){const r=Ec;if(n){const i=n[r(499)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){z$e(this,function(){const t=Ec,e=new RegExp(t(483)),n=new RegExp(t(469),"i"),s=kP("init");!e.test(s+t(468))||!n[t(472)](s+t(485))?s("0"):kP()})()})();function S1(){const t=["dot","indexOf","fill","6gJQaKF","4225818OozBpm","tensor2d","while (true) {}","apply","gger","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","27632028THdSUG","36816onLkcZ","test","1170760URndsU","constructor","34507rmslvW","forEach","4qRpFkN","750918MggMAu","every","action","258909frhQEr","transpose","function *\\( *\\)","debu","input","No matching terms in query.","7cSwbmZ","counter","1962bNbHoO","stateObject","910adOWIz"];return S1=function(){return t},S1()}function B$e(t,e,n){const s=Ec,r=L$e(t),i=new Array(e.length)[s(494)](0);if(r[s(476)](c=>{const u=s,h=e[u(493)](c);h!==-1&&(i[h]+=1)}),i[s(479)](c=>c===0))throw new Error(s(486));const o=xn(i),a=Rl[s(497)](n);return Rl[s(492)](o,a[s(482)]())}function kP(t){function e(n){const s=Ec;if(typeof n=="string")return(function(r){}).constructor(s(498))[s(499)](s(488));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(474)](s(484)+s(500)).call(s(480)):(function(){return!1})[s(474)]("debu"+s(500))[s(499)](s(490)),e(++n)}try{if(t)return e;e(0)}catch{}}/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function l0(t){return t+.5|0}const ca=(t,e,n)=>Math.max(Math.min(t,n),e);function Rf(t){return ca(l0(t*2.55),0,255)}function Ia(t){return ca(l0(t*255),0,255)}function Ji(t){return ca(l0(t/2.55)/100,0,1)}function CP(t){return ca(l0(t*100),0,100)}const br={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},vC=[..."0123456789ABCDEF"],V$e=t=>vC[t&15],W$e=t=>vC[(t&240)>>4]+vC[t&15],Z0=t=>(t&240)>>4===(t&15),U$e=t=>Z0(t.r)&&Z0(t.g)&&Z0(t.b)&&Z0(t.a);function j$e(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&br[t[1]]*17,g:255&br[t[2]]*17,b:255&br[t[3]]*17,a:e===5?br[t[4]]*17:255}:(e===7||e===9)&&(n={r:br[t[1]]<<4|br[t[2]],g:br[t[3]]<<4|br[t[4]],b:br[t[5]]<<4|br[t[6]],a:e===9?br[t[7]]<<4|br[t[8]]:255})),n}const H$e=(t,e)=>t<255?e(t):"";function G$e(t){var e=U$e(t)?V$e:W$e;return t?"#"+e(t.r)+e(t.g)+e(t.b)+H$e(t.a,e):void 0}const q$e=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function k8(t,e,n){const s=e*Math.min(n,1-n),r=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function K$e(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function X$e(t,e,n){const s=k8(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function Y$e(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function bE(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,c,u;return i!==o&&(u=i-o,c=a>.5?u/(2-i-o):u/(i+o),l=Y$e(n,s,r,u,i),l=l*60+.5),[l|0,c||0,a]}function wE(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(Ia)}function vE(t,e,n){return wE(k8,t,e,n)}function Q$e(t,e,n){return wE(X$e,t,e,n)}function Z$e(t,e,n){return wE(K$e,t,e,n)}function C8(t){return(t%360+360)%360}function J$e(t){const e=q$e.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Rf(+e[5]):Ia(+e[5]));const r=C8(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=Q$e(r,i,o):e[1]==="hsv"?s=Z$e(r,i,o):s=vE(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function eEe(t,e){var n=bE(t);n[0]=C8(n[0]+e),n=vE(n),t.r=n[0],t.g=n[1],t.b=n[2]}function tEe(t){if(!t)return;const e=bE(t),n=e[0],s=CP(e[1]),r=CP(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Ji(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const TP={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},IP={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function nEe(){const t={},e=Object.keys(IP),n=Object.keys(TP);let s,r,i,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,TP[i]);i=parseInt(IP[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let J0;function sEe(t){J0||(J0=nEe(),J0.transparent=[0,0,0,0]);const e=J0[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const rEe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function iEe(t){const e=rEe.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?Rf(o):ca(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?Rf(s):ca(s,0,255)),r=255&(e[4]?Rf(r):ca(r,0,255)),i=255&(e[6]?Rf(i):ca(i,0,255)),{r:s,g:r,b:i,a:n}}}function oEe(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ji(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Y2=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,lu=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function aEe(t,e,n){const s=lu(Ji(t.r)),r=lu(Ji(t.g)),i=lu(Ji(t.b));return{r:Ia(Y2(s+n*(lu(Ji(e.r))-s))),g:Ia(Y2(r+n*(lu(Ji(e.g))-r))),b:Ia(Y2(i+n*(lu(Ji(e.b))-i))),a:t.a+n*(e.a-t.a)}}function ex(t,e,n){if(t){let s=bE(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=vE(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function T8(t,e){return t&&Object.assign(e||{},t)}function NP(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Ia(t[3]))):(e=T8(t,{r:0,g:0,b:0,a:1}),e.a=Ia(e.a)),e}function lEe(t){return t.charAt(0)==="r"?iEe(t):J$e(t)}class tm{constructor(e){if(e instanceof tm)return e;const n=typeof e;let s;n==="object"?s=NP(e):n==="string"&&(s=j$e(e)||sEe(e)||lEe(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=T8(this._rgb);return e&&(e.a=Ji(e.a)),e}set rgb(e){this._rgb=NP(e)}rgbString(){return this._valid?oEe(this._rgb):void 0}hexString(){return this._valid?G$e(this._rgb):void 0}hslString(){return this._valid?tEe(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-c,s.r=255&c*s.r+i*r.r+.5,s.g=255&c*s.g+i*r.g+.5,s.b=255&c*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=aEe(this._rgb,e._rgb,n)),this}clone(){return new tm(this.rgb)}alpha(e){return this._rgb.a=Ia(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=l0(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return ex(this._rgb,2,e),this}darken(e){return ex(this._rgb,2,-e),this}saturate(e){return ex(this._rgb,1,e),this}desaturate(e){return ex(this._rgb,1,-e),this}rotate(e){return eEe(this._rgb,e),this}}/*!
 * Chart.js v4.4.4
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function Hi(){}const cEe=(()=>{let t=0;return()=>t++})();function Ke(t){return t===null||typeof t>"u"}function Nt(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ue(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Lt(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Ks(t,e){return Lt(t)?t:e}function Ae(t,e){return typeof t>"u"?e:t}const uEe=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,I8=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function dt(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function nt(t,e,n,s){let r,i,o;if(Nt(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(Ue(t))for(o=Object.keys(t),i=o.length,r=0;r<i;r++)e.call(n,t[o[r]],o[r])}function k1(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function C1(t){if(Nt(t))return t.map(C1);if(Ue(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=C1(t[n[r]]);return e}return t}function N8(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function hEe(t,e,n,s){if(!N8(t))return;const r=e[t],i=n[t];Ue(r)&&Ue(i)?nm(r,i,s):e[t]=C1(i)}function nm(t,e,n){const s=Nt(e)?e:[e],r=s.length;if(!Ue(t))return t;n=n||{};const i=n.merger||hEe;let o;for(let a=0;a<r;++a){if(o=s[a],!Ue(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)i(l[c],t,o,n)}return t}function ep(t,e){return nm(t,e,{merger:dEe})}function dEe(t,e,n){if(!N8(t))return;const s=e[t],r=n[t];Ue(s)&&Ue(r)?ep(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=C1(r))}const _P={"":t=>t,x:t=>t.x,y:t=>t.y};function fEe(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function pEe(t){const e=fEe(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function ja(t,e){return(_P[e]||(_P[e]=pEe(e)))(t)}function SE(t){return t.charAt(0).toUpperCase()+t.slice(1)}const sm=t=>typeof t<"u",Ha=t=>typeof t=="function",$P=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function mEe(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const kt=Math.PI,vt=2*kt,gEe=vt+kt,T1=Number.POSITIVE_INFINITY,xEe=kt/180,Jt=kt/2,pl=kt/4,EP=kt*2/3,ua=Math.log10,Oi=Math.sign;function tp(t,e,n){return Math.abs(t-e)<n}function DP(t){const e=Math.round(t);t=tp(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(ua(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function yEe(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function yh(t){return!isNaN(parseFloat(t))&&isFinite(t)}function bEe(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function _8(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function Xr(t){return t*(kt/180)}function kE(t){return t*(180/kt)}function AP(t){if(!Lt(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function $8(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*kt&&(i+=vt),{angle:i,distance:r}}function SC(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function wEe(t,e){return(t-e+gEe)%vt-kt}function Qs(t){return(t%vt+vt)%vt}function rm(t,e,n,s){const r=Qs(t),i=Qs(e),o=Qs(n),a=Qs(i-r),l=Qs(o-r),c=Qs(r-i),u=Qs(r-o);return r===i||r===o||s&&i===o||a>l&&c<u}function An(t,e,n){return Math.max(e,Math.min(n,t))}function vEe(t){return An(t,-32768,32767)}function io(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function CE(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const oo=(t,e,n,s)=>CE(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),SEe=(t,e,n)=>CE(t,n,s=>t[s][e]>=n);function kEe(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const E8=["push","pop","shift","splice","unshift"];function CEe(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),E8.forEach(n=>{const s="_onData"+SE(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function RP(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(E8.forEach(i=>{delete t[i]}),delete t._chartjs)}function D8(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const A8=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function R8(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,A8.call(window,()=>{s=!1,t.apply(e,n)}))}}function TEe(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const TE=t=>t==="start"?"left":t==="end"?"right":"center",Kn=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,IEe=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e;function O8(t,e,n){const s=e.length;let r=0,i=s;if(t._sorted){const{iScale:o,_parsed:a}=t,l=o.axis,{min:c,max:u,minDefined:h,maxDefined:d}=o.getUserBounds();h&&(r=An(Math.min(oo(a,l,c).lo,n?s:oo(e,l,o.getPixelForValue(c)).lo),0,s-1)),d?i=An(Math.max(oo(a,o.axis,u,!0).hi+1,n?0:oo(e,l,o.getPixelForValue(u),!0).hi+1),r,s)-r:i=s-r}return{start:r,count:i}}function P8(t){const{xScale:e,yScale:n,_scaleRanges:s}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=r,!0;const i=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),i}const tx=t=>t===0||t===1,OP=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*vt/n)),PP=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*vt/n)+1,np={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Jt)+1,easeOutSine:t=>Math.sin(t*Jt),easeInOutSine:t=>-.5*(Math.cos(kt*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>tx(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>tx(t)?t:OP(t,.075,.3),easeOutElastic:t=>tx(t)?t:PP(t,.075,.3),easeInOutElastic(t){return tx(t)?t:t<.5?.5*OP(t*2,.1125,.45):.5+.5*PP(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-np.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?np.easeInBounce(t*2)*.5:np.easeOutBounce(t*2-1)*.5+.5};function IE(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function FP(t){return IE(t)?t:new tm(t)}function Q2(t){return IE(t)?t:new tm(t).saturate(.5).darken(.1).hexString()}const NEe=["x","y","borderWidth","radius","tension"],_Ee=["color","borderColor","backgroundColor"];function $Ee(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:_Ee},numbers:{type:"number",properties:NEe}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function EEe(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const MP=new Map;function DEe(t,e){e=e||{};const n=t+JSON.stringify(e);let s=MP.get(n);return s||(s=new Intl.NumberFormat(t,e),MP.set(n,s)),s}function c0(t,e,n){return DEe(e,n).format(t)}const F8={values(t){return Nt(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),i=AEe(t,n)}const o=ua(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),c0(t,s,l)},logarithmic(t,e,n){if(t===0)return"0";const s=n[e].significand||t/Math.pow(10,Math.floor(ua(t)));return[1,2,3,5,10,15].includes(s)||e>.8*n.length?F8.numeric.call(this,t,e,n):""}};function AEe(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Bv={formatters:F8};function REe(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Bv.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Dc=Object.create(null),kC=Object.create(null);function sp(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function Z2(t,e,n){return typeof e=="string"?nm(sp(t,e),n):nm(sp(t,""),e)}class OEe{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Q2(r.backgroundColor),this.hoverBorderColor=(s,r)=>Q2(r.borderColor),this.hoverColor=(s,r)=>Q2(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Z2(this,e,n)}get(e){return sp(this,e)}describe(e,n){return Z2(kC,e,n)}override(e,n){return Z2(Dc,e,n)}route(e,n,s,r){const i=sp(this,e),o=sp(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[r];return Ue(l)?Object.assign({},c,l):Ae(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var zt=new OEe({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[$Ee,EEe,REe]);function PEe(t){return!t||Ke(t.size)||Ke(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function I1(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function FEe(t,e,n,s){s=s||{};let r=s.data=s.data||{},i=s.garbageCollect=s.garbageCollect||[];s.font!==e&&(r=s.data={},i=s.garbageCollect=[],s.font=e),t.save(),t.font=e;let o=0;const a=n.length;let l,c,u,h,d;for(l=0;l<a;l++)if(h=n[l],h!=null&&!Nt(h))o=I1(t,r,i,o,h);else if(Nt(h))for(c=0,u=h.length;c<u;c++)d=h[c],d!=null&&!Nt(d)&&(o=I1(t,r,i,o,d));t.restore();const f=i.length/2;if(f>n.length){for(l=0;l<f;l++)delete r[i[l]];i.splice(0,f)}return o}function ml(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function LP(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function CC(t,e,n,s){M8(t,e,n,s,null)}function M8(t,e,n,s,r){let i,o,a,l,c,u,h,d;const f=e.pointStyle,p=e.rotation,g=e.radius;let m=(p||0)*xEe;if(f&&typeof f=="object"&&(i=f.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(m),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!(isNaN(g)||g<=0)){switch(t.beginPath(),f){default:r?t.ellipse(n,s,r/2,g,0,0,vt):t.arc(n,s,g,0,vt),t.closePath();break;case"triangle":u=r?r/2:g,t.moveTo(n+Math.sin(m)*u,s-Math.cos(m)*g),m+=EP,t.lineTo(n+Math.sin(m)*u,s-Math.cos(m)*g),m+=EP,t.lineTo(n+Math.sin(m)*u,s-Math.cos(m)*g),t.closePath();break;case"rectRounded":c=g*.516,l=g-c,o=Math.cos(m+pl)*l,h=Math.cos(m+pl)*(r?r/2-c:l),a=Math.sin(m+pl)*l,d=Math.sin(m+pl)*(r?r/2-c:l),t.arc(n-h,s-a,c,m-kt,m-Jt),t.arc(n+d,s-o,c,m-Jt,m),t.arc(n+h,s+a,c,m,m+Jt),t.arc(n-d,s+o,c,m+Jt,m+kt),t.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*g,u=r?r/2:l,t.rect(n-u,s-l,2*u,2*l);break}m+=pl;case"rectRot":h=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),t.moveTo(n-h,s-a),t.lineTo(n+d,s-o),t.lineTo(n+h,s+a),t.lineTo(n-d,s+o),t.closePath();break;case"crossRot":m+=pl;case"cross":h=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+d,s-o),t.lineTo(n-d,s+o);break;case"star":h=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+d,s-o),t.lineTo(n-d,s+o),m+=pl,h=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+d,s-o),t.lineTo(n-d,s+o);break;case"line":o=r?r/2:Math.cos(m)*g,a=Math.sin(m)*g,t.moveTo(n-o,s-a),t.lineTo(n+o,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(m)*(r?r/2:g),s+Math.sin(m)*g);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function ao(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Vv(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Wv(t){t.restore()}function MEe(t,e,n,s,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else r==="after"!=!!s?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function LEe(t,e,n,s){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function zEe(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Ke(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function BEe(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,u),t.lineTo(a,u),t.stroke()}}function VEe(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Ac(t,e,n,s,r,i={}){const o=Nt(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(t.save(),t.font=r.string,zEe(t,i),l=0;l<o.length;++l)c=o[l],i.backdrop&&VEe(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),Ke(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(c,n,s,i.maxWidth)),t.fillText(c,n,s,i.maxWidth),BEe(t,n,s,c,i),s+=Number(r.lineHeight);t.restore()}function im(t,e){const{x:n,y:s,w:r,h:i,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*kt,kt,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,kt,Jt,!0),t.lineTo(n+r-o.bottomRight,s+i),t.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,Jt,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-Jt,!0),t.lineTo(n+o.topLeft,s)}const WEe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,UEe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function jEe(t,e){const n=(""+t).match(WEe);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const HEe=t=>+t||0;function NE(t,e){const n={},s=Ue(e),r=s?Object.keys(e):e,i=Ue(t)?s?o=>Ae(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=HEe(i(o));return n}function L8(t){return NE(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Ql(t){return NE(t,["topLeft","topRight","bottomLeft","bottomRight"])}function as(t){const e=L8(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function bn(t,e){t=t||{},e=e||zt.font;let n=Ae(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=Ae(t.style,e.style);s&&!(""+s).match(UEe)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:Ae(t.family,e.family),lineHeight:jEe(Ae(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:Ae(t.weight,e.weight),string:""};return r.string=PEe(r),r}function Of(t,e,n,s){let r,i,o;for(r=0,i=t.length;r<i;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function GEe(t,e,n){const{min:s,max:r}=t,i=I8(e,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function cl(t,e){return Object.assign(Object.create(t),e)}function _E(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=W8("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>_E([a,...t],e,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return B8(a,l,()=>eDe(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return BP(a).includes(l)},ownKeys(a){return BP(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function bh(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:z8(t,s),setContext:i=>bh(t,i,n,s),override:i=>bh(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return B8(i,o,()=>KEe(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function z8(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Ha(n)?n:()=>n,isIndexable:Ha(s)?s:()=>s}}const qEe=(t,e)=>t?t+SE(e):e,$E=(t,e)=>Ue(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function B8(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function KEe(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=t;let a=s[e];return Ha(a)&&o.isScriptable(e)&&(a=XEe(e,a,t,n)),Nt(a)&&a.length&&(a=YEe(e,a,t,o.isIndexable)),$E(e,a)&&(a=bh(a,r,i&&i[e],o)),a}function XEe(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||s);return a.delete(t),$E(t,l)&&(l=EE(r._scopes,r,t,l)),l}function YEe(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(Ue(e[0])){const l=e,c=r._scopes.filter(u=>u!==l);e=[];for(const u of l){const h=EE(c,r,t,u);e.push(bh(h,i,o&&o[t],a))}}return e}function V8(t,e,n){return Ha(t)?t(e,n):t}const QEe=(t,e)=>t===!0?e:typeof t=="string"?ja(e,t):void 0;function ZEe(t,e,n,s,r){for(const i of e){const o=QEe(n,i);if(o){t.add(o);const a=V8(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function EE(t,e,n,s){const r=e._rootScopes,i=V8(e._fallback,n,s),o=[...t,...r],a=new Set;a.add(s);let l=zP(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=zP(a,o,i,l,s),l===null)?!1:_E(Array.from(a),[""],r,i,()=>JEe(e,n,s))}function zP(t,e,n,s,r){for(;n;)n=ZEe(t,e,n,s,r);return n}function JEe(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return Nt(r)&&Ue(n)?n:r||{}}function eDe(t,e,n,s){let r;for(const i of e)if(r=W8(qEe(i,t),n),typeof r<"u")return $E(t,r)?EE(n,s,t,r):r}function W8(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function BP(t){let e=t._keys;return e||(e=t._keys=tDe(t._scopes)),e}function tDe(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function U8(t,e,n,s){const{iScale:r}=t,{key:i="r"}=this._parsing,o=new Array(s);let a,l,c,u;for(a=0,l=s;a<l;++a)c=a+n,u=e[c],o[a]={r:r.parse(ja(u,i),c)};return o}const nDe=Number.EPSILON||1e-14,wh=(t,e)=>e<t.length&&!t[e].skip&&t[e],j8=t=>t==="x"?"y":"x";function sDe(t,e,n,s){const r=t.skip?e:t,i=e,o=n.skip?e:n,a=SC(i,r),l=SC(o,i);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=s*c,d=s*u;return{previous:{x:i.x-h*(o.x-r.x),y:i.y-h*(o.y-r.y)},next:{x:i.x+d*(o.x-r.x),y:i.y+d*(o.y-r.y)}}}function rDe(t,e,n){const s=t.length;let r,i,o,a,l,c=wh(t,0);for(let u=0;u<s-1;++u)if(l=c,c=wh(t,u+1),!(!l||!c)){if(tp(e[u],0,nDe)){n[u]=n[u+1]=0;continue}r=n[u]/e[u],i=n[u+1]/e[u],a=Math.pow(r,2)+Math.pow(i,2),!(a<=9)&&(o=3/Math.sqrt(a),n[u]=r*o*e[u],n[u+1]=i*o*e[u])}}function iDe(t,e,n="x"){const s=j8(n),r=t.length;let i,o,a,l=wh(t,0);for(let c=0;c<r;++c){if(o=a,a=l,l=wh(t,c+1),!a)continue;const u=a[n],h=a[s];o&&(i=(u-o[n])/3,a[`cp1${n}`]=u-i,a[`cp1${s}`]=h-i*e[c]),l&&(i=(l[n]-u)/3,a[`cp2${n}`]=u+i,a[`cp2${s}`]=h+i*e[c])}}function oDe(t,e="x"){const n=j8(e),s=t.length,r=Array(s).fill(0),i=Array(s);let o,a,l,c=wh(t,0);for(o=0;o<s;++o)if(a=l,l=c,c=wh(t,o+1),!!l){if(c){const u=c[e]-l[e];r[o]=u!==0?(c[n]-l[n])/u:0}i[o]=a?c?Oi(r[o-1])!==Oi(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}rDe(t,r,i),iDe(t,i,e)}function nx(t,e,n){return Math.max(Math.min(t,n),e)}function aDe(t,e){let n,s,r,i,o,a=ao(t[0],e);for(n=0,s=t.length;n<s;++n)o=i,i=a,a=n<s-1&&ao(t[n+1],e),i&&(r=t[n],o&&(r.cp1x=nx(r.cp1x,e.left,e.right),r.cp1y=nx(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=nx(r.cp2x,e.left,e.right),r.cp2y=nx(r.cp2y,e.top,e.bottom)))}function lDe(t,e,n,s,r){let i,o,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")oDe(t,r);else{let c=s?t[t.length-1]:t[0];for(i=0,o=t.length;i<o;++i)a=t[i],l=sDe(c,a,t[Math.min(i+1,o-(s?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&aDe(t,n)}function DE(){return typeof window<"u"&&typeof document<"u"}function AE(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function N1(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const Uv=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function cDe(t,e){return Uv(t).getPropertyValue(e)}const uDe=["top","right","bottom","left"];function Zl(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=uDe[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const hDe=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function dDe(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(hDe(r,i,t.target))a=r,l=i;else{const c=e.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Tl(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=Uv(n),i=r.boxSizing==="border-box",o=Zl(r,"padding"),a=Zl(r,"border","width"),{x:l,y:c,box:u}=dDe(t,n),h=o.left+(u&&a.left),d=o.top+(u&&a.top);let{width:f,height:p}=e;return i&&(f-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-h)/f*n.width/s),y:Math.round((c-d)/p*n.height/s)}}function fDe(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&AE(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=Uv(i),l=Zl(a,"border","width"),c=Zl(a,"padding");e=o.width-c.width-l.width,n=o.height-c.height-l.height,s=N1(a.maxWidth,i,"clientWidth"),r=N1(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||T1,maxHeight:r||T1}}const sx=t=>Math.round(t*10)/10;function pDe(t,e,n,s){const r=Uv(t),i=Zl(r,"margin"),o=N1(r.maxWidth,t,"clientWidth")||T1,a=N1(r.maxHeight,t,"clientHeight")||T1,l=fDe(t,e,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const d=Zl(r,"border","width"),f=Zl(r,"padding");c-=f.width+d.width,u-=f.height+d.height}return c=Math.max(0,c-i.width),u=Math.max(0,s?c/s:u-i.height),c=sx(Math.min(c,o,l.maxWidth)),u=sx(Math.min(u,a,l.maxHeight)),c&&!u&&(u=sx(c/2)),(e!==void 0||n!==void 0)&&s&&l.height&&u>l.height&&(u=l.height,c=sx(Math.floor(u*s))),{width:c,height:u}}function VP(t,e,n){const s=e||1,r=Math.floor(t.height*s),i=Math.floor(t.width*s);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(t.currentDevicePixelRatio=s,o.height=r,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const mDe=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};DE()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function WP(t,e){const n=cDe(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Il(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function gDe(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:s==="middle"?n<.5?t.y:e.y:s==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function xDe(t,e,n,s){const r={x:t.cp2x,y:t.cp2y},i={x:e.cp1x,y:e.cp1y},o=Il(t,r,n),a=Il(r,i,n),l=Il(i,e,n),c=Il(o,a,n),u=Il(a,l,n);return Il(c,u,n)}const yDe=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},bDe=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Uu(t,e,n){return t?yDe(e,n):bDe()}function H8(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function G8(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function q8(t){return t==="angle"?{between:rm,compare:wEe,normalize:Qs}:{between:io,compare:(e,n)=>e-n,normalize:e=>e}}function UP({start:t,end:e,count:n,loop:s,style:r}){return{start:t%n,end:e%n,loop:s&&(e-t+1)%n===0,style:r}}function wDe(t,e,n){const{property:s,start:r,end:i}=n,{between:o,normalize:a}=q8(s),l=e.length;let{start:c,end:u,loop:h}=t,d,f;if(h){for(c+=l,u+=l,d=0,f=l;d<f&&o(a(e[c%l][s]),r,i);++d)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:t.style}}function K8(t,e,n){if(!n)return[t];const{property:s,start:r,end:i}=n,o=e.length,{compare:a,between:l,normalize:c}=q8(s),{start:u,end:h,loop:d,style:f}=wDe(t,e,n),p=[];let g=!1,m=null,x,y,b;const w=()=>l(r,b,x)&&a(r,b)!==0,v=()=>a(i,x)===0||l(i,b,x),S=()=>g||w(),T=()=>!g||v();for(let k=u,I=u;k<=h;++k)y=e[k%o],!y.skip&&(x=c(y[s]),x!==b&&(g=l(x,r,i),m===null&&S()&&(m=a(x,r)===0?k:I),m!==null&&T()&&(p.push(UP({start:m,end:k,loop:d,count:o,style:f})),m=null),I=k,b=x));return m!==null&&p.push(UP({start:m,end:h,loop:d,count:o,style:f})),p}function X8(t,e){const n=[],s=t.segments;for(let r=0;r<s.length;r++){const i=K8(s[r],t.points,e);i.length&&n.push(...i)}return n}function vDe(t,e,n,s){let r=0,i=e-1;if(n&&!s)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(i+=r);i>r&&t[i%e].skip;)i--;return i%=e,{start:r,end:i}}function SDe(t,e,n,s){const r=t.length,i=[];let o=e,a=t[e],l;for(l=e+1;l<=n;++l){const c=t[l%r];c.skip||c.stop?a.skip||(s=!1,i.push({start:e%r,end:(l-1)%r,loop:s}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&i.push({start:e%r,end:o%r,loop:s}),i}function kDe(t,e){const n=t.points,s=t.options.spanGaps,r=n.length;if(!r)return[];const i=!!t._loop,{start:o,end:a}=vDe(n,r,i,s);if(s===!0)return jP(t,[{start:o,end:a,loop:i}],n,e);const l=a<o?a+r:a,c=!!t._fullLoop&&o===0&&a===r-1;return jP(t,SDe(n,o,l,c),n,e)}function jP(t,e,n,s){return!s||!s.setContext||!n?e:CDe(t,e,n,s)}function CDe(t,e,n,s){const r=t._chart.getContext(),i=HP(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,c=[];let u=i,h=e[0].start,d=h;function f(p,g,m,x){const y=a?-1:1;if(p!==g){for(p+=l;n[p%l].skip;)p-=y;for(;n[g%l].skip;)g+=y;p%l!==g%l&&(c.push({start:p%l,end:g%l,loop:m,style:x}),u=x,h=g%l)}}for(const p of e){h=a?h:p.start;let g=n[h%l],m;for(d=h+1;d<=p.end;d++){const x=n[d%l];m=HP(s.setContext(cl(r,{type:"segment",p0:g,p1:x,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),TDe(m,u)&&f(h,d-1,p.loop,u),g=x,u=m}h<d-1&&f(h,d-1,p.loop,u)}return c}function HP(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function TDe(t,e){if(!e)return!1;const n=[],s=function(r,i){return IE(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(t,s)!==JSON.stringify(e,s)}/*!
 * Chart.js v4.4.4
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class IDe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=A8.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Gi=new IDe;const GP="transparent",NDe={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=FP(t||GP),r=s.valid&&FP(e||GP);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class _De{constructor(e,n,s,r){const i=n[s];r=Of([e.to,r,i,e.from]);const o=Of([e.from,i,r]);this._active=!0,this._fn=e.fn||NDe[e.type||typeof o],this._easing=np[e.easing]||np.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Of([e.to,n,r,e.from]),this._from=Of([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class Y8{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Ue(e))return;const n=Object.keys(zt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!Ue(i))return;const o={};for(const a of n)o[a]=i[a];(Nt(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,n){const s=n.options,r=EDe(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&$De(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(e,n));continue}const u=n[c];let h=i[c];const d=s.get(c);if(h)if(d&&h.active()){h.update(d,u,a);continue}else h.cancel();if(!d||!d.duration){e[c]=u;continue}i[c]=h=new _De(d,e,c,u),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Gi.add(this._chart,s),!0}}function $De(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function EDe(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function qP(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function DDe(t,e,n){if(n===!1)return!1;const s=qP(t,n),r=qP(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function ADe(t){let e,n,s,r;return Ue(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function Q8(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function KP(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let o,a,l,c;if(e!==null){for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(s.all)continue;break}c=t.values[l],Lt(c)&&(i||e===0||Oi(e)===Oi(c))&&(e+=c)}return e}}function RDe(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[r]:u,[i]:t[u]};return a}function XP(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function ODe(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function PDe(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function FDe(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function YP(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function QP(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,c=o.axis,u=ODe(i,o,s),h=e.length;let d;for(let f=0;f<h;++f){const p=e[f],{[l]:g,[c]:m}=p,x=p._stacks||(p._stacks={});d=x[c]=FDe(r,u,g),d[a]=m,d._top=YP(d,o,!0,s.type),d._bottom=YP(d,o,!1,s.type);const y=d._visualValues||(d._visualValues={});y[a]=m}}function J2(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function MDe(t,e){return cl(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function LDe(t,e,n){return cl(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function uf(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const eS=t=>t==="reset"||t==="none",ZP=(t,e)=>e?t:Object.assign({},t),zDe=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Q8(n,!0),values:null};class ni{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=XP(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&uf(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,d,f,p)=>h==="x"?d:h==="r"?p:f,i=n.xAxisID=Ae(s.xAxisID,J2(e,"x")),o=n.yAxisID=Ae(s.yAxisID,J2(e,"y")),a=n.rAxisID=Ae(s.rAxisID,J2(e,"r")),l=n.indexAxis,c=n.iAxisID=r(l,i,o,a),u=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&RP(this._data,this),e._stacked&&uf(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(Ue(n)){const r=this._cachedMeta;this._data=RDe(n,r)}else if(s!==n){if(s){RP(s,this);const r=this._cachedMeta;uf(r),r._parsed=[]}n&&Object.isExtensible(n)&&CEe(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=XP(n.vScale,n),n.stack!==s.stack&&(r=!0,uf(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&QP(this,n._parsed)}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=e===0&&n===r.length?!0:s._sorted,c=e>0&&s._parsed[e-1],u,h,d;if(this._parsing===!1)s._parsed=r,s._sorted=!0,d=r;else{Nt(r[e])?d=this.parseArrayData(s,r,e,n):Ue(r[e])?d=this.parseObjectData(s,r,e,n):d=this.parsePrimitiveData(s,r,e,n);const f=()=>h[a]===null||c&&h[a]<c[a];for(u=0;u<n;++u)s._parsed[u+e]=h=d[u],l&&(f()&&(l=!1),c=h);s._sorted=l}o&&QP(this,d)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,c=i.getLabels(),u=i===o,h=new Array(r);let d,f,p;for(d=0,f=r;d<f;++d)p=d+s,h[d]={[a]:u||i.parse(c[p],p),[l]:o.parse(n[p],p)};return h}parseArrayData(e,n,s,r){const{xScale:i,yScale:o}=e,a=new Array(r);let l,c,u,h;for(l=0,c=r;l<c;++l)u=l+s,h=n[u],a[l]={x:i.parse(h[0],u),y:o.parse(h[1],u)};return a}parseObjectData(e,n,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,h,d,f;for(u=0,h=r;u<h;++u)d=u+s,f=n[d],c[u]={x:i.parse(ja(f,a),d),y:o.parse(ja(f,l),d)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:Q8(r,!0),values:n._stacks[e.axis]._visualValues};return KP(a,o,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=KP(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,a=this._getOtherScale(e),l=zDe(n,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=PDe(a);let d,f;function p(){f=r[d];const g=f[a.axis];return!Lt(f[e.axis])||u>g||h<g}for(d=0;d<o&&!(!p()&&(this.updateRangeFromParsed(c,e,f,l),i));++d);if(i){for(d=o-1;d>=0;--d)if(!p()){this.updateRangeFromParsed(c,e,f,l);break}}return c}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][e.axis],Lt(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=ADe(Ae(this.options.clip,DDe(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(e,i,a,l),u=a;u<a+l;++u){const h=r[u];h.hidden||(h.active&&c?o.push(h):h.draw(e,i))}for(u=0;u<o.length;++u)o[u].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=LDe(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=MDe(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&sm(s);if(a)return ZP(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],d=c.getOptionScopes(this.getDataset(),u),f=Object.keys(zt.elements[e]),p=()=>this.getContext(s,r,n),g=c.resolveNamedOptions(d,f,p,h);return g.$shared&&(g.$shared=l,i[o]=Object.freeze(ZP(g,l))),g}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,n),d=u.getOptionScopes(this.getDataset(),h);l=u.createResolver(d,this.getContext(e,s,n))}const c=new Y8(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||eS(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(e,n,s,r){eS(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!eS(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,o=e+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&uf(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}X(ni,"defaults",{}),X(ni,"datasetElementType",null),X(ni,"dataElementType",null);function BDe(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=D8(s.sort((r,i)=>r-i))}return t._cache.$bar}function VDe(t){const e=t.iScale,n=BDe(e,t.type);let s=e._length,r,i,o,a;const l=()=>{o===32767||o===-32768||(sm(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(r=0,i=n.length;r<i;++r)o=e.getPixelForValue(n[r]),l();for(a=void 0,r=0,i=e.ticks.length;r<i;++r)o=e.getPixelForTick(r),l();return s}function WDe(t,e,n,s){const r=n.barThickness;let i,o;return Ke(r)?(i=e.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:e.pixels[t]-i/2}}function UDe(t,e,n,s){const r=e.pixels,i=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;o===null&&(o=i-(a===null?e.end-e.start:a-i)),a===null&&(a=i+i-o);const c=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:n.barPercentage,start:c}}function jDe(t,e,n,s){const r=n.parse(t[0],s),i=n.parse(t[1],s),o=Math.min(r,i),a=Math.max(r,i);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:i,min:o,max:a}}function Z8(t,e,n,s){return Nt(t)?jDe(t,e,n,s):e[n.axis]=n.parse(t,s),e}function JP(t,e,n,s){const r=t.iScale,i=t.vScale,o=r.getLabels(),a=r===i,l=[];let c,u,h,d;for(c=n,u=n+s;c<u;++c)d=e[c],h={},h[r.axis]=a||r.parse(o[c],c),l.push(Z8(d,h,i,c));return l}function tS(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function HDe(t,e,n){return t!==0?Oi(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function GDe(t){let e,n,s,r,i;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:e,top:r,bottom:i}}function qDe(t,e,n,s){let r=e.borderSkipped;const i={};if(!r){t.borderSkipped=i;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=GDe(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=c:(n._bottom||0)===s?r=u:(i[eF(u,o,a,l)]=!0,r=c)),i[eF(r,o,a,l)]=!0,t.borderSkipped=i}function eF(t,e,n,s){return s?(t=KDe(t,e,n),t=tF(t,n,e)):t=tF(t,e,n),t}function KDe(t,e,n){return t===e?n:t===n?e:t}function tF(t,e,n){return t==="start"?e:t==="end"?n:t}function XDe(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class rp extends ni{parsePrimitiveData(e,n,s,r){return JP(e,n,s,r)}parseArrayData(e,n,s,r){return JP(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:i,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=i.axis==="x"?a:l,u=o.axis==="x"?a:l,h=[];let d,f,p,g;for(d=s,f=s+r;d<f;++d)g=n[d],p={},p[i.axis]=i.parse(ja(g,c),d),h.push(Z8(ja(g,u),p,o,d));return h}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(e),o=i._custom,a=tS(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:d}=this._getSharedOptions(n,r);for(let f=n;f<n+s;f++){const p=this.getParsed(f),g=i||Ke(p[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),m=this._calculateBarIndexPixels(f,u),x=(p._stacks||{})[a.axis],y={horizontal:c,base:g.base,enableBorderRadius:!x||tS(p._custom)||o===x._top||o===x._bottom,x:c?g.head:m.center,y:c?m.center:g.head,height:c?m.size:Math.abs(g.size),width:c?Math.abs(g.size):m.size};d&&(y.options=h||this.resolveDataElementOptions(f,e[f].active?"active":r));const b=y.options||e[f].options;qDe(y,b,x,o),XDe(y,b,u.ratio),this.updateElement(e[f],f,y,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),i=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[s.axis],c=u=>{const h=u._parsed.find(f=>f[s.axis]===l),d=h&&h[u.vScale.axis];if(Ke(d)||isNaN(d))return!0};for(const u of r)if(!(n!==void 0&&c(u))&&((i===!1||o.indexOf(u.stack)===-1||i===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,n,s){const r=this._getStacks(e,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const a=e.barThickness;return{min:a||VDe(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(e),c=l._custom,u=tS(c);let h=l[n.axis],d=0,f=s?this.applyStack(n,l,s):h,p,g;f!==h&&(d=f-h,f=h),u&&(h=c.barStart,f=c.barEnd-c.barStart,h!==0&&Oi(h)!==Oi(c.barEnd)&&(d=0),d+=h);const m=!Ke(i)&&!u?i:d;let x=n.getPixelForValue(m);if(this.chart.getDataVisibility(e)?p=n.getPixelForValue(d+f):p=x,g=p-x,Math.abs(g)<o){g=HDe(g,n,a)*o,h===a&&(x-=g/2);const y=n.getPixelForDecimal(0),b=n.getPixelForDecimal(1),w=Math.min(y,b),v=Math.max(y,b);x=Math.max(Math.min(x,v),w),p=x+g,s&&!u&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(p)-n.getValueForPixel(x))}if(x===n.getPixelForValue(a)){const y=Oi(g)*n.getLineWidthForValue(a)/2;x+=y,g-=y}return{size:g,base:x,head:p,center:p+g/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,i=r.skipNull,o=Ae(r.maxBarThickness,1/0);let a,l;if(n.grouped){const c=i?this._getStackCount(e):n.stackCount,u=r.barThickness==="flex"?UDe(e,n,r,c):WDe(e,n,r,c),h=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0);a=u.start+u.chunk*h+u.chunk/2,l=Math.min(o,u.chunk*u.ratio)}else a=s.getPixelForValue(this.getParsed(e)[s.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}X(rp,"id","bar"),X(rp,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),X(rp,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class zx extends ni{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,n,s,r){const i=super.parsePrimitiveData(e,n,s,r);for(let o=0;o<i.length;o++)i[o]._custom=this.resolveDataElementOptions(o+s).radius;return i}parseArrayData(e,n,s,r){const i=super.parseArrayData(e,n,s,r);for(let o=0;o<i.length;o++){const a=n[s+o];i[o]._custom=Ae(a[2],this.resolveDataElementOptions(o+s).radius)}return i}parseObjectData(e,n,s,r){const i=super.parseObjectData(e,n,s,r);for(let o=0;o<i.length;o++){const a=n[s+o];i[o]._custom=Ae(a&&a.r&&+a.r,this.resolveDataElementOptions(o+s).radius)}return i}getMaxOverflow(){const e=this._cachedMeta.data;let n=0;for(let s=e.length-1;s>=0;--s)n=Math.max(n,e[s].size(this.resolveDataElementOptions(s))/2);return n>0&&n}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:i}=n,o=this.getParsed(e),a=r.getLabelForValue(o.x),l=i.getLabelForValue(o.y),c=o._custom;return{label:s[e]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(e){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,e)}updateElements(e,n,s,r){const i=r==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(n,r),u=o.axis,h=a.axis;for(let d=n;d<n+s;d++){const f=e[d],p=!i&&this.getParsed(d),g={},m=g[u]=i?o.getPixelForDecimal(.5):o.getPixelForValue(p[u]),x=g[h]=i?a.getBasePixel():a.getPixelForValue(p[h]);g.skip=isNaN(m)||isNaN(x),c&&(g.options=l||this.resolveDataElementOptions(d,f.active?"active":r),i&&(g.options.radius=0)),this.updateElement(f,d,g,r)}}resolveDataElementOptions(e,n){const s=this.getParsed(e);let r=super.resolveDataElementOptions(e,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const i=r.radius;return n!=="active"&&(r.radius=0),r.radius+=Ae(s&&s._custom,i),r}}X(zx,"id","bubble"),X(zx,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),X(zx,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function YDe(t,e,n){let s=1,r=1,i=0,o=0;if(e<vt){const a=t,l=a+e,c=Math.cos(a),u=Math.sin(a),h=Math.cos(l),d=Math.sin(l),f=(b,w,v)=>rm(b,a,l,!0)?1:Math.max(w,w*n,v,v*n),p=(b,w,v)=>rm(b,a,l,!0)?-1:Math.min(w,w*n,v,v*n),g=f(0,c,h),m=f(Jt,u,d),x=p(kt,c,h),y=p(kt+Jt,u,d);s=(g-x)/2,r=(m-y)/2,i=-(g+x)/2,o=-(m+y)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class Vl extends ni{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(Ue(s[e])){const{key:l="value"}=this._parsing;i=c=>+ja(s[c],l)}let o,a;for(o=e,a=e+n;o<a;++o)r._parsed[o]=i(o)}}_getRotation(){return Xr(this.options.rotation-90)}_getCircumference(){return Xr(this.options.circumference)}_getRotationExtents(){let e=vt,n=-vt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),n=Math.max(n,i+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(uEe(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:d,ratioY:f,offsetX:p,offsetY:g}=YDe(h,u,l),m=(s.width-o)/d,x=(s.height-o)/f,y=Math.max(Math.min(m,x)/2,0),b=I8(this.options.radius,y),w=Math.max(b*l,0),v=(b-w)/this._getVisibleDatasetWeightTotal();this.offsetX=p*b,this.offsetY=g*b,r.total=this.calculateTotal(),this.outerRadius=b-v*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-v*c,0),this.updateElements(i,0,i.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/vt)}updateElements(e,n,s,r){const i=r==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,h=(a.top+a.bottom)/2,d=i&&c.animateScale,f=d?0:this.innerRadius,p=d?0:this.outerRadius,{sharedOptions:g,includeOptions:m}=this._getSharedOptions(n,r);let x=this._getRotation(),y;for(y=0;y<n;++y)x+=this._circumference(y,i);for(y=n;y<n+s;++y){const b=this._circumference(y,i),w=e[y],v={x:u+this.offsetX,y:h+this.offsetY,startAngle:x,endAngle:x+b,circumference:b,outerRadius:p,innerRadius:f};m&&(v.options=g||this.resolveDataElementOptions(y,w.active?"active":r)),x+=b,this.updateElement(w,y,v,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?vt*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=c0(n._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,i,o,a,l;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(Ae(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}X(Vl,"id","doughnut"),X(Vl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),X(Vl,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),X(Vl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=e.legend.options;return n.labels.map((i,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class Bx extends ni{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=O8(n,r,o);this._drawStart=a,this._drawCount=l,P8(n)&&(a=0,l=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=r;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:c},e),this.updateElements(r,a,l,e)}updateElements(e,n,s,r){const i=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(n,r),d=o.axis,f=a.axis,{spanGaps:p,segment:g}=this.options,m=yh(p)?p:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||i||r==="none",y=n+s,b=e.length;let w=n>0&&this.getParsed(n-1);for(let v=0;v<b;++v){const S=e[v],T=x?S:{};if(v<n||v>=y){T.skip=!0;continue}const k=this.getParsed(v),I=Ke(k[f]),_=T[d]=o.getPixelForValue(k[d],v),D=T[f]=i||I?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,k,l):k[f],v);T.skip=isNaN(_)||isNaN(D)||I,T.stop=v>0&&Math.abs(k[d]-w[d])>m,g&&(T.parsed=k,T.raw=c.data[v]),h&&(T.options=u||this.resolveDataElementOptions(v,S.active?"active":r)),x||this.updateElement(S,v,T,r),w=k}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,i,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}X(Bx,"id","line"),X(Bx,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),X(Bx,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class ip extends ni{constructor(e,n){super(e,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=c0(n._parsed[e].r,s.options.locale);return{label:r[e]||"",value:i}}parseObjectData(e,n,s,r){return U8.bind(this)(e,n,s,r)}update(e){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,e)}getMinMax(){const e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((s,r)=>{const i=this.getParsed(r).r;!isNaN(i)&&this.chart.getDataVisibility(r)&&(i<n.min&&(n.min=i),i>n.max&&(n.max=i))}),n}_updateRadius(){const e=this.chart,n=e.chartArea,s=e.options,r=Math.min(n.right-n.left,n.bottom-n.top),i=Math.max(r/2,0),o=Math.max(s.cutoutPercentage?i/100*s.cutoutPercentage:1,0),a=(i-o)/e.getVisibleDatasetCount();this.outerRadius=i-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,n,s,r){const i=r==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,h=c.yCenter,d=c.getIndexAngle(0)-.5*kt;let f=d,p;const g=360/this.countVisibleElements();for(p=0;p<n;++p)f+=this._computeAngle(p,r,g);for(p=n;p<n+s;p++){const m=e[p];let x=f,y=f+this._computeAngle(p,r,g),b=o.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;f=y,i&&(l.animateScale&&(b=0),l.animateRotate&&(x=y=d));const w={x:u,y:h,innerRadius:0,outerRadius:b,startAngle:x,endAngle:y,options:this.resolveDataElementOptions(p,m.active?"active":r)};this.updateElement(m,p,w,r)}}countVisibleElements(){const e=this._cachedMeta;let n=0;return e.data.forEach((s,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(e,n,s){return this.chart.getDataVisibility(e)?Xr(this.resolveDataElementOptions(e,n).angle||s):0}}X(ip,"id","polarArea"),X(ip,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),X(ip,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=e.legend.options;return n.labels.map((i,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class TC extends Vl{}X(TC,"id","pie"),X(TC,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Vx extends ni{getLabelAndValue(e){const n=this._cachedMeta.vScale,s=this.getParsed(e);return{label:n.getLabels()[e],value:""+n.getLabelForValue(s[n.axis])}}parseObjectData(e,n,s,r){return U8.bind(this)(e,n,s,r)}update(e){const n=this._cachedMeta,s=n.dataset,r=n.data||[],i=n.iScale.getLabels();if(s.points=r,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:i.length===r.length,options:o};this.updateElement(s,void 0,a,e)}this.updateElements(r,0,r.length,e)}updateElements(e,n,s,r){const i=this._cachedMeta.rScale,o=r==="reset";for(let a=n;a<n+s;a++){const l=e[a],c=this.resolveDataElementOptions(a,l.active?"active":r),u=i.getPointPositionForValue(a,this.getParsed(a).r),h=o?i.xCenter:u.x,d=o?i.yCenter:u.y,f={x:h,y:d,angle:u.angle,skip:isNaN(h)||isNaN(d),options:c};this.updateElement(l,a,f,r)}}}X(Vx,"id","radar"),X(Vx,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),X(Vx,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class op extends ni{getLabelAndValue(e){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:i}=n,o=this.getParsed(e),a=r.getLabelForValue(o.x),l=i.getLabelForValue(o.y);return{label:s[e]||"",value:"("+a+", "+l+")"}}update(e){const n=this._cachedMeta,{data:s=[]}=n,r=this.chart._animationsDisabled;let{start:i,count:o}=O8(n,s,r);if(this._drawStart=i,this._drawCount=o,P8(n)&&(i=0,o=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=n;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=s;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!r,options:c},e)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(s,i,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,n,s,r){const i=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(n,r),h=this.getSharedOptions(u),d=this.includeOptions(r,h),f=o.axis,p=a.axis,{spanGaps:g,segment:m}=this.options,x=yh(g)?g:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||i||r==="none";let b=n>0&&this.getParsed(n-1);for(let w=n;w<n+s;++w){const v=e[w],S=this.getParsed(w),T=y?v:{},k=Ke(S[p]),I=T[f]=o.getPixelForValue(S[f],w),_=T[p]=i||k?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,S,l):S[p],w);T.skip=isNaN(I)||isNaN(_)||k,T.stop=w>0&&Math.abs(S[f]-b[f])>x,m&&(T.parsed=S,T.raw=c.data[w]),d&&(T.options=h||this.resolveDataElementOptions(w,v.active?"active":r)),y||this.updateElement(v,w,T,r),b=S}this.updateSharedOptions(h,r,u)}getMaxOverflow(){const e=this._cachedMeta,n=e.data||[];if(!this.options.showLine){let a=0;for(let l=n.length-1;l>=0;--l)a=Math.max(a,n[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const s=e.dataset,r=s.options&&s.options.borderWidth||0;if(!n.length)return r;const i=n[0].size(this.resolveDataElementOptions(0)),o=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,i,o)/2}}X(op,"id","scatter"),X(op,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),X(op,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var QDe=Object.freeze({__proto__:null,BarController:rp,BubbleController:zx,DoughnutController:Vl,LineController:Bx,PieController:TC,PolarAreaController:ip,RadarController:Vx,ScatterController:op});function gl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class RE{constructor(e){X(this,"options");this.options=e||{}}static override(e){Object.assign(RE.prototype,e)}init(){}formats(){return gl()}parse(){return gl()}format(){return gl()}add(){return gl()}diff(){return gl()}startOf(){return gl()}endOf(){return gl()}}var J8={_date:RE};function ZDe(t,e,n,s){const{controller:r,data:i,_sorted:o}=t,a=r._cachedMeta.iScale;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const l=a._reversePixels?SEe:oo;if(s){if(r._sharedOptions){const c=i[0],u=typeof c.getRange=="function"&&c.getRange(e);if(u){const h=l(i,e,n-u),d=l(i,e,n+u);return{lo:h.lo,hi:d.hi}}}}else return l(i,e,n)}return{lo:0,hi:i.length-1}}function u0(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:c,data:u}=i[a],{lo:h,hi:d}=ZDe(i[a],e,o,r);for(let f=h;f<=d;++f){const p=u[f];p.skip||s(p,c,f)}}}function JDe(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function nS(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||u0(t,n,e,function(a,l,c){!r&&!ao(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&i.push({element:a,datasetIndex:l,index:c})},!0),i}function eAe(t,e,n,s){let r=[];function i(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],s),{angle:h}=$8(o,{x:e.x,y:e.y});rm(h,c,u)&&r.push({element:o,datasetIndex:a,index:l})}return u0(t,n,e,i),r}function tAe(t,e,n,s,r,i){let o=[];const a=JDe(n);let l=Number.POSITIVE_INFINITY;function c(u,h,d){const f=u.inRange(e.x,e.y,r);if(s&&!f)return;const p=u.getCenterPoint(r);if(!(!!i||t.isPointInArea(p))&&!f)return;const m=a(e,p);m<l?(o=[{element:u,datasetIndex:h,index:d}],l=m):m===l&&o.push({element:u,datasetIndex:h,index:d})}return u0(t,n,e,c),o}function sS(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?eAe(t,e,n,r):tAe(t,e,n,s,r,i)}function nF(t,e,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return u0(t,n,e,(l,c,u)=>{l[o]&&l[o](e[n],r)&&(i.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:i}var nAe={evaluateInteractionItems:u0,modes:{index(t,e,n,s){const r=Tl(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?nS(t,r,i,s,o):sS(t,r,i,!1,s,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(t,e,n,s){const r=Tl(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?nS(t,r,i,s,o):sS(t,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(t,e,n,s){const r=Tl(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return nS(t,r,i,s,o)},nearest(t,e,n,s){const r=Tl(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return sS(t,r,i,n.intersect,s,o)},x(t,e,n,s){const r=Tl(e,t);return nF(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Tl(e,t);return nF(t,r,"y",n.intersect,s)}}};const ej=["left","top","right","bottom"];function hf(t,e){return t.filter(n=>n.pos===e)}function sF(t,e){return t.filter(n=>ej.indexOf(n.pos)===-1&&n.box.axis===e)}function df(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function sAe(t){const e=[];let n,s,r,i,o,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return e}function rAe(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!ej.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function iAe(t,e){const n=rAe(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,c=n[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=u?u*r:l&&e.availableHeight)}return n}function oAe(t){const e=sAe(t),n=df(e.filter(c=>c.box.fullSize),!0),s=df(hf(e,"left"),!0),r=df(hf(e,"right")),i=df(hf(e,"top"),!0),o=df(hf(e,"bottom")),a=sF(e,"x"),l=sF(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:hf(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function rF(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function tj(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function aAe(t,e,n,s){const{pos:r,box:i}=n,o=t.maxPadding;if(!Ue(r)){n.size&&(t[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,t[r]+=n.size}i.getPadding&&tj(o,i.getPadding());const a=Math.max(0,e.outerWidth-rF(o,t,"left","right")),l=Math.max(0,e.outerHeight-rF(o,t,"top","bottom")),c=a!==t.w,u=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function lAe(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function cAe(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function Pf(t,e,n,s){const r=[];let i,o,a,l,c,u;for(i=0,o=t.length,c=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,cAe(a.horizontal,e));const{same:h,other:d}=aAe(e,n,a,s);c|=h&&r.length,u=u||d,l.fullSize||r.push(a)}return c&&Pf(r,e,n,s)||u}function rx(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function iF(t,e,n,s){const r=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,c=s[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const h=e.w*u,d=c.size||l.height;sm(c.start)&&(o=c.start),l.fullSize?rx(l,r.left,o,n.outerWidth-r.right-r.left,d):rx(l,e.left+c.placed,o,h,d),c.start=o,c.placed+=h,o=l.bottom}else{const h=e.h*u,d=c.size||l.width;sm(c.start)&&(i=c.start),l.fullSize?rx(l,i,r.top,d,n.outerHeight-r.bottom-r.top):rx(l,i,e.top+c.placed,d,h),c.start=i,c.placed+=h,i=l.right}}e.x=i,e.y=o}var ns={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=as(t.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=oAe(t.boxes),l=a.vertical,c=a.horizontal;nt(t.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const u=l.reduce((g,m)=>m.box.options&&m.box.options.display===!1?g:g+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/u,hBoxMaxHeight:o/2}),d=Object.assign({},r);tj(d,as(s));const f=Object.assign({maxPadding:d,w:i,h:o,x:r.left,y:r.top},r),p=iAe(l.concat(c),h);Pf(a.fullSize,f,h,p),Pf(l,f,h,p),Pf(c,f,h,p)&&Pf(l,f,h,p),lAe(f),iF(a.leftAndTop,f,h,p),f.x+=f.w,f.y+=f.h,iF(a.rightAndBottom,f,h,p),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},nt(a.chartArea,g=>{const m=g.box;Object.assign(m,t.chartArea),m.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class nj{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class uAe extends nj{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Wx="$chartjs",hAe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},oF=t=>t===null||t==="";function dAe(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Wx]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",oF(r)){const i=WP(t,"width");i!==void 0&&(t.width=i)}if(oF(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=WP(t,"height");i!==void 0&&(t.height=i)}return t}const sj=mDe?{passive:!0}:!1;function fAe(t,e,n){t&&t.addEventListener(e,n,sj)}function pAe(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,sj)}function mAe(t,e){const n=hAe[t.type]||t.type,{x:s,y:r}=Tl(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function _1(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function gAe(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||_1(a.addedNodes,s),o=o&&!_1(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function xAe(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||_1(a.removedNodes,s),o=o&&!_1(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const om=new Map;let aF=0;function rj(){const t=window.devicePixelRatio;t!==aF&&(aF=t,om.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function yAe(t,e){om.size||window.addEventListener("resize",rj),om.set(t,e)}function bAe(t){om.delete(t),om.size||window.removeEventListener("resize",rj)}function wAe(t,e,n){const s=t.canvas,r=s&&AE(s);if(!r)return;const i=R8((a,l)=>{const c=r.clientWidth;n(a,l),c<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||i(c,u)});return o.observe(r),yAe(t,i),o}function rS(t,e,n){n&&n.disconnect(),e==="resize"&&bAe(t)}function vAe(t,e,n){const s=t.canvas,r=R8(i=>{t.ctx!==null&&n(mAe(i,t))},t);return fAe(s,e,r),r}class SAe extends nj{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(dAe(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Wx])return!1;const s=n[Wx].initial;["height","width"].forEach(i=>{const o=s[i];Ke(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[Wx],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:gAe,detach:xAe,resize:wAe}[n]||vAe;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:rS,detach:rS,resize:rS}[n]||pAe)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return pDe(e,n,s,r)}isAttached(e){const n=e&&AE(e);return!!(n&&n.isConnected)}}function kAe(t){return!DE()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?uAe:SAe}var fx;let Bo=(fx=class{constructor(){X(this,"x");X(this,"y");X(this,"active",!1);X(this,"options");X(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return yh(this.x)&&yh(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},X(fx,"defaults",{}),X(fx,"defaultRoutes"),fx);function CAe(t,e){const n=t.options.ticks,s=TAe(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?NAe(e):[],o=i.length,a=i[0],l=i[o-1],c=[];if(o>r)return _Ae(e,c,i,o/r),c;const u=IAe(i,e,r);if(o>0){let h,d;const f=o>1?Math.round((l-a)/(o-1)):null;for(ix(e,c,u,Ke(f)?0:a-f,a),h=0,d=o-1;h<d;h++)ix(e,c,u,i[h],i[h+1]);return ix(e,c,u,l,Ke(f)?e.length:l+f),c}return ix(e,c,u),c}function TAe(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function IAe(t,e,n){const s=$Ae(t),r=e.length/n;if(!s)return Math.max(r,1);const i=yEe(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function NAe(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function _Ae(t,e,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(e.push(t[o]),r++,i=n[r*s])}function ix(t,e,n,s,r){const i=Ae(s,0),o=Math.min(Ae(r,t.length),t.length);let a=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),u=i;u<0;)a++,u=Math.round(i+a*n);for(c=Math.max(i,0);c<o;c++)c===u&&(e.push(t[c]),a++,u=Math.round(i+a*n))}function $Ae(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const EAe=t=>t==="left"?"right":t==="right"?"left":t,lF=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,cF=(t,e)=>Math.min(e||t,t);function uF(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function DAe(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),c;if(!(n&&(s===1?c=Math.max(l-i,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(r-1))/2,l+=r<e?c:-c,l<i-a||l>o+a)))return l}function AAe(t,e){nt(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function ff(t){return t.drawTicks?t.tickLength:0}function hF(t,e){if(!t.display)return 0;const n=bn(t.font,e),s=as(t.padding);return(Nt(t.text)?t.text.length:1)*n.lineHeight+s.height}function RAe(t,e){return cl(t,{scale:e,type:"scale"})}function OAe(t,e,n){return cl(t,{tick:n,index:e,type:"tick"})}function PAe(t,e,n){let s=TE(t);return(n&&e!=="right"||!n&&e==="right")&&(s=EAe(s)),s}function FAe(t,e,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:u}=l;let h=0,d,f,p;const g=o-r,m=a-i;if(t.isHorizontal()){if(f=Kn(s,i,a),Ue(n)){const x=Object.keys(n)[0],y=n[x];p=u[x].getPixelForValue(y)+g-e}else n==="center"?p=(c.bottom+c.top)/2+g-e:p=lF(t,n,e);d=a-i}else{if(Ue(n)){const x=Object.keys(n)[0],y=n[x];f=u[x].getPixelForValue(y)-m+e}else n==="center"?f=(c.left+c.right)/2-m+e:f=lF(t,n,e);p=Kn(s,o,r),h=n==="left"?-Jt:Jt}return{titleX:f,titleY:p,maxWidth:d,rotation:h}}class nu extends Bo{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=Ks(e,Number.POSITIVE_INFINITY),n=Ks(n,Number.NEGATIVE_INFINITY),s=Ks(s,Number.POSITIVE_INFINITY),r=Ks(r,Number.NEGATIVE_INFINITY),{min:Ks(e,s),max:Ks(n,r),minDefined:Lt(e),maxDefined:Lt(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:Ks(n,Ks(s,n)),max:Ks(s,Ks(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){dt(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=GEe(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?uF(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=CAe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){dt(this.options.afterUpdate,[this])}beforeSetDimensions(){dt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){dt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),dt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){dt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=dt(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){dt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){dt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=cF(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,c;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),h=u.widest.width,d=u.highest.height,f=An(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/s:f/(s-1),h+6>a&&(a=f/(s-(e.offset?.5:1)),l=this.maxHeight-ff(e.grid)-n.padding-hF(e.title,this.chart.options.font),c=Math.sqrt(h*h+d*d),o=kE(Math.min(Math.asin(An((u.highest.height+6)/a,-1,1)),Math.asin(An(l/c,-1,1))-Math.asin(An(d/c,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){dt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){dt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=hF(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=ff(i)+l):(e.height=this.maxHeight,e.width=ff(i)+l),s.display&&this.ticks.length){const{first:c,last:u,widest:h,highest:d}=this._getLabelSizes(),f=s.padding*2,p=Xr(this.labelRotation),g=Math.cos(p),m=Math.sin(p);if(a){const x=s.mirror?0:m*h.width+g*d.height;e.height=Math.min(this.maxHeight,e.height+x+f)}else{const x=s.mirror?0:g*h.width+m*d.height;e.width=Math.min(this.maxWidth,e.width+x+f)}this._calculatePadding(c,u,m,g)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,f=0;l?c?(d=r*e.width,f=s*n.height):(d=s*e.height,f=r*n.width):i==="start"?f=n.width:i==="end"?d=e.width:i!=="inner"&&(d=e.width/2,f=n.width/2),this.paddingLeft=Math.max((d-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-h+o)*this.width/(this.width-h),0)}else{let u=n.height/2,h=e.height/2;i==="start"?(u=0,h=e.height):i==="end"&&(u=n.height,h=0),this.paddingTop=u+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){dt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)Ke(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=uF(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/cF(n,s));let c=0,u=0,h,d,f,p,g,m,x,y,b,w,v;for(h=0;h<n;h+=l){if(p=e[h].label,g=this._resolveTickFontOptions(h),r.font=m=g.string,x=i[m]=i[m]||{data:{},gc:[]},y=g.lineHeight,b=w=0,!Ke(p)&&!Nt(p))b=I1(r,x.data,x.gc,b,p),w=y;else if(Nt(p))for(d=0,f=p.length;d<f;++d)v=p[d],!Ke(v)&&!Nt(v)&&(b=I1(r,x.data,x.gc,b,v),w+=y);o.push(b),a.push(w),c=Math.max(b,c),u=Math.max(w,u)}AAe(i,n);const S=o.indexOf(c),T=a.indexOf(u),k=I=>({width:o[I]||0,height:a[I]||0});return{first:k(0),last:k(n-1),widest:k(S),highest:k(T),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return vEe(this._alignToPixels?ml(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=OAe(this.getContext(),e,s))}return this.$context||(this.$context=RAe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Xr(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),d=ff(i),f=[],p=a.setContext(this.getContext()),g=p.display?p.width:0,m=g/2,x=function(R){return ml(s,R,g)};let y,b,w,v,S,T,k,I,_,D,A,L;if(o==="top")y=x(this.bottom),T=this.bottom-d,I=y-m,D=x(e.top)+m,L=e.bottom;else if(o==="bottom")y=x(this.top),D=e.top,L=x(e.bottom)-m,T=y+m,I=this.top+d;else if(o==="left")y=x(this.right),S=this.right-d,k=y-m,_=x(e.left)+m,A=e.right;else if(o==="right")y=x(this.left),_=e.left,A=x(e.right)-m,S=y+m,k=this.left+d;else if(n==="x"){if(o==="center")y=x((e.top+e.bottom)/2+.5);else if(Ue(o)){const R=Object.keys(o)[0],O=o[R];y=x(this.chart.scales[R].getPixelForValue(O))}D=e.top,L=e.bottom,T=y+m,I=T+d}else if(n==="y"){if(o==="center")y=x((e.left+e.right)/2);else if(Ue(o)){const R=Object.keys(o)[0],O=o[R];y=x(this.chart.scales[R].getPixelForValue(O))}S=y-m,k=S-d,_=e.left,A=e.right}const B=Ae(r.ticks.maxTicksLimit,h),F=Math.max(1,Math.ceil(h/B));for(b=0;b<h;b+=F){const R=this.getContext(b),O=i.setContext(R),E=a.setContext(R),V=O.lineWidth,G=O.color,Y=E.dash||[],Z=E.dashOffset,ee=O.tickWidth,te=O.tickColor,ne=O.tickBorderDash||[],ie=O.tickBorderDashOffset;w=DAe(this,b,l),w!==void 0&&(v=ml(s,w,V),c?S=k=_=A=v:T=I=D=L=v,f.push({tx1:S,ty1:T,tx2:k,ty2:I,x1:_,y1:D,x2:A,y2:L,width:V,color:G,borderDash:Y,borderDashOffset:Z,tickWidth:ee,tickColor:te,tickBorderDash:ne,tickBorderDashOffset:ie}))}return this._ticksLength=h,this._borderValue=y,f}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=i,d=ff(s.grid),f=d+u,p=h?-u:f,g=-Xr(this.labelRotation),m=[];let x,y,b,w,v,S,T,k,I,_,D,A,L="middle";if(r==="top")S=this.bottom-p,T=this._getXAxisLabelAlignment();else if(r==="bottom")S=this.top+p,T=this._getXAxisLabelAlignment();else if(r==="left"){const F=this._getYAxisLabelAlignment(d);T=F.textAlign,v=F.x}else if(r==="right"){const F=this._getYAxisLabelAlignment(d);T=F.textAlign,v=F.x}else if(n==="x"){if(r==="center")S=(e.top+e.bottom)/2+f;else if(Ue(r)){const F=Object.keys(r)[0],R=r[F];S=this.chart.scales[F].getPixelForValue(R)+f}T=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")v=(e.left+e.right)/2-f;else if(Ue(r)){const F=Object.keys(r)[0],R=r[F];v=this.chart.scales[F].getPixelForValue(R)}T=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(l==="start"?L="top":l==="end"&&(L="bottom"));const B=this._getLabelSizes();for(x=0,y=a.length;x<y;++x){b=a[x],w=b.label;const F=i.setContext(this.getContext(x));k=this.getPixelForTick(x)+i.labelOffset,I=this._resolveTickFontOptions(x),_=I.lineHeight,D=Nt(w)?w.length:1;const R=D/2,O=F.color,E=F.textStrokeColor,V=F.textStrokeWidth;let G=T;o?(v=k,T==="inner"&&(x===y-1?G=this.options.reverse?"left":"right":x===0?G=this.options.reverse?"right":"left":G="center"),r==="top"?c==="near"||g!==0?A=-D*_+_/2:c==="center"?A=-B.highest.height/2-R*_+_:A=-B.highest.height+_/2:c==="near"||g!==0?A=_/2:c==="center"?A=B.highest.height/2-R*_:A=B.highest.height-D*_,h&&(A*=-1),g!==0&&!F.showLabelBackdrop&&(v+=_/2*Math.sin(g))):(S=k,A=(1-D)*_/2);let Y;if(F.showLabelBackdrop){const Z=as(F.backdropPadding),ee=B.heights[x],te=B.widths[x];let ne=A-Z.top,ie=0-Z.left;switch(L){case"middle":ne-=ee/2;break;case"bottom":ne-=ee;break}switch(T){case"center":ie-=te/2;break;case"right":ie-=te;break;case"inner":x===y-1?ie-=te:x>0&&(ie-=te/2);break}Y={left:ie,top:ne,width:te+Z.width,height:ee+Z.height,color:F.backdropColor}}m.push({label:w,font:I,textOffset:A,options:{rotation:g,color:O,strokeColor:E,strokeWidth:V,textAlign:G,textBaseline:L,translation:[v,S],backdrop:Y}})}return m}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Xr(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let c,u;return n==="left"?r?(u=this.right+i,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+i,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,c,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,h,d;this.isHorizontal()?(c=ml(e,this.left,o)-o/2,u=ml(e,this.right,a)+a/2,h=d=l):(h=ml(e,this.top,o)-o/2,d=ml(e,this.bottom,a)+a/2,c=u=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(c,h),n.lineTo(u,d),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&Vv(s,r);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,c=o.label,u=o.textOffset;Ac(s,c,0,u,l,a)}r&&Wv(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=bn(s.font),o=as(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||Ue(n)?(l+=o.bottom,Nt(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:h,rotation:d}=FAe(this,l,n,a);Ac(e,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:d,textAlign:PAe(a,n,r),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=Ae(e.grid&&e.grid.z,-1),r=Ae(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==nu.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return bn(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class ox{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;zAe(n)&&(s=this.register(n));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,MAe(e,o,s),this.override&&zt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in zt[r]&&(delete zt[r][s],this.override&&delete Dc[s])}}function MAe(t,e,n){const s=nm(Object.create(null),[n?zt.get(n):{},zt.get(e),t.defaults]);zt.set(e,s),t.defaultRoutes&&LAe(e,t.defaultRoutes),t.descriptors&&zt.describe(e,t.descriptors)}function LAe(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");zt.route(i,r,l,a)})}function zAe(t){return"id"in t&&"defaults"in t}class BAe{constructor(){this.controllers=new ox(ni,"datasets",!0),this.elements=new ox(Bo,"elements"),this.plugins=new ox(Object,"plugins"),this.scales=new ox(nu,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):nt(r,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,s){const r=SE(e);dt(s["before"+r],[],s),n[e](s),dt(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var xi=new BAe;class VAe{constructor(){this._init=[]}notify(e,n,s,r){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,n,s,r){r=r||{};for(const i of e){const o=i.plugin,a=o[s],l=[n,r,i.options];if(dt(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){Ke(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=Ae(s.options&&s.options.plugins,{}),i=WAe(s);return r===!1&&!n?[]:jAe(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function WAe(t){const e={},n=[],s=Object.keys(xi.plugins.items);for(let i=0;i<s.length;i++)n.push(xi.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function UAe(t,e){return!e&&t===!1?null:t===!0?{}:t}function jAe(t,{plugins:e,localIds:n},s,r){const i=[],o=t.getContext();for(const a of e){const l=a.id,c=UAe(s[l],r);c!==null&&i.push({plugin:a,options:HAe(t.config,{plugin:a,local:n[l]},c,o)})}return i}function HAe(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(s,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function IC(t,e){const n=zt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function GAe(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function qAe(t,e){return t===e?"_index_":"_value_"}function dF(t){if(t==="x"||t==="y"||t==="r")return t}function KAe(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function NC(t,...e){if(dF(t))return t;for(const n of e){const s=n.axis||KAe(n.position)||t.length>1&&dF(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function fF(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function XAe(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return fF(t,"x",n[0])||fF(t,"y",n[0])}return{}}function YAe(t,e){const n=Dc[t.type]||{scales:{}},s=e.scales||{},r=IC(t.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!Ue(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=NC(o,a,XAe(o,t),zt.scales[a.type]),c=qAe(l,r),u=n.scales||{};i[o]=ep(Object.create(null),[{axis:l},a,u[l],u[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||IC(a,e),u=(Dc[a]||{}).scales||{};Object.keys(u).forEach(h=>{const d=GAe(h,l),f=o[d+"AxisID"]||d;i[f]=i[f]||Object.create(null),ep(i[f],[{axis:d},s[f],u[h]])})}),Object.keys(i).forEach(o=>{const a=i[o];ep(a,[zt.scales[a.type],zt.scale])}),i}function ij(t){const e=t.options||(t.options={});e.plugins=Ae(e.plugins,{}),e.scales=YAe(t,e)}function oj(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function QAe(t){return t=t||{},t.data=oj(t.data),ij(t),t}const pF=new Map,aj=new Set;function ax(t,e){let n=pF.get(t);return n||(n=e(),pF.set(t,n),aj.add(n)),n}const pf=(t,e,n)=>{const s=ja(e,n);s!==void 0&&t.add(s)};class ZAe{constructor(e){this._config=QAe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=oj(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),ij(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return ax(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return ax(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return ax(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return ax(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(u=>{e&&(l.add(e),u.forEach(h=>pf(l,e,h))),u.forEach(h=>pf(l,r,h)),u.forEach(h=>pf(l,Dc[i]||{},h)),u.forEach(h=>pf(l,zt,h)),u.forEach(h=>pf(l,kC,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),aj.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:e,type:n}=this;return[e,Dc[n]||{},zt.datasets[n]||{},{type:n},zt,kC]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=mF(this._resolverCache,e,r);let l=o;if(eRe(o,n)){i.$shared=!1,s=Ha(s)?s():s;const c=this.createResolver(e,s,a);l=bh(o,s,c)}for(const c of n)i[c]=l[c];return i}createResolver(e,n,s=[""],r){const{resolver:i}=mF(this._resolverCache,e,s);return Ue(n)?bh(i,n,void 0,r):i}}function mF(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:_E(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const JAe=t=>Ue(t)&&Object.getOwnPropertyNames(t).some(e=>Ha(t[e]));function eRe(t,e){const{isScriptable:n,isIndexable:s}=z8(t);for(const r of e){const i=n(r),o=s(r),a=(o||i)&&t[r];if(i&&(Ha(a)||JAe(a))||o&&Nt(a))return!0}return!1}var tRe="4.4.4";const nRe=["top","bottom","left","right","chartArea"];function gF(t,e){return t==="top"||t==="bottom"||nRe.indexOf(t)===-1&&e==="x"}function xF(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function yF(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),dt(n&&n.onComplete,[t],e)}function sRe(t){const e=t.chart,n=e.options.animation;dt(n&&n.onProgress,[t],e)}function lj(t){return DE()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Ux={},bF=t=>{const e=lj(t);return Object.values(Ux).filter(n=>n.canvas===e).pop()};function rRe(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}function iRe(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}function lx(t,e,n){return t.options.clip?t[n]:e[n]}function oRe(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:lx(n,e,"left"),right:lx(n,e,"right"),top:lx(s,e,"top"),bottom:lx(s,e,"bottom")}:e}var qo;let Gd=(qo=class{static register(...e){xi.add(...e),wF()}static unregister(...e){xi.remove(...e),wF()}constructor(e,n){const s=this.config=new ZAe(n),r=lj(e),i=bF(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||kAe(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=cEe(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new VAe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=TEe(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],Ux[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Gi.listen(this,"complete",yF),Gi.listen(this,"progress",sRe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return Ke(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return xi}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():VP(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return LP(this.canvas,this.ctx),this}stop(){return Gi.stop(this),this}resize(e,n){Gi.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,VP(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),dt(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};nt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=NC(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),nt(i,o=>{const a=o.options,l=a.id,c=NC(l,a),u=Ae(a.type,o.dtype);(a.position===void 0||gF(a.position,c)!==gF(o.dposition))&&(a.position=o.dposition),r[l]=!0;let h=null;if(l in s&&s[l].type===u)h=s[l];else{const d=xi.getScale(u);h=new d({id:l,type:u,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(a,e)}),nt(r,(o,a)=>{o||delete s[a]}),nt(s,o=>{ns.configure(this,o,o.options),ns.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(xF("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||IC(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=xi.getController(a),{datasetElementType:c,dataElementType:u}=zt.datasets[a];Object.assign(l,{dataElementType:xi.getElement(u),datasetElementType:c&&xi.getElement(c)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){nt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:h}=this.getDatasetMeta(c),d=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(d),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||nt(i,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(xF("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){nt(this.scales,e=>{ns.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!$P(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;rRe(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!$P(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ns.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],nt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Ha(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Gi.has(this)?this.attached&&!Gi.running(this)&&Gi.start(this):(this.draw(),yF({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s=e._clip,r=!s.disabled,i=oRe(e,this.chartArea),o={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(r&&Vv(n,{left:s.left===!1?0:i.left-s.left,right:s.right===!1?this.width:i.right+s.right,top:s.top===!1?0:i.top-s.top,bottom:s.bottom===!1?this.height:i.bottom+s.bottom}),e.controller.draw(),r&&Wv(n),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return ao(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=nAe.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=cl(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);sm(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Gi.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),LP(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Ux[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};nt(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,c)=>{n.addEventListener(this,l,c),e[l]=c},r=(l,c)=>{e[l]&&(n.removeEventListener(this,l,c),delete e[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){nt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},nt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!k1(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,c)=>l.filter(u=>!c.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),o=i(n,e),a=s?e:i(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(e,r,s,o),l=mEe(e),c=iRe(e,this._lastEvent,s,l);s&&(this._lastEvent=null,dt(i.onHover,[e,a,this],this),l&&dt(i.onClick,[e,a,this],this));const u=!k1(a,r);return(u||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=c,u}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}},X(qo,"defaults",zt),X(qo,"instances",Ux),X(qo,"overrides",Dc),X(qo,"registry",xi),X(qo,"version",tRe),X(qo,"getChart",bF),qo);function wF(){return nt(Gd.instances,t=>t._plugins.invalidate())}function aRe(t,e,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:a,innerRadius:l}=e;let c=r/a;t.beginPath(),t.arc(i,o,a,s-c,n+c),l>r?(c=r/l,t.arc(i,o,l,n+c,s-c,!0)):t.arc(i,o,r,n+Jt,s-Jt),t.closePath(),t.clip()}function lRe(t){return NE(t,["outerStart","outerEnd","innerStart","innerEnd"])}function cRe(t,e,n,s){const r=lRe(t.options.borderRadius),i=(n-e)/2,o=Math.min(i,s*e/2),a=l=>{const c=(n-Math.min(i,l))*s/2;return An(l,0,Math.min(i,c))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:An(r.innerStart,0,o),innerEnd:An(r.innerEnd,0,o)}}function cu(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function $1(t,e,n,s,r,i){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=e,h=Math.max(e.outerRadius+s+n-c,0),d=u>0?u+s+n+c:0;let f=0;const p=r-l;if(s){const F=u>0?u-s:0,R=h>0?h-s:0,O=(F+R)/2,E=O!==0?p*O/(O+s):p;f=(p-E)/2}const g=Math.max(.001,p*h-n/kt)/h,m=(p-g)/2,x=l+m+f,y=r-m-f,{outerStart:b,outerEnd:w,innerStart:v,innerEnd:S}=cRe(e,d,h,y-x),T=h-b,k=h-w,I=x+b/T,_=y-w/k,D=d+v,A=d+S,L=x+v/D,B=y-S/A;if(t.beginPath(),i){const F=(I+_)/2;if(t.arc(o,a,h,I,F),t.arc(o,a,h,F,_),w>0){const V=cu(k,_,o,a);t.arc(V.x,V.y,w,_,y+Jt)}const R=cu(A,y,o,a);if(t.lineTo(R.x,R.y),S>0){const V=cu(A,B,o,a);t.arc(V.x,V.y,S,y+Jt,B+Math.PI)}const O=(y-S/d+(x+v/d))/2;if(t.arc(o,a,d,y-S/d,O,!0),t.arc(o,a,d,O,x+v/d,!0),v>0){const V=cu(D,L,o,a);t.arc(V.x,V.y,v,L+Math.PI,x-Jt)}const E=cu(T,x,o,a);if(t.lineTo(E.x,E.y),b>0){const V=cu(T,I,o,a);t.arc(V.x,V.y,b,x-Jt,I)}}else{t.moveTo(o,a);const F=Math.cos(I)*h+o,R=Math.sin(I)*h+a;t.lineTo(F,R);const O=Math.cos(_)*h+o,E=Math.sin(_)*h+a;t.lineTo(O,E)}t.closePath()}function uRe(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a}=e;let l=e.endAngle;if(i){$1(t,e,n,s,l,r);for(let c=0;c<i;++c)t.fill();isNaN(a)||(l=o+(a%vt||vt))}return $1(t,e,n,s,l,r),t.fill(),l}function hRe(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:h,borderDashOffset:d}=l,f=l.borderAlign==="inner";if(!c)return;t.setLineDash(h||[]),t.lineDashOffset=d,f?(t.lineWidth=c*2,t.lineJoin=u||"round"):(t.lineWidth=c,t.lineJoin=u||"bevel");let p=e.endAngle;if(i){$1(t,e,n,s,p,r);for(let g=0;g<i;++g)t.stroke();isNaN(a)||(p=o+(a%vt||vt))}f&&aRe(t,e,p),i||($1(t,e,n,s,p,r),t.stroke())}class Ff extends Bo{constructor(n){super();X(this,"circumference");X(this,"endAngle");X(this,"fullCircles");X(this,"innerRadius");X(this,"outerRadius");X(this,"pixelMargin");X(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.getProps(["x","y"],r),{angle:o,distance:a}=$8(i,{x:n,y:s}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:h,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),f=(this.options.spacing+this.options.borderWidth)/2,p=Ae(d,c-l),g=rm(o,l,c)&&l!==c,m=p>=vt||g,x=io(a,u+f,h+f);return m&&x}getCenterPoint(n){const{x:s,y:r,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:c,spacing:u}=this.options,h=(i+o)/2,d=(a+l+u+c)/2;return{x:s+Math.cos(h)*d,y:r+Math.sin(h)*d}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>vt?Math.floor(r/vt):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const c=1-Math.sin(Math.min(kt,r||0)),u=i*c;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,uRe(n,this,u,o,a),hRe(n,this,u,o,a),n.restore()}}X(Ff,"id","arc"),X(Ff,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),X(Ff,"defaultRoutes",{backgroundColor:"backgroundColor"}),X(Ff,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function cj(t,e,n=e){t.lineCap=Ae(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Ae(n.borderDash,e.borderDash)),t.lineDashOffset=Ae(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Ae(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Ae(n.borderWidth,e.borderWidth),t.strokeStyle=Ae(n.borderColor,e.borderColor)}function dRe(t,e,n){t.lineTo(n.x,n.y)}function fRe(t){return t.stepped?MEe:t.tension||t.cubicInterpolationMode==="monotone"?LEe:dRe}function uj(t,e,n={}){const s=t.length,{start:r=0,end:i=s-1}=n,{start:o,end:a}=e,l=Math.max(r,o),c=Math.min(i,a),u=r<o&&i<o||r>a&&i>a;return{count:s,start:l,loop:e.loop,ilen:c<l&&!u?s+c-l:c-l}}function pRe(t,e,n,s){const{points:r,options:i}=e,{count:o,start:a,loop:l,ilen:c}=uj(r,n,s),u=fRe(i);let{move:h=!0,reverse:d}=s||{},f,p,g;for(f=0;f<=c;++f)p=r[(a+(d?c-f:f))%o],!p.skip&&(h?(t.moveTo(p.x,p.y),h=!1):u(t,g,p,d,i.stepped),g=p);return l&&(p=r[(a+(d?c:0))%o],u(t,g,p,d,i.stepped)),!!l}function mRe(t,e,n,s){const r=e.points,{count:i,start:o,ilen:a}=uj(r,n,s),{move:l=!0,reverse:c}=s||{};let u=0,h=0,d,f,p,g,m,x;const y=w=>(o+(c?a-w:w))%i,b=()=>{g!==m&&(t.lineTo(u,m),t.lineTo(u,g),t.lineTo(u,x))};for(l&&(f=r[y(0)],t.moveTo(f.x,f.y)),d=0;d<=a;++d){if(f=r[y(d)],f.skip)continue;const w=f.x,v=f.y,S=w|0;S===p?(v<g?g=v:v>m&&(m=v),u=(h*u+w)/++h):(b(),t.lineTo(w,v),p=S,h=0,g=m=v),x=v}b()}function _C(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?mRe:pRe}function gRe(t){return t.stepped?gDe:t.tension||t.cubicInterpolationMode==="monotone"?xDe:Il}function xRe(t,e,n,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,s)&&r.closePath()),cj(t,e.options),t.stroke(r)}function yRe(t,e,n,s){const{segments:r,options:i}=e,o=_C(e);for(const a of r)cj(t,i,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const bRe=typeof Path2D=="function";function wRe(t,e,n,s){bRe&&!e.options.segment?xRe(t,e,n,s):yRe(t,e,n,s)}class ha extends Bo{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;lDe(this._points,s,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=kDe(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,r=e[n],i=this.points,o=X8(this,{property:n,start:r,end:r});if(!o.length)return;const a=[],l=gRe(s);let c,u;for(c=0,u=o.length;c<u;++c){const{start:h,end:d}=o[c],f=i[h],p=i[d];if(f===p){a.push(f);continue}const g=Math.abs((r-f[n])/(p[n]-f[n])),m=l(f,p,g,s.stepped);m[n]=e[n],a.push(m)}return a.length===1?a[0]:a}pathSegment(e,n,s){return _C(this)(e,this,n,s)}path(e,n,s){const r=this.segments,i=_C(this);let o=this._loop;n=n||0,s=s||this.points.length-n;for(const a of r)o&=i(e,this,a,{start:n,end:n+s-1});return!!o}draw(e,n,s,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),wRe(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}X(ha,"id","line"),X(ha,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),X(ha,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),X(ha,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function vF(t,e,n,s){const r=t.options,{[n]:i}=t.getProps([n],s);return Math.abs(e-i)<r.radius+r.hitRadius}class jx extends Bo{constructor(n){super();X(this,"parsed");X(this,"skip");X(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.options,{x:o,y:a}=this.getProps(["x","y"],r);return Math.pow(n-o,2)+Math.pow(s-a,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(n,s){return vF(this,n,"x",s)}inYRange(n,s){return vF(this,n,"y",s)}getCenterPoint(n){const{x:s,y:r}=this.getProps(["x","y"],n);return{x:s,y:r}}size(n){n=n||this.options||{};let s=n.radius||0;s=Math.max(s,s&&n.hoverRadius||0);const r=s&&n.borderWidth||0;return(s+r)*2}draw(n,s){const r=this.options;this.skip||r.radius<.1||!ao(this,s,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,CC(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}X(jx,"id","point"),X(jx,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),X(jx,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function hj(t,e){const{x:n,y:s,base:r,width:i,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,u,h;return t.horizontal?(h=o/2,a=Math.min(n,r),l=Math.max(n,r),c=s-h,u=s+h):(h=i/2,a=n-h,l=n+h,c=Math.min(s,r),u=Math.max(s,r)),{left:a,top:c,right:l,bottom:u}}function da(t,e,n,s){return t?0:An(e,n,s)}function vRe(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,i=L8(s);return{t:da(r.top,i.top,0,n),r:da(r.right,i.right,0,e),b:da(r.bottom,i.bottom,0,n),l:da(r.left,i.left,0,e)}}function SRe(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,i=Ql(r),o=Math.min(e,n),a=t.borderSkipped,l=s||Ue(r);return{topLeft:da(!l||a.top||a.left,i.topLeft,0,o),topRight:da(!l||a.top||a.right,i.topRight,0,o),bottomLeft:da(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:da(!l||a.bottom||a.right,i.bottomRight,0,o)}}function kRe(t){const e=hj(t),n=e.right-e.left,s=e.bottom-e.top,r=vRe(t,n/2,s/2),i=SRe(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function iS(t,e,n,s){const r=e===null,i=n===null,a=t&&!(r&&i)&&hj(t,s);return a&&(r||io(e,a.left,a.right))&&(i||io(n,a.top,a.bottom))}function CRe(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function TRe(t,e){t.rect(e.x,e.y,e.w,e.h)}function oS(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-s,o=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+i,h:t.h+o,radius:t.radius}}class ap extends Bo{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=kRe(this),a=CRe(o.radius)?im:TRe;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),a(e,oS(o,n,i)),e.clip(),a(e,oS(i,-n,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),a(e,oS(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return iS(this,e,n,s)}inXRange(e,n){return iS(this,e,null,n)}inYRange(e,n){return iS(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}X(ap,"id","bar"),X(ap,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),X(ap,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var IRe=Object.freeze({__proto__:null,ArcElement:Ff,BarElement:ap,LineElement:ha,PointElement:jx});const $C=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],SF=$C.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function dj(t){return $C[t%$C.length]}function fj(t){return SF[t%SF.length]}function NRe(t,e){return t.borderColor=dj(e),t.backgroundColor=fj(e),++e}function _Re(t,e){return t.backgroundColor=t.data.map(()=>dj(e++)),e}function $Re(t,e){return t.backgroundColor=t.data.map(()=>fj(e++)),e}function ERe(t){let e=0;return(n,s)=>{const r=t.getDatasetMeta(s).controller;r instanceof Vl?e=_Re(n,e):r instanceof ip?e=$Re(n,e):r&&(e=NRe(n,e))}}function kF(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function DRe(t){return t&&(t.borderColor||t.backgroundColor)}var ARe={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,n){if(!n.enabled)return;const{data:{datasets:s},options:r}=t.config,{elements:i}=r;if(!n.forceOverride&&(kF(s)||DRe(r)||i&&kF(i)))return;const o=ERe(t);s.forEach(o)}};function RRe(t,e,n,s,r){const i=r.samples||s;if(i>=n)return t.slice(e,e+n);const o=[],a=(n-2)/(i-2);let l=0;const c=e+n-1;let u=e,h,d,f,p,g;for(o[l++]=t[u],h=0;h<i-2;h++){let m=0,x=0,y;const b=Math.floor((h+1)*a)+1+e,w=Math.min(Math.floor((h+2)*a)+1,n)+e,v=w-b;for(y=b;y<w;y++)m+=t[y].x,x+=t[y].y;m/=v,x/=v;const S=Math.floor(h*a)+1+e,T=Math.min(Math.floor((h+1)*a)+1,n)+e,{x:k,y:I}=t[u];for(f=p=-1,y=S;y<T;y++)p=.5*Math.abs((k-m)*(t[y].y-I)-(k-t[y].x)*(x-I)),p>f&&(f=p,d=t[y],g=y);o[l++]=d,u=g}return o[l++]=t[c],o}function ORe(t,e,n,s){let r=0,i=0,o,a,l,c,u,h,d,f,p,g;const m=[],x=e+n-1,y=t[e].x,w=t[x].x-y;for(o=e;o<e+n;++o){a=t[o],l=(a.x-y)/w*s,c=a.y;const v=l|0;if(v===u)c<p?(p=c,h=o):c>g&&(g=c,d=o),r=(i*r+a.x)/++i;else{const S=o-1;if(!Ke(h)&&!Ke(d)){const T=Math.min(h,d),k=Math.max(h,d);T!==f&&T!==S&&m.push({...t[T],x:r}),k!==f&&k!==S&&m.push({...t[k],x:r})}o>0&&S!==f&&m.push(t[S]),m.push(a),u=v,i=0,p=g=c,h=d=f=o}}return m}function pj(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function CF(t){t.data.datasets.forEach(e=>{pj(e)})}function PRe(t,e){const n=e.length;let s=0,r;const{iScale:i}=t,{min:o,max:a,minDefined:l,maxDefined:c}=i.getUserBounds();return l&&(s=An(oo(e,i.axis,o).lo,0,n-1)),c?r=An(oo(e,i.axis,a).hi+1,s,n)-s:r=n-s,{start:s,count:r}}var FRe={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled){CF(t);return}const s=t.width;t.data.datasets.forEach((r,i)=>{const{_data:o,indexAxis:a}=r,l=t.getDatasetMeta(i),c=o||r.data;if(Of([a,t.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=t.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||t.options.parsing)return;let{start:h,count:d}=PRe(l,c);const f=n.threshold||4*s;if(d<=f){pj(r);return}Ke(o)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(g){this._data=g}}));let p;switch(n.algorithm){case"lttb":p=RRe(c,h,d,s,n);break;case"min-max":p=ORe(c,h,d,s);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=p})},destroy(t){CF(t)}};function MRe(t,e,n){const s=t.segments,r=t.points,i=e.points,o=[];for(const a of s){let{start:l,end:c}=a;c=OE(l,c,r);const u=EC(n,r[l],r[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:r[l],end:r[c]});continue}const h=X8(e,u);for(const d of h){const f=EC(n,i[d.start],i[d.end],d.loop),p=K8(a,r,f);for(const g of p)o.push({source:g,target:d,start:{[n]:TF(u,f,"start",Math.max)},end:{[n]:TF(u,f,"end",Math.min)}})}}return o}function EC(t,e,n,s){if(s)return;let r=e[t],i=n[t];return t==="angle"&&(r=Qs(r),i=Qs(i)),{property:t,start:r,end:i}}function LRe(t,e){const{x:n=null,y:s=null}=t||{},r=e.points,i=[];return e.segments.forEach(({start:o,end:a})=>{a=OE(o,a,r);const l=r[o],c=r[a];s!==null?(i.push({x:l.x,y:s}),i.push({x:c.x,y:s})):n!==null&&(i.push({x:n,y:l.y}),i.push({x:n,y:c.y}))}),i}function OE(t,e,n){for(;e>t;e--){const s=n[e];if(!isNaN(s.x)&&!isNaN(s.y))break}return e}function TF(t,e,n,s){return t&&e?s(t[n],e[n]):t?t[n]:e?e[n]:0}function mj(t,e){let n=[],s=!1;return Nt(t)?(s=!0,n=t):n=LRe(t,e),n.length?new ha({points:n,options:{tension:0},_loop:s,_fullLoop:s}):null}function IF(t){return t&&t.fill!==!1}function zRe(t,e,n){let r=t[e].fill;const i=[e];let o;if(!n)return r;for(;r!==!1&&i.indexOf(r)===-1;){if(!Lt(r))return r;if(o=t[r],!o)return!1;if(o.visible)return r;i.push(r),r=o.fill}return!1}function BRe(t,e,n){const s=jRe(t);if(Ue(s))return isNaN(s.value)?!1:s;let r=parseFloat(s);return Lt(r)&&Math.floor(r)===r?VRe(s[0],e,r,n):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function VRe(t,e,n,s){return(t==="-"||t==="+")&&(n=e+n),n===e||n<0||n>=s?!1:n}function WRe(t,e){let n=null;return t==="start"?n=e.bottom:t==="end"?n=e.top:Ue(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function URe(t,e,n){let s;return t==="start"?s=n:t==="end"?s=e.options.reverse?e.min:e.max:Ue(t)?s=t.value:s=e.getBaseValue(),s}function jRe(t){const e=t.options,n=e.fill;let s=Ae(n&&n.target,n);return s===void 0&&(s=!!e.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function HRe(t){const{scale:e,index:n,line:s}=t,r=[],i=s.segments,o=s.points,a=GRe(e,n);a.push(mj({x:null,y:e.bottom},s));for(let l=0;l<i.length;l++){const c=i[l];for(let u=c.start;u<=c.end;u++)qRe(r,o[u],a)}return new ha({points:r,options:{}})}function GRe(t,e){const n=[],s=t.getMatchingVisibleMetas("line");for(let r=0;r<s.length;r++){const i=s[r];if(i.index===e)break;i.hidden||n.unshift(i.dataset)}return n}function qRe(t,e,n){const s=[];for(let r=0;r<n.length;r++){const i=n[r],{first:o,last:a,point:l}=KRe(i,e,"x");if(!(!l||o&&a)){if(o)s.unshift(l);else if(t.push(l),!a)break}}t.push(...s)}function KRe(t,e,n){const s=t.interpolate(e,n);if(!s)return{};const r=s[n],i=t.segments,o=t.points;let a=!1,l=!1;for(let c=0;c<i.length;c++){const u=i[c],h=o[u.start][n],d=o[u.end][n];if(io(r,h,d)){a=r===h,l=r===d;break}}return{first:a,last:l,point:s}}class gj{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,n,s){const{x:r,y:i,radius:o}=this;return n=n||{start:0,end:vt},e.arc(r,i,o,n.end,n.start,!0),!s.bounds}interpolate(e){const{x:n,y:s,radius:r}=this,i=e.angle;return{x:n+Math.cos(i)*r,y:s+Math.sin(i)*r,angle:i}}}function XRe(t){const{chart:e,fill:n,line:s}=t;if(Lt(n))return YRe(e,n);if(n==="stack")return HRe(t);if(n==="shape")return!0;const r=QRe(t);return r instanceof gj?r:mj(r,s)}function YRe(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}function QRe(t){return(t.scale||{}).getPointPositionForValue?JRe(t):ZRe(t)}function ZRe(t){const{scale:e={},fill:n}=t,s=WRe(n,e);if(Lt(s)){const r=e.isHorizontal();return{x:r?s:null,y:r?null:s}}return null}function JRe(t){const{scale:e,fill:n}=t,s=e.options,r=e.getLabels().length,i=s.reverse?e.max:e.min,o=URe(n,e,i),a=[];if(s.grid.circular){const l=e.getPointPositionForValue(0,i);return new gj({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<r;++l)a.push(e.getPointPositionForValue(l,o));return a}function aS(t,e,n){const s=XRe(e),{line:r,scale:i,axis:o}=e,a=r.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:h=c}=l||{};s&&r.points.length&&(Vv(t,n),eOe(t,{line:r,target:s,above:u,below:h,area:n,scale:i,axis:o}),Wv(t))}function eOe(t,e){const{line:n,target:s,above:r,below:i,area:o,scale:a}=e,l=n._loop?"angle":e.axis;t.save(),l==="x"&&i!==r&&(NF(t,s,o.top),_F(t,{line:n,target:s,color:r,scale:a,property:l}),t.restore(),t.save(),NF(t,s,o.bottom)),_F(t,{line:n,target:s,color:i,scale:a,property:l}),t.restore()}function NF(t,e,n){const{segments:s,points:r}=e;let i=!0,o=!1;t.beginPath();for(const a of s){const{start:l,end:c}=a,u=r[l],h=r[OE(l,c,r)];i?(t.moveTo(u.x,u.y),i=!1):(t.lineTo(u.x,n),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(h.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function _F(t,e){const{line:n,target:s,property:r,color:i,scale:o}=e,a=MRe(n,s,r);for(const{source:l,target:c,start:u,end:h}of a){const{style:{backgroundColor:d=i}={}}=l,f=s!==!0;t.save(),t.fillStyle=d,tOe(t,o,f&&EC(r,u,h)),t.beginPath();const p=!!n.pathSegment(t,l);let g;if(f){p?t.closePath():$F(t,s,h,r);const m=!!s.pathSegment(t,c,{move:p,reverse:!0});g=p&&m,g||$F(t,s,u,r)}t.closePath(),t.fill(g?"evenodd":"nonzero"),t.restore()}}function tOe(t,e,n){const{top:s,bottom:r}=e.chart.chartArea,{property:i,start:o,end:a}=n||{};i==="x"&&(t.beginPath(),t.rect(o,s,a-o,r-s),t.clip())}function $F(t,e,n,s){const r=e.interpolate(n,s);r&&t.lineTo(r.x,r.y)}var nOe={id:"filler",afterDatasetsUpdate(t,e,n){const s=(t.data.datasets||[]).length,r=[];let i,o,a,l;for(o=0;o<s;++o)i=t.getDatasetMeta(o),a=i.dataset,l=null,a&&a.options&&a instanceof ha&&(l={visible:t.isDatasetVisible(o),index:o,fill:BRe(a,o,s),chart:t,axis:i.controller.options.indexAxis,scale:i.vScale,line:a}),i.$filler=l,r.push(l);for(o=0;o<s;++o)l=r[o],!(!l||l.fill===!1)&&(l.fill=zRe(r,o,n.propagate))},beforeDraw(t,e,n){const s=n.drawTime==="beforeDraw",r=t.getSortedVisibleDatasetMetas(),i=t.chartArea;for(let o=r.length-1;o>=0;--o){const a=r[o].$filler;a&&(a.line.updateControlPoints(i,a.axis),s&&a.fill&&aS(t.ctx,a,i))}},beforeDatasetsDraw(t,e,n){if(n.drawTime!=="beforeDatasetsDraw")return;const s=t.getSortedVisibleDatasetMetas();for(let r=s.length-1;r>=0;--r){const i=s[r].$filler;IF(i)&&aS(t.ctx,i,t.chartArea)}},beforeDatasetDraw(t,e,n){const s=e.meta.$filler;!IF(s)||n.drawTime!=="beforeDatasetDraw"||aS(t.ctx,s,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const EF=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},sOe=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class DF extends Bo{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=dt(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=bn(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=EF(s,i);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,i,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let h=e;i.textAlign="left",i.textBaseline="middle";let d=-1,f=-u;return this.legendItems.forEach((p,g)=>{const m=s+n/2+i.measureText(p.text).width;(g===0||c[c.length-1]+m+2*a>o)&&(h+=u,c[c.length-(g>0?0:1)]=0,f+=u,d++),l[g]={left:0,top:f,row:d,width:m,height:r},c[c.length-1]+=m+a}),h}_fitCols(e,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let h=a,d=0,f=0,p=0,g=0;return this.legendItems.forEach((m,x)=>{const{itemWidth:y,itemHeight:b}=rOe(s,n,i,m,r);x>0&&f+b+2*a>u&&(h+=d+a,c.push({width:d,height:f}),p+=d+a,g++,d=f=0),l[x]={left:p,top:f,col:g,width:y,height:b},d=Math.max(d,y),f+=b+a}),h+=d,c.push({width:d,height:f}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=Uu(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=Kn(s,this.left+r,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=Kn(s,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+e+r,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+r}else{let a=0,l=Kn(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=Kn(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Vv(e,this),this._draw(),Wv(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,a=zt.color,l=Uu(e.rtl,this.left,this.width),c=bn(o.font),{padding:u}=o,h=c.size,d=h/2;let f;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:p,boxHeight:g,itemHeight:m}=EF(o,h),x=function(S,T,k){if(isNaN(p)||p<=0||isNaN(g)||g<0)return;r.save();const I=Ae(k.lineWidth,1);if(r.fillStyle=Ae(k.fillStyle,a),r.lineCap=Ae(k.lineCap,"butt"),r.lineDashOffset=Ae(k.lineDashOffset,0),r.lineJoin=Ae(k.lineJoin,"miter"),r.lineWidth=I,r.strokeStyle=Ae(k.strokeStyle,a),r.setLineDash(Ae(k.lineDash,[])),o.usePointStyle){const _={radius:g*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:I},D=l.xPlus(S,p/2),A=T+d;M8(r,_,D,A,o.pointStyleWidth&&p)}else{const _=T+Math.max((h-g)/2,0),D=l.leftForLtr(S,p),A=Ql(k.borderRadius);r.beginPath(),Object.values(A).some(L=>L!==0)?im(r,{x:D,y:_,w:p,h:g,radius:A}):r.rect(D,_,p,g),r.fill(),I!==0&&r.stroke()}r.restore()},y=function(S,T,k){Ac(r,k.text,S,T+m/2,c,{strikethrough:k.hidden,textAlign:l.textAlign(k.textAlign)})},b=this.isHorizontal(),w=this._computeTitleHeight();b?f={x:Kn(i,this.left+u,this.right-s[0]),y:this.top+u+w,line:0}:f={x:this.left+u,y:Kn(i,this.top+w+u,this.bottom-n[0].height),line:0},H8(this.ctx,e.textDirection);const v=m+u;this.legendItems.forEach((S,T)=>{r.strokeStyle=S.fontColor,r.fillStyle=S.fontColor;const k=r.measureText(S.text).width,I=l.textAlign(S.textAlign||(S.textAlign=o.textAlign)),_=p+d+k;let D=f.x,A=f.y;l.setWidth(this.width),b?T>0&&D+_+u>this.right&&(A=f.y+=v,f.line++,D=f.x=Kn(i,this.left+u,this.right-s[f.line])):T>0&&A+v>this.bottom&&(D=f.x=D+n[f.line].width+u,f.line++,A=f.y=Kn(i,this.top+w+u,this.bottom-n[f.line].height));const L=l.x(D);if(x(L,A,S),D=IEe(I,D+p+d,b?D+_:this.right,e.rtl),y(l.x(D),A,S),b)f.x+=_+u;else if(typeof S.text!="string"){const B=c.lineHeight;f.y+=xj(S,B)+u}else f.y+=v}),G8(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=bn(n.font),r=as(n.padding);if(!n.display)return;const i=Uu(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,c=r.top+l;let u,h=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),u=this.top+c,h=Kn(e.align,h,this.right-d);else{const p=this.columnSizes.reduce((g,m)=>Math.max(g,m.height),0);u=c+Kn(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const f=Kn(a,h,h+d);o.textAlign=i.textAlign(TE(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,Ac(o,n.text,f,u,s)}_computeTitleHeight(){const e=this.options.title,n=bn(e.font),s=as(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(io(e,this.left,this.right)&&io(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],io(e,r.left,r.left+r.width)&&io(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!aOe(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=sOe(r,s);r&&!i&&dt(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&dt(n.onHover,[e,s,this],this)}else s&&dt(n.onClick,[e,s,this],this)}}function rOe(t,e,n,s,r){const i=iOe(s,t,e,n),o=oOe(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function iOe(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+s.measureText(r).width}function oOe(t,e,n){let s=t;return typeof e.text!="string"&&(s=xj(e,n)),s}function xj(t,e){const n=t.text?t.text.length:0;return e*n}function aOe(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var yj={id:"legend",_element:DF,start(t,e,n){const s=t.legend=new DF({ctx:t.ctx,options:n,chart:t});ns.configure(t,s,n),ns.addBox(t,s)},stop(t){ns.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;ns.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),u=as(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class PE extends Bo{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=Nt(s.text)?s.text.length:1;this._padding=as(s.padding);const i=r*bn(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:s,bottom:r,right:i,options:o}=this,a=o.align;let l=0,c,u,h;return this.isHorizontal()?(u=Kn(a,s,i),h=n+e,c=i-s):(o.position==="left"?(u=s+e,h=Kn(a,r,n),l=kt*-.5):(u=i-e,h=Kn(a,n,r),l=kt*.5),c=r-n),{titleX:u,titleY:h,maxWidth:c,rotation:l}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const s=bn(n.font),i=s.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(i);Ac(e,n.text,0,0,s,{color:n.color,maxWidth:l,rotation:c,textAlign:TE(n.align),textBaseline:"middle",translation:[o,a]})}}function lOe(t,e){const n=new PE({ctx:t.ctx,options:e,chart:t});ns.configure(t,n,e),ns.addBox(t,n),t.titleBlock=n}var bj={id:"title",_element:PE,start(t,e,n){lOe(t,n)},stop(t){const e=t.titleBlock;ns.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const s=t.titleBlock;ns.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const cx=new WeakMap;var cOe={id:"subtitle",start(t,e,n){const s=new PE({ctx:t.ctx,options:n,chart:t});ns.configure(t,s,n),ns.addBox(t,s),cx.set(t,s)},stop(t){ns.removeBox(t,cx.get(t)),cx.delete(t)},beforeUpdate(t,e,n){const s=cx.get(t);ns.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Mf={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=SC(e,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function mi(t,e){return e&&(Nt(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function qi(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function uOe(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:t,label:o,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function AF(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=bn(e.bodyFont),c=bn(e.titleFont),u=bn(e.footerFont),h=i.length,d=r.length,f=s.length,p=as(e.padding);let g=p.height,m=0,x=s.reduce((w,v)=>w+v.before.length+v.lines.length+v.after.length,0);if(x+=t.beforeBody.length+t.afterBody.length,h&&(g+=h*c.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),x){const w=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;g+=f*w+(x-f)*l.lineHeight+(x-1)*e.bodySpacing}d&&(g+=e.footerMarginTop+d*u.lineHeight+(d-1)*e.footerSpacing);let y=0;const b=function(w){m=Math.max(m,n.measureText(w).width+y)};return n.save(),n.font=c.string,nt(t.title,b),n.font=l.string,nt(t.beforeBody.concat(t.afterBody),b),y=e.displayColors?o+2+e.boxPadding:0,nt(s,w=>{nt(w.before,b),nt(w.lines,b),nt(w.after,b)}),y=0,n.font=u.string,nt(t.footer,b),n.restore(),m+=p.width,{width:m,height:g}}function hOe(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function dOe(t,e,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+i+o>e.width||t==="right"&&r-i-o<0)return!0}function fOe(t,e,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return s==="center"?c=r<=(a+l)/2?"left":"right":r<=i/2?c="left":r>=o-i/2&&(c="right"),dOe(c,t,e,n)&&(c="center"),c}function RF(t,e,n){const s=n.yAlign||e.yAlign||hOe(t,n);return{xAlign:n.xAlign||e.xAlign||fOe(t,e,n,s),yAlign:s}}function pOe(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function mOe(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function OF(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,c=r+i,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=Ql(o);let p=pOe(e,a);const g=mOe(e,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,d)+r:a==="right"&&(p+=Math.max(h,f)+r),{x:An(p,0,s.width-e.width),y:An(g,0,s.height-e.height)}}function ux(t,e,n){const s=as(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function PF(t){return mi([],qi(t))}function gOe(t,e,n){return cl(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function FF(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const wj={beforeTitle:Hi,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Hi,beforeBody:Hi,beforeLabel:Hi,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Ke(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Hi,afterBody:Hi,beforeFooter:Hi,footer:Hi,afterFooter:Hi};function Ns(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?wj[e].call(n,s):r}class DC extends Bo{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new Y8(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=gOe(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=Ns(s,"beforeTitle",this,e),i=Ns(s,"title",this,e),o=Ns(s,"afterTitle",this,e);let a=[];return a=mi(a,qi(r)),a=mi(a,qi(i)),a=mi(a,qi(o)),a}getBeforeBody(e,n){return PF(Ns(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return nt(e,i=>{const o={before:[],lines:[],after:[]},a=FF(s,i);mi(o.before,qi(Ns(a,"beforeLabel",this,i))),mi(o.lines,Ns(a,"label",this,i)),mi(o.after,qi(Ns(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,n){return PF(Ns(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=Ns(s,"beforeFooter",this,e),i=Ns(s,"footer",this,e),o=Ns(s,"afterFooter",this,e);let a=[];return a=mi(a,qi(r)),a=mi(a,qi(i)),a=mi(a,qi(o)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(uOe(this.chart,n[l]));return e.filter&&(a=a.filter((u,h,d)=>e.filter(u,h,d,s))),e.itemSort&&(a=a.sort((u,h)=>e.itemSort(u,h,s))),nt(a,u=>{const h=FF(e.callbacks,u);r.push(Ns(h,"labelColor",this,u)),i.push(Ns(h,"labelPointStyle",this,u)),o.push(Ns(h,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=Mf[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=AF(this,s),c=Object.assign({},a,l),u=RF(this.chart,s,c),h=OF(s,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,i={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=Ql(a),{x:d,y:f}=e,{width:p,height:g}=n;let m,x,y,b,w,v;return i==="center"?(w=f+g/2,r==="left"?(m=d,x=m-o,b=w+o,v=w-o):(m=d+p,x=m+o,b=w-o,v=w+o),y=m):(r==="left"?x=d+Math.max(l,u)+o:r==="right"?x=d+p-Math.max(c,h)-o:x=this.caretX,i==="top"?(b=f,w=b-o,m=x-o,y=x+o):(b=f+g,w=b+o,m=x+o,y=x-o),v=b),{x1:m,x2:x,x3:y,y1:b,y2:w,y3:v}}drawTitle(e,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const c=Uu(s.rtl,this.x,this.width);for(e.x=ux(this,s.titleAlign,s),n.textAlign=c.textAlign(s.titleAlign),n.textBaseline="middle",o=bn(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=i,u=bn(i.bodyFont),h=ux(this,"left",i),d=r.x(h),f=l<u.lineHeight?(u.lineHeight-l)/2:0,p=n.y+f;if(i.usePointStyle){const g={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},m=r.leftForLtr(d,c)+c/2,x=p+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,CC(e,g,m,x),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,CC(e,g,m,x)}else{e.lineWidth=Ue(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const g=r.leftForLtr(d,c),m=r.leftForLtr(r.xPlus(d,1),c-2),x=Ql(o.borderRadius);Object.values(x).some(y=>y!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,im(e,{x:g,y:p,w:c,h:l,radius:x}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),im(e,{x:m,y:p+1,w:c-2,h:l-2,radius:x}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(g,p,c,l),e.strokeRect(g,p,c,l),e.fillStyle=o.backgroundColor,e.fillRect(m,p+1,c-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=s,h=bn(s.bodyFont);let d=h.lineHeight,f=0;const p=Uu(s.rtl,this.x,this.width),g=function(k){n.fillText(k,p.x(e.x+f),e.y+d/2),e.y+=d+i},m=p.textAlign(o);let x,y,b,w,v,S,T;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,e.x=ux(this,m,s),n.fillStyle=s.bodyColor,nt(this.beforeBody,g),f=a&&m!=="right"?o==="center"?c/2+u:c+2+u:0,w=0,S=r.length;w<S;++w){for(x=r[w],y=this.labelTextColors[w],n.fillStyle=y,nt(x.before,g),b=x.lines,a&&b.length&&(this._drawColorBox(n,e,w,p,s),d=Math.max(h.lineHeight,l)),v=0,T=b.length;v<T;++v)g(b[v]),d=h.lineHeight;nt(x.after,g)}f=0,d=h.lineHeight,nt(this.afterBody,g),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=Uu(s.rtl,this.x,this.width);for(e.x=ux(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=bn(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=s,{topLeft:h,topRight:d,bottomLeft:f,bottomRight:p}=Ql(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+h,l),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+c-d,l),n.quadraticCurveTo(a+c,l,a+c,l+d),o==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+c,l+u-p),n.quadraticCurveTo(a+c,l+u,a+c-p,l+u),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+f,l+u),n.quadraticCurveTo(a,l+u,a,l+u-f),o==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+h),n.quadraticCurveTo(a,l,a+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=Mf[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=AF(this,e),l=Object.assign({},o,this._size),c=RF(n,e,l),u=OF(e,l,c,n);(r._to!==u.x||i._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=as(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),H8(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),G8(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),i=!k1(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,s),a=this._positionChanged(o,e),l=n||!k1(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,o=Mf[i.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}X(DC,"positioners",Mf);var vj={id:"tooltip",_element:DC,positioners:Mf,afterInit(t,e,n){n&&(t.tooltip=new DC({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:wj},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},xOe=Object.freeze({__proto__:null,Colors:ARe,Decimation:FRe,Filler:nOe,Legend:yj,SubTitle:cOe,Title:bj,Tooltip:vj});const yOe=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function bOe(t,e,n,s){const r=t.indexOf(e);if(r===-1)return yOe(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const wOe=(t,e)=>t===null?null:An(Math.round(t),0,e);function MF(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class E1 extends nu{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(Ke(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:bOe(s,e,Ae(n,e),this._addedLabels),wOe(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return MF.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}X(E1,"id","category"),X(E1,"defaults",{ticks:{callback:MF}});function vOe(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:d}=t,f=i||1,p=u-1,{min:g,max:m}=e,x=!Ke(o),y=!Ke(a),b=!Ke(c),w=(m-g)/(h+1);let v=DP((m-g)/p/f)*f,S,T,k,I;if(v<1e-14&&!x&&!y)return[{value:g},{value:m}];I=Math.ceil(m/v)-Math.floor(g/v),I>p&&(v=DP(I*v/p/f)*f),Ke(l)||(S=Math.pow(10,l),v=Math.ceil(v*S)/S),r==="ticks"?(T=Math.floor(g/v)*v,k=Math.ceil(m/v)*v):(T=g,k=m),x&&y&&i&&bEe((a-o)/i,v/1e3)?(I=Math.round(Math.min((a-o)/v,u)),v=(a-o)/I,T=o,k=a):b?(T=x?o:T,k=y?a:k,I=c-1,v=(k-T)/I):(I=(k-T)/v,tp(I,Math.round(I),v/1e3)?I=Math.round(I):I=Math.ceil(I));const _=Math.max(AP(v),AP(T));S=Math.pow(10,Ke(l)?_:l),T=Math.round(T*S)/S,k=Math.round(k*S)/S;let D=0;for(x&&(d&&T!==o?(n.push({value:o}),T<o&&D++,tp(Math.round((T+D*v)*S)/S,o,LF(o,w,t))&&D++):T<o&&D++);D<I;++D){const A=Math.round((T+D*v)*S)/S;if(y&&A>a)break;n.push({value:A})}return y&&d&&k!==a?n.length&&tp(n[n.length-1].value,a,LF(a,w,t))?n[n.length-1].value=a:n.push({value:a}):(!y||k===a)&&n.push({value:k}),n}function LF(t,e,{horizontal:n,minRotation:s}){const r=Xr(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class D1 extends nu{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return Ke(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(e){const l=Oi(r),c=Oi(i);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=vOe(r,i);return e.bounds==="ticks"&&_8(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return c0(e,this.chart.options.locale,this.options.ticks.format)}}class A1 extends D1{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Lt(e)?e:0,this.max=Lt(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Xr(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}X(A1,"id","linear"),X(A1,"defaults",{ticks:{callback:Bv.formatters.numeric}});const am=t=>Math.floor(ua(t)),xl=(t,e)=>Math.pow(10,am(t)+e);function zF(t){return t/Math.pow(10,am(t))===1}function BF(t,e,n){const s=Math.pow(10,n),r=Math.floor(t/s);return Math.ceil(e/s)-r}function SOe(t,e){const n=e-t;let s=am(n);for(;BF(t,e,s)>10;)s++;for(;BF(t,e,s)<10;)s--;return Math.min(s,am(t))}function kOe(t,{min:e,max:n}){e=Ks(t.min,e);const s=[],r=am(e);let i=SOe(e,n),o=i<0?Math.pow(10,Math.abs(i)):1;const a=Math.pow(10,i),l=r>i?Math.pow(10,r):0,c=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let h=Math.floor((c-u)/Math.pow(10,i)),d=Ks(t.min,Math.round((l+u+h*Math.pow(10,i))*o)/o);for(;d<n;)s.push({value:d,major:zF(d),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(i++,h=2,o=i>=0?1:o),d=Math.round((l+u+h*Math.pow(10,i))*o)/o;const f=Ks(t.max,d);return s.push({value:f,major:zF(f),significand:h}),s}class AC extends nu{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,n){const s=D1.prototype.parse.apply(this,[e,n]);if(s===0){this._zero=!0;return}return Lt(s)&&s>0?s:null}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Lt(e)?Math.max(0,e):null,this.max=Lt(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Lt(this._userMin)&&(this.min=e===xl(this.min,0)?xl(this.min,-1):xl(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let s=this.min,r=this.max;const i=a=>s=e?s:a,o=a=>r=n?r:a;s===r&&(s<=0?(i(1),o(10)):(i(xl(s,-1)),o(xl(r,1)))),s<=0&&i(xl(r,-1)),r<=0&&o(xl(s,1)),this.min=s,this.max=r}buildTicks(){const e=this.options,n={min:this._userMin,max:this._userMax},s=kOe(n,this);return e.bounds==="ticks"&&_8(s,this,"value"),e.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(e){return e===void 0?"0":c0(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=ua(e),this._valueRange=ua(this.max)-ua(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(ua(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const n=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+n*this._valueRange)}}X(AC,"id","logarithmic"),X(AC,"defaults",{ticks:{callback:Bv.formatters.logarithmic,major:{enabled:!0}}});function RC(t){const e=t.ticks;if(e.display&&t.display){const n=as(e.backdropPadding);return Ae(e.font&&e.font.size,zt.font.size)+n.height}return 0}function COe(t,e,n){return n=Nt(n)?n:[n],{w:FEe(t,e.string,n),h:n.length*e.lineHeight}}function VF(t,e,n,s,r){return t===s||t===r?{start:e-n/2,end:e+n/2}:t<s||t>r?{start:e-n,end:e}:{start:e,end:e+n}}function TOe(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),s=[],r=[],i=t._pointLabels.length,o=t.options.pointLabels,a=o.centerPointLabels?kt/i:0;for(let l=0;l<i;l++){const c=o.setContext(t.getPointLabelContext(l));r[l]=c.padding;const u=t.getPointPosition(l,t.drawingArea+r[l],a),h=bn(c.font),d=COe(t.ctx,h,t._pointLabels[l]);s[l]=d;const f=Qs(t.getIndexAngle(l)+a),p=Math.round(kE(f)),g=VF(p,u.x,d.w,0,180),m=VF(p,u.y,d.h,90,270);IOe(n,e,f,g,m)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=$Oe(t,s,r)}function IOe(t,e,n,s,r){const i=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,l=0;s.start<e.l?(a=(e.l-s.start)/i,t.l=Math.min(t.l,e.l-a)):s.end>e.r&&(a=(s.end-e.r)/i,t.r=Math.max(t.r,e.r+a)),r.start<e.t?(l=(e.t-r.start)/o,t.t=Math.min(t.t,e.t-l)):r.end>e.b&&(l=(r.end-e.b)/o,t.b=Math.max(t.b,e.b+l))}function NOe(t,e,n){const s=t.drawingArea,{extra:r,additionalAngle:i,padding:o,size:a}=n,l=t.getPointPosition(e,s+r+o,i),c=Math.round(kE(Qs(l.angle+Jt))),u=AOe(l.y,a.h,c),h=EOe(c),d=DOe(l.x,a.w,h);return{visible:!0,x:l.x,y:u,textAlign:h,left:d,top:u,right:d+a.w,bottom:u+a.h}}function _Oe(t,e){if(!e)return!0;const{left:n,top:s,right:r,bottom:i}=t;return!(ao({x:n,y:s},e)||ao({x:n,y:i},e)||ao({x:r,y:s},e)||ao({x:r,y:i},e))}function $Oe(t,e,n){const s=[],r=t._pointLabels.length,i=t.options,{centerPointLabels:o,display:a}=i.pointLabels,l={extra:RC(i)/2,additionalAngle:o?kt/r:0};let c;for(let u=0;u<r;u++){l.padding=n[u],l.size=e[u];const h=NOe(t,u,l);s.push(h),a==="auto"&&(h.visible=_Oe(h,c),h.visible&&(c=h))}return s}function EOe(t){return t===0||t===180?"center":t<180?"left":"right"}function DOe(t,e,n){return n==="right"?t-=e:n==="center"&&(t-=e/2),t}function AOe(t,e,n){return n===90||n===270?t-=e/2:(n>270||n<90)&&(t-=e),t}function ROe(t,e,n){const{left:s,top:r,right:i,bottom:o}=n,{backdropColor:a}=e;if(!Ke(a)){const l=Ql(e.borderRadius),c=as(e.backdropPadding);t.fillStyle=a;const u=s-c.left,h=r-c.top,d=i-s+c.width,f=o-r+c.height;Object.values(l).some(p=>p!==0)?(t.beginPath(),im(t,{x:u,y:h,w:d,h:f,radius:l}),t.fill()):t.fillRect(u,h,d,f)}}function OOe(t,e){const{ctx:n,options:{pointLabels:s}}=t;for(let r=e-1;r>=0;r--){const i=t._pointLabelItems[r];if(!i.visible)continue;const o=s.setContext(t.getPointLabelContext(r));ROe(n,o,i);const a=bn(o.font),{x:l,y:c,textAlign:u}=i;Ac(n,t._pointLabels[r],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function Sj(t,e,n,s){const{ctx:r}=t;if(n)r.arc(t.xCenter,t.yCenter,e,0,vt);else{let i=t.getPointPosition(0,e);r.moveTo(i.x,i.y);for(let o=1;o<s;o++)i=t.getPointPosition(o,e),r.lineTo(i.x,i.y)}}function POe(t,e,n,s,r){const i=t.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!s||!a||!l||n<0||(i.save(),i.strokeStyle=a,i.lineWidth=l,i.setLineDash(r.dash),i.lineDashOffset=r.dashOffset,i.beginPath(),Sj(t,n,o,s),i.closePath(),i.stroke(),i.restore())}function FOe(t,e,n){return cl(t,{label:n,index:e,type:"pointLabel"})}class Lf extends D1{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=as(RC(this.options)/2),n=this.width=this.maxWidth-e.width,s=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+n/2+e.left),this.yCenter=Math.floor(this.top+s/2+e.top),this.drawingArea=Math.floor(Math.min(n,s)/2)}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!1);this.min=Lt(e)&&!isNaN(e)?e:0,this.max=Lt(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/RC(this.options))}generateTickLabels(e){D1.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((n,s)=>{const r=dt(this.options.pointLabels.callback,[n,s],this);return r||r===0?r:""}).filter((n,s)=>this.chart.getDataVisibility(s))}fit(){const e=this.options;e.display&&e.pointLabels.display?TOe(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,n,s,r){this.xCenter+=Math.floor((e-n)/2),this.yCenter+=Math.floor((s-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,n,s,r))}getIndexAngle(e){const n=vt/(this._pointLabels.length||1),s=this.options.startAngle||0;return Qs(e*n+Xr(s))}getDistanceFromCenterForValue(e){if(Ke(e))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*n:(e-this.min)*n}getValueForDistanceFromCenter(e){if(Ke(e))return NaN;const n=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(e){const n=this._pointLabels||[];if(e>=0&&e<n.length){const s=n[e];return FOe(this.getContext(),e,s)}}getPointPosition(e,n,s=0){const r=this.getIndexAngle(e)-Jt+s;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(e,n){return this.getPointPosition(e,this.getDistanceFromCenterForValue(n))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:n,top:s,right:r,bottom:i}=this._pointLabelItems[e];return{left:n,top:s,right:r,bottom:i}}drawBackground(){const{backgroundColor:e,grid:{circular:n}}=this.options;if(e){const s=this.ctx;s.save(),s.beginPath(),Sj(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),s.closePath(),s.fillStyle=e,s.fill(),s.restore()}}drawGrid(){const e=this.ctx,n=this.options,{angleLines:s,grid:r,border:i}=n,o=this._pointLabels.length;let a,l,c;if(n.pointLabels.display&&OOe(this,o),r.display&&this.ticks.forEach((u,h)=>{if(h!==0||h===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const d=this.getContext(h),f=r.setContext(d),p=i.setContext(d);POe(this,f,l,o,p)}}),s.display){for(e.save(),a=o-1;a>=0;a--){const u=s.setContext(this.getPointLabelContext(a)),{color:h,lineWidth:d}=u;!d||!h||(e.lineWidth=d,e.strokeStyle=h,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,n=this.options,s=n.ticks;if(!s.display)return;const r=this.getIndexAngle(0);let i,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!n.reverse)return;const c=s.setContext(this.getContext(l)),u=bn(c.font);if(i=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const h=as(c.backdropPadding);e.fillRect(-o/2-h.left,-i-u.size/2-h.top,o+h.width,u.size+h.height)}Ac(e,a.label,0,-i,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),e.restore()}drawTitle(){}}X(Lf,"id","radialLinear"),X(Lf,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Bv.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),X(Lf,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),X(Lf,"descriptors",{angleLines:{_fallback:"grid"}});const jv={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Os=Object.keys(jv);function WF(t,e){return t-e}function UF(t,e){if(Ke(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),Lt(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(yh(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function jF(t,e,n,s){const r=Os.length;for(let i=Os.indexOf(t);i<r-1;++i){const o=jv[Os[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=s)return Os[i]}return Os[r-1]}function MOe(t,e,n,s,r){for(let i=Os.length-1;i>=Os.indexOf(n);i--){const o=Os[i];if(jv[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return Os[n?Os.indexOf(n):0]}function LOe(t){for(let e=Os.indexOf(t)+1,n=Os.length;e<n;++e)if(jv[Os[e]].common)return Os[e]}function HF(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=CE(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function zOe(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function GF(t,e,n){const s=[],r={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:zOe(t,s,r,n)}class lm extends nu{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new J8._date(e.adapters.date);r.init(n),ep(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:UF(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Lt(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Lt(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=kEe(r,i,o);return this._unit=n.unit||(s.autoSkip?jF(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):MOe(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:LOe(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),GF(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=An(n,0,o),s=An(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||jF(i.minUnit,n,s,this._getLabelCapacity(n)),a=Ae(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,c=yh(l)||l===!0,u={};let h=n,d,f;if(c&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,c?"day":o),e.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const p=r.ticks.source==="data"&&this.getDataTimestamps();for(d=h,f=0;d<s;d=+e.add(d,a,o),f++)HF(u,d,p);return(d===s||r.bounds==="ticks"||f===1)&&HF(u,d,p),Object.keys(u).sort(WF).map(g=>+g)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return dt(o,[e,n,s],this);const a=i.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],h=c&&a[c],d=s[n],f=c&&h&&d&&d.major;return this._adapter.format(e,r||(f?h:u))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=Xr(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,GF(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(UF(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return D8(e.sort(WF))}}X(lm,"id","time"),X(lm,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function hx(t,e,n){let s=0,r=t.length-1,i,o,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=oo(t,"pos",e)),{pos:i,time:a}=t[s],{pos:o,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=oo(t,"time",e)),{time:i,pos:a}=t[s],{time:o,pos:l}=t[r]);const c=o-i;return c?a+(l-a)*(e-i)/c:a}class OC extends lm{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=hx(n,this.min),this._tableRange=hx(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=n&&c<=s&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],l=r[o-1],c=r[o],Math.round((u+l)/2)!==c&&i.push({time:c,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(hx(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return hx(this._table,s*this._tableRange+this._minPos,!0)}}X(OC,"id","timeseries"),X(OC,"defaults",lm.defaults);var BOe=Object.freeze({__proto__:null,CategoryScale:E1,LinearScale:A1,LogarithmicScale:AC,RadialLinearScale:Lf,TimeScale:lm,TimeSeriesScale:OC});const kj=[QDe,IRe,xOe,BOe],Cj="label";function qF(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function VOe(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function Tj(t,e){t.labels=e}function Ij(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Cj;const s=[];t.datasets=e.map(r=>{const i=t.datasets.find(o=>o[n]===r[n]);return!i||!r.data||s.includes(i)?{...r}:(s.push(i),Object.assign(i,r),i)})}function WOe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cj;const n={labels:[],datasets:[]};return Tj(n,t.labels),Ij(n,t.datasets,e),n}function UOe(t,e){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:i,type:o,data:a,options:l,plugins:c=[],fallbackContent:u,updateMode:h,...d}=t,f=H.useRef(null),p=H.useRef(),g=()=>{f.current&&(p.current=new Gd(f.current,{type:o,data:WOe(a,i),options:l&&{...l},plugins:c}),qF(e,p.current))},m=()=>{qF(e,null),p.current&&(p.current.destroy(),p.current=null)};return H.useEffect(()=>{!r&&p.current&&l&&VOe(p.current,l)},[r,l]),H.useEffect(()=>{!r&&p.current&&Tj(p.current.config.data,a.labels)},[r,a.labels]),H.useEffect(()=>{!r&&p.current&&a.datasets&&Ij(p.current.config.data,a.datasets,i)},[r,a.datasets]),H.useEffect(()=>{p.current&&(r?(m(),setTimeout(g)):p.current.update(h))},[r,l,a.labels,a.datasets,h]),H.useEffect(()=>{p.current&&(m(),setTimeout(g))},[o]),H.useEffect(()=>(g(),()=>m()),[]),ze.createElement("canvas",Object.assign({ref:f,role:"img",height:n,width:s},d),u)}const jOe=H.forwardRef(UOe);function Nj(t,e){return Gd.register(e),H.forwardRef((n,s)=>ze.createElement(jOe,Object.assign({},n,{ref:s,type:t})))}const PC=Nj("bar",rp),Hx=Nj("scatter",op),_j=Ga;function R1(){const t=["expandDims","footer","absolute inset-0 bg-gradient-to-r from-white to-transparent opacity-20 rounded-2xl filter blur-lg","trim","input","gger","log","Loading data...","index","text-white text-xl mb-4","matMul","Doc ","scalar","stateObject","relative max-w-2xl w-full","rgba(75, 192, 192, 0.6)","relative bg-white bg-opacity-10 border border-white border-opacity-30 backdrop-filter backdrop-blur-xl rounded-2xl shadow-2xl p-8","tensor2d","test","button","w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-pink-500 hover:to-purple-500 transition duration-300 transform hover:scale-105 flex items-center justify-center","toFixed","div","string","All chunks loaded.","register","24771KlNIWj","easeInOutQuad","slice","106502TpcEnx","bg-blue-500 h-4 rounded-full","max-h-96","stringify","...","init","Results","all 0.5s ease-in-out","An unknown error occurred during chunk loading.","Enter","dispose","call","value","text","Chunk ","array","counter","1036EckMtW","function *\\( *\\)","1096036QPdUgl","white","rgba(255,255,255,0.1)","Type your query here...","message","27568clWwXc","opacity-100","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","text-white mt-2","squeeze","debu","documents","concat","round","text-5xl font-bold text-white mb-4","4100358yPeRAt","action","Cosine Similarity","bg-opacity-20","18ztgmSg","constructor","9YkpJlq","text-3xl font-semibold text-white mb-6","bg-white bg-opacity-20 p-4 rounded-lg shadow-lg hover:bg-opacity-30 transition-all duration-500 ease-in-out overflow-hidden ",": Similarity "," loaded.","apply","norm","similarity","max-h-32","mul","19556260WgVOXW","Discover relevant documents using Latent Semantic Analysis.","key","text-center mb-12","mt-8","length","Please enter a query.","An unknown error occurred during query processing.","scale-105 bg-opacity-40","map","mt-16 text-center text-gray-300","euclidean","mr-2","while (true) {}","sort","document","3503920IJluQK"];return R1=function(){return t},R1()}(function(t,e){const n=Ga,s=t();for(;;)try{if(parseInt(n(220))/1+-parseInt(n(162))/2*(-parseInt(n(217))/3)+parseInt(n(239))/4+parseInt(n(190))/5+parseInt(n(158))/6+-parseInt(n(237))/7*(-parseInt(n(244))/8)+-parseInt(n(164))/9*(parseInt(n(174))/10)===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(R1,393383);const HOe=function(){let t=!0;return function(e,n){const s=t?function(){if(n){const r=n.apply(e,arguments);return n=null,r}}:function(){};return t=!1,s}}();(function(){HOe(this,function(){const t=Ga,e=new RegExp(t(238)),n=new RegExp(t(246),"i"),s=KF(t(225));!e[t(209)](s+"chain")||!n[t(209)](s+"input")?s("0"):KF()})()})();Gd[_j(216)](E1,A1,ap,bj,vj,yj);function Ga(t,e){const n=R1();return Ga=function(s,r){return s=s-158,n[s]},Ga(t,e)}const lS=189;function GOe(){const t=_j,[e,n]=H.useState(""),[s,r]=H.useState(null),[i,o]=H.useState([]),[a,l]=H.useState(null),[c,u]=H.useState(!0),[h,d]=H.useState(0),[f,p]=H.useState({Vt:[],terms:[],U:[],documents:[]}),[g,m]=H.useState(null);H.useEffect(()=>{(async()=>{try{const w=await aZ();p({...w,U:[],documents:[]}),await x(0)}catch(w){w instanceof Error?m(w.message):m("An unknown error occurred while loading metadata.")}})()},[]);const x=async b=>{const w=Ga;try{console[w(197)]("Loading chunk "+b+w(224));const v=await cZ(b);console[w(197)](w(234)+b+w(168)),p(S=>({...S,U:S.U.concat(v.U),documents:S[w(250)][w(251)](v[w(250)])})),d(b+1),b+1<lS?await x(b+1):(u(!1),console.log(w(215)))}catch(v){v instanceof Error?m(v[w(243)]):m(w(228))}},y=async()=>{const b=Ga;if(!e[b(194)]()){m(b(180));return}m(null);try{const{U:w,Vt:v,terms:S,documents:T}=f,k=B$e(e,S,v),I=Rl[b(208)](w),_=Rl[b(201)](I,k[b(191)](1))[b(248)](),D=Rl[b(170)](I,b(185),1),A=Rl[b(170)](k),L=D[b(173)](A).add(Rl[b(203)](1e-8)),B=_[b(213)](L),F=await B[b(235)](),R=F[b(183)]((O,E)=>({index:E,similarity:O,document:T[E]}))[b(188)]((O,E)=>E[b(171)]-O.similarity)[b(219)](0,5);o(R),l({labels:R[b(183)](O=>b(202)+O[b(199)]),datasets:[{label:b(160),data:R[b(183)](O=>O.similarity),backgroundColor:b(206)}]}),I[b(230)](),_[b(230)](),B[b(230)]()}catch(w){w instanceof Error?m(w[b(243)]):m(b(181))}};return z.jsx(t(213),{className:"min-h-screen bg-gradient-to-br from-purple-600 via-pink-500 to-red-500 p-8 flex items-center justify-center",children:z.jsxs(t(213),{className:t(205),children:[z.jsx(t(213),{className:t(193)}),z.jsx(t(213),{className:t(207),children:c?z.jsxs(t(213),{className:"flex flex-col items-center justify-center min-h-screen",children:[z.jsx(t(213),{className:t(200),children:t(198)}),z.jsx(t(213),{className:"w-64 bg-gray-300 rounded-full h-4",children:z.jsx("div",{className:t(221),style:{width:h/lS*100+"%"}})}),z.jsxs(t(213),{className:t(247),children:[Math[t(252)](h/lS*100),"%"]})]}):z.jsxs(z.Fragment,{children:[z.jsxs("div",{className:t(177),children:[z.jsx("h1",{className:t(253),children:"LSA Search Engine"}),z.jsx("p",{className:"text-xl text-gray-200",children:t(175)})]}),z.jsx(t(195),{type:t(233),className:"w-full p-4 rounded mb-6 bg-white bg-opacity-30 placeholder-gray-200 text-white focus:outline-none focus:ring-2 focus:ring-purple-300 transition duration-300",placeholder:t(242),value:e,onChange:b=>n(b.target[t(232)]),onKeyDown:b=>{const w=t;b[w(176)]===w(229)&&y()}}),z.jsxs(t(210),{onClick:y,className:t(211),children:[z.jsx(DQ,{className:t(186)}),"Search"]}),g&&z.jsx(t(213),{className:"text-red-500 text-center mt-4",children:g}),i[t(179)]>0&&z.jsxs("div",{className:t(178),children:[z.jsx("h2",{className:t(165),children:t(226)}),z.jsx("ul",{children:i.map((b,w)=>z.jsx("li",{className:"mb-6 transform transition-all duration-500 ease-in-out "+t(w===s?182:161),onMouseEnter:()=>r(w),onMouseLeave:()=>r(null),children:z.jsxs("div",{className:t(166)+t(w===s?222:172),style:{transition:t(227)},children:[z.jsxs("p",{className:"text-white text-lg font-semibold",children:["Document ",b[t(199)],t(167),b.similarity[t(212)](4)]}),z.jsx("p",{className:"text-gray-200 mt-2 transition-opacity duration-500 "+(w===s?t(245):"opacity-50"),children:b[t(189)][t(233)]})]})},w))}),z.jsx(t(213),{className:t(178),children:z.jsx(PC,{data:a,options:{responsive:!0,scales:{x:{ticks:{color:t(240)},grid:{display:!1}},y:{ticks:{color:t(240)},grid:{color:t(241)}}},animation:{duration:1e3,easing:t(218)}}},JSON[t(223)](a))})]}),z.jsx(t(192),{className:t(184),children:"© 2024 Nathan Clark. All rights reserved."})]})})]})})}function KF(t){function e(n){const s=Ga;if(typeof n===s(214))return(function(r){})[s(163)](s(187)).apply(s(236));(""+n/n)[s(179)]!==1||n%20===0?(function(){return!0})[s(163)](s(249)+"gger")[s(231)](s(159)):(function(){return!1})[s(163)](s(249)+s(196))[s(169)](s(204)),e(++n)}try{if(t)return e;e(0)}catch{}}const $j=Ds;(function(t,e){const n=Ds,s=t();for(;;)try{if(-parseInt(n(126))/1*(parseInt(n(170))/2)+-parseInt(n(116))/3+parseInt(n(188))/4+parseInt(n(154))/5+-parseInt(n(171))/6*(parseInt(n(132))/7)+-parseInt(n(149))/8*(parseInt(n(135))/9)+parseInt(n(166))/10===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(O1,693865);const qOe=function(){let t=!0;return function(e,n){const s=t?function(){const r=Ds;if(n){const i=n[r(155)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){qOe(this,function(){const t=Ds,e=new RegExp(t(141)),n=new RegExp(t(181),"i"),s=XF("init");!e[t(157)](s+t(180))||!n.test(s+t(147))?s("0"):XF()})()})();function O1(){const t=["45649830IJNjrh","constructor","Data Points","Number of Simulations (S):","44zDNbZe","79446YLXVtG","rgba(255, 159, 64, 0.6)","form","preventDefault","Mean (μ):","text-xl font-semibold mt-6","max","action","from","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","submit","abs","Slope Bins","string","button","gger","482356sPWGCy","cos","Variance (σ²):","line","mt-6 p-6 bg-gray-800 text-white rounded-lg","filter","number","sigma2","div","3860142UnJBdS","Intercepts","Proportion of intercepts more extreme than calculated intercept: ","value","Generate","log","fill","label","forEach","counter","56458dOmTQO","length","w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded","register","bins","sqrt","539lNxlbl","toFixed","Slopes","1656rHBtnA","map","Sample Size (N):","block font-medium","mt-4","input w-full p-2 rounded bg-gray-700 text-white","function *\\( *\\)","reduce","Frequency","rgba(255, 99, 132, 1)","any","push","input","min","22416aLsGel","text-2xl font-semibold mb-4","rgba(54, 162, 235, 0.6)","stateObject","Histogram of Slopes","361040brNeyI","apply","floor","test","target","random","space-y-4","debu","counts","X + ","results mt-8","slopeHistogramData"];return O1=function(){return t},O1()}Gd[$j(129)](...kj);function KOe(){const t=$j,[e,n]=H.useState(100),[s,r]=H.useState(0),[i,o]=H.useState(1),[a,l]=H.useState(1e3),[c,u]=H.useState(null),[h,d]=H.useState(null),[f,p]=H.useState(0),[g,m]=H.useState(0),[x,y]=H.useState(!1),b=A=>{A[Ds(174)](),D(e,s,i,a)};function w(){const A=Ds;let L=0,B=0;for(;L===0;)L=Math.random();for(;B===0;)B=Math[A(159)]();return Math[A(131)](-2*Math[A(121)](L))*Math[A(189)](2*Math.PI*B)}function v(A,L){return A+L*w()}function S(A,L){const B=T(A),F=T(L),R=k(A,B),O=I(A,L,B,F),E=O/R,V=F-E*B;return{slope:E,intercept:V}}function T(A){const L=Ds;return A.reduce((B,F)=>B+F,0)/A[L(127)]}function k(A,L){const B=Ds;return A[B(142)]((F,R)=>F+(R-L)**2,0)/A[B(127)]}function I(A,L,B,F){const R=Ds;let O=0;for(let E=0;E<A.length;E++)O+=(A[E]-B)*(L[E]-F);return O/A[R(127)]}function _(A,L){const B=Ds,F=Math[B(148)](...A),R=Math[B(177)](...A),O=(R-F)/L,E=Array[B(179)]({length:L},(G,Y)=>F+Y*O),V=Array(L)[B(122)](0);return A[B(124)](G=>{let Z=Math[B(156)]((G-F)/O);Z===L&&Z--,V[Z]++}),{bins:E,counts:V}}const D=(A,L,B,F)=>{const R=Ds,O=Array[R(179)]({length:A},()=>Math[R(159)]()),E=Math[R(131)](B),V=O[R(136)](Ne=>v(L,E)),{slope:G,intercept:Y}=S(O,V),Z={datasets:[{label:R(168),data:O[R(136)]((Ne,Xe)=>({x:Ne,y:V[Xe]})),backgroundColor:R(151)},{label:"Regression Line: Y = "+G[R(133)](2)+R(163)+Y[R(133)](2),data:[{x:Math[R(148)](...O),y:G*Math[R(148)](...O)+Y},{x:Math[R(177)](...O),y:G*Math[R(177)](...O)+Y}],type:R(191),borderColor:R(144),borderWidth:2,fill:!1,pointRadius:0}]},ee=[],te=[];for(let Ne=0;Ne<F;Ne++){const Xe=Array[R(179)]({length:A},()=>Math[R(159)]()),gt=Xe[R(136)](ht=>ht+v(L,E)),{slope:et,intercept:Ye}=S(Xe,gt);ee[R(146)](et),te[R(146)](Ye)}const ne=20,ie=_(ee,ne),ce=_(te,ne),ye={labels:ie[R(130)][R(136)](Ne=>Ne.toFixed(2)),datasets:[{label:R(134),data:ie[R(162)],backgroundColor:R(151)}]},ve={labels:ce[R(130)][R(136)](Ne=>Ne[R(133)](2)),datasets:[{label:R(117),data:ce[R(162)],backgroundColor:R(172)}]},Ie=ee[R(112)](Ne=>Math[R(183)](Ne)>Math[R(183)](G))[R(127)]/F*100,$e=te[R(112)](Ne=>Math[R(183)](Ne)>Math[R(183)](Y))[R(127)]/F*100;u(Z),d({slopeHistogramData:ye,interceptHistogramData:ve}),p(Ie),m($e),y(!0)};return z.jsxs(t(115),{className:t(111),children:[z.jsx("h1",{className:t(150),children:"Interactive Linear Regression Assumptions"}),z.jsxs(t(173),{onSubmit:b,className:t(160),children:[z.jsxs(t(115),{children:[z.jsx(t(123),{htmlFor:"N",className:"block font-medium",children:t(137)}),z.jsx(t(147),{type:"number",id:"N",name:"N",required:!0,className:t(140),value:e,onChange:A=>n(parseInt(A[t(158)][t(119)]))})]}),z.jsxs("div",{children:[z.jsx(t(123),{htmlFor:"mu",className:t(138),children:t(175)}),z.jsx("input",{type:t(113),step:t(145),id:"mu",name:"mu",required:!0,className:t(140),value:s,onChange:A=>r(parseFloat(A[t(158)][t(119)]))})]}),z.jsxs(t(115),{children:[z.jsx(t(123),{htmlFor:t(114),className:t(138),children:t(190)}),z.jsx(t(147),{type:t(113),step:t(145),id:t(114),name:t(114),required:!0,className:t(140),value:i,onChange:A=>o(parseFloat(A[t(158)][t(119)]))})]}),z.jsxs(t(115),{children:[z.jsx(t(123),{htmlFor:"S",className:t(138),children:t(169)}),z.jsx(t(147),{type:"number",id:"S",name:"S",required:!0,className:t(140),value:a,onChange:A=>l(parseInt(A.target[t(119)]))})]}),z.jsx(t(186),{type:t(182),className:t(128),children:t(120)})]}),x&&z.jsxs(t(115),{className:t(164),children:[z.jsx("h2",{className:t(176),children:"Generated Plot"}),z.jsx(t(115),{className:t(139),children:z.jsx(Hx,{data:c,options:{scales:{x:{title:{display:!0,text:"X"}},y:{title:{display:!0,text:"Y"}}}}})}),z.jsx("h2",{className:t(176),children:t(153)}),z.jsx(t(115),{className:t(139),children:z.jsx(PC,{data:h[t(165)],options:{scales:{x:{title:{display:!0,text:t(184)}},y:{title:{display:!0,text:t(143)}}}}})}),z.jsx("h2",{className:"text-xl font-semibold mt-6",children:"Histogram of Intercepts"}),z.jsx(t(115),{className:"mt-4",children:z.jsx(PC,{data:h.interceptHistogramData,options:{scales:{x:{title:{display:!0,text:"Intercept Bins"}},y:{title:{display:!0,text:t(143)}}}}})}),z.jsxs("p",{className:t(139),children:["Proportion of slopes more extreme than calculated slope: ",f[t(133)](2),"%"]}),z.jsxs("p",{children:[t(118),g[t(133)](2),"%"]})]})]})}function Ds(t,e){const n=O1();return Ds=function(s,r){return s=s-111,n[s]},Ds(t,e)}function XF(t){function e(n){const s=Ds;if(typeof n===s(185))return(function(r){})[s(167)]("while (true) {}")[s(155)](s(125));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(167)](s(161)+s(187)).call(s(178)):(function(){return!1})[s(167)]("debu"+s(187))[s(155)](s(152)),e(++n)}try{if(t)return e;e(0)}catch{}}const Ej=6048e5,XOe=864e5,h0=6e4,d0=36e5,YOe=1e3,YF=Symbol.for("constructDateFrom");function Ut(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&YF in t?t[YF](e):t instanceof Date?new t.constructor(e):new Date(e)}function _e(t,e){return Ut(e||t,t)}function Hv(t,e,n){const s=_e(t,n==null?void 0:n.in);return isNaN(e)?Ut((n==null?void 0:n.in)||t,NaN):(e&&s.setDate(s.getDate()+e),s)}function FE(t,e,n){const s=_e(t,n==null?void 0:n.in);if(isNaN(e))return Ut(t,NaN);if(!e)return s;const r=s.getDate(),i=Ut(t,s.getTime());i.setMonth(s.getMonth()+e+1,0);const o=i.getDate();return r>=o?i:(s.setFullYear(i.getFullYear(),i.getMonth(),r),s)}function ME(t,e,n){return Ut(t,+_e(t)+e)}function QOe(t,e,n){return ME(t,e*d0)}let ZOe={};function su(){return ZOe}function Bi(t,e){var a,l,c,u;const n=su(),s=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,r=_e(t,e==null?void 0:e.in),i=r.getDay(),o=(i<s?7:0)+i-s;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function vh(t,e){return Bi(t,{...e,weekStartsOn:1})}function Dj(t,e){const n=_e(t,e==null?void 0:e.in),s=n.getFullYear(),r=Ut(n,0);r.setFullYear(s+1,0,4),r.setHours(0,0,0,0);const i=vh(r),o=Ut(n,0);o.setFullYear(s,0,4),o.setHours(0,0,0,0);const a=vh(o);return n.getTime()>=i.getTime()?s+1:n.getTime()>=a.getTime()?s:s-1}function P1(t){const e=_e(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function ru(t,...e){const n=Ut.bind(null,e.find(s=>typeof s=="object"));return e.map(n)}function FC(t,e){const n=_e(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function Aj(t,e,n){const[s,r]=ru(n==null?void 0:n.in,t,e),i=FC(s),o=FC(r),a=+i-P1(i),l=+o-P1(o);return Math.round((a-l)/XOe)}function JOe(t,e){const n=Dj(t,e),s=Ut(t,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),vh(s)}function ePe(t,e,n){const s=_e(t,n==null?void 0:n.in);return s.setTime(s.getTime()+e*h0),s}function tPe(t,e,n){return FE(t,e*3,n)}function nPe(t,e,n){return ME(t,e*1e3)}function sPe(t,e,n){return Hv(t,e*7,n)}function rPe(t,e,n){return FE(t,e*12,n)}function lp(t,e){const n=+_e(t)-+_e(e);return n<0?-1:n>0?1:n}function iPe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Rj(t){return!(!iPe(t)&&typeof t!="number"||isNaN(+_e(t)))}function oPe(t,e,n){const[s,r]=ru(n==null?void 0:n.in,t,e),i=s.getFullYear()-r.getFullYear(),o=s.getMonth()-r.getMonth();return i*12+o}function aPe(t,e,n){const[s,r]=ru(n==null?void 0:n.in,t,e);return s.getFullYear()-r.getFullYear()}function Oj(t,e,n){const[s,r]=ru(n==null?void 0:n.in,t,e),i=QF(s,r),o=Math.abs(Aj(s,r));s.setDate(s.getDate()-i*o);const a=+(QF(s,r)===-i),l=i*(o-a);return l===0?0:l}function QF(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function f0(t){return e=>{const s=(t?Math[t]:Math.trunc)(e);return s===0?0:s}}function lPe(t,e,n){const[s,r]=ru(n==null?void 0:n.in,t,e),i=(+s-+r)/d0;return f0(n==null?void 0:n.roundingMethod)(i)}function LE(t,e){return+_e(t)-+_e(e)}function cPe(t,e,n){const s=LE(t,e)/h0;return f0(n==null?void 0:n.roundingMethod)(s)}function Pj(t,e){const n=_e(t,e==null?void 0:e.in);return n.setHours(23,59,59,999),n}function Fj(t,e){const n=_e(t,e==null?void 0:e.in),s=n.getMonth();return n.setFullYear(n.getFullYear(),s+1,0),n.setHours(23,59,59,999),n}function uPe(t,e){const n=_e(t,e==null?void 0:e.in);return+Pj(n,e)==+Fj(n,e)}function Mj(t,e,n){const[s,r,i]=ru(n==null?void 0:n.in,t,t,e),o=lp(r,i),a=Math.abs(oPe(r,i));if(a<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-o*a);let l=lp(r,i)===-o;uPe(s)&&a===1&&lp(s,i)===1&&(l=!1);const c=o*(a-+l);return c===0?0:c}function hPe(t,e,n){const s=Mj(t,e,n)/3;return f0(n==null?void 0:n.roundingMethod)(s)}function dPe(t,e,n){const s=LE(t,e)/1e3;return f0(n==null?void 0:n.roundingMethod)(s)}function fPe(t,e,n){const s=Oj(t,e,n)/7;return f0(n==null?void 0:n.roundingMethod)(s)}function pPe(t,e,n){const[s,r]=ru(n==null?void 0:n.in,t,e),i=lp(s,r),o=Math.abs(aPe(s,r));s.setFullYear(1584),r.setFullYear(1584);const a=lp(s,r)===-i,l=i*(o-+a);return l===0?0:l}function mPe(t,e){const n=_e(t,e==null?void 0:e.in),s=n.getMonth(),r=s-s%3;return n.setMonth(r,1),n.setHours(0,0,0,0),n}function gPe(t,e){const n=_e(t,e==null?void 0:e.in);return n.setDate(1),n.setHours(0,0,0,0),n}function xPe(t,e){const n=_e(t,e==null?void 0:e.in),s=n.getFullYear();return n.setFullYear(s+1,0,0),n.setHours(23,59,59,999),n}function Lj(t,e){const n=_e(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function yPe(t,e){const n=_e(t,e==null?void 0:e.in);return n.setMinutes(59,59,999),n}function bPe(t,e){var a,l;const n=su(),s=n.weekStartsOn??((l=(a=n.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??0,r=_e(t,e==null?void 0:e.in),i=r.getDay(),o=(i<s?-7:0)+6-(i-s);return r.setDate(r.getDate()+o),r.setHours(23,59,59,999),r}function wPe(t,e){const n=_e(t,e==null?void 0:e.in);return n.setSeconds(59,999),n}function vPe(t,e){const n=_e(t,e==null?void 0:e.in),s=n.getMonth(),r=s-s%3+3;return n.setMonth(r,0),n.setHours(23,59,59,999),n}function SPe(t,e){const n=_e(t,e==null?void 0:e.in);return n.setMilliseconds(999),n}const kPe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},CPe=(t,e,n)=>{let s;const r=kPe[t];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function cS(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const TPe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},IPe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},NPe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_Pe={date:cS({formats:TPe,defaultWidth:"full"}),time:cS({formats:IPe,defaultWidth:"full"}),dateTime:cS({formats:NPe,defaultWidth:"full"})},$Pe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},EPe=(t,e,n,s)=>$Pe[t];function mf(t){return(e,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let r;if(s==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):o;r=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=n!=null&&n.width?String(n.width):t.defaultWidth;r=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return r[i]}}const DPe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},APe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},RPe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},OPe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},PPe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},FPe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},MPe=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},LPe={ordinalNumber:MPe,era:mf({values:DPe,defaultWidth:"wide"}),quarter:mf({values:APe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:mf({values:RPe,defaultWidth:"wide"}),day:mf({values:OPe,defaultWidth:"wide"}),dayPeriod:mf({values:PPe,defaultWidth:"wide",formattingValues:FPe,defaultFormattingWidth:"wide"})};function gf(t){return(e,n={})=>{const s=n.width,r=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=e.match(r);if(!i)return null;const o=i[0],a=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?BPe(a,h=>h.test(o)):zPe(a,h=>h.test(o));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=e.slice(o.length);return{value:c,rest:u}}}function zPe(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function BPe(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function VPe(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const r=s[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const a=e.slice(r.length);return{value:o,rest:a}}}const WPe=/^(\d+)(th|st|nd|rd)?/i,UPe=/\d+/i,jPe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},HPe={any:[/^b/i,/^(a|c)/i]},GPe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},qPe={any:[/1/i,/2/i,/3/i,/4/i]},KPe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},XPe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},YPe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},QPe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},ZPe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},JPe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},eFe={ordinalNumber:VPe({matchPattern:WPe,parsePattern:UPe,valueCallback:t=>parseInt(t,10)}),era:gf({matchPatterns:jPe,defaultMatchWidth:"wide",parsePatterns:HPe,defaultParseWidth:"any"}),quarter:gf({matchPatterns:GPe,defaultMatchWidth:"wide",parsePatterns:qPe,defaultParseWidth:"any",valueCallback:t=>t+1}),month:gf({matchPatterns:KPe,defaultMatchWidth:"wide",parsePatterns:XPe,defaultParseWidth:"any"}),day:gf({matchPatterns:YPe,defaultMatchWidth:"wide",parsePatterns:QPe,defaultParseWidth:"any"}),dayPeriod:gf({matchPatterns:ZPe,defaultMatchWidth:"any",parsePatterns:JPe,defaultParseWidth:"any"})},zj={code:"en-US",formatDistance:CPe,formatLong:_Pe,formatRelative:EPe,localize:LPe,match:eFe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function tFe(t,e){const n=_e(t,e==null?void 0:e.in);return Aj(n,Lj(n))+1}function Bj(t,e){const n=_e(t,e==null?void 0:e.in),s=+vh(n)-+JOe(n);return Math.round(s/Ej)+1}function zE(t,e){var u,h,d,f;const n=_e(t,e==null?void 0:e.in),s=n.getFullYear(),r=su(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(d=r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,o=Ut((e==null?void 0:e.in)||t,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const a=Bi(o,e),l=Ut((e==null?void 0:e.in)||t,0);l.setFullYear(s,0,i),l.setHours(0,0,0,0);const c=Bi(l,e);return+n>=+a?s+1:+n>=+c?s:s-1}function nFe(t,e){var a,l,c,u;const n=su(),s=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,r=zE(t,e),i=Ut((e==null?void 0:e.in)||t,0);return i.setFullYear(r,0,s),i.setHours(0,0,0,0),Bi(i,e)}function Vj(t,e){const n=_e(t,e==null?void 0:e.in),s=+Bi(n,e)-+nFe(n,e);return Math.round(s/Ej)+1}function tt(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const Go={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return tt(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):tt(n+1,2)},d(t,e){return tt(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return tt(t.getHours()%12||12,e.length)},H(t,e){return tt(t.getHours(),e.length)},m(t,e){return tt(t.getMinutes(),e.length)},s(t,e){return tt(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),r=Math.trunc(s*Math.pow(10,n-3));return tt(r,e.length)}},uu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ZF={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),r=s>0?s:1-s;return n.ordinalNumber(r,{unit:"year"})}return Go.y(t,e)},Y:function(t,e,n,s){const r=zE(t,s),i=r>0?r:1-r;if(e==="YY"){const o=i%100;return tt(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):tt(i,e.length)},R:function(t,e){const n=Dj(t);return tt(n,e.length)},u:function(t,e){const n=t.getFullYear();return tt(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return tt(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return tt(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return Go.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return tt(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const r=Vj(t,s);return e==="wo"?n.ordinalNumber(r,{unit:"week"}):tt(r,e.length)},I:function(t,e,n){const s=Bj(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):tt(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Go.d(t,e)},D:function(t,e,n){const s=tFe(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):tt(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return tt(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return tt(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return tt(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let r;switch(s===12?r=uu.noon:s===0?r=uu.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let r;switch(s>=17?r=uu.evening:s>=12?r=uu.afternoon:s>=4?r=uu.morning:r=uu.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return Go.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Go.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):tt(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):tt(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Go.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Go.s(t,e)},S:function(t,e){return Go.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return e3(s);case"XXXX":case"XX":return Nl(s);case"XXXXX":case"XXX":default:return Nl(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return e3(s);case"xxxx":case"xx":return Nl(s);case"xxxxx":case"xxx":default:return Nl(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+JF(s,":");case"OOOO":default:return"GMT"+Nl(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+JF(s,":");case"zzzz":default:return"GMT"+Nl(s,":")}},t:function(t,e,n){const s=Math.trunc(+t/1e3);return tt(s,e.length)},T:function(t,e,n){return tt(+t,e.length)}};function JF(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=Math.trunc(s/60),i=s%60;return i===0?n+String(r):n+String(r)+e+tt(i,2)}function e3(t,e){return t%60===0?(t>0?"-":"+")+tt(Math.abs(t)/60,2):Nl(t,e)}function Nl(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=tt(Math.trunc(s/60),2),i=tt(s%60,2);return n+r+e+i}const t3=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Wj=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},sFe=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],r=n[2];if(!r)return t3(t,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",t3(s,e)).replace("{{time}}",Wj(r,e))},MC={p:Wj,P:sFe},rFe=/^D+$/,iFe=/^Y+$/,oFe=["D","DD","YY","YYYY"];function Uj(t){return rFe.test(t)}function jj(t){return iFe.test(t)}function LC(t,e,n){const s=aFe(t,e,n);if(console.warn(s),oFe.includes(t))throw new RangeError(s)}function aFe(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const lFe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,cFe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,uFe=/^'([^]*?)'?$/,hFe=/''/g,dFe=/[a-zA-Z]/;function fFe(t,e,n){var u,h,d,f,p,g,m,x;const s=su(),r=(n==null?void 0:n.locale)??s.locale??zj,i=(n==null?void 0:n.firstWeekContainsDate)??((h=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((f=(d=s.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,o=(n==null?void 0:n.weekStartsOn)??((g=(p=n==null?void 0:n.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??s.weekStartsOn??((x=(m=s.locale)==null?void 0:m.options)==null?void 0:x.weekStartsOn)??0,a=_e(t,n==null?void 0:n.in);if(!Rj(a))throw new RangeError("Invalid time value");let l=e.match(cFe).map(y=>{const b=y[0];if(b==="p"||b==="P"){const w=MC[b];return w(y,r.formatLong)}return y}).join("").match(lFe).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const b=y[0];if(b==="'")return{isToken:!1,value:pFe(y)};if(ZF[b])return{isToken:!0,value:y};if(b.match(dFe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:y}});r.localize.preprocessor&&(l=r.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:r};return l.map(y=>{if(!y.isToken)return y.value;const b=y.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&jj(b)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&Uj(b))&&LC(b,e,String(t));const w=ZF[b[0]];return w(a,b,r.localize,c)}).join("")}function pFe(t){const e=t.match(uFe);return e?e[1].replace(hFe,"'"):t}function mFe(){return Object.assign({},su())}function gFe(t,e){const n=_e(t,e==null?void 0:e.in).getDay();return n===0?7:n}function xFe(t,e){const n=yFe(e)?new e(0):Ut(e,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n}function yFe(t){var e;return typeof t=="function"&&((e=t.prototype)==null?void 0:e.constructor)===t}const bFe=10;class Hj{constructor(){X(this,"subPriority",0)}validate(e,n){return!0}}class wFe extends Hj{constructor(e,n,s,r,i){super(),this.value=e,this.validateValue=n,this.setValue=s,this.priority=r,i&&(this.subPriority=i)}validate(e,n){return this.validateValue(e,this.value,n)}set(e,n,s){return this.setValue(e,n,this.value,s)}}class vFe extends Hj{constructor(n,s){super();X(this,"priority",bFe);X(this,"subPriority",-1);this.context=n||(r=>Ut(s,r))}set(n,s){return s.timestampIsSet?n:Ut(n,xFe(n,this.context))}}class Qe{run(e,n,s,r){const i=this.parse(e,n,s,r);return i?{setter:new wFe(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(e,n,s){return!0}}class SFe extends Qe{constructor(){super(...arguments);X(this,"priority",140);X(this,"incompatibleTokens",["R","u","t","T"])}parse(n,s,r){switch(s){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,s,r){return s.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}}const en={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Si={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function tn(t,e){return t&&{value:e(t.value),rest:t.rest}}function Rt(t,e){const n=e.match(t);return n?{value:parseInt(n[0],10),rest:e.slice(n[0].length)}:null}function ki(t,e){const n=e.match(t);if(!n)return null;if(n[0]==="Z")return{value:0,rest:e.slice(1)};const s=n[1]==="+"?1:-1,r=n[2]?parseInt(n[2],10):0,i=n[3]?parseInt(n[3],10):0,o=n[5]?parseInt(n[5],10):0;return{value:s*(r*d0+i*h0+o*YOe),rest:e.slice(n[0].length)}}function Gj(t){return Rt(en.anyDigitsSigned,t)}function jt(t,e){switch(t){case 1:return Rt(en.singleDigit,e);case 2:return Rt(en.twoDigits,e);case 3:return Rt(en.threeDigits,e);case 4:return Rt(en.fourDigits,e);default:return Rt(new RegExp("^\\d{1,"+t+"}"),e)}}function F1(t,e){switch(t){case 1:return Rt(en.singleDigitSigned,e);case 2:return Rt(en.twoDigitsSigned,e);case 3:return Rt(en.threeDigitsSigned,e);case 4:return Rt(en.fourDigitsSigned,e);default:return Rt(new RegExp("^-?\\d{1,"+t+"}"),e)}}function BE(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function qj(t,e){const n=e>0,s=n?e:1-e;let r;if(s<=50)r=t||100;else{const i=s+50,o=Math.trunc(i/100)*100,a=t>=i%100;r=t+o-(a?100:0)}return n?r:1-r}function Kj(t){return t%400===0||t%4===0&&t%100!==0}class kFe extends Qe{constructor(){super(...arguments);X(this,"priority",130);X(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(n,s,r){const i=o=>({year:o,isTwoDigitYear:s==="yy"});switch(s){case"y":return tn(jt(4,n),i);case"yo":return tn(r.ordinalNumber(n,{unit:"year"}),i);default:return tn(jt(s.length,n),i)}}validate(n,s){return s.isTwoDigitYear||s.year>0}set(n,s,r){const i=n.getFullYear();if(r.isTwoDigitYear){const a=qj(r.year,i);return n.setFullYear(a,0,1),n.setHours(0,0,0,0),n}const o=!("era"in s)||s.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class CFe extends Qe{constructor(){super(...arguments);X(this,"priority",130);X(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(n,s,r){const i=o=>({year:o,isTwoDigitYear:s==="YY"});switch(s){case"Y":return tn(jt(4,n),i);case"Yo":return tn(r.ordinalNumber(n,{unit:"year"}),i);default:return tn(jt(s.length,n),i)}}validate(n,s){return s.isTwoDigitYear||s.year>0}set(n,s,r,i){const o=zE(n,i);if(r.isTwoDigitYear){const l=qj(r.year,o);return n.setFullYear(l,0,i.firstWeekContainsDate),n.setHours(0,0,0,0),Bi(n,i)}const a=!("era"in s)||s.era===1?r.year:1-r.year;return n.setFullYear(a,0,i.firstWeekContainsDate),n.setHours(0,0,0,0),Bi(n,i)}}class TFe extends Qe{constructor(){super(...arguments);X(this,"priority",130);X(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(n,s){return F1(s==="R"?4:s.length,n)}set(n,s,r){const i=Ut(n,0);return i.setFullYear(r,0,4),i.setHours(0,0,0,0),vh(i)}}class IFe extends Qe{constructor(){super(...arguments);X(this,"priority",130);X(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(n,s){return F1(s==="u"?4:s.length,n)}set(n,s,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}}class NFe extends Qe{constructor(){super(...arguments);X(this,"priority",120);X(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(n,s,r){switch(s){case"Q":case"QQ":return jt(s.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,s){return s>=1&&s<=4}set(n,s,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}}class _Fe extends Qe{constructor(){super(...arguments);X(this,"priority",120);X(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(n,s,r){switch(s){case"q":case"qq":return jt(s.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,s){return s>=1&&s<=4}set(n,s,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}}class $Fe extends Qe{constructor(){super(...arguments);X(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);X(this,"priority",110)}parse(n,s,r){const i=o=>o-1;switch(s){case"M":return tn(Rt(en.month,n),i);case"MM":return tn(jt(2,n),i);case"Mo":return tn(r.ordinalNumber(n,{unit:"month"}),i);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,s){return s>=0&&s<=11}set(n,s,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class EFe extends Qe{constructor(){super(...arguments);X(this,"priority",110);X(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(n,s,r){const i=o=>o-1;switch(s){case"L":return tn(Rt(en.month,n),i);case"LL":return tn(jt(2,n),i);case"Lo":return tn(r.ordinalNumber(n,{unit:"month"}),i);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,s){return s>=0&&s<=11}set(n,s,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}function DFe(t,e,n){const s=_e(t,n==null?void 0:n.in),r=Vj(s,n)-e;return s.setDate(s.getDate()-r*7),_e(s,n==null?void 0:n.in)}class AFe extends Qe{constructor(){super(...arguments);X(this,"priority",100);X(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(n,s,r){switch(s){case"w":return Rt(en.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return jt(s.length,n)}}validate(n,s){return s>=1&&s<=53}set(n,s,r,i){return Bi(DFe(n,r,i),i)}}function RFe(t,e,n){const s=_e(t,n==null?void 0:n.in),r=Bj(s,n)-e;return s.setDate(s.getDate()-r*7),s}class OFe extends Qe{constructor(){super(...arguments);X(this,"priority",100);X(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(n,s,r){switch(s){case"I":return Rt(en.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return jt(s.length,n)}}validate(n,s){return s>=1&&s<=53}set(n,s,r){return vh(RFe(n,r))}}const PFe=[31,28,31,30,31,30,31,31,30,31,30,31],FFe=[31,29,31,30,31,30,31,31,30,31,30,31];class MFe extends Qe{constructor(){super(...arguments);X(this,"priority",90);X(this,"subPriority",1);X(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(n,s,r){switch(s){case"d":return Rt(en.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return jt(s.length,n)}}validate(n,s){const r=n.getFullYear(),i=Kj(r),o=n.getMonth();return i?s>=1&&s<=FFe[o]:s>=1&&s<=PFe[o]}set(n,s,r){return n.setDate(r),n.setHours(0,0,0,0),n}}class LFe extends Qe{constructor(){super(...arguments);X(this,"priority",90);X(this,"subpriority",1);X(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(n,s,r){switch(s){case"D":case"DD":return Rt(en.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return jt(s.length,n)}}validate(n,s){const r=n.getFullYear();return Kj(r)?s>=1&&s<=366:s>=1&&s<=365}set(n,s,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}}function VE(t,e,n){var h,d,f,p;const s=su(),r=(n==null?void 0:n.weekStartsOn)??((d=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:d.weekStartsOn)??s.weekStartsOn??((p=(f=s.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??0,i=_e(t,n==null?void 0:n.in),o=i.getDay(),l=(e%7+7)%7,c=7-r,u=e<0||e>6?e-(o+c)%7:(l+c)%7-(o+c)%7;return Hv(i,u,n)}class zFe extends Qe{constructor(){super(...arguments);X(this,"priority",90);X(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(n,s,r){switch(s){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,s){return s>=0&&s<=6}set(n,s,r,i){return n=VE(n,r,i),n.setHours(0,0,0,0),n}}class BFe extends Qe{constructor(){super(...arguments);X(this,"priority",90);X(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(n,s,r,i){const o=a=>{const l=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+l};switch(s){case"e":case"ee":return tn(jt(s.length,n),o);case"eo":return tn(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,s){return s>=0&&s<=6}set(n,s,r,i){return n=VE(n,r,i),n.setHours(0,0,0,0),n}}class VFe extends Qe{constructor(){super(...arguments);X(this,"priority",90);X(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(n,s,r,i){const o=a=>{const l=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+l};switch(s){case"c":case"cc":return tn(jt(s.length,n),o);case"co":return tn(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,s){return s>=0&&s<=6}set(n,s,r,i){return n=VE(n,r,i),n.setHours(0,0,0,0),n}}function WFe(t,e,n){const s=_e(t,n==null?void 0:n.in),r=gFe(s,n),i=e-r;return Hv(s,i,n)}class UFe extends Qe{constructor(){super(...arguments);X(this,"priority",90);X(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(n,s,r){const i=o=>o===0?7:o;switch(s){case"i":case"ii":return jt(s.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return tn(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),i);case"iiiii":return tn(r.day(n,{width:"narrow",context:"formatting"}),i);case"iiiiii":return tn(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),i);case"iiii":default:return tn(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),i)}}validate(n,s){return s>=1&&s<=7}set(n,s,r){return n=WFe(n,r),n.setHours(0,0,0,0),n}}class jFe extends Qe{constructor(){super(...arguments);X(this,"priority",80);X(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(n,s,r){switch(s){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,s,r){return n.setHours(BE(r),0,0,0),n}}class HFe extends Qe{constructor(){super(...arguments);X(this,"priority",80);X(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(n,s,r){switch(s){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,s,r){return n.setHours(BE(r),0,0,0),n}}class GFe extends Qe{constructor(){super(...arguments);X(this,"priority",80);X(this,"incompatibleTokens",["a","b","t","T"])}parse(n,s,r){switch(s){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,s,r){return n.setHours(BE(r),0,0,0),n}}class qFe extends Qe{constructor(){super(...arguments);X(this,"priority",70);X(this,"incompatibleTokens",["H","K","k","t","T"])}parse(n,s,r){switch(s){case"h":return Rt(en.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return jt(s.length,n)}}validate(n,s){return s>=1&&s<=12}set(n,s,r){const i=n.getHours()>=12;return i&&r<12?n.setHours(r+12,0,0,0):!i&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}}class KFe extends Qe{constructor(){super(...arguments);X(this,"priority",70);X(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(n,s,r){switch(s){case"H":return Rt(en.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return jt(s.length,n)}}validate(n,s){return s>=0&&s<=23}set(n,s,r){return n.setHours(r,0,0,0),n}}class XFe extends Qe{constructor(){super(...arguments);X(this,"priority",70);X(this,"incompatibleTokens",["h","H","k","t","T"])}parse(n,s,r){switch(s){case"K":return Rt(en.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return jt(s.length,n)}}validate(n,s){return s>=0&&s<=11}set(n,s,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}}class YFe extends Qe{constructor(){super(...arguments);X(this,"priority",70);X(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(n,s,r){switch(s){case"k":return Rt(en.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return jt(s.length,n)}}validate(n,s){return s>=1&&s<=24}set(n,s,r){const i=r<=24?r%24:r;return n.setHours(i,0,0,0),n}}class QFe extends Qe{constructor(){super(...arguments);X(this,"priority",60);X(this,"incompatibleTokens",["t","T"])}parse(n,s,r){switch(s){case"m":return Rt(en.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return jt(s.length,n)}}validate(n,s){return s>=0&&s<=59}set(n,s,r){return n.setMinutes(r,0,0),n}}class ZFe extends Qe{constructor(){super(...arguments);X(this,"priority",50);X(this,"incompatibleTokens",["t","T"])}parse(n,s,r){switch(s){case"s":return Rt(en.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return jt(s.length,n)}}validate(n,s){return s>=0&&s<=59}set(n,s,r){return n.setSeconds(r,0),n}}class JFe extends Qe{constructor(){super(...arguments);X(this,"priority",30);X(this,"incompatibleTokens",["t","T"])}parse(n,s){const r=i=>Math.trunc(i*Math.pow(10,-s.length+3));return tn(jt(s.length,n),r)}set(n,s,r){return n.setMilliseconds(r),n}}class e3e extends Qe{constructor(){super(...arguments);X(this,"priority",10);X(this,"incompatibleTokens",["t","T","x"])}parse(n,s){switch(s){case"X":return ki(Si.basicOptionalMinutes,n);case"XX":return ki(Si.basic,n);case"XXXX":return ki(Si.basicOptionalSeconds,n);case"XXXXX":return ki(Si.extendedOptionalSeconds,n);case"XXX":default:return ki(Si.extended,n)}}set(n,s,r){return s.timestampIsSet?n:Ut(n,n.getTime()-P1(n)-r)}}class t3e extends Qe{constructor(){super(...arguments);X(this,"priority",10);X(this,"incompatibleTokens",["t","T","X"])}parse(n,s){switch(s){case"x":return ki(Si.basicOptionalMinutes,n);case"xx":return ki(Si.basic,n);case"xxxx":return ki(Si.basicOptionalSeconds,n);case"xxxxx":return ki(Si.extendedOptionalSeconds,n);case"xxx":default:return ki(Si.extended,n)}}set(n,s,r){return s.timestampIsSet?n:Ut(n,n.getTime()-P1(n)-r)}}class n3e extends Qe{constructor(){super(...arguments);X(this,"priority",40);X(this,"incompatibleTokens","*")}parse(n){return Gj(n)}set(n,s,r){return[Ut(n,r*1e3),{timestampIsSet:!0}]}}class s3e extends Qe{constructor(){super(...arguments);X(this,"priority",20);X(this,"incompatibleTokens","*")}parse(n){return Gj(n)}set(n,s,r){return[Ut(n,r),{timestampIsSet:!0}]}}const r3e={G:new SFe,y:new kFe,Y:new CFe,R:new TFe,u:new IFe,Q:new NFe,q:new _Fe,M:new $Fe,L:new EFe,w:new AFe,I:new OFe,d:new MFe,D:new LFe,E:new zFe,e:new BFe,c:new VFe,i:new UFe,a:new jFe,b:new HFe,B:new GFe,h:new qFe,H:new KFe,K:new XFe,k:new YFe,m:new QFe,s:new ZFe,S:new JFe,X:new e3e,x:new t3e,t:new n3e,T:new s3e},i3e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,o3e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,a3e=/^'([^]*?)'?$/,l3e=/''/g,c3e=/\S/,u3e=/[a-zA-Z]/;function h3e(t,e,n,s){var m,x,y,b,w,v,S,T;const r=()=>Ut((s==null?void 0:s.in)||n,NaN),i=mFe(),o=(s==null?void 0:s.locale)??i.locale??zj,a=(s==null?void 0:s.firstWeekContainsDate)??((x=(m=s==null?void 0:s.locale)==null?void 0:m.options)==null?void 0:x.firstWeekContainsDate)??i.firstWeekContainsDate??((b=(y=i.locale)==null?void 0:y.options)==null?void 0:b.firstWeekContainsDate)??1,l=(s==null?void 0:s.weekStartsOn)??((v=(w=s==null?void 0:s.locale)==null?void 0:w.options)==null?void 0:v.weekStartsOn)??i.weekStartsOn??((T=(S=i.locale)==null?void 0:S.options)==null?void 0:T.weekStartsOn)??0;if(!e)return t?r():_e(n,s==null?void 0:s.in);const c={firstWeekContainsDate:a,weekStartsOn:l,locale:o},u=[new vFe(s==null?void 0:s.in,n)],h=e.match(o3e).map(k=>{const I=k[0];if(I in MC){const _=MC[I];return _(k,o.formatLong)}return k}).join("").match(i3e),d=[];for(let k of h){!(s!=null&&s.useAdditionalWeekYearTokens)&&jj(k)&&LC(k,e,t),!(s!=null&&s.useAdditionalDayOfYearTokens)&&Uj(k)&&LC(k,e,t);const I=k[0],_=r3e[I];if(_){const{incompatibleTokens:D}=_;if(Array.isArray(D)){const L=d.find(B=>D.includes(B.token)||B.token===I);if(L)throw new RangeError(`The format string mustn't contain \`${L.fullToken}\` and \`${k}\` at the same time`)}else if(_.incompatibleTokens==="*"&&d.length>0)throw new RangeError(`The format string mustn't contain \`${k}\` and any other token at the same time`);d.push({token:I,fullToken:k});const A=_.run(t,k,o.match,c);if(!A)return r();u.push(A.setter),t=A.rest}else{if(I.match(u3e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+I+"`");if(k==="''"?k="'":I==="'"&&(k=d3e(k)),t.indexOf(k)===0)t=t.slice(k.length);else return r()}}if(t.length>0&&c3e.test(t))return r();const f=u.map(k=>k.priority).sort((k,I)=>I-k).filter((k,I,_)=>_.indexOf(k)===I).map(k=>u.filter(I=>I.priority===k).sort((I,_)=>_.subPriority-I.subPriority)).map(k=>k[0]);let p=_e(n,s==null?void 0:s.in);if(isNaN(+p))return r();const g={};for(const k of f){if(!k.validate(p,c))return r();const I=k.set(p,g,c);Array.isArray(I)?(p=I[0],Object.assign(g,I[1])):p=I}return p}function d3e(t){return t.match(a3e)[1].replace(l3e,"'")}function f3e(t,e){const n=_e(t,e==null?void 0:e.in);return n.setMinutes(0,0,0),n}function p3e(t,e){const n=_e(t,e==null?void 0:e.in);return n.setSeconds(0,0),n}function m3e(t,e){const n=_e(t,e==null?void 0:e.in);return n.setMilliseconds(0),n}function g3e(t,e){const n=()=>Ut(e==null?void 0:e.in,NaN),s=(e==null?void 0:e.additionalDigits)??2,r=w3e(t);let i;if(r.date){const c=v3e(r.date,s);i=S3e(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const o=+i;let a=0,l;if(r.time&&(a=k3e(r.time),isNaN(a)))return n();if(r.timezone){if(l=C3e(r.timezone),isNaN(l))return n()}else{const c=new Date(o+a),u=_e(0,e==null?void 0:e.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return _e(o+a+l,e==null?void 0:e.in)}const dx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},x3e=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,y3e=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,b3e=/^([+-])(\d{2})(?::?(\d{2}))?$/;function w3e(t){const e={},n=t.split(dx.dateTimeDelimiter);let s;if(n.length>2)return e;if(/:/.test(n[0])?s=n[0]:(e.date=n[0],s=n[1],dx.timeZoneDelimiter.test(e.date)&&(e.date=t.split(dx.timeZoneDelimiter)[0],s=t.substr(e.date.length,t.length))),s){const r=dx.timezone.exec(s);r?(e.time=s.replace(r[1],""),e.timezone=r[1]):e.time=s}return e}function v3e(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),s=t.match(n);if(!s)return{year:NaN,restDateString:""};const r=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?r:i*100,restDateString:t.slice((s[1]||s[2]).length)}}function S3e(t,e){if(e===null)return new Date(NaN);const n=t.match(x3e);if(!n)return new Date(NaN);const s=!!n[4],r=xf(n[1]),i=xf(n[2])-1,o=xf(n[3]),a=xf(n[4]),l=xf(n[5])-1;if(s)return $3e(e,a,l)?T3e(e,a,l):new Date(NaN);{const c=new Date(0);return!N3e(e,i,o)||!_3e(e,r)?new Date(NaN):(c.setUTCFullYear(e,i,Math.max(r,o)),c)}}function xf(t){return t?parseInt(t):1}function k3e(t){const e=t.match(y3e);if(!e)return NaN;const n=uS(e[1]),s=uS(e[2]),r=uS(e[3]);return E3e(n,s,r)?n*d0+s*h0+r*1e3:NaN}function uS(t){return t&&parseFloat(t.replace(",","."))||0}function C3e(t){if(t==="Z")return 0;const e=t.match(b3e);if(!e)return 0;const n=e[1]==="+"?-1:1,s=parseInt(e[2]),r=e[3]&&parseInt(e[3])||0;return D3e(s,r)?n*(s*d0+r*h0):NaN}function T3e(t,e,n){const s=new Date(0);s.setUTCFullYear(t,0,4);const r=s.getUTCDay()||7,i=(e-1)*7+n+1-r;return s.setUTCDate(s.getUTCDate()+i),s}const I3e=[31,null,31,30,31,30,31,31,30,31,30,31];function Xj(t){return t%400===0||t%4===0&&t%100!==0}function N3e(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(I3e[e]||(Xj(t)?29:28))}function _3e(t,e){return e>=1&&e<=(Xj(t)?366:365)}function $3e(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function E3e(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function D3e(t,e){return e>=0&&e<=59}/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const A3e={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};J8._date.override({_id:"date-fns",formats:function(){return A3e},parse:function(t,e){if(t===null||typeof t>"u")return null;const n=typeof t;return n==="number"||t instanceof Date?t=_e(t):n==="string"&&(typeof e=="string"?t=h3e(t,e,new Date,this.options):t=g3e(t,this.options)),Rj(t)?t.getTime():null},format:function(t,e){return fFe(t,e,this.options)},add:function(t,e,n){switch(n){case"millisecond":return ME(t,e);case"second":return nPe(t,e);case"minute":return ePe(t,e);case"hour":return QOe(t,e);case"day":return Hv(t,e);case"week":return sPe(t,e);case"month":return FE(t,e);case"quarter":return tPe(t,e);case"year":return rPe(t,e);default:return t}},diff:function(t,e,n){switch(n){case"millisecond":return LE(t,e);case"second":return dPe(t,e);case"minute":return cPe(t,e);case"hour":return lPe(t,e);case"day":return Oj(t,e);case"week":return fPe(t,e);case"month":return Mj(t,e);case"quarter":return hPe(t,e);case"year":return pPe(t,e);default:return 0}},startOf:function(t,e,n){switch(e){case"second":return m3e(t);case"minute":return p3e(t);case"hour":return f3e(t);case"day":return FC(t);case"week":return Bi(t);case"isoWeek":return Bi(t,{weekStartsOn:+n});case"month":return gPe(t);case"quarter":return mPe(t);case"year":return Lj(t);default:return t}},endOf:function(t,e){switch(e){case"second":return SPe(t);case"minute":return wPe(t);case"hour":return yPe(t);case"day":return Pj(t);case"week":return bPe(t);case"month":return Fj(t);case"quarter":return vPe(t);case"year":return xPe(t);default:return t}}});const Yj=Zs;(function(t,e){const n=Zs,s=t();for(;;)try{if(parseInt(n(389))/1+parseInt(n(349))/2*(parseInt(n(306))/3)+-parseInt(n(327))/4+parseInt(n(331))/5*(-parseInt(n(393))/6)+-parseInt(n(388))/7*(parseInt(n(343))/8)+parseInt(n(362))/9*(-parseInt(n(369))/10)+parseInt(n(326))/11*(parseInt(n(365))/12)===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(M1,882739);function Zs(t,e){const n=M1();return Zs=function(s,r){return s=s-306,n[s]},Zs(t,e)}const R3e=function(){let t=!0;return function(e,n){const s=t?function(){const r=Zs;if(n){const i=n[r(384)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){R3e(this,function(){const t=Zs,e=new RegExp(t(395)),n=new RegExp(t(344),"i"),s=n3(t(315));!e[t(336)](s+t(335))||!n[t(336)](s+t(319))?s("0"):n3()})()})();function M1(){const t=["Loss","rgba(153, 102, 255, 0.6)","end","push","Shift End:","Number of Steps:","animate-spin inline-block","Class 1","input w-full p-2 rounded bg-gray-700 text-white","apply","random","sqrt","while (true) {}","238VXlwaw","837654SaMgjV","Loss and Margin Width vs. Shift Distance","Beta2","constructor","6aUWBhl","Value","function *\\( *\\)","space-y-4","Run Experiment","rgba(255, 206, 86, 0.6)","lossList","rgba(75, 192, 192, 0.6)","145476fuAMgQ","Datasets and Decision Boundaries","top","Shift Distance","filter","stepNum","beta1List","string","Beta0","init","Logistic Regression Experiment","grid grid-cols-1 md:grid-cols-2 gap-8","beta2List","input","Parameter Value","fill","block font-medium","number","target","results mt-8","55SAITyJ","560524ojBfhL","debu","log","cos","6288330ZNlpUC","label","value","preventDefault","chain","test","data","rgba(0, 255, 0, 0.8)","Beta1","map","rgba(54, 162, 235, 0.6)","toFixed","7440jkprzs","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","distance","exp","counter","font-semibold mb-2","36iapfpi","Decision Boundary","start","text-2xl font-semibold mb-4","w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded mt-4","mt-4","form","rgba(255, 99, 132, 0.6)","line","div","Shift Distance: ","text-xl font-semibold mt-6","mt-6 p-6 bg-gray-800 text-white rounded-lg","10545201XuduGR","beta0List","stateObject","4256004CsHdIn","length","register","Class 0","10RiKvRT","button","Margin Width","shiftDistances","call","gger"];return M1=function(){return t},M1()}Gd[Yj(367)](...kj);function O3e(){const t=Yj,[e,n]=H.useState(.25),[s,r]=H.useState(2),[i,o]=H.useState(8),[a,l]=H.useState(!1),[c,u]=H.useState([]),[h,d]=H.useState(null),f=async w=>{w[Zs(334)](),l(!0),await p(e,s,i),l(!1)},p=async(w,v,S)=>{const T=Zs,k=g(w,v,S),I=[],_=[],D=[],A=[],L=[],B=[],F=[],R=[];for(let O of k){const{X:E,y:V}=m(O,100),{beta0:G,beta1:Y,beta2:Z,loss:ee}=b(E,V);I.push(G),_.push(Y),D[T(378)](Z);const te=-Y/Z,ne=-G/Z;A[T(378)](te),L.push(ne),B[T(378)](ee);const ie=O;F[T(378)](ie),R[T(378)]({distance:O,data:{datasets:[{label:T(368),data:E[T(310)]((ce,ye)=>V[ye]===0)[T(340)](ce=>({x:ce[0],y:ce[1]})),backgroundColor:T(341)},{label:T(382),data:E[T(310)]((ce,ye)=>V[ye]===1).map(ce=>({x:ce[0],y:ce[1]})),backgroundColor:T(356)},{label:T(350),data:[{x:-5,y:te*-5+ne},{x:5,y:te*5+ne}],type:T(357),borderColor:T(338),borderWidth:2,fill:!1,pointRadius:0}]}})}d({shiftDistances:k,beta0List:I,beta1List:_,beta2List:D,slopeList:A,interceptList:L,lossList:B,marginWidths:F}),u(R)};function g(w,v,S){const T=[],k=(v-w)/(S-1);for(let I=0;I<S;I++)T.push(w+k*I);return T}function m(w,v){const S=Zs,T=.5,k=[[T,T*.8],[T*.8,T]],I=[1,1],_=[1+w,1+w],D=x(I,k,v),A=x(_,k,v),L=Array(v)[S(321)](0),B=Array(v)[S(321)](1),F=[...D,...A],R=[...L,...B];return{X:F,y:R}}function x(w,v,S){const T=Zs,k=[],[I,_]=w,[D,A]=[Math[T(386)](v[0][0]),Math[T(386)](v[1][1])];for(let L=0;L<S;L++){const B=y(I,D),F=y(_,A);k[T(378)]([B,F])}return k}function y(w,v){const S=Zs;let T=0,k=0;for(;T===0;)T=Math[S(385)]();for(;k===0;)k=Math[S(385)]();return w+v*Math[S(386)](-2*Math[S(329)](T))*Math[S(330)](2*Math.PI*k)}function b(w,v){const S=Zs,T=1e3,k=.1;let I=0,_=0,D=0;for(let L=0;L<T;L++){let B=0,F=0,R=0,O=0;for(let E=0;E<w[S(366)];E++){const V=w[E],G=v[E],Y=I+_*V[0]+D*V[1],Z=1/(1+Math[S(346)](-Y));O+=-G*Math[S(329)](Z+1e-10)-(1-G)*Math[S(329)](1-Z+1e-10),B+=Z-G,F+=(Z-G)*V[0],R+=(Z-G)*V[1]}I-=k*B/w[S(366)],_-=k*F/w[S(366)],D-=k*R/w[S(366)]}let A=0;for(let L=0;L<w.length;L++){const B=w[L],F=v[L],R=I+_*B[0]+D*B[1],O=1/(1+Math[S(346)](-R));A+=-F*Math[S(329)](O+1e-10)-(1-F)*Math[S(329)](1-O+1e-10)}return A/=w.length,{beta0:I,beta1:_,beta2:D,loss:A}}return z.jsxs(t(358),{className:t(361),children:[z.jsx("h1",{className:t(352),children:t(316)}),z.jsxs(t(355),{onSubmit:f,className:t(396),children:[z.jsxs(t(358),{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[z.jsxs("div",{children:[z.jsx(t(332),{htmlFor:t(351),className:t(322),children:"Shift Start:"}),z.jsx(t(319),{type:t(323),step:"any",id:t(351),name:"start",required:!0,className:t(383),value:e,onChange:w=>n(parseFloat(w[t(324)][t(333)]))})]}),z.jsxs(t(358),{children:[z.jsx(t(332),{htmlFor:t(377),className:t(322),children:t(379)}),z.jsx(t(319),{type:t(323),step:"any",id:t(377),name:t(377),required:!0,className:"input w-full p-2 rounded bg-gray-700 text-white",value:s,onChange:w=>r(parseFloat(w[t(324)].value))})]}),z.jsxs(t(358),{children:[z.jsx("label",{htmlFor:t(311),className:t(322),children:t(380)}),z.jsx("input",{type:t(323),id:"stepNum",name:t(311),required:!0,className:"input w-full p-2 rounded bg-gray-700 text-white",value:i,onChange:w=>o(parseInt(w.target[t(333)]))})]})]}),z.jsx(t(370),{type:"submit",className:t(353),disabled:a,children:a?z.jsx(AQ,{className:t(381)}):t(397)})]}),c.length>0&&z.jsxs(t(358),{className:t(325),children:[z.jsx("h2",{className:t(360),children:t(307)}),z.jsx(t(358),{className:t(317),children:c[t(340)]((w,v)=>z.jsxs(t(358),{className:t(354),children:[z.jsxs("h3",{className:t(348),children:[t(359),w[t(345)][t(342)](2)]}),z.jsx(Hx,{data:w[t(337)],options:{plugins:{legend:{display:!0,position:t(308)}},scales:{x:{title:{display:!0,text:"x1"},min:-2,max:5},y:{title:{display:!0,text:"x2"},min:-2,max:5}}}})]},v))}),h&&z.jsxs(z.Fragment,{children:[z.jsx("h2",{className:t(360),children:"Parameters vs. Shift Distance"}),z.jsx(t(358),{className:t(354),children:z.jsx(Hx,{data:{labels:h.shiftDistances,datasets:[{label:t(314),data:h[t(372)][t(340)]((w,v)=>({x:w,y:h[t(363)][v]})),backgroundColor:"rgba(255, 99, 132, 0.6)"},{label:t(339),data:h.shiftDistances[t(340)]((w,v)=>({x:w,y:h[t(312)][v]})),backgroundColor:t(341)},{label:t(391),data:h[t(372)].map((w,v)=>({x:w,y:h[t(318)][v]})),backgroundColor:t(398)}]},options:{plugins:{legend:{display:!0,position:"top"}},scales:{x:{title:{display:!0,text:t(309)}},y:{title:{display:!0,text:t(320)}}}}})}),z.jsx("h2",{className:"text-xl font-semibold mt-6",children:t(390)}),z.jsx("div",{className:t(354),children:z.jsx(Hx,{data:{labels:h[t(372)],datasets:[{label:t(375),data:h[t(372)].map((w,v)=>({x:w,y:h[t(399)][v]})),backgroundColor:t(400)},{label:t(371),data:h[t(372)].map((w,v)=>({x:w,y:h.marginWidths[v]})),backgroundColor:t(376)}]},options:{plugins:{legend:{display:!0,position:t(308)}},scales:{x:{title:{display:!0,text:t(309)}},y:{title:{display:!0,text:t(394)}}}}})})]})]})]})}function n3(t){function e(n){const s=Zs;if(typeof n===s(313))return(function(r){}).constructor(s(387))[s(384)](s(347));(""+n/n)[s(366)]!==1||n%20===0?(function(){return!0})[s(392)](s(328)+s(374))[s(373)]("action"):(function(){return!1}).constructor(s(328)+s(374))[s(384)](s(364)),e(++n)}try{if(t)return e;e(0)}catch{}}function L1(){const t=["text-blue-500 underline","test","map","div","390948mUaDpB","This is the assignment on data colection and analysis.","init","This was the winning submission to a kaggle competition on recommender systems, developing a unique approach to generalizing n-grams via the embedding similarity metric.","apply","This is the submission to this ","370nVAcsF","space-y-8","stateObject"," for this linear regressions tool.","my-8 border-t border-gray-500 opacity-50","3vLENCz","245982cxcLcH","Github Link","text-2xl font-semibold","https://www.kaggle.com/competitions/cs-506-predicting-customer-churn-using-knn/leaderboard","function *\\( *\\)","416382YMBKkd","length","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","76920IDImlS","Find the ","Kaggle competition","1957401MjrksX","Fuzzy n-grams & matrix factorization: towards improved recommender systems","https://youtu.be/BUGsAUDCy0Y","string","input","action","from","https://github.com/user04f8-cs506/nbclark-assignment-","debu","Weekly mini-projects","185610tDijAl","36xTyPUX","gger","1975728grIwUa","constructor","counter","mt-20 p-6 text-white","mt-2","217cfGwit"];return L1=function(){return t},L1()}(function(t,e){const n=Rc,s=t();for(;;)try{if(parseInt(n(250))/1+parseInt(n(220))/2*(parseInt(n(214))/3)+-parseInt(n(238))/4*(-parseInt(n(237))/5)+parseInt(n(240))/6+-parseInt(n(245))/7*(parseInt(n(224))/8)+parseInt(n(227))/9+-parseInt(n(209))/10*(parseInt(n(215))/11)===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(L1,354555);const P3e=function(){let t=!0;return function(e,n){const s=t?function(){const r=Rc;if(n){const i=n[r(254)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){P3e(this,function(){const t=Rc,e=new RegExp(t(219)),n=new RegExp(t(223),"i"),s=r3(t(252));!e[t(247)](s+t(222))||!n[t(247)](s+t(231))?s("0"):r3()})()})();function s3(){const t=Rc,e=8,n=Array[t(233)]({length:e+1},(r,i)=>i),s=[z.jsx(z.Fragment,{children:"This is a simple assignment used as a test."}),z.jsx(z.Fragment,{children:t(251)}),z.jsx(rZ,{}),z.jsx(z.Fragment,{children:"This is the completed analysis of SVD on MNIST"}),z.jsx(GOe,{}),z.jsxs(z.Fragment,{children:[t(208),z.jsx("a",{href:t(218),className:"text-blue-500 underline",children:t(226)})]}),z.jsx(KOe,{}),z.jsxs(z.Fragment,{children:[t(225),z.jsx("a",{href:t(229),className:"text-blue-500 underline",children:"video demo here"}),t(212)]}),z.jsx(O3e,{})];return z.jsxs(t(249),{className:t(243),children:[z.jsx("h1",{className:t(217),children:t(228)}),z.jsxs(t(249),{className:t(210),children:[z.jsx("p",{className:t(244),children:t(253)}),z.jsx("a",{href:"https://github.com/user04f8/genetic-nlp",className:"text-blue-500 underline",children:t(216)})]}),z.jsx(t(249),{className:t(213)}),z.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:t(236)}),z.jsx(t(249),{className:t(210),children:n[t(248)](r=>z.jsxs(t(249),{children:[z.jsxs("h2",{className:"text-2xl font-semibold",children:["Assignment ",r]}),z.jsx("p",{className:t(244),children:s[r]}),z.jsx("a",{href:t(234)+r,className:t(246),children:t(216)})]},r))})]})}function Rc(t,e){const n=L1();return Rc=function(s,r){return s=s-208,n[s]},Rc(t,e)}function r3(t){function e(n){const s=Rc;if(typeof n===s(230))return(function(r){}).constructor("while (true) {}").apply(s(242));(""+n/n)[s(221)]!==1||n%20===0?(function(){return!0})[s(241)](s(235)+s(239)).call(s(232)):(function(){return!1})[s(241)](s(235)+s(239)).apply(s(211)),e(++n)}try{if(t)return e;e(0)}catch{}}function Oc(t,e){var n=z1();return Oc=function(s,r){s=s-478;var i=n[s];return i},Oc(t,e)}(function(t,e){for(var n=Oc,s=t();;)try{var r=parseInt(n(508))/1*(parseInt(n(503))/2)+-parseInt(n(498))/3+parseInt(n(497))/4*(-parseInt(n(496))/5)+-parseInt(n(505))/6+-parseInt(n(502))/7*(parseInt(n(494))/8)+parseInt(n(491))/9+parseInt(n(486))/10*(-parseInt(n(504))/11);if(r===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(z1,348589);var F3e=function(){var t=!0;return function(e,n){var s=t?function(){var r=Oc;if(n){var i=n[r(492)](e,arguments);return n=null,i}}:function(){};return t=!1,s}}();(function(){F3e(this,function(){var t=Oc,e=new RegExp("function *\\( *\\)"),n=new RegExp(t(482),"i"),s=i3("init");!e[t(488)](s+t(499))||!n.test(s+t(479))?s("0"):i3()})()})();function z1(){var t=["262129klPvRX","14jMYhCr","616gTbWRO","366720dUexEQ","/assignments","string","85831mRCDcE","while (true) {}","input","div","gger","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor","/contact","stateObject","52510KHjGJV","length","test","/work-experience","counter","5789295jwAvif","apply","debu","64FWxmCP","action","125040eBhfMG","12uryBku","497121gnyMcr","chain","mt-20","/mini-projects"];return z1=function(){return t},z1()}function M3e(){var t=Oc;return z.jsxs(I7,{children:[z.jsx(O7,{}),z.jsx(t(480),{className:t(500),children:z.jsxs(y7,{children:[z.jsx(wl,{path:"/",element:z.jsx(iQ,{})}),z.jsx(wl,{path:t(489),element:z.jsx(hQ,{})}),z.jsx(wl,{path:"/projects",element:z.jsx(gQ,{})}),z.jsx(wl,{path:t(484),element:z.jsx(FQ,{})}),z.jsx(wl,{path:t(501),element:z.jsx(s3,{})}),z.jsx(wl,{path:t(506),element:z.jsx(s3,{})})]})})]})}function i3(t){function e(n){var s=Oc;if(typeof n===s(507))return(function(r){})[s(483)](s(478))[s(492)](s(490));(""+n/n)[s(487)]!==1||n%20===0?(function(){return!0})[s(483)]("debu"+s(481)).call(s(495)):(function(){return!1})[s(483)](s(493)+s(481))[s(492)](s(485)),e(++n)}try{if(t)return e;e(0)}catch{}}var hS=Sh;(function(t,e){for(var n=Sh,s=t();;)try{var r=-parseInt(n(154))/1*(parseInt(n(139))/2)+parseInt(n(147))/3+-parseInt(n(153))/4*(-parseInt(n(160))/5)+-parseInt(n(138))/6*(parseInt(n(157))/7)+-parseInt(n(159))/8+parseInt(n(145))/9+-parseInt(n(162))/10*(parseInt(n(149))/11);if(r===e)break;s.push(s.shift())}catch{s.push(s.shift())}})(B1,511127);var L3e=function(){var t=!0;return function(e,n){var s=t?function(){if(n){var r=n.apply(e,arguments);return n=null,r}}:function(){};return t=!1,s}}();(function(){L3e(this,function(){var t=Sh,e=new RegExp(t(151)),n=new RegExp(t(163),"i"),s=o3(t(152));!e[t(143)](s+"chain")||!n[t(143)](s+t(150))?s("0"):o3()})()})();function B1(){var t=["635pTrSeo","apply","492850trahVk","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","string","6uzDcND","190uDbxCw","root","getElementById","gger","test","render","6503202idNljd","debu","1704174jLiKai","constructor","22qAZMVT","input","function *\\( *\\)","init","5368umdKeo","727rJsNUO","action","while (true) {}","2595551zWlMFA","counter","3292120GjkdbP"];return B1=function(){return t},B1()}function Sh(t,e){var n=B1();return Sh=function(s,r){s=s-138;var i=n[s];return i},Sh(t,e)}vL(document[hS(141)](hS(140)))[hS(144)](z.jsx(H.StrictMode,{children:z.jsx(M3e,{})}));function o3(t){function e(n){var s=Sh;if(typeof n===s(164))return(function(r){})[s(148)](s(156)).apply(s(158));(""+n/n).length!==1||n%20===0?(function(){return!0}).constructor("debu"+s(142)).call(s(155)):(function(){return!1})[s(148)](s(146)+s(142))[s(161)]("stateObject"),e(++n)}try{if(t)return e;e(0)}catch{}}
