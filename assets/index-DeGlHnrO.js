var Fj=Object.defineProperty;var Lj=(e,t,n)=>t in e?Fj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var at=(e,t,n)=>Lj(e,typeof t!="symbol"?t+"":t,n);function dF(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in e)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function bl(e,t){const n=bx();return bl=function(s,r){return s=s-182,n[s]},bl(e,t)}(function(e,t){const n=bl,s=e();for(;;)try{if(-parseInt(n(207))/1*(parseInt(n(225))/2)+-parseInt(n(197))/3*(-parseInt(n(186))/4)+-parseInt(n(205))/5+-parseInt(n(217))/6+parseInt(n(210))/7+parseInt(n(214))/8+-parseInt(n(218))/9*(-parseInt(n(223))/10)===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(bx,109577),function(){const t=bl,n=function(){let o=!0;return function(a,l){const c=o?function(){const u=bl;if(l){const h=l[u(199)](a,arguments);return l=null,h}}:function(){};return o=!1,c}}(),s=document[t(202)](t(224))[t(194)];if(s&&s[t(183)]&&s[t(183)](t(185)))return;for(const o of document[t(192)](t(204)))i(o);new MutationObserver(o=>{const a=t;for(const l of o)if(l[a(189)]==="childList")for(const c of l[a(182)])c[a(193)]===a(203)&&c[a(222)]===a(185)&&i(c)})[t(190)](document,{childList:!0,subtree:!0});function r(o){const a=t,l={};return o.integrity&&(l[a(209)]=o[a(209)]),o[a(201)]&&(l[a(201)]=o.referrerPolicy),o[a(219)]==="use-credentials"?l[a(187)]=a(196):o[a(219)]===a(195)?l[a(187)]=a(206):l[a(187)]=a(216),l}function i(o){const a=t;if(function(){n(this,function(){const c=bl,u=new RegExp(c(213)),h=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),d=tE("init");!u.test(d+c(211))||!h[c(208)](d+c(191))?d("0"):tE()})()}(),o.ep)return;o.ep=!0;const l=r(o);fetch(o[a(215)],l)}}();function tE(e){function t(n){const s=bl;if(typeof n===s(200))return(function(r){}).constructor("while (true) {}")[s(199)](s(198));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(184)](s(221)+"gger").call(s(212)):(function(){return!1}).constructor(s(221)+s(220))[s(199)](s(188)),t(++n)}try{if(e)return t;t(0)}catch{}}function bx(){const e=["querySelectorAll","tagName","relList","anonymous","include","813CrmypM","counter","apply","string","referrerPolicy","createElement","LINK",'link[rel="modulepreload"]',"751440COzJfr","omit","1mvinbx","test","integrity","172074nQzgRC","chain","action","function *\\( *\\)","1098064Osyvin","href","same-origin","806406oEYxUO","9jRAiww","crossOrigin","gger","debu","rel","1992850sWxnJx","link","153228DFcRAZ","addedNodes","supports","constructor","modulepreload","1620CpFTTZ","credentials","stateObject","type","observe","input"];return bx=function(){return e},bx()}var gf=Tu;(function(e,t){for(var n=Tu,s=e();;)try{var r=parseInt(n(147))/1*(-parseInt(n(137))/2)+parseInt(n(140))/3*(-parseInt(n(143))/4)+-parseInt(n(144))/5*(-parseInt(n(141))/6)+-parseInt(n(165))/7+-parseInt(n(142))/8*(-parseInt(n(152))/9)+parseInt(n(136))/10+parseInt(n(160))/11;if(r===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(vx,357229);var Mj=function(){var e=!0;return function(t,n){var s=e?function(){if(n){var r=n.apply(t,arguments);return n=null,r}}:function(){};return e=!1,s}}();(function(){Mj(this,function(){var e=Tu,t=new RegExp("function *\\( *\\)"),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=eE(e(158));!t[e(169)](s+e(145))||!n[e(169)](s+e(159))?s("0"):eE()})()})();var wc=typeof globalThis!==gf(168)?globalThis:typeof window<"u"?window:typeof global!==gf(168)?global:typeof self!==gf(168)?self:{};function fF(e){var t=gf;return e&&e[t(153)]&&Object[t(148)][t(149)].call(e,t(162))?e.default:e}function vx(){var e=["forEach","371gipcqX","prototype","hasOwnProperty","constructor","apply","370287BzVUbD","__esModule","while (true) {}","defineProperty","string","debu","init","input","5378835zfolAE","getOwnPropertyDescriptor","default","action","call","3598343djXavJ","function","keys","undefined","test","6486900rwauuZ","3498EQuMYU","construct","stateObject","431325PTvoRE","6xltPMa","48pGIFuc","12MBLxia","2834745qEsiUe","chain"];return vx=function(){return e},vx()}function Tu(e,t){var n=vx();return Tu=function(s,r){s=s-136;var i=n[s];return i},Tu(e,t)}function zj(e){var t=gf;if(e.__esModule)return e;var n=e.default;if(typeof n==t(166)){var s=function r(){var i=t;return this instanceof r?Reflect[i(138)](n,arguments,this[i(150)]):n[i(151)](this,arguments)};s.prototype=n[t(148)]}else s={};return Object[t(155)](s,"__esModule",{value:!0}),Object[t(167)](e)[t(146)](function(r){var i=t,o=Object[i(161)](e,r);Object[i(155)](s,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}),s}function eE(e){function t(n){var s=Tu;if(typeof n===s(156))return(function(r){})[s(150)](s(154)).apply("counter");(""+n/n).length!==1||n%20===0?(function(){return!0}).constructor(s(157)+"gger")[s(164)](s(163)):(function(){return!1})[s(150)](s(157)+"gger").apply(s(139)),t(++n)}try{if(e)return t;t(0)}catch{}}var pF={exports:{}},h1={},mF={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bp=Symbol.for("react.element"),Bj=Symbol.for("react.portal"),Vj=Symbol.for("react.fragment"),Wj=Symbol.for("react.strict_mode"),Uj=Symbol.for("react.profiler"),jj=Symbol.for("react.provider"),Gj=Symbol.for("react.context"),Hj=Symbol.for("react.forward_ref"),Kj=Symbol.for("react.suspense"),qj=Symbol.for("react.memo"),Xj=Symbol.for("react.lazy"),nE=Symbol.iterator;function Yj(e){return e===null||typeof e!="object"?null:(e=nE&&e[nE]||e["@@iterator"],typeof e=="function"?e:null)}var gF={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xF=Object.assign,yF={};function rh(e,t,n){this.props=e,this.context=t,this.refs=yF,this.updater=n||gF}rh.prototype.isReactComponent={};rh.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};rh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function bF(){}bF.prototype=rh.prototype;function sC(e,t,n){this.props=e,this.context=t,this.refs=yF,this.updater=n||gF}var rC=sC.prototype=new bF;rC.constructor=sC;xF(rC,rh.prototype);rC.isPureReactComponent=!0;var sE=Array.isArray,vF=Object.prototype.hasOwnProperty,iC={current:null},wF={key:!0,ref:!0,__self:!0,__source:!0};function SF(e,t,n){var s,r={},i=null,o=null;if(t!=null)for(s in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)vF.call(t,s)&&!wF.hasOwnProperty(s)&&(r[s]=t[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(e&&e.defaultProps)for(s in a=e.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:Bp,type:e,key:i,ref:o,props:r,_owner:iC.current}}function Zj(e,t){return{$$typeof:Bp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function oC(e){return typeof e=="object"&&e!==null&&e.$$typeof===Bp}function Qj(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var rE=/\/+/g;function xw(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Qj(""+e.key):t.toString(36)}function W0(e,t,n,s,r){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Bp:case Bj:o=!0}}if(o)return o=e,r=r(o),e=s===""?"."+xw(o,0):s,sE(r)?(n="",e!=null&&(n=e.replace(rE,"$&/")+"/"),W0(r,t,n,"",function(c){return c})):r!=null&&(oC(r)&&(r=Zj(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(rE,"$&/")+"/")+e)),t.push(r)),1;if(o=0,s=s===""?".":s+":",sE(e))for(var a=0;a<e.length;a++){i=e[a];var l=s+xw(i,a);o+=W0(i,t,n,l,r)}else if(l=Yj(e),typeof l=="function")for(e=l.call(e),a=0;!(i=e.next()).done;)i=i.value,l=s+xw(i,a++),o+=W0(i,t,n,l,r);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function jg(e,t,n){if(e==null)return e;var s=[],r=0;return W0(e,s,"","",function(i){return t.call(n,i,r++)}),s}function Jj(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var xs={current:null},U0={transition:null},t8={ReactCurrentDispatcher:xs,ReactCurrentBatchConfig:U0,ReactCurrentOwner:iC};function kF(){throw Error("act(...) is not supported in production builds of React.")}Vt.Children={map:jg,forEach:function(e,t,n){jg(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return jg(e,function(){t++}),t},toArray:function(e){return jg(e,function(t){return t})||[]},only:function(e){if(!oC(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Vt.Component=rh;Vt.Fragment=Vj;Vt.Profiler=Uj;Vt.PureComponent=sC;Vt.StrictMode=Wj;Vt.Suspense=Kj;Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t8;Vt.act=kF;Vt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=xF({},e.props),r=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=iC.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)vF.call(t,l)&&!wF.hasOwnProperty(l)&&(s[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:Bp,type:e.type,key:r,ref:i,props:s,_owner:o}};Vt.createContext=function(e){return e={$$typeof:Gj,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jj,_context:e},e.Consumer=e};Vt.createElement=SF;Vt.createFactory=function(e){var t=SF.bind(null,e);return t.type=e,t};Vt.createRef=function(){return{current:null}};Vt.forwardRef=function(e){return{$$typeof:Hj,render:e}};Vt.isValidElement=oC;Vt.lazy=function(e){return{$$typeof:Xj,_payload:{_status:-1,_result:e},_init:Jj}};Vt.memo=function(e,t){return{$$typeof:qj,type:e,compare:t===void 0?null:t}};Vt.startTransition=function(e){var t=U0.transition;U0.transition={};try{e()}finally{U0.transition=t}};Vt.unstable_act=kF;Vt.useCallback=function(e,t){return xs.current.useCallback(e,t)};Vt.useContext=function(e){return xs.current.useContext(e)};Vt.useDebugValue=function(){};Vt.useDeferredValue=function(e){return xs.current.useDeferredValue(e)};Vt.useEffect=function(e,t){return xs.current.useEffect(e,t)};Vt.useId=function(){return xs.current.useId()};Vt.useImperativeHandle=function(e,t,n){return xs.current.useImperativeHandle(e,t,n)};Vt.useInsertionEffect=function(e,t){return xs.current.useInsertionEffect(e,t)};Vt.useLayoutEffect=function(e,t){return xs.current.useLayoutEffect(e,t)};Vt.useMemo=function(e,t){return xs.current.useMemo(e,t)};Vt.useReducer=function(e,t,n){return xs.current.useReducer(e,t,n)};Vt.useRef=function(e){return xs.current.useRef(e)};Vt.useState=function(e){return xs.current.useState(e)};Vt.useSyncExternalStore=function(e,t,n){return xs.current.useSyncExternalStore(e,t,n)};Vt.useTransition=function(){return xs.current.useTransition()};Vt.version="18.3.1";mF.exports=Vt;var K=mF.exports;const Mt=fF(K),e8=dF({__proto__:null,default:Mt},[K]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n8=K,s8=Symbol.for("react.element"),r8=Symbol.for("react.fragment"),i8=Object.prototype.hasOwnProperty,o8=n8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a8={key:!0,ref:!0,__self:!0,__source:!0};function CF(e,t,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(s in t)i8.call(t,s)&&!a8.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)r[s]===void 0&&(r[s]=t[s]);return{$$typeof:s8,type:e,key:i,ref:o,props:r,_owner:o8.current}}h1.Fragment=r8;h1.jsx=CF;h1.jsxs=CF;pF.exports=h1;var j=pF.exports,IF={exports:{}},ir={},TF={exports:{}},NF={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(E,B){var q=E.length;E.push(B);t:for(;0<q;){var Y=q-1>>>1,Q=E[Y];if(0<r(Q,B))E[Y]=B,E[q]=Q,q=Y;else break t}}function n(E){return E.length===0?null:E[0]}function s(E){if(E.length===0)return null;var B=E[0],q=E.pop();if(q!==B){E[0]=q;t:for(var Y=0,Q=E.length,J=Q>>>1;Y<J;){var et=2*(Y+1)-1,nt=E[et],rt=et+1,ht=E[rt];if(0>r(nt,q))rt<Q&&0>r(ht,nt)?(E[Y]=ht,E[rt]=q,Y=rt):(E[Y]=nt,E[et]=q,Y=et);else if(rt<Q&&0>r(ht,q))E[Y]=ht,E[rt]=q,Y=rt;else break t}}return B}function r(E,B){var q=E.sortIndex-B.sortIndex;return q!==0?q:E.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(E){for(var B=n(c);B!==null;){if(B.callback===null)s(c);else if(B.startTime<=E)s(c),B.sortIndex=B.expirationTime,t(l,B);else break;B=n(c)}}function v(E){if(g=!1,b(E),!p)if(n(l)!==null)p=!0,P(w);else{var B=n(c);B!==null&&L(v,B.startTime-E)}}function w(E,B){p=!1,g&&(g=!1,x(C),C=-1),f=!0;var q=d;try{for(b(B),h=n(l);h!==null&&(!(h.expirationTime>B)||E&&!A());){var Y=h.callback;if(typeof Y=="function"){h.callback=null,d=h.priorityLevel;var Q=Y(h.expirationTime<=B);B=e.unstable_now(),typeof Q=="function"?h.callback=Q:h===n(l)&&s(l),b(B)}else s(l);h=n(l)}if(h!==null)var J=!0;else{var et=n(c);et!==null&&L(v,et.startTime-B),J=!1}return J}finally{h=null,d=q,f=!1}}var k=!1,I=null,C=-1,N=5,$=-1;function A(){return!(e.unstable_now()-$<N)}function R(){if(I!==null){var E=e.unstable_now();$=E;var B=!0;try{B=I(!0,E)}finally{B?z():(k=!1,I=null)}}else k=!1}var z;if(typeof y=="function")z=function(){y(R)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,F=U.port2;U.port1.onmessage=R,z=function(){F.postMessage(null)}}else z=function(){m(R,0)};function P(E){I=E,k||(k=!0,z())}function L(E,B){C=m(function(){E(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(E){E.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,P(w))},e.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<E?Math.floor(1e3/E):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(E){switch(d){case 1:case 2:case 3:var B=3;break;default:B=d}var q=d;d=B;try{return E()}finally{d=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(E,B){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var q=d;d=E;try{return B()}finally{d=q}},e.unstable_scheduleCallback=function(E,B,q){var Y=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?Y+q:Y):q=Y,E){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=q+Q,E={id:u++,callback:B,priorityLevel:E,startTime:q,expirationTime:Q,sortIndex:-1},q>Y?(E.sortIndex=q,t(c,E),n(l)===null&&E===n(c)&&(g?(x(C),C=-1):g=!0,L(v,q-Y))):(E.sortIndex=Q,t(l,E),p||f||(p=!0,P(w))),E},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(E){var B=d;return function(){var q=d;d=B;try{return E.apply(this,arguments)}finally{d=q}}}})(NF);TF.exports=NF;var l8=TF.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c8=K,er=l8;function it(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _F=new Set,Bf={};function Sc(e,t){Nu(e,t),Nu(e+"Capture",t)}function Nu(e,t){for(Bf[e]=t,e=0;e<t.length;e++)_F.add(t[e])}var oo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),D2=Object.prototype.hasOwnProperty,u8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iE={},oE={};function h8(e){return D2.call(oE,e)?!0:D2.call(iE,e)?!1:u8.test(e)?oE[e]=!0:(iE[e]=!0,!1)}function d8(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function f8(e,t,n,s){if(t===null||typeof t>"u"||d8(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ys(e,t,n,s,r,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Fn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Fn[e]=new ys(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Fn[t]=new ys(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Fn[e]=new ys(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Fn[e]=new ys(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Fn[e]=new ys(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Fn[e]=new ys(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Fn[e]=new ys(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Fn[e]=new ys(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Fn[e]=new ys(e,5,!1,e.toLowerCase(),null,!1,!1)});var aC=/[\-:]([a-z])/g;function lC(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(aC,lC);Fn[t]=new ys(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(aC,lC);Fn[t]=new ys(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(aC,lC);Fn[t]=new ys(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Fn[e]=new ys(e,1,!1,e.toLowerCase(),null,!1,!1)});Fn.xlinkHref=new ys("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Fn[e]=new ys(e,1,!1,e.toLowerCase(),null,!0,!0)});function cC(e,t,n,s){var r=Fn.hasOwnProperty(t)?Fn[t]:null;(r!==null?r.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(f8(t,n,r,s)&&(n=null),s||r===null?h8(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=n===null?r.type===3?!1:"":n:(t=r.attributeName,s=r.attributeNamespace,n===null?e.removeAttribute(t):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var vo=c8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gg=Symbol.for("react.element"),Zc=Symbol.for("react.portal"),Qc=Symbol.for("react.fragment"),uC=Symbol.for("react.strict_mode"),O2=Symbol.for("react.profiler"),$F=Symbol.for("react.provider"),EF=Symbol.for("react.context"),hC=Symbol.for("react.forward_ref"),P2=Symbol.for("react.suspense"),F2=Symbol.for("react.suspense_list"),dC=Symbol.for("react.memo"),zo=Symbol.for("react.lazy"),AF=Symbol.for("react.offscreen"),aE=Symbol.iterator;function _d(e){return e===null||typeof e!="object"?null:(e=aE&&e[aE]||e["@@iterator"],typeof e=="function"?e:null)}var Re=Object.assign,yw;function qd(e){if(yw===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);yw=t&&t[1]||""}return`
`+yw+e}var bw=!1;function vw(e,t){if(!e||bw)return"";bw=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var s=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){s=c}e.call(t.prototype)}else{try{throw Error()}catch(c){s=c}e()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{bw=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?qd(e):""}function p8(e){switch(e.tag){case 5:return qd(e.type);case 16:return qd("Lazy");case 13:return qd("Suspense");case 19:return qd("SuspenseList");case 0:case 2:case 15:return e=vw(e.type,!1),e;case 11:return e=vw(e.type.render,!1),e;case 1:return e=vw(e.type,!0),e;default:return""}}function L2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Qc:return"Fragment";case Zc:return"Portal";case O2:return"Profiler";case uC:return"StrictMode";case P2:return"Suspense";case F2:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case EF:return(e.displayName||"Context")+".Consumer";case $F:return(e._context.displayName||"Context")+".Provider";case hC:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case dC:return t=e.displayName||null,t!==null?t:L2(e.type)||"Memo";case zo:t=e._payload,e=e._init;try{return L2(e(t))}catch{}}return null}function m8(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return L2(t);case 8:return t===uC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ma(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function RF(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function g8(e){var t=RF(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hg(e){e._valueTracker||(e._valueTracker=g8(e))}function DF(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=RF(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function wx(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function M2(e,t){var n=t.checked;return Re({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function lE(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=ma(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function OF(e,t){t=t.checked,t!=null&&cC(e,"checked",t,!1)}function z2(e,t){OF(e,t);var n=ma(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?B2(e,t.type,n):t.hasOwnProperty("defaultValue")&&B2(e,t.type,ma(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function cE(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function B2(e,t,n){(t!=="number"||wx(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Xd=Array.isArray;function gu(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+ma(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,s&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function V2(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(it(91));return Re({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function uE(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(it(92));if(Xd(n)){if(1<n.length)throw Error(it(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ma(n)}}function PF(e,t){var n=ma(t.value),s=ma(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function hE(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function FF(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function W2(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?FF(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Kg,LF=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,r){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Kg=Kg||document.createElement("div"),Kg.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Kg.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Vf(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var xf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},x8=["Webkit","ms","Moz","O"];Object.keys(xf).forEach(function(e){x8.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xf[t]=xf[e]})});function MF(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||xf.hasOwnProperty(e)&&xf[e]?(""+t).trim():t+"px"}function zF(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=MF(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,r):e[n]=r}}var y8=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function U2(e,t){if(t){if(y8[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(it(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(it(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(it(61))}if(t.style!=null&&typeof t.style!="object")throw Error(it(62))}}function j2(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var G2=null;function fC(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var H2=null,xu=null,yu=null;function dE(e){if(e=Up(e)){if(typeof H2!="function")throw Error(it(280));var t=e.stateNode;t&&(t=g1(t),H2(e.stateNode,e.type,t))}}function BF(e){xu?yu?yu.push(e):yu=[e]:xu=e}function VF(){if(xu){var e=xu,t=yu;if(yu=xu=null,dE(e),t)for(e=0;e<t.length;e++)dE(t[e])}}function WF(e,t){return e(t)}function UF(){}var ww=!1;function jF(e,t,n){if(ww)return e(t,n);ww=!0;try{return WF(e,t,n)}finally{ww=!1,(xu!==null||yu!==null)&&(UF(),VF())}}function Wf(e,t){var n=e.stateNode;if(n===null)return null;var s=g1(n);if(s===null)return null;n=s[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break t;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(it(231,t,typeof n));return n}var K2=!1;if(oo)try{var $d={};Object.defineProperty($d,"passive",{get:function(){K2=!0}}),window.addEventListener("test",$d,$d),window.removeEventListener("test",$d,$d)}catch{K2=!1}function b8(e,t,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var yf=!1,Sx=null,kx=!1,q2=null,v8={onError:function(e){yf=!0,Sx=e}};function w8(e,t,n,s,r,i,o,a,l){yf=!1,Sx=null,b8.apply(v8,arguments)}function S8(e,t,n,s,r,i,o,a,l){if(w8.apply(this,arguments),yf){if(yf){var c=Sx;yf=!1,Sx=null}else throw Error(it(198));kx||(kx=!0,q2=c)}}function kc(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function GF(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function fE(e){if(kc(e)!==e)throw Error(it(188))}function k8(e){var t=e.alternate;if(!t){if(t=kc(e),t===null)throw Error(it(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return fE(r),e;if(i===s)return fE(r),t;i=i.sibling}throw Error(it(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(it(189))}}if(n.alternate!==s)throw Error(it(190))}if(n.tag!==3)throw Error(it(188));return n.stateNode.current===n?e:t}function HF(e){return e=k8(e),e!==null?KF(e):null}function KF(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=KF(e);if(t!==null)return t;e=e.sibling}return null}var qF=er.unstable_scheduleCallback,pE=er.unstable_cancelCallback,C8=er.unstable_shouldYield,I8=er.unstable_requestPaint,Ge=er.unstable_now,T8=er.unstable_getCurrentPriorityLevel,pC=er.unstable_ImmediatePriority,XF=er.unstable_UserBlockingPriority,Cx=er.unstable_NormalPriority,N8=er.unstable_LowPriority,YF=er.unstable_IdlePriority,d1=null,pi=null;function _8(e){if(pi&&typeof pi.onCommitFiberRoot=="function")try{pi.onCommitFiberRoot(d1,e,void 0,(e.current.flags&128)===128)}catch{}}var Vr=Math.clz32?Math.clz32:A8,$8=Math.log,E8=Math.LN2;function A8(e){return e>>>=0,e===0?32:31-($8(e)/E8|0)|0}var qg=64,Xg=4194304;function Yd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ix(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,r=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=Yd(a):(i&=o,i!==0&&(s=Yd(i)))}else o=n&~r,o!==0?s=Yd(o):i!==0&&(s=Yd(i));if(s===0)return 0;if(t!==0&&t!==s&&!(t&r)&&(r=s&-s,i=t&-t,r>=i||r===16&&(i&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-Vr(t),r=1<<n,s|=e[n],t&=~r;return s}function R8(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D8(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Vr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=R8(a,t)):l<=t&&(e.expiredLanes|=a),i&=~a}}function X2(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ZF(){var e=qg;return qg<<=1,!(qg&4194240)&&(qg=64),e}function Sw(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Vp(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Vr(t),e[t]=n}function O8(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-Vr(n),i=1<<r;t[r]=0,s[r]=-1,e[r]=-1,n&=~i}}function mC(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-Vr(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}var ne=0;function QF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var JF,gC,t3,e3,n3,Y2=!1,Yg=[],na=null,sa=null,ra=null,Uf=new Map,jf=new Map,Wo=[],P8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mE(e,t){switch(e){case"focusin":case"focusout":na=null;break;case"dragenter":case"dragleave":sa=null;break;case"mouseover":case"mouseout":ra=null;break;case"pointerover":case"pointerout":Uf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":jf.delete(t.pointerId)}}function Ed(e,t,n,s,r,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},t!==null&&(t=Up(t),t!==null&&gC(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function F8(e,t,n,s,r){switch(t){case"focusin":return na=Ed(na,e,t,n,s,r),!0;case"dragenter":return sa=Ed(sa,e,t,n,s,r),!0;case"mouseover":return ra=Ed(ra,e,t,n,s,r),!0;case"pointerover":var i=r.pointerId;return Uf.set(i,Ed(Uf.get(i)||null,e,t,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,jf.set(i,Ed(jf.get(i)||null,e,t,n,s,r)),!0}return!1}function s3(e){var t=vl(e.target);if(t!==null){var n=kc(t);if(n!==null){if(t=n.tag,t===13){if(t=GF(n),t!==null){e.blockedOn=t,n3(e.priority,function(){t3(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function j0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Z2(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);G2=s,n.target.dispatchEvent(s),G2=null}else return t=Up(n),t!==null&&gC(t),e.blockedOn=n,!1;t.shift()}return!0}function gE(e,t,n){j0(e)&&n.delete(t)}function L8(){Y2=!1,na!==null&&j0(na)&&(na=null),sa!==null&&j0(sa)&&(sa=null),ra!==null&&j0(ra)&&(ra=null),Uf.forEach(gE),jf.forEach(gE)}function Ad(e,t){e.blockedOn===t&&(e.blockedOn=null,Y2||(Y2=!0,er.unstable_scheduleCallback(er.unstable_NormalPriority,L8)))}function Gf(e){function t(r){return Ad(r,e)}if(0<Yg.length){Ad(Yg[0],e);for(var n=1;n<Yg.length;n++){var s=Yg[n];s.blockedOn===e&&(s.blockedOn=null)}}for(na!==null&&Ad(na,e),sa!==null&&Ad(sa,e),ra!==null&&Ad(ra,e),Uf.forEach(t),jf.forEach(t),n=0;n<Wo.length;n++)s=Wo[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Wo.length&&(n=Wo[0],n.blockedOn===null);)s3(n),n.blockedOn===null&&Wo.shift()}var bu=vo.ReactCurrentBatchConfig,Tx=!0;function M8(e,t,n,s){var r=ne,i=bu.transition;bu.transition=null;try{ne=1,xC(e,t,n,s)}finally{ne=r,bu.transition=i}}function z8(e,t,n,s){var r=ne,i=bu.transition;bu.transition=null;try{ne=4,xC(e,t,n,s)}finally{ne=r,bu.transition=i}}function xC(e,t,n,s){if(Tx){var r=Z2(e,t,n,s);if(r===null)Rw(e,t,s,Nx,n),mE(e,s);else if(F8(r,e,t,n,s))s.stopPropagation();else if(mE(e,s),t&4&&-1<P8.indexOf(e)){for(;r!==null;){var i=Up(r);if(i!==null&&JF(i),i=Z2(e,t,n,s),i===null&&Rw(e,t,s,Nx,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Rw(e,t,s,null,n)}}var Nx=null;function Z2(e,t,n,s){if(Nx=null,e=fC(s),e=vl(e),e!==null)if(t=kc(e),t===null)e=null;else if(n=t.tag,n===13){if(e=GF(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Nx=e,null}function r3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(T8()){case pC:return 1;case XF:return 4;case Cx:case N8:return 16;case YF:return 536870912;default:return 16}default:return 16}}var jo=null,yC=null,G0=null;function i3(){if(G0)return G0;var e,t=yC,n=t.length,s,r="value"in jo?jo.value:jo.textContent,i=r.length;for(e=0;e<n&&t[e]===r[e];e++);var o=n-e;for(s=1;s<=o&&t[n-s]===r[i-s];s++);return G0=r.slice(e,1<s?1-s:void 0)}function H0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zg(){return!0}function xE(){return!1}function or(e){function t(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Zg:xE,this.isPropagationStopped=xE,this}return Re(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zg)},persist:function(){},isPersistent:Zg}),t}var ih={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bC=or(ih),Wp=Re({},ih,{view:0,detail:0}),B8=or(Wp),kw,Cw,Rd,f1=Re({},Wp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vC,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Rd&&(Rd&&e.type==="mousemove"?(kw=e.screenX-Rd.screenX,Cw=e.screenY-Rd.screenY):Cw=kw=0,Rd=e),kw)},movementY:function(e){return"movementY"in e?e.movementY:Cw}}),yE=or(f1),V8=Re({},f1,{dataTransfer:0}),W8=or(V8),U8=Re({},Wp,{relatedTarget:0}),Iw=or(U8),j8=Re({},ih,{animationName:0,elapsedTime:0,pseudoElement:0}),G8=or(j8),H8=Re({},ih,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),K8=or(H8),q8=Re({},ih,{data:0}),bE=or(q8),X8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Y8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Z8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Q8(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Z8[e])?!!t[e]:!1}function vC(){return Q8}var J8=Re({},Wp,{key:function(e){if(e.key){var t=X8[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=H0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Y8[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vC,charCode:function(e){return e.type==="keypress"?H0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?H0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),tG=or(J8),eG=Re({},f1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vE=or(eG),nG=Re({},Wp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vC}),sG=or(nG),rG=Re({},ih,{propertyName:0,elapsedTime:0,pseudoElement:0}),iG=or(rG),oG=Re({},f1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),aG=or(oG),lG=[9,13,27,32],wC=oo&&"CompositionEvent"in window,bf=null;oo&&"documentMode"in document&&(bf=document.documentMode);var cG=oo&&"TextEvent"in window&&!bf,o3=oo&&(!wC||bf&&8<bf&&11>=bf),wE=" ",SE=!1;function a3(e,t){switch(e){case"keyup":return lG.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function l3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Jc=!1;function uG(e,t){switch(e){case"compositionend":return l3(t);case"keypress":return t.which!==32?null:(SE=!0,wE);case"textInput":return e=t.data,e===wE&&SE?null:e;default:return null}}function hG(e,t){if(Jc)return e==="compositionend"||!wC&&a3(e,t)?(e=i3(),G0=yC=jo=null,Jc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return o3&&t.locale!=="ko"?null:t.data;default:return null}}var dG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kE(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!dG[e.type]:t==="textarea"}function c3(e,t,n,s){BF(s),t=_x(t,"onChange"),0<t.length&&(n=new bC("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var vf=null,Hf=null;function fG(e){v3(e,0)}function p1(e){var t=nu(e);if(DF(t))return e}function pG(e,t){if(e==="change")return t}var u3=!1;if(oo){var Tw;if(oo){var Nw="oninput"in document;if(!Nw){var CE=document.createElement("div");CE.setAttribute("oninput","return;"),Nw=typeof CE.oninput=="function"}Tw=Nw}else Tw=!1;u3=Tw&&(!document.documentMode||9<document.documentMode)}function IE(){vf&&(vf.detachEvent("onpropertychange",h3),Hf=vf=null)}function h3(e){if(e.propertyName==="value"&&p1(Hf)){var t=[];c3(t,Hf,e,fC(e)),jF(fG,t)}}function mG(e,t,n){e==="focusin"?(IE(),vf=t,Hf=n,vf.attachEvent("onpropertychange",h3)):e==="focusout"&&IE()}function gG(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return p1(Hf)}function xG(e,t){if(e==="click")return p1(t)}function yG(e,t){if(e==="input"||e==="change")return p1(t)}function bG(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qr=typeof Object.is=="function"?Object.is:bG;function Kf(e,t){if(qr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!D2.call(t,r)||!qr(e[r],t[r]))return!1}return!0}function TE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function NE(e,t){var n=TE(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=TE(n)}}function d3(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?d3(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function f3(){for(var e=window,t=wx();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=wx(e.document)}return t}function SC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function vG(e){var t=f3(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&d3(n.ownerDocument.documentElement,n)){if(s!==null&&SC(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!e.extend&&i>s&&(r=s,s=i,i=r),r=NE(n,i);var o=NE(n,s);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),i>s?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var wG=oo&&"documentMode"in document&&11>=document.documentMode,tu=null,Q2=null,wf=null,J2=!1;function _E(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;J2||tu==null||tu!==wx(s)||(s=tu,"selectionStart"in s&&SC(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),wf&&Kf(wf,s)||(wf=s,s=_x(Q2,"onSelect"),0<s.length&&(t=new bC("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=tu)))}function Qg(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var eu={animationend:Qg("Animation","AnimationEnd"),animationiteration:Qg("Animation","AnimationIteration"),animationstart:Qg("Animation","AnimationStart"),transitionend:Qg("Transition","TransitionEnd")},_w={},p3={};oo&&(p3=document.createElement("div").style,"AnimationEvent"in window||(delete eu.animationend.animation,delete eu.animationiteration.animation,delete eu.animationstart.animation),"TransitionEvent"in window||delete eu.transitionend.transition);function m1(e){if(_w[e])return _w[e];if(!eu[e])return e;var t=eu[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in p3)return _w[e]=t[n];return e}var m3=m1("animationend"),g3=m1("animationiteration"),x3=m1("animationstart"),y3=m1("transitionend"),b3=new Map,$E="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(e,t){b3.set(e,t),Sc(t,[e])}for(var $w=0;$w<$E.length;$w++){var Ew=$E[$w],SG=Ew.toLowerCase(),kG=Ew[0].toUpperCase()+Ew.slice(1);Oa(SG,"on"+kG)}Oa(m3,"onAnimationEnd");Oa(g3,"onAnimationIteration");Oa(x3,"onAnimationStart");Oa("dblclick","onDoubleClick");Oa("focusin","onFocus");Oa("focusout","onBlur");Oa(y3,"onTransitionEnd");Nu("onMouseEnter",["mouseout","mouseover"]);Nu("onMouseLeave",["mouseout","mouseover"]);Nu("onPointerEnter",["pointerout","pointerover"]);Nu("onPointerLeave",["pointerout","pointerover"]);Sc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CG=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zd));function EE(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,S8(s,t,void 0,e),e.currentTarget=null}function v3(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;t:{var i=void 0;if(t)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break t;EE(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break t;EE(r,a,c),i=l}}}if(kx)throw e=q2,kx=!1,q2=null,e}function me(e,t){var n=t[rS];n===void 0&&(n=t[rS]=new Set);var s=e+"__bubble";n.has(s)||(w3(t,e,2,!1),n.add(s))}function Aw(e,t,n){var s=0;t&&(s|=4),w3(n,e,s,t)}var Jg="_reactListening"+Math.random().toString(36).slice(2);function qf(e){if(!e[Jg]){e[Jg]=!0,_F.forEach(function(n){n!=="selectionchange"&&(CG.has(n)||Aw(n,!1,e),Aw(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jg]||(t[Jg]=!0,Aw("selectionchange",!1,t))}}function w3(e,t,n,s){switch(r3(t)){case 1:var r=M8;break;case 4:r=z8;break;default:r=xC}n=r.bind(null,t,n,e),r=void 0,!K2||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),s?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Rw(e,t,n,s,r){var i=s;if(!(t&1)&&!(t&2)&&s!==null)t:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=vl(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue t}a=a.parentNode}}s=s.return}jF(function(){var c=i,u=fC(n),h=[];t:{var d=b3.get(e);if(d!==void 0){var f=bC,p=e;switch(e){case"keypress":if(H0(n)===0)break t;case"keydown":case"keyup":f=tG;break;case"focusin":p="focus",f=Iw;break;case"focusout":p="blur",f=Iw;break;case"beforeblur":case"afterblur":f=Iw;break;case"click":if(n.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=yE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=W8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=sG;break;case m3:case g3:case x3:f=G8;break;case y3:f=iG;break;case"scroll":f=B8;break;case"wheel":f=aG;break;case"copy":case"cut":case"paste":f=K8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=vE}var g=(t&4)!==0,m=!g&&e==="scroll",x=g?d!==null?d+"Capture":null:d;g=[];for(var y=c,b;y!==null;){b=y;var v=b.stateNode;if(b.tag===5&&v!==null&&(b=v,x!==null&&(v=Wf(y,x),v!=null&&g.push(Xf(y,v,b)))),m)break;y=y.return}0<g.length&&(d=new f(d,p,null,n,u),h.push({event:d,listeners:g}))}}if(!(t&7)){t:{if(d=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",d&&n!==G2&&(p=n.relatedTarget||n.fromElement)&&(vl(p)||p[ao]))break t;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?vl(p):null,p!==null&&(m=kc(p),p!==m||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(g=yE,v="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=vE,v="onPointerLeave",x="onPointerEnter",y="pointer"),m=f==null?d:nu(f),b=p==null?d:nu(p),d=new g(v,y+"leave",f,n,u),d.target=m,d.relatedTarget=b,v=null,vl(u)===c&&(g=new g(x,y+"enter",p,n,u),g.target=b,g.relatedTarget=m,v=g),m=v,f&&p)e:{for(g=f,x=p,y=0,b=g;b;b=Uc(b))y++;for(b=0,v=x;v;v=Uc(v))b++;for(;0<y-b;)g=Uc(g),y--;for(;0<b-y;)x=Uc(x),b--;for(;y--;){if(g===x||x!==null&&g===x.alternate)break e;g=Uc(g),x=Uc(x)}g=null}else g=null;f!==null&&AE(h,d,f,g,!1),p!==null&&m!==null&&AE(h,m,p,g,!0)}}t:{if(d=c?nu(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var w=pG;else if(kE(d))if(u3)w=yG;else{w=gG;var k=mG}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=xG);if(w&&(w=w(e,c))){c3(h,w,n,u);break t}k&&k(e,d,c),e==="focusout"&&(k=d._wrapperState)&&k.controlled&&d.type==="number"&&B2(d,"number",d.value)}switch(k=c?nu(c):window,e){case"focusin":(kE(k)||k.contentEditable==="true")&&(tu=k,Q2=c,wf=null);break;case"focusout":wf=Q2=tu=null;break;case"mousedown":J2=!0;break;case"contextmenu":case"mouseup":case"dragend":J2=!1,_E(h,n,u);break;case"selectionchange":if(wG)break;case"keydown":case"keyup":_E(h,n,u)}var I;if(wC)t:{switch(e){case"compositionstart":var C="onCompositionStart";break t;case"compositionend":C="onCompositionEnd";break t;case"compositionupdate":C="onCompositionUpdate";break t}C=void 0}else Jc?a3(e,n)&&(C="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(o3&&n.locale!=="ko"&&(Jc||C!=="onCompositionStart"?C==="onCompositionEnd"&&Jc&&(I=i3()):(jo=u,yC="value"in jo?jo.value:jo.textContent,Jc=!0)),k=_x(c,C),0<k.length&&(C=new bE(C,e,null,n,u),h.push({event:C,listeners:k}),I?C.data=I:(I=l3(n),I!==null&&(C.data=I)))),(I=cG?uG(e,n):hG(e,n))&&(c=_x(c,"onBeforeInput"),0<c.length&&(u=new bE("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=I))}v3(h,t)})}function Xf(e,t,n){return{instance:e,listener:t,currentTarget:n}}function _x(e,t){for(var n=t+"Capture",s=[];e!==null;){var r=e,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Wf(e,n),i!=null&&s.unshift(Xf(e,i,r)),i=Wf(e,t),i!=null&&s.push(Xf(e,i,r))),e=e.return}return s}function Uc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function AE(e,t,n,s,r){for(var i=t._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=Wf(n,i),l!=null&&o.unshift(Xf(n,l,a))):r||(l=Wf(n,i),l!=null&&o.push(Xf(n,l,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var IG=/\r\n?/g,TG=/\u0000|\uFFFD/g;function RE(e){return(typeof e=="string"?e:""+e).replace(IG,`
`).replace(TG,"")}function t0(e,t,n){if(t=RE(t),RE(e)!==t&&n)throw Error(it(425))}function $x(){}var tS=null,eS=null;function nS(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sS=typeof setTimeout=="function"?setTimeout:void 0,NG=typeof clearTimeout=="function"?clearTimeout:void 0,DE=typeof Promise=="function"?Promise:void 0,_G=typeof queueMicrotask=="function"?queueMicrotask:typeof DE<"u"?function(e){return DE.resolve(null).then(e).catch($G)}:sS;function $G(e){setTimeout(function(){throw e})}function Dw(e,t){var n=t,s=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){e.removeChild(r),Gf(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);Gf(t)}function ia(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function OE(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var oh=Math.random().toString(36).slice(2),hi="__reactFiber$"+oh,Yf="__reactProps$"+oh,ao="__reactContainer$"+oh,rS="__reactEvents$"+oh,EG="__reactListeners$"+oh,AG="__reactHandles$"+oh;function vl(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ao]||n[hi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=OE(e);e!==null;){if(n=e[hi])return n;e=OE(e)}return t}e=n,n=e.parentNode}return null}function Up(e){return e=e[hi]||e[ao],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function nu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(it(33))}function g1(e){return e[Yf]||null}var iS=[],su=-1;function Pa(e){return{current:e}}function ge(e){0>su||(e.current=iS[su],iS[su]=null,su--)}function ue(e,t){su++,iS[su]=e.current,e.current=t}var ga={},Zn=Pa(ga),Es=Pa(!1),zl=ga;function _u(e,t){var n=e.type.contextTypes;if(!n)return ga;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=t[i];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function As(e){return e=e.childContextTypes,e!=null}function Ex(){ge(Es),ge(Zn)}function PE(e,t,n){if(Zn.current!==ga)throw Error(it(168));ue(Zn,t),ue(Es,n)}function S3(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in t))throw Error(it(108,m8(e)||"Unknown",r));return Re({},n,s)}function Ax(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ga,zl=Zn.current,ue(Zn,e),ue(Es,Es.current),!0}function FE(e,t,n){var s=e.stateNode;if(!s)throw Error(it(169));n?(e=S3(e,t,zl),s.__reactInternalMemoizedMergedChildContext=e,ge(Es),ge(Zn),ue(Zn,e)):ge(Es),ue(Es,n)}var zi=null,x1=!1,Ow=!1;function k3(e){zi===null?zi=[e]:zi.push(e)}function RG(e){x1=!0,k3(e)}function Fa(){if(!Ow&&zi!==null){Ow=!0;var e=0,t=ne;try{var n=zi;for(ne=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}zi=null,x1=!1}catch(r){throw zi!==null&&(zi=zi.slice(e+1)),qF(pC,Fa),r}finally{ne=t,Ow=!1}}return null}var ru=[],iu=0,Rx=null,Dx=0,pr=[],mr=0,Bl=null,Hi=1,Ki="";function il(e,t){ru[iu++]=Dx,ru[iu++]=Rx,Rx=e,Dx=t}function C3(e,t,n){pr[mr++]=Hi,pr[mr++]=Ki,pr[mr++]=Bl,Bl=e;var s=Hi;e=Ki;var r=32-Vr(s)-1;s&=~(1<<r),n+=1;var i=32-Vr(t)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Hi=1<<32-Vr(t)+r|n<<r|s,Ki=i+e}else Hi=1<<i|n<<r|s,Ki=e}function kC(e){e.return!==null&&(il(e,1),C3(e,1,0))}function CC(e){for(;e===Rx;)Rx=ru[--iu],ru[iu]=null,Dx=ru[--iu],ru[iu]=null;for(;e===Bl;)Bl=pr[--mr],pr[mr]=null,Ki=pr[--mr],pr[mr]=null,Hi=pr[--mr],pr[mr]=null}var Qs=null,Ks=null,Se=!1,Lr=null;function I3(e,t){var n=xr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function LE(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Qs=e,Ks=ia(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Qs=e,Ks=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Bl!==null?{id:Hi,overflow:Ki}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=xr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Qs=e,Ks=null,!0):!1;default:return!1}}function oS(e){return(e.mode&1)!==0&&(e.flags&128)===0}function aS(e){if(Se){var t=Ks;if(t){var n=t;if(!LE(e,t)){if(oS(e))throw Error(it(418));t=ia(n.nextSibling);var s=Qs;t&&LE(e,t)?I3(s,n):(e.flags=e.flags&-4097|2,Se=!1,Qs=e)}}else{if(oS(e))throw Error(it(418));e.flags=e.flags&-4097|2,Se=!1,Qs=e}}}function ME(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qs=e}function e0(e){if(e!==Qs)return!1;if(!Se)return ME(e),Se=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!nS(e.type,e.memoizedProps)),t&&(t=Ks)){if(oS(e))throw T3(),Error(it(418));for(;t;)I3(e,t),t=ia(t.nextSibling)}if(ME(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(it(317));t:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ks=ia(e.nextSibling);break t}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ks=null}}else Ks=Qs?ia(e.stateNode.nextSibling):null;return!0}function T3(){for(var e=Ks;e;)e=ia(e.nextSibling)}function $u(){Ks=Qs=null,Se=!1}function IC(e){Lr===null?Lr=[e]:Lr.push(e)}var DG=vo.ReactCurrentBatchConfig;function Dd(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(it(309));var s=n.stateNode}if(!s)throw Error(it(147,e));var r=s,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(it(284));if(!n._owner)throw Error(it(290,e))}return e}function n0(e,t){throw e=Object.prototype.toString.call(t),Error(it(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function zE(e){var t=e._init;return t(e._payload)}function N3(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function n(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function s(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function r(x,y){return x=ca(x,y),x.index=0,x.sibling=null,x}function i(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,y,b,v){return y===null||y.tag!==6?(y=Vw(b,x.mode,v),y.return=x,y):(y=r(y,b),y.return=x,y)}function l(x,y,b,v){var w=b.type;return w===Qc?u(x,y,b.props.children,v,b.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===zo&&zE(w)===y.type)?(v=r(y,b.props),v.ref=Dd(x,y,b),v.return=x,v):(v=J0(b.type,b.key,b.props,null,x.mode,v),v.ref=Dd(x,y,b),v.return=x,v)}function c(x,y,b,v){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Ww(b,x.mode,v),y.return=x,y):(y=r(y,b.children||[]),y.return=x,y)}function u(x,y,b,v,w){return y===null||y.tag!==7?(y=$l(b,x.mode,v,w),y.return=x,y):(y=r(y,b),y.return=x,y)}function h(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Vw(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Gg:return b=J0(y.type,y.key,y.props,null,x.mode,b),b.ref=Dd(x,null,y),b.return=x,b;case Zc:return y=Ww(y,x.mode,b),y.return=x,y;case zo:var v=y._init;return h(x,v(y._payload),b)}if(Xd(y)||_d(y))return y=$l(y,x.mode,b,null),y.return=x,y;n0(x,y)}return null}function d(x,y,b,v){var w=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return w!==null?null:a(x,y,""+b,v);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Gg:return b.key===w?l(x,y,b,v):null;case Zc:return b.key===w?c(x,y,b,v):null;case zo:return w=b._init,d(x,y,w(b._payload),v)}if(Xd(b)||_d(b))return w!==null?null:u(x,y,b,v,null);n0(x,b)}return null}function f(x,y,b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return x=x.get(b)||null,a(y,x,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Gg:return x=x.get(v.key===null?b:v.key)||null,l(y,x,v,w);case Zc:return x=x.get(v.key===null?b:v.key)||null,c(y,x,v,w);case zo:var k=v._init;return f(x,y,b,k(v._payload),w)}if(Xd(v)||_d(v))return x=x.get(b)||null,u(y,x,v,w,null);n0(y,v)}return null}function p(x,y,b,v){for(var w=null,k=null,I=y,C=y=0,N=null;I!==null&&C<b.length;C++){I.index>C?(N=I,I=null):N=I.sibling;var $=d(x,I,b[C],v);if($===null){I===null&&(I=N);break}e&&I&&$.alternate===null&&t(x,I),y=i($,y,C),k===null?w=$:k.sibling=$,k=$,I=N}if(C===b.length)return n(x,I),Se&&il(x,C),w;if(I===null){for(;C<b.length;C++)I=h(x,b[C],v),I!==null&&(y=i(I,y,C),k===null?w=I:k.sibling=I,k=I);return Se&&il(x,C),w}for(I=s(x,I);C<b.length;C++)N=f(I,x,C,b[C],v),N!==null&&(e&&N.alternate!==null&&I.delete(N.key===null?C:N.key),y=i(N,y,C),k===null?w=N:k.sibling=N,k=N);return e&&I.forEach(function(A){return t(x,A)}),Se&&il(x,C),w}function g(x,y,b,v){var w=_d(b);if(typeof w!="function")throw Error(it(150));if(b=w.call(b),b==null)throw Error(it(151));for(var k=w=null,I=y,C=y=0,N=null,$=b.next();I!==null&&!$.done;C++,$=b.next()){I.index>C?(N=I,I=null):N=I.sibling;var A=d(x,I,$.value,v);if(A===null){I===null&&(I=N);break}e&&I&&A.alternate===null&&t(x,I),y=i(A,y,C),k===null?w=A:k.sibling=A,k=A,I=N}if($.done)return n(x,I),Se&&il(x,C),w;if(I===null){for(;!$.done;C++,$=b.next())$=h(x,$.value,v),$!==null&&(y=i($,y,C),k===null?w=$:k.sibling=$,k=$);return Se&&il(x,C),w}for(I=s(x,I);!$.done;C++,$=b.next())$=f(I,x,C,$.value,v),$!==null&&(e&&$.alternate!==null&&I.delete($.key===null?C:$.key),y=i($,y,C),k===null?w=$:k.sibling=$,k=$);return e&&I.forEach(function(R){return t(x,R)}),Se&&il(x,C),w}function m(x,y,b,v){if(typeof b=="object"&&b!==null&&b.type===Qc&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Gg:t:{for(var w=b.key,k=y;k!==null;){if(k.key===w){if(w=b.type,w===Qc){if(k.tag===7){n(x,k.sibling),y=r(k,b.props.children),y.return=x,x=y;break t}}else if(k.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===zo&&zE(w)===k.type){n(x,k.sibling),y=r(k,b.props),y.ref=Dd(x,k,b),y.return=x,x=y;break t}n(x,k);break}else t(x,k);k=k.sibling}b.type===Qc?(y=$l(b.props.children,x.mode,v,b.key),y.return=x,x=y):(v=J0(b.type,b.key,b.props,null,x.mode,v),v.ref=Dd(x,y,b),v.return=x,x=v)}return o(x);case Zc:t:{for(k=b.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(x,y.sibling),y=r(y,b.children||[]),y.return=x,x=y;break t}else{n(x,y);break}else t(x,y);y=y.sibling}y=Ww(b,x.mode,v),y.return=x,x=y}return o(x);case zo:return k=b._init,m(x,y,k(b._payload),v)}if(Xd(b))return p(x,y,b,v);if(_d(b))return g(x,y,b,v);n0(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(x,y.sibling),y=r(y,b),y.return=x,x=y):(n(x,y),y=Vw(b,x.mode,v),y.return=x,x=y),o(x)):n(x,y)}return m}var Eu=N3(!0),_3=N3(!1),Ox=Pa(null),Px=null,ou=null,TC=null;function NC(){TC=ou=Px=null}function _C(e){var t=Ox.current;ge(Ox),e._currentValue=t}function lS(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function vu(e,t){Px=e,TC=ou=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(_s=!0),e.firstContext=null)}function Cr(e){var t=e._currentValue;if(TC!==e)if(e={context:e,memoizedValue:t,next:null},ou===null){if(Px===null)throw Error(it(308));ou=e,Px.dependencies={lanes:0,firstContext:e}}else ou=ou.next=e;return t}var wl=null;function $C(e){wl===null?wl=[e]:wl.push(e)}function $3(e,t,n,s){var r=t.interleaved;return r===null?(n.next=n,$C(t)):(n.next=r.next,r.next=n),t.interleaved=n,lo(e,s)}function lo(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Bo=!1;function EC(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function E3(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Qi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function oa(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Ht&2){var r=s.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),s.pending=t,lo(e,n)}return r=s.interleaved,r===null?(t.next=t,$C(s)):(t.next=r.next,r.next=t),s.interleaved=t,lo(e,n)}function K0(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,mC(e,n)}}function BE(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=t:i=i.next=t}else r=i=t;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fx(e,t,n,s){var r=e.updateQueue;Bo=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;o=0,u=c=l=null,a=i;do{var d=a.lane,f=a.eventTime;if((s&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var p=e,g=a;switch(d=t,f=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(f,h,d);break t}h=p;break t;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break t;h=Re({},h,d);break t;case 2:Bo=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(u===null&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else i===null&&(r.shared.lanes=0);Wl|=o,e.lanes=o,e.memoizedState=h}}function VE(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(it(191,r));r.call(s)}}}var jp={},mi=Pa(jp),Zf=Pa(jp),Qf=Pa(jp);function Sl(e){if(e===jp)throw Error(it(174));return e}function AC(e,t){switch(ue(Qf,t),ue(Zf,e),ue(mi,jp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:W2(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=W2(t,e)}ge(mi),ue(mi,t)}function Au(){ge(mi),ge(Zf),ge(Qf)}function A3(e){Sl(Qf.current);var t=Sl(mi.current),n=W2(t,e.type);t!==n&&(ue(Zf,e),ue(mi,n))}function RC(e){Zf.current===e&&(ge(mi),ge(Zf))}var _e=Pa(0);function Lx(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Pw=[];function DC(){for(var e=0;e<Pw.length;e++)Pw[e]._workInProgressVersionPrimary=null;Pw.length=0}var q0=vo.ReactCurrentDispatcher,Fw=vo.ReactCurrentBatchConfig,Vl=0,Ae=null,on=null,bn=null,Mx=!1,Sf=!1,Jf=0,OG=0;function zn(){throw Error(it(321))}function OC(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!qr(e[n],t[n]))return!1;return!0}function PC(e,t,n,s,r,i){if(Vl=i,Ae=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,q0.current=e===null||e.memoizedState===null?MG:zG,e=n(s,r),Sf){i=0;do{if(Sf=!1,Jf=0,25<=i)throw Error(it(301));i+=1,bn=on=null,t.updateQueue=null,q0.current=BG,e=n(s,r)}while(Sf)}if(q0.current=zx,t=on!==null&&on.next!==null,Vl=0,bn=on=Ae=null,Mx=!1,t)throw Error(it(300));return e}function FC(){var e=Jf!==0;return Jf=0,e}function oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?Ae.memoizedState=bn=e:bn=bn.next=e,bn}function Ir(){if(on===null){var e=Ae.alternate;e=e!==null?e.memoizedState:null}else e=on.next;var t=bn===null?Ae.memoizedState:bn.next;if(t!==null)bn=t,on=e;else{if(e===null)throw Error(it(310));on=e,e={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},bn===null?Ae.memoizedState=bn=e:bn=bn.next=e}return bn}function tp(e,t){return typeof t=="function"?t(e):t}function Lw(e){var t=Ir(),n=t.queue;if(n===null)throw Error(it(311));n.lastRenderedReducer=e;var s=on,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((Vl&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:e(s,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=s):l=l.next=h,Ae.lanes|=u,Wl|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,qr(s,t.memoizedState)||(_s=!0),t.memoizedState=s,t.baseState=o,t.baseQueue=l,n.lastRenderedState=s}if(e=n.interleaved,e!==null){r=e;do i=r.lane,Ae.lanes|=i,Wl|=i,r=r.next;while(r!==e)}else r===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Mw(e){var t=Ir(),n=t.queue;if(n===null)throw Error(it(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,i=t.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=e(i,o.action),o=o.next;while(o!==r);qr(i,t.memoizedState)||(_s=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,s]}function R3(){}function D3(e,t){var n=Ae,s=Ir(),r=t(),i=!qr(s.memoizedState,r);if(i&&(s.memoizedState=r,_s=!0),s=s.queue,LC(F3.bind(null,n,s,e),[e]),s.getSnapshot!==t||i||bn!==null&&bn.memoizedState.tag&1){if(n.flags|=2048,ep(9,P3.bind(null,n,s,r,t),void 0,null),In===null)throw Error(it(349));Vl&30||O3(n,t,r)}return r}function O3(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ae.updateQueue,t===null?(t={lastEffect:null,stores:null},Ae.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function P3(e,t,n,s){t.value=n,t.getSnapshot=s,L3(t)&&M3(e)}function F3(e,t,n){return n(function(){L3(t)&&M3(e)})}function L3(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!qr(e,n)}catch{return!0}}function M3(e){var t=lo(e,1);t!==null&&Wr(t,e,1,-1)}function WE(e){var t=oi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tp,lastRenderedState:e},t.queue=e,e=e.dispatch=LG.bind(null,Ae,e),[t.memoizedState,e]}function ep(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Ae.updateQueue,t===null?(t={lastEffect:null,stores:null},Ae.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function z3(){return Ir().memoizedState}function X0(e,t,n,s){var r=oi();Ae.flags|=e,r.memoizedState=ep(1|t,n,void 0,s===void 0?null:s)}function y1(e,t,n,s){var r=Ir();s=s===void 0?null:s;var i=void 0;if(on!==null){var o=on.memoizedState;if(i=o.destroy,s!==null&&OC(s,o.deps)){r.memoizedState=ep(t,n,i,s);return}}Ae.flags|=e,r.memoizedState=ep(1|t,n,i,s)}function UE(e,t){return X0(8390656,8,e,t)}function LC(e,t){return y1(2048,8,e,t)}function B3(e,t){return y1(4,2,e,t)}function V3(e,t){return y1(4,4,e,t)}function W3(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function U3(e,t,n){return n=n!=null?n.concat([e]):null,y1(4,4,W3.bind(null,t,e),n)}function MC(){}function j3(e,t){var n=Ir();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&OC(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function G3(e,t){var n=Ir();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&OC(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function H3(e,t,n){return Vl&21?(qr(n,t)||(n=ZF(),Ae.lanes|=n,Wl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,_s=!0),e.memoizedState=n)}function PG(e,t){var n=ne;ne=n!==0&&4>n?n:4,e(!0);var s=Fw.transition;Fw.transition={};try{e(!1),t()}finally{ne=n,Fw.transition=s}}function K3(){return Ir().memoizedState}function FG(e,t,n){var s=la(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},q3(e))X3(t,n);else if(n=$3(e,t,n,s),n!==null){var r=cs();Wr(n,e,s,r),Y3(n,t,s)}}function LG(e,t,n){var s=la(e),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(q3(e))X3(t,r);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,qr(a,o)){var l=t.interleaved;l===null?(r.next=r,$C(t)):(r.next=l.next,l.next=r),t.interleaved=r;return}}catch{}finally{}n=$3(e,t,r,s),n!==null&&(r=cs(),Wr(n,e,s,r),Y3(n,t,s))}}function q3(e){var t=e.alternate;return e===Ae||t!==null&&t===Ae}function X3(e,t){Sf=Mx=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Y3(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,mC(e,n)}}var zx={readContext:Cr,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},MG={readContext:Cr,useCallback:function(e,t){return oi().memoizedState=[e,t===void 0?null:t],e},useContext:Cr,useEffect:UE,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,X0(4194308,4,W3.bind(null,t,e),n)},useLayoutEffect:function(e,t){return X0(4194308,4,e,t)},useInsertionEffect:function(e,t){return X0(4,2,e,t)},useMemo:function(e,t){var n=oi();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=oi();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=FG.bind(null,Ae,e),[s.memoizedState,e]},useRef:function(e){var t=oi();return e={current:e},t.memoizedState=e},useState:WE,useDebugValue:MC,useDeferredValue:function(e){return oi().memoizedState=e},useTransition:function(){var e=WE(!1),t=e[0];return e=PG.bind(null,e[1]),oi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Ae,r=oi();if(Se){if(n===void 0)throw Error(it(407));n=n()}else{if(n=t(),In===null)throw Error(it(349));Vl&30||O3(s,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,UE(F3.bind(null,s,i,e),[e]),s.flags|=2048,ep(9,P3.bind(null,s,i,n,t),void 0,null),n},useId:function(){var e=oi(),t=In.identifierPrefix;if(Se){var n=Ki,s=Hi;n=(s&~(1<<32-Vr(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=Jf++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=OG++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},zG={readContext:Cr,useCallback:j3,useContext:Cr,useEffect:LC,useImperativeHandle:U3,useInsertionEffect:B3,useLayoutEffect:V3,useMemo:G3,useReducer:Lw,useRef:z3,useState:function(){return Lw(tp)},useDebugValue:MC,useDeferredValue:function(e){var t=Ir();return H3(t,on.memoizedState,e)},useTransition:function(){var e=Lw(tp)[0],t=Ir().memoizedState;return[e,t]},useMutableSource:R3,useSyncExternalStore:D3,useId:K3,unstable_isNewReconciler:!1},BG={readContext:Cr,useCallback:j3,useContext:Cr,useEffect:LC,useImperativeHandle:U3,useInsertionEffect:B3,useLayoutEffect:V3,useMemo:G3,useReducer:Mw,useRef:z3,useState:function(){return Mw(tp)},useDebugValue:MC,useDeferredValue:function(e){var t=Ir();return on===null?t.memoizedState=e:H3(t,on.memoizedState,e)},useTransition:function(){var e=Mw(tp)[0],t=Ir().memoizedState;return[e,t]},useMutableSource:R3,useSyncExternalStore:D3,useId:K3,unstable_isNewReconciler:!1};function Or(e,t){if(e&&e.defaultProps){t=Re({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function cS(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:Re({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var b1={isMounted:function(e){return(e=e._reactInternals)?kc(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=cs(),r=la(e),i=Qi(s,r);i.payload=t,n!=null&&(i.callback=n),t=oa(e,i,r),t!==null&&(Wr(t,e,r,s),K0(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=cs(),r=la(e),i=Qi(s,r);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=oa(e,i,r),t!==null&&(Wr(t,e,r,s),K0(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cs(),s=la(e),r=Qi(n,s);r.tag=2,t!=null&&(r.callback=t),t=oa(e,r,s),t!==null&&(Wr(t,e,s,n),K0(t,e,s))}};function jE(e,t,n,s,r,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,i,o):t.prototype&&t.prototype.isPureReactComponent?!Kf(n,s)||!Kf(r,i):!0}function Z3(e,t,n){var s=!1,r=ga,i=t.contextType;return typeof i=="object"&&i!==null?i=Cr(i):(r=As(t)?zl:Zn.current,s=t.contextTypes,i=(s=s!=null)?_u(e,r):ga),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=b1,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=i),t}function GE(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&b1.enqueueReplaceState(t,t.state,null)}function uS(e,t,n,s){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},EC(e);var i=t.contextType;typeof i=="object"&&i!==null?r.context=Cr(i):(i=As(t)?zl:Zn.current,r.context=_u(e,i)),r.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(cS(e,t,i,n),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&b1.enqueueReplaceState(r,r.state,null),Fx(e,n,r,s),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Ru(e,t){try{var n="",s=t;do n+=p8(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:r,digest:null}}function zw(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function hS(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var VG=typeof WeakMap=="function"?WeakMap:Map;function Q3(e,t,n){n=Qi(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Vx||(Vx=!0,wS=s),hS(e,t)},n}function J3(e,t,n){n=Qi(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var r=t.value;n.payload=function(){return s(r)},n.callback=function(){hS(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){hS(e,t),typeof s!="function"&&(aa===null?aa=new Set([this]):aa.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function HE(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new VG;var r=new Set;s.set(t,r)}else r=s.get(t),r===void 0&&(r=new Set,s.set(t,r));r.has(n)||(r.add(n),e=eH.bind(null,e,t,n),t.then(e,e))}function KE(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function qE(e,t,n,s,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Qi(-1,1),t.tag=2,oa(n,t,1))),n.lanes|=1),e)}var WG=vo.ReactCurrentOwner,_s=!1;function is(e,t,n,s){t.child=e===null?_3(t,null,n,s):Eu(t,e.child,n,s)}function XE(e,t,n,s,r){n=n.render;var i=t.ref;return vu(t,r),s=PC(e,t,n,s,i,r),n=FC(),e!==null&&!_s?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,co(e,t,r)):(Se&&n&&kC(t),t.flags|=1,is(e,t,s,r),t.child)}function YE(e,t,n,s,r){if(e===null){var i=n.type;return typeof i=="function"&&!HC(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,tL(e,t,i,s,r)):(e=J0(n.type,null,s,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Kf,n(o,s)&&e.ref===t.ref)return co(e,t,r)}return t.flags|=1,e=ca(i,s),e.ref=t.ref,e.return=t,t.child=e}function tL(e,t,n,s,r){if(e!==null){var i=e.memoizedProps;if(Kf(i,s)&&e.ref===t.ref)if(_s=!1,t.pendingProps=s=i,(e.lanes&r)!==0)e.flags&131072&&(_s=!0);else return t.lanes=e.lanes,co(e,t,r)}return dS(e,t,n,s,r)}function eL(e,t,n){var s=t.pendingProps,r=s.children,i=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ue(lu,Us),Us|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ue(lu,Us),Us|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,ue(lu,Us),Us|=s}else i!==null?(s=i.baseLanes|n,t.memoizedState=null):s=n,ue(lu,Us),Us|=s;return is(e,t,r,n),t.child}function nL(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function dS(e,t,n,s,r){var i=As(n)?zl:Zn.current;return i=_u(t,i),vu(t,r),n=PC(e,t,n,s,i,r),s=FC(),e!==null&&!_s?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,co(e,t,r)):(Se&&s&&kC(t),t.flags|=1,is(e,t,n,r),t.child)}function ZE(e,t,n,s,r){if(As(n)){var i=!0;Ax(t)}else i=!1;if(vu(t,r),t.stateNode===null)Y0(e,t),Z3(t,n,s),uS(t,n,s,r),s=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Cr(c):(c=As(n)?zl:Zn.current,c=_u(t,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&GE(t,o,s,c),Bo=!1;var d=t.memoizedState;o.state=d,Fx(t,s,o,r),l=t.memoizedState,a!==s||d!==l||Es.current||Bo?(typeof u=="function"&&(cS(t,n,u,s),l=t.memoizedState),(a=Bo||jE(t,n,a,s,d,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{o=t.stateNode,E3(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Or(t.type,a),o.props=c,h=t.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Cr(l):(l=As(n)?zl:Zn.current,l=_u(t,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&GE(t,o,s,l),Bo=!1,d=t.memoizedState,o.state=d,Fx(t,s,o,r);var p=t.memoizedState;a!==h||d!==p||Es.current||Bo?(typeof f=="function"&&(cS(t,n,f,s),p=t.memoizedState),(c=Bo||jE(t,n,c,s,d,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=p),o.props=s,o.state=p,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),s=!1)}return fS(e,t,n,s,i,r)}function fS(e,t,n,s,r,i){nL(e,t);var o=(t.flags&128)!==0;if(!s&&!o)return r&&FE(t,n,!1),co(e,t,i);s=t.stateNode,WG.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&o?(t.child=Eu(t,e.child,null,i),t.child=Eu(t,null,a,i)):is(e,t,a,i),t.memoizedState=s.state,r&&FE(t,n,!0),t.child}function sL(e){var t=e.stateNode;t.pendingContext?PE(e,t.pendingContext,t.pendingContext!==t.context):t.context&&PE(e,t.context,!1),AC(e,t.containerInfo)}function QE(e,t,n,s,r){return $u(),IC(r),t.flags|=256,is(e,t,n,s),t.child}var pS={dehydrated:null,treeContext:null,retryLane:0};function mS(e){return{baseLanes:e,cachePool:null,transitions:null}}function rL(e,t,n){var s=t.pendingProps,r=_e.current,i=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),ue(_e,r&1),e===null)return aS(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=s.children,e=s.fallback,i?(s=t.mode,i=t.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=S1(o,s,0,null),e=$l(e,s,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=mS(n),t.memoizedState=pS,e):zC(t,o));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return UG(e,t,o,s,a,r,n);if(i){i=s.fallback,o=t.mode,r=e.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&t.child!==r?(s=t.child,s.childLanes=0,s.pendingProps=l,t.deletions=null):(s=ca(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=ca(a,i):(i=$l(i,o,n,null),i.flags|=2),i.return=t,s.return=t,s.sibling=i,t.child=s,s=i,i=t.child,o=e.child.memoizedState,o=o===null?mS(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=pS,s}return i=e.child,e=i.sibling,s=ca(i,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function zC(e,t){return t=S1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function s0(e,t,n,s){return s!==null&&IC(s),Eu(t,e.child,null,n),e=zC(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function UG(e,t,n,s,r,i,o){if(n)return t.flags&256?(t.flags&=-257,s=zw(Error(it(422))),s0(e,t,o,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=s.fallback,r=t.mode,s=S1({mode:"visible",children:s.children},r,0,null),i=$l(i,r,o,null),i.flags|=2,s.return=t,i.return=t,s.sibling=i,t.child=s,t.mode&1&&Eu(t,e.child,null,o),t.child.memoizedState=mS(o),t.memoizedState=pS,i);if(!(t.mode&1))return s0(e,t,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(it(419)),s=zw(i,s,void 0),s0(e,t,o,s)}if(a=(o&e.childLanes)!==0,_s||a){if(s=In,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,lo(e,r),Wr(s,e,r,-1))}return GC(),s=zw(Error(it(421))),s0(e,t,o,s)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=nH.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,Ks=ia(r.nextSibling),Qs=t,Se=!0,Lr=null,e!==null&&(pr[mr++]=Hi,pr[mr++]=Ki,pr[mr++]=Bl,Hi=e.id,Ki=e.overflow,Bl=t),t=zC(t,s.children),t.flags|=4096,t)}function JE(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),lS(e.return,t,n)}function Bw(e,t,n,s,r){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function iL(e,t,n){var s=t.pendingProps,r=s.revealOrder,i=s.tail;if(is(e,t,s.children,n),s=_e.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&JE(e,n,t);else if(e.tag===19)JE(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;e.sibling===null;){if(e.return===null||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(ue(_e,s),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&Lx(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Bw(t,!1,r,n,i);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&Lx(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Bw(t,!0,n,null,i);break;case"together":Bw(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Y0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function co(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Wl|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(it(153));if(t.child!==null){for(e=t.child,n=ca(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ca(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function jG(e,t,n){switch(t.tag){case 3:sL(t),$u();break;case 5:A3(t);break;case 1:As(t.type)&&Ax(t);break;case 4:AC(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,r=t.memoizedProps.value;ue(Ox,s._currentValue),s._currentValue=r;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(ue(_e,_e.current&1),t.flags|=128,null):n&t.child.childLanes?rL(e,t,n):(ue(_e,_e.current&1),e=co(e,t,n),e!==null?e.sibling:null);ue(_e,_e.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return iL(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ue(_e,_e.current),s)break;return null;case 22:case 23:return t.lanes=0,eL(e,t,n)}return co(e,t,n)}var oL,gS,aL,lL;oL=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gS=function(){};aL=function(e,t,n,s){var r=e.memoizedProps;if(r!==s){e=t.stateNode,Sl(mi.current);var i=null;switch(n){case"input":r=M2(e,r),s=M2(e,s),i=[];break;case"select":r=Re({},r,{value:void 0}),s=Re({},s,{value:void 0}),i=[];break;case"textarea":r=V2(e,r),s=V2(e,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=$x)}U2(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Bf.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Bf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&me("scroll",e),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};lL=function(e,t,n,s){n!==s&&(t.flags|=4)};function Od(e,t){if(!Se)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Bn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function GG(e,t,n){var s=t.pendingProps;switch(CC(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(t),null;case 1:return As(t.type)&&Ex(),Bn(t),null;case 3:return s=t.stateNode,Au(),ge(Es),ge(Zn),DC(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(e0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Lr!==null&&(CS(Lr),Lr=null))),gS(e,t),Bn(t),null;case 5:RC(t);var r=Sl(Qf.current);if(n=t.type,e!==null&&t.stateNode!=null)aL(e,t,n,s,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(it(166));return Bn(t),null}if(e=Sl(mi.current),e0(t)){s=t.stateNode,n=t.type;var i=t.memoizedProps;switch(s[hi]=t,s[Yf]=i,e=(t.mode&1)!==0,n){case"dialog":me("cancel",s),me("close",s);break;case"iframe":case"object":case"embed":me("load",s);break;case"video":case"audio":for(r=0;r<Zd.length;r++)me(Zd[r],s);break;case"source":me("error",s);break;case"img":case"image":case"link":me("error",s),me("load",s);break;case"details":me("toggle",s);break;case"input":lE(s,i),me("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},me("invalid",s);break;case"textarea":uE(s,i),me("invalid",s)}U2(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&t0(s.textContent,a,e),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&t0(s.textContent,a,e),r=["children",""+a]):Bf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&me("scroll",s)}switch(n){case"input":Hg(s),cE(s,i,!0);break;case"textarea":Hg(s),hE(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=$x)}s=r,t.updateQueue=s,s!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=FF(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=o.createElement(n,{is:s.is}):(e=o.createElement(n),n==="select"&&(o=e,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):e=o.createElementNS(e,n),e[hi]=t,e[Yf]=s,oL(e,t,!1,!1),t.stateNode=e;t:{switch(o=j2(n,s),n){case"dialog":me("cancel",e),me("close",e),r=s;break;case"iframe":case"object":case"embed":me("load",e),r=s;break;case"video":case"audio":for(r=0;r<Zd.length;r++)me(Zd[r],e);r=s;break;case"source":me("error",e),r=s;break;case"img":case"image":case"link":me("error",e),me("load",e),r=s;break;case"details":me("toggle",e),r=s;break;case"input":lE(e,s),r=M2(e,s),me("invalid",e);break;case"option":r=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},r=Re({},s,{value:void 0}),me("invalid",e);break;case"textarea":uE(e,s),r=V2(e,s),me("invalid",e);break;default:r=s}U2(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?zF(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&LF(e,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Vf(e,l):typeof l=="number"&&Vf(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Bf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&me("scroll",e):l!=null&&cC(e,i,l,o))}switch(n){case"input":Hg(e),cE(e,s,!1);break;case"textarea":Hg(e),hE(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ma(s.value));break;case"select":e.multiple=!!s.multiple,i=s.value,i!=null?gu(e,!!s.multiple,i,!1):s.defaultValue!=null&&gu(e,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=$x)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break t;case"img":s=!0;break t;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Bn(t),null;case 6:if(e&&t.stateNode!=null)lL(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(it(166));if(n=Sl(Qf.current),Sl(mi.current),e0(t)){if(s=t.stateNode,n=t.memoizedProps,s[hi]=t,(i=s.nodeValue!==n)&&(e=Qs,e!==null))switch(e.tag){case 3:t0(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&t0(s.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[hi]=t,t.stateNode=s}return Bn(t),null;case 13:if(ge(_e),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Se&&Ks!==null&&t.mode&1&&!(t.flags&128))T3(),$u(),t.flags|=98560,i=!1;else if(i=e0(t),s!==null&&s.dehydrated!==null){if(e===null){if(!i)throw Error(it(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(it(317));i[hi]=t}else $u(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Bn(t),i=!1}else Lr!==null&&(CS(Lr),Lr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||_e.current&1?ln===0&&(ln=3):GC())),t.updateQueue!==null&&(t.flags|=4),Bn(t),null);case 4:return Au(),gS(e,t),e===null&&qf(t.stateNode.containerInfo),Bn(t),null;case 10:return _C(t.type._context),Bn(t),null;case 17:return As(t.type)&&Ex(),Bn(t),null;case 19:if(ge(_e),i=t.memoizedState,i===null)return Bn(t),null;if(s=(t.flags&128)!==0,o=i.rendering,o===null)if(s)Od(i,!1);else{if(ln!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Lx(e),o!==null){for(t.flags|=128,Od(i,!1),s=o.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)i=n,e=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ue(_e,_e.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ge()>Du&&(t.flags|=128,s=!0,Od(i,!1),t.lanes=4194304)}else{if(!s)if(e=Lx(o),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Od(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Se)return Bn(t),null}else 2*Ge()-i.renderingStartTime>Du&&n!==1073741824&&(t.flags|=128,s=!0,Od(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ge(),t.sibling=null,n=_e.current,ue(_e,s?n&1|2:n&1),t):(Bn(t),null);case 22:case 23:return jC(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Us&1073741824&&(Bn(t),t.subtreeFlags&6&&(t.flags|=8192)):Bn(t),null;case 24:return null;case 25:return null}throw Error(it(156,t.tag))}function HG(e,t){switch(CC(t),t.tag){case 1:return As(t.type)&&Ex(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Au(),ge(Es),ge(Zn),DC(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return RC(t),null;case 13:if(ge(_e),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(it(340));$u()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ge(_e),null;case 4:return Au(),null;case 10:return _C(t.type._context),null;case 22:case 23:return jC(),null;case 24:return null;default:return null}}var r0=!1,jn=!1,KG=typeof WeakSet=="function"?WeakSet:Set,pt=null;function au(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Oe(e,t,s)}else n.current=null}function xS(e,t,n){try{n()}catch(s){Oe(e,t,s)}}var tA=!1;function qG(e,t){if(tS=Tx,e=f3(),SC(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else t:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break t}var o=0,a=-1,l=-1,c=0,u=0,h=e,d=null;e:for(;;){for(var f;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(l=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===e)break e;if(d===n&&++c===r&&(a=o),d===i&&++u===s&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(eS={focusedElem:e,selectionRange:n},Tx=!1,pt=t;pt!==null;)if(t=pt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,pt=e;else for(;pt!==null;){t=pt;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,m=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Or(t.type,g),m);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(it(163))}}catch(v){Oe(t,t.return,v)}if(e=t.sibling,e!==null){e.return=t.return,pt=e;break}pt=t.return}return p=tA,tA=!1,p}function kf(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&e)===e){var i=r.destroy;r.destroy=void 0,i!==void 0&&xS(t,n,i)}r=r.next}while(r!==s)}}function v1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function yS(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function cL(e){var t=e.alternate;t!==null&&(e.alternate=null,cL(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[hi],delete t[Yf],delete t[rS],delete t[EG],delete t[AG])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function uL(e){return e.tag===5||e.tag===3||e.tag===4}function eA(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||uL(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bS(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=$x));else if(s!==4&&(e=e.child,e!==null))for(bS(e,t,n),e=e.sibling;e!==null;)bS(e,t,n),e=e.sibling}function vS(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(vS(e,t,n),e=e.sibling;e!==null;)vS(e,t,n),e=e.sibling}var Dn=null,Fr=!1;function Po(e,t,n){for(n=n.child;n!==null;)hL(e,t,n),n=n.sibling}function hL(e,t,n){if(pi&&typeof pi.onCommitFiberUnmount=="function")try{pi.onCommitFiberUnmount(d1,n)}catch{}switch(n.tag){case 5:jn||au(n,t);case 6:var s=Dn,r=Fr;Dn=null,Po(e,t,n),Dn=s,Fr=r,Dn!==null&&(Fr?(e=Dn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Dn.removeChild(n.stateNode));break;case 18:Dn!==null&&(Fr?(e=Dn,n=n.stateNode,e.nodeType===8?Dw(e.parentNode,n):e.nodeType===1&&Dw(e,n),Gf(e)):Dw(Dn,n.stateNode));break;case 4:s=Dn,r=Fr,Dn=n.stateNode.containerInfo,Fr=!0,Po(e,t,n),Dn=s,Fr=r;break;case 0:case 11:case 14:case 15:if(!jn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&xS(n,t,o),r=r.next}while(r!==s)}Po(e,t,n);break;case 1:if(!jn&&(au(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Oe(n,t,a)}Po(e,t,n);break;case 21:Po(e,t,n);break;case 22:n.mode&1?(jn=(s=jn)||n.memoizedState!==null,Po(e,t,n),jn=s):Po(e,t,n);break;default:Po(e,t,n)}}function nA(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new KG),t.forEach(function(s){var r=sH.bind(null,e,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Ar(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=e,o=t,a=o;t:for(;a!==null;){switch(a.tag){case 5:Dn=a.stateNode,Fr=!1;break t;case 3:Dn=a.stateNode.containerInfo,Fr=!0;break t;case 4:Dn=a.stateNode.containerInfo,Fr=!0;break t}a=a.return}if(Dn===null)throw Error(it(160));hL(i,o,r),Dn=null,Fr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Oe(r,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)dL(t,e),t=t.sibling}function dL(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ar(t,e),ri(e),s&4){try{kf(3,e,e.return),v1(3,e)}catch(g){Oe(e,e.return,g)}try{kf(5,e,e.return)}catch(g){Oe(e,e.return,g)}}break;case 1:Ar(t,e),ri(e),s&512&&n!==null&&au(n,n.return);break;case 5:if(Ar(t,e),ri(e),s&512&&n!==null&&au(n,n.return),e.flags&32){var r=e.stateNode;try{Vf(r,"")}catch(g){Oe(e,e.return,g)}}if(s&4&&(r=e.stateNode,r!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&OF(r,i),j2(a,o);var c=j2(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?zF(r,h):u==="dangerouslySetInnerHTML"?LF(r,h):u==="children"?Vf(r,h):cC(r,u,h,c)}switch(a){case"input":z2(r,i);break;case"textarea":PF(r,i);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?gu(r,!!i.multiple,f,!1):d!==!!i.multiple&&(i.defaultValue!=null?gu(r,!!i.multiple,i.defaultValue,!0):gu(r,!!i.multiple,i.multiple?[]:"",!1))}r[Yf]=i}catch(g){Oe(e,e.return,g)}}break;case 6:if(Ar(t,e),ri(e),s&4){if(e.stateNode===null)throw Error(it(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(g){Oe(e,e.return,g)}}break;case 3:if(Ar(t,e),ri(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Gf(t.containerInfo)}catch(g){Oe(e,e.return,g)}break;case 4:Ar(t,e),ri(e);break;case 13:Ar(t,e),ri(e),r=e.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(WC=Ge())),s&4&&nA(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(jn=(c=jn)||u,Ar(t,e),jn=c):Ar(t,e),ri(e),s&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(pt=e,u=e.child;u!==null;){for(h=pt=u;pt!==null;){switch(d=pt,f=d.child,d.tag){case 0:case 11:case 14:case 15:kf(4,d,d.return);break;case 1:au(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){s=d,n=d.return;try{t=s,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Oe(s,n,g)}}break;case 5:au(d,d.return);break;case 22:if(d.memoizedState!==null){rA(h);continue}}f!==null?(f.return=d,pt=f):rA(h)}u=u.sibling}t:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=MF("display",o))}catch(g){Oe(e,e.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Oe(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break t;for(;h.sibling===null;){if(h.return===null||h.return===e)break t;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ar(t,e),ri(e),s&4&&nA(e);break;case 21:break;default:Ar(t,e),ri(e)}}function ri(e){var t=e.flags;if(t&2){try{t:{for(var n=e.return;n!==null;){if(uL(n)){var s=n;break t}n=n.return}throw Error(it(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Vf(r,""),s.flags&=-33);var i=eA(e);vS(e,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=eA(e);bS(e,a,o);break;default:throw Error(it(161))}}catch(l){Oe(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function XG(e,t,n){pt=e,fL(e)}function fL(e,t,n){for(var s=(e.mode&1)!==0;pt!==null;){var r=pt,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||r0;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||jn;a=r0;var c=jn;if(r0=o,(jn=l)&&!c)for(pt=r;pt!==null;)o=pt,l=o.child,o.tag===22&&o.memoizedState!==null?iA(r):l!==null?(l.return=o,pt=l):iA(r);for(;i!==null;)pt=i,fL(i),i=i.sibling;pt=r,r0=a,jn=c}sA(e)}else r.subtreeFlags&8772&&i!==null?(i.return=r,pt=i):sA(e)}}function sA(e){for(;pt!==null;){var t=pt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jn||v1(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!jn)if(n===null)s.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:Or(t.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&VE(t,i,s);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}VE(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Gf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(it(163))}jn||t.flags&512&&yS(t)}catch(d){Oe(t,t.return,d)}}if(t===e){pt=null;break}if(n=t.sibling,n!==null){n.return=t.return,pt=n;break}pt=t.return}}function rA(e){for(;pt!==null;){var t=pt;if(t===e){pt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,pt=n;break}pt=t.return}}function iA(e){for(;pt!==null;){var t=pt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{v1(4,t)}catch(l){Oe(t,n,l)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var r=t.return;try{s.componentDidMount()}catch(l){Oe(t,r,l)}}var i=t.return;try{yS(t)}catch(l){Oe(t,i,l)}break;case 5:var o=t.return;try{yS(t)}catch(l){Oe(t,o,l)}}}catch(l){Oe(t,t.return,l)}if(t===e){pt=null;break}var a=t.sibling;if(a!==null){a.return=t.return,pt=a;break}pt=t.return}}var YG=Math.ceil,Bx=vo.ReactCurrentDispatcher,BC=vo.ReactCurrentOwner,kr=vo.ReactCurrentBatchConfig,Ht=0,In=null,Qe=null,Pn=0,Us=0,lu=Pa(0),ln=0,np=null,Wl=0,w1=0,VC=0,Cf=null,Is=null,WC=0,Du=1/0,Mi=null,Vx=!1,wS=null,aa=null,i0=!1,Go=null,Wx=0,If=0,SS=null,Z0=-1,Q0=0;function cs(){return Ht&6?Ge():Z0!==-1?Z0:Z0=Ge()}function la(e){return e.mode&1?Ht&2&&Pn!==0?Pn&-Pn:DG.transition!==null?(Q0===0&&(Q0=ZF()),Q0):(e=ne,e!==0||(e=window.event,e=e===void 0?16:r3(e.type)),e):1}function Wr(e,t,n,s){if(50<If)throw If=0,SS=null,Error(it(185));Vp(e,n,s),(!(Ht&2)||e!==In)&&(e===In&&(!(Ht&2)&&(w1|=n),ln===4&&Uo(e,Pn)),Rs(e,s),n===1&&Ht===0&&!(t.mode&1)&&(Du=Ge()+500,x1&&Fa()))}function Rs(e,t){var n=e.callbackNode;D8(e,t);var s=Ix(e,e===In?Pn:0);if(s===0)n!==null&&pE(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&pE(n),t===1)e.tag===0?RG(oA.bind(null,e)):k3(oA.bind(null,e)),_G(function(){!(Ht&6)&&Fa()}),n=null;else{switch(QF(s)){case 1:n=pC;break;case 4:n=XF;break;case 16:n=Cx;break;case 536870912:n=YF;break;default:n=Cx}n=wL(n,pL.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function pL(e,t){if(Z0=-1,Q0=0,Ht&6)throw Error(it(327));var n=e.callbackNode;if(wu()&&e.callbackNode!==n)return null;var s=Ix(e,e===In?Pn:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Ux(e,s);else{t=s;var r=Ht;Ht|=2;var i=gL();(In!==e||Pn!==t)&&(Mi=null,Du=Ge()+500,_l(e,t));do try{JG();break}catch(a){mL(e,a)}while(!0);NC(),Bx.current=i,Ht=r,Qe!==null?t=0:(In=null,Pn=0,t=ln)}if(t!==0){if(t===2&&(r=X2(e),r!==0&&(s=r,t=kS(e,r))),t===1)throw n=np,_l(e,0),Uo(e,s),Rs(e,Ge()),n;if(t===6)Uo(e,s);else{if(r=e.current.alternate,!(s&30)&&!ZG(r)&&(t=Ux(e,s),t===2&&(i=X2(e),i!==0&&(s=i,t=kS(e,i))),t===1))throw n=np,_l(e,0),Uo(e,s),Rs(e,Ge()),n;switch(e.finishedWork=r,e.finishedLanes=s,t){case 0:case 1:throw Error(it(345));case 2:ol(e,Is,Mi);break;case 3:if(Uo(e,s),(s&130023424)===s&&(t=WC+500-Ge(),10<t)){if(Ix(e,0)!==0)break;if(r=e.suspendedLanes,(r&s)!==s){cs(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=sS(ol.bind(null,e,Is,Mi),t);break}ol(e,Is,Mi);break;case 4:if(Uo(e,s),(s&4194240)===s)break;for(t=e.eventTimes,r=-1;0<s;){var o=31-Vr(s);i=1<<o,o=t[o],o>r&&(r=o),s&=~i}if(s=r,s=Ge()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*YG(s/1960))-s,10<s){e.timeoutHandle=sS(ol.bind(null,e,Is,Mi),s);break}ol(e,Is,Mi);break;case 5:ol(e,Is,Mi);break;default:throw Error(it(329))}}}return Rs(e,Ge()),e.callbackNode===n?pL.bind(null,e):null}function kS(e,t){var n=Cf;return e.current.memoizedState.isDehydrated&&(_l(e,t).flags|=256),e=Ux(e,t),e!==2&&(t=Is,Is=n,t!==null&&CS(t)),e}function CS(e){Is===null?Is=e:Is.push.apply(Is,e)}function ZG(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!qr(i(),r))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Uo(e,t){for(t&=~VC,t&=~w1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Vr(t),s=1<<n;e[n]=-1,t&=~s}}function oA(e){if(Ht&6)throw Error(it(327));wu();var t=Ix(e,0);if(!(t&1))return Rs(e,Ge()),null;var n=Ux(e,t);if(e.tag!==0&&n===2){var s=X2(e);s!==0&&(t=s,n=kS(e,s))}if(n===1)throw n=np,_l(e,0),Uo(e,t),Rs(e,Ge()),n;if(n===6)throw Error(it(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ol(e,Is,Mi),Rs(e,Ge()),null}function UC(e,t){var n=Ht;Ht|=1;try{return e(t)}finally{Ht=n,Ht===0&&(Du=Ge()+500,x1&&Fa())}}function Ul(e){Go!==null&&Go.tag===0&&!(Ht&6)&&wu();var t=Ht;Ht|=1;var n=kr.transition,s=ne;try{if(kr.transition=null,ne=1,e)return e()}finally{ne=s,kr.transition=n,Ht=t,!(Ht&6)&&Fa()}}function jC(){Us=lu.current,ge(lu)}function _l(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,NG(n)),Qe!==null)for(n=Qe.return;n!==null;){var s=n;switch(CC(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ex();break;case 3:Au(),ge(Es),ge(Zn),DC();break;case 5:RC(s);break;case 4:Au();break;case 13:ge(_e);break;case 19:ge(_e);break;case 10:_C(s.type._context);break;case 22:case 23:jC()}n=n.return}if(In=e,Qe=e=ca(e.current,null),Pn=Us=t,ln=0,np=null,VC=w1=Wl=0,Is=Cf=null,wl!==null){for(t=0;t<wl.length;t++)if(n=wl[t],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}wl=null}return e}function mL(e,t){do{var n=Qe;try{if(NC(),q0.current=zx,Mx){for(var s=Ae.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Mx=!1}if(Vl=0,bn=on=Ae=null,Sf=!1,Jf=0,BC.current=null,n===null||n.return===null){ln=1,np=t,Qe=null;break}t:{var i=e,o=n.return,a=n,l=t;if(t=Pn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=KE(o);if(f!==null){f.flags&=-257,qE(f,o,a,i,t),f.mode&1&&HE(i,c,t),t=f,l=c;var p=t.updateQueue;if(p===null){var g=new Set;g.add(l),t.updateQueue=g}else p.add(l);break t}else{if(!(t&1)){HE(i,c,t),GC();break t}l=Error(it(426))}}else if(Se&&a.mode&1){var m=KE(o);if(m!==null){!(m.flags&65536)&&(m.flags|=256),qE(m,o,a,i,t),IC(Ru(l,a));break t}}i=l=Ru(l,a),ln!==4&&(ln=2),Cf===null?Cf=[i]:Cf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=Q3(i,l,t);BE(i,x);break t;case 1:a=l;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(aa===null||!aa.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var v=J3(i,a,t);BE(i,v);break t}}i=i.return}while(i!==null)}yL(n)}catch(w){t=w,Qe===n&&n!==null&&(Qe=n=n.return);continue}break}while(!0)}function gL(){var e=Bx.current;return Bx.current=zx,e===null?zx:e}function GC(){(ln===0||ln===3||ln===2)&&(ln=4),In===null||!(Wl&268435455)&&!(w1&268435455)||Uo(In,Pn)}function Ux(e,t){var n=Ht;Ht|=2;var s=gL();(In!==e||Pn!==t)&&(Mi=null,_l(e,t));do try{QG();break}catch(r){mL(e,r)}while(!0);if(NC(),Ht=n,Bx.current=s,Qe!==null)throw Error(it(261));return In=null,Pn=0,ln}function QG(){for(;Qe!==null;)xL(Qe)}function JG(){for(;Qe!==null&&!C8();)xL(Qe)}function xL(e){var t=vL(e.alternate,e,Us);e.memoizedProps=e.pendingProps,t===null?yL(e):Qe=t,BC.current=null}function yL(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=HG(n,t),n!==null){n.flags&=32767,Qe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ln=6,Qe=null;return}}else if(n=GG(n,t,Us),n!==null){Qe=n;return}if(t=t.sibling,t!==null){Qe=t;return}Qe=t=e}while(t!==null);ln===0&&(ln=5)}function ol(e,t,n){var s=ne,r=kr.transition;try{kr.transition=null,ne=1,tH(e,t,n,s)}finally{kr.transition=r,ne=s}return null}function tH(e,t,n,s){do wu();while(Go!==null);if(Ht&6)throw Error(it(327));n=e.finishedWork;var r=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(it(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(O8(e,i),e===In&&(Qe=In=null,Pn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||i0||(i0=!0,wL(Cx,function(){return wu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=kr.transition,kr.transition=null;var o=ne;ne=1;var a=Ht;Ht|=4,BC.current=null,qG(e,n),dL(n,e),vG(eS),Tx=!!tS,eS=tS=null,e.current=n,XG(n),I8(),Ht=a,ne=o,kr.transition=i}else e.current=n;if(i0&&(i0=!1,Go=e,Wx=r),i=e.pendingLanes,i===0&&(aa=null),_8(n.stateNode),Rs(e,Ge()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Vx)throw Vx=!1,e=wS,wS=null,e;return Wx&1&&e.tag!==0&&wu(),i=e.pendingLanes,i&1?e===SS?If++:(If=0,SS=e):If=0,Fa(),null}function wu(){if(Go!==null){var e=QF(Wx),t=kr.transition,n=ne;try{if(kr.transition=null,ne=16>e?16:e,Go===null)var s=!1;else{if(e=Go,Go=null,Wx=0,Ht&6)throw Error(it(331));var r=Ht;for(Ht|=4,pt=e.current;pt!==null;){var i=pt,o=i.child;if(pt.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(pt=c;pt!==null;){var u=pt;switch(u.tag){case 0:case 11:case 15:kf(8,u,i)}var h=u.child;if(h!==null)h.return=u,pt=h;else for(;pt!==null;){u=pt;var d=u.sibling,f=u.return;if(cL(u),u===c){pt=null;break}if(d!==null){d.return=f,pt=d;break}pt=f}}}var p=i.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(g!==null)}}pt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,pt=o;else t:for(;pt!==null;){if(i=pt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:kf(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,pt=x;break t}pt=i.return}}var y=e.current;for(pt=y;pt!==null;){o=pt;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,pt=b;else t:for(o=y;pt!==null;){if(a=pt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:v1(9,a)}}catch(w){Oe(a,a.return,w)}if(a===o){pt=null;break t}var v=a.sibling;if(v!==null){v.return=a.return,pt=v;break t}pt=a.return}}if(Ht=r,Fa(),pi&&typeof pi.onPostCommitFiberRoot=="function")try{pi.onPostCommitFiberRoot(d1,e)}catch{}s=!0}return s}finally{ne=n,kr.transition=t}}return!1}function aA(e,t,n){t=Ru(n,t),t=Q3(e,t,1),e=oa(e,t,1),t=cs(),e!==null&&(Vp(e,1,t),Rs(e,t))}function Oe(e,t,n){if(e.tag===3)aA(e,e,n);else for(;t!==null;){if(t.tag===3){aA(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(aa===null||!aa.has(s))){e=Ru(n,e),e=J3(t,e,1),t=oa(t,e,1),e=cs(),t!==null&&(Vp(t,1,e),Rs(t,e));break}}t=t.return}}function eH(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=cs(),e.pingedLanes|=e.suspendedLanes&n,In===e&&(Pn&n)===n&&(ln===4||ln===3&&(Pn&130023424)===Pn&&500>Ge()-WC?_l(e,0):VC|=n),Rs(e,t)}function bL(e,t){t===0&&(e.mode&1?(t=Xg,Xg<<=1,!(Xg&130023424)&&(Xg=4194304)):t=1);var n=cs();e=lo(e,t),e!==null&&(Vp(e,t,n),Rs(e,n))}function nH(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),bL(e,n)}function sH(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(it(314))}s!==null&&s.delete(t),bL(e,n)}var vL;vL=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Es.current)_s=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return _s=!1,jG(e,t,n);_s=!!(e.flags&131072)}else _s=!1,Se&&t.flags&1048576&&C3(t,Dx,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Y0(e,t),e=t.pendingProps;var r=_u(t,Zn.current);vu(t,n),r=PC(null,t,s,e,r,n);var i=FC();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,As(s)?(i=!0,Ax(t)):i=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,EC(t),r.updater=b1,t.stateNode=r,r._reactInternals=t,uS(t,s,e,n),t=fS(null,t,s,!0,i,n)):(t.tag=0,Se&&i&&kC(t),is(null,t,r,n),t=t.child),t;case 16:s=t.elementType;t:{switch(Y0(e,t),e=t.pendingProps,r=s._init,s=r(s._payload),t.type=s,r=t.tag=iH(s),e=Or(s,e),r){case 0:t=dS(null,t,s,e,n);break t;case 1:t=ZE(null,t,s,e,n);break t;case 11:t=XE(null,t,s,e,n);break t;case 14:t=YE(null,t,s,Or(s.type,e),n);break t}throw Error(it(306,s,""))}return t;case 0:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:Or(s,r),dS(e,t,s,r,n);case 1:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:Or(s,r),ZE(e,t,s,r,n);case 3:t:{if(sL(t),e===null)throw Error(it(387));s=t.pendingProps,i=t.memoizedState,r=i.element,E3(e,t),Fx(t,s,null,n);var o=t.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){r=Ru(Error(it(423)),t),t=QE(e,t,s,n,r);break t}else if(s!==r){r=Ru(Error(it(424)),t),t=QE(e,t,s,n,r);break t}else for(Ks=ia(t.stateNode.containerInfo.firstChild),Qs=t,Se=!0,Lr=null,n=_3(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($u(),s===r){t=co(e,t,n);break t}is(e,t,s,n)}t=t.child}return t;case 5:return A3(t),e===null&&aS(t),s=t.type,r=t.pendingProps,i=e!==null?e.memoizedProps:null,o=r.children,nS(s,r)?o=null:i!==null&&nS(s,i)&&(t.flags|=32),nL(e,t),is(e,t,o,n),t.child;case 6:return e===null&&aS(t),null;case 13:return rL(e,t,n);case 4:return AC(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Eu(t,null,s,n):is(e,t,s,n),t.child;case 11:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:Or(s,r),XE(e,t,s,r,n);case 7:return is(e,t,t.pendingProps,n),t.child;case 8:return is(e,t,t.pendingProps.children,n),t.child;case 12:return is(e,t,t.pendingProps.children,n),t.child;case 10:t:{if(s=t.type._context,r=t.pendingProps,i=t.memoizedProps,o=r.value,ue(Ox,s._currentValue),s._currentValue=o,i!==null)if(qr(i.value,o)){if(i.children===r.children&&!Es.current){t=co(e,t,n);break t}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=Qi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),lS(i.return,n,t),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(it(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),lS(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}is(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,s=t.pendingProps.children,vu(t,n),r=Cr(r),s=s(r),t.flags|=1,is(e,t,s,n),t.child;case 14:return s=t.type,r=Or(s,t.pendingProps),r=Or(s.type,r),YE(e,t,s,r,n);case 15:return tL(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:Or(s,r),Y0(e,t),t.tag=1,As(s)?(e=!0,Ax(t)):e=!1,vu(t,n),Z3(t,s,r),uS(t,s,r,n),fS(null,t,s,!0,e,n);case 19:return iL(e,t,n);case 22:return eL(e,t,n)}throw Error(it(156,t.tag))};function wL(e,t){return qF(e,t)}function rH(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xr(e,t,n,s){return new rH(e,t,n,s)}function HC(e){return e=e.prototype,!(!e||!e.isReactComponent)}function iH(e){if(typeof e=="function")return HC(e)?1:0;if(e!=null){if(e=e.$$typeof,e===hC)return 11;if(e===dC)return 14}return 2}function ca(e,t){var n=e.alternate;return n===null?(n=xr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function J0(e,t,n,s,r,i){var o=2;if(s=e,typeof e=="function")HC(e)&&(o=1);else if(typeof e=="string")o=5;else t:switch(e){case Qc:return $l(n.children,r,i,t);case uC:o=8,r|=8;break;case O2:return e=xr(12,n,t,r|2),e.elementType=O2,e.lanes=i,e;case P2:return e=xr(13,n,t,r),e.elementType=P2,e.lanes=i,e;case F2:return e=xr(19,n,t,r),e.elementType=F2,e.lanes=i,e;case AF:return S1(n,r,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $F:o=10;break t;case EF:o=9;break t;case hC:o=11;break t;case dC:o=14;break t;case zo:o=16,s=null;break t}throw Error(it(130,e==null?e:typeof e,""))}return t=xr(o,n,t,r),t.elementType=e,t.type=s,t.lanes=i,t}function $l(e,t,n,s){return e=xr(7,e,s,t),e.lanes=n,e}function S1(e,t,n,s){return e=xr(22,e,s,t),e.elementType=AF,e.lanes=n,e.stateNode={isHidden:!1},e}function Vw(e,t,n){return e=xr(6,e,null,t),e.lanes=n,e}function Ww(e,t,n){return t=xr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oH(e,t,n,s,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sw(0),this.expirationTimes=Sw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sw(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function KC(e,t,n,s,r,i,o,a,l){return e=new oH(e,t,n,a,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=xr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},EC(i),e}function aH(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zc,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function SL(e){if(!e)return ga;e=e._reactInternals;t:{if(kc(e)!==e||e.tag!==1)throw Error(it(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break t;case 1:if(As(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break t}}t=t.return}while(t!==null);throw Error(it(171))}if(e.tag===1){var n=e.type;if(As(n))return S3(e,n,t)}return t}function kL(e,t,n,s,r,i,o,a,l){return e=KC(n,s,!0,e,r,i,o,a,l),e.context=SL(null),n=e.current,s=cs(),r=la(n),i=Qi(s,r),i.callback=t??null,oa(n,i,r),e.current.lanes=r,Vp(e,r,s),Rs(e,s),e}function k1(e,t,n,s){var r=t.current,i=cs(),o=la(r);return n=SL(n),t.context===null?t.context=n:t.pendingContext=n,t=Qi(i,o),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=oa(r,t,o),e!==null&&(Wr(e,r,o,i),K0(e,r,o)),o}function jx(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function lA(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function qC(e,t){lA(e,t),(e=e.alternate)&&lA(e,t)}function lH(){return null}var CL=typeof reportError=="function"?reportError:function(e){console.error(e)};function XC(e){this._internalRoot=e}C1.prototype.render=XC.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(it(409));k1(e,t,null,null)};C1.prototype.unmount=XC.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ul(function(){k1(null,e,null,null)}),t[ao]=null}};function C1(e){this._internalRoot=e}C1.prototype.unstable_scheduleHydration=function(e){if(e){var t=e3();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Wo.length&&t!==0&&t<Wo[n].priority;n++);Wo.splice(n,0,e),n===0&&s3(e)}};function YC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function I1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function cA(){}function cH(e,t,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=jx(o);i.call(c)}}var o=kL(t,s,e,0,null,!1,!1,"",cA);return e._reactRootContainer=o,e[ao]=o.current,qf(e.nodeType===8?e.parentNode:e),Ul(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=jx(l);a.call(c)}}var l=KC(e,0,!1,null,null,!1,!1,"",cA);return e._reactRootContainer=l,e[ao]=l.current,qf(e.nodeType===8?e.parentNode:e),Ul(function(){k1(t,l,n,s)}),l}function T1(e,t,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=jx(o);a.call(l)}}k1(t,o,e,r)}else o=cH(n,t,e,r,s);return jx(o)}JF=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Yd(t.pendingLanes);n!==0&&(mC(t,n|1),Rs(t,Ge()),!(Ht&6)&&(Du=Ge()+500,Fa()))}break;case 13:Ul(function(){var s=lo(e,1);if(s!==null){var r=cs();Wr(s,e,1,r)}}),qC(e,1)}};gC=function(e){if(e.tag===13){var t=lo(e,134217728);if(t!==null){var n=cs();Wr(t,e,134217728,n)}qC(e,134217728)}};t3=function(e){if(e.tag===13){var t=la(e),n=lo(e,t);if(n!==null){var s=cs();Wr(n,e,t,s)}qC(e,t)}};e3=function(){return ne};n3=function(e,t){var n=ne;try{return ne=e,t()}finally{ne=n}};H2=function(e,t,n){switch(t){case"input":if(z2(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=g1(s);if(!r)throw Error(it(90));DF(s),z2(s,r)}}}break;case"textarea":PF(e,n);break;case"select":t=n.value,t!=null&&gu(e,!!n.multiple,t,!1)}};WF=UC;UF=Ul;var uH={usingClientEntryPoint:!1,Events:[Up,nu,g1,BF,VF,UC]},Pd={findFiberByHostInstance:vl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hH={bundleType:Pd.bundleType,version:Pd.version,rendererPackageName:Pd.rendererPackageName,rendererConfig:Pd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=HF(e),e===null?null:e.stateNode},findFiberByHostInstance:Pd.findFiberByHostInstance||lH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var o0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!o0.isDisabled&&o0.supportsFiber)try{d1=o0.inject(hH),pi=o0}catch{}}ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uH;ir.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!YC(t))throw Error(it(200));return aH(e,t,null,n)};ir.createRoot=function(e,t){if(!YC(e))throw Error(it(299));var n=!1,s="",r=CL;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=KC(e,1,!1,null,null,n,!1,s,r),e[ao]=t.current,qf(e.nodeType===8?e.parentNode:e),new XC(t)};ir.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(it(188)):(e=Object.keys(e).join(","),Error(it(268,e)));return e=HF(t),e=e===null?null:e.stateNode,e};ir.flushSync=function(e){return Ul(e)};ir.hydrate=function(e,t,n){if(!I1(t))throw Error(it(200));return T1(null,e,t,!0,n)};ir.hydrateRoot=function(e,t,n){if(!YC(e))throw Error(it(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=CL;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=kL(t,null,e,1,n??null,r,!1,i,o),e[ao]=t.current,qf(e),s)for(e=0;e<s.length;e++)n=s[e],r=n._getVersion,r=r(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new C1(t)};ir.render=function(e,t,n){if(!I1(t))throw Error(it(200));return T1(null,e,t,!1,n)};ir.unmountComponentAtNode=function(e){if(!I1(e))throw Error(it(40));return e._reactRootContainer?(Ul(function(){T1(null,null,e,!1,function(){e._reactRootContainer=null,e[ao]=null})}),!0):!1};ir.unstable_batchedUpdates=UC;ir.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!I1(n))throw Error(it(200));if(e==null||e._reactInternals===void 0)throw Error(it(38));return T1(e,t,n,!1,s)};ir.version="18.3.1-next-f1338f8080-20240426";function IL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(IL)}catch(e){console.error(e)}}IL(),IF.exports=ir;var dH=IF.exports,TL,uA=dH;TL=uA.createRoot,uA.hydrateRoot;/**
 * @remix-run/router v1.19.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sp(){return sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},sp.apply(this,arguments)}var Ho;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ho||(Ho={}));const hA="popstate";function fH(e){e===void 0&&(e={});function t(s,r){let{pathname:i,search:o,hash:a}=s.location;return IS("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Gx(r)}return mH(t,n,null,e)}function Le(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function NL(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function pH(){return Math.random().toString(36).substr(2,8)}function dA(e,t){return{usr:e.state,key:e.key,idx:t}}function IS(e,t,n,s){return n===void 0&&(n=null),sp({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ah(t):t,{state:n,key:t&&t.key||s||pH()})}function Gx(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function ah(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function mH(e,t,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=Ho.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(sp({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Ho.Pop;let m=u(),x=m==null?null:m-c;c=m,l&&l({action:a,location:g.location,delta:x})}function d(m,x){a=Ho.Push;let y=IS(g.location,m,x);c=u()+1;let b=dA(y,c),v=g.createHref(y);try{o.pushState(b,"",v)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;r.location.assign(v)}i&&l&&l({action:a,location:g.location,delta:1})}function f(m,x){a=Ho.Replace;let y=IS(g.location,m,x);c=u();let b=dA(y,c),v=g.createHref(y);o.replaceState(b,"",v),i&&l&&l({action:a,location:g.location,delta:0})}function p(m){let x=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof m=="string"?m:Gx(m);return y=y.replace(/ $/,"%20"),Le(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let g={get action(){return a},get location(){return e(r,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(hA,h),l=m,()=>{r.removeEventListener(hA,h),l=null}},createHref(m){return t(r,m)},createURL:p,encodeLocation(m){let x=p(m);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:d,replace:f,go(m){return o.go(m)}};return g}var fA;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(fA||(fA={}));function gH(e,t,n){return n===void 0&&(n="/"),xH(e,t,n,!1)}function xH(e,t,n,s){let r=typeof t=="string"?ah(t):t,i=Ou(r.pathname||"/",n);if(i==null)return null;let o=_L(e);yH(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=$H(i);a=NH(o[l],c,s)}return a}function _L(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Le(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let c=ua([s,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(Le(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),_L(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:IH(c,i.index),routesMeta:u})};return e.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of $L(i.path))r(i,o,l)}),t}function $L(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=$L(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>e.startsWith("/")&&l===""?"/":l)}function yH(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:TH(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const bH=/^:[\w-]+$/,vH=3,wH=2,SH=1,kH=10,CH=-2,pA=e=>e==="*";function IH(e,t){let n=e.split("/"),s=n.length;return n.some(pA)&&(s+=CH),t&&(s+=wH),n.filter(r=>!pA(r)).reduce((r,i)=>r+(bH.test(i)?vH:i===""?SH:kH),s)}function TH(e,t){return e.length===t.length&&e.slice(0,-1).every((s,r)=>s===t[r])?e[e.length-1]-t[t.length-1]:0}function NH(e,t,n){let{routesMeta:s}=e,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=i==="/"?t:t.slice(i.length)||"/",h=Hx({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h&&c&&n&&!s[s.length-1].route.index&&(h=Hx({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:ua([i,h.pathname]),pathnameBase:DH(ua([i,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(i=ua([i,h.pathnameBase]))}return o}function Hx(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=_H(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((c,u,h)=>{let{paramName:d,isOptional:f}=u;if(d==="*"){let g=a[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[h];return f&&!p?c[d]=void 0:c[d]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:e}}function _H(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),NL(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),s]}function $H(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return NL(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Ou(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function EH(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:r=""}=typeof e=="string"?ah(e):e;return{pathname:n?n.startsWith("/")?n:AH(n,t):t,search:OH(s),hash:PH(r)}}function AH(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Uw(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function RH(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function EL(e,t){let n=RH(e);return t?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function AL(e,t,n,s){s===void 0&&(s=!1);let r;typeof e=="string"?r=ah(e):(r=sp({},e),Le(!r.pathname||!r.pathname.includes("?"),Uw("?","pathname","search",r)),Le(!r.pathname||!r.pathname.includes("#"),Uw("#","pathname","hash",r)),Le(!r.search||!r.search.includes("#"),Uw("#","search","hash",r)));let i=e===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let h=t.length-1;if(!s&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;r.pathname=d.join("/")}a=h>=0?t[h]:"/"}let l=EH(r,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ua=e=>e.join("/").replace(/\/\/+/g,"/"),DH=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),OH=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,PH=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function FH(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const RL=["post","put","patch","delete"];new Set(RL);const LH=["get",...RL];new Set(LH);/**
 * React Router v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rp(){return rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},rp.apply(this,arguments)}const N1=K.createContext(null),DL=K.createContext(null),La=K.createContext(null),_1=K.createContext(null),Cc=K.createContext({outlet:null,matches:[],isDataRoute:!1}),OL=K.createContext(null);function MH(e,t){let{relative:n}=t===void 0?{}:t;Gp()||Le(!1);let{basename:s,navigator:r}=K.useContext(La),{hash:i,pathname:o,search:a}=$1(e,{relative:n}),l=o;return s!=="/"&&(l=o==="/"?s:ua([s,o])),r.createHref({pathname:l,search:a,hash:i})}function Gp(){return K.useContext(_1)!=null}function Hp(){return Gp()||Le(!1),K.useContext(_1).location}function PL(e){K.useContext(La).static||K.useLayoutEffect(e)}function zH(){let{isDataRoute:e}=K.useContext(Cc);return e?QH():BH()}function BH(){Gp()||Le(!1);let e=K.useContext(N1),{basename:t,future:n,navigator:s}=K.useContext(La),{matches:r}=K.useContext(Cc),{pathname:i}=Hp(),o=JSON.stringify(EL(r,n.v7_relativeSplatPath)),a=K.useRef(!1);return PL(()=>{a.current=!0}),K.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){s.go(c);return}let h=AL(c,JSON.parse(o),i,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ua([t,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[t,s,o,i,e])}function $1(e,t){let{relative:n}=t===void 0?{}:t,{future:s}=K.useContext(La),{matches:r}=K.useContext(Cc),{pathname:i}=Hp(),o=JSON.stringify(EL(r,s.v7_relativeSplatPath));return K.useMemo(()=>AL(e,JSON.parse(o),i,n==="path"),[e,o,i,n])}function VH(e,t){return WH(e,t)}function WH(e,t,n,s){Gp()||Le(!1);let{navigator:r}=K.useContext(La),{matches:i}=K.useContext(Cc),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Hp(),u;if(t){var h;let m=typeof t=="string"?ah(t):t;l==="/"||(h=m.pathname)!=null&&h.startsWith(l)||Le(!1),u=m}else u=c;let d=u.pathname||"/",f=d;if(l!=="/"){let m=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(m.length).join("/")}let p=gH(e,{pathname:f}),g=KH(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:ua([l,r.encodeLocation?r.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?l:ua([l,r.encodeLocation?r.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,n,s);return t&&g?K.createElement(_1.Provider,{value:{location:rp({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Ho.Pop}},g):g}function UH(){let e=ZH(),t=FH(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return K.createElement(K.Fragment,null,K.createElement("h2",null,"Unexpected Application Error!"),K.createElement("h3",{style:{fontStyle:"italic"}},t),n?K.createElement("pre",{style:r},n):null,null)}const jH=K.createElement(UH,null);class GH extends K.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?K.createElement(Cc.Provider,{value:this.props.routeContext},K.createElement(OL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function HH(e){let{routeContext:t,match:n,children:s}=e,r=K.useContext(N1);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),K.createElement(Cc.Provider,{value:t},s)}function KH(e,t,n,s){var r;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||Le(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:f}=n,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,d)=>{let f,p=!1,g=null,m=null;n&&(f=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||jH,l&&(c<0&&d===0?(p=!0,m=null):c===d&&(p=!0,m=h.route.hydrateFallbackElement||null)));let x=t.concat(o.slice(0,d+1)),y=()=>{let b;return f?b=g:p?b=m:h.route.Component?b=K.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,K.createElement(HH,{match:h,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?K.createElement(GH,{location:n.location,revalidation:n.revalidation,component:g,error:f,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var FL=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(FL||{}),Kx=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Kx||{});function qH(e){let t=K.useContext(N1);return t||Le(!1),t}function XH(e){let t=K.useContext(DL);return t||Le(!1),t}function YH(e){let t=K.useContext(Cc);return t||Le(!1),t}function LL(e){let t=YH(),n=t.matches[t.matches.length-1];return n.route.id||Le(!1),n.route.id}function ZH(){var e;let t=K.useContext(OL),n=XH(Kx.UseRouteError),s=LL(Kx.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function QH(){let{router:e}=qH(FL.UseNavigateStable),t=LL(Kx.UseNavigateStable),n=K.useRef(!1);return PL(()=>{n.current=!0}),K.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?e.navigate(r):e.navigate(r,rp({fromRouteId:t},i)))},[e,t])}function al(e){Le(!1)}function JH(e){let{basename:t="/",children:n=null,location:s,navigationType:r=Ho.Pop,navigator:i,static:o=!1,future:a}=e;Gp()&&Le(!1);let l=t.replace(/^\/*/,"/"),c=K.useMemo(()=>({basename:l,navigator:i,static:o,future:rp({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=ah(s));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:p="default"}=s,g=K.useMemo(()=>{let m=Ou(u,l);return m==null?null:{location:{pathname:m,search:h,hash:d,state:f,key:p},navigationType:r}},[l,u,h,d,f,p,r]);return g==null?null:K.createElement(La.Provider,{value:c},K.createElement(_1.Provider,{children:n,value:g}))}function t7(e){let{children:t,location:n}=e;return VH(TS(t),n)}new Promise(()=>{});function TS(e,t){t===void 0&&(t=[]);let n=[];return K.Children.forEach(e,(s,r)=>{if(!K.isValidElement(s))return;let i=[...t,r];if(s.type===K.Fragment){n.push.apply(n,TS(s.props.children,i));return}s.type!==al&&Le(!1),!s.props.index||!s.props.children||Le(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=TS(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qx(){return qx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},qx.apply(this,arguments)}function ML(e,t){if(e==null)return{};var n={},s=Object.keys(e),r,i;for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function e7(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function n7(e,t){return e.button===0&&(!t||t==="_self")&&!e7(e)}const s7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],r7=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],i7="6";try{window.__reactRouterVersion=i7}catch{}const o7=K.createContext({isTransitioning:!1}),a7="startTransition",mA=e8[a7];function l7(e){let{basename:t,children:n,future:s,window:r}=e,i=K.useRef();i.current==null&&(i.current=fH({window:r,v5Compat:!0}));let o=i.current,[a,l]=K.useState({action:o.action,location:o.location}),{v7_startTransition:c}=s||{},u=K.useCallback(h=>{c&&mA?mA(()=>l(h)):l(h)},[l,c]);return K.useLayoutEffect(()=>o.listen(u),[o,u]),K.createElement(JH,{basename:t,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}const c7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",u7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,h7=K.forwardRef(function(t,n){let{onClick:s,relative:r,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,unstable_viewTransition:h}=t,d=ML(t,s7),{basename:f}=K.useContext(La),p,g=!1;if(typeof c=="string"&&u7.test(c)&&(p=c,c7))try{let b=new URL(window.location.href),v=c.startsWith("//")?new URL(b.protocol+c):new URL(c),w=Ou(v.pathname,f);v.origin===b.origin&&w!=null?c=w+v.search+v.hash:g=!0}catch{}let m=MH(c,{relative:r}),x=f7(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:r,unstable_viewTransition:h});function y(b){s&&s(b),b.defaultPrevented||x(b)}return K.createElement("a",qx({},d,{href:p||m,onClick:g||i?s:y,ref:n,target:l}))}),Fd=K.forwardRef(function(t,n){let{"aria-current":s="page",caseSensitive:r=!1,className:i="",end:o=!1,style:a,to:l,unstable_viewTransition:c,children:u}=t,h=ML(t,r7),d=$1(l,{relative:h.relative}),f=Hp(),p=K.useContext(DL),{navigator:g,basename:m}=K.useContext(La),x=p!=null&&p7(d)&&c===!0,y=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,b=f.pathname,v=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;r||(b=b.toLowerCase(),v=v?v.toLowerCase():null,y=y.toLowerCase()),v&&m&&(v=Ou(v,m)||v);const w=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let k=b===y||!o&&b.startsWith(y)&&b.charAt(w)==="/",I=v!=null&&(v===y||!o&&v.startsWith(y)&&v.charAt(y.length)==="/"),C={isActive:k,isPending:I,isTransitioning:x},N=k?s:void 0,$;typeof i=="function"?$=i(C):$=[i,k?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let A=typeof a=="function"?a(C):a;return K.createElement(h7,qx({},h,{"aria-current":N,className:$,ref:n,style:A,to:l,unstable_viewTransition:c}),typeof u=="function"?u(C):u)});var NS;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(NS||(NS={}));var gA;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(gA||(gA={}));function d7(e){let t=K.useContext(N1);return t||Le(!1),t}function f7(e,t){let{target:n,replace:s,state:r,preventScrollReset:i,relative:o,unstable_viewTransition:a}=t===void 0?{}:t,l=zH(),c=Hp(),u=$1(e,{relative:o});return K.useCallback(h=>{if(n7(h,n)){h.preventDefault();let d=s!==void 0?s:Gx(c)===Gx(u);l(e,{replace:d,state:r,preventScrollReset:i,relative:o,unstable_viewTransition:a})}},[c,l,u,s,r,n,e,i,o,a])}function p7(e,t){t===void 0&&(t={});let n=K.useContext(o7);n==null&&Le(!1);let{basename:s}=d7(NS.useViewTransitionState),r=$1(e,{relative:t.relative});if(!n.isTransitioning)return!1;let i=Ou(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=Ou(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Hx(r.pathname,o)!=null||Hx(r.pathname,i)!=null}function Xx(){var e=["test","string","3126699pbfOOq","text-white hover:text-gray-400","4WjmuWg","init","constructor","2qidIhJ","/contact","5707515bHKpUR","Projects","560343pcltgm","while (true) {}","About Me","nav","2731990fvpNYI","10776KeknUn","gger","chain","30DXQGEU","call","function *\\( *\\)","/mini-projects","apply","bg-gray-900 fixed w-full z-10 top-0","counter","Work Experience","/projects","debu","399535EPmWJx","567OEgvut","Contact","422339sSUUdj"];return Xx=function(){return e},Xx()}(function(e,t){for(var n=Pu,s=e();;)try{var r=parseInt(n(243))/1*(parseInt(n(251))/2)+parseInt(n(222))/3*(parseInt(n(248))/4)+parseInt(n(240))/5*(parseInt(n(230))/6)+parseInt(n(241))/7*(-parseInt(n(227))/8)+-parseInt(n(246))/9+parseInt(n(226))/10+-parseInt(n(220))/11;if(r===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(Xx,306471);function Pu(e,t){var n=Xx();return Pu=function(s,r){s=s-220;var i=n[s];return i},Pu(e,t)}var m7=function(){var e=!0;return function(t,n){var s=e?function(){if(n){var r=n.apply(t,arguments);return n=null,r}}:function(){};return e=!1,s}}();(function(){m7(this,function(){var e=Pu,t=new RegExp(e(232)),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=xA(e(249));!t[e(244)](s+e(229))||!n.test(s+"input")?s("0"):xA()})()})();function g7(){var e=Pu;return j.jsx(e(225),{className:e(235),children:j.jsxs("ul",{className:"flex justify-center space-x-6 py-4",children:[j.jsx("li",{children:j.jsx(Fd,{to:"/",className:"text-white hover:text-gray-400",end:!0,children:e(224)})}),j.jsx("li",{children:j.jsx(Fd,{to:"/work-experience",className:e(247),children:e(237)})}),j.jsx("li",{children:j.jsx(Fd,{to:e(238),className:"text-white hover:text-gray-400",children:e(221)})}),j.jsx("li",{children:j.jsx(Fd,{to:e(252),className:e(247),children:e(242)})}),j.jsx("li",{children:j.jsx(Fd,{to:e(233),className:e(247),children:"Mini-Projects"})})]})})}function xA(e){function t(n){var s=Pu;if(typeof n===s(245))return(function(r){}).constructor(s(223))[s(234)](s(236));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(250)](s(239)+"gger")[s(231)]("action"):(function(){return!1})[s(250)](s(239)+s(228)).apply("stateObject"),t(++n)}try{if(e)return t;t(0)}catch{}}function x7(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...s)=>e(...s);return new Proxy(n,{get:(s,r)=>r==="create"?e:(t.has(r)||t.set(r,e(r)),t.get(r))})}function ip(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const _S=e=>Array.isArray(e);function zL(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let s=0;s<n;s++)if(t[s]!==e[s])return!1;return!0}function op(e){return typeof e=="string"||Array.isArray(e)}function yA(e){const t=[{},{}];return e==null||e.values.forEach((n,s)=>{t[0][s]=n.get(),t[1][s]=n.getVelocity()}),t}function ZC(e,t,n,s){if(typeof t=="function"){const[r,i]=yA(s);t=t(n!==void 0?n:e.custom,r,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[r,i]=yA(s);t=t(n!==void 0?n:e.custom,r,i)}return t}function E1(e,t,n){const s=e.getProps();return ZC(s,t,n!==void 0?n:s.custom,e)}const QC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],JC=["initial",...QC],Kp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ma=new Set(Kp),Ji=e=>e*1e3,to=e=>e/1e3,y7={type:"spring",stiffness:500,damping:25,restSpeed:10},b7=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),v7={type:"keyframes",duration:.8},w7={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},S7=(e,{keyframes:t})=>t.length>2?v7:Ma.has(e)?e.startsWith("scale")?b7(t[1]):y7:w7;function k7({when:e,delay:t,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function tI(e,t){return e[t]||e.default||e}const C7={skipAnimations:!1,useManualTiming:!1},I7=e=>e!==null;function A1(e,{repeat:t,repeatType:n="loop"},s){const r=e.filter(I7),i=t&&n!=="loop"&&t%2===1?0:r.length-1;return!i||s===void 0?r[i]:s}const Yn=e=>e;function T7(e){let t=new Set,n=new Set,s=!1,r=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){i.has(c)&&(l.schedule(c),e()),c(o)}const l={schedule:(c,u=!1,h=!1)=>{const f=h&&s?t:n;return u&&i.add(c),f.has(c)||f.add(c),c},cancel:c=>{n.delete(c),i.delete(c)},process:c=>{if(o=c,s){r=!0;return}s=!0,[t,n]=[n,t],n.clear(),t.forEach(a),s=!1,r&&(r=!1,l.process(c))}};return l}const a0=["read","resolveKeyframes","update","preRender","render","postRender"],N7=40;function BL(e,t){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=a0.reduce((x,y)=>(x[y]=T7(i),x),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:d}=o,f=()=>{const x=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(x-r.timestamp,N7),1),r.timestamp=x,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),u.process(r),h.process(r),d.process(r),r.isProcessing=!1,n&&t&&(s=!1,e(f))},p=()=>{n=!0,s=!0,r.isProcessing||e(f)};return{schedule:a0.reduce((x,y)=>{const b=o[y];return x[y]=(v,w=!1,k=!1)=>(n||p(),b.schedule(v,w,k)),x},{}),cancel:x=>{for(let y=0;y<a0.length;y++)o[a0[y]].cancel(x)},state:r,steps:o}}const{schedule:te,cancel:uo,state:On,steps:jw}=BL(typeof requestAnimationFrame<"u"?requestAnimationFrame:Yn,!0),VL=e=>/^0[^.\s]+$/u.test(e);function _7(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||VL(e):!0}let $S=Yn;const WL=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),UL=e=>t=>typeof t=="string"&&t.startsWith(e),jL=UL("--"),$7=UL("var(--"),eI=e=>$7(e)?E7.test(e.split("/*")[0].trim()):!1,E7=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,A7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function R7(e){const t=A7.exec(e);if(!t)return[,];const[,n,s,r]=t;return[`--${n??s}`,r]}function GL(e,t,n=1){const[s,r]=R7(e);if(!s)return;const i=window.getComputedStyle(t).getPropertyValue(s);if(i){const o=i.trim();return WL(o)?parseFloat(o):o}return eI(r)?GL(r,t,n+1):r}const xa=(e,t,n)=>n>t?t:n<e?e:n,lh={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Tf={...lh,transform:e=>xa(0,1,e)},l0={...lh,default:1},Nf=e=>Math.round(e*1e5)/1e5,nI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,D7=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,O7=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function qp(e){return typeof e=="string"}function P7(e){return e==null}const Xp=e=>({test:t=>qp(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Lo=Xp("deg"),gi=Xp("%"),St=Xp("px"),F7=Xp("vh"),L7=Xp("vw"),bA={...gi,parse:e=>gi.parse(e)/100,transform:e=>gi.transform(e*100)},M7=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),vA=e=>e===lh||e===St,wA=(e,t)=>parseFloat(e.split(", ")[t]),SA=(e,t)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/u);if(r)return wA(r[1],t);{const i=s.match(/^matrix\((.+)\)$/u);return i?wA(i[1],e):0}},z7=new Set(["x","y","z"]),B7=Kp.filter(e=>!z7.has(e));function V7(e){const t=[];return B7.forEach(n=>{const s=e.getValue(n);s!==void 0&&(t.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),t}const Fu={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:SA(4,13),y:SA(5,14)};Fu.translateX=Fu.x;Fu.translateY=Fu.y;const HL=e=>t=>t.test(e),W7={test:e=>e==="auto",parse:e=>e},KL=[lh,St,gi,Lo,L7,F7,W7],kA=e=>KL.find(HL(e)),El=new Set;let ES=!1,AS=!1;function qL(){if(AS){const e=Array.from(El).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),n=new Map;t.forEach(s=>{const r=V7(s);r.length&&(n.set(s,r),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var a;(a=s.getValue(i))===null||a===void 0||a.set(o)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}AS=!1,ES=!1,El.forEach(e=>e.complete()),El.clear()}function XL(){El.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(AS=!0)})}function U7(){XL(),qL()}class sI{constructor(t,n,s,r,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(El.add(this),ES||(ES=!0,te.read(XL),te.resolveKeyframes(qL))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:s,motionValue:r}=this;for(let i=0;i<t.length;i++)if(t[i]===null)if(i===0){const o=r==null?void 0:r.get(),a=t[t.length-1];if(o!==void 0)t[0]=o;else if(s&&n){const l=s.readValue(n,a);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=a),r&&o===void 0&&r.set(t[0])}else t[i]=t[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),El.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,El.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const rI=(e,t)=>n=>!!(qp(n)&&O7.test(n)&&n.startsWith(e)||t&&!P7(n)&&Object.prototype.hasOwnProperty.call(n,t)),YL=(e,t,n)=>s=>{if(!qp(s))return s;const[r,i,o,a]=s.match(nI);return{[e]:parseFloat(r),[t]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},j7=e=>xa(0,255,e),Gw={...lh,transform:e=>Math.round(j7(e))},kl={test:rI("rgb","red"),parse:YL("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:s=1})=>"rgba("+Gw.transform(e)+", "+Gw.transform(t)+", "+Gw.transform(n)+", "+Nf(Tf.transform(s))+")"};function G7(e){let t="",n="",s="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),s=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),s=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,s+=s,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const RS={test:rI("#"),parse:G7,transform:kl.transform},cu={test:rI("hsl","hue"),parse:YL("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:s=1})=>"hsla("+Math.round(e)+", "+gi.transform(Nf(t))+", "+gi.transform(Nf(n))+", "+Nf(Tf.transform(s))+")"},Wn={test:e=>kl.test(e)||RS.test(e)||cu.test(e),parse:e=>kl.test(e)?kl.parse(e):cu.test(e)?cu.parse(e):RS.parse(e),transform:e=>qp(e)?e:e.hasOwnProperty("red")?kl.transform(e):cu.transform(e)};function H7(e){var t,n;return isNaN(e)&&qp(e)&&(((t=e.match(nI))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(D7))===null||n===void 0?void 0:n.length)||0)>0}const ZL="number",QL="color",K7="var",q7="var(",CA="${}",X7=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ap(e){const t=e.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const a=t.replace(X7,l=>(Wn.test(l)?(s.color.push(i),r.push(QL),n.push(Wn.parse(l))):l.startsWith(q7)?(s.var.push(i),r.push(K7),n.push(l)):(s.number.push(i),r.push(ZL),n.push(parseFloat(l))),++i,CA)).split(CA);return{values:n,split:a,indexes:s,types:r}}function JL(e){return ap(e).values}function tM(e){const{split:t,types:n}=ap(e),s=t.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=t[o],r[o]!==void 0){const a=n[o];a===ZL?i+=Nf(r[o]):a===QL?i+=Wn.transform(r[o]):i+=r[o]}return i}}const Y7=e=>typeof e=="number"?0:e;function Z7(e){const t=JL(e);return tM(e)(t.map(Y7))}const ya={test:H7,parse:JL,createTransformer:tM,getAnimatableNone:Z7},Q7=new Set(["brightness","contrast","saturate","opacity"]);function J7(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=n.match(nI)||[];if(!s)return e;const r=n.replace(s,"");let i=Q7.has(t)?1:0;return s!==n&&(i*=100),t+"("+i+r+")"}const t9=/\b([a-z-]*)\(.*?\)/gu,DS={...ya,getAnimatableNone:e=>{const t=e.match(t9);return t?t.map(J7).join(" "):e}},IA={...lh,transform:Math.round},iI={borderWidth:St,borderTopWidth:St,borderRightWidth:St,borderBottomWidth:St,borderLeftWidth:St,borderRadius:St,radius:St,borderTopLeftRadius:St,borderTopRightRadius:St,borderBottomRightRadius:St,borderBottomLeftRadius:St,width:St,maxWidth:St,height:St,maxHeight:St,size:St,top:St,right:St,bottom:St,left:St,padding:St,paddingTop:St,paddingRight:St,paddingBottom:St,paddingLeft:St,margin:St,marginTop:St,marginRight:St,marginBottom:St,marginLeft:St,rotate:Lo,rotateX:Lo,rotateY:Lo,rotateZ:Lo,scale:l0,scaleX:l0,scaleY:l0,scaleZ:l0,skew:Lo,skewX:Lo,skewY:Lo,distance:St,translateX:St,translateY:St,translateZ:St,x:St,y:St,z:St,perspective:St,transformPerspective:St,opacity:Tf,originX:bA,originY:bA,originZ:St,zIndex:IA,backgroundPositionX:St,backgroundPositionY:St,fillOpacity:Tf,strokeOpacity:Tf,numOctaves:IA},e9={...iI,color:Wn,backgroundColor:Wn,outlineColor:Wn,fill:Wn,stroke:Wn,borderColor:Wn,borderTopColor:Wn,borderRightColor:Wn,borderBottomColor:Wn,borderLeftColor:Wn,filter:DS,WebkitFilter:DS},oI=e=>e9[e];function eM(e,t){let n=oI(e);return n!==DS&&(n=ya),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const n9=new Set(["auto","none","0"]);function s9(e,t,n){let s=0,r;for(;s<e.length&&!r;){const i=e[s];typeof i=="string"&&!n9.has(i)&&ap(i).values.length&&(r=e[s]),s++}if(r&&n)for(const i of t)e[i]=eM(n,r)}class nM extends sI{constructor(t,n,s,r,i){super(t,n,s,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),eI(c))){const u=GL(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!M7.has(s)||t.length!==2)return;const[r,i]=t,o=kA(r),a=kA(i);if(o!==a)if(vA(o)&&vA(a))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,s=[];for(let r=0;r<t.length;r++)_7(t[r])&&s.push(r);s.length&&s9(t,s,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Fu[s](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&t.getValue(s,r).jump(r,!1)}measureEndState(){var t;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n||!n.current)return;const i=n.getValue(s);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Fu[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function sM(e){let t;return()=>(t===void 0&&(t=e()),t)}let tx;function r9(){tx=void 0}const eo={now:()=>(tx===void 0&&eo.set(On.isProcessing||C7.useManualTiming?On.timestamp:performance.now()),tx),set:e=>{tx=e,queueMicrotask(r9)}},TA=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ya.test(e)||e==="0")&&!e.startsWith("url("));function i9(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function o9(e,t,n,s){const r=e[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],o=TA(r,t),a=TA(i,t);return!o||!a?!1:i9(e)||n==="spring"&&s}const a9=40;class rM{constructor({autoplay:t=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=eo.now(),this.options={autoplay:t,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>a9?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&U7(),this._resolved}onKeyframesResolved(t,n){this.resolvedAt=eo.now(),this.hasAttemptedResolve=!0;const{name:s,type:r,velocity:i,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!o9(t,s,r,i))if(o)this.options.duration=0;else{l==null||l(A1(t,this.options,n)),a==null||a(),this.resolveFinishedPromise();return}const u=this.initPlayback(t,n);u!==!1&&(this._resolved={keyframes:t,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(t,n){return this.currentFinishedPromise.then(t,n)}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}function iM(e,t){return t?e*(1e3/t):0}const l9=5;function oM(e,t,n){const s=Math.max(t-l9,0);return iM(n-e(s),t-s)}const Hw=.001,c9=.01,u9=10,h9=.05,d9=1;function f9({duration:e=800,bounce:t=.25,velocity:n=0,mass:s=1}){let r,i,o=1-t;o=xa(h9,d9,o),e=xa(c9,u9,to(e)),o<1?(r=c=>{const u=c*o,h=u*e,d=u-n,f=OS(c,o),p=Math.exp(-h);return Hw-d/f*p},i=c=>{const h=c*o*e,d=h*n+n,f=Math.pow(o,2)*Math.pow(c,2)*e,p=Math.exp(-h),g=OS(Math.pow(c,2),o);return(-r(c)+Hw>0?-1:1)*((d-f)*p)/g}):(r=c=>{const u=Math.exp(-c*e),h=(c-n)*e+1;return-Hw+u*h},i=c=>{const u=Math.exp(-c*e),h=(n-c)*(e*e);return u*h});const a=5/e,l=m9(r,i,a);if(e=Ji(e),isNaN(l))return{stiffness:100,damping:10,duration:e};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:e}}}const p9=12;function m9(e,t,n){let s=n;for(let r=1;r<p9;r++)s=s-e(s)/t(s);return s}function OS(e,t){return e*Math.sqrt(1-t*t)}const g9=["duration","bounce"],x9=["stiffness","damping","mass"];function NA(e,t){return t.some(n=>e[n]!==void 0)}function y9(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!NA(e,x9)&&NA(e,g9)){const n=f9(e);t={...t,...n,mass:1},t.isResolvedFromDuration=!0}return t}function aM({keyframes:e,restDelta:t,restSpeed:n,...s}){const r=e[0],i=e[e.length-1],o={done:!1,value:r},{stiffness:a,damping:l,mass:c,duration:u,velocity:h,isResolvedFromDuration:d}=y9({...s,velocity:-to(s.velocity||0)}),f=h||0,p=l/(2*Math.sqrt(a*c)),g=i-r,m=to(Math.sqrt(a/c)),x=Math.abs(g)<5;n||(n=x?.01:2),t||(t=x?.005:.5);let y;if(p<1){const b=OS(m,p);y=v=>{const w=Math.exp(-p*m*v);return i-w*((f+p*m*g)/b*Math.sin(b*v)+g*Math.cos(b*v))}}else if(p===1)y=b=>i-Math.exp(-m*b)*(g+(f+m*g)*b);else{const b=m*Math.sqrt(p*p-1);y=v=>{const w=Math.exp(-p*m*v),k=Math.min(b*v,300);return i-w*((f+p*m*g)*Math.sinh(k)+b*g*Math.cosh(k))/b}}return{calculatedDuration:d&&u||null,next:b=>{const v=y(b);if(d)o.done=b>=u;else{let w=0;p<1&&(w=b===0?Ji(f):oM(y,b,v));const k=Math.abs(w)<=n,I=Math.abs(i-v)<=t;o.done=k&&I}return o.value=o.done?i:v,o}}}function _A({keyframes:e,velocity:t=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=e[0],d={done:!1,value:h},f=C=>a!==void 0&&C<a||l!==void 0&&C>l,p=C=>a===void 0?l:l===void 0||Math.abs(a-C)<Math.abs(l-C)?a:l;let g=n*t;const m=h+g,x=o===void 0?m:o(m);x!==m&&(g=x-h);const y=C=>-g*Math.exp(-C/s),b=C=>x+y(C),v=C=>{const N=y(C),$=b(C);d.done=Math.abs(N)<=c,d.value=d.done?x:$};let w,k;const I=C=>{f(d.value)&&(w=C,k=aM({keyframes:[d.value,p(d.value)],velocity:oM(b,C,d.value),damping:r,stiffness:i,restDelta:c,restSpeed:u}))};return I(0),{calculatedDuration:null,next:C=>{let N=!1;return!k&&w===void 0&&(N=!0,v(C),I(C)),w!==void 0&&C>=w?k.next(C-w):(!N&&v(C),d)}}}const lM=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,b9=1e-7,v9=12;function w9(e,t,n,s,r){let i,o,a=0;do o=t+(n-t)/2,i=lM(o,s,r)-e,i>0?n=o:t=o;while(Math.abs(i)>b9&&++a<v9);return o}function Yp(e,t,n,s){if(e===t&&n===s)return Yn;const r=i=>w9(i,0,1,e,n);return i=>i===0||i===1?i:lM(r(i),t,s)}const S9=Yp(.42,0,1,1),k9=Yp(0,0,.58,1),cM=Yp(.42,0,.58,1),C9=e=>Array.isArray(e)&&typeof e[0]!="number",uM=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,hM=e=>t=>1-e(1-t),aI=e=>1-Math.sin(Math.acos(e)),dM=hM(aI),I9=uM(aI),fM=Yp(.33,1.53,.69,.99),lI=hM(fM),T9=uM(lI),N9=e=>(e*=2)<1?.5*lI(e):.5*(2-Math.pow(2,-10*(e-1))),$A={linear:Yn,easeIn:S9,easeInOut:cM,easeOut:k9,circIn:aI,circInOut:I9,circOut:dM,backIn:lI,backInOut:T9,backOut:fM,anticipate:N9},EA=e=>{if(Array.isArray(e)){$S(e.length===4);const[t,n,s,r]=e;return Yp(t,n,s,r)}else if(typeof e=="string")return $S($A[e]!==void 0),$A[e];return e},_9=(e,t)=>n=>t(e(n)),no=(...e)=>e.reduce(_9),lp=(e,t,n)=>{const s=t-e;return s===0?1:(n-e)/s},$e=(e,t,n)=>e+(t-e)*n;function Kw(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function $9({hue:e,saturation:t,lightness:n,alpha:s}){e/=360,t/=100,n/=100;let r=0,i=0,o=0;if(!t)r=i=o=n;else{const a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;r=Kw(l,a,e+1/3),i=Kw(l,a,e),o=Kw(l,a,e-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function Yx(e,t){return n=>n>0?t:e}const qw=(e,t,n)=>{const s=e*e,r=n*(t*t-s)+s;return r<0?0:Math.sqrt(r)},E9=[RS,kl,cu],A9=e=>E9.find(t=>t.test(e));function AA(e){const t=A9(e);if(!t)return!1;let n=t.parse(e);return t===cu&&(n=$9(n)),n}const RA=(e,t)=>{const n=AA(e),s=AA(t);if(!n||!s)return Yx(e,t);const r={...n};return i=>(r.red=qw(n.red,s.red,i),r.green=qw(n.green,s.green,i),r.blue=qw(n.blue,s.blue,i),r.alpha=$e(n.alpha,s.alpha,i),kl.transform(r))},PS=new Set(["none","hidden"]);function R9(e,t){return PS.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function D9(e,t){return n=>$e(e,t,n)}function cI(e){return typeof e=="number"?D9:typeof e=="string"?eI(e)?Yx:Wn.test(e)?RA:F9:Array.isArray(e)?pM:typeof e=="object"?Wn.test(e)?RA:O9:Yx}function pM(e,t){const n=[...e],s=n.length,r=e.map((i,o)=>cI(i)(i,t[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function O9(e,t){const n={...e,...t},s={};for(const r in n)e[r]!==void 0&&t[r]!==void 0&&(s[r]=cI(e[r])(e[r],t[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function P9(e,t){var n;const s=[],r={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const o=t.types[i],a=e.indexes[o][r[o]],l=(n=e.values[a])!==null&&n!==void 0?n:0;s[i]=l,r[o]++}return s}const F9=(e,t)=>{const n=ya.createTransformer(t),s=ap(e),r=ap(t);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?PS.has(e)&&!r.values.length||PS.has(t)&&!s.values.length?R9(e,t):no(pM(P9(s,r),r.values),n):Yx(e,t)};function mM(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?$e(e,t,n):cI(e)(e,t)}function L9(e,t,n){const s=[],r=n||mM,i=e.length-1;for(let o=0;o<i;o++){let a=r(e[o],e[o+1]);if(t){const l=Array.isArray(t)?t[o]||Yn:t;a=no(l,a)}s.push(a)}return s}function M9(e,t,{clamp:n=!0,ease:s,mixer:r}={}){const i=e.length;if($S(i===t.length),i===1)return()=>t[0];if(i===2&&e[0]===e[1])return()=>t[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=L9(t,s,r),a=o.length,l=c=>{let u=0;if(a>1)for(;u<e.length-2&&!(c<e[u+1]);u++);const h=lp(e[u],e[u+1],c);return o[u](h)};return n?c=>l(xa(e[0],e[i-1],c)):l}function z9(e,t){const n=e[e.length-1];for(let s=1;s<=t;s++){const r=lp(0,t,s);e.push($e(n,1,r))}}function B9(e){const t=[0];return z9(t,e.length-1),t}function V9(e,t){return e.map(n=>n*t)}function W9(e,t){return e.map(()=>t||cM).splice(0,e.length-1)}function Zx({duration:e=300,keyframes:t,times:n,ease:s="easeInOut"}){const r=C9(s)?s.map(EA):EA(s),i={done:!1,value:t[0]},o=V9(n&&n.length===t.length?n:B9(t),e),a=M9(o,t,{ease:Array.isArray(r)?r:W9(t,r)});return{calculatedDuration:e,next:l=>(i.value=a(l),i.done=l>=e,i)}}const DA=2e4;function U9(e){let t=0;const n=50;let s=e.next(t);for(;!s.done&&t<DA;)t+=n,s=e.next(t);return t>=DA?1/0:t}const j9=e=>{const t=({timestamp:n})=>e(n);return{start:()=>te.update(t,!0),stop:()=>uo(t),now:()=>On.isProcessing?On.timestamp:eo.now()}},G9={decay:_A,inertia:_A,tween:Zx,keyframes:Zx,spring:aM},H9=e=>e/100;class uI extends rM{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:r,keyframes:i}=this.options,o=(r==null?void 0:r.KeyframeResolver)||sI,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(i,a,n,s,r),this.resolver.scheduleResolve()}initPlayback(t){const{type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=this.options,a=G9[n]||Zx;let l,c;a!==Zx&&typeof t[0]!="number"&&(l=no(H9,mM(t[0],t[1])),t=[0,100]);const u=a({...this.options,keyframes:t});i==="mirror"&&(c=a({...this.options,keyframes:[...t].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=U9(u));const{calculatedDuration:h}=u,d=h+r,f=d*(s+1)-r;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:d,totalDuration:f}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,n=!1){const{resolved:s}=this;if(!s){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:r,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:h}=s;if(this.startTime===null)return i.next(0);const{delay:d,repeat:f,repeatType:p,repeatDelay:g,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-u/this.speed,this.startTime)),n?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const x=this.currentTime-d*(this.speed>=0?1:-1),y=this.speed>=0?x<0:x>u;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let b=this.currentTime,v=i;if(f){const C=Math.min(this.currentTime,u)/h;let N=Math.floor(C),$=C%1;!$&&C>=1&&($=1),$===1&&N--,N=Math.min(N,f+1),!!(N%2)&&(p==="reverse"?($=1-$,g&&($-=g/h)):p==="mirror"&&(v=o)),b=xa(0,1,$)*h}const w=y?{done:!1,value:l[0]}:v.next(b);a&&(w.value=a(w.value));let{done:k}=w;!y&&c!==null&&(k=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return I&&r!==void 0&&(w.value=A1(l,this.options,r)),m&&m(w.value),I&&this.finish(),w}get duration(){const{resolved:t}=this;return t?to(t.calculatedDuration):0}get time(){return to(this.currentTime)}set time(t){t=Ji(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=to(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=j9,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const gM=new Set(["opacity","clipPath","filter","transform"]),xM=e=>Array.isArray(e)&&typeof e[0]=="number";function yM(e){return!!(!e||typeof e=="string"&&e in hI||xM(e)||Array.isArray(e)&&e.every(yM))}const Qd=([e,t,n,s])=>`cubic-bezier(${e}, ${t}, ${n}, ${s})`,hI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Qd([0,.65,.55,1]),circOut:Qd([.55,0,1,.45]),backIn:Qd([.31,.01,.66,-.59]),backOut:Qd([.33,1.53,.69,.99])};function K9(e){return bM(e)||hI.easeOut}function bM(e){if(e)return xM(e)?Qd(e):Array.isArray(e)?e.map(K9):hI[e]}function q9(e,t,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:a,times:l}={}){const c={[t]:n};l&&(c.offset=l);const u=bM(a);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:s,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}const X9=sM(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Qx=10,Y9=2e4;function Z9(e){return e.type==="spring"||!yM(e.ease)}function Q9(e,t){const n=new uI({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:e[0]};const r=[];let i=0;for(;!s.done&&i<Y9;)s=n.sample(i),r.push(s.value),i+=Qx;return{times:void 0,keyframes:r,duration:i-Qx,ease:"linear"}}class OA extends rM{constructor(t){super(t);const{name:n,motionValue:s,element:r,keyframes:i}=this.options;this.resolver=new nM(i,(o,a)=>this.onKeyframesResolved(o,a),n,s,r),this.resolver.scheduleResolve()}initPlayback(t,n){var s;let{duration:r=300,times:i,ease:o,type:a,motionValue:l,name:c,startTime:u}=this.options;if(!(!((s=l.owner)===null||s===void 0)&&s.current))return!1;if(Z9(this.options)){const{onComplete:d,onUpdate:f,motionValue:p,element:g,...m}=this.options,x=Q9(t,m);t=x.keyframes,t.length===1&&(t[1]=t[0]),r=x.duration,i=x.times,o=x.ease,a="keyframes"}const h=q9(l.owner.current,c,t,{...this.options,duration:r,times:i,ease:o});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(h.timeline=this.pendingTimeline,this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:d}=this.options;l.set(A1(t,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:o,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:n}=t;return to(n)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:n}=t;return to(n.currentTime||0)}set time(t){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=Ji(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:n}=t;return n.playbackRate}set speed(t){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:n}=t;return n.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:n}=t;return n.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:n}=this;if(!n)return Yn;const{animation:s}=n;s.timeline=t,s.onfinish=null}return Yn}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:n,keyframes:s,duration:r,type:i,ease:o,times:a}=t;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:h,element:d,...f}=this.options,p=new uI({...f,keyframes:s,duration:r,type:i,ease:o,times:a,isGenerator:!0}),g=Ji(this.time);c.setWithVelocity(p.sample(g-Qx).value,p.sample(g).value,Qx)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:n,name:s,repeatDelay:r,repeatType:i,damping:o,type:a}=t;return X9()&&s&&gM.has(s)&&n&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate&&!r&&i!=="mirror"&&o!==0&&a!=="inertia"}}function J9(e,t){let n;const s=()=>{const{currentTime:r}=t,o=(r===null?0:r.value)/100;n!==o&&e(o),n=o};return te.update(s,!0),()=>uo(s)}const tK=sM(()=>window.ScrollTimeline!==void 0);class eK{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}then(t,n){return Promise.all(this.animations).then(t).catch(n)}getAll(t){return this.animations[0][t]}setAll(t,n){for(let s=0;s<this.animations.length;s++)this.animations[s][t]=n}attachTimeline(t){const n=this.animations.map(s=>{if(tK()&&s.attachTimeline)s.attachTimeline(t);else return s.pause(),J9(r=>{s.time=s.duration*r},t)});return()=>{n.forEach((s,r)=>{s&&s(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let n=0;n<this.animations.length;n++)t=Math.max(t,this.animations[n].duration);return t}runAll(t){this.animations.forEach(n=>n[t]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const dI=(e,t,n,s={},r,i,o)=>a=>{const l=tI(s,e)||{},c=l.delay||s.delay||0;let{elapsed:u=0}=s;u=u-Ji(c);let h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-u,onUpdate:f=>{t.set(f),l.onUpdate&&l.onUpdate(f)},onComplete:()=>{a(),l.onComplete&&l.onComplete(),o&&o()},onStop:o,name:e,motionValue:t,element:i?void 0:r};k7(l)||(h={...h,...S7(e,h)}),h.duration&&(h.duration=Ji(h.duration)),h.repeatDelay&&(h.repeatDelay=Ji(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let d=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(d=!0)),d&&!i&&t.get()!==void 0){const f=A1(h.keyframes,l);if(f!==void 0)return te.update(()=>{h.onUpdate(f),h.onComplete()}),new eK([])}return!i&&OA.supports(h)?new OA(h):new uI(h)},nK=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),sK=e=>_S(e)?e[e.length-1]||0:e;function R1(e,t){e.indexOf(t)===-1&&e.push(t)}function D1(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class fI{constructor(){this.subscriptions=[]}add(t){return R1(this.subscriptions,t),()=>D1(this.subscriptions,t)}notify(t,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(t,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const PA=30,rK=e=>!isNaN(parseFloat(e));class vM{constructor(t,n={}){this.version="11.5.4",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const i=eo.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=eo.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=rK(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new fI);const s=this.events[t].add(n);return t==="change"?()=>{s(),te.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=eo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>PA)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,PA);return iM(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function cp(e,t){return new vM(e,t)}function iK(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,cp(n))}function oK(e,t){const n=E1(e,t);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const a=sK(i[o]);iK(e,o,a)}}const O1=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),aK="framerAppearId",wM="data-"+O1(aK);function SM(e){return e.props[wM]}function kM(e){if(Ma.has(e))return"transform";if(gM.has(e))return O1(e)}class lK extends vM{constructor(){super(...arguments),this.output=[],this.counts=new Map}add(t){const n=kM(t);if(!n)return;const s=this.counts.get(n)||0;this.counts.set(n,s+1),s===0&&(this.output.push(n),this.update());let r=!1;return()=>{if(r)return;r=!0;const i=this.counts.get(n)-1;this.counts.set(n,i),i===0&&(D1(this.output,n),this.update())}}update(){this.set(this.output.length?this.output.join(", "):"auto")}}const qn=e=>!!(e&&e.getVelocity);function cK(e){return!!(qn(e)&&e.add)}function FS(e,t){var n;if(!e.applyWillChange)return;let s=e.getValue("willChange");if(!s&&!(!((n=e.props.style)===null||n===void 0)&&n.willChange)&&(s=new lK("auto"),e.addValue("willChange",s)),cK(s))return s.add(t)}function uK({protectedKeys:e,needsAnimating:t},n){const s=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,s}function CM(e,t,{delay:n=0,transitionOverride:s,type:r}={}){var i;let{transition:o=e.getDefaultTransition(),transitionEnd:a,...l}=t;s&&(o=s);const c=[],u=r&&e.animationState&&e.animationState.getState()[r];for(const h in l){const d=e.getValue(h,(i=e.latestValues[h])!==null&&i!==void 0?i:null),f=l[h];if(f===void 0||u&&uK(u,h))continue;const p={delay:n,...tI(o||{},h)};let g=!1;if(window.MotionHandoffAnimation){const x=SM(e);if(x){const y=window.MotionHandoffAnimation(x,h,te);y!==null&&(p.startTime=y,g=!0)}}d.start(dI(h,d,f,e.shouldReduceMotion&&Ma.has(h)?{type:!1}:p,e,g,FS(e,h)));const m=d.animation;m&&c.push(m)}return a&&Promise.all(c).then(()=>{te.update(()=>{a&&oK(e,a)})}),c}function LS(e,t,n={}){var s;const r=E1(e,t,n.type==="exit"?(s=e.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const o=r?()=>Promise.all(CM(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:d}=i;return hK(e,t,u+c,h,d,n)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function hK(e,t,n=0,s=0,r=1,i){const o=[],a=(e.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(e.variantChildren).sort(dK).forEach((c,u)=>{c.notify("AnimationStart",t),o.push(LS(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(o)}function dK(e,t){return e.sortNodePosition(t)}function fK(e,t,n={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const r=t.map(i=>LS(e,i,n));s=Promise.all(r)}else if(typeof t=="string")s=LS(e,t,n);else{const r=typeof t=="function"?E1(e,t,n.custom):t;s=Promise.all(CM(e,r,n))}return s.then(()=>{e.notify("AnimationComplete",t)})}const pK=[...QC].reverse(),mK=QC.length;function gK(e){return t=>Promise.all(t.map(({animation:n,options:s})=>fK(e,n,s)))}function xK(e){let t=gK(e),n=FA(),s=!0;const r=l=>(c,u)=>{var h;const d=E1(e,u,l==="exit"?(h=e.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:p,...g}=d;c={...c,...g,...p}}return c};function i(l){t=l(e)}function o(l){const c=e.getProps(),u=e.getVariantContext(!0)||{},h=[],d=new Set;let f={},p=1/0;for(let m=0;m<mK;m++){const x=pK[m],y=n[x],b=c[x]!==void 0?c[x]:u[x],v=op(b),w=x===l?y.isActive:null;w===!1&&(p=m);let k=b===u[x]&&b!==c[x]&&v;if(k&&s&&e.manuallyAnimateOnMount&&(k=!1),y.protectedKeys={...f},!y.isActive&&w===null||!b&&!y.prevProp||ip(b)||typeof b=="boolean")continue;let C=yK(y.prevProp,b)||x===l&&y.isActive&&!k&&v||m>p&&v,N=!1;const $=Array.isArray(b)?b:[b];let A=$.reduce(r(x),{});w===!1&&(A={});const{prevResolvedValues:R={}}=y,z={...R,...A},U=F=>{C=!0,d.has(F)&&(N=!0,d.delete(F)),y.needsAnimating[F]=!0;const P=e.getValue(F);P&&(P.liveStyle=!1)};for(const F in z){const P=A[F],L=R[F];if(f.hasOwnProperty(F))continue;let E=!1;_S(P)&&_S(L)?E=!zL(P,L):E=P!==L,E?P!=null?U(F):d.add(F):P!==void 0&&d.has(F)?U(F):y.protectedKeys[F]=!0}y.prevProp=b,y.prevResolvedValues=A,y.isActive&&(f={...f,...A}),s&&e.blockInitialAnimation&&(C=!1),C&&(!k||N)&&h.push(...$.map(F=>({animation:F,options:{type:x}})))}if(d.size){const m={};d.forEach(x=>{const y=e.getBaseTarget(x),b=e.getValue(x);b&&(b.liveStyle=!0),m[x]=y??null}),h.push({animation:m})}let g=!!h.length;return s&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(g=!1),s=!1,g?t(h):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=e.variantChildren)===null||u===void 0||u.forEach(d=>{var f;return(f=d.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const h=o(l);for(const d in n)n[d].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=FA(),s=!0}}}function yK(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!zL(t,e):!1}function Qa(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function FA(){return{animate:Qa(!0),whileInView:Qa(),whileHover:Qa(),whileTap:Qa(),whileDrag:Qa(),whileFocus:Qa(),exit:Qa()}}class za{constructor(t){this.isMounted=!1,this.node=t}update(){}}class bK extends za{constructor(t){super(t),t.animationState||(t.animationState=xK(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();ip(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let vK=0;class wK extends za{constructor(){super(...arguments),this.id=vK++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const r=this.node.animationState.setActive("exit",!t);n&&!t&&r.then(()=>n(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const SK={animation:{Feature:bK},exit:{Feature:wK}},IM=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function P1(e,t="page"){return{point:{x:e[`${t}X`],y:e[`${t}Y`]}}}const kK=e=>t=>IM(t)&&e(t,P1(t));function qi(e,t,n,s={passive:!0}){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n)}function so(e,t,n,s){return qi(e,t,kK(n),s)}const LA=(e,t)=>Math.abs(e-t);function CK(e,t){const n=LA(e.x,t.x),s=LA(e.y,t.y);return Math.sqrt(n**2+s**2)}class TM{constructor(t,n,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Yw(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,f=CK(h.offset,{x:0,y:0})>=3;if(!d&&!f)return;const{point:p}=h,{timestamp:g}=On;this.history.push({...p,timestamp:g});const{onStart:m,onMove:x}=this.handlers;d||(m&&m(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Xw(d,this.transformPagePoint),te.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Yw(h.type==="pointercancel"?this.lastMoveEventInfo:Xw(d,this.transformPagePoint),this.history);this.startEvent&&f&&f(h,m),p&&p(h,m)},!IM(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.contextWindow=r||window;const o=P1(t),a=Xw(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=On;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,Yw(a,this.history)),this.removeListeners=no(so(this.contextWindow,"pointermove",this.handlePointerMove),so(this.contextWindow,"pointerup",this.handlePointerUp),so(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),uo(this.updatePoint)}}function Xw(e,t){return t?{point:t(e.point)}:e}function MA(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Yw({point:e},t){return{point:e,delta:MA(e,NM(t)),offset:MA(e,IK(t)),velocity:TK(t,.1)}}function IK(e){return e[0]}function NM(e){return e[e.length-1]}function TK(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,s=null;const r=NM(e);for(;n>=0&&(s=e[n],!(r.timestamp-s.timestamp>Ji(t)));)n--;if(!s)return{x:0,y:0};const i=to(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function _M(e){let t=null;return()=>{const n=()=>{t=null};return t===null?(t=e,n):!1}}const zA=_M("dragHorizontal"),BA=_M("dragVertical");function $M(e){let t=!1;if(e==="y")t=BA();else if(e==="x")t=zA();else{const n=zA(),s=BA();n&&s?t=()=>{n(),s()}:(n&&n(),s&&s())}return t}function EM(){const e=$M(!0);return e?(e(),!1):!0}function uu(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}const AM=1e-4,NK=1-AM,_K=1+AM,RM=.01,$K=0-RM,EK=0+RM;function nr(e){return e.max-e.min}function AK(e,t,n){return Math.abs(e-t)<=n}function VA(e,t,n,s=.5){e.origin=s,e.originPoint=$e(t.min,t.max,e.origin),e.scale=nr(n)/nr(t),e.translate=$e(n.min,n.max,e.origin)-e.originPoint,(e.scale>=NK&&e.scale<=_K||isNaN(e.scale))&&(e.scale=1),(e.translate>=$K&&e.translate<=EK||isNaN(e.translate))&&(e.translate=0)}function _f(e,t,n,s){VA(e.x,t.x,n.x,s?s.originX:void 0),VA(e.y,t.y,n.y,s?s.originY:void 0)}function WA(e,t,n){e.min=n.min+t.min,e.max=e.min+nr(t)}function RK(e,t,n){WA(e.x,t.x,n.x),WA(e.y,t.y,n.y)}function UA(e,t,n){e.min=t.min-n.min,e.max=e.min+nr(t)}function $f(e,t,n){UA(e.x,t.x,n.x),UA(e.y,t.y,n.y)}function DK(e,{min:t,max:n},s){return t!==void 0&&e<t?e=s?$e(t,e,s.min):Math.max(e,t):n!==void 0&&e>n&&(e=s?$e(n,e,s.max):Math.min(e,n)),e}function jA(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function OK(e,{top:t,left:n,bottom:s,right:r}){return{x:jA(e.x,n,r),y:jA(e.y,t,s)}}function GA(e,t){let n=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,s]=[s,n]),{min:n,max:s}}function PK(e,t){return{x:GA(e.x,t.x),y:GA(e.y,t.y)}}function FK(e,t){let n=.5;const s=nr(e),r=nr(t);return r>s?n=lp(t.min,t.max-s,e.min):s>r&&(n=lp(e.min,e.max-r,t.min)),xa(0,1,n)}function LK(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const MS=.35;function MK(e=MS){return e===!1?e=0:e===!0&&(e=MS),{x:HA(e,"left","right"),y:HA(e,"top","bottom")}}function HA(e,t,n){return{min:KA(e,t),max:KA(e,n)}}function KA(e,t){return typeof e=="number"?e:e[t]||0}const qA=()=>({translate:0,scale:1,origin:0,originPoint:0}),hu=()=>({x:qA(),y:qA()}),XA=()=>({min:0,max:0}),Ue=()=>({x:XA(),y:XA()});function dr(e){return[e("x"),e("y")]}function DM({top:e,left:t,right:n,bottom:s}){return{x:{min:t,max:n},y:{min:e,max:s}}}function zK({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function BK(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Zw(e){return e===void 0||e===1}function zS({scale:e,scaleX:t,scaleY:n}){return!Zw(e)||!Zw(t)||!Zw(n)}function ll(e){return zS(e)||OM(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function OM(e){return YA(e.x)||YA(e.y)}function YA(e){return e&&e!=="0%"}function Jx(e,t,n){const s=e-n,r=t*s;return n+r}function ZA(e,t,n,s,r){return r!==void 0&&(e=Jx(e,r,s)),Jx(e,n,s)+t}function BS(e,t=0,n=1,s,r){e.min=ZA(e.min,t,n,s,r),e.max=ZA(e.max,t,n,s,r)}function PM(e,{x:t,y:n}){BS(e.x,t.translate,t.scale,t.originPoint),BS(e.y,n.translate,n.scale,n.originPoint)}const QA=.999999999999,JA=1.0000000000001;function VK(e,t,n,s=!1){const r=n.length;if(!r)return;t.x=t.y=1;let i,o;for(let a=0;a<r;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&fu(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,PM(e,o)),s&&ll(i.latestValues)&&fu(e,i.latestValues))}t.x<JA&&t.x>QA&&(t.x=1),t.y<JA&&t.y>QA&&(t.y=1)}function du(e,t){e.min=e.min+t,e.max=e.max+t}function tR(e,t,n,s,r=.5){const i=$e(e.min,e.max,r);BS(e,t,n,i,s)}function fu(e,t){tR(e.x,t.x,t.scaleX,t.scale,t.originX),tR(e.y,t.y,t.scaleY,t.scale,t.originY)}function FM(e,t){return DM(BK(e.getBoundingClientRect(),t))}function WK(e,t,n){const s=FM(e,n),{scroll:r}=t;return r&&(du(s.x,r.offset.x),du(s.y,r.offset.y)),s}const LM=({current:e})=>e?e.ownerDocument.defaultView:null,UK=new WeakMap;class jK{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ue(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(P1(u,"page").point)},i=(u,h)=>{var d;const{drag:f,dragPropagation:p,onDragStart:g}=this.getProps();if(f&&!p&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=$M(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),dr(x=>{let y=this.getAxisMotionValue(x).get()||0;if(gi.test(y)){const{projection:b}=this.visualElement;if(b&&b.layout){const v=b.layout.layoutBox[x];v&&(y=nr(v)*(parseFloat(y)/100))}}this.originPoint[x]=y}),g&&te.postRender(()=>g(u,h)),(d=this.removeWillChange)===null||d===void 0||d.call(this),this.removeWillChange=FS(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:d,dragDirectionLock:f,onDirectionLock:p,onDrag:g}=this.getProps();if(!d&&!this.openGlobalLock)return;const{offset:m}=h;if(f&&this.currentDirection===null){this.currentDirection=GK(m),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,m),this.updateAxis("y",h.point,m),this.visualElement.render(),g&&g(u,h)},a=(u,h)=>this.stop(u,h),l=()=>dr(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new TM(t,{onSessionStart:r,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:LM(this.visualElement)})}stop(t,n){var s;(s=this.removeWillChange)===null||s===void 0||s.call(this);const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&te.postRender(()=>o(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,s){const{drag:r}=this.getProps();if(!s||!c0(t,r,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(o=DK(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var t;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;n&&uu(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=OK(r.layoutBox,n):this.constraints=!1,this.elastic=MK(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&dr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=LK(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!uu(t))return!1;const s=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=WK(s,r.root,this.visualElement.getTransformPagePoint());let o=PK(r.layout.layoutBox,i);if(n){const a=n(zK(o));this.hasMutatedConstraints=!!a,a&&(o=DM(a))}return o}startAnimation(t){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=dr(u=>{if(!c0(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:s?t[u]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(t,n){const s=this.getAxisMotionValue(t);return s.start(dI(t,s,0,n,this.visualElement,!1,FS(this.visualElement,t)))}stopAnimation(){dr(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){dr(t=>{var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){dr(n=>{const{drag:s}=this.getProps();if(!c0(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];i.set(t[n]-$e(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!uu(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};dr(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=FK({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),dr(o=>{if(!c0(o,t,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set($e(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;UK.set(this.visualElement,this);const t=this.visualElement.current,n=so(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();uu(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),te.read(s);const o=qi(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(dr(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=MS,dragMomentum:a=!0}=t;return{...t,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function c0(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function GK(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class HK extends za{constructor(t){super(t),this.removeGroupControls=Yn,this.removeListeners=Yn,this.controls=new jK(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Yn}unmount(){this.removeGroupControls(),this.removeListeners()}}const eR=e=>(t,n)=>{e&&te.postRender(()=>e(t,n))};class KK extends za{constructor(){super(...arguments),this.removePointerDownListener=Yn}onPointerDown(t){this.session=new TM(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:LM(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:eR(t),onStart:eR(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&te.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=so(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const pI=K.createContext(null);function qK(){const e=K.useContext(pI);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:s}=e,r=K.useId();K.useEffect(()=>s(r),[]);const i=K.useCallback(()=>n&&n(r),[r,n]);return!t&&n?[!1,i]:[!0]}const MM=K.createContext({}),zM=K.createContext({}),ex={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function nR(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ld={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(St.test(e))e=parseFloat(e);else return e;const n=nR(e,t.target.x),s=nR(e,t.target.y);return`${n}% ${s}%`}},XK={correct:(e,{treeScale:t,projectionDelta:n})=>{const s=e,r=ya.parse(e);if(r.length>5)return s;const i=ya.createTransformer(e),o=typeof r[0]!="number"?1:0,a=n.x.scale*t.x,l=n.y.scale*t.y;r[0+o]/=a,r[1+o]/=l;const c=$e(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),i(r)}},ty={};function YK(e){Object.assign(ty,e)}const{schedule:mI,cancel:BDt}=BL(queueMicrotask,!1);class ZK extends K.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=t;YK(QK),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),ex.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,o=s.projection;return o&&(o.isPresent=i,r||t.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||te.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),mI.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=t;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function BM(e){const[t,n]=qK(),s=K.useContext(MM);return j.jsx(ZK,{...e,layoutGroup:s,switchLayoutGroup:K.useContext(zM),isPresent:t,safeToRemove:n})}const QK={borderRadius:{...Ld,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ld,borderTopRightRadius:Ld,borderBottomLeftRadius:Ld,borderBottomRightRadius:Ld,boxShadow:XK},VM=["TopLeft","TopRight","BottomLeft","BottomRight"],JK=VM.length,sR=e=>typeof e=="string"?parseFloat(e):e,rR=e=>typeof e=="number"||St.test(e);function tq(e,t,n,s,r,i){r?(e.opacity=$e(0,n.opacity!==void 0?n.opacity:1,eq(s)),e.opacityExit=$e(t.opacity!==void 0?t.opacity:1,0,nq(s))):i&&(e.opacity=$e(t.opacity!==void 0?t.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<JK;o++){const a=`border${VM[o]}Radius`;let l=iR(t,a),c=iR(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||rR(l)===rR(c)?(e[a]=Math.max($e(sR(l),sR(c),s),0),(gi.test(c)||gi.test(l))&&(e[a]+="%")):e[a]=c}(t.rotate||n.rotate)&&(e.rotate=$e(t.rotate||0,n.rotate||0,s))}function iR(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const eq=WM(0,.5,dM),nq=WM(.5,.95,Yn);function WM(e,t,n){return s=>s<e?0:s>t?1:n(lp(e,t,s))}function oR(e,t){e.min=t.min,e.max=t.max}function lr(e,t){oR(e.x,t.x),oR(e.y,t.y)}function aR(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function lR(e,t,n,s,r){return e-=t,e=Jx(e,1/n,s),r!==void 0&&(e=Jx(e,1/r,s)),e}function sq(e,t=0,n=1,s=.5,r,i=e,o=e){if(gi.test(t)&&(t=parseFloat(t),t=$e(o.min,o.max,t/100)-o.min),typeof t!="number")return;let a=$e(i.min,i.max,s);e===i&&(a-=t),e.min=lR(e.min,t,n,a,r),e.max=lR(e.max,t,n,a,r)}function cR(e,t,[n,s,r],i,o){sq(e,t[n],t[s],t[r],t.scale,i,o)}const rq=["x","scaleX","originX"],iq=["y","scaleY","originY"];function uR(e,t,n,s){cR(e.x,t,rq,n?n.x:void 0,s?s.x:void 0),cR(e.y,t,iq,n?n.y:void 0,s?s.y:void 0)}function hR(e){return e.translate===0&&e.scale===1}function UM(e){return hR(e.x)&&hR(e.y)}function dR(e,t){return e.min===t.min&&e.max===t.max}function oq(e,t){return dR(e.x,t.x)&&dR(e.y,t.y)}function fR(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function jM(e,t){return fR(e.x,t.x)&&fR(e.y,t.y)}function pR(e){return nr(e.x)/nr(e.y)}function mR(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class aq{constructor(){this.members=[]}add(t){R1(this.members,t),t.scheduleRender()}remove(t){if(D1(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(r=>t===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(t,n){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,n&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:s}=t;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function lq(e,t,n){let s="";const r=e.x.translate/t.x,i=e.y.translate/t.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:d,skewX:f,skewY:p}=n;c&&(s=`perspective(${c}px) ${s}`),u&&(s+=`rotate(${u}deg) `),h&&(s+=`rotateX(${h}deg) `),d&&(s+=`rotateY(${d}deg) `),f&&(s+=`skewX(${f}deg) `),p&&(s+=`skewY(${p}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const cq=(e,t)=>e.depth-t.depth;class uq{constructor(){this.children=[],this.isDirty=!1}add(t){R1(this.children,t),this.isDirty=!0}remove(t){D1(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(cq),this.isDirty=!1,this.children.forEach(t)}}function nx(e){const t=qn(e)?e.get():e;return nK(t)?t.toValue():t}function hq(e,t){const n=eo.now(),s=({timestamp:r})=>{const i=r-n;i>=t&&(uo(s),e(i-t))};return te.read(s,!0),()=>uo(s)}function dq(e){return e instanceof SVGElement&&e.tagName!=="svg"}function fq(e,t,n){const s=qn(e)?e:cp(e);return s.start(dI("",s,t,n)),s.animation}const cl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Jd=typeof window<"u"&&window.MotionDebug!==void 0,Qw=["","X","Y","Z"],pq={visibility:"hidden"},gR=1e3;let mq=0;function Jw(e,t,n,s){const{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),s&&(s[e]=0))}function GM(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=SM(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",te,!(r||i))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&GM(s)}function HM({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=t==null?void 0:t()){this.id=mq++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Jd&&(cl.totalNodes=cl.resolvedTargetDeltas=cl.recalculatedProjection=0),this.nodes.forEach(yq),this.nodes.forEach(kq),this.nodes.forEach(Cq),this.nodes.forEach(bq),Jd&&window.MotionDebug.record(cl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new uq)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new fI),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=dq(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),e){let h;const d=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=hq(d,250),ex.hasAnimatedSinceResize&&(ex.hasAnimatedSinceResize=!1,this.nodes.forEach(yR))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||$q,{onLayoutAnimationStart:m,onLayoutAnimationComplete:x}=u.getProps(),y=!this.targetLayout||!jM(this.targetLayout,p)||f,b=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,b);const v={...tI(g,"layout"),onPlay:m,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(v.delay=0,v.type=!1),this.startAnimation(v)}else d||yR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,uo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Iq),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&GM(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(xR);return}this.isUpdating||this.nodes.forEach(wq),this.isUpdating=!1,this.nodes.forEach(Sq),this.nodes.forEach(gq),this.nodes.forEach(xq),this.clearAllSnapshots();const a=eo.now();On.delta=xa(0,1e3/60,a-On.timestamp),On.timestamp=a,On.isProcessing=!0,jw.update.process(On),jw.preRender.process(On),jw.render.process(On),On.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,mI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(vq),this.sharedNodes.forEach(Tq)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,te.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){te.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ue(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!UM(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||ll(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Eq(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return Ue();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(Aq))){const{scroll:u}=this.root;u&&(du(l.x,u.offset.x),du(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=Ue();if(lr(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:d}=u;u!==this.root&&h&&d.layoutScroll&&(h.wasRoot&&lr(l,o),du(l.x,h.offset.x),du(l.y,h.offset.y))}return l}applyTransform(o,a=!1){const l=Ue();lr(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&fu(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),ll(u.latestValues)&&fu(l,u.latestValues)}return ll(this.latestValues)&&fu(l,this.latestValues),l}removeTransform(o){const a=Ue();lr(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!ll(c.latestValues))continue;zS(c.latestValues)&&c.updateSnapshot();const u=Ue(),h=c.measurePageBox();lr(u,h),uR(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return ll(this.latestValues)&&uR(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==On.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=On.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ue(),this.relativeTargetOrigin=Ue(),$f(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),lr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ue(),this.targetWithTransforms=Ue()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),RK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):lr(this.target,this.layout.layoutBox),PM(this.target,this.targetDelta)):lr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ue(),this.relativeTargetOrigin=Ue(),$f(this.relativeTargetOrigin,this.target,f.target),lr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Jd&&cl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||zS(this.parent.latestValues)||OM(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===On.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;lr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;VK(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Ue());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(aR(this.prevProjectionDelta.x,this.projectionDelta.x),aR(this.prevProjectionDelta.y,this.projectionDelta.y)),_f(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!mR(this.projectionDelta.x,this.prevProjectionDelta.x)||!mR(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),Jd&&cl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=hu(),this.projectionDelta=hu(),this.projectionDeltaWithTransform=hu()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=hu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=Ue(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,g=f!==p,m=this.getStack(),x=!m||m.members.length<=1,y=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(_q));this.animationProgress=0;let b;this.mixTargetDelta=v=>{const w=v/1e3;bR(h.x,o.x,w),bR(h.y,o.y,w),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&($f(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Nq(this.relativeTarget,this.relativeTargetOrigin,d,w),b&&oq(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=Ue()),lr(b,this.relativeTarget)),g&&(this.animationValues=u,tq(u,c,this.latestValues,w,y,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=w},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(uo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=te.update(()=>{ex.hasAnimatedSinceResize=!0,this.currentAnimation=fq(0,gR,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(gR),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&KM(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Ue();const h=nr(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const d=nr(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}lr(a,l),fu(a,u),_f(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new aq),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&Jw("z",o,c,this.animationValues);for(let u=0;u<Qw.length;u++)Jw(`rotate${Qw[u]}`,o,c,this.animationValues),Jw(`skew${Qw[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return pq;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=nx(o==null?void 0:o.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=nx(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!ll(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=lq(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in ty){if(d[g]===void 0)continue;const{correct:m,applyTo:x}=ty[g],y=c.transform==="none"?d[g]:m(d[g],h);if(x){const b=x.length;for(let v=0;v<b;v++)c[x[v]]=y}else c[g]=y}return this.options.layoutId&&(c.pointerEvents=h===this?nx(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(xR),this.root.sharedNodes.clear()}}}function gq(e){e.updateLayout()}function xq(e){var t;const n=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=e.layout,{animationType:i}=e.options,o=n.source!==e.layout.source;i==="size"?dr(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=nr(d);d.min=s[h].min,d.max=d.min+f}):KM(i,n.layoutBox,s)&&dr(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=nr(s[h]);d.max=d.min+f,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+f)});const a=hu();_f(a,s,n.layoutBox);const l=hu();o?_f(l,e.applyTransform(r,!0),n.measuredBox):_f(l,s,n.layoutBox);const c=!UM(a);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const p=Ue();$f(p,n.layoutBox,d.layoutBox);const g=Ue();$f(g,s,f.layoutBox),jM(p,g)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=p,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function yq(e){Jd&&cl.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function bq(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function vq(e){e.clearSnapshot()}function xR(e){e.clearMeasurements()}function wq(e){e.isLayoutDirty=!1}function Sq(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function yR(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function kq(e){e.resolveTargetDelta()}function Cq(e){e.calcProjection()}function Iq(e){e.resetSkewAndRotation()}function Tq(e){e.removeLeadSnapshot()}function bR(e,t,n){e.translate=$e(t.translate,0,n),e.scale=$e(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function vR(e,t,n,s){e.min=$e(t.min,n.min,s),e.max=$e(t.max,n.max,s)}function Nq(e,t,n,s){vR(e.x,t.x,n.x,s),vR(e.y,t.y,n.y,s)}function _q(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const $q={duration:.45,ease:[.4,0,.1,1]},wR=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),SR=wR("applewebkit/")&&!wR("chrome/")?Math.round:Yn;function kR(e){e.min=SR(e.min),e.max=SR(e.max)}function Eq(e){kR(e.x),kR(e.y)}function KM(e,t,n){return e==="position"||e==="preserve-aspect"&&!AK(pR(t),pR(n),.2)}function Aq(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const Rq=HM({attachResizeListener:(e,t)=>qi(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),t2={current:void 0},qM=HM({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!t2.current){const e=new Rq({});e.mount(window),e.setOptions({layoutScroll:!0}),t2.current=e}return t2.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Dq={pan:{Feature:KK},drag:{Feature:HK,ProjectionNode:qM,MeasureLayout:BM}};function CR(e,t){const n=t?"pointerenter":"pointerleave",s=t?"onHoverStart":"onHoverEnd",r=(i,o)=>{if(i.pointerType==="touch"||EM())return;const a=e.getProps();e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",t);const l=a[s];l&&te.postRender(()=>l(i,o))};return so(e.current,n,r,{passive:!e.getProps()[s]})}class Oq extends za{mount(){this.unmount=no(CR(this.node,!0),CR(this.node,!1))}unmount(){}}class Pq extends za{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=no(qi(this.node.current,"focus",()=>this.onFocus()),qi(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const XM=(e,t)=>t?e===t?!0:XM(e,t.parentElement):!1;function e2(e,t){if(!t)return;const n=new PointerEvent("pointer"+e);t(n,P1(n))}class Fq extends za{constructor(){super(...arguments),this.removeStartListeners=Yn,this.removeEndListeners=Yn,this.removeAccessibleListeners=Yn,this.startPointerPress=(t,n)=>{if(this.isPressing)return;this.removeEndListeners();const s=this.node.getProps(),i=so(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u,globalTapTarget:h}=this.node.getProps(),d=!h&&!XM(this.node.current,a.target)?u:c;d&&te.update(()=>d(a,l))},{passive:!(s.onTap||s.onPointerUp)}),o=so(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(s.onTapCancel||s.onPointerCancel)});this.removeEndListeners=no(i,o),this.startPress(t,n)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||e2("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&te.postRender(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=qi(this.node.current,"keyup",o),e2("down",(a,l)=>{this.startPress(a,l)})},n=qi(this.node.current,"keydown",t),s=()=>{this.isPressing&&e2("cancel",(i,o)=>this.cancelPress(i,o))},r=qi(this.node.current,"blur",s);this.removeAccessibleListeners=no(n,r)}}startPress(t,n){this.isPressing=!0;const{onTapStart:s,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),s&&te.postRender(()=>s(t,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!EM()}cancelPress(t,n){if(!this.checkPressEnd())return;const{onTapCancel:s}=this.node.getProps();s&&te.postRender(()=>s(t,n))}mount(){const t=this.node.getProps(),n=so(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),s=qi(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=no(n,s)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const VS=new WeakMap,n2=new WeakMap,Lq=e=>{const t=VS.get(e.target);t&&t(e)},Mq=e=>{e.forEach(Lq)};function zq({root:e,...t}){const n=e||document;n2.has(n)||n2.set(n,{});const s=n2.get(n),r=JSON.stringify(t);return s[r]||(s[r]=new IntersectionObserver(Mq,{root:e,...t})),s[r]}function Bq(e,t,n){const s=zq(t);return VS.set(e,n),s.observe(e),()=>{VS.delete(e),s.unobserve(e)}}const Vq={some:0,all:1};class Wq extends za{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=t,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:Vq[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return Bq(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(Uq(t,n))&&this.startObserver()}unmount(){}}function Uq({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const jq={inView:{Feature:Wq},tap:{Feature:Fq},focus:{Feature:Pq},hover:{Feature:Oq}},Gq={layout:{ProjectionNode:qM,MeasureLayout:BM}},YM=K.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),F1=K.createContext({}),gI=typeof window<"u",Hq=gI?K.useLayoutEffect:K.useEffect,ZM=K.createContext({strict:!1});let IR=!1;function Kq(e,t,n,s,r){var i;const{visualElement:o}=K.useContext(F1),a=K.useContext(ZM),l=K.useContext(pI),c=K.useContext(YM).reducedMotion,u=K.useRef();s=s||a.renderer,!u.current&&s&&(u.current=s(e,{visualState:t,parent:o,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const h=u.current,d=K.useContext(zM);h&&!h.projection&&r&&(h.type==="html"||h.type==="svg")&&Xq(u.current,n,r,d),K.useInsertionEffect(()=>{h&&h.update(n,l)});const f=n[wM],p=K.useRef(!!f&&!window.MotionHandoffIsComplete&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,f)));return Hq(()=>{h&&(h.updateFeatures(),mI.render(h.render),p.current&&h.animationState&&h.animationState.animateChanges())}),K.useEffect(()=>{h&&(!p.current&&h.animationState&&h.animationState.animateChanges(),p.current=!1,IR||(IR=!0,queueMicrotask(qq)))}),h}function qq(){window.MotionHandoffIsComplete=!0}function Xq(e,t,n,s){const{layoutId:r,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:QM(e.parent)),e.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!o||a&&uu(a),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function QM(e){if(e)return e.options.allowProjection!==!1?e.projection:QM(e.parent)}function Yq(e,t,n){return K.useCallback(s=>{s&&e.mount&&e.mount(s),t&&(s?t.mount(s):t.unmount()),n&&(typeof n=="function"?n(s):uu(n)&&(n.current=s))},[t])}function L1(e){return ip(e.animate)||JC.some(t=>op(e[t]))}function JM(e){return!!(L1(e)||e.variants)}function Zq(e,t){if(L1(e)){const{initial:n,animate:s}=e;return{initial:n===!1||op(n)?n:void 0,animate:op(s)?s:void 0}}return e.inherit!==!1?t:{}}function Qq(e){const{initial:t,animate:n}=Zq(e,K.useContext(F1));return K.useMemo(()=>({initial:t,animate:n}),[TR(t),TR(n)])}function TR(e){return Array.isArray(e)?e.join(" "):e}const NR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Lu={};for(const e in NR)Lu[e]={isEnabled:t=>NR[e].some(n=>!!t[n])};function Jq(e){for(const t in e)Lu[t]={...Lu[t],...e[t]}}const tX=Symbol.for("motionComponentSymbol");function eX({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:s,Component:r}){e&&Jq(e);function i(a,l){let c;const u={...K.useContext(YM),...a,layoutId:nX(a)},{isStatic:h}=u,d=Qq(a),f=s(a,h);if(!h&&gI){sX();const p=rX(u);c=p.MeasureLayout,d.visualElement=Kq(r,f,u,t,p.ProjectionNode)}return j.jsxs(F1.Provider,{value:d,children:[c&&d.visualElement?j.jsx(c,{visualElement:d.visualElement,...u}):null,n(r,a,Yq(f,d.visualElement,l),f,h,d.visualElement)]})}const o=K.forwardRef(i);return o[tX]=r,o}function nX({layoutId:e}){const t=K.useContext(MM).id;return t&&e!==void 0?t+"-"+e:e}function sX(e,t){K.useContext(ZM).strict}function rX(e){const{drag:t,layout:n}=Lu;if(!t&&!n)return{};const s={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const iX=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function xI(e){return typeof e!="string"||e.includes("-")?!1:!!(iX.indexOf(e)>-1||/[A-Z]/u.test(e))}function t4(e,{style:t,vars:n},s,r){Object.assign(e.style,t,r&&r.getProjectionStyles(s));for(const i in n)e.style.setProperty(i,n[i])}const e4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function n4(e,t,n,s){t4(e,t,void 0,s);for(const r in t.attrs)e.setAttribute(e4.has(r)?r:O1(r),t.attrs[r])}function s4(e,{layout:t,layoutId:n}){return Ma.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!ty[e]||e==="opacity")}function yI(e,t,n){var s;const{style:r}=e,i={};for(const o in r)(qn(r[o])||t.style&&qn(t.style[o])||s4(o,e)||((s=n==null?void 0:n.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(i[o]=r[o]);return n&&r&&typeof r.willChange=="string"&&(n.applyWillChange=!1),i}function r4(e,t,n){const s=yI(e,t,n);for(const r in e)if(qn(e[r])||qn(t[r])){const i=Kp.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=e[r]}return s}function oX(e){const t=K.useRef(null);return t.current===null&&(t.current=e()),t.current}function aX({applyWillChange:e=!1,scrapeMotionValuesFromProps:t,createRenderState:n,onMount:s},r,i,o,a){const l={latestValues:cX(r,i,o,a?!1:e,t),renderState:n()};return s&&(l.mount=c=>s(r,c,l)),l}const i4=e=>(t,n)=>{const s=K.useContext(F1),r=K.useContext(pI),i=()=>aX(e,t,s,r,n);return n?i():oX(i)};function lX(e,t){const n=kM(t);n&&R1(e,n)}function _R(e,t,n){const s=Array.isArray(t)?t:[t];for(let r=0;r<s.length;r++){const i=ZC(e,s[r]);if(i){const{transitionEnd:o,transition:a,...l}=i;n(l,o)}}}function cX(e,t,n,s,r){var i;const o={},a=[],l=s&&((i=e.style)===null||i===void 0?void 0:i.willChange)===void 0,c=r(e,{});for(const m in c)o[m]=nx(c[m]);let{initial:u,animate:h}=e;const d=L1(e),f=JM(e);t&&f&&!d&&e.inherit!==!1&&(u===void 0&&(u=t.initial),h===void 0&&(h=t.animate));let p=n?n.initial===!1:!1;p=p||u===!1;const g=p?h:u;return g&&typeof g!="boolean"&&!ip(g)&&_R(e,g,(m,x)=>{for(const y in m){let b=m[y];if(Array.isArray(b)){const v=p?b.length-1:0;b=b[v]}b!==null&&(o[y]=b)}for(const y in x)o[y]=x[y]}),l&&(h&&u!==!1&&!ip(h)&&_R(e,h,m=>{for(const x in m)lX(a,x)}),a.length&&(o.willChange=a.join(","))),o}const bI=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),o4=()=>({...bI(),attrs:{}}),a4=(e,t)=>t&&typeof e=="number"?t.transform(e):e,uX={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hX=Kp.length;function dX(e,t,n){let s="",r=!0;for(let i=0;i<hX;i++){const o=Kp[i],a=e[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=a4(a,iI[o]);if(!l){r=!1;const u=uX[o]||o;s+=`${u}(${c}) `}n&&(t[o]=c)}}return s=s.trim(),n?s=n(t,r?"":s):r&&(s="none"),s}function vI(e,t,n){const{style:s,vars:r,transformOrigin:i}=e;let o=!1,a=!1;for(const l in t){const c=t[l];if(Ma.has(l)){o=!0;continue}else if(jL(l)){r[l]=c;continue}else{const u=a4(c,iI[l]);l.startsWith("origin")?(a=!0,i[l]=u):s[l]=u}}if(t.transform||(o||n?s.transform=dX(t,e.transform,n):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;s.transformOrigin=`${l} ${c} ${u}`}}function $R(e,t,n){return typeof e=="string"?e:St.transform(t+n*e)}function fX(e,t,n){const s=$R(t,e.x,e.width),r=$R(n,e.y,e.height);return`${s} ${r}`}const pX={offset:"stroke-dashoffset",array:"stroke-dasharray"},mX={offset:"strokeDashoffset",array:"strokeDasharray"};function gX(e,t,n=1,s=0,r=!0){e.pathLength=1;const i=r?pX:mX;e[i.offset]=St.transform(-s);const o=St.transform(t),a=St.transform(n);e[i.array]=`${o} ${a}`}function wI(e,{attrX:t,attrY:n,attrScale:s,originX:r,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h){if(vI(e,c,h),u){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:f,dimensions:p}=e;d.transform&&(p&&(f.transform=d.transform),delete d.transform),p&&(r!==void 0||i!==void 0||f.transform)&&(f.transformOrigin=fX(p,r!==void 0?r:.5,i!==void 0?i:.5)),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),s!==void 0&&(d.scale=s),o!==void 0&&gX(d,o,a,l,!1)}const SI=e=>typeof e=="string"&&e.toLowerCase()==="svg",xX={useVisualState:i4({scrapeMotionValuesFromProps:r4,createRenderState:o4,onMount:(e,t,{renderState:n,latestValues:s})=>{te.read(()=>{try{n.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),te.render(()=>{wI(n,s,SI(t.tagName),e.transformTemplate),n4(t,n)})}})},yX={useVisualState:i4({applyWillChange:!0,scrapeMotionValuesFromProps:yI,createRenderState:bI})};function l4(e,t,n){for(const s in t)!qn(t[s])&&!s4(s,n)&&(e[s]=t[s])}function bX({transformTemplate:e},t){return K.useMemo(()=>{const n=bI();return vI(n,t,e),Object.assign({},n.vars,n.style)},[t])}function vX(e,t){const n=e.style||{},s={};return l4(s,n,e),Object.assign(s,bX(e,t)),s}function wX(e,t){const n={},s=vX(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n}const SX=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ey(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||SX.has(e)}let c4=e=>!ey(e);function kX(e){e&&(c4=t=>t.startsWith("on")?!ey(t):e(t))}try{kX(require("@emotion/is-prop-valid").default)}catch{}function CX(e,t,n){const s={};for(const r in e)r==="values"&&typeof e.values=="object"||(c4(r)||n===!0&&ey(r)||!t&&!ey(r)||e.draggable&&r.startsWith("onDrag"))&&(s[r]=e[r]);return s}function IX(e,t,n,s){const r=K.useMemo(()=>{const i=o4();return wI(i,t,SI(s),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};l4(i,e.style,e),r.style={...i,...r.style}}return r}function TX(e=!1){return(n,s,r,{latestValues:i},o)=>{const l=(xI(n)?IX:wX)(s,i,o,n),c=CX(s,typeof n=="string",e),u=n!==K.Fragment?{...c,...l,ref:r}:{},{children:h}=s,d=K.useMemo(()=>qn(h)?h.get():h,[h]);return K.createElement(n,{...u,children:d})}}function NX(e,t){return function(s,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...xI(s)?xX:yX,preloadedFeatures:e,useRender:TX(r),createVisualElement:t,Component:s};return eX(o)}}const WS={current:null},u4={current:!1};function _X(){if(u4.current=!0,!!gI)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>WS.current=e.matches;e.addListener(t),t()}else WS.current=!1}function $X(e,t,n){for(const s in t){const r=t[s],i=n[s];if(qn(r))e.addValue(s,r);else if(qn(i))e.addValue(s,cp(r,{owner:e}));else if(i!==r)if(e.hasValue(s)){const o=e.getValue(s);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=e.getStaticValue(s);e.addValue(s,cp(o!==void 0?o:r,{owner:e}))}}for(const s in n)t[s]===void 0&&e.removeValue(s);return t}const ER=new WeakMap,EX=[...KL,Wn,ya],AX=e=>EX.find(HL(e)),AR=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],RX=JC.length;class DX{scrapeMotionValuesFromProps(t,n,s){return{}}constructor({parent:t,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},a={}){this.applyWillChange=!1,this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=sI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.isRenderScheduled=!1,this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.isRenderScheduled=!1,this.scheduleRender=()=>{this.isRenderScheduled||(this.isRenderScheduled=!0,te.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=L1(n),this.isVariantNode=JM(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const d in h){const f=h[d];l[d]!==void 0&&qn(f)&&f.set(l[d],!1)}}mount(t){this.current=t,ER.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),u4.current||_X(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:WS.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){ER.delete(this.current),this.projection&&this.projection.unmount(),uo(this.notifyUpdate),uo(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Ma.has(t),r=n.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&te.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{r(),i(),o&&o(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Lu){const n=Lu[t];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[t]&&r&&s(this.props)&&(this.features[t]=new r(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ue()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<AR.length;s++){const r=AR[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=t[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=$X(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const s=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(s.initial=this.props.initial),s}const n={};for(let s=0;s<RX;s++){const r=JC[s],i=this.props[r];(op(i)||i===!1)&&(n[r]=i)}return n}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const s=this.values.get(t);n!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&n!==void 0&&(s=cp(n===null?void 0:n,{owner:this}),this.addValue(t,s)),s}readValue(t,n){var s;let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(s=this.getBaseTargetFromProps(this.props,t))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(WL(r)||VL(r))?r=parseFloat(r):!AX(r)&&ya.test(n)&&(r=eM(t,n)),this.setBaseTarget(t,qn(r)?r.get():r)),qn(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const o=ZC(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(r=o[t])}if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!qn(i)?i:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new fI),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class h4 extends DX{constructor(){super(...arguments),this.KeyframeResolver=nM}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:s}){delete n[t],delete s[t]}}function OX(e){return window.getComputedStyle(e)}class PX extends h4{constructor(){super(...arguments),this.type="html",this.applyWillChange=!0,this.renderInstance=t4}readValueFromInstance(t,n){if(Ma.has(n)){const s=oI(n);return s&&s.default||0}else{const s=OX(t),r=(jL(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:n}){return FM(t,n)}build(t,n,s){vI(t,n,s.transformTemplate)}scrapeMotionValuesFromProps(t,n,s){return yI(t,n,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;qn(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}class FX extends h4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ue}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Ma.has(n)){const s=oI(n);return s&&s.default||0}return n=e4.has(n)?n:O1(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,s){return r4(t,n,s)}build(t,n,s){wI(t,n,this.isSVGTag,s.transformTemplate)}renderInstance(t,n,s,r){n4(t,n,s,r)}mount(t){this.isSVGTag=SI(t.tagName),super.mount(t)}}const LX=(e,t)=>xI(e)?new FX(t):new PX(t,{allowProjection:e!==K.Fragment}),MX=NX({...SK,...jq,...Dq,...Gq},LX),zX=x7(MX);(function(e,t){for(var n=ba,s=e();;)try{var r=-parseInt(n(356))/1+parseInt(n(329))/2*(parseInt(n(342))/3)+parseInt(n(334))/4+-parseInt(n(339))/5+parseInt(n(346))/6*(parseInt(n(343))/7)+parseInt(n(340))/8*(-parseInt(n(352))/9)+-parseInt(n(333))/10*(parseInt(n(328))/11);if(r===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(ny,361777);var BX=function(){var e=!0;return function(t,n){var s=e?function(){var r=ba;if(n){var i=n[r(354)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){BX(this,function(){var e=ba,t=new RegExp(e(335)),n=new RegExp(e(337),"i"),s=RR("init");!t[e(331)](s+e(355))||!n[e(331)](s+"input")?s("0"):RR()})()})();function ba(e,t){var n=ny();return ba=function(s,r){s=s-326;var i=n[s];return i},ba(e,t)}function VX(){var e=ba;return K.useEffect(()=>{var t=ba;document[t(341)][t(351)][t(353)](t(338),t(332))},[]),j.jsxs("div",{className:e(348),children:[j.jsx(zX.h1,{className:"text-4xl font-bold mb-4",animate:{scale:[1,1.05,1]},transition:{duration:2,repeat:1/0},children:e(347)}),j.jsx("p",{className:e(349),children:e(345)})]})}function ny(){var e=["246715awFUDF","8nXLRpO","documentElement","15xwRznG","7eFqQXy","debu","I'm a machine learning engineer passionate about leveraging technology for a better future. I also enjoy music, especially classical piano, in my spare time.","1391238aLOrZm","About Me","mt-20 p-6 text-center text-white","text-lg","counter","style","2328579TcHjJB","setProperty","apply","chain","180960WxGelj","action","string","gger","constructor","14630MzLUAo","257270RBdYjh","call","test","#1a202c","3110HHKzTd","1557572CTmWzs","function *\\( *\\)","stateObject","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","--primary-color"];return ny=function(){return e},ny()}function RR(e){function t(n){var s=ba;if(typeof n===s(358))return(function(r){}).constructor("while (true) {}")[s(354)](s(350));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(327)](s(344)+"gger")[s(330)](s(357)):(function(){return!1})[s(327)](s(344)+s(326))[s(354)](s(336)),t(++n)}try{if(e)return t;t(0)}catch{}}const WX="/assets/noblis_logo_dark_mode-u6tRUWOk.png",UX="/assets/BU_logo-BbOsLxua.png",jX="/assets/state_dept_logo-CbhS8uLj.png",De=jl;function jl(e,t){const n=sy();return jl=function(s,r){return s=s-287,n[s]},jl(e,t)}(function(e,t){const n=jl,s=e();for(;;)try{if(parseInt(n(335))/1*(parseInt(n(287))/2)+-parseInt(n(342))/3*(-parseInt(n(317))/4)+-parseInt(n(334))/5+parseInt(n(327))/6*(-parseInt(n(305))/7)+-parseInt(n(298))/8*(parseInt(n(311))/9)+parseInt(n(301))/10*(-parseInt(n(331))/11)+parseInt(n(314))/12*(parseInt(n(292))/13)===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(sy,636772);const GX=function(){let e=!0;return function(t,n){const s=e?function(){const r=jl;if(n){const i=n[r(313)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){GX(this,function(){const e=jl,t=new RegExp("function *\\( *\\)"),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=DR(e(336));!t[e(295)](s+"chain")||!n.test(s+"input")?s("0"):DR()})()})();const HX=[{company:De(329),logo:WX,roles:[{title:De(293),duration:"June 2024 - Present",description:[De(312),De(339),De(326)]},{title:De(290),duration:De(325),description:[De(346),"Designed and implemented improved vision transformer architectures in PyTorch for meteorological predictions",De(318)]},{title:De(289),duration:De(299),description:["Optimized Python object detection pipeline for orchestrated networks of autonomous vehicles, reduced bandwidth usage by 87%"]}]},{company:De(347),logo:UX,roles:[{title:De(307),duration:De(316),description:[De(308),De(294),"Managed graders"]},{title:De(333),duration:De(316),description:[De(304)]}]},{company:De(297),logo:jX,roles:[{title:"Information Services Center, U.S. Embassy of Ottawa",duration:De(324),description:["Automated data reorganization processes with Python and VBA, reducing processing times from months to days"]}]}];function KX(){const e=De;return j.jsxs(e(337),{className:e(309),children:[j.jsx("h1",{className:e(291),children:e(332)}),j.jsx(e(337),{className:"space-y-8",children:HX[e(303)]((t,n)=>j.jsxs(e(337),{className:e(302),children:[j.jsxs(e(337),{className:e(319),children:[t.logo&&j.jsx("img",{src:t.logo,alt:t.company+e(338),className:e(296)}),j.jsx("h2",{className:e(345),children:t[e(323)]})]}),j.jsx(e(337),{className:e(341),children:t[e(315)].map((s,r)=>j.jsxs(e(337),{children:[j.jsx("h3",{className:e(328),children:s[e(310)]}),j.jsx("p",{className:e(344),children:s[e(321)]}),j.jsx("ul",{className:e(300),children:s.description[e(303)]((i,o)=>j.jsx("li",{children:i},o))})]},r))})]},n))})]})}function DR(e){function t(n){const s=jl;if(typeof n=="string")return(function(r){})[s(306)](s(320))[s(313)](s(343));(""+n/n)[s(288)]!==1||n%20===0?(function(){return!0})[s(306)](s(348)+s(322))[s(330)](s(340)):(function(){return!1})[s(306)]("debu"+s(322))[s(313)]("stateObject"),t(++n)}try{if(e)return t;t(0)}catch{}}function sy(){const e=["Principal Investigator","text-4xl font-bold mb-6 text-center","9698286ywNoql","Machine Learning Engineer","Developed unit tests for assignments","test","w-12 h-12 mr-4 object-contain","State Department","8YzgByB","June 2022 - September 2022","mt-2 list-disc list-inside","10HhkyTB","bg-gray-800 p-6 rounded-lg","map","Designed NLP model leveraging BERT for social media content moderation and analytics","8213275cpZino","constructor","TA for ENG EC500, Software at Scale","Led tutorials and lectures in C++ and JavaScript","mt-20 p-6 text-white","title","6141231kvRkjm","Led project implementing ViT for climate predictions leading to NOAA contract","apply","36RQilti","roles","September 2022 - December 2022","1753660RRaICV","Authored CVPR 2024 submission advancing multimodal object detection for computer vision","flex items-center mb-4","while (true) {}","duration","gger","company","June 2019 - August 2020","September 2022 - Present","Technical director for our LLM lab, managing new employees and upskilling developers to leverage LLMs in workflows across NRO, NASA, IRS, and other clients, resulting in increased automation","6rewKNw","text-2xl font-semibold","Noblis","call","5999653RNLXcJ","Work Experience","Spark! Innovation Fellow","3968920pHUlYf","109NwOkvl","init","div"," Logo","Developed full-stack LLM chatbot, fine-tuned LLaMA 3.1, and deployed in production on client hardware","action","space-y-6","3TOMell","counter","text-sm text-gray-400","text-3xl font-bold","Led research leveraging ML for malware attribution, presented results to C-suite and external clients","Boston University","debu","21196Xzonik","length","Machine Learning Research Intern"];return sy=function(){return e},sy()}const qX="/assets/rps_splash-DWuzWn6E.webp",XX="/assets/langcraft_splash-CCEZf5wB.png",Pi=Gl;(function(e,t){const n=Gl,s=e();for(;;)try{if(-parseInt(n(282))/1*(-parseInt(n(321))/2)+-parseInt(n(285))/3+parseInt(n(314))/4+parseInt(n(281))/5*(-parseInt(n(293))/6)+parseInt(n(315))/7*(parseInt(n(305))/8)+-parseInt(n(296))/9+-parseInt(n(306))/10===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(ry,446859);const YX=function(){let e=!0;return function(t,n){const s=e?function(){const r=Gl;if(n){const i=n[r(295)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();function ry(){const e=["call","init","https://rockpaperinfinity.com/","img","image","3283828IffxRd","7oSGAFF","gger","debu","while (true) {}","div","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","15394iczfNg","Achieved 2nd best accuracy in this machine learning competition using fine-tuned GPT-3 with RAG on web-scraped news.","https://github.com/user04f8/TradeBot","text-4xl font-bold mb-6 text-center","mt-2","text-2xl font-semibold mt-4","constructor","645XsmYty","35RYwpLi","action","input","609888KKwcld","counter","w-full h-48 object-cover rounded","test","TradeBot","map","Rock Paper Infinity","stateObject","1182vVbUGo","https://github.com/user04f8/autocast","apply","7951239FMjvwk","chain","MineCompile","A trading bot that was the winning submission for Iddo Drori's deep learning stock market competition.","function *\\( *\\)","title","_blank","Projects","description","4673992lsFxzf","1155620iDrxXf","link","noopener noreferrer"];return ry=function(){return e},ry()}(function(){YX(this,function(){const e=Gl,t=new RegExp(e(300)),n=new RegExp(e(320),"i"),s=OR(e(310));!t[e(288)](s+e(297))||!n[e(288)](s+e(284))?s("0"):OR()})()})();function Gl(e,t){const n=ry();return Gl=function(s,r){return s=s-276,n[s]},Gl(e,t)}const ZX=[{title:Pi(291),description:"Developed and deployed AI-powered game available at rockpaperinfinity.com in React powered by LLM backend.",image:qX,link:Pi(311)},{title:Pi(298),description:"A framework built in Python for auto-generating Minecraft datapack components; includes mal (MetaAutoLang), a language with parser and interpreter for code generation.",image:XX,link:"https://github.com/user04f8/MineCompile"},{title:"NeurIPS Autocast",description:Pi(322),image:"",link:Pi(294)},{title:Pi(289),description:Pi(299),image:"",link:Pi(276)}];function QX(){const e=Pi;return j.jsxs(e(319),{className:"mt-20 p-6 text-white",children:[j.jsx("h1",{className:e(277),children:e(303)}),j.jsx(e(319),{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:ZX[e(290)]((t,n)=>j.jsxs(e(319),{className:"bg-gray-800 p-6 rounded-lg",children:[t.image&&j.jsx(e(312),{src:t[e(313)],alt:t.title,className:e(287)}),j.jsx("h2",{className:e(279),children:t[e(301)]}),j.jsx("p",{className:e(278),children:t[e(304)]}),j.jsx("a",{href:t[e(307)],target:e(302),rel:e(308),className:"text-blue-500 underline mt-2 block",children:"Visit Project"})]},n))})]})}function OR(e){function t(n){const s=Gl;if(typeof n=="string")return(function(r){})[s(280)](s(318)).apply(s(286));(""+n/n).length!==1||n%20===0?(function(){return!0}).constructor(s(317)+s(316))[s(309)](s(283)):(function(){return!1}).constructor("debu"+s(316))[s(295)](s(292)),t(++n)}try{if(e)return t;t(0)}catch{}}var d4={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},PR=Mt.createContext&&Mt.createContext(d4),JX=["attr","size","title"];function tY(e,t){if(e==null)return{};var n=eY(e,t),s,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)s=i[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function eY(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function iy(){return iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},iy.apply(this,arguments)}function FR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function oy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FR(Object(n),!0).forEach(function(s){nY(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FR(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function nY(e,t,n){return t=sY(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sY(e){var t=rY(e,"string");return typeof t=="symbol"?t:t+""}function rY(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f4(e){return e&&e.map((t,n)=>Mt.createElement(t.tag,oy({key:n},t.attr),f4(t.child)))}function $i(e){return t=>Mt.createElement(iY,iy({attr:oy({},e.attr)},t),f4(e.child))}function iY(e){var t=n=>{var{attr:s,size:r,title:i}=e,o=tY(e,JX),a=r||n.size||"1em",l;return n.className&&(l=n.className),e.className&&(l=(l?l+" ":"")+e.className),Mt.createElement("svg",iy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,o,{className:l,style:oy(oy({color:e.color||n.color},n.style),e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),i&&Mt.createElement("title",null,i),e.children)};return PR!==void 0?Mt.createElement(PR.Consumer,null,n=>t(n)):t(d4)}function oY(e){return $i({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(e)}function aY(e){return $i({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"},child:[]}]})(e)}function lY(e){return $i({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function cY(e){return $i({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 76v360c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12V284.1L276.5 440.6c-20.6 17.2-52.5 2.8-52.5-24.6V284.1L52.5 440.6C31.9 457.8 0 443.4 0 416V96c0-27.4 31.9-41.7 52.5-24.6L224 226.8V96c0-27.4 31.9-41.7 52.5-24.6L448 226.8V76c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12z"},child:[]}]})(e)}function uY(e){return $i({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"},child:[]}]})(e)}function hY(e){return $i({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"},child:[]}]})(e)}function dY(e){return $i({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M500.33 0h-47.41a12 12 0 0 0-12 12.57l4 82.76A247.42 247.42 0 0 0 256 8C119.34 8 7.9 119.53 8 256.19 8.1 393.07 119.1 504 256 504a247.1 247.1 0 0 0 166.18-63.91 12 12 0 0 0 .48-17.43l-34-34a12 12 0 0 0-16.38-.55A176 176 0 1 1 402.1 157.8l-101.53-4.87a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12h200.33a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12z"},child:[]}]})(e)}function fY(e){return $i({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function pY(e){return $i({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"},child:[]}]})(e)}function mY(e){return $i({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"},child:[]}]})(e)}function Hl(e,t){var n=ay();return Hl=function(s,r){s=s-343;var i=n[s];return i},Hl(e,t)}(function(e,t){for(var n=Hl,s=e();;)try{var r=-parseInt(n(359))/1+-parseInt(n(353))/2+parseInt(n(374))/3+-parseInt(n(372))/4+-parseInt(n(378))/5*(parseInt(n(368))/6)+parseInt(n(371))/7+parseInt(n(360))/8*(parseInt(n(377))/9);if(r===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(ay,634310);var gY=function(){var e=!0;return function(t,n){var s=e?function(){var r=Hl;if(n){var i=n[r(361)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){gY(this,function(){var e=Hl,t=new RegExp("function *\\( *\\)"),n=new RegExp(e(370),"i"),s=LR("init");!t[e(363)](s+e(366))||!n[e(363)](s+e(347))?s("0"):LR()})()})();function xY(){var e=Hl;return j.jsxs(e(344),{className:e(352),children:[j.jsx("h1",{className:e(348),children:e(367)}),j.jsxs("div",{className:e(355),children:[j.jsxs("a",{href:"mailto:nc9241+fromwebsite@gmail.com",className:e(356),children:[j.jsx(lY,{}),j.jsx(e(349),{children:e(354)})]}),j.jsxs("a",{href:e(343),target:e(345),rel:e(376),className:e(356),children:[j.jsx(oY,{}),j.jsx(e(349),{children:e(351)})]}),j.jsxs("a",{href:e(358),target:e(345),rel:e(376),className:e(356),children:[j.jsx(aY,{}),j.jsx(e(349),{children:e(350)})]})]})]})}function LR(e){function t(n){var s=Hl;if(typeof n=="string")return(function(r){})[s(373)](s(364))[s(361)](s(369));(""+n/n)[s(346)]!==1||n%20===0?(function(){return!0}).constructor(s(357)+s(362))[s(375)](s(365)):(function(){return!1})[s(373)](s(357)+"gger").apply("stateObject"),t(++n)}try{if(e)return t;t(0)}catch{}}function ay(){var e=["test","while (true) {}","action","chain","Contact Me","252tVeDRM","counter","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","4799340cZzbug","3094832GFtnnD","constructor","1435434iGgsDR","call","noopener noreferrer","12181122xQfPXW","91510FUrISK","https://github.com/user04f8","div","_blank","length","input","text-4xl font-bold mb-6","span","LinkedIn","GitHub","mt-20 p-6 text-center text-white","2007408QXrbZC","nc9241@gmail.com","space-y-4","flex items-center justify-center space-x-2 text-lg hover:text-gray-400","debu","https://www.linkedin.com/in/nathan-clark-409719207/","690608BDJXvX","16RTZaWl","apply","gger"];return ay=function(){return e},ay()}const Rn=ho;function ly(){const e=["Farthest First","FarthestFirst","KMeansPlusPlus","apply","2018571vVYoLx","stringify","1608eLVMff","kMeansPlusPlusInitialization","cluster","string","point","debu","filter","6934495MaBSGu","KMeans++","while (true) {}","push","57389kSuKIR","2cocYrj","chain","function *\\( *\\)","centroids","farthestFirstInitialization","stateObject","sqrt","8241804BPriNB","updateCentroids","action","initializationMethod","reduce","353313dTCSOE","assignPointsToClusters","input","35861BRDxiU","map","iterate","floor","initializeCentroids","590nznQRX","slice","points","parse","min","pow","call","randomInitialization","5988824TPVTyX","distance","random","forEach","constructor","test","counter","Manual","euclideanDistance","Random","gger","length","hasConverged"];return ly=function(){return e},ly()}(function(e,t){const n=ho,s=e();for(;;)try{if(-parseInt(n(365))/1+-parseInt(n(366))/2*(-parseInt(n(352))/3)+parseInt(n(335))/4+parseInt(n(361))/5+-parseInt(n(373))/6+parseInt(n(381))/7*(parseInt(n(354))/8)+-parseInt(n(378))/9*(parseInt(n(386))/10)===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(ly,839499);const yY=function(){let e=!0;return function(t,n){const s=e?function(){const r=ho;if(n){const i=n[r(351)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();function ho(e,t){const n=ly();return ho=function(s,r){return s=s-335,n[s]},ho(e,t)}(function(){yY(this,function(){const e=ho,t=new RegExp(e(368)),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=zR("init");!t.test(s+e(367))||!n[e(340)](s+e(380))?s("0"):zR()})()})();var gr=(e=>{const t=ho;return e[t(344)]=t(344),e[t(349)]=t(348),e[t(350)]="KMeans++",e.Manual=t(342),e})(gr||{});class MR{constructor(t,n,s){const r=ho;this.k=t,this.points=n,this[r(376)]=s,this[r(369)]=[]}[Rn(385)](){const t=Rn;switch(this[t(376)]){case"Random":this.randomInitialization();break;case"Farthest First":this[t(370)]();break;case t(362):this.kMeansPlusPlusInitialization();break;case t(342):break;default:throw new Error("Unknown initialization method")}}[Rn(393)](){const t=Rn,n=[...this[t(388)]].sort(()=>.5-Math.random());this[t(369)]=n[t(387)](0,this.k)[t(382)](s=>({x:s.x,y:s.y}))}farthestFirstInitialization(){const t=Rn,n=[],s=this[t(388)][Math[t(384)](Math[t(337)]()*this[t(388)][t(346)])];for(n.push({x:s.x,y:s.y});n.length<this.k;){const r=this[t(388)][t(382)](o=>{const a=t,l=Math[a(390)](...n.map(c=>this[a(343)](o,c)));return{point:o,distance:l}}),i=r[t(377)]((o,a)=>a.distance>o[t(336)]?a:o);n.push({x:i[t(358)].x,y:i.point.y})}this.centroids=n}[Rn(355)](){const t=Rn,n=[],s=this[t(388)][Math[t(384)](Math.random()*this[t(388)].length)];for(n[t(364)]({x:s.x,y:s.y});n[t(346)]<this.k;){const r=this[t(388)][t(382)](c=>{const u=t;return Math[u(390)](...n.map(d=>Math[u(391)](this[u(343)](c,d),2)))}),i=r[t(377)]((c,u)=>c+u,0),o=r[t(382)](c=>c/i);let a=0;const l=Math[t(337)]();for(let c=0;c<o.length;c++)if(a+=o[c],l<a){const u=this[t(388)][c];n[t(364)]({x:u.x,y:u.y});break}}this[t(369)]=n}[Rn(343)](t,n){return Math[Rn(372)](Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}assignPointsToClusters(){const t=Rn;this.points[t(338)](n=>{const s=t;let r=1/0,i=-1;this.centroids[s(338)]((o,a)=>{const l=this.euclideanDistance(n,o);l<r&&(r=l,i=a)}),n[s(356)]=i})}[Rn(374)](){const t=Rn;this[t(369)]=this[t(369)][t(382)]((n,s)=>{const r=t,i=this[r(388)][r(360)](c=>c[r(356)]===s),o=i[r(346)];if(o===0)return this[r(369)][s];const a=i.reduce((c,u)=>c+u.x,0),l=i.reduce((c,u)=>c+u.y,0);return{x:a/o,y:l/o}})}[Rn(347)](t,n){const s=Rn;for(let r=0;r<t.length;r++)if(this[s(343)](t[r],n[r])>1e-6)return!1;return!0}[Rn(383)](){const t=Rn,n=JSON[t(389)](JSON[t(353)](this[t(369)]));return this[t(379)](),this[t(374)](),this[t(347)](n,this[t(369)])}getCentroids(){return this.centroids}getPoints(){return this[Rn(388)]}}function zR(e){function t(n){const s=ho;if(typeof n===s(357))return(function(r){}).constructor(s(363))[s(351)](s(341));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(339)]("debu"+s(345))[s(392)](s(375)):(function(){return!1})[s(339)](s(359)+s(345)).apply(s(371)),t(++n)}try{if(e)return t;t(0)}catch{}}(function(e,t){const n=Kl,s=e();for(;;)try{if(-parseInt(n(412))/1+-parseInt(n(372))/2*(parseInt(n(394))/3)+parseInt(n(411))/4*(-parseInt(n(377))/5)+-parseInt(n(395))/6*(-parseInt(n(407))/7)+-parseInt(n(419))/8*(-parseInt(n(359))/9)+-parseInt(n(402))/10+parseInt(n(408))/11*(parseInt(n(385))/12)===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(cy,135019);const bY=function(){let e=!0;return function(t,n){const s=e?function(){const r=Kl;if(n){const i=n[r(365)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){bY(this,function(){const e=Kl,t=new RegExp("function *\\( *\\)"),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=BR(e(417));!t[e(398)](s+e(354))||!n[e(398)](s+e(353))?s("0"):BR()})()})();function Kl(e,t){const n=cy();return Kl=function(s,r){return s=s-352,n[s]},Kl(e,t)}function cy(){const e=["input","chain","stateObject","constructor","string","uniform","1137411nGYigQ","initMethod","action","Reset","button","Number of Clusters (k):","apply","div","Manual","map","flex flex-wrap justify-center space-x-4","bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition-colors duration-200 mb-2 flex items-center","Pause","26QzUWpE","gger","option","value","flex items-center space-x-4","180580tkmRun","debu","border rounded px-2 py-1 w-20","gaussian","label","Distribution:","flex items-center space-x-4 mb-4 md:mb-0","values","2976MkwEcW","Initialization Method:","counter","bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors duration-200 mb-2 flex items-center","bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-colors duration-200 mb-2 flex items-center","Step","Converge","New Dataset","Click on the visualization to add centroids. Added Centroids: ","11337aBhfMk","606ijgAMk","border rounded px-2 py-1 w-24","select","test","length","target","font-semibold text-gray-700","1546630neycPM","mr-2","Number of Points:","border rounded px-2 py-1","Gaussian","17682kUNHlA","4246pTORFP","bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 w-full max-w-3xl","flex flex-col md:flex-row md:items-center md:justify-between mb-4","8GqHKKl","192571kXYRSs","call","distribution","while (true) {}","numPoints","init","Play","16uObIRE","number"];return cy=function(){return e},cy()}const vY=({initializationMethod:e,onInitializationMethodChange:t,onNewDataset:n,onStep:s,onConverge:r,onReset:i,onPlay:o,onPause:a,isPlaying:l,k:c,setK:u,manualCentroids:h,numPoints:d,setNumPoints:f,distribution:p,setDistribution:g})=>{const m=Kl;return j.jsx("div",{className:"flex flex-col items-center mb-6",children:j.jsxs(m(366),{className:m(409),children:[j.jsxs(m(366),{className:m(410),children:[j.jsxs(m(366),{className:m(383),children:[j.jsx("label",{htmlFor:m(416),className:m(401),children:m(404)}),j.jsx(m(353),{type:m(352),id:m(416),value:d,onChange:x=>f(Number(x[m(400)][m(375)])),className:m(396),min:10})]}),j.jsxs("div",{className:m(383),children:[j.jsx(m(381),{htmlFor:"distribution",className:"font-semibold text-gray-700",children:m(382)}),j.jsxs(m(397),{id:m(414),value:p,onChange:x=>g(x[m(400)][m(375)]),className:m(405),children:[j.jsx(m(374),{value:m(358),children:"Uniform"}),j.jsx(m(374),{value:m(380),children:m(406)})]})]})]}),j.jsxs(m(366),{className:m(410),children:[j.jsxs(m(366),{className:"flex items-center space-x-4 mb-4 md:mb-0",children:[j.jsx(m(381),{htmlFor:"k",className:m(401),children:m(364)}),j.jsx(m(353),{type:m(352),id:"k",value:e===gr[m(367)]?h.length:c,onChange:x=>u(Number(x[m(400)][m(375)])),className:m(379),min:1,disabled:e===gr[m(367)]})]}),j.jsxs(m(366),{className:m(376),children:[j.jsx(m(381),{htmlFor:"initMethod",className:m(401),children:m(386)}),j.jsx(m(397),{id:m(360),value:e,onChange:x=>t(x.target[m(375)]),className:"border rounded px-2 py-1",children:Object[m(384)](gr)[m(368)](x=>j.jsx(m(374),{value:x,children:x},x))})]})]}),e===gr[m(367)]&&j.jsxs("p",{className:"text-sm text-gray-600",children:[m(393),h[m(399)]]}),j.jsxs("div",{className:m(369),children:[j.jsxs("button",{onClick:n,className:m(388),children:[j.jsx(mY,{className:m(403)}),m(392)]}),j.jsxs(m(363),{onClick:s,className:m(389),children:[j.jsx(pY,{className:m(403)}),m(390)]}),l?j.jsxs("button",{onClick:a,className:m(370),children:[j.jsx(uY,{className:m(403)}),m(371)]}):j.jsxs(m(363),{onClick:o,className:m(370),children:[j.jsx(hY,{className:m(403)}),m(418)]}),j.jsxs("button",{onClick:r,className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors duration-200 mb-2 flex items-center",children:[j.jsx(cY,{className:m(403)}),m(391)]}),j.jsxs(m(363),{onClick:i,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors duration-200 mb-2 flex items-center",children:[j.jsx(dY,{className:"mr-2"}),m(362)]})]})]})})};function BR(e){function t(n){const s=Kl;if(typeof n===s(357))return(function(r){})[s(356)](s(415))[s(365)](s(387));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(356)](s(378)+s(373))[s(413)](s(361)):(function(){return!1})[s(356)](s(378)+s(373)).apply(s(355)),t(++n)}try{if(e)return t;t(0)}catch{}}const rs=ql;(function(e,t){const n=ql,s=e();for(;;)try{if(parseInt(n(409))/1+-parseInt(n(423))/2+parseInt(n(428))/3+parseInt(n(422))/4+parseInt(n(436))/5+parseInt(n(416))/6*(-parseInt(n(440))/7)+-parseInt(n(427))/8*(-parseInt(n(421))/9)===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(uy,178280);function ql(e,t){const n=uy();return ql=function(s,r){return s=s-408,n[s]},ql(e,t)}const wY=function(){let e=!0;return function(t,n){const s=e?function(){const r=ql;if(n){const i=n[r(429)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();function uy(){const e=["8ZZkCVc","580977lrzXnc","apply","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#46f0f0","#f032e6","gger","test","#492073","68685WLMcXU","#911eb4","counter","#746F6C","1791811zFaqAq","input","#008080","#e6194b","195369hwvKCI","function *\\( *\\)","#20436C","debu","#fabebe","#652074","#6F6D20","6ODQTpD","#68616E","chain","call","#f58231","221220RQUbfL","1345980NylEZN","659174oRtJRR","#686973","constructor","#0082c8"];return uy=function(){return e},uy()}(function(){wY(this,function(){const e=ql,t=new RegExp(e(410)),n=new RegExp(e(430),"i"),s=VR("init");!t[e(434)](s+e(418))||!n[e(434)](s+e(441))?s("0"):VR()})()})();const pu=[rs(408),"#3cb44b",rs(426),rs(420),rs(437),rs(431),rs(432),"#d2f53c",rs(413),rs(442),rs(435),rs(439),rs(414),rs(424),"#206672",rs(415),"#4E6174",rs(417),rs(411),"#61726B"];function VR(e){function t(n){const s=ql;if(typeof n=="string")return(function(r){}).constructor("while (true) {}")[s(429)](s(438));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(425)](s(412)+s(433))[s(419)]("action"):(function(){return!1})[s(425)]("debu"+s(433)).apply("stateObject"),t(++n)}try{if(e)return t;t(0)}catch{}}function va(e,t){const n=hy();return va=function(s,r){return s=s-356,n[s]},va(e,t)}(function(e,t){const n=va,s=e();for(;;)try{if(-parseInt(n(367))/1*(-parseInt(n(375))/2)+-parseInt(n(357))/3*(-parseInt(n(383))/4)+parseInt(n(372))/5+-parseInt(n(373))/6*(-parseInt(n(392))/7)+-parseInt(n(370))/8*(-parseInt(n(369))/9)+parseInt(n(363))/10*(parseInt(n(374))/11)+-parseInt(n(379))/12===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(hy,488913);const SY=function(){let e=!0;return function(t,n){const s=e?function(){const r=va;if(n){const i=n[r(362)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){SY(this,function(){const e=va,t=new RegExp("function *\\( *\\)"),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=WR("init");!t[e(393)](s+"chain")||!n.test(s+e(376))?s("0"):WR()})()})();const kY=({points:e,centroids:t,onCentroidAdd:n,initializationMethod:s})=>{const r=va,i=40,o=a=>{const l=va;if(s!==gr[l(371)]||!n)return;const c=a[l(395)],u=c[l(384)](),h=600/u.width,d=600/u[l(381)],f=(a[l(385)]-u.left-i)*h,p=(a[l(390)]-u.top-i)*d;n({x:f/(600-2*i),y:p/(600-2*i)})};return j.jsx(r(391),{className:r(361),children:j.jsxs("svg",{viewBox:"0 0 600 600",className:r(356),onClick:o,children:[j.jsx("rect",{width:"600",height:r(358),fill:r(387)}),e[r(368)]((a,l)=>j.jsx(r(359),{cx:i+a.x*(600-2*i),cy:i+a.y*(600-2*i),r:4,fill:a.cluster!==void 0?pu[a[r(378)]%pu[r(377)]]:r(380)},l)),t.map((a,l)=>j.jsx(r(359),{className:r(394),cx:i+a.x*(600-2*i),cy:i+a.y*(600-2*i),r:10,fill:pu[l%pu.length],stroke:"#000",strokeWidth:2},l))]})})};function WR(e){function t(n){const s=va;if(typeof n===s(364))return(function(r){})[s(388)]("while (true) {}")[s(362)](s(360));(""+n/n)[s(377)]!==1||n%20===0?(function(){return!0})[s(388)](s(386)+s(365))[s(366)](s(389)):(function(){return!1}).constructor(s(386)+"gger")[s(362)](s(382)),t(++n)}try{if(e)return t;t(0)}catch{}}function hy(){const e=["clientY","div","7RtlHwM","test","centroid","currentTarget","border border-gray-400 w-full h-auto max-w-3xl bg-white rounded-lg shadow-md","24IbvQWp","600","circle","counter","flex justify-center items-center w-full","apply","2675850ECLQOJ","string","gger","call","14SMlwIL","map","1422GnChnd","49432HfSnsm","Manual","4454085jaNTko","2128578AvETmQ","33GkycWw","21046yjyxIu","input","length","cluster","35802552HpoctN","#aaaaaa","height","stateObject","150260IRfijd","getBoundingClientRect","clientX","debu","white","constructor","action"];return hy=function(){return e},hy()}(function(e,t){const n=Xl,s=e();for(;;)try{if(-parseInt(n(460))/1*(parseInt(n(479))/2)+-parseInt(n(457))/3*(-parseInt(n(459))/4)+parseInt(n(454))/5*(parseInt(n(456))/6)+-parseInt(n(451))/7+-parseInt(n(470))/8+parseInt(n(463))/9+-parseInt(n(462))/10*(-parseInt(n(461))/11)===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(dy,663039);const CY=function(){let e=!0;return function(t,n){const s=e?function(){const r=Xl;if(n){const i=n[r(472)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();function Xl(e,t){const n=dy();return Xl=function(s,r){return s=s-448,n[s]},Xl(e,t)}(function(){CY(this,function(){const e=Xl,t=new RegExp(e(464)),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=UR(e(450));!t[e(482)](s+e(467))||!n.test(s+e(469))?s("0"):UR()})()})();function dy(){const e=["Cluster ","26178Txlvnp","3CZlTir","from","1375064jcxvzs","5906tGSeGN","8130166MYJdoZ","20HHjnde","1831815GBiOya","function *\\( *\\)","while (true) {}","debu","chain","action","input","5023432XzHnmD","text-gray-200","apply","gger","w-4 h-4 mr-1 rounded","counter","span","map","flex items-center mr-4 mb-2","244FVTyea","call","stateObject","test","length","string","init","2632994lOKHbt","div","constructor","415JlivFr"];return dy=function(){return e},dy()}const IY=({k:e})=>{const t=Xl;return j.jsx(t(452),{className:"flex justify-center mt-4 flex-wrap",children:Array[t(458)]({length:e})[t(477)]((n,s)=>j.jsxs(t(452),{className:t(478),children:[j.jsx("div",{className:t(474),style:{backgroundColor:pu[s%pu[t(448)]],border:"1px solid black"}}),j.jsxs(t(476),{className:t(471),children:[t(455),s+1]})]},s))})};function UR(e){function t(n){const s=Xl;if(typeof n===s(449))return(function(r){}).constructor(s(465))[s(472)](s(475));(""+n/n)[s(448)]!==1||n%20===0?(function(){return!0})[s(453)](s(466)+"gger")[s(480)](s(468)):(function(){return!1})[s(453)](s(466)+s(473))[s(472)](s(481)),t(++n)}try{if(e)return t;t(0)}catch{}}function p4(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=p4(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function Ko(){for(var e,t,n=0,s="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=p4(e))&&(s&&(s+=" "),s+=t);return s}const up=e=>typeof e=="number"&&!isNaN(e),Al=e=>typeof e=="string",qs=e=>typeof e=="function",sx=e=>Al(e)||qs(e)?e:null,US=e=>K.isValidElement(e)||Al(e)||qs(e)||up(e);function TY(e,t,n){n===void 0&&(n=300);const{scrollHeight:s,style:r}=e;requestAnimationFrame(()=>{r.minHeight="initial",r.height=s+"px",r.transition=`all ${n}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,n)})})}function M1(e){let{enter:t,exit:n,appendPosition:s=!1,collapse:r=!0,collapseDuration:i=300}=e;return function(o){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:d,playToast:f}=o;const p=s?`${t}--${l}`:t,g=s?`${n}--${l}`:n,m=K.useRef(0);return K.useLayoutEffect(()=>{const x=h.current,y=p.split(" "),b=v=>{v.target===h.current&&(f(),x.removeEventListener("animationend",b),x.removeEventListener("animationcancel",b),m.current===0&&v.type!=="animationcancel"&&x.classList.remove(...y))};x.classList.add(...y),x.addEventListener("animationend",b),x.addEventListener("animationcancel",b)},[]),K.useEffect(()=>{const x=h.current,y=()=>{x.removeEventListener("animationend",y),r?TY(x,u,i):u()};d||(c?y():(m.current=1,x.className+=` ${g}`,x.addEventListener("animationend",y)))},[d]),Mt.createElement(Mt.Fragment,null,a)}}function jR(e,t){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const as=new Map;let hp=[];const jS=new Set,NY=e=>jS.forEach(t=>t(e)),m4=()=>as.size>0;function g4(e,t){var n;if(t)return!((n=as.get(t))==null||!n.isToastActive(e));let s=!1;return as.forEach(r=>{r.isToastActive(e)&&(s=!0)}),s}function x4(e,t){US(e)&&(m4()||hp.push({content:e,options:t}),as.forEach(n=>{n.buildToast(e,t)}))}function GR(e,t){as.forEach(n=>{t!=null&&t!=null&&t.containerId?(t==null?void 0:t.containerId)===n.id&&n.toggle(e,t==null?void 0:t.id):n.toggle(e,t==null?void 0:t.id)})}function _Y(e){const{subscribe:t,getSnapshot:n,setProps:s}=K.useRef(function(i){const o=i.containerId||1;return{subscribe(a){const l=function(u,h,d){let f=1,p=0,g=[],m=[],x=[],y=h;const b=new Map,v=new Set,w=()=>{x=Array.from(b.values()),v.forEach(C=>C())},k=C=>{m=C==null?[]:m.filter(N=>N!==C),w()},I=C=>{const{toastId:N,onOpen:$,updateId:A,children:R}=C.props,z=A==null;C.staleId&&b.delete(C.staleId),b.set(N,C),m=[...m,C.props.toastId].filter(U=>U!==C.staleId),w(),d(jR(C,z?"added":"updated")),z&&qs($)&&$(K.isValidElement(R)&&R.props)};return{id:u,props:y,observe:C=>(v.add(C),()=>v.delete(C)),toggle:(C,N)=>{b.forEach($=>{N!=null&&N!==$.props.toastId||qs($.toggle)&&$.toggle(C)})},removeToast:k,toasts:b,clearQueue:()=>{p-=g.length,g=[]},buildToast:(C,N)=>{if((Q=>{let{containerId:J,toastId:et,updateId:nt}=Q;const rt=J?J!==u:u!==1,ht=b.has(et)&&nt==null;return rt||ht})(N))return;const{toastId:$,updateId:A,data:R,staleId:z,delay:U}=N,F=()=>{k($)},P=A==null;P&&p++;const L={...y,style:y.toastStyle,key:f++,...Object.fromEntries(Object.entries(N).filter(Q=>{let[J,et]=Q;return et!=null})),toastId:$,updateId:A,data:R,closeToast:F,isIn:!1,className:sx(N.className||y.toastClassName),bodyClassName:sx(N.bodyClassName||y.bodyClassName),progressClassName:sx(N.progressClassName||y.progressClassName),autoClose:!N.isLoading&&(E=N.autoClose,B=y.autoClose,E===!1||up(E)&&E>0?E:B),deleteToast(){const Q=b.get($),{onClose:J,children:et}=Q.props;qs(J)&&J(K.isValidElement(et)&&et.props),d(jR(Q,"removed")),b.delete($),p--,p<0&&(p=0),g.length>0?I(g.shift()):w()}};var E,B;L.closeButton=y.closeButton,N.closeButton===!1||US(N.closeButton)?L.closeButton=N.closeButton:N.closeButton===!0&&(L.closeButton=!US(y.closeButton)||y.closeButton);let q=C;K.isValidElement(C)&&!Al(C.type)?q=K.cloneElement(C,{closeToast:F,toastProps:L,data:R}):qs(C)&&(q=C({closeToast:F,toastProps:L,data:R}));const Y={content:q,props:L,staleId:z};y.limit&&y.limit>0&&p>y.limit&&P?g.push(Y):up(U)?setTimeout(()=>{I(Y)},U):I(Y)},setProps(C){y=C},setToggle:(C,N)=>{b.get(C).toggle=N},isToastActive:C=>m.some(N=>N===C),getSnapshot:()=>y.newestOnTop?x.reverse():x}}(o,i,NY);as.set(o,l);const c=l.observe(a);return hp.forEach(u=>x4(u.content,u.options)),hp=[],()=>{c(),as.delete(o)}},setProps(a){var l;(l=as.get(o))==null||l.setProps(a)},getSnapshot(){var a;return(a=as.get(o))==null?void 0:a.getSnapshot()}}}(e)).current;s(e);const r=K.useSyncExternalStore(t,n,n);return{getToastToRender:function(i){if(!r)return[];const o=new Map;return r.forEach(a=>{const{position:l}=a.props;o.has(l)||o.set(l,[]),o.get(l).push(a)}),Array.from(o,a=>i(a[0],a[1]))},isToastActive:g4,count:r==null?void 0:r.length}}function $Y(e){const[t,n]=K.useState(!1),[s,r]=K.useState(!1),i=K.useRef(null),o=K.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:c,onClick:u,closeOnClick:h}=e;var d,f;function p(){n(!0)}function g(){n(!1)}function m(b){const v=i.current;o.canDrag&&v&&(o.didMove=!0,t&&g(),o.delta=e.draggableDirection==="x"?b.clientX-o.start:b.clientY-o.start,o.start!==b.clientX&&(o.canCloseOnClick=!1),v.style.transform=`translate3d(${e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`},0)`,v.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function x(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",x);const b=i.current;if(o.canDrag&&o.didMove&&b){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return r(!0),e.closeToast(),void e.collapseAll();b.style.transition="transform 0.2s, opacity 0.2s",b.style.removeProperty("transform"),b.style.removeProperty("opacity")}}(f=as.get((d={id:e.toastId,containerId:e.containerId,fn:n}).containerId||1))==null||f.setToggle(d.id,d.fn),K.useEffect(()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||g(),window.addEventListener("focus",p),window.addEventListener("blur",g),()=>{window.removeEventListener("focus",p),window.removeEventListener("blur",g)}},[e.pauseOnFocusLoss]);const y={onPointerDown:function(b){if(e.draggable===!0||e.draggable===b.pointerType){o.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",x);const v=i.current;o.canCloseOnClick=!0,o.canDrag=!0,v.style.transition="none",e.draggableDirection==="x"?(o.start=b.clientX,o.removalDistance=v.offsetWidth*(e.draggablePercent/100)):(o.start=b.clientY,o.removalDistance=v.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(b){const{top:v,bottom:w,left:k,right:I}=i.current.getBoundingClientRect();b.nativeEvent.type!=="touchend"&&e.pauseOnHover&&b.clientX>=k&&b.clientX<=I&&b.clientY>=v&&b.clientY<=w?g():p()}};return a&&l&&(y.onMouseEnter=g,e.stacked||(y.onMouseLeave=p)),h&&(y.onClick=b=>{u&&u(b),o.canCloseOnClick&&c()}),{playToast:p,pauseToast:g,isRunning:t,preventExitTransition:s,toastRef:i,eventHandlers:y}}function EY(e){let{delay:t,isRunning:n,closeToast:s,type:r="default",hide:i,className:o,style:a,controlledProgress:l,progress:c,rtl:u,isIn:h,theme:d}=e;const f=i||l&&c===0,p={...a,animationDuration:`${t}ms`,animationPlayState:n?"running":"paused"};l&&(p.transform=`scaleX(${c})`);const g=Ko("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":u}),m=qs(o)?o({rtl:u,type:r,defaultClassName:g}):Ko(g,o),x={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{h&&s()}};return Mt.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},Mt.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${r}`}),Mt.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:m,style:p,...x}))}let AY=1;const y4=()=>""+AY++;function RY(e){return e&&(Al(e.toastId)||up(e.toastId))?e.toastId:y4()}function Ef(e,t){return x4(e,t),t.toastId}function fy(e,t){return{...t,type:t&&t.type||e,toastId:RY(t)}}function u0(e){return(t,n)=>Ef(t,fy(e,n))}function Lt(e,t){return Ef(e,fy("default",t))}Lt.loading=(e,t)=>Ef(e,fy("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),Lt.promise=function(e,t,n){let s,{pending:r,error:i,success:o}=t;r&&(s=Al(r)?Lt.loading(r,n):Lt.loading(r.render,{...n,...r}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,h,d)=>{if(h==null)return void Lt.dismiss(s);const f={type:u,...a,...n,data:d},p=Al(h)?{render:h}:h;return s?Lt.update(s,{...f,...p}):Lt(p.render,{...f,...p}),d},c=qs(e)?e():e;return c.then(u=>l("success",o,u)).catch(u=>l("error",i,u)),c},Lt.success=u0("success"),Lt.info=u0("info"),Lt.error=u0("error"),Lt.warning=u0("warning"),Lt.warn=Lt.warning,Lt.dark=(e,t)=>Ef(e,fy("default",{theme:"dark",...t})),Lt.dismiss=function(e){(function(t){var n;if(m4()){if(t==null||Al(n=t)||up(n))as.forEach(s=>{s.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){const s=as.get(t.containerId);s?s.removeToast(t.id):as.forEach(r=>{r.removeToast(t.id)})}}else hp=hp.filter(s=>t!=null&&s.options.toastId!==t)})(e)},Lt.clearWaitingQueue=function(e){e===void 0&&(e={}),as.forEach(t=>{!t.props.limit||e.containerId&&t.id!==e.containerId||t.clearQueue()})},Lt.isActive=g4,Lt.update=function(e,t){t===void 0&&(t={});const n=((s,r)=>{var i;let{containerId:o}=r;return(i=as.get(o||1))==null?void 0:i.toasts.get(s)})(e,t);if(n){const{props:s,content:r}=n,i={delay:100,...s,...t,toastId:t.toastId||e,updateId:y4()};i.toastId!==e&&(i.staleId=e);const o=i.render||r;delete i.render,Ef(o,i)}},Lt.done=e=>{Lt.update(e,{progress:1})},Lt.onChange=function(e){return jS.add(e),()=>{jS.delete(e)}},Lt.play=e=>GR(!0,e),Lt.pause=e=>GR(!1,e);const DY=typeof window<"u"?K.useLayoutEffect:K.useEffect,h0=e=>{let{theme:t,type:n,isLoading:s,...r}=e;return Mt.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${n})`,...r})},s2={info:function(e){return Mt.createElement(h0,{...e},Mt.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return Mt.createElement(h0,{...e},Mt.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return Mt.createElement(h0,{...e},Mt.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return Mt.createElement(h0,{...e},Mt.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Mt.createElement("div",{className:"Toastify__spinner"})}},OY=e=>{const{isRunning:t,preventExitTransition:n,toastRef:s,eventHandlers:r,playToast:i}=$Y(e),{closeButton:o,children:a,autoClose:l,onClick:c,type:u,hideProgressBar:h,closeToast:d,transition:f,position:p,className:g,style:m,bodyClassName:x,bodyStyle:y,progressClassName:b,progressStyle:v,updateId:w,role:k,progress:I,rtl:C,toastId:N,deleteToast:$,isIn:A,isLoading:R,closeOnClick:z,theme:U}=e,F=Ko("Toastify__toast",`Toastify__toast-theme--${U}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":C},{"Toastify__toast--close-on-click":z}),P=qs(g)?g({rtl:C,position:p,type:u,defaultClassName:F}):Ko(F,g),L=function(Y){let{theme:Q,type:J,isLoading:et,icon:nt}=Y,rt=null;const ht={theme:Q,type:J};return nt===!1||(qs(nt)?rt=nt({...ht,isLoading:et}):K.isValidElement(nt)?rt=K.cloneElement(nt,ht):et?rt=s2.spinner():(vt=>vt in s2)(J)&&(rt=s2[J](ht))),rt}(e),E=!!I||!l,B={closeToast:d,type:u,theme:U};let q=null;return o===!1||(q=qs(o)?o(B):K.isValidElement(o)?K.cloneElement(o,B):function(Y){let{closeToast:Q,theme:J,ariaLabel:et="close"}=Y;return Mt.createElement("button",{className:`Toastify__close-button Toastify__close-button--${J}`,type:"button",onClick:nt=>{nt.stopPropagation(),Q(nt)},"aria-label":et},Mt.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Mt.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(B)),Mt.createElement(f,{isIn:A,done:$,position:p,preventExitTransition:n,nodeRef:s,playToast:i},Mt.createElement("div",{id:N,onClick:c,"data-in":A,className:P,...r,style:m,ref:s},Mt.createElement("div",{...A&&{role:k},className:qs(x)?x({type:u}):Ko("Toastify__toast-body",x),style:y},L!=null&&Mt.createElement("div",{className:Ko("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!R})},L),Mt.createElement("div",null,a)),q,Mt.createElement(EY,{...w&&!E?{key:`pb-${w}`}:{},rtl:C,theme:U,delay:l,isRunning:t,isIn:A,closeToast:d,hide:h,type:u,style:v,className:b,controlledProgress:E,progress:I||0})))},z1=function(e,t){return t===void 0&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},PY=M1(z1("bounce",!0));M1(z1("slide",!0));M1(z1("zoom"));M1(z1("flip"));const FY={position:"top-right",transition:PY,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function LY(e){let t={...FY,...e};const n=e.stacked,[s,r]=K.useState(!0),i=K.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=_Y(t),{className:c,style:u,rtl:h,containerId:d}=t;function f(g){const m=Ko("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":h});return qs(c)?c({position:g,rtl:h,defaultClassName:m}):Ko(m,sx(c))}function p(){n&&(r(!0),Lt.play())}return DY(()=>{if(n){var g;const m=i.current.querySelectorAll('[data-in="true"]'),x=12,y=(g=t.position)==null?void 0:g.includes("top");let b=0,v=0;Array.from(m).reverse().forEach((w,k)=>{const I=w;I.classList.add("Toastify__toast--stacked"),k>0&&(I.dataset.collapsed=`${s}`),I.dataset.pos||(I.dataset.pos=y?"top":"bot");const C=b*(s?.2:1)+(s?0:x*k);I.style.setProperty("--y",`${y?C:-1*C}px`),I.style.setProperty("--g",`${x}`),I.style.setProperty("--s",""+(1-(s?v:0))),b+=I.offsetHeight,v+=.025})}},[s,l,n]),Mt.createElement("div",{ref:i,className:"Toastify",id:d,onMouseEnter:()=>{n&&(r(!1),Lt.pause())},onMouseLeave:p},o((g,m)=>{const x=m.length?{...u}:{...u,pointerEvents:"none"};return Mt.createElement("div",{className:f(g),style:x,key:`container-${g}`},m.map(y=>{let{content:b,props:v}=y;return Mt.createElement(OY,{...v,stacked:n,collapseAll:p,isIn:a(v.toastId,v.containerId),style:v.style,key:`toast-${v.key}`},b)}))}))}(function(e,t){const n=rn,s=e();for(;;)try{if(-parseInt(n(359))/1+-parseInt(n(386))/2+parseInt(n(393))/3*(-parseInt(n(402))/4)+parseInt(n(403))/5*(-parseInt(n(365))/6)+-parseInt(n(389))/7+parseInt(n(361))/8*(-parseInt(n(357))/9)+parseInt(n(367))/10===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(py,155255);const MY=function(){let e=!0;return function(t,n){const s=e?function(){const r=rn;if(n){const i=n[r(388)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){MY(this,function(){const e=rn,t=new RegExp(e(405)),n=new RegExp(e(363),"i"),s=KR(e(384));!t[e(391)](s+e(368))||!n[e(391)](s+e(381))?s("0"):KR()})()})();function rn(e,t){const n=py();return rn=function(s,r){return s=s-354,n[s]},rn(e,t)}const zY=()=>{const e=rn,[t,n]=K.useState([]),[s,r]=K.useState(null),[i,o]=K.useState(gr.Random),[a,l]=K.useState(3),[c,u]=K.useState([]),[h,d]=K.useState([]),[f,p]=K.useState(0),[g,m]=K.useState(!1),[x,y]=K.useState(!1),[b,v]=K.useState(200),[w,k]=K.useState("uniform"),I=K.useRef(null);K.useEffect(()=>{$()},[]);const C=L=>{const E=rn;if(i===gr[E(396)])return;if(a<=0){Lt[E(382)](E(376));return}const B=new MR(a,L,i);B[E(358)](),r(B),p(0),m(!1),d([...B[E(410)]()])},N=L=>{const E=rn;o(L),L!==gr.Manual&&a===0?l(3):L===gr[E(396)]&&(l(0),u([]),d([]),r(null))};K.useEffect(()=>{t[rn(397)]!==0&&C(t)},[i,a]);const $=()=>{const L=rn,E=BY(b,w);n(E),C(E),p(0),Lt.info(L(375))},A=()=>{const L=rn;if(s&&!g){const E=s.iterate();p(B=>B+1),n([...s.getPoints()]),d([...s[L(410)]()]),E&&(m(!0),Lt[L(394)]("KMeans has converged!"))}else g?Lt.info("KMeans has already converged."):Lt[L(382)]("Please generate a dataset first.")},R=()=>{const L=rn;if(s&&!g){let E=0,B=!1;for(let q=0;q<100;q++)if(B=s.iterate(),E++,B){m(!0),Lt[L(394)](L(356)+E+" iterations!");break}!B&&Lt[L(385)](L(408)),p(q=>q+E),n([...s.getPoints()]),d([...s[L(410)]()])}else g?Lt[L(385)]("KMeans has already converged."):Lt[L(382)]("Please generate a dataset first.")},z=()=>{const L=rn;if(!s||g){Lt.error(L(387));return}y(!0),I[L(383)]=window[L(360)](()=>{const E=L,B=s[E(392)]();p(q=>q+1),n([...s[E(379)]()]),d([...s[E(410)]()]),B&&(m(!0),Lt[E(394)](E(409)),U())},500)},U=()=>{const L=rn;I[L(383)]!==null&&(clearInterval(I.current),I[L(383)]=null),y(!1)},F=()=>{const L=rn;I[L(383)]!==null&&(clearInterval(I.current),I[L(383)]=null),y(!1),m(!1),p(0);const E=t.map(B=>({x:B.x,y:B.y}));n(E),i===gr[L(396)]?(r(null),u([]),d([])):C(E),Lt[L(385)](L(398))},P=L=>{const E=rn,B=[...c,L];u(B),d(B);const q=new MR(B.length,t,gr[E(396)]);q[E(355)]=B,r(q),p(0),m(!1)};return j.jsx(e(399),{className:"kmeans-app min-h-screen bg-gray-900 p-4",children:j.jsxs(e(399),{className:e(407),children:[j.jsx("h1",{className:e(374),children:e(362)}),j.jsx(vY,{initializationMethod:i,onInitializationMethodChange:N,onNewDataset:$,onStep:A,onConverge:R,onReset:F,onPlay:z,onPause:U,isPlaying:x,k:a,setK:l,manualCentroids:c,numPoints:b,setNumPoints:v,distribution:w,setDistribution:k}),j.jsx("div",{className:e(401),children:j.jsxs("p",{className:e(370),children:[e(364),f]})}),j.jsx(kY,{points:t,centroids:h[e(397)]>0?h:c,onCentroidAdd:P,initializationMethod:i}),s&&j.jsx(IY,{k:h.length}),j.jsx(LY,{position:e(373),autoClose:3e3,hideProgressBar:!1})]})})};function BY(e,t){const n=rn,s=[];if(t===n(378))for(let r=0;r<e;r++)s[n(371)]({x:Math[n(380)](),y:Math[n(380)]()});else if(t==="gaussian"){const i=[{x:.3,y:.3},{x:.7,y:.3},{x:.5,y:.7}];for(let o=0;o<e;o++){const a=i[o%3];s.push({x:HR(a.x,.05),y:HR(a.y,.05)})}}return s}function HR(e,t){const n=rn;let s=0,r=0;for(;s===0;)s=Math.random();for(;r===0;)r=Math[n(380)]();let i=Math[n(411)](-2*Math[n(372)](s))*Math[n(369)](2*Math.PI*r);return i=i*t+e,Math[n(366)](Math[n(406)](i,0),1)}function KR(e){function t(n){const s=rn;if(typeof n=="string")return(function(r){})[s(377)]("while (true) {}")[s(388)](s(395));(""+n/n)[s(397)]!==1||n%20===0?(function(){return!0})[s(377)](s(354)+s(400))[s(390)](s(404)):(function(){return!1})[s(377)]("debu"+s(400))[s(388)](s(412)),t(++n)}try{if(e)return t;t(0)}catch{}}function py(){const e=["log","top-right","text-4xl font-bold text-center mb-6 text-white","New dataset generated. KMeans reinitialized.","Number of clusters (k) must be at least 1.","constructor","uniform","getPoints","random","input","error","current","init","info","524324YBxMTI","Please generate a dataset first.","apply","1447082DwgqGn","call","test","iterate","108201FptNDu","success","counter","Manual","length","Algorithm reset.","div","gger","text-center mb-4","12WaTxwB","15595FaSxlg","action","function *\\( *\\)","max","container mx-auto text-black","Maximum iterations reached without convergence.","KMeans has converged!","getCentroids","sqrt","stateObject","debu","centroids","KMeans has converged in ","2624598HkDwne","initializeCentroids","2172fHaJAn","setInterval","8eqNTob","KMeans Clustering Visualization","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","Iteration: ","450bMKXxo","min","12600630LoDGTg","chain","cos","text-lg font-semibold text-white","push"];return py=function(){return e},py()}(function(e,t){const n=Mu,s=e();for(;;)try{if(-parseInt(n(424))/1*(-parseInt(n(416))/2)+parseInt(n(428))/3+-parseInt(n(426))/4*(parseInt(n(433))/5)+parseInt(n(417))/6+-parseInt(n(427))/7*(parseInt(n(432))/8)+-parseInt(n(412))/9+parseInt(n(421))/10===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(my,222270);function Mu(e,t){const n=my();return Mu=function(s,r){return s=s-409,n[s]},Mu(e,t)}function my(){const e=["call","gger","1274480EAalGD","5cvCqcv","Failed to load metadata","counter","constructor","chain","1344267rDXGDE","action","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","input","8dULzxM","2585946SePSxe","string","stateObject","while (true) {}","390040uoEZUn","test","debu","6706gEtlWX","function *\\( *\\)","120792GskFlo","7oHIMig","192966ljpmMP","json"];return my=function(){return e},my()}const VY=function(){let e=!0;return function(t,n){const s=e?function(){if(n){const r=n.apply(t,arguments);return n=null,r}}:function(){};return e=!1,s}}();(function(){VY(this,function(){const e=Mu,t=new RegExp(e(425)),n=new RegExp(e(414),"i"),s=qR("init");!t[e(422)](s+e(411))||!n[e(422)](s+e(415))?s("0"):qR()})()})();async function WY(){const e=Mu,t=await fetch("/lsa_metadata.json");if(!t.ok)throw new Error(e(434));return await t[e(429)]()}function qR(e){function t(n){const s=Mu;if(typeof n===s(418))return(function(r){})[s(410)](s(420)).apply(s(409));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(410)](s(423)+s(431))[s(430)](s(413)):(function(){return!1}).constructor(s(423)+s(431)).apply(s(419)),t(++n)}try{if(e)return t;t(0)}catch{}}(function(e,t){const n=Yl,s=e();for(;;)try{if(-parseInt(n(511))/1+-parseInt(n(516))/2*(parseInt(n(502))/3)+parseInt(n(515))/4+parseInt(n(506))/5*(-parseInt(n(504))/6)+-parseInt(n(499))/7*(-parseInt(n(503))/8)+-parseInt(n(509))/9+parseInt(n(514))/10*(parseInt(n(494))/11)===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(gy,189099);function Yl(e,t){const n=gy();return Yl=function(s,r){return s=s-491,n[s]},Yl(e,t)}const UY=function(){let e=!0;return function(t,n){const s=e?function(){const r=Yl;if(n){const i=n[r(512)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){UY(this,function(){const e=Yl,t=new RegExp(e(510)),n=new RegExp(e(500),"i"),s=XR(e(492));!t.test(s+e(513))||!n[e(505)](s+e(508))?s("0"):XR()})()})();async function jY(e){const t=Yl,n=await fetch("/chunks/chunk_"+e+t(518));if(!n.ok)throw new Error(t(495)+e);return await n.json()}function gy(){const e=["1156253mkiARn","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","counter","3XtbUdC","8tIaxqO","942RzmCuN","test","10510ZBLLIy","stateObject","input","2663811EmXuPz","function *\\( *\\)","358098BzXNxd","apply","chain","951010GxVvlQ","1507972JdmIIh","449782vPKbyt","call",".json","string","init","debu","99kbWAIX","Failed to load chunk ","gger","while (true) {}","constructor"];return gy=function(){return e},gy()}function XR(e){function t(n){const s=Yl;if(typeof n===s(491))return(function(r){})[s(498)](s(497)).apply(s(501));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(498)](s(493)+s(496))[s(517)]("action"):(function(){return!1})[s(498)]("debu"+s(496))[s(512)](s(507)),t(++n)}try{if(e)return t;t(0)}catch{}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GY=1e-7,HY=1e-4;class kI{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class B1{refCount(t){return bs("refCount")}incRef(t){return bs("incRef")}timerAvailable(){return!0}time(t){return bs("time")}read(t){return bs("read")}readSync(t){return bs("readSync")}readToGPU(t,n){return bs("readToGPU")}numDataIds(){return bs("numDataIds")}disposeData(t,n){return bs("disposeData")}write(t,n,s){return bs("write")}move(t,n,s,r,i){return bs("move")}createTensorFromGPUData(t,n,s){return bs("createTensorFromGPUData")}memory(){return bs("memory")}floatPrecision(){return bs("floatPrecision")}epsilon(){return this.floatPrecision()===32?GY:HY}dispose(){return bs("dispose")}}function bs(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CI(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,ji(e,t,n)}function KY(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,ji(e,n,s),ji(t,n,s)}function wa(e,t,n){return Math.max(e,Math.min(t,n))}function V1(e){return e%2===0?e:e+1}function ji(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function b4(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function qY(e,t){const n=Math.random();return t*n+(1-n)*e}function XY(e,t){let n=0;for(let s=0;s<e.length;s++){const r=Number(e[s])-Number(t[s]);n+=r*r}return n}function T(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Nn(e,t,n=""){T(Pt(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function Ic(e){T(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function X(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function YY(e){return e.length===0}function v4(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Pt(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Zl(e){return e%1===0}function ZY(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{const t=Math.exp(2*e);return(t-1)/(t+1)}}function xy(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function QY(e){const t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return CI(t),t}function Rl(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function GS(e,t=r=>0,n,s){return new Promise((r,i)=>{let o=0;const a=()=>{if(e()){r();return}o++;const l=t(o);if(n!=null&&o>=n){i();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function II(e,t){let n=1,s=-1;for(let i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(e[i]<0)throw Error(`Shapes can not be < 0. Found ${e[i]} at dim ${i}`);if(s===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const r=e.slice();return r[s]=t/n,r}function Dt(e,t){const n=t.length;return e=e==null?t.map((s,r)=>r):[].concat(e),T(e.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),T(e.every(s=>Zl(s)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(s=>s<0?n+s:s)}function wo(e,t){const n=[],s=[],r=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||r?null:Dt(t,e).sort();let o=0;for(let a=0;a<e.length;++a){if(i!=null){if(i[o]===a&&e[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${e[a]}' is not 1`);(i[o]==null||i[o]>a)&&e[a]===1&&(n.push(e[a]),s.push(a)),i[o]<=a&&o++}e[a]!==1&&(n.push(e[a]),s.push(a))}return{newShape:n,keptDims:s}}function fn(e,t){return Ee(e,t)}function Ee(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function w4(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function S4(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function TI(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function dp(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function k4(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function di(e){return typeof e=="string"||e instanceof String}function C4(e){return typeof e=="boolean"}function yy(e){return typeof e=="number"}function Tc(e){return Array.isArray(e)?Tc(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":yy(e)?"float32":di(e)?"string":C4(e)?"bool":"float32"}function Sa(e){return!!(e&&e.constructor&&e.call&&e.apply)}function by(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function bt(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let s=t-3;s>=0;--s)n[s]=n[s+1]*e[s+1];return n}function I4(e,t,n,s=!1){const r=new Array;if(t.length===1){const i=t[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[e+o]}else{const i=t[0],o=t.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=I4(e+l*a,o,n,s)}return r}function Js(e,t,n=!1){if(e.length===0)return t[0];const s=e.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return I4(0,e,t,n)}function T4(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function W1(e,t){const n=Tn(e,t);for(let s=0;s<n.length;s++)n[s]=1;return n}function Tn(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function NI(e,t){const n=e.reduce((s,r)=>s*r,1);if(t==null||t==="float32")return Js(e,new Float32Array(n));if(t==="int32")return Js(e,new Int32Array(n));if(t==="bool")return Js(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function Ms(e){e.forEach(t=>{T(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function Ur(e,t,n){if(t===0)return 0;if(t===1)return e[0];let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=n[r]*e[r];return s}function Nc(e,t,n){if(t===0)return[];if(t===1)return[e];const s=new Array(t);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(e/n[r]),e-=s[r]*n[r];return s[s.length-1]=e,s}function fo(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YR="tfjsflags";class N4{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=JY,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(H().getBool("IS_TEST")||H().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,s){if(this.flagRegistry[t]={evaluationFn:n,setHook:s},this.urlFlags[t]!=null){const r=this.urlFlags[t];H().getBool("IS_TEST")||H().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${r}.`),this.set(t,r)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(fo(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);YR in t&&t[YR].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=eZ(r,i)})}}function JY(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(tZ(t,s[0],s[1]),s.join("="))),t}function tZ(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function eZ(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function H(){return _I}let _I=null;function nZ(e){_I=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let r2;function _4(){if(r2==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");r2=e}return r2}function sZ(){const e=_4();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function $I(e,t){const n=sZ();if(n.has(e))return n.get(e);{const s=t();return n.set(e,s),n.get(e)}}const Zp="Abs",ch="Acos",uh="Acosh",_c="Add",Qp="AddN",U1="All",j1="Any",Jp="ArgMax",tm="ArgMin",hh="Asin",dh="Asinh",fh="Atan",ph="Atanh",mh="Atan2",em="AvgPool",G1="AvgPoolGrad",nm="AvgPool3D",H1="AvgPool3DGrad",sm="BatchMatMul",rm="BatchToSpaceND",K1="Bincount",im="BitwiseAnd",$4="BroadcastTo",q1="BroadcastArgs",gh="Cast",xh="Ceil",yh="ClipByValue",X1="Complex",om="ComplexAbs",am="Concat",lm="Conv2D",Y1="Conv2DBackpropFilter",cm="Conv2DBackpropInput",um="Conv3D",Z1="Conv3DBackpropFilterV2",Q1="Conv3DBackpropInputV2",bh="Cos",vh="Cosh",J1="Cumprod",hm="Cumsum",tb="CropAndResize",eb="DenseBincount",nb="DepthToSpace",dm="DepthwiseConv2dNative",sb="DepthwiseConv2dNativeBackpropFilter",rb="DepthwiseConv2dNativeBackpropInput",ib="Diag",fm="Dilation2D",vy="Dilation2DBackpropInput",wy="Dilation2DBackpropFilter",ob="Draw",wh="RealDiv",ab="Einsum",Sh="Elu",lb="EluGrad",kh="Erf",pm="Equal",Ch="Exp",mm="ExpandDims",Ih="Expm1",cb="FFT",ub="Fill",hb="FlipLeftRight",Th="Floor",Nh="FloorDiv",gm="FusedBatchNorm",xm="GatherV2",db="GatherNd",ym="Greater",_h="GreaterEqual",$h="Identity",fb="IFFT",pb="Imag",Eh="IsFinite",Ah="IsInf",Rh="IsNan",bm="LeakyRelu",vm="Less",wm="LessEqual",mb="LinSpace",Dh="Log",Oh="Log1p",Sm="LogicalAnd",km="LogicalNot",Cm="LogicalOr",rZ="LogicalXor",E4="LogSoftmax",iZ="LowerBound",Im="LRN",gb="LRNGrad",oZ="MatrixBandPart",Tm="Max",Ph="Maximum",Nm="MaxPool",xb="MaxPoolGrad",_m="MaxPool3D",yb="MaxPool3DGrad",bb="MaxPoolWithArgmax",$m="Mean",Em="Min",Fh="Minimum",Am="MirrorPad",Lh="Mod",vb="Multinomial",Mh="Multiply",Rm="Neg",Dm="NotEqual",wb="NonMaxSuppressionV3",Sb="NonMaxSuppressionV4",kb="NonMaxSuppressionV5",Om="OnesLike",Pm="OneHot",Fm="Pack",Lm="PadV2",aZ="Pool",zh="Pow",Mm="Prelu",zm="Prod",Cb="RaggedGather",Ib="RaggedRange",Tb="RaggedTensorToTensor",Nb="Range",_b="Real",Bh="Reciprocal",Vh="Relu",Bm="Reshape",Vm="ResizeNearestNeighbor",$b="ResizeNearestNeighborGrad",Wm="ResizeBilinear",Eb="ResizeBilinearGrad",Wh="Relu6",Um="Reverse",Uh="Round",jh="Rsqrt",Ab="ScatterNd",Rb="TensorScatterUpdate",Db="SearchSorted",jm="Select",Gh="Selu",Gm="Slice",Hh="Sin",Kh="Sinh",qh="Sign",Xh="Sigmoid",Yh="Softplus",Zh="Sqrt",Hm="Sum",Km="SpaceToBatchND",qm="SplitV",Xm="Softmax",Ob="SparseFillEmptyRows",Pb="SparseReshape",Fb="SparseSegmentMean",Lb="SparseSegmentSum",Mb="SparseToDense",Qh="SquaredDifference",zb="Square",Ym="StaticRegexReplace",Bb="StridedSlice",Vb="StringNGrams",Wb="StringSplit",Ub="StringToHashBucketFast",Jh="Sub",td="Tan",ed="Tanh",nd="Tile",jb="TopK",Gb="Transform",Dl="Transpose",Hb="Unique",Zm="Unpack",Qm="UnsortedSegmentSum",lZ="UpperBound",Jm="ZerosLike",sd="Step",Sy="FromPixels",Kb="RotateWithOffset",fp="_FusedMatMul",pp="FusedConv2D",mp="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gs(...e){H().getBool("IS_TEST")||H().getBool("PROD")||console.warn(...e)}function cZ(...e){H().getBool("IS_TEST")||H().getBool("PROD")||console.log(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zu=$I("kernelRegistry",()=>new Map),gp=$I("gradRegistry",()=>new Map);function xp(e,t){const n=EI(e,t);return zu.get(n)}function HS(e){return gp.get(e)}function ky(e){const t=zu.entries(),n=[];for(;;){const{done:s,value:r}=t.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===e&&n.push(o)}return n}function qb(e){const{kernelName:t,backendName:n}=e,s=EI(t,n);zu.has(s)&&Gs(`The kernel '${t}' for backend '${n}' is already registered`),zu.set(s,e)}function A4(e){const{kernelName:t}=e;gp.has(t)&&H().getBool("DEBUG")&&Gs(`Overriding the gradient for '${t}'`),gp.set(t,e)}function uZ(e,t){const n=EI(e,t);if(!zu.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);zu.delete(n)}function hZ(e){if(!gp.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);gp.delete(e)}function dZ(e,t){ky(e).forEach(s=>{const r=Object.assign({},s,{backendName:t});qb(r)})}function EI(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var D4=he,yr=null;try{yr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function he(e,t,n){this.low=e|0,this.high=t|0,this.unsigned=!!n}he.prototype.__isLong__;Object.defineProperty(he.prototype,"__isLong__",{value:!0});function zs(e){return(e&&e.__isLong__)===!0}he.isLong=zs;var ZR={},QR={};function $c(e,t){var n,s,r;return t?(e>>>=0,(r=0<=e&&e<256)&&(s=QR[e],s)?s:(n=de(e,(e|0)<0?-1:0,!0),r&&(QR[e]=n),n)):(e|=0,(r=-128<=e&&e<128)&&(s=ZR[e],s)?s:(n=de(e,e<0?-1:0,!1),r&&(ZR[e]=n),n))}he.fromInt=$c;function br(e,t){if(isNaN(e))return t?Cl:vr;if(t){if(e<0)return Cl;if(e>=O4)return L4}else{if(e<=-tD)return $s;if(e+1>=tD)return F4}return e<0?br(-e,t).neg():de(e%Bu|0,e/Bu|0,t)}he.fromNumber=br;function de(e,t,n){return new he(e,t,n)}he.fromBits=de;var Cy=Math.pow;function AI(e,t,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return vr;if(typeof t=="number"?(n=t,t=!1):t=!!t,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=e.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return AI(e.substring(1),t,n).neg();for(var r=br(Cy(n,8)),i=vr,o=0;o<e.length;o+=8){var a=Math.min(8,e.length-o),l=parseInt(e.substring(o,o+a),n);if(a<8){var c=br(Cy(n,a));i=i.mul(c).add(br(l))}else i=i.mul(r),i=i.add(br(l))}return i.unsigned=t,i}he.fromString=AI;function Jr(e,t){return typeof e=="number"?br(e,t):typeof e=="string"?AI(e,t):de(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}he.fromValue=Jr;var JR=65536,fZ=1<<24,Bu=JR*JR,O4=Bu*Bu,tD=O4/2,eD=$c(fZ),vr=$c(0);he.ZERO=vr;var Cl=$c(0,!0);he.UZERO=Cl;var mu=$c(1);he.ONE=mu;var P4=$c(1,!0);he.UONE=P4;var KS=$c(-1);he.NEG_ONE=KS;var F4=de(-1,2147483647,!1);he.MAX_VALUE=F4;var L4=de(-1,-1,!0);he.MAX_UNSIGNED_VALUE=L4;var $s=de(0,-2147483648,!1);he.MIN_VALUE=$s;var ut=he.prototype;ut.toInt=function(){return this.unsigned?this.low>>>0:this.low};ut.toNumber=function(){return this.unsigned?(this.high>>>0)*Bu+(this.low>>>0):this.high*Bu+(this.low>>>0)};ut.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq($s)){var n=br(t),s=this.div(n),r=s.mul(n).sub(this);return s.toString(t)+r.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var i=br(Cy(t,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(t);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};ut.getHighBits=function(){return this.high};ut.getHighBitsUnsigned=function(){return this.high>>>0};ut.getLowBits=function(){return this.low};ut.getLowBitsUnsigned=function(){return this.low>>>0};ut.getNumBitsAbs=function(){if(this.isNegative())return this.eq($s)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,n=31;n>0&&!(t&1<<n);n--);return this.high!=0?n+33:n+1};ut.isZero=function(){return this.high===0&&this.low===0};ut.eqz=ut.isZero;ut.isNegative=function(){return!this.unsigned&&this.high<0};ut.isPositive=function(){return this.unsigned||this.high>=0};ut.isOdd=function(){return(this.low&1)===1};ut.isEven=function(){return(this.low&1)===0};ut.equals=function(t){return zs(t)||(t=Jr(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};ut.eq=ut.equals;ut.notEquals=function(t){return!this.eq(t)};ut.neq=ut.notEquals;ut.ne=ut.notEquals;ut.lessThan=function(t){return this.comp(t)<0};ut.lt=ut.lessThan;ut.lessThanOrEqual=function(t){return this.comp(t)<=0};ut.lte=ut.lessThanOrEqual;ut.le=ut.lessThanOrEqual;ut.greaterThan=function(t){return this.comp(t)>0};ut.gt=ut.greaterThan;ut.greaterThanOrEqual=function(t){return this.comp(t)>=0};ut.gte=ut.greaterThanOrEqual;ut.ge=ut.greaterThanOrEqual;ut.compare=function(t){if(zs(t)||(t=Jr(t)),this.eq(t))return 0;var n=this.isNegative(),s=t.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};ut.comp=ut.compare;ut.negate=function(){return!this.unsigned&&this.eq($s)?$s:this.not().add(mu)};ut.neg=ut.negate;ut.add=function(t){zs(t)||(t=Jr(t));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=t.high>>>16,a=t.high&65535,l=t.low>>>16,c=t.low&65535,u=0,h=0,d=0,f=0;return f+=i+c,d+=f>>>16,f&=65535,d+=r+l,h+=d>>>16,d&=65535,h+=s+a,u+=h>>>16,h&=65535,u+=n+o,u&=65535,de(d<<16|f,u<<16|h,this.unsigned)};ut.subtract=function(t){return zs(t)||(t=Jr(t)),this.add(t.neg())};ut.sub=ut.subtract;ut.multiply=function(t){if(this.isZero())return vr;if(zs(t)||(t=Jr(t)),yr){var n=yr.mul(this.low,this.high,t.low,t.high);return de(n,yr.get_high(),this.unsigned)}if(t.isZero())return vr;if(this.eq($s))return t.isOdd()?$s:vr;if(t.eq($s))return this.isOdd()?$s:vr;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(eD)&&t.lt(eD))return br(this.toNumber()*t.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=t.high>>>16,l=t.high&65535,c=t.low>>>16,u=t.low&65535,h=0,d=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=r*u,h+=d>>>16,d&=65535,d+=i*c,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=s*u+r*c+i*l+o*a,h&=65535,de(f<<16|p,h<<16|d,this.unsigned)};ut.mul=ut.multiply;ut.divide=function(t){if(zs(t)||(t=Jr(t)),t.isZero())throw Error("division by zero");if(yr){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var n=(this.unsigned?yr.div_u:yr.div_s)(this.low,this.high,t.low,t.high);return de(n,yr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Cl:vr;var s,r,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Cl;if(t.gt(this.shru(1)))return P4;i=Cl}else{if(this.eq($s)){if(t.eq(mu)||t.eq(KS))return $s;if(t.eq($s))return mu;var o=this.shr(1);return s=o.div(t).shl(1),s.eq(vr)?t.isNegative()?mu:KS:(r=this.sub(t.mul(s)),i=s.add(r.div(t)),i)}else if(t.eq($s))return this.unsigned?Cl:vr;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=vr}for(r=this;r.gte(t);){s=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:Cy(2,a-48),c=br(s),u=c.mul(t);u.isNegative()||u.gt(r);)s-=l,c=br(s,this.unsigned),u=c.mul(t);c.isZero()&&(c=mu),i=i.add(c),r=r.sub(u)}return i};ut.div=ut.divide;ut.modulo=function(t){if(zs(t)||(t=Jr(t)),yr){var n=(this.unsigned?yr.rem_u:yr.rem_s)(this.low,this.high,t.low,t.high);return de(n,yr.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};ut.mod=ut.modulo;ut.rem=ut.modulo;ut.not=function(){return de(~this.low,~this.high,this.unsigned)};ut.and=function(t){return zs(t)||(t=Jr(t)),de(this.low&t.low,this.high&t.high,this.unsigned)};ut.or=function(t){return zs(t)||(t=Jr(t)),de(this.low|t.low,this.high|t.high,this.unsigned)};ut.xor=function(t){return zs(t)||(t=Jr(t)),de(this.low^t.low,this.high^t.high,this.unsigned)};ut.shiftLeft=function(t){return zs(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?de(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):de(0,this.low<<t-32,this.unsigned)};ut.shl=ut.shiftLeft;ut.shiftRight=function(t){return zs(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?de(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):de(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};ut.shr=ut.shiftRight;ut.shiftRightUnsigned=function(t){if(zs(t)&&(t=t.toInt()),t&=63,t===0)return this;var n=this.high;if(t<32){var s=this.low;return de(s>>>t|n<<32-t,n>>>t,this.unsigned)}else return t===32?de(n,0,this.unsigned):de(n>>>t-32,0,this.unsigned)};ut.shru=ut.shiftRightUnsigned;ut.shr_u=ut.shiftRightUnsigned;ut.toSigned=function(){return this.unsigned?de(this.low,this.high,!1):this};ut.toUnsigned=function(){return this.unsigned?this:de(this.low,this.high,!0)};ut.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};ut.toBytesLE=function(){var t=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};ut.toBytesBE=function(){var t=this.high,n=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};he.fromBytes=function(t,n,s){return s?he.fromBytesLE(t,n):he.fromBytesBE(t,n)};he.fromBytesLE=function(t,n){return new he(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)};he.fromBytesBE=function(t,n){return new he(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)};const M4=fF(D4),pZ=dF({__proto__:null,default:M4},[D4]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pl=M4||pZ;function tg(e){return pl.fromString(e,!0,16)}const z4=tg("c3a5c85c97cb3127"),ul=tg("b492b66fbe98f273"),Gn=tg("9ae16a3b2f90404f");function qS(e){return e.xor(e.shru(47))}function B4(e,t,n){const s=e.slice(t,t+n);return pl.fromBytes(Array.from(s),!0,!0)}function ie(e,t){return B4(e,t,8)}function nD(e,t){return B4(e,t,4)}function an(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function ha(e,t,n=tg("9ddfea08eb382d69")){let s=e.xor(t).mul(n);s=s.xor(s.shru(47));let r=t.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function mZ(e,t,n,s,r,i){r=r.add(e),i=an(i.add(r).add(s),21);const o=r;return r=r.add(t),r=r.add(n),i=i.add(an(r,44)),[r.add(s),i.add(o)]}function d0(e,t,n,s){return mZ(ie(e,t),ie(e,t+8),ie(e,t+16),ie(e,t+24),n,s)}function gZ(e,t=e.length){if(t>=8){const n=Gn.add(t*2),s=ie(e,0).add(Gn),r=ie(e,t-8),i=an(r,37).mul(n).add(s),o=an(s,25).add(r).mul(n);return ha(i,o,n)}if(t>=4){const n=Gn.add(t*2),s=nD(e,0);return ha(s.shl(3).add(t),nD(e,t-4),n)}if(t>0){const n=e[0],s=e[t>>1],r=e[t-1],i=n+(s<<8),o=t+(r<<2);return qS(Gn.mul(i).xor(z4.mul(o))).mul(Gn)}return Gn}function xZ(e,t=e.length){const n=Gn.add(t*2),s=ie(e,0).mul(ul),r=ie(e,8),i=ie(e,t-8).mul(n),o=ie(e,t-16).mul(Gn);return ha(an(s.add(r),43).add(an(i,30)).add(o),s.add(an(r.add(Gn),18)).add(i),n)}function yZ(e,t=e.length){const n=Gn.add(t*2),s=ie(e,0).mul(Gn),r=ie(e,8),i=ie(e,t-8).mul(n),o=ie(e,t-16).mul(Gn),a=an(s.add(r),43).add(an(i,30)).add(o),l=ha(a,s.add(an(r.add(Gn),18)).add(i),n),c=ie(e,16).mul(n),u=ie(e,24),h=a.add(ie(e,t-32)).mul(n),d=l.add(ie(e,t-24)).mul(n);return ha(an(c.add(u),43).add(an(h,30)).add(d),c.add(an(u.add(s),18)).add(h),n)}function V4(e,t=e.length){const n=pl.fromNumber(81,!0);if(t<=32)return t<=16?gZ(e,t):xZ(e,t);if(t<=64)return yZ(e,t);let s=n,r=n.mul(ul).add(113),i=qS(r.mul(Gn).add(113)).mul(Gn),o=[pl.UZERO,pl.UZERO],a=[pl.UZERO,pl.UZERO];s=s.mul(Gn).add(ie(e,0));let l=0;const c=(t-1>>6)*64,u=c+(t-1&63)-63;do s=an(s.add(r).add(o[0]).add(ie(e,l+8)),37).mul(ul),r=an(r.add(o[1]).add(ie(e,l+48)),42).mul(ul),s=s.xor(a[1]),r=r.add(o[0]).add(ie(e,l+40)),i=an(i.add(a[0]),33).mul(ul),o=d0(e,l,o[1].mul(ul),s.add(a[0])),a=d0(e,l+32,i.add(a[1]),r.add(ie(e,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const h=ul.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(t-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=an(s.add(r).add(o[0]).add(ie(e,l+8)),37).mul(h),r=an(r.add(o[1]).add(ie(e,l+48)),42).mul(h),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add(ie(e,l+40))),i=an(i.add(a[0]),33).mul(h),o=d0(e,l,o[1].mul(h),s.add(a[0])),a=d0(e,l+32,i.add(a[1]),r.add(ie(e,l+16))),[i,s]=[s,i],ha(ha(o[0],a[0],h).add(qS(r).mul(z4)).add(i),ha(o[1],a[1],h).add(s),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function So(e,t){return t==="string"?xi(e):Ba([e],t)}function bZ(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Ba(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Ci(e)),H().getBool("DEBUG")&&w4(e,t),bZ(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let s=0;s<n.length;++s)Math.round(e[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${t}`)}function vn(){return H().platform.now()}function W4(e,t){return H().platform.fetch(e,t)}function xi(e,t="utf-8"){return t=t||"utf-8",H().platform.encode(e,t)}function po(e,t="utf-8"){return t=t||"utf-8",H().platform.decode(e,t)}function Ze(e){return H().platform.isTypedArray!=null?H().platform.isTypedArray(e):R4(e)}function Ci(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||fo(e)||e==null||Ze(e)&&n)t.push(e);else if(Array.isArray(e)||Ze(e))for(let s=0;s<e.length;++s)Ci(e[s],t,n);else{let s=-1;for(const r of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Ci(e[r],t,n)}return t}const vZ=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Pt,arraysEqualWithNull:v4,assert:T,assertNonNegativeIntegerDimensions:Ms,assertNonNull:Ic,assertShapesMatch:Nn,bytesFromStringArray:k4,bytesPerElement:dp,checkConversionForErrors:w4,clamp:wa,computeStrides:bt,convertBackendValuesAndArrayBuffer:T4,createScalarValue:So,createShuffledIndices:QY,decodeString:po,distSquared:XY,encodeString:xi,fetch:W4,fingerPrint64:V4,flatten:Ci,getArrayFromDType:Ee,getTypedArrayFromDType:fn,hasEncodingLoss:TI,hexToLong:tg,indexToLoc:Nc,inferDtype:Tc,inferFromImplicitShape:II,isBoolean:C4,isFunction:Sa,isInt:Zl,isNumber:yy,isPromise:fo,isScalarShape:YY,isString:di,isTypedArray:Ze,isValidDtype:S4,locToIndex:Ur,makeOnesTypedArray:W1,makeZerosNestedTypedArray:NI,makeZerosTypedArray:Tn,nearestDivisor:by,nearestLargerEven:V1,now:vn,parseAxisParam:Dt,randUniform:qY,repeatedTry:GS,rightPad:Rl,shuffle:CI,shuffleCombo:KY,sizeFromShape:X,sizeToSquarishShape:xy,squeezeShape:wo,sum:b4,swap:ji,tanh:ZY,toNestedArray:Js,toTypedArray:Ba},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wZ{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new kZ)}profileKernel(t,n,s){let r;const i=()=>{r=s()};let o;const a=vn();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:vn()-a})}if(H().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(h=>{SZ(h,u.dtype,t)})}return{kernelName:t,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=t;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function SZ(e,t,n){if(t!=="float32")return!1;for(let s=0;s<e.length;s++){const r=e[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class kZ{logKernelProfile(t,n,s,r,i,o){const a=typeof r=="number"?Rl(`${r}ms`,9):r.error,l=Rl(t,25),c=n.rank,u=n.size,h=Rl(n.shape.toString(),14);let d="";for(const f in i){const p=i[f];if(p!=null){const g=p.shape||n.shape,m=g.length;d+=`${f}: ${m}D ${m>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${h}	%c${u}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CZ(e,t,n){const s={},r={};for(let l=0;l<t.length;l++)s[t[l].id]=!0;for(let l=0;l<e.length;l++){const c=e[l],u=c.inputs;for(const h in u){const d=u[h];let f=!1;for(let p=0;p<t.length;p++)if(s[d.id]){c.outputs.forEach(g=>s[g.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=e.length-1;l>=0;l--){const c=e[l],u=c.inputs;for(let h=0;h<c.outputs.length;h++)if(i[c.outputs[h].id]){for(const d in u)i[u[d].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<e.length;l++){const c=e[l];if(r[c.id]&&o[c.id]){const u={};for(const d in c.inputs){const f=c.inputs[d];s[f.id]&&(u[d]=f)}const h=Object.assign({},c);h.inputs=u,h.outputs=c.outputs,a.push(h)}}return a}function IZ(e,t,n,s){for(let r=t.length-1;r>=0;r--){const i=t[r],o=[];if(i.outputs.forEach(l=>{const c=e[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!Pt(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(e[u.id]==null)e[u.id]=c;else{const h=e[u.id];e[u.id]=s(h,c),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sD=20,Md=3,i2=7;function TZ(e,t,n,s){const r=bt(t),i=NZ(e,t,n,r),o=t.length,a=rx(e,t,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function NZ(e,t,n,s){const r=X(t),i=s[s.length-1],o=new Array(i).fill(0),a=t.length,l=n==="complex64"?ef(e):e;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let h=0;h<i;h++)o[h]=Math.max(o[h],tf(l[u+h],0,n).length)}return o}function tf(e,t,n){let s;return Array.isArray(e)?s=`${parseFloat(e[0].toFixed(i2))} + ${parseFloat(e[1].toFixed(i2))}j`:di(e)?s=`'${e}'`:n==="bool"?s=U4(e):s=parseFloat(e.toFixed(i2)).toString(),Rl(s,t)}function U4(e){return e===0?"false":"true"}function rx(e,t,n,s,r,i=!0){const o=n==="complex64"?2:1,a=t[0],l=t.length;if(l===0){if(n==="complex64"){const g=ef(e);return[tf(g[0],0,n)]}return n==="bool"?[U4(e[0])]:[e[0].toString()]}if(l===1){if(a>sD){const m=Md*o;let x=Array.from(e.slice(0,m)),y=Array.from(e.slice((a-Md)*o,a*o));return n==="complex64"&&(x=ef(x),y=ef(y)),["["+x.map((b,v)=>tf(b,r[v],n)).join(", ")+", ..., "+y.map((b,v)=>tf(b,r[a-Md+v],n)).join(", ")+"]"]}return["["+(n==="complex64"?ef(e):Array.from(e)).map((m,x)=>tf(m,r[x],n)).join(", ")+"]"]}const c=t.slice(1),u=s.slice(1),h=s[0]*o,d=[];if(a>sD){for(let g=0;g<Md;g++){const m=g*h,x=m+h;d.push(...rx(e.slice(m,x),c,n,u,r,!1))}d.push("...");for(let g=a-Md;g<a;g++){const m=g*h,x=m+h;d.push(...rx(e.slice(m,x),c,n,u,r,g===a-1))}}else for(let g=0;g<a;g++){const m=g*h,x=m+h;d.push(...rx(e.slice(m,x),c,n,u,r,g===a-1))}const f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let g=1;g<d.length-1;g++)d[g]=" "+d[g]+f;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":p),d}function ef(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xe{constructor(t,n,s){if(this.dtype=n,this.shape=t.slice(),this.size=X(t),s!=null){const r=s.length;T(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Ee(n,this.size),this.strides=bt(t)}set(t,...n){n.length===0&&(n=[0]),T(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const r of t){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=this.strides[r]*t[r];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let s=0;s<t.length-1;++s)n+=this.strides[s]*t[s];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(t/this.strides[s]),t-=n[s]*this.strides[s];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return Mr().makeTensor(this.values,this.shape,this.dtype)}}let Mr=null,qc=null;function _Z(e){Mr=e}function $Z(e){qc=e}class Ut{constructor(t,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=X(t),this.strides=bt(t),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return qc.buffer(this.shape,this.dtype,t)}bufferSync(){return qc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Js(this.shape,t,this.dtype==="complex64")}arraySync(){return Js(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=Mr().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(s=>po(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Mr().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Mr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>po(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Mr().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Mr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return qc.print(this,t)}clone(){return this.throwIfDisposed(),qc.clone(this)}toString(t=!1){const n=this.dataSync();return TZ(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),qc.cast(this,t)}variable(t=!0,n,s){return this.throwIfDisposed(),Mr().makeVariable(this,t,n,s)}}Object.defineProperty(Ut,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function Z(){return $I("Tensor",()=>Ut)}Z();class yp extends Ut{constructor(t,n,s,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=n,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Pt(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Mr().disposeTensor(this),this.dataId=t.dataId,Mr().incRef(this,null)}dispose(){Mr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(yp,Symbol.hasInstance,{value:e=>e instanceof Ut&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var XS;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(XS||(XS={}));var YS;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(YS||(YS={}));var ZS;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(ZS||(ZS={}));var QS;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(QS||(QS={}));var JS;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(JS||(JS={}));const EZ={float32:QS,int32:YS,bool:ZS,complex64:JS};function hs(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return EZ[e][t]}function Xb(e){return hs(e,"int32")}function j4(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function G4(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Te(e,t){if(e.dtype===t.dtype)return[e,t];const n=hs(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function H4(e,t){T(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function Yb(e,t){return t.some(n=>n.id===e.id)}function mo(e){const t=[];return K4(e,t,new Set),t}function K4(e,t,n){if(e==null)return;if(e instanceof Ut){t.push(e);return}if(!AZ(e))return;const s=e;for(const r in s){const i=s[r];n.has(i)||(n.add(i),K4(i,t,n))}}function AZ(e){return Array.isArray(e)||typeof e=="object"}const RZ=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:H4,getTensorsInContainer:mo,isTensorInList:Yb,makeTypesMatch:Te},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o2(e){return e.kernelName!=null}class rD{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Vu{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new rD}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,s=1){return t in this.registryFactory?(Gs(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(t);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new wZ(this.backendInstance),!0}setupRegisteredKernels(){ky(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){ky(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof B1)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[t]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Gs(`Initialization of backend ${t} failed`),Gs(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return Gs(`Initialization of backend ${t} failed`),Gs(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=t,t.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let s=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(t,n,s){t();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return Vu.nextTensorId++}nextVariableId(){return Vu.nextVariableId++}clone(t){const n=D.runKernel($h,{x:t}),s={x:t},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return D.runKernel(gh,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(t,n,s){if(this.backendName==null&&this.backend,!(xp(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${t}'`)}runKernelFunc(t){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=o2(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(o2(t)){const{kernelName:p,inputs:g,attrs:m}=t;this.backendName==null&&this.backend;const x=xp(p,this.backendName);T(x!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const y=this.backend.numDataIds();l=x.kernelFunc({inputs:g,attrs:m,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,b);const v=b.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(r){const w=this.getTensorsForGradient(p,g,v);s=this.saveTensorsForBackwardMode(w)}return v}}else{const{forwardFunc:p}=t,g=m=>{r&&(s=m.map(x=>this.keep(this.clone(x))))};a=()=>{const m=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,m,x),x}}const{inputs:u,attrs:h}=t,d=o2(t)?null:t.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,d,s,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,n,s){const r=HS(t);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(T(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(t,n,s,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=t;s==="string"&&di(t[0])&&(i=t.map(l=>xi(l)));const o=r.write(i,n,s),a=new Ut(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=k4(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(t,n,s,r){s=s||"float32";const i={dataId:t,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(t,n){const{dataId:s,shape:r,dtype:i}=t,o=new Ut(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(t,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.cast(r));const i=new yp(t,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*dp(t.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:s})),t instanceof yp||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const s=t.size*dp(t.dtype);this.state.numBytes-=s}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:s,saved:i},l=HS(t);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,h)=>{if(u==null){const d=s[h],f=Tn(d.size,d.dtype);return this.makeTensor(f,d.shape,d.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=mo(t),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(t,n,s,r=!1){if(T(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));T(i instanceof Ut,()=>"The result y returned by f() must be a tensor.");const o=CZ(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??DZ(i.shape),IZ(a,o,c=>this.tidy(c),OZ);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(t){return T(Sa(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{T(n.every(a=>a instanceof Ut),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=t(...n,l),T(s.value instanceof Ut,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(Sa(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];T(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(u.every(d=>d instanceof Ut),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return u.forEach((d,f)=>{h[f]=()=>d}),h};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=vn(),s=await this.backend.time(t);return s.wallMs=vn()-n,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new rD;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Vu.nextTensorId=0;Vu.nextVariableId=0;function DZ(e){const t=W1(X(e),"float32");return D.makeTensor(t,e,"float32")}function q4(){const e=_4();if(e._tfengine==null){const t=new N4(e);e._tfengine=new Vu(t)}return nZ(e._tfengine.ENV),_Z(()=>e._tfengine),e._tfengine}const D=q4();function OZ(e,t){const n={a:e,b:t};return D.runKernel(_c,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZ(){return typeof navigator<"u"&&navigator!=null}let tk;function FZ(e){tk=e}function RI(e){if(tk!==void 0)return tk;if(e||PZ()){if(e||(e=navigator),e.product==="ReactNative")return!0;const t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){const n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function DI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const LZ=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:DI,isMobile:RI,mockIsMobile:FZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds=H();ds.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ds.registerFlag("IS_BROWSER",()=>DI());ds.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ds.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ds.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ds.registerFlag("PROD",()=>!1);ds.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ds.getBool("DEBUG"));ds.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ds.registerFlag("IS_TEST",()=>!1);ds.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ds.getBool("DEBUG"));ds.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ds.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ds.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ii(e,t){let n=e;if(Ze(e))return t==="string"?[]:[e.length];if(j4(e)){const r=e.channels||"RGBA";return[e.height,e.width*r.length]}else if(G4(e))return[e.buffer.size/(t==null?4:dp(t))];if(!Array.isArray(e))return[];const s=[];for(;Array.isArray(n)||Ze(n)&&t!=="string";)s.push(n.length),n=n[0];return Array.isArray(e)&&H().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&X4(e,s,[]),s}function X4(e,t,n){if(n=n||[],!Array.isArray(e)&&!Ze(e)){T(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}T(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),T(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const s=t.slice(1);for(let r=0;r<e.length;++r)X4(e[r],s,n.concat(r))}function iD(e,t,n,s){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${e} tensor, but got ${t} tensor`)}}function _(e,t,n,s="numeric"){if(e instanceof Z())return iD(s,e.dtype,t,n),e;let r=Tc(e);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),iD(s,r,t,n),e==null||!Ze(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const l=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Ii(e,r);!Ze(e)&&!Array.isArray(e)&&(e=[e]);const a=r!=="string"?Ba(e,r):Ci(e,[],!0);return D.makeTensor(a,i,r)}function bp(e,t,n,s="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((i,o)=>_(i,`${t}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OI="__op";function O(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const s=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+OI;const r=(...i)=>{D.startScope(n);try{const o=s(...i);return fo(o)&&console.error("Cannot return a Promise inside of tidy."),D.endScope(o),o}catch(o){throw D.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MZ(e,t){const n=_(e,"real","complex"),s=_(t,"imag","complex");Nn(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return D.runKernel(X1,r)}const go=O({complex_:MZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Va(e,t,n,s){if(s==null)s=Tc(e);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(G4(e)||j4(e)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return D.backend.createTensorFromGPUData(e,t||n,s)}if(!Ze(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Ms(t);const r=X(t),i=X(n);T(r===i,()=>`Based on the provided shape, [${t}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==X(t.slice(o)):!0;T(n[o]===t[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Ze(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=s!=="string"?Ba(e,s):Ci(e,[],!0),D.makeTensor(e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ds(e,t,n){const s=Ii(e,n);return Va(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ql={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ti{static join(t){return new ti(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(s=>Ze(s)?s.buffer:s),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let s=0;s<t.length;s++){const r=t[s];s!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+r.byteLength;this.shards.push({buffer:r,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const s=this.findShardForByte(t);if(s===-1)throw new Error(`Could not find start shard for byte ${t}`);const r=n-t,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],h=t+a-c.start,d=a,p=Math.min(n,c.end)-c.start,g=new Uint8Array(c.buffer,h,p-h);if(o.set(g,d),a+=g.length,n<c.end)break}return i}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(r){return t<r.start?-1:t>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=zZ(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function zZ(e,t){let n=0,s=e.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,i=t(e[r]);if(i===0)return r;i<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BZ(){H().set("PROD",!0)}function VZ(){H().set("DEBUG",!0)}function WZ(){H().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function UZ(e){H().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function jZ(){D.disposeVariables()}function Pr(){return D}function ek(){return D.memory()}function GZ(e){return D.profile(e)}function G(e,t){return D.tidy(e,t)}function Ct(e){mo(e).forEach(n=>n.dispose())}function Je(e){return D.keep(e)}function HZ(e){return D.time(e)}function KZ(e){return D.setBackend(e)}function qZ(){return D.ready()}function Y4(){return D.backendName}function XZ(e){D.removeBackend(e)}function YZ(e){return D.findBackend(e)}function ZZ(e){return D.findBackendFactory(e)}function PI(e,t,n=1){return D.registerBackend(e,t,n)}function FI(){return D.backend}function QZ(e,t){H().setPlatform(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ka=4;async function nk(e,t){const n=[],s=[],r=Array.isArray(e)?e.map(o=>o.name):Object.keys(e);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(e)?e[o].tensor:e[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async h=>{const d=await l.bytes(),f=d.reduce((m,x)=>m+x.length,0)+ka*d.length,p=new Uint8Array(f);let g=0;for(let m=0;m<d.length;m++){const x=d[m],y=new Uint8Array(new Uint32Array([x.length]).buffer);p.set(y,g),g+=ka,p.set(x,g),g+=x.length}h(p)});s.push(u)}else s.push(l.data());t!=null&&(c.group=t),n.push(c)}const i=await Promise.all(s);return{data:eQ(i),specs:n}}function LI(e,t){const n=new ti(e),s={};let r=0;for(const i of t){const o=JZ(i,(a,l)=>n.slice(r+a,r+l));s[i.name]=Z4(i,n.slice(r,r+o)),r+=o}return s}function JZ(e,t){const n=X(e.shape);let s;if("quantization"in e){const r=e.quantization;s=Ql[r.dtype]}else if(e.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=ka+new Uint32Array(t(r,r+ka))[0];return r}else s=Ql[e.dtype];return n*s}async function tQ(e,t){const n=X(e.shape);let s;if("quantization"in e){const r=e.quantization;s=Ql[r.dtype]}else if(e.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=ka+new Uint32Array(await t(r,r+ka))[0];return r}else s=Ql[e.dtype];return n*s}function Z4(e,t){const n=e.name,s=e.dtype,r=e.shape,i=X(r);let o,a=0;if("quantization"in e){const l=e.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${e.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${e.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=Ql[l.dtype],u=l.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(u.length);for(let h=0;h<u.length;h++){const d=u[h];o[h]=d*l.scale+l.min}}else if(l.dtype==="float16")o=aQ()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(u.length);for(let h=0;h<u.length;h++){const d=u[h];o[h]=Math.round(d*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*c}else if(s==="string"){const l=X(e.shape);o=[];for(let c=0;c<l;c++){const u=new Uint32Array(t.slice(a,a+ka))[0];a+=ka;const h=new Uint8Array(t.slice(a,a+u));o.push(h),a+=u}}else{const l=Ql[s];if(s==="float32")o=new Float32Array(t);else if(s==="int32")o=new Int32Array(t);else if(s==="bool")o=new Uint8Array(t);else if(s==="complex64"){o=new Float32Array(t);const c=new Float32Array(o.length/2),u=new Float32Array(o.length/2);for(let p=0;p<c.length;p++)c[p]=o[p*2],u[p]=o[p*2+1];const h=Ds(c,r,"float32"),d=Ds(u,r,"float32"),f=go(h,d);return h.dispose(),d.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*l}return Ds(o,r,s)}async function oD(e,t,n){let s=new Uint8Array(t);for(;s.byteLength<n;){const{done:r,value:i}=await e.read();if(r&&i==null){const a=n-s.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(s.length+i.byteLength);o.set(s,0),o.set(new Uint8Array(i),s.length),s=o}return s.buffer}async function Q4(e,t){const n={},s=e.getReader();let r=new ArrayBuffer(0);for(const i of t){const o=await tQ(i,async(c,u)=>(r=await oD(s,r,u),r.slice(c,u)));r=await oD(s,r,o);const a=r.slice(0,o);r=r.slice(o);const l=Z4(i,a);if(n[i.name]=l,Y4()==="webgpu"){const c=FI();"uploadToGPU"in c&&X(l.shape)>=H().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return n}function eQ(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(i=>{if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(t);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const MI=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function aD(e){return MI?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function nQ(e){if(MI)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let s=0,r=t.length;s<r;s++)n+=String.fromCharCode(t[s]);return btoa(n)}function sQ(e){if(MI){const s=Buffer.from(e,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let s=0;s<t.length;++s)n.set([t.charCodeAt(s)],s);return n.buffer}function J4(e){return ti.join(e)}function lD(e){const t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);const n=e.split(t);return n[n.length-1]}function tz(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function zI(e,t,n){const s={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(s.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=t,s.weightData=n}return e.signature!=null&&(s.signature=e.signature),e.userDefinedMetadata!=null&&(s.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(s.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(s.initializerSignature=e.initializerSignature),s}async function BI(e,t){let n,s;return e.weightsManifest!=null&&([n,s]=await t(e.weightsManifest)),zI(e,n,s)}function eg(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:aD(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:aD(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new ti(e.weightData).byteLength}}function Iy(e){const t=[];for(const n of e)t.push(...n.weights);return t}function rQ(){const e=n=>{let s=n<<13,r=0;for(;!(s&8388608);)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function iQ(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function oQ(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function aQ(){const e=rQ(),t=iQ(),n=oQ();return s=>{const r=new ArrayBuffer(4*s.length),i=new Uint32Array(r);for(let o=0;o<s.length;o++){const a=s[o],l=e[n[a>>10]+(a&1023)]+t[a>>10];i[o]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class we{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return we.instance==null&&(we.instance=new we),we.instance}static registerSaveRouter(t){we.getInstance().saveRouters.push(t)}static registerLoadRouter(t){we.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return we.getHandlers(t,"save")}static getLoadHandlers(t,n){return we.getHandlers(t,"load",n)}static getHandlers(t,n,s){const r=[];return(n==="load"?we.getInstance().loadRouters:we.getInstance().saveRouters).forEach(o=>{const a=o(t,s);a!==null&&r.push(a)}),r}}const lQ=e=>we.registerSaveRouter(e),cQ=e=>we.registerLoadRouter(e),ez=e=>we.getSaveHandlers(e),nz=(e,t)=>we.getLoadHandlers(e,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sk="tensorflowjs",rk=1,Il="models_store",qo="model_info_store";function sz(){if(!H().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function ik(e){const t=e.result;t.createObjectStore(Il,{keyPath:"modelPath"}),t.createObjectStore(qo,{keyPath:"modelPath"})}class Jl{constructor(t){if(this.indexedDB=sz(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((s,r)=>{const i=this.indexedDB.open(sk,rk);i.onupgradeneeded=()=>ik(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(Il,"readonly"),c=a.objectStore(Il).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=ti.join(n.weightData);const a=eg(n),l=o.transaction(qo,"readwrite");let c=l.objectStore(qo),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return r(d)}let h;u.onsuccess=()=>{h=o.transaction(Il,"readwrite");const d=h.objectStore(Il);let f;try{f=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(qo);const g=c.delete(this.modelPath);g.onsuccess=()=>(o.close(),r(f.error)),g.onerror=m=>(o.close(),r(f.error))}},u.onerror=d=>(o.close(),r(u.error)),l.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}Jl.URL_SCHEME="indexeddb://";const rz=e=>H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Jl.URL_SCHEME)?uQ(e.slice(Jl.URL_SCHEME.length)):null;we.registerSaveRouter(rz);we.registerLoadRouter(rz);function uQ(e){return new Jl(e)}function hQ(e){return e.startsWith(Jl.URL_SCHEME)?e.slice(Jl.URL_SCHEME.length):e}class dQ{constructor(){this.indexedDB=sz()}async listModels(){return new Promise((t,n)=>{const s=this.indexedDB.open(sk,rk);s.onupgradeneeded=()=>ik(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(qo,"readonly"),a=i.objectStore(qo).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;t(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(t){return t=hQ(t),new Promise((n,s)=>{const r=this.indexedDB.open(sk,rk);r.onupgradeneeded=()=>ik(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(qo,"readwrite"),a=o.objectStore(qo),l=a.get(t);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const u=a.delete(t),h=()=>{c=i.transaction(Il,"readwrite");const f=c.objectStore(Il).delete(t);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=h,u.onerror=d=>(h(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gi="/",Xc="tensorflowjs_models",iz="info",fQ="model_topology",pQ="weight_specs",mQ="weight_data",gQ="model_metadata";function oz(e){return{info:[Xc,e,iz].join(Gi),topology:[Xc,e,fQ].join(Gi),weightSpecs:[Xc,e,pQ].join(Gi),weightData:[Xc,e,mQ].join(Gi),modelMetadata:[Xc,e,gQ].join(Gi)}}function az(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function xQ(e){const t=e.split(Gi);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Gi)}function yQ(e){return e.startsWith(tc.URL_SCHEME)?e.slice(tc.URL_SCHEME.length):e}class tc{constructor(t){if(!H().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=oz(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),r=eg(t),i=ti.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,nQ(i));const o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw az(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=sQ(o),n}}tc.URL_SCHEME="localstorage://";const lz=e=>H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(tc.URL_SCHEME)?bQ(e.slice(tc.URL_SCHEME.length)):null;we.registerSaveRouter(lz);we.registerLoadRouter(lz);function bQ(e){return new tc(e)}class vQ{constructor(){T(H().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=Xc+Gi,s=Gi+iz;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=xQ(i);t[o]=JSON.parse(this.LS.getItem(i))}}return t}async removeModel(t){t=yQ(t);const n=oz(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(n.info));return az(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Su="://";class Un{constructor(){this.managers={}}static getInstance(){return Un.instance==null&&(Un.instance=new Un),Un.instance}static registerManager(t,n){T(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(Su)&&(t=t.slice(0,t.indexOf(Su))),T(t.length>0,()=>"scheme must not be an empty string.");const s=Un.getInstance();T(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=n}static getManager(t){const n=Un.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(Un.getInstance().managers)}}function ix(e){if(e.indexOf(Su)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Un.getSchemes().join(",")}`);return{scheme:e.split(Su)[0],path:e.split(Su)[1]}}async function cz(e,t,n=!1){T(e!==t,()=>`Old path and new path are the same: '${e}'`);const s=we.getLoadHandlers(e);T(s.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),T(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${e}.`);const r=s[0],i=we.getSaveHandlers(t);T(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),T(i.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${t}.`);const o=i[0],a=ix(e).scheme,l=ix(e).path,c=a===ix(e).scheme,u=await r.load();n&&c&&await Un.getManager(a).removeModel(l);const h=await o.save(u);return n&&!c&&await Un.getManager(a).removeModel(l),h.modelArtifactsInfo}async function wQ(){const e=Un.getSchemes(),t={};for(const n of e){const s=await Un.getManager(n).listModels();for(const r in s){const i=n+Su+r;t[i]=s[r]}}return t}async function SQ(e){const t=ix(e);return Un.getManager(t.scheme).removeModel(t.path)}async function kQ(e,t){return cz(e,t,!1)}async function CQ(e,t){return cz(e,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IQ{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!H().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return R4(t)}}if(H().get("IS_BROWSER")){H().setPlatform("browser",new IQ);try{Un.registerManager(tc.URL_SCHEME,new vQ)}catch{}try{Un.registerManager(Jl.URL_SCHEME,new dQ)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TQ={importFetch:()=>require("node-fetch")};let a2;class NQ{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return H().global.fetch!=null?H().global.fetch(t,n):(a2==null&&(a2=TQ.importFetch()),a2(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}H().get("IS_NODE")&&!H().get("IS_BROWSER")&&H().setPlatform("node",new NQ);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Et(e,t="float32",n){return t=t||"float32",Ms(e),new Xe(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(e,t){const n=_(e,"x","cast");if(!S4(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:t};return D.runKernel(gh,s,r)}const ot=O({cast_:_Q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(e){const n={x:_(e,"x","clone","string_or_numeric")};return D.runKernel($h,n)}const yi=O({clone_:$Q});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VI(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q4();const EQ={buffer:Et,cast:ot,clone:yi,print:VI};$Z(EQ);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(e,t){let n=_(e,"a","add"),s=_(t,"b","add");[n,s]=Te(n,s);const r={a:n,b:s};return D.runKernel(_c,r)}const tt=O({add_:AQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RQ(e,t){let n=_(e,"a","floorDiv"),s=_(t,"b","floorDiv");[n,s]=Te(n,s);const r={a:n,b:s};return D.runKernel(Nh,r)}const Zb=O({floorDiv_:RQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DQ(e,t){let n=_(e,"a","div"),s=_(t,"b","div");if([n,s]=Te(n,s),n.dtype==="int32"&&s.dtype==="int32")return Zb(n,s);const r={a:n,b:s},i={};return D.runKernel(wh,r,i)}const gt=O({div_:DQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OQ(e,t){let n=_(e,"a","mul"),s=_(t,"b","mul");[n,s]=Te(n,s);const r={a:n,b:s};return D.runKernel(Mh,r)}const M=O({mul_:OQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(e){const t=_(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return D.runKernel(om,n)}else{const n={x:t};return D.runKernel(Zp,n)}}const je=O({abs_:PQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQ(e){const n={x:_(e,"x","acos")};return D.runKernel(ch,n)}const WI=O({acos_:FQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LQ(e){const n={x:_(e,"x","acosh")};return D.runKernel(uh,n)}const UI=O({acosh_:LQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(e){T(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),T(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);const t=e.map((r,i)=>_(r,`tensors${i}`,"addN")),n=t[0];t.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(r=>{if(!Pt(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=t;return D.runKernel(Qp,s)}const uz=O({addN_:MQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zQ(e,t=null,n=!1){const r={x:_(e,"x","all","bool")},i={axis:t,keepDims:n};return D.runKernel(U1,r,i)}const Qb=O({all_:zQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(e,t=null,n=!1){const r={x:_(e,"x","any","bool")},i={axis:t,keepDims:n};return D.runKernel(j1,r,i)}const vp=O({any_:BQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQ(e,t=0){const s={x:_(e,"x","argMax")},r={axis:t};return D.runKernel(Jp,s,r)}const ec=O({argMax_:VQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(e,t=0){const s={x:_(e,"x","argMin")},r={axis:t};return D.runKernel(tm,s,r)}const jI=O({argMin_:WQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UQ(e){const n={x:_(e,"x","asin")};return D.runKernel(hh,n)}const GI=O({asin_:UQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jQ(e){const n={x:_(e,"x","asinh")};return D.runKernel(dh,n)}const HI=O({asinh_:jQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ(e){const n={x:_(e,"x","atan")};return D.runKernel(fh,n)}const KI=O({atan_:GQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HQ(e,t){let n=_(e,"a","atan2"),s=_(t,"b","atan2");[n,s]=Te(n,s);const r={a:n,b:s};return D.runKernel(mh,r)}const qI=O({atan2_:HQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KQ(e){const n={x:_(e,"x","atanh")};return D.runKernel(ph,n)}const XI=O({atanh_:KQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ng(e,t,n,s,r="NHWC",i){const o=e[3],a=[...t,o],l=Co(r);return gn(e,a,n,i,s,null,null,l)}function Nr(e,t,n,s,r,i,o="channelsLast"){const[a,l]=wp(t);let c;if(o==="channelsLast")c=[a,l,e[3],e[3]];else if(o==="channelsFirst")c=[a,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${o}`);return gn(e,c,n,s,r,i,!1,o)}function ko(e,t,n,s,r,i,o="NDHWC"){const[a,l,c]=ok(t);let u,h;if(o==="NDHWC")h="channelsLast",u=[a,l,c,e[4],e[4]];else if(o==="NCDHW")h="channelsFirst",u=[a,l,c,e[1],e[1]];else throw new Error(`Unknown dataFormat ${o}`);return Wa(e,u,n,s,r,!1,h,i)}function gn(e,t,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,h]=e;else if(a==="channelsFirst")[l,h,c,u]=e;else throw new Error(`Unknown dataFormat ${a}`);const[d,f,,p]=t,[g,m]=wp(n),[x,y]=wp(s),b=ku(d,x),v=ku(f,y),{padInfo:w,outHeight:k,outWidth:I}=YQ(r,c,u,g,m,b,v,i,a),C=o?p*h:p;let N;return a==="channelsFirst"?N=[l,C,k,I]:a==="channelsLast"&&(N=[l,k,I,C]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:h,outHeight:k,outWidth:I,outChannels:C,padInfo:w,strideHeight:g,strideWidth:m,filterHeight:d,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:v,dilationHeight:x,dilationWidth:y,inShape:e,outShape:N,filterShape:t}}function Wa(e,t,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,h,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,h,d]=e;else if(o==="channelsFirst")[l,d,c,u,h]=e;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,g,,m]=t,[x,y,b]=ok(n),[v,w,k]=ok(s),I=ku(f,v),C=ku(p,w),N=ku(g,k),{padInfo:$,outDepth:A,outHeight:R,outWidth:z}=ZQ(r,c,u,h,x,y,b,I,C,N,a),U=i?m*d:m;let F;return o==="channelsFirst"?F=[l,U,A,R,z]:o==="channelsLast"&&(F=[l,A,R,z,U]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:h,inChannels:d,outDepth:A,outHeight:R,outWidth:z,outChannels:U,padInfo:$,strideDepth:x,strideHeight:y,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:g,effectiveFilterDepth:I,effectiveFilterHeight:C,effectiveFilterWidth:N,dilationDepth:v,dilationHeight:w,dilationWidth:k,inShape:e,outShape:F,filterShape:t}}function qQ(e,t,n,s,r){s==null&&(s=YI(e,t,n));const i=e[0],o=e[1],a=Sp((i-t+2*s)/n+1,r),l=Sp((o-t+2*s)/n+1,r);return[a,l]}function XQ(e,t,n,s,r,i){r==null&&(r=YI(e,t[0],s[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)e[a]+2*r>=t[a]&&(o[a]=Sp((e[a]-t[a]+2*r)/s[a]+1,i));return o}function YI(e,t,n,s=1){const r=ku(t,s);return Math.floor((e[0]*(n-1)-n+r)/2)}function wp(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function ok(e){return typeof e=="number"?[e,e,e]:e}function ku(e,t){return t<=1?e:e+(e-1)*(t-1)}function YQ(e,t,n,s,r,i,o,a,l){let c,u,h;if(typeof e=="number"){c={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const f=qQ([t,n],i,s,e,a);u=f[0],h=f[1]}else if(e==="same"){u=Math.ceil(t/s),h=Math.ceil(n/r);const d=Math.max(0,(u-1)*s+i-t),f=Math.max(0,(h-1)*r+o-n),p=Math.floor(d/2),g=d-p,m=Math.floor(f/2),x=f-m;c={top:p,bottom:g,left:m,right:x,type:"SAME"}}else if(e==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-i+1)/s),h=Math.ceil((n-o+1)/r);else if(typeof e=="object"){const d=l==="channelsLast"?e[1][0]:e[2][0],f=l==="channelsLast"?e[1][1]:e[2][1],p=l==="channelsLast"?e[2][0]:e[3][0],g=l==="channelsLast"?e[2][1]:e[3][1];c={top:d,bottom:f,left:p,right:g,type:d===0&&f===0&&p===0&&g===0?"VALID":"EXPLICIT"},u=Sp((t-i+d+f)/s+1,a),h=Sp((n-o+p+g)/r+1,a)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outHeight:u,outWidth:h}}function ZQ(e,t,n,s,r,i,o,a,l,c,u){let h,d,f,p;if(e==="valid"&&(e=0),typeof e=="number"){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const m=XQ([t,n,s,1],[a,l,c],1,[r,i,o],e,u);d=m[0],f=m[1],p=m[2]}else if(e==="same"){d=Math.ceil(t/r),f=Math.ceil(n/i),p=Math.ceil(s/o);const g=(d-1)*r+a-t,m=(f-1)*i+l-n,x=(p-1)*o+c-s,y=Math.floor(g/2),b=g-y,v=Math.floor(m/2),w=m-v,k=Math.floor(x/2),I=x-k;h={top:v,bottom:w,left:k,right:I,front:y,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}function Sp(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function Ca(e){const[t,n,s]=wp(e);return t===1&&n===1&&s===1}function _n(e,t){return Ca(e)||Ca(t)}function nc(e){return wp(e).every(t=>t>0)}function Co(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function es(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")T(Zl(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(s=>{s.forEach(r=>{T(Zl(r),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ(e,t){const s={x:_(e,"x","reshape","string_or_numeric")},r={shape:t};return D.runKernel(Bm,s,r)}const V=O({reshape_:QQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQ(e,t,n,s,r){const i=_(e,"x","avgPool","float32"),o=1;T(_n(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),es("avgPool",s,r);const c={x:a},u={filterSize:t,strides:n,pad:s,dimRoundingMode:r};let h=D.runKernel(em,c,u);return h=ot(h,i.dtype),l?V(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const sg=O({avgPool_:JQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tJ(e,t,n,s,r,i="NDHWC"){const o=_(e,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=V(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),T(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),es("avgPool3d",s,r);const c={x:a},u={filterSize:t,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let h=D.runKernel(nm,c,u);return h=ot(h,a.dtype),l?V(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const ZI=O({avgPool3d_:tJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJ(e,t=0){T(e.length>=1,()=>"Pass at least one tensor to concat");const n=bp(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return yi(n[0]);const s=n,r={axis:t};return D.runKernel(am,s,r)}const Me=O({concat_:eJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nJ(e,t,n=!1,s=!1){let r=_(e,"a","matMul"),i=_(t,"b","matMul");[r,i]=Te(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return D.runKernel(sm,o,a)}const Rt=O({matMul_:nJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sJ(e){const n={x:_(e,"x","sigmoid","float32")};return D.runKernel(Xh,n)}const jr=O({sigmoid_:sJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rJ(e,t,n){const s=_(e,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:t,size:n};return D.runKernel(Gm,r,i)}const zt=O({slice_:rJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iJ(e){const n={x:_(e,"x","tanh","float32")};return D.runKernel(ed,n)}const Ia=O({tanh_:iJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oJ(e,t,n,s,r,i){const o=_(e,"forgetBias","basicLSTMCell"),a=_(t,"lstmKernel","basicLSTMCell"),l=_(n,"lstmBias","basicLSTMCell"),c=_(s,"data","basicLSTMCell"),u=_(r,"c","basicLSTMCell"),h=_(i,"h","basicLSTMCell"),d=Me([c,h],1),f=Rt(d,a),p=tt(f,l),g=p.shape[0],m=p.shape[1]/4,x=[g,m],y=zt(p,[0,0],x),b=zt(p,[0,m],x),v=zt(p,[0,m*2],x),w=zt(p,[0,m*3],x),k=tt(M(jr(y),Ia(b)),M(u,jr(tt(o,v)))),I=M(Ia(k),jr(w));return[k,I]}const hz=O({basicLSTMCell_:oJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aJ(e,t,n){const s=_(e,"x","batchToSpaceND"),r=t.reduce((a,l)=>a*l);T(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),T(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),T(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${r}`);const i={x:s},o={blockShape:t,crops:n};return D.runKernel(rm,i,o)}const rg=O({batchToSpaceND_:aJ});function lJ(e){let t;return e.rank===0||e.rank===1?t=V(e,[1,1,1,e.size]):e.rank===2?t=V(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cJ(e,t,n,s,r,i){i==null&&(i=.001);const o=_(e,"x","batchNorm"),a=_(t,"mean","batchNorm"),l=_(n,"variance","batchNorm");let c;r!=null&&(c=_(r,"scale","batchNorm"));let u;s!=null&&(u=_(s,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:lJ(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=D.runKernel(gm,d,f);return V(p,o.shape)}const rd=O({batchNorm_:cJ});function uJ(e,t,n,s,r,i){const o=_(e,"x","batchNorm"),a=_(t,"mean","batchNorm"),l=_(n,"variance","batchNorm");let c;r!=null&&(c=_(r,"scale","batchNorm"));let u;return s!=null&&(u=_(s,"offset","batchNorm")),T(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),T(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),rd(o,a,l,u,c,i)}const QI=O({batchNorm2d_:uJ});function hJ(e,t,n,s,r,i){const o=_(e,"x","batchNorm"),a=_(t,"mean","batchNorm"),l=_(n,"variance","batchNorm");let c;r!=null&&(c=_(r,"scale","batchNorm"));let u;return s!=null&&(u=_(s,"offset","batchNorm")),T(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),T(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),rd(o,a,l,u,c,i)}const JI=O({batchNorm3d_:hJ});function dJ(e,t,n,s,r,i){const o=_(e,"x","batchNorm"),a=_(t,"mean","batchNorm"),l=_(n,"variance","batchNorm");let c;r!=null&&(c=_(r,"scale","batchNorm"));let u;return s!=null&&(u=_(s,"offset","batchNorm")),T(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),T(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),rd(o,a,l,u,c,i)}const tT=O({batchNorm4d_:dJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fJ(e,t,n){const s=_(e,"x","bincount"),r=_(t,"weights","bincount");T(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return D.runKernel(K1,i,o)}const eT=O({bincount_:fJ});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pJ(e,t){const n=_(e,"x","bitwiseAnd"),s=_(t,"y","bitwiseAnd");if(!Pt(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return D.runKernel(im,r)}const dz=O({bitwiseAnd_:pJ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mJ(e,t){const n=_(e,"s0","broadcastArgs","int32"),s=_(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return D.runKernel(q1,r)}const fz=O({broadcastArgs_:mJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gJ(e,t){let n=_(e,"broadcastTo","x");const s=n.shape;if(Ms(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const c=n.shape.slice();for(;c.length<t.length;)c.unshift(1);n=V(n,c)}const r=n.shape,i=Array.from(t);for(let c=t.length-1;c>=0;c--)if(r[c]===t[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return yi(n);const a={x:n},l={reps:i};return D.runKernel(nd,a,l)}const Ol=O({broadcastTo_:gJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(e){const n={x:_(e,"x","ceil","float32")};return D.runKernel(xh,n)}const nT=O({ceil_:xJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ec(e,t,n){Ms(e),n=n||Tc(t);const s={shape:e,value:t,dtype:n};return D.runKernel(ub,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yJ(e,t,n){const s=_(e,"x","clipByValue");if(T(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return Ec(s.shape,t,s.dtype);const r={x:s},i={clipValueMin:t,clipValueMax:n};return D.runKernel(yh,r,i)}const fs=O({clipByValue_:yJ});function bJ(e){return Me(e,0)}const sT=O({concat1d_:bJ});function vJ(e,t){return Me(e,t)}const rT=O({concat2d_:vJ});function wJ(e,t){return Me(e,t)}const iT=O({concat3d_:wJ});function SJ(e,t){return Me(e,t)}const oT=O({concat4d_:SJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kJ(e,t,n,s,r="NHWC",i=[1,1],o){const a=_(e,"x","conv2d","float32"),l=_(t,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),es("conv2d",s,o);const h=r==="NHWC"?c.shape[3]:c.shape[1];T(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),T(_n(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),T(nc(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),T(nc(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=D.runKernel(lm,d,f);return u?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const xo=O({conv2d_:kJ});function CJ(e,t,n,s,r="NWC",i=1,o){const a=_(e,"x","conv1d"),l=_(t,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=V(a,[1,a.shape[0],a.shape[1]])),T(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),T(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),es("conv1d",s,o),T(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(_n(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),T(nc(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),T(nc(n),()=>"Error in conv1D: Stride should be larger than 0."),T(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const h=V(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=V(c,[c.shape[0],1,c.shape[1],c.shape[2]]),m=xo(d,h,[1,n],s,"NHWC",[1,i],o);return u?V(m,[m.shape[2],m.shape[3]]):V(m,[m.shape[0],m.shape[2],m.shape[3]])}const Jb=O({conv1d_:CJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(e,t,n,s,r,i="NHWC",o){T(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,l=t,c=!1;t.rank===3&&(c=!0,l=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,e[0],e[1],e[2]]),T(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],h=i==="NHWC"?l.shape[3]:l.shape[1];T(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),T(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),es("conv2dDerInput",r,o);const d={dy:l,filter:n},f={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},p=D.runKernel(cm,d,f);return c?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const aT=O({conv2DBackpropInput_:IJ});function TJ(e,t,n,s,r,i){const o=_(e,"x","conv2dTranspose"),a=_(t,"filter","conv2dTranspose");return aT(n,o,a,s,r,"NHWC",i)}const tv=O({conv2dTranspose_:TJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NJ(e,t,n,s,r="NDHWC",i=[1,1,1]){const o=_(e,"x","conv3d"),a=_(t,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=V(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(_n(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),T(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),T(nc(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),T(nc(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},h={strides:n,pad:s,dataFormat:r,dilations:i},d=D.runKernel(um,u,h);return c?V(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const lT=O({conv3d_:NJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _J(e,t,n,s,r){T(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let i=e,o=t,a=!1;t.rank===4&&(a=!0,o=V(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);const l=i[4],c=o.shape[4];T(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),T(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),T(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),T(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),T(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},h={pad:r,strides:s,inputShape:i},d=D.runKernel(Q1,u,h);return a?V(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const pz=O({conv3DBackpropInput_:_J});function $J(e,t,n,s,r){const i=_(e,"x","conv3dTranspose"),o=_(t,"filter","conv3dTranspose");return pz(n,i,o,s,r)}const cT=O({conv3dTranspose_:$J});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJ(e){const n={x:_(e,"x","cos","float32")};return D.runKernel(bh,n)}const ig=O({cos_:EJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(e){const n={x:_(e,"x","cosh","float32")};return D.runKernel(vh,n)}const ev=O({cosh_:AJ});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RJ(e,t=0,n=!1,s=!1){const i={x:_(e,"x","cumprod")},o={axis:t,exclusive:n,reverse:s};return D.runKernel(J1,i,o)}const kp=O({cumprod_:RJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DJ(e,t=0,n=!1,s=!1){const i={x:_(e,"x","cumsum")},o={axis:t,exclusive:n,reverse:s};return D.runKernel(hm,i,o)}const nv=O({cumsum_:DJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OJ(e,t,n,s=!1){const r=_(e,"x","denseBincount"),i=_(t,"weights","denseBincount");T(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),T(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return D.runKernel(eb,o,a)}const Ty=O({denseBincount_:OJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PJ(e,t,n="NHWC"){const s=_(e,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];T(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),T(r*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${t}  for depthToSpace with input shape
    ${s.shape}`),T(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t} for depthToSpace with input shape
        ${s.shape}`),T(o%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:t,dataFormat:n};return D.runKernel(nb,a,l)}const uT=O({depthToSpace_:PJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FJ(e,t,n,s,r="NHWC",i=[1,1],o){const a=_(e,"x","depthwiseConv2d","float32"),l=_(t,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=r==="NHWC"?c.shape[3]:c.shape[1];T(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),es("depthwiseConv2d",s,o);const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=D.runKernel(dm,d,f);return u?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const id=O({depthwiseConv2d_:FJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LJ(e){const n={x:_(e,"x","diag")};return D.runKernel(ib,n)}const mz=O({diag_:LJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MJ(e,t,n,s,r=[1,1],i="NHWC"){const o=_(e,"x","dilation2d"),a=_(t,"filter","dilation2d");T(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),T(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=V(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),T(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},h={strides:n,pad:s,dilations:r},d=D.runKernel(fm,u,h);return c?V(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const hT=O({dilation2d_:MJ});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sc(e,t){const n=e.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=e[i]||1;(t[t.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function Ye(e,t){const n=[];for(let s=0;s<t.length;s++){const r=e[e.length-s-1],i=t.length-s-1,o=t[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function It(e,t){const n=Math.max(e.length,t.length),s=new Array(n);for(let r=0;r<n;r++){let i=e[e.length-r-1];i==null&&(i=1);let o=t[t.length-r-1];if(o==null&&(o=1),i===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(a)}else s[n-r-1]=i}return s}const zJ=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:It,getBroadcastDims:sc,getReductionAxes:Ye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BJ(e,t){let n=_(e,"a","equal","string_or_numeric"),s=_(t,"b","equal","string_or_numeric");[n,s]=Te(n,s),It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(pm,r)}const Os=O({equal_:BJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VJ(e,t,n){const s=_(t,"a","where"),r=_(n,"b","where"),i=_(e,"condition","where","bool"),o=It(It(i.shape,s.shape),r.shape),a=Ol(i,o),l=Ol(s,o),c=Ol(r,o),u={condition:a,t:l,e:c};return D.runKernel(jm,u)}const dn=O({where_:VJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WJ(e){const n={x:_(e,"x","zerosLike")};return D.runKernel(Jm,n)}const Bt=O({zerosLike_:WJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UJ(e,t){let n=_(e,"a","div"),s=_(t,"b","div");[n,s]=Te(n,s);const r=gt(n,s),i=Bt(r),o=Os(s,i);return dn(o,i,r)}const dT=O({divNoNan_:UJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jJ(e,t){const n=_(e,"t1","dot"),s=_(t,"t2","dot");T((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(T(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=V(n,[1,-1]),a=V(s,[-1,1]),l=Rt(o,a);return V(l,[])}else if(n.rank===1&&s.rank===2){const o=V(n,[1,-1]),a=V(s,[s.shape[0],s.shape[1]]),l=Rt(o,a);return V(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=V(s,[-1,1]),a=Rt(n,o);return V(a,[a.size])}else{const o=V(s,[s.shape[0],s.shape[1]]);return Rt(n,o)}}const fT=O({dot_:jJ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GJ(e,...t){const n=t.map((r,i)=>_(r,`tensors${i}`,"einsum")),s={equation:e};return D.runKernel(ab,n,s)}const ml=O({einsum_:GJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HJ(e){const n={x:_(e,"x","elu","float32")};return D.runKernel(Sh,n)}const od=O({elu_:HJ});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KJ(e,t){const n=_(e,"x","ensureShape","string_or_numeric");if(!v4(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}const gz=O({ensureShape_:KJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qJ(e){let t=_(e,"x","erf");T(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=ot(t,"float32"));const n={x:t};return D.runKernel(kh,n)}const sv=O({erf_:qJ});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pT(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function xz(e,t,n){const s=e.length+t.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(e[i++]):r.push(t[o++]);return r}function xn(e,t){const n=[],s=e.length;for(let i=0;i<s;i++)t.indexOf(i)===-1&&n.push(e[i]);const r=t.map(i=>e[i]);return[n,r]}function ze(e,t){const n=t.map(s=>1);return xz(e,n,t)}function $n(e,t,n){T(pT(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function Ne(e,t){if(pT(e,t))return null;const n=[];for(let s=0;s<t;++s)e.indexOf(s)===-1&&n.push(s);return e.forEach(s=>n.push(s)),n}function Ua(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function Be(e,t){const n=[];for(let s=t-e;s<t;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XJ(e,t=null,n=!1){const r={x:_(e,"x","max")},i={reductionIndices:t,keepDims:n};return D.runKernel(Tm,r,i)}const tr=O({max_:XJ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJ(e,t=null,n=!1){const r={x:_(e,"x","min")},i={axis:t,keepDims:n};return D.runKernel(Em,r,i)}const Wu=O({min_:YJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(e,t){let n=_(e,"base","pow"),s=_(t,"exp","pow");[n,s]=Te(n,s);const r={a:n,b:s};return D.runKernel(zh,r)}const Ti=O({pow_:ZJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yt(e,t){if((Ze(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ze(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Va(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QJ(e){const n={x:_(e,"x","sqrt","float32")};return D.runKernel(Zh,n)}const pn=O({sqrt_:QJ});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JJ(e){const t=_(e,"x","square"),n={};return D.runKernel("Square",{x:t},n)}const ee=O({square_:JJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ttt(e,t=null,n=!1){let s=_(e,"x","sum");s.dtype==="bool"&&(s=ot(s,"int32"));const r={x:s},i={axis:t,keepDims:n};return D.runKernel(Hm,r,i)}const ft=O({sum_:ttt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ett(e,t="euclidean",n=null,s=!1){e=_(e,"x","norm");const r=yz(e,t,n);let i=r.shape;if(s){const o=Dt(n,e.shape);i=ze(r.shape,o)}return V(r,i)}function yz(e,t,n=null){if(e.rank===0)return je(e);if(e.rank!==1&&n===null)return yz(V(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return ft(je(e),n);if(t===1/0)return tr(je(e),n);if(t===-1/0)return Wu(je(e),n);if(t==="euclidean"||t===2)return pn(ft(Ti(je(e),yt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return tr(ft(je(e),n[0]),n[1]-1);if(t===1/0)return tr(ft(je(e),n[1]),n[0]);if(t===-1/0)return Wu(ft(je(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return pn(ft(ee(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const ad=O({norm_:ett});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ntt(e,t=null,n=!1){return ad(e,"euclidean",t,n)}const mT=O({euclideanNorm_:ntt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function stt(e){const n={x:_(e,"x","exp")};return D.runKernel(Ch,n)}const ps=O({exp_:stt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rtt(e,t=0){const n=_(e,"x","expandDims","string_or_numeric");T(t<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:t};return D.runKernel(mm,s,r)}const wn=O({expandDims_:rtt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function itt(e){const n={x:_(e,"x","expm1")};return D.runKernel(Ih,n)}const gT=O({expm1_:itt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ott(e,t){const n=_(e,"x","tile","string_or_numeric");T(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const s={x:n},r={reps:t};return D.runKernel(nd,s,r)}const Xs=O({tile_:ott});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function att(e,t,n,s="float32"){t==null&&(t=e);const r=Et([e,t],s),i=e<=t?e:t;for(let a=0;a<i;++a)r.set(1,a,a);const o=V(r.toTensor(),[e,t]);if(n==null)return o;if(n.length===1)return Xs(wn(o,0),[n[0],1,1]);if(n.length===2)return Xs(wn(wn(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Xs(wn(wn(wn(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const rv=O({eye_:att});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ltt(e){const n={x:_(e,"x","floor","float32")};return D.runKernel(Th,n)}const ld=O({floor_:ltt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ctt(e,t,n=0,s=0){const r=_(e,"x","gather"),i=_(t,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return D.runKernel(xm,o,a)}const cd=O({gather_:ctt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function utt(e,t){let n=_(e,"a","greater","string_or_numeric"),s=_(t,"b","greater","string_or_numeric");[n,s]=Te(n,s),It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(ym,r)}const ns=O({greater_:utt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function htt(e,t){let n=_(e,"a","greaterEqual","string_or_numeric"),s=_(t,"b","greaterEqual","string_or_numeric");[n,s]=Te(n,s),It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(_h,r)}const Io=O({greaterEqual_:htt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dtt(e){const n={input:_(e,"input","imag")};return D.runKernel(pb,n)}const og=O({imag_:dtt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ftt(e){const n={x:_(e,"x","isFinite")};return D.runKernel(Eh,n)}const xT=O({isFinite_:ftt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ptt(e){const n={x:_(e,"x","isInf")};return D.runKernel(Ah,n)}const yT=O({isInf_:ptt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mtt(e){const n={x:_(e,"x","isNaN")};return D.runKernel(Rh,n)}const bT=O({isNaN_:mtt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gtt(e,t=.2){const s={x:_(e,"x","leakyRelu")},r={alpha:t};return D.runKernel(bm,s,r)}const ag=O({leakyRelu_:gtt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xtt(e,t){let n=_(e,"a","less","string_or_numeric"),s=_(t,"b","less","string_or_numeric");[n,s]=Te(n,s),It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(vm,r)}const Uu=O({less_:xtt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ytt(e,t){let n=_(e,"a","lessEqual","string_or_numeric"),s=_(t,"b","lessEqual","string_or_numeric");[n,s]=Te(n,s),It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(wm,r)}const ja=O({lessEqual_:ytt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:e,stop:t,num:n};return D.runKernel(mb,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function btt(e,t=5,n=1,s=1,r=.5){const i=_(e,"x","localResponseNormalization");T(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),T(Zl(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=V(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:t,bias:n,alpha:s,beta:r},u=D.runKernel(Im,l,c);return a?V(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const vT=O({localResponseNormalization_:btt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vtt(e){const n={x:_(e,"x","log","float32")};return D.runKernel(Dh,n)}const Ps=O({log_:vtt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wtt(e){const n={x:_(e,"x","log1p")};return D.runKernel(Oh,n)}const lg=O({log1p_:wtt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Stt(e){return T(Sa(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{const s=_(t,"x","tf.grad","string_or_numeric"),r=n!=null?_(n,"dy","tf.grad"):null;return D.tidy(()=>{const{value:i,grads:o}=D.gradients(()=>e(s),[s],r);return r!=null&&Nn(i.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),iv(o),o[0]})}}function ktt(e){return T(Sa(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{T(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=bp(t,"args","tf.grads","string_or_numeric"),r=n!=null?_(n,"dy","tf.grads"):null;return D.tidy(()=>{const{value:i,grads:o}=D.gradients(()=>e(...s),s,r);return r!=null&&Nn(i.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),iv(o),o})}}function Ctt(e){return T(Sa(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{T(t instanceof Ut,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),T(n==null||n instanceof Ut,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=D.gradients(()=>e(t),[t],n);return iv(s),{grad:s[0],value:r}}}function Itt(e){return T(Sa(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{T(Array.isArray(t)&&t.every(r=>r instanceof Ut),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),T(n==null||n instanceof Ut,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=D.gradients(()=>e(...t),t,n);return n!=null&&Nn(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),iv(s.grads),s}}function vz(e,t){T(Sa(e),()=>"The f passed in variableGrads(f) must be a function"),T(t==null||Array.isArray(t)&&t.every(c=>c instanceof yp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const c in D.registeredVariables)t.push(D.registeredVariables[c])}const s=n?t.filter(c=>!c.trainable):null,r=t.length;t=t.filter(c=>c.trainable),T(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=D.gradients(e,t,null,i);T(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return t.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function Ni(e){return D.customGrad(e)}function iv(e){if(e.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ttt(e){const n={x:_(e,"x","neg")};return D.runKernel(Rm,n)}const oe=O({neg_:Ttt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ntt(e){const n={x:_(e,"x","softplus")};return D.runKernel(Yh,n)}const Ac=O({softplus_:Ntt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _tt(e){const t=_(e,"x","logSigmoid");return Ni(s=>({value:oe(Ac(oe(s))),gradFunc:o=>M(o,jr(oe(s)))}))(t)}const wT=O({logSigmoid_:_tt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $tt(e,t){let n=_(e,"a","sub"),s=_(t,"b","sub");[n,s]=Te(n,s);const r={a:n,b:s};return D.runKernel(Jh,r)}const dt=O({sub_:$tt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ett(e,t=-1){const n=_(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Ni((r,i)=>{const a=tr(r,t,!0),l=dt(r,a),c=dt(ot(l,"float32"),Ps(ft(ps(l),t,!0)));return i([c]),{value:c,gradFunc:(h,d)=>{const[f]=d,p=!0,g=ps(f);return dt(h,M(ft(h,t,p),g))}}})(n)}const ov=O({logSoftmax_:Ett});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Att(e,t=null,n=!1){const s=_(e,"x","logSumExp"),r=Dt(t,s.shape),i=tr(s,r,!0),o=dt(s,i),a=ps(o),l=ft(a,r),c=Ps(l),u=tt(V(i,c.shape),c);if(n){const h=ze(u.shape,r);return V(u,h)}return u}const cg=O({logSumExp_:Att});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rtt(e,t){const n=_(e,"a","logicalAnd","bool"),s=_(t,"b","logicalAnd","bool");It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Sm,r)}const Tr=O({logicalAnd_:Rtt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dtt(e){const n={x:_(e,"x","logicalNot","bool")};return D.runKernel(km,n)}const ug=O({logicalNot_:Dtt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ott(e,t){const n=_(e,"a","logicalOr","bool"),s=_(t,"b","logicalOr","bool");It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Cm,r)}const av=O({logicalOr_:Ott});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ptt(e,t){const n=_(e,"a","logicalXor","bool"),s=_(t,"b","logicalXor","bool");return It(n.shape,s.shape),Tr(av(e,t),ug(Tr(e,t)))}const ST=O({logicalXor_:Ptt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f0=2147483648;function Ftt(e,t,n="left"){const s=_(e,"sortedSequence","searchSorted"),r=_(t,"values","searchSorted"),i=s.shape[s.shape.length-1],o=r.shape[r.shape.length-1],a=V(s,[-1,i]),l=V(r,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(X(l.shape)>=f0)throw new Error(`values tensor size must less than ${f0}`);if(a.shape[1]>=f0)throw new Error(`trailing dim_size must less than ${f0} for int32 output type, was ${a.shape[1]}`);const c={sortedSequence:a,values:l},u={side:n};return D.runKernel(Db,c,u)}const lv=O({searchSorted_:Ftt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(e,t){return lv(e,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ltt(e,t,n,s,r){const i=_(e,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(_n(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),es("maxPool",s,r);const c={x:a},u={filterSize:t,strides:n,pad:s,dimRoundingMode:r},h=D.runKernel(Nm,c,u);return l?V(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const hg=O({maxPool_:Ltt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mtt(e,t=[1,1,1],n,s,r,i="NDHWC"){const o=_(e,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=V(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),es("maxPool3d",s,r);const c={x:a},u={filterSize:t,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},h=D.runKernel(_m,c,u);return l?V(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const kT=O({maxPool3d_:Mtt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ztt(e,t,n,s,r=!1){const o={x:_(e,"x","maxPoolWithArgmax")},a={filterSize:t,strides:n,pad:s,includeBatchInIndex:r},l=D.runKernel(bb,o,a);return{result:l[0],indexes:l[1]}}const Sz=O({maxPoolWithArgmax_:ztt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Btt(e,t){let n=_(e,"a","maximum"),s=_(t,"b","maximum");[n,s]=Te(n,s),n.dtype==="bool"&&(n=ot(n,"int32"),s=ot(s,"int32")),It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Ph,r)}const Ei=O({maximum_:Btt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vtt(e,t=null,n=!1){const r={x:_(e,"x","mean")},i={axis:t,keepDims:n};return D.runKernel($m,r,i)}const ke=O({mean_:Vtt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function He(e,t="float32"){if(Ms(e),t==="complex64"){const s=He(e,"float32"),r=He(e,"float32");return go(s,r)}const n=Tn(X(e),t);return D.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ls(e,t="float32"){if(Ms(e),t==="complex64"){const s=ls(e,"float32"),r=He(e,"float32");return go(s,r)}const n=W1(X(e),t);return D.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kz(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let s=_(e,"x","meshgrid",e instanceof Ut?e.dtype:"float32");if(t===void 0)return[s];let r=_(t,"y","meshgrid",t instanceof Ut?t.dtype:"float32");const i=X(s.shape),o=X(r.shape);return n==="xy"?(s=V(s,[1,-1]),r=V(r,[-1,1]),[Rt(ls([o,1],s.dtype),s),Rt(r,ls([1,i],r.dtype))]):(s=V(s,[-1,1]),r=V(r,[1,-1]),[Rt(s,ls([1,o],s.dtype)),Rt(ls([i,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wtt(e,t){let n=_(e,"a","minimum"),s=_(t,"b","minimum");[n,s]=Te(n,s),n.dtype==="bool"&&(n=ot(n,"int32"),s=ot(s,"int32")),It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Fh,r)}const Ta=O({minimum_:Wtt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Utt(e,t,n){T(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=_(e,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)T(t[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),T(t[a][0]>=0&&t[a][0]<=s.shape[a]-r&&t[a][1]>=0&&t[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:t,mode:n},o={x:s};return D.runKernel(Am,o,i)}const CT=O({mirrorPad_:Utt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jtt(e,t){let n=_(e,"a","mod"),s=_(t,"b","mod");[n,s]=Te(n,s);const r={a:n,b:s};return D.runKernel(Lh,r)}const IT=O({mod_:jtt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gtt(e,t=null,n=!1){e=_(e,"x","moments");const s=Dt(t,e.shape),r=ke(e,s,n);let i=r.shape;n||(i=ze(r.shape,s));const o=ee(dt(ot(e,"float32"),V(r,i))),a=ke(o,s,n);return{mean:r,variance:a}}const dg=O({moments_:Gtt});function Htt(e,t,n,s){const r=_(t,"data","multiRNNCell"),i=bp(n,"c","multiRNNCell"),o=bp(s,"h","multiRNNCell");let a=r;const l=[];for(let h=0;h<e.length;h++){const d=e[h](a,i[h],o[h]);l.push(d[0]),l.push(d[1]),a=d[1]}const c=[],u=[];for(let h=0;h<l.length;h+=2)c.push(l[h]),u.push(l[h+1]);return[c,u]}const Cz=O({multiRNNCell_:Htt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ktt(e,t,n,s=!1){const r=_(e,"logits","multinomial"),i=r.size,o=r.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?V(r,[1,-1]):r},c={numSamples:t,seed:n,normalized:s},u=D.runKernel(vb,l,c);return o===1?V(u,[u.size]):u}const Iz=O({multinomial_:Ktt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qtt(e,t){let n=_(e,"a","notEqual","string_or_numeric"),s=_(t,"b","notEqual","string_or_numeric");[n,s]=Te(n,s),It(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Dm,r)}const rc=O({notEqual_:qtt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xtt(e,t,n=1,s=0,r="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const o={indices:_(e,"indices","oneHot","int32")},a={dtype:r,depth:t,onValue:n,offValue:s};return D.runKernel(Pm,o,a)}const ju=O({oneHot_:Xtt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ytt(e){const n={x:_(e,"x","onesLike")};return D.runKernel(Om,n)}const Fs=O({onesLike_:Ytt});function Ztt(e,t){const n=_(e,"v1","outerProduct"),s=_(t,"v2","outerProduct");T(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=V(n,[-1,1]),i=V(s,[1,-1]);return Rt(r,i)}const Tz=O({outerProduct_:Ztt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qtt(e,t,n=0){const s=_(e,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:t,constantValue:n},i={x:s};return D.runKernel(Lm,i,r)}const To=O({pad_:Qtt});function Jtt(e,t,n=0){return T(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),To(e,[t],n)}const Nz=O({pad1d_:Jtt});function tet(e,t,n=0){return T(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),To(e,t,n)}const _z=O({pad2d_:tet});function eet(e,t,n=0){return T(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),To(e,t,n)}const $z=O({pad3d_:eet});function net(e,t,n=0){return T(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),To(e,t,n)}const Ez=O({pad4d_:net});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function set(e,t,n){const s=_(e,"x","spaceToBatchND");T(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),T(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),T(s.shape.reduce((o,a,l)=>l>0&&l<=t.length?o&&(a+n[l-1][0]+n[l-1][1])%t[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const r={x:s},i={blockShape:t,paddings:n};return D.runKernel(Km,r,i)}const fg=O({spaceToBatchND_:set});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ret(e,t,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=_(e,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(_n(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=Nr(l.shape,t,i,r,s),h=[u.dilationHeight,u.dilationWidth];let d;s==="same"?d=oet([u.filterHeight,u.filterWidth],h):d=[[0,0],[0,0]];const f=h[0]===1&&h[1]===1,[p,g]=iet([u.inHeight,u.inWidth],h,d),m=f?s:"valid",x=f?l:fg(l,h,p),b=(n==="avg"?()=>sg(x,t,i,m,o):()=>hg(x,t,i,m,o))(),v=f?b:rg(b,h,g);return c?V(v,[v.shape[1],v.shape[2],v.shape[3]]):v}function iet(e,t,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=e.concat(s,r),o=t.map((u,h)=>(u-i[h]%u)%u),a=r.map((u,h)=>u+o[h]),l=t.map((u,h)=>[s[h],a[h]]),c=t.map((u,h)=>[0,o[h]]);return[l,c]}function oet(e,t){const s=e.map((o,a)=>o+(o-1)*(t[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const TT=O({pool_:ret});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aet(e,t){const n=_(e,"x","prelu"),s=_(t,"alpha","prelu"),r={x:n,alpha:s};return D.runKernel(Mm,r)}const pg=O({prelu_:aet});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cet(e,t=null,n=!1){let s=_(e,"x","prod");s.dtype==="bool"&&(s=ot(s,"int32"));const r={x:s},i={axis:t,keepDims:n};return D.runKernel(zm,r,i)}const NT=O({prod_:cet});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uet(e,t,n,s){const r=e.map((u,h)=>_(u,`tensors${h}`,"raggedGather","int32")),i=_(t,"paramsDenseValues","raggedGather"),o=_(n,"indices","raggedGather","int32"),a={paramsNestedSplits:r,paramsDenseValues:i,indices:o},l={outputRaggedRank:s},c=D.runKernel(Cb,a,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const Az=O({raggedGather_:uet});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function het(e,t,n){const s=_(e,"starts","raggedRange"),r=_(t,"limits","raggedRange",s.dtype),i=_(n,"deltas","raggedRange",s.dtype),o={starts:s,limits:r,deltas:i},a=D.runKernel(Ib,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const Rz=O({raggedRange_:het});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function det(e,t,n,s,r){const i=_(e,"shape","raggedTensorToTensor","int32"),o=_(t,"values","raggedTensorToTensor"),a=_(n,"defaultValue","raggedTensorToTensor",o.dtype),l=s.map((h,d)=>_(h,`tensors${d}`,"raggedTensorToTensor","int32")),c={shape:i,values:o,defaultValue:a,rowPartitionTensors:l},u={rowPartitionTypes:r};return D.runKernel(Tb,c,u)}const Dz=O({raggedTensorToTensor_:det});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fet(e,t,n){Ms(e);const s=X(e);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<s;i++)r[i]=t();return D.makeTensor(r,e,n)}const Oz=O({rand_:fet});var _T={exports:{}};_T.exports;(function(e){(function(t,n,s){function r(l){var c=this,u=a();c.next=function(){var h=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=h|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),h=c&&c.state,d=u.next;return d.int32=function(){return u.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&i(h,u),d.state=function(){return i(u,{})}),d}function a(){var l=4022871197,c=function(u){u=String(u);for(var h=0;h<u.length;h++){l+=u.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(wc,e)})(_T);var pet=_T.exports,$T={exports:{}};$T.exports;(function(e){(function(t,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xor128=o})(wc,e)})($T);var met=$T.exports,ET={exports:{}};ET.exports;(function(e){(function(t,n,s){function r(a){var l=this,c="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xorwow=o})(wc,e)})(ET);var get=ET.exports,AT={exports:{}};AT.exports;(function(e){(function(t,n,s){function r(a){var l=this;l.next=function(){var u=l.x,h=l.i,d,f;return d=u[h],d^=d>>>7,f=d^d<<24,d=u[h+1&7],f^=d^d>>>10,d=u[h+3&7],f^=d^d>>>3,d=u[h+4&7],f^=d^d<<7,d=u[h+7&7],d=d^d<<13,f^=d^d<<9,u[h]=f,l.i=h+1&7,f};function c(u,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],u.x=f,u.i=0,d=256;d>0;--d)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.x&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xorshift7=o})(wc,e)})(AT);var xet=AT.exports,RT={exports:{}};RT.exports;(function(e){(function(t,n,s){function r(a){var l=this;l.next=function(){var u=l.w,h=l.X,d=l.i,f,p;return l.w=u=u+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(u^u>>>16)|0};function c(u,h){var d,f,p,g,m,x=[],y=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,y=Math.max(y,h.length)),p=0,g=-32;g<y;++g)h&&(f^=h.charCodeAt((g+32)%h.length)),g===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(m=m+1640531527|0,d=x[g&127]^=f+m,p=d==0?p+1:0);for(p>=128&&(x[(h&&h.length||0)&127]=-1),p=127,g=4*128;g>0;--g)f=x[p+34&127],d=x[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,x[p]=f^d;u.w=m,u.X=x,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.X&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xor4096=o})(wc,e)})(RT);var yet=RT.exports,DT={exports:{}};DT.exports;(function(e){(function(t,n,s){function r(a){var l=this,c="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.tychei=o})(wc,e)})(DT);var bet=DT.exports,Pz={exports:{}};const vet={},wet=Object.freeze(Object.defineProperty({__proto__:null,default:vet},Symbol.toStringTag,{value:"Module"})),ket=zj(wet);(function(e){(function(t,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,h=r-1,d;function f(v,w,k){var I=[];w=w==!0?{entropy:!0}:w||{};var C=x(m(w.entropy?[v,b(n)]:v??y(),3),I),N=new p(I),$=function(){for(var A=N.g(i),R=l,z=0;A<c;)A=(A+z)*r,R*=r,z=N.g(1);for(;A>=u;)A/=2,R/=2,z>>>=1;return(A+z)/R};return $.int32=function(){return N.g(4)|0},$.quick=function(){return N.g(4)/4294967296},$.double=$,x(b(N.S),n),(w.pass||k||function(A,R,z,U){return U&&(U.S&&g(U,N),A.state=function(){return g(N,{})}),z?(s[a]=A,R):A})($,C,"global"in w?w.global:this==s,w.state)}function p(v){var w,k=v.length,I=this,C=0,N=I.i=I.j=0,$=I.S=[];for(k||(v=[k++]);C<r;)$[C]=C++;for(C=0;C<r;C++)$[C]=$[N=h&N+v[C%k]+(w=$[C])],$[N]=w;(I.g=function(A){for(var R,z=0,U=I.i,F=I.j,P=I.S;A--;)R=P[U=h&U+1],z=z*r+P[h&(P[U]=P[F=h&F+R])+(P[F]=R)];return I.i=U,I.j=F,z})(r)}function g(v,w){return w.i=v.i,w.j=v.j,w.S=v.S.slice(),w}function m(v,w){var k=[],I=typeof v,C;if(w&&I=="object")for(C in v)try{k.push(m(v[C],w-1))}catch{}return k.length?k:I=="string"?v:v+"\0"}function x(v,w){for(var k=v+"",I,C=0;C<k.length;)w[h&C]=h&(I^=w[h&C]*19)+k.charCodeAt(C++);return b(w)}function y(){try{var v;return d&&(v=d.randomBytes)?v=v(r):(v=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(v)),b(v)}catch{var w=t.navigator,k=w&&w.plugins;return[+new Date,t,k,t.screen,b(n)]}}function b(v){return String.fromCharCode.apply(0,v)}if(x(s.random(),n),e.exports){e.exports=f;try{d=ket}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:wc,[],Math)})(Pz);var Cet=Pz.exports,Iet=pet,Tet=met,Net=get,_et=xet,$et=yet,Eet=bet,Rc=Cet;Rc.alea=Iet;Rc.xor128=Tet;Rc.xorwow=Net;Rc.xorshift7=_et;Rc.xor4096=$et;Rc.tychei=Eet;var ud=Rc;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aet=.001,Fz=.1;function Ret(e,t,n){return n==null&&(n=OT()),ak(e,t,(s,r)=>PT(s,r,n))}function OT(){return D.backend.floatPrecision()===32?Aet:Fz}function ak(e,t,n){let s=!0;if((Ze(e)||Ze(t))&&(s=!1),Ze(e)&&Ze(t)&&(s=!0),s){const o=e.constructor.name,a=t.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(e)&&Array.isArray(t)){const o=Ii(e),a=Ii(t);if(!Pt(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const r=Ze(e)?e:Ci(e),i=Ze(t)?t:Ci(t);if(r.length!==i.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${i.length}.
Actual:   ${r}.
Expected: ${i}.`);for(let o=0;o<i.length;++o){const a=r[o],l=i[o];if(!n(a,l))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${l}.
Actual:   ${r}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function Det(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function Oet(e,t){const n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return di(e)||di(e[0])||di(t)||di(t[0])?ak(e,n,(s,r)=>s==r):ak(e,t,(s,r)=>PT(s,r,0))}function Pet(e,t,n){if(n==null&&(n=OT()),!PT(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function PT(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function Fet(e,t,n){for(let s=0;s<e.length;s++)if(e[s]<t||e[s]>n)throw new Error(`Value out of range:${e[s]} low: ${t}, high: ${n}`)}function Let(e,t){const n=new Float32Array(e),s=new Float32Array(t);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let r=0;r<s.length;r++)if(n[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${n[r]} instead`)}function Lz(e){for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(n)?Lz(n):e[t]=xi(n)}return e}function Met(e){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",s=>n(t)),t.load()})}async function zet(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}const Bet=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:Fz,createVideoElement:Met,encodeStrings:Lz,expectArrayBuffersEqual:Let,expectArraysClose:Ret,expectArraysEqual:Oet,expectNumbersClose:Pet,expectPromiseToFail:Det,expectValuesInRange:Fet,play:zet,testEpsilon:OT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FT{constructor(t,n,s,r,i){this.mean=t,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=ud.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let t,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(t))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Vet{constructor(t,n,s,r){this.alpha=t,this.beta=1/n,this.dtype=s;const i=r||Math.random();this.randu=ud.alea(i.toString()),this.randn=new FT(0,1,s,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,s,r,i,o;for(;;){do r=this.randn.nextValue(),o=1+this.c*r;while(o<=0);if(o*=o*o,t=r*r,n=1-.331*t*t,s=.5*t+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<s)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class Wet{constructor(t=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=ud.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uet(e,t,n=1,s="float32",r){if(Ms(e),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const i=new Vet(t,n,s,r),o=Et(e,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Mz=O({randomGamma_:Uet});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jet(e,t=0,n=1,s,r){if(Ms(e),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new FT(t,n,s,!1,r),o=Et(e,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const cv=O({randomNormal_:jet});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Get(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return cv(e,0,1,t,n)}const zz=O({randomStandardNormal_:Get});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Het(e,t=0,n=1,s="float32",r){Ms(e);const i=Et(e,s),o=new Wet(t,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Ga=O({randomUniform_:Het});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ket(e,t,n,s){return Ga(e,t,n,"int32",s)}const Bz=O({randomUniformInt_:Ket});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ic(e,t,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:e,stop:t,step:n,dtype:s};return D.runKernel(Nb,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qet(e){const n={input:_(e,"input","real")};return D.runKernel(_b,n)}const Gu=O({real_:qet});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xet(e){const n={x:_(e,"x","reciprocal")};return D.runKernel(Bh,n)}const LT=O({reciprocal_:Xet});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yet(e){const n={x:_(e,"x","relu")};return D.runKernel(Vh,n)}const ei=O({relu_:Yet});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zet(e){const n={x:_(e,"x","relu6")};return D.runKernel(Wh,n)}const uv=O({relu6_:Zet});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qet(e,t){const s={x:_(e,"x","reverse")},r={dims:t};return D.runKernel(Um,s,r)}const sr=O({reverse_:Qet});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jet(e){const t=_(e,"x","reverse");return T(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),sr(t,0)}const Vz=O({reverse1d_:Jet});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tnt(e,t){const n=_(e,"x","reverse");return T(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),sr(n,t)}const Wz=O({reverse2d_:tnt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ent(e,t){const n=_(e,"x","reverse");return T(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),sr(n,t)}const Uz=O({reverse3d_:ent});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nnt(e,t){const n=_(e,"x","reverse");return T(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),sr(n,t)}const jz=O({reverse4d_:nnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function snt(e){const n={x:_(e,"x","round")};return D.runKernel(Uh,n)}const hv=O({round_:snt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rnt(e){const n={x:_(e,"x","rsqrt","float32")};return D.runKernel(jh,n)}const dv=O({rsqrt_:rnt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function int(e){const n={x:_(e,"x","selu")};return D.runKernel(Gh,n)}const fv=O({selu_:int});function ont(e,t,n,s,r,i=[1,1],o="NHWC"){const a=_(e,"x","separableConv2d"),l=_(t,"depthwiseFilter","separableConv2d"),c=_(n,"pointwiseFilter","separableConv2d");let u=a,h=!1;if(a.rank===3&&(h=!0,u=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),T(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=l.shape[2],f=l.shape[3];T(c.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${c.shape[2]}.`);const p=id(u,l,s,r,o,i),m=xo(p,c,1,"valid",o);return h?V(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const pv=O({separableConv2d_:ont});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ant(e,t){const n=_(e,"x","setdiff1d"),s=_(t,"y","setdiff1d");T(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),T(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),T(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),i=await s.data(),o=new Set(i);let a=0;for(let u=0;u<r.length;u++)o.has(r[u])||a++;const l=new Xe([a],n.dtype),c=new Xe([a],"int32");for(let u=0,h=0;u<r.length;u++)o.has(r[u])||(l.values[h]=r[u],c.values[h]=u,h++);return[l.toTensor(),c.toTensor()]}const Gz=ant;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lnt(e){const n={x:_(e,"x","sign")};return D.runKernel(qh,n)}const MT=O({sign_:lnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cnt(e){const n={x:_(e,"x","sin","float32")};return D.runKernel(Hh,n)}const mv=O({sin_:cnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function unt(e){const n={x:_(e,"x","sinh")};return D.runKernel(Kh,n)}const gv=O({sinh_:unt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hnt(e,t,n){const s=_(e,"x","slice1d");return T(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),zt(s,[t],[n])}const mg=O({slice1d_:hnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dnt(e,t,n){const s=_(e,"x","slice2d");return T(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),zt(s,t,n)}const xv=O({slice2d_:dnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fnt(e,t,n){const s=_(e,"x","slice3d");return T(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),zt(s,t,n)}const gg=O({slice3d_:fnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pnt(e,t,n){const s=_(e,"x","slice4d");return T(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),zt(s,t,n)}const Hu=O({slice4d_:pnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mnt(e,t=-1){const n=_(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const s={logits:n},r={dim:t};return D.runKernel(Xm,s,r)}const xg=O({softmax_:mnt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gnt(e){T(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return D.runKernel(cb,t)}const yg=O({fft_:gnt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xnt(e){T(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return D.runKernel(fb,t)}const Ku=O({ifft_:xnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ynt(e){const t=e.shape[e.shape.length-1],n=e.size/t;let s;if(t<=2){const r=V(e,[n,t]);s=Ku(r)}else{const r=[n,2*(t-1)],i=V(Gu(e),[n,t]),o=V(og(e),[n,t]),a=sr(zt(i,[0,1],[n,t-2]),1),l=M(sr(zt(o,[0,1],[n,t-2]),1),yt(-1)),c=Me([i,a],1),u=Me([o,l],1),h=V(go(c,u),[r[0],r[1]]);s=Ku(h)}if(s=Gu(s),e.rank===3&&e.shape[0]!==0){const r=s,i=e.shape[0];s=V(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const yv=O({irfft_:ynt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bnt(e,t,n=0){const r={x:_(e,"x","split")},i={numOrSizeSplits:t,axis:n};return D.runKernel(qm,r,i)}const us=O({split_:bnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vnt(e,t){T(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const s=e.size/n;let r;if(t!=null&&t<n){const p=e.shape.map(m=>0),g=e.shape.map(m=>m);g[e.shape.length-1]=t,r=zt(e,p,g),n=t}else if(t!=null&&t>n){const p=e.shape.map(g=>g);p[e.shape.length-1]=t-n,r=Me([e,He(p)],e.shape.length-1),n=t}else r=e;const i=Bt(r),o=V(go(r,i),[s,n]),a=yg(o),l=Math.floor(n/2)+1,c=Gu(a),u=og(a),h=us(c,[l,n-l],c.shape.length-1),d=us(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,V(go(h[0],d[0]),f)}const bg=O({rfft_:vnt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wnt(e,t){let n=_(e,"a","squaredDifference"),s=_(t,"b","squaredDifference");[n,s]=Te(n,s),It(n.shape,s.shape);const r={a:n,b:s},i={};return D.runKernel(Qh,r,i)}const bv=O({squaredDifference_:wnt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Snt(e,t){const n=_(e,"x","squeeze","string_or_numeric");return V(n,wo(n.shape,t).newShape)}const Ha=O({squeeze_:Snt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function knt(e,t=0){const n=bp(e,"tensors","stack","string_or_numeric");T(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&T(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:t};return D.runKernel(Fm,s,r)}const Qn=O({stack_:knt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cnt(e,t=0){const s={x:_(e,"x","step")},r={alpha:t};return D.runKernel(sd,s,r)}const Dc=O({step_:Cnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Int(e,t,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:_(e,"x","stridedSlice","string_or_numeric")},h={begin:t,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return D.runKernel(Bb,u,h)}const zT=O({stridedSlice_:Int});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tnt(e){const n={x:_(e,"x","tan","float32")};return D.runKernel(td,n)}const BT=O({tan_:Tnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cn(e,t){Ic(e);const n=Ii(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Va(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ro(e,t,n){if(Ic(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Ii(e,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Va(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VT(e,t,n){if(Ic(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Ii(e,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Va(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(e,t,n){if(Ic(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Ii(e,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Va(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kz(e,t,n){if(Ic(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Ii(e,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Va(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qz(e,t,n){if(Ic(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Ii(e,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||s,Va(e,t,s,n)}function WT(e,t,n){const s=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(e.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+e.length-s)throw new Error(i+` update.rank != ${r+e.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==e[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${e[o+r]})`)}function vv(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}WT(n,t,e)}function Ka(e,t,n){const s=t.shape.length,r=s>1?t.shape[s-1]:1,i=n.length;let o=1;for(let h=r;h<i;++h)o*=n[h];const a=r<1?1:r,l=X(t.shape)/a,c=[...bt(n.slice(0,r)),1],u=X(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}const Nnt=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:Ka,validateInput:vv,validateUpdateShape:WT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _nt(e,t,n){const s=_(e,"tensor","tensorScatterupdate"),r=_(t,"indices","tensorScatterupdate","int32"),i=_(n,"updates","tensorScatterupdate");if(vv(i,r,s.shape),s.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${i.dtype}.`);const o={tensor:s,indices:r,updates:i},a={};return D.runKernel(Rb,o,a)}const Xz=O({tensorScatterUpdate_:_nt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $nt(e,t=1,n=!0){const s=_(e,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${t}`);const i={x:s},o={k:t,sorted:n},[a,l]=D.runKernel(jb,i,o);return{values:a,indices:l}}const UT=O({topk_:$nt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ent(e,t=0,n=1,s,r){if(Ms(e),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new FT(t,n,s,!0,r),o=Et(e,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const wv=O({truncatedNormal_:Ent});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ant(e,t=0){const n=_(e,"x","unique","string_or_numeric");T(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:t},[i,o]=D.runKernel(Hb,s,r);return{values:i,indices:o}}const jT=O({unique_:Ant});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rnt(e,t,n){const s=_(e,"x","unsortedSegmentSum"),r=_(t,"segmentIds","unsortedSegmentSum","int32");T(Zl(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return D.runKernel(Qm,i,o)}const Sv=O({unsortedSegmentSum_:Rnt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dnt(e,t=0){const n=_(e,"x","unstack","string_or_numeric");T(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:t};return D.runKernel(Zm,s,r)}const rr=O({unstack_:Dnt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yz(e,t){return lv(e,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GT(e,t=!0,n,s){return D.makeVariable(e,t,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kv(e,t){const n=[];for(let i=0;i<t.length;i++)t[i]&&n.push(i);const s=Et(e,"int32"),r=Et([n.length,e.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*e.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ont(e){const t=_(e,"condition","whereAsync","bool"),n=await t.data(),s=kv(t.shape,n);return e!==t&&t.dispose(),s}const HT=Ont;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Pnt(e,t,n){const s=_(e,"tensor","boolMask"),r=_(t,"mask","boolMask","bool"),i=n??0,o=r.rank,a=s.shape;T(o>0,()=>"mask cannot be scalar"),Nn(a.slice(i,i+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=i;g<i+o;g++)l*=a[g];const c=a.slice(0,i).concat([l],a.slice(i+o)),u=V(s,c),h=V(r,[-1]),d=await HT(h),f=Ha(d,[1]),p=cd(u,f,i);return e!==s&&s.dispose(),t!==r&&r.dispose(),f.dispose(),u.dispose(),h.dispose(),d.dispose(),p}const Zz=Pnt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fnt(e,t,n){const s=_(e,"x","transpose");if(t==null&&(t=s.shape.map((o,a)=>a).reverse()),T(s.rank===t.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${t}.`),t.forEach(o=>{T(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${t}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:t};return s.dtype==="complex64"?G(()=>{let o=Gu(s),a=og(s);return o=D.runKernel(Dl,{x:o},i),a=D.runKernel(Dl,{x:a},i),n&&(a=oe(a)),go(o,a)}):D.runKernel(Dl,r,i)}const Ft=O({transpose_:Fnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lnt(e,t,n,s,r=!0){const i=_(e,"v","movingAverage"),o=_(t,"x","movingAverage"),a=_(n,"decay","movingAverage");H4(i,o),T(Pt(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=yt(1),c=dt(l,a);let u=M(dt(o,i),c);if(r){T(s!=null,()=>"When using zeroDebias: true, step is required.");const h=_(s,"step","movingAverage");u=gt(u,dt(l,Ti(a,h)))}return tt(i,u)}const Qz=O({movingAverage_:Lnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mnt(e,t,n){Ms(n);const s=_(e,"indices","scatterND","int32"),r=_(t,"updates","scatterND");vv(r,s,n);const i={indices:s,updates:r},o={shape:n};return D.runKernel(Ab,i,o)}const Jz=O({scatterND_:Mnt});function znt(e,t,n,s){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const r=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=t.size;if(!(t.rank===0||t.rank===1&&o===r))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${r}]`);if(t.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bnt(e,t,n,s=0){Ms(n);const r=_(e,"sparseIndices","sparseToDense","int32"),i=_(t,"sparseValues","sparseToDense","string_or_numeric"),o=_(s,"defaultValue","sparseToDense",i.dtype);znt(r,i,n,o);const a={sparseIndices:r,sparseValues:i,defaultValue:o},l={outputShape:n};return D.runKernel(Mb,a,l)}const tB=O({sparseToDense_:Bnt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vnt(e,t){const n=_(t,"indices","gatherND","int32"),r={params:_(e,"x","gatherND","string_or_numeric"),indices:n};return D.runKernel(db,r)}const eB=O({gatherND_:Vnt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wnt(e,t){if(t==null)return e.shape.slice();if(Pt(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let s=0;s<e.shape.length;s++)t[s]==null&&e.shape[s]!=null?n.push(e.shape[s]):n.push(t[s]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Unt(e,t,n,s){const r=_(e,"x","dropout");if(T(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),T(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof Ut?r.clone():r;const i=Wnt(r,n),o=1-t,a=gt(ld(tt(Ga(i,0,1,"float32",s),o)),o);return M(r,a)}const KT=O({dropout_:Unt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qT(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Cv(e,t,n){const s=1-e%2,r=new Float32Array(e);for(let i=0;i<e;++i){const o=2*Math.PI*i/(e+s-1);r[i]=t-n*Math.cos(o)}return cn(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function jnt(e,t,n=1){const s=_(e,"predictions","inTopK"),r=_(t,"targets","inTopK");T(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),T(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Nn(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=s.shape[s.shape.length-1];T(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await s.data(),a=await r.data(),[l,c]=[o.length/i,i],u=fn("bool",l);for(let h=0;h<l;h++){const d=h*c,f=o.subarray(d,d+c),p=[];for(let g=0;g<f.length;g++)p.push({value:f[g],index:g});p.sort((g,m)=>m.value-g.value),u[h]=0;for(let g=0;g<n;g++)if(p[g].index===a[h]){u[h]=1;break}}return e!==s&&s.dispose(),t!==r&&r.dispose(),Ds(u,r.shape,"bool")}const nB=jnt;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gnt(e,t,n,s,r,i="NHWC",o){let a=e;e.rank===3&&(a=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=V(t,[1,t.shape[0],t.shape[1],t.shape[2]])),T(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];T(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),T(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),es("conv2dDerFilter",r,o);const h={x:a,dy:l},d={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return D.runKernel(Y1,h,d)}const XT=O({conv2DBackpropFilter_:Gnt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iv(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return M(e,Dc(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Tv(e,t){let n=t;const s=Ye(e.shape,t.shape);return s.length>0&&(n=ft(n,s)),V(n,e.shape)}function Nv(e,t,n,s){if(t==="linear")return e;if(t==="relu")return ei(e);if(t==="elu")return od(e);if(t==="relu6")return uv(e);if(t==="prelu")return pg(e,n);if(t==="leakyrelu")return ag(e,s);if(t==="sigmoid")return jr(e);throw new Error(`Unknown fused activation ${t}.`)}const _v=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hnt({x:e,filter:t,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",_v(D.state.gradientDepth,l)===!1){T(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=xo(e,t,n,s,r,i,o);return a!=null&&(k=tt(k,a)),Nv(k,l,c,u)}const h=_(e,"x","conv2d","float32"),d=_(t,"filter","conv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=V(h,[1,h.shape[0],h.shape[1],h.shape[2]])),T(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),es("fused conv2d",s,o);const g=r==="NHWC"?f.shape[3]:f.shape[1];T(d.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${d.shape[2]}.`),T(_n(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const m=gn(f.shape,d.shape,n,i,s,o);let x;a!=null&&(x=_(a,"bias","fused conv2d"),[x]=Te(x,h),r==="NHWC"?It(m.outShape,x.shape):(T(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),T(x.shape.length===0||x.shape[0]===m.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${m.outChannels})`)));let y;if(c!=null){const k=c.shape;if(T(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)T(k[0]===1||k[0]===m.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${m.outChannels}).`);else if(k.length===3)try{It(k,m.outShape)}catch{const C=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${m.outShape}).`;throw Error(C)}y=_(c,"prelu weights","fused conv2d")}const b=(k,I)=>{T(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[C,N,$,A]=I,R=Iv(k,$,l);T(Ca(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const z=aT(N.shape,R,C,n,s),U=XT(N,R,C.shape,n,s),F=[z,U];if(A!=null){const P=Tv(A,R);F.push(P)}return F},v={x:f,filter:d,bias:x,preluActivationWeights:y},w={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Ni((I,C,N)=>{let $=D.runKernel(pp,v,w);return N([C,I,$]),p&&($=V($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:b}})(f,d):Ni((I,C,N,$)=>{let A=D.runKernel(pp,v,w);return $([C,I,A,N]),p&&(A=V(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:b}})(f,d,x)}const sB=O({fusedConv2d_:Hnt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Knt(e,t,n,s,r,i=[1,1],o){let a=e;e.rank===3&&(a=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return D.runKernel(sb,c,u)}const rB=O({depthwiseConv2dNativeBackpropFilter_:Knt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qnt(e,t,n,s,r,i=[1,1],o){let a=t,l=!1;t.rank===3&&(l=!0,a=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:e},h=D.runKernel(rb,c,u);return l?V(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const iB=O({depthwiseConv2dNativeBackpropInput_:qnt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xnt({x:e,filter:t,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(_v(D.state.gradientDepth,l)===!1){let w=id(e,t,n,s,r,i,o);return a!=null&&(w=tt(w,a)),Nv(w,l,c,u)}const h=_(e,"x","depthwiseConv2d","float32"),d=_(t,"filter","depthwiseConv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=V(h,[1,h.shape[0],h.shape[1],h.shape[2]])),T(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),T(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),T(f.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),i==null&&(i=[1,1]),T(_n(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),es("fused depthwiseConv2d",s,o);const g=gn(f.shape,d.shape,n,i,s,o,!0);let m;a!=null&&(m=_(a,"bias","fused conv2d"),[m]=Te(m,h),It(g.outShape,m.shape));let x;c!=null&&(x=_(c,"prelu weights","fused depthwiseConv2d"));const y=(w,k)=>{T(Ca(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[I,C,N,$]=k,A=Iv(w,N,l),R=iB(C.shape,A,I,n,s,i,o),z=rB(C,A,I.shape,n,s,i,o);if($!=null){const U=Tv(m,A);return[R,z,U]}return[R,z]},b={x:f,filter:d,bias:m,preluActivationWeights:x},v={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Ni((k,I,C)=>{let N=D.runKernel(mp,b,v);return C([I,k,N]),p&&(N=V(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:y}})(f,d):Ni((k,I,C,N)=>{let $=D.runKernel(mp,b,v);return N([I,k,$,C]),p&&($=V($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:y}})(f,d,m)}const Ynt=O({fusedDepthwiseConv2d_:Xnt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Znt({a:e,b:t,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(_v(D.state.gradientDepth,i)===!1){let A=Rt(e,t,n,s);return r!=null&&(A=tt(A,r)),Nv(A,i,o,a)}let l=_(e,"a","fused matMul"),c=_(t,"b","fused matMul");[l,c]=Te(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=s?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),g=c.shape.slice(0,-2),m=X(p),x=X(g);T(u===h,()=>`Error in fused matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const b=It(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,f]),v=n?V(l,[m,u,d]):V(l,[m,d,u]),w=s?V(c,[x,f,h]):V(c,[x,h,f]);let k;r!=null&&(k=_(r,"bias","fused matMul"),[k]=Te(k,l),It(b,k.shape));let I;o!=null&&(I=_(o,"prelu weights","fused matMul"));const C=(A,R)=>{const[z,U,F,P]=R,L=Iv(V(A,F.shape),F,i);let E,B;if(!n&&!s?(E=Rt(L,U,!1,!0),B=Rt(z,L,!0,!1)):!n&&s?(E=Rt(L,U,!1,!1),B=Rt(L,z,!0,!1)):n&&!s?(E=Rt(U,L,!1,!0),B=Rt(z,L,!1,!1)):(E=Rt(U,L,!0,!0),B=Rt(L,z,!0,!0)),r!=null){const q=Tv(P,L);return[E,B,q]}else return[E,B]},N={a:v,b:w,bias:k,preluActivationWeights:I},$={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?Ni((R,z,U)=>{const F=D.runKernel(fp,N,$);return U([R,z,F]),{value:V(F,b),gradFunc:C}})(v,w):Ni((R,z,U,F)=>{const P=D.runKernel(fp,N,$);return F([R,z,P,U]),{value:V(P,b),gradFunc:C}})(v,w,k)}const lk=O({fusedMatMul_:Znt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oB=Object.freeze(Object.defineProperty({__proto__:null,conv2d:sB,depthwiseConv2d:Ynt,matMul:lk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qnt(e){return Cv(e,.54,.46)}const Jnt=O({hammingWindow_:Qnt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tst(e){return Cv(e,.5,.5)}const aB=O({hannWindow_:tst});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function est(e,t,n,s=!1,r=0){let i=0;const o=[];for(;i+t<=e.size;)o.push(zt(e,i,t)),i+=n;if(s)for(;i<e.size;){const a=i+t-e.size,l=Me([zt(e,i,t-a),Ec([a],r)]);o.push(l),i+=n}return o.length===0?ro([],[0,t]):V(Me(o),[o.length,t])}const lB=O({frame_:est});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nst(e,t,n,s,r=aB){s==null&&(s=qT(t));const i=lB(e,t,n),o=M(i,r(t));return bg(o,s)}const sst=O({stft_:nst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rst(e,t,n,s,r="bilinear",i=0){const o=_(e,"image","cropAndResize"),a=_(t,"boxes","cropAndResize","float32"),l=_(n,"boxInd","cropAndResize","int32"),c=a.shape[0];T(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),T(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),T(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),T(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),T(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),T(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},h={method:r,extrapolationValue:i,cropSize:s};return D.runKernel(tb,u,h)}const ist=O({cropAndResize_:rst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ost(e){const t=_(e,"image","flipLeftRight","float32");T(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return D.runKernel(hb,n,{})}const ast=O({flipLeftRight_:ost});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lst(e){const t=_(e,"image","grayscaleToRGB"),n=t.rank-1,s=t.shape[n];T(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),T(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(t.rank);return r.fill(1,0,n),r[n]=3,Xs(t,r)}const cst=O({grayscaleToRGB_:lst});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ust(e){const t=_(e,"image","RGBToGrayscale"),n=t.rank-1,s=t.shape[n];T(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),T(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=t.dtype,i=ot(t,"float32"),o=cn([.2989,.587,.114]);let a;switch(t.rank){case 2:a=ml("ij,j->i",i,o);break;case 3:a=ml("ijk,k->ij",i,o);break;case 4:a=ml("ijkl,l->ijk",i,o);break;case 5:a=ml("ijklm,m->ijkl",i,o);break;case 6:a=ml("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=wn(a,-1),ot(a,r)}const hst=O({rgbToGrayscale_:ust});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dst(e,t,n=0,s=.5){const r=_(e,"image","rotateWithOffset","float32");T(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:t,fillValue:n,center:s};return D.runKernel(Kb,i,o)}const fst=O({rotateWithOffset_:dst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hd(e,t,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=e.shape[0];return n=Math.min(n,o),T(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),T(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),T(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),T(t.rank===1,()=>"scores must be a 1D tensor"),T(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),T(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pst(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=_(e,"boxes","nonMaxSuppression","float32"),o=_(t,"scores","nonMaxSuppression","float32"),a=hd(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return D.runKernel(wb,{boxes:i,scores:o},l)}const mst=O({nonMaxSuppression_:pst});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gst(e,t,n){const s=xst(e,t,n),r=s<0?-(s+1):s;e.splice(r,0,t)}function xst(e,t,n){return bst(e,t,n||yst)}function yst(e,t){return e>t?1:e<t?-1:0}function bst(e,t,n){let s=0,r=e.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(t,e[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $v(e,t,n,s,r){return YT(e,t,n,s,r,0)}function Ev(e,t,n,s,r,i){return YT(e,t,n,s,r,0,!1,i,!0)}function Av(e,t,n,s,r,i){return YT(e,t,n,s,r,i,!0)}function YT(e,t,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let m=0;m<t.length;m++)t[m]>r&&c.push({score:t[m],boxIndex:m,suppressBeginIndex:0});c.sort(cD);const u=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&c.length>0;){const m=c.pop(),{score:x,boxIndex:y,suppressBeginIndex:b}=m;if(x<r)break;let v=!1;for(let w=h.length-1;w>=b;--w){const k=vst(e,y,h[w]);if(k>=s){v=!0;break}if(m.score=m.score*wst(s,u,k),m.score<=r)break}m.suppressBeginIndex=h.length,v||(m.score===x?(h.push(y),d.push(m.score)):m.score>r&&gst(c,m,cD))}const f=h.length,p=n-f;a&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const g={selectedIndices:h};return o&&(g.selectedScores=d),l&&(g.validOutputs=f),g}function vst(e,t,n){const s=e.subarray(t*4,t*4+4),r=e.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),f=(a-i)*(l-o),p=(h-c)*(d-u);if(f<=0||p<=0)return 0;const g=Math.max(i,c),m=Math.max(o,u),x=Math.min(a,h),y=Math.min(l,d),b=Math.max(x-g,0)*Math.max(y-m,0);return b/(f+p-b)}function wst(e,t,n){const s=Math.exp(t*n*n);return n<=e?s:0}function cD(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Sst(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=_(e,"boxes","nonMaxSuppressionAsync"),o=_(t,"scores","nonMaxSuppressionAsync"),a=hd(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:h}=$v(c,u,n,s,r);return i!==e&&i.dispose(),o!==t&&o.dispose(),cn(h,"int32")}const kst=Sst;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cst(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=_(e,"boxes","nonMaxSuppression"),a=_(t,"scores","nonMaxSuppression"),l=hd(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},h=D.runKernel(kb,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}const Ist=O({nonMaxSuppressionWithScore_:Cst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Tst(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=_(e,"boxes","nonMaxSuppressionAsync"),a=_(t,"scores","nonMaxSuppressionAsync"),l=hd(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],h=c[1],{selectedIndices:d,selectedScores:f}=Av(u,h,n,s,r,i);return o!==e&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:cn(d,"int32"),selectedScores:cn(f)}}const Nst=Tst;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _st(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=_(e,"boxes","nonMaxSuppression"),a=_(t,"scores","nonMaxSuppression"),l=hd(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,d={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:h,padToMaxOutputSize:i},p=D.runKernel(Sb,d,f);return{selectedIndices:p[0],validOutputs:p[1]}}const $st=O({nonMaxSuppressionPadded_:_st});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Est(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=_(e,"boxes","nonMaxSuppressionAsync"),a=_(t,"scores","nonMaxSuppressionAsync"),l=hd(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:g}=Ev(d,f,c,u,h,i);return o!==e&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:cn(p,"int32"),validOutputs:yt(g,"int32")}}const Ast=Est;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rst(e,t,n=!1,s=!1){const r=_(e,"images","resizeBilinear");T(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),T(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),T(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=V(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:t},c=D.runKernel(Wm,a,l);return o?V(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const cB=O({resizeBilinear_:Rst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dst(e,t,n=!1,s=!1){const r=_(e,"images","resizeNearestNeighbor");T(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),T(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),T(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),T(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=V(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:t},c=D.runKernel(Vm,a,l);return o?V(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const uB=O({resizeNearestNeighbor_:Dst});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ost(e,t="binary",n=!1,s=.5){const r=_(e,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=M(cn([s]),255),u,h,d,f;if(T(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),T(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),T(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),T(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),r.shape[2]===3){[u,h,d]=us(r,[1,1,1],-1);const m=M(u,i),x=M(h,o),y=M(d,a);f=tt(tt(m,x),y)}else f=e;if(t==="otsu"){const m=eT(ot(hv(f),"int32"),Ds([]),256);c=Pst(m,l)}const p=n?ja(f,c):ns(f,c);return ot(M(p,255),"int32")}function Pst(e,t){let n=cn([-1]),s=cn([0]),r=cn([0]),i,o,a,l,c,u;for(let h=0;h<e.size-1;h++){i=zt(e,0,h+1),o=zt(e,h+1),c=gt(ft(i),t),u=gt(ft(o),t);const d=ft(M(i,ic(0,i.size)));a=gt(d,ft(i));const f=Ec(o.shape,i.size),p=tt(ic(0,o.size),f),g=M(o,p);l=gt(ft(g),ft(o));const m=dt(a,l),x=dt(a,l),y=M(c,u);r=M(M(y,m),x);const b=ns(r,s);s=dn(b,r,s),n=dn(b,cn([h]),n)}return n}const Fst=O({threshold_:Ost});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lst(e,t,n="nearest",s="constant",r=0,i){const o=_(e,"image","transform","float32"),a=_(t,"transforms","transform","float32");T(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),T(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return D.runKernel(Gb,l,c)}const Mst=O({transform_:Lst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zst(e,t,n){const s=_(e,"a","bandPart");T(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);let a,l;typeof t=="number"?(T(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),T(t<=i,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${i}).`),a=_(t<0?i:t,"numLower","bandPart")):(T(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=dn(Uu(t,0),i,Ta(t,i))),typeof n=="number"?(T(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),T(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=_(n<0?o:n,"numUpper","bandPart")):(T(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=dn(Uu(n,0),o,Ta(n,o)));const c=V(ic(0,i,1,"int32"),[-1,1]),u=ic(0,o,1,"int32"),h=dt(c,u),d=Tr(ja(h,a),Io(h,oe(l))),f=He([i,o],s.dtype);return V(Qn(rr(V(s,[-1,i,o])).map(p=>dn(d,p,f))),r)}const Bst=O({bandPart_:zst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vst(e){let t;if(Array.isArray(e)){t=!1,T(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=e[0].shape[0];for(let i=1;i<e.length;++i)T(e[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[i].shape[0]} vs. ${r})`)}else t=!0,e=us(e,e.shape[0],0).map(r=>Ha(r,[0]));T(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],s=e;for(let r=0;r<e.length;++r)n.push(D.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=M(ft(M(n[o],i)),n[o]);i=dt(i,a)}return gt(i,ad(i,"euclidean"))}));return t?Qn(n,0):n}const Wst=O({gramSchmidt_:Vst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ust(e,t=!1){if(T(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return uD(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((l,c)=>l*c),s=rr(V(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=uD(l,t);r.push(c),i.push(u)});const o=V(Qn(r,0),e.shape),a=V(Qn(i,0),e.shape);return[o,a]}}function uD(e,t=!1){return D.tidy(()=>{T(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],s=e.shape[1];let r=rv(n),i=yi(e);const o=ro([[1]],[1,1]);let a=yi(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,h=a,d=r;[a,i,r]=D.tidy(()=>{const f=zt(i,[c,c],[n-c,1]),p=ad(f),g=zt(i,[c,c],[1,1]),m=dn(ns(g,0),ro([[-1]]),ro([[1]])),x=dt(g,M(m,p)),y=gt(f,x);y.shape[0]===1?a=yi(o):a=Me([o,zt(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const b=oe(gt(Rt(m,x),p)),v=zt(i,[c,0],[n-c,s]),w=M(b,a),k=Ft(a);if(c===0)i=dt(v,Rt(w,Rt(k,v)));else{const N=dt(v,Rt(w,Rt(k,v)));i=Me([zt(i,[0,0],[c,s]),N],0)}const I=Ft(w),C=zt(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=dt(C,Rt(Rt(C,a),I));else{const N=dt(C,Rt(Rt(C,a),I));r=Me([zt(r,[0,0],[n,c]),N],1)}return[a,i,r]}),Ct([u,h,d])}return!t&&n>s&&(r=zt(r,[0,0],[n,s]),i=zt(i,[0,0],[s,s])),[r,i]})}const jst=O({qr_:Ust});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hn;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Hn||(Hn={}));function Gst(e,t,n=Hn.SUM_BY_NONZERO_WEIGHTS){const s=_(e,"losses","computeWeightedLoss");let r=null;t!=null&&(r=_(t,"weights","computeWeightedLoss"));const i=r==null?s:M(s,r);if(n===Hn.NONE)return i;if(n===Hn.SUM)return ft(i);if(n===Hn.MEAN){if(r==null)return ke(i);{const o=s.size/r.size,a=gt(ft(i),ft(r));return o>1?gt(a,yt(o)):a}}if(n===Hn.SUM_BY_NONZERO_WEIGHTS){if(r==null)return gt(ft(i),yt(s.size));{const o=M(r,ls(s.shape)),a=ot(ft(rc(o,yt(0))),"float32");return gt(ft(i),a)}}throw Error(`Unknown reduction: ${n}`)}const No=O({computeWeightedLoss_:Gst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hst(e,t,n,s=Hn.SUM_BY_NONZERO_WEIGHTS){const r=_(e,"labels","absoluteDifference"),i=_(t,"predictions","absoluteDifference");let o=null;n!=null&&(o=_(n,"weights","absoluteDifference")),Nn(r.shape,i.shape,"Error in absoluteDifference: ");const a=je(dt(r,i));return No(a,o,s)}const Kst=O({absoluteDifference_:Hst});function qst(e,t,n,s,r=Hn.SUM_BY_NONZERO_WEIGHTS){const i=_(e,"labels","cosineDistance"),o=_(t,"predictions","cosineDistance");let a=null;s!=null&&(a=_(s,"weights","cosineDistance")),Nn(i.shape,o.shape,"Error in cosineDistance: ");const l=yt(1),c=dt(l,ft(M(i,o),n,!0));return No(c,a,r)}const Xst=O({cosineDistance_:qst});function Yst(e,t,n,s=Hn.SUM_BY_NONZERO_WEIGHTS){let r=_(e,"labels","hingeLoss");const i=_(t,"predictions","hingeLoss");let o=null;n!=null&&(o=_(n,"weights","hingeLoss")),Nn(r.shape,i.shape,"Error in hingeLoss: ");const a=yt(1);r=dt(M(yt(2),r),a);const l=ei(dt(a,M(r,i)));return No(l,o,s)}const Zst=O({hingeLoss_:Yst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qst(e,t,n,s=1,r=Hn.SUM_BY_NONZERO_WEIGHTS){const i=_(e,"labels","huberLoss"),o=_(t,"predictions","huberLoss");let a=null;n!=null&&(a=_(n,"weights","huberLoss")),Nn(i.shape,o.shape,"Error in huberLoss: ");const l=yt(s),c=je(dt(o,i)),u=Ta(c,l),h=dt(c,u),d=tt(M(yt(.5),ee(u)),M(l,h));return No(d,a,r)}const Jst=O({huberLoss_:Qst});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function trt(e,t,n,s=1e-7,r=Hn.SUM_BY_NONZERO_WEIGHTS){const i=_(e,"labels","logLoss"),o=_(t,"predictions","logLoss");let a=null;n!=null&&(a=_(n,"weights","logLoss")),Nn(i.shape,o.shape,"Error in logLoss: ");const l=yt(1),c=yt(s),u=oe(M(i,Ps(tt(o,c)))),h=M(dt(l,i),Ps(tt(dt(l,o),c))),d=dt(u,h);return No(d,a,r)}const ert=O({logLoss_:trt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nrt(e,t,n,s=Hn.SUM_BY_NONZERO_WEIGHTS){const r=_(e,"labels","meanSquaredError"),i=_(t,"predictions","meanSquaredError");let o=null;n!=null&&(o=_(n,"weights","meanSquaredError")),Nn(r.shape,i.shape,"Error in meanSquaredError: ");const a=bv(r,i);return No(a,o,s)}const srt=O({meanSquaredError_:nrt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rrt(e,t){const n=_(e,"labels","sigmoidCrossEntropyWithLogits"),s=_(t,"logits","sigmoidCrossEntropyWithLogits");Nn(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=ei(s),i=M(s,n),o=lg(ps(oe(je(s))));return tt(dt(r,i),o)}function irt(e,t,n,s=0,r=Hn.SUM_BY_NONZERO_WEIGHTS){let i=_(e,"multiClassLabels","sigmoidCrossEntropy");const o=_(t,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=_(n,"weights","sigmoidCrossEntropy")),Nn(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=yt(s),u=yt(1),h=yt(.5);i=tt(M(i,dt(u,c)),M(h,c))}const l=rrt(i,o);return No(l,a,r)}const ort=O({sigmoidCrossEntropy_:irt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function art(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Ni((r,i,o)=>{const l=cg(i,[n],!0),c=dt(ot(i,"float32"),l);o([r,c]);const u=oe(M(c,r));return{value:ft(u,[n]),gradFunc:(f,p)=>{const[g,m]=p,x=ze(f.shape,[n]);return[M(V(f,x),dt(ot(g,"float32"),ps(m))),M(V(f,x),dt(ps(m),ot(g,"float32")))]}}})(e,t)}function lrt(e,t,n,s=0,r=Hn.SUM_BY_NONZERO_WEIGHTS){let i=_(e,"onehotLabels","softmaxCrossEntropy");const o=_(t,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=_(n,"weights","softmaxCrossEntropy")),Nn(i.shape,o.shape,"Error in softmaxCrossEntropy: "),s>0){const c=yt(s),u=yt(1),h=yt(i.shape[1]);i=tt(M(i,dt(u,c)),gt(c,h))}const l=art(i,o);return No(l,a,r)}const crt=O({softmaxCrossEntropy_:lrt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function urt(e,t,n,s){const r=_(e,"indices","sparseFillEmptyRows","int32"),i=_(t,"values","sparseFillEmptyRows"),o=_(n,"denseShape","sparseFillEmptyRows","int32"),a=_(s,"defaultValue","sparseFillEmptyRows",i.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:r,values:i,denseShape:o,defaultValue:a},c=D.runKernel(Ob,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const hrt=O({sparseFillEmptyRows_:urt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function drt(e,t,n){const s=_(e,"inputIndices","sparseReshape","int32"),r=_(t,"inputShape","sparseReshape","int32"),i=_(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:s,inputShape:r,newShape:i},a=D.runKernel(Pb,o);return{outputIndices:a[0],outputShape:a[1]}}const frt=O({sparseReshape_:drt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function prt(e,t,n){const s=_(e,"data","sparseSegmentMean"),r=_(t,"indices","sparseSegmentMean","int32"),i=_(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return D.runKernel(Fb,o)}const mrt=O({sparseSegmentMean_:prt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function grt(e,t,n){const s=_(e,"data","sparseSegmentSum"),r=_(t,"indices","sparseSegmentSum","int32"),i=_(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return D.runKernel(Lb,o)}const xrt=O({sparseSegmentSum_:grt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yrt(e,t,n,s,r,i,o,a){const l=_(e,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=_(t,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:s,leftPad:r,rightPad:i,padWidth:o,preserveShortSequences:a},h={data:l,dataSplits:c},d=D.runKernel(Vb,h,u);return{nGrams:d[0],nGramsSplits:d[1]}}const brt=O({stringNGrams_:yrt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vrt(e,t,n=!0){const s=_(e,"input","stringSplit","string"),r=_(t,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const i={skipEmpty:n},o={input:s,delimiter:r},a=D.runKernel(Wb,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const wrt=O({stringSplit_:vrt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Srt(e,t){const n=_(e,"input","stringToHashBucketFast","string"),s={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return D.runKernel(Ub,r,s)}const krt=O({stringToHashBucketFast_:Srt});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Crt(e,t,n,s=!0){const r=_(e,"input","staticRegexReplace","string"),i={pattern:t,rewrite:n,replaceGlobal:s};return D.runKernel(Ym,{x:r},i)}const Irt=O({staticRegexReplace_:Crt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hB={fft:yg,ifft:Ku,rfft:bg,irfft:yv},dB={hammingWindow:Jnt,hannWindow:aB,frame:lB,stft:sst},wr={flipLeftRight:ast,grayscaleToRGB:cst,resizeNearestNeighbor:uB,resizeBilinear:cB,rgbToGrayscale:hst,rotateWithOffset:fst,cropAndResize:ist,nonMaxSuppression:mst,nonMaxSuppressionAsync:kst,nonMaxSuppressionWithScore:Ist,nonMaxSuppressionWithScoreAsync:Nst,nonMaxSuppressionPadded:$st,nonMaxSuppressionPaddedAsync:Ast,threshold:Fst,transform:Mst},ZT={bandPart:Bst,gramSchmidt:Wst,qr:jst},fB={absoluteDifference:Kst,computeWeightedLoss:No,cosineDistance:Xst,hingeLoss:Zst,huberLoss:Jst,logLoss:ert,meanSquaredError:srt,sigmoidCrossEntropy:ort,softmaxCrossEntropy:crt},pB={sparseFillEmptyRows:hrt,sparseReshape:frt,sparseSegmentMean:mrt,sparseSegmentSum:xrt},mB={stringNGrams:brt,stringSplit:wrt,stringToHashBucketFast:krt,staticRegexReplace:Irt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Trt=new Map,ck=new Map;class Oc{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class Hs{constructor(){this.classNameMap={}}static getMap(){return Hs.instance==null&&(Hs.instance=new Hs),Hs.instance}static register(t){Hs.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function st(e,t,n){T(e.className!=null,()=>"Class being registered does not have the static className property defined."),T(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),T(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const s=n,r=t+">"+s;return Hs.register(e),Trt.set(r,e),ck.set(e,r),e}function Nrt(e){return ck.has(e)?ck.get(e):e.className}const _rt=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Oc,SerializationMap:Hs,getRegisteredName:Nrt,registerClass:st},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _o extends Oc{minimize(t,n=!1,s){const{value:r,grads:i}=this.computeGradients(t,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Ct(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return vz(t,n)}dispose(){this.iterations_!=null&&Ct(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:yt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(_o,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QT extends _o{static get className(){return"Adadelta"}constructor(t,n,s=null){super(),this.learningRate=t,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=D.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const i=D.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:G(()=>Bt(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:G(()=>Bt(i).variable(o))});const a=Array.isArray(t)?t[r].tensor:t[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;G(()=>{const u=tt(M(l,this.rho),M(ee(a),1-this.rho)),h=M(gt(pn(tt(c,this.epsilon)),pn(tt(l,this.epsilon))),a),d=tt(M(c,this.rho),M(ee(h),1-this.rho));l.assign(u),c.assign(d);const f=tt(M(h,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ct(this.accumulatedGrads.map(t=>t.variable)),Ct(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,s=!1;this.accumulatedGrads=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JT extends _o{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const i=D.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:G(()=>Ec(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(t)?t[r].tensor:t[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;G(()=>{const l=tt(a,ee(o));a.assign(l);const c=tt(M(gt(o,pn(tt(l,D.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ct(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tN extends _o{static get className(){return"Adam"}constructor(t,n,s,r=null){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],G(()=>{this.accBeta1=yt(n).variable(),this.accBeta2=yt(s).variable()}),r==null&&(this.epsilon=D.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);G(()=>{const s=dt(1,this.accBeta1),r=dt(1,this.accBeta2);n.forEach((i,o)=>{const a=D.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:G(()=>Bt(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:G(()=>Bt(a).variable(l))});const c=Array.isArray(t)?t[o].tensor:t[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,h=this.accumulatedSecondMoment[o].variable,d=tt(M(u,this.beta1),M(c,1-this.beta1)),f=tt(M(h,this.beta2),M(ee(c),1-this.beta2)),p=gt(d,s),g=gt(f,r);u.assign(d),h.assign(f);const m=tt(M(gt(p,tt(pn(g),this.epsilon)),-this.learningRate),a);a.assign(m)}),this.accBeta1.assign(M(this.accBeta1,this.beta1)),this.accBeta2.assign(M(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ct(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&Ct(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),G(()=>{this.accBeta1.assign(Ti(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ti(this.beta2,this.iterations_+1))});const n=t.length/2,s=!1;this.accumulatedFirstMoment=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eN extends _o{static get className(){return"Adamax"}constructor(t,n,s,r=null,i=0){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],G(()=>{this.iteration=yt(0).variable(),this.accBeta1=yt(n).variable()}),r==null&&(this.epsilon=D.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);G(()=>{const s=dt(1,this.accBeta1),r=gt(-this.learningRate,tt(M(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=D.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Bt(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Bt(a).variable(l)});const c=Array.isArray(t)?t[o].tensor:t[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,h=this.accumulatedWeightedInfNorm[o].variable,d=tt(M(u,this.beta1),M(c,1-this.beta1)),f=M(h,this.beta2),p=je(c),g=Ei(f,p);u.assign(d),h.assign(g);const m=tt(M(gt(r,s),gt(d,tt(g,this.epsilon))),a);a.assign(m)}),this.iteration.assign(tt(this.iteration,1)),this.accBeta1.assign(M(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ct(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&Ct(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rv extends _o{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const i=Array.isArray(t)?t[r].tensor:t[s];if(i==null)return;const o=D.registeredVariables[s];G(()=>{const a=tt(M(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=Je(yt(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nN extends Rv{static get className(){return"Momentum"}constructor(t,n,s=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=yt(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const i=D.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:G(()=>Bt(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(t)?t[r].tensor:t[s];a!=null&&G(()=>{let l;const c=tt(M(this.m,o),a);this.useNesterov?l=tt(M(this.c,tt(a,M(c,this.m))),i):l=tt(M(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ct(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sN extends _o{static get className(){return"RMSProp"}constructor(t,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=D.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const i=D.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:G(()=>Bt(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:G(()=>Bt(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:G(()=>Bt(i).variable(o))});const a=Array.isArray(t)?t[r].tensor:t[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;G(()=>{const u=tt(M(l,this.decay),M(ee(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[r].variable,d=tt(M(h,this.decay),M(a,1-this.decay)),f=gt(M(a,this.learningRate),pn(dt(u,tt(ee(d),this.epsilon)))),p=tt(M(c,this.momentum),f);l.assign(u),h.assign(d),c.assign(p);const g=dt(i,p);i.assign(g)}else{const h=tt(M(l,this.decay),M(ee(a),1-this.decay)),d=tt(M(c,this.momentum),gt(M(a,this.learningRate),pn(tt(h,this.epsilon))));l.assign(h),c.assign(d);const f=dt(i,d);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ct(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ct(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&Ct(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,s=!1;this.accumulatedMeanSquares=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $rt=[QT,JT,tN,eN,nN,sN,Rv];function Ert(){for(const e of $rt)st(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Art="model",Rrt=".json",Drt=".weights.bin";function hD(e){return new Promise(t=>setTimeout(t)).then(e)}class oc{constructor(t){if(!H().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(oc.URL_SCHEME)&&(t=t.slice(oc.URL_SCHEME.length)),(t==null||t.length===0)&&(t=Art),this.modelJsonFileName=t+Rrt,this.weightDataFileName=t+Drt}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=ti.join(t.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i=tz(t,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await hD(()=>a.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await hD(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:eg(t)}}}}oc.URL_SCHEME="downloads://";class Ort{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,n)=>{const s=new FileReader;s.onload=r=>{const i=JSON.parse(r.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:o});return}const l=BI(i,c=>this.loadWeights(c));t(l)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(t){const n=[],s=[];for(const o of t)n.push(...o.weights),s.push(...o.paths);const r=this.checkManifestAndWeightFiles(t),i=s.map(o=>this.loadWeightsFile(o,r[o]));return Promise.all(i).then(o=>[n,o])}loadWeightsFile(t,n){return new Promise((s,r)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;s(a)},i.onerror=o=>r(`Failed to weights data from file of path '${t}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(t){const n=[],s=this.weightsFiles.map(i=>lD(i.name)),r={};for(const i of t)i.paths.forEach(o=>{const a=lD(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);r[o]=this.weightsFiles[s.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const Prt=e=>H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(oc.URL_SCHEME)?Frt(e.slice(oc.URL_SCHEME.length)):null;we.registerSaveRouter(Prt);function Frt(e="model"){return new oc(e)}function Lrt(e){return new Ort(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dD(e,t,n,s){o(e),n=n??0,s=s??1,a(n,s);let r=0;const i=l=>(l.then(c=>{const u=n+ ++r/e.length*(s-n);return t(u),c}),l);function o(l){T(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){T(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),T(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),T(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(e.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function gB(e,t){t==null&&(t={});const n=t.fetchFunc==null?H().platform.fetch:t.fetchFunc,s=e.map(h=>n(h,t.requestInit,{isBinary:!0})),a=(t.onProgress==null?await Promise.all(s):await dD(s,t.onProgress,0,.5)).map(h=>h.arrayBuffer());return t.onProgress==null?await Promise.all(a):await dD(a,t.onProgress,.5,1)}function Mrt(e,t){var n;const s=t.fetchFunc==null?H().platform.fetch:t.fetchFunc;let r=0,i;return(n=t.onProgress)===null||n===void 0||n.call(t,0),new ReadableStream({pull:async o=>{for(var a;r<e.length;){i||(i=(await s(e[r],t.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await i.read();if(l){r++,i=void 0,(a=t.onProgress)===null||a===void 0||a.call(t,r/e.length);continue}o.enqueue(c);return}o.close()}})}async function xB(e,t="",n,s){return yB(o=>gB(o,{requestInit:s}))(e,t,n)}function yB(e){return async(t,n="",s)=>{const r=t.map(()=>!1),i={},o=s!=null?s.map(()=>!1):[],a=[];if(t.forEach((f,p)=>{let g=0;f.weights.forEach(m=>{const x="quantization"in m?m.quantization.dtype:m.dtype,y=Ql[x]*X(m.shape),b=()=>{r[p]=!0,i[p]==null&&(i[p]=[]),i[p].push({manifestEntry:m,groupOffset:g,sizeBytes:y})};s!=null?s.forEach((v,w)=>{v===m.name&&(b(),o[w]=!0)}):b(),a.push(m.name),g+=y})}),!o.every(f=>f)){const f=s.filter((p,g)=>!o[g]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=r.reduce((f,p,g)=>(p&&f.push(g),f),[]),c=[];l.forEach(f=>{t[f].paths.forEach(p=>{const g=n+(n.endsWith("/")?"":"/")+p;c.push(g)})});const u=await e(c),h={};let d=0;return l.forEach(f=>{const p=t[f].paths.length,g=new ti(u.slice(d,d+p));i[f].forEach(x=>{const y=g.slice(x.groupOffset,x.groupOffset+x.sizeBytes),b=LI(y,[x.manifestEntry]);for(const v in b)h[v]=b[v]}),d+=p}),h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zrt="application/octet-stream",Brt="application/json";class rN{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(T(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=H().platform.fetch,T(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&T(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=tz(t,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:Brt}),"model.json"),t.weightData!=null){const o=ti.join(t.weightData);n.body.append("model.weights.bin",new Blob([o],{type:zrt}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:eg(t),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await t.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return BI(t,n=>this.loadWeights(n))}async loadStream(){const t=await this.loadModelJSON(),n=await this.getWeightUrls(t.weightsManifest),s=Iy(t.weightsManifest),r=()=>Mrt(n,this.loadOptions);return Object.assign(Object.assign({},t),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(t){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=Vrt(n),i=this.weightPathPrefix||s,o=[],a=[];for(const l of t)for(const c of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(c)):o.push(i+c+r);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(t){const n=await this.getWeightUrls(t),s=Iy(t),r=await gB(n,this.loadOptions);return[s,r]}}rN.URL_SCHEME_REGEX=/^https?:\/\//;function Vrt(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),s=e.substring(0,t),r=n>t?e.substring(n):"";return[s+"/",r]}function uk(e){return e.match(rN.URL_SCHEME_REGEX)!=null}const bB=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(s=>uk(s)):n=uk(e),n)return iN(e,t)}return null};we.registerSaveRouter(bB);we.registerLoadRouter(bB);function iN(e,t){return new rN(e,t)}function vB(e,t){return iN(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l2{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class wB{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class Wrt{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=n=>Promise.resolve(t.save(n)))}}function Urt(e,t,n,s){const r=arguments;return new Wrt(Ny(...r))}function Ny(e,t,n,s){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new l2(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new l2({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new l2({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:s}))}function jrt(e){return new wB(e)}function Grt(e){return new wB(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oN=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:ti,browserFiles:Lrt,browserHTTPRequest:vB,concatenateArrayBuffers:J4,copyModel:kQ,decodeWeights:LI,decodeWeightsStream:Q4,encodeWeights:nk,fromMemory:Urt,fromMemorySync:Ny,getLoadHandlers:nz,getModelArtifactsForJSON:BI,getModelArtifactsForJSONSync:zI,getModelArtifactsInfoForJSON:eg,getSaveHandlers:ez,getWeightSpecs:Iy,http:iN,isHTTPScheme:uk,listModels:wQ,loadWeights:xB,moveModel:CQ,registerLoadRouter:cQ,registerSaveRouter:lQ,removeModel:SQ,weightsLoaderFactory:yB,withSaveHandler:jrt,withSaveHandlerSync:Grt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hrt(e,t,n){const s=_(e,"labels","confusionMatrix"),r=_(t,"predictions","confusionMatrix");T(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),T(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),T(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),T(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),T(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const i=ju(ot(s,"int32"),n),o=ju(ot(r,"int32"),n),a=Ft(i),l=Rt(a,o);return ot(l,"int32")}const Krt=O({confusionMatrix_:Hrt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qrt=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:Krt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ja,fD=!1;function SB(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,i=!1,o=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else if(e.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(xp(Sy,D.backendName)!=null){const p={pixels:e},g={numChannels:t};return D.runKernel(Sy,p,g)}const[c,u]=r?[e.videoWidth,e.videoHeight]:[e.width,e.height];let h;if(o)h=e.getContext("2d").getImageData(0,0,c,u).data;else if(s||n)h=e.data;else if(i||r||a){if(Ja==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Ja=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Ja=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Ja.canvas.width=c,Ja.canvas.height=u,Ja.drawImage(e,0,0,c,u),h=Ja.getImageData(0,0,c,u).data}let d;if(t===4)d=new Int32Array(h);else{const p=c*u;d=new Int32Array(p*t);for(let g=0;g<p;g++)for(let m=0;m<t;++m)d[g*t+m]=h[g*4+m]}return VT(d,[u,c,t],"int32")}function Xrt(e){return e!=null&&e.data instanceof Uint8Array}function Yrt(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function Zrt(e){return e!=null&&e.width!==0&&e.height!==0}function Qrt(e){return Yrt()&&!(e instanceof ImageBitmap)&&Zrt(e)&&!Xrt(e)}async function Jrt(e,t=3){let n=null;if(H().getBool("WRAP_TO_IMAGEBITMAP")&&Qrt(e)){let s;try{s=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===e.width&&s.height===e.height?n=s:n=e}else n=e;return SB(n,t)}function kB(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function tit(e){const t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function eit(e,t){let n=_(e,"img","toPixels");if(!(e instanceof Ut)){const c=n;n=ot(c,"int32"),c.dispose()}kB(n);const[s,r]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2],o=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let c=0;c<s*r;++c){const u=[0,0,0,255];for(let d=0;d<i;d++){const f=o[c*i+d];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);i===1?(u[0]=f*a,u[1]=f*a,u[2]=f*a):u[d]=f*a}const h=c*4;l[h+0]=Math.round(u[0]),l[h+1]=Math.round(u[1]),l[h+2]=Math.round(u[2]),l[h+3]=Math.round(u[3])}if(t!=null){fD||xp(ob,D.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),fD=!0),t.width=r,t.height=s;const c=t.getContext("2d"),u=new ImageData(l,r,s);c.putImageData(u,0,0)}return n!==e&&n.dispose(),l}function nit(e,t,n){let s=_(e,"img","draw");if(!(e instanceof Ut)){const o=s;s=ot(o,"int32"),o.dispose()}kB(s),tit(n==null?void 0:n.imageOptions);const r={image:s},i={canvas:t,options:n};D.runKernel(ob,r,i)}const CB=O({fromPixels_:SB}),sit=Object.freeze(Object.defineProperty({__proto__:null,draw:nit,fromPixels:CB,fromPixelsAsync:Jrt,toPixels:eit},Symbol.toStringTag,{value:"Module"}));function Dv(e,t){const n=e.shape.length,s=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[s-1]} vs. ${n}`);if(X(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const r=t.shape,i=r[r.length-1];let o=1;for(let h=0;h<r.length-1;++h)o*=r[h];const a=e.shape,l=r.slice();l.pop();let c=1;for(let h=i;h<n;++h)c*=a[h],l.push(a[h]);const u=[...bt(e.shape).map(h=>h/c),1].slice(0,i);return[l,o,c,u]}const rit=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:Dv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hk=-2,iit=-1;function aN(e,t,n){const s=e.shape.length;T(s===t.length,()=>`Error in slice${s}D: Length of begin ${t} must match the rank of the array (${s}).`),T(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)T(t[r]+n[r]<=e.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${t[r]+n[r]}) would overflow input.shape[${r}] (${e.shape[r]})`)}function oit(e){const t=[];let n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function lN(e,t,n){const s=[];for(let r=0;r<e.length;r++)s[r]=Math.ceil((t[r]-e[r])/n[r]);return s}function IB(e,t,n,s){const r=[...e];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[t]=1:(r.splice(t,0,1),r.pop());return r}function TB(e,t,n){return n<=e?n:n-(t-1)}function NB(e,t){const n=[];for(let s=0;s<e;s++)n.push(t+s);return n}function ait(e,t,n,s,r,i,o,a,l){const c=e.length;let u=new Array(c),h=new Array(c),d=new Array(c);if(t.length&&n>0){const f=t[0],p=n+1;u=_B(o,f,p,s,e),h=$B(a,f,p,r,e),d=IB(i,f,p,e)}else for(let f=0;f<c;f++)u[f]=AB(o,s,i,e,f,l),h[f]=RB(a,r,i,e,f,l),d[f]=EB(i,f,l);return{begin:u,end:h,strides:d}}function _B(e,t,n,s,r){const i=[...r],o=NB(n,t);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=TB(t,n,a);let c=s[l];e&1<<l&&(c=0),i[a]=c}return i}function $B(e,t,n,s,r){const i=[...r],o=NB(n,t);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=TB(t,n,a);let c=s[l];e&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=wa(0,i[a],r[a])}return i}function EB(e,t,n){let s=e[t];return(n&1<<t||s==null)&&(s=1),s}function AB(e,t,n,s,r,i){let o=t[r];const a=n[r]||1;(e&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=wa(0,o,l-1),o}function RB(e,t,n,s,r,i){let o=t[r];const a=n[r]||1;(e&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=wa(0,o,l):o=wa(-1,o,l-1),o}function cN(e,t,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function uN(e,t){let n=e.length>0?e[e.length-1]:1;for(let s=0;s<e.length-1;s++)n+=e[s]*t[s];return n}function Ov(e,t,n){let s;const r=e.shape.length;typeof t=="number"?s=[t,...new Array(r-1).fill(0)]:t.length<r?s=t.concat(new Array(r-t.length).fill(0)):s=t.slice(),s.forEach(o=>{T(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(T(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),e.shape[a]-s[a])),[s,i]}function hN(e,t,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(t.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<h.dims;b++)u&&1<<b&a&&h.numAddAxisAfterEllipsis++,1<<b&o&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};lit(h,d);let f=!0,p=!0,g=!0;const m=[],x=[];for(let b=0;b<e.length;++b){if(d.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const v=!!(d.shrinkAxisMask&1<<b),w=e[b];if(w===-1){m.push(v?1:-1);continue}const k=[d.beginMask&1<<b,d.endMask&1<<b],I=[d.strides[b]>0?0:-1,d.strides[b]>0?w:w-1];if(v&&d.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&d.strides[b]===1;const C=!!(d.beginMask&1<<b&&d.endMask&1<<b);if(d.beginValid&&d.endValid){if(v){const R=d.begin[b]<0?w+d.begin[b]:d.begin[b];if(d.begin[b]=R,d.end[b]=d.begin[b]+1,R<0||R>=w)throw Error(`slice index ${d.begin[b]} of dimension ${b} out of bounds.`)}else d.begin[b]=pD(d.begin[b],0,d.strides[b],w,k,I),d.end[b]=pD(d.end[b],1,d.strides[b],w,k,I);const A=d.strides[b]===1&&d.begin[b]===0&&d.end[b]===w;f=f&&A,p=p&&(b===0&&d.strides[b]===1||A)}else f=f&&d.strides[b]===1&&C,p=p&&(b===0&&d.strides[b]===1||C);let N,$=!1;if(d.beginValid&&d.endValid?(N=d.end[b]-d.begin[b],$=!0):v?(N=1,$=!0):C&&w>=0&&(d.strides[b]<0?N=-w:N=w,$=!0),$){let A;N===0||N<0!=d.strides[b]<0?A=0:A=Math.trunc(N/d.strides[b])+(N%d.strides[b]!==0?1:0),m.push(A)}else m.push(-1)}for(let b=0;b<d.finalShapeGatherIndices.length;++b){const v=d.finalShapeGatherIndices[b];v>=0?x.push(m[v]):v===hk&&x.push(1)}return{finalShapeSparse:x.filter((b,v)=>d.finalShapeGatherIndices[v]!==hk),finalShape:x,isIdentity:f,sliceDim0:p,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function lit(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let s=0;s<e.dims;s++)if(1<<s&e.ellipsisMask){const r=Math.min(t.dims-(e.dims-s)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<r;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&e.newAxisMask)t.finalShapeGatherIndices.push(hk),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[s]),e.end!=null&&(t.end[n]=e.end[s]),t.strides[n]=e.strides[s],e.beginMask&1<<s&&(t.beginMask|=1<<n),e.endMask&1<<s&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<s?(t.finalShapeGatherIndices.push(iit),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(s)),t.inputShapeGatherIndicesSparse[n]=s,n++}}function pD(e,t,n,s,r,i){if(r[t])return n>0?i[t]:i[t+1&1];{const o=e<0?s+e:e;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const DB=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:aN,computeFlatOffset:uN,computeOutShape:lN,getNormalizedAxes:ait,isSliceContinous:cN,maskToAxes:oit,parseSliceParams:Ov,sliceInfo:hN,startForAxis:AB,startIndicesWithElidedDims:_B,stopForAxis:RB,stopIndicesWithElidedDims:$B,stridesForAxis:EB,stridesWithElidedDims:IB},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const OB="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PB{static sgd(t){return new Rv(t)}static momentum(t,n,s=!1){return new nN(t,n,s)}static rmsprop(t,n=.9,s=0,r=null,i=!1){return new sN(t,n,s,r,i)}static adam(t=.001,n=.9,s=.999,r=null){return new tN(t,n,s,r)}static adadelta(t=.001,n=.95,s=null){return new QT(t,n,s)}static adamax(t=.002,n=.9,s=.999,r=null,i=0){return new eN(t,n,s,r,i)}static adagrad(t,n=.1){return new JT(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hl=PB;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cit=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e();function dN(){return new Promise(e=>cit(()=>e()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fN(e,t){const n=e[0].length;e.forEach((r,i)=>{T(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),T(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=e[0];e.forEach((r,i)=>{for(let o=0;o<n;o++)T(o===t||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function bi(e,t){const n=e[0].slice();for(let s=1;s<e.length;s++)n[t]+=e[s][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zr;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(zr||(zr={}));function FB(e,t,n){let s=new Array;if(n==null&&t==null)return s;if(t==null)for(;s.length<e+n.length;)s.push(-1);else s=t.slice();if(n==null)return s;if(e+n.length!==s.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${r+e}] = ${i} but shape[${r+e}] = ${a}`)}else s[o]=i}return s}function LB(e){const t={FIRST_DIM_SIZE:zr.FIRST_DIM_SIZE,VALUE_ROWIDS:zr.VALUE_ROWIDS,ROW_LENGTHS:zr.ROW_LENGTHS,ROW_SPLITS:zr.ROW_SPLITS,ROW_LIMITS:zr.ROW_LIMITS,ROW_STARTS:zr.ROW_STARTS},n=[];for(const s of e)if(s in t)n.push(t[s]);else break;return n}function MB(e){return e.length===0?0:e[0]===zr.FIRST_DIM_SIZE?e.length-1:e.length}function zB(e,t){if(e==null||t==null)return;const n=e.length,s=t.length;if(n>=s)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=e[r],o=t[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${r-e.length}] = ${i} but ragged tensor input.flatValues.shape[${r-e.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pN=30;function Pv(e){return e<=pN?e:by(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mN(e,t,n){const s=n*(typeof e=="number"?e:e[0]),r=t*(typeof e=="number"?e:e[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vg(e,t,n,s=!0){let r=[];if(s)r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const i=t.length;for(let o=0;o<i;++o)r=r.concat([e[o+1]/t[o],t[o]]);r=r.concat(e.slice(i+1))}return r}function wg(e,t,n=!0){const s=[];if(n){s.push(t);for(let r=t+1;r<e;++r)r<=2*t?(s.push(r),s.push(r-(t+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<e;++o)o>=t*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function Sg(e,t,n,s=!0){const r=[];s?r.push(e[0]/n):r.push(e[0]*n);for(let i=1;i<e.length;++i)i<=t.length?s?r.push(t[i-1]*e[i]):r.push(e[i]/t[i-1]):r.push(e[i]);return r}function gN(e,t){const n=[0];for(let s=0;s<t;++s)n.push(e[s][0]);return n}function xN(e,t,n){const s=e.slice(0,1);for(let r=0;r<n;++r)s.push(e[r+1]-t[r][0]-t[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fv=1.7580993408473768,Lv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yN=.3275911,bN=.254829592,vN=-.284496736,wN=1.421413741,SN=-1.453152027,kN=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yo(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let s=0;s<n.length;s+=2)n[s]=e[s/2],n[s+1]=t[s/2];return n}function BB(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let s=0;s<e.length;s+=2)t[s/2]=e[s],n[s/2]=e[s+1];return{real:t,imag:n}}function VB(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let r=0;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],s[Math.floor(r/4)]=e[r+1];return{real:n,imag:s}}function WB(e){const t=Math.floor(e.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let r=2;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],s[Math.floor(r/4)]=e[r+1];return{real:n,imag:s}}function CN(e,t){const n=e[t*2],s=e[t*2+1];return{real:n,imag:s}}function UB(e,t,n,s){e[s*2]=t,e[s*2+1]=n}function jB(e,t){const n=new Float32Array(e/2),s=new Float32Array(e/2);for(let r=0;r<Math.ceil(e/2);r++){const i=(t?2:-2)*Math.PI*(r/e);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function GB(e,t,n){const s=(n?2:-2)*Math.PI*(e/t),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c2="->",uit=/->/g,mD=",",gD="...";function IN(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(uit,"").length)/c2.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${c2}").`);const[s,r]=e.split(c2);T(s.indexOf(gD)===-1,()=>`The ellipsis notation ("${gD}") is not supported yet.`);const i=s.split(mD),o=i.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<r.length;++d){const f=r[d];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<s.length;++d){const f=s[d];a.indexOf(f)===-1&&f!==mD&&a.push(f)}const l=new Array(i.length);for(let d=0;d<o;++d){if(new Set(i[d].split("")).size!==i[d].length)throw new Error(`Found duplicate axes in input component ${i[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<i[d].length;++f)l[d].push(a.indexOf(i[d][f]))}const c=a.length,u=r.length,h=[];for(let d=u;d<c;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function TN(e,t){let n=new Array(e);n.fill(-1);for(let r=0;r<t.length;++r)n[t[r]]=r;const s=[];for(let r=0;r<e;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function NN(e,t,n){const s=new Array(e);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<t[r].length;++o)s[t[r][o]]===void 0?s[t[r][o]]=i[o]:T(s[t[r][o]]===i[o],()=>`Expected dimension ${s[t[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function _N(e,t){const n=e,s=[];let r=0;e.length===0&&n.push(-1),r=e.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=hit(t,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function $N(e){return e.every((t,n)=>t===n)}function hit(e,t){const n=[];for(let s=0;s<e.length;++s)(e[s].length===0||e[s].indexOf(t)!==-1||t===-1)&&n.push(s);return n}function EN(e,t,n=0){let s=[];if(typeof t=="number")T(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),s=new Array(t).fill(e.shape[n]/t);else{const r=t.reduce((o,a)=>(a===-1&&(o+=1),o),0);T(r<=1,()=>"There should be only one negative value in split array.");const i=t.indexOf(-1);if(i!==-1){const o=t.reduce((a,l)=>l>0?a+l:a);t[i]=e.shape[n]-o}T(e.shape[n]===t.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=t}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HB(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function KB(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function qB(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XB(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function YB(e,t){return`size ${e} must be non-negative, not ${t}`}function ZB(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function QB(e,t){const n=X(e),s=X(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${e} outputShape= ${t}`}function JB(e,t){const n=X(e),s=X(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dk(){return"segment ids must be >= 0"}function tV(){return"segment ids are not increasing"}function eV(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function nV(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sV(e,t){let n=!1,s;for(e<=pN?(s=e,n=!0):s=by(e,Math.floor(Math.sqrt(e)));!n;)s>t||s===e?n=!0:s=by(e,s+1);return s}function rV(e,t,n){const s=[],r=e.length;for(let i=0;i<r;i++)i!==t?s.push(e[i]):s.push(n);return s}function AN(e,t,n,s){const r=t.shape.length,i=e.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let h=0;h<s;++h)if(e.shape[h]!==t.shape[h])throw new Error(`x.shape[${h}]: ${e.shape[h]} should be equal to indices.shape[${h}]: ${t.shape[h]}.`);const o=e.shape[n],a=[];let l=1,c=1,u=1;for(let h=0;h<s;++h)a.push(e.shape[h]),l*=e.shape[h];for(let h=s;h<n;h++)a.push(e.shape[h]),c*=e.shape[h];for(let h=s;h<r;h++)a.push(t.shape[h]);for(let h=n+1;h<i;h++)a.push(e.shape[h]),u*=e.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const dit=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:AN,computeOutShape:rV,segOpComputeOptimalWindowSize:sV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bo(e){try{return e.map(t=>po(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function iV(e){return e.map(t=>xi(t))}const oV=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:bN,ERF_A2:vN,ERF_A3:wN,ERF_A4:SN,ERF_A5:kN,ERF_P:yN,PARALLELIZE_THRESHOLD:pN,get RowPartitionType(){return zr},SELU_SCALE:Lv,SELU_SCALEALPHA:Fv,applyActivation:Nv,assertAndGetBroadcastShape:It,assertAxesAreInnerMostDims:$n,assertParamsConsistent:fN,assignToTypedArray:UB,axesAreInnerMostDims:pT,calculateShapes:Ka,checkEinsumDimSizes:NN,checkPadOnDimRoundingMode:es,combineLocations:xz,combineRaggedTensorToTensorShapes:FB,complexWithEvenIndex:VB,complexWithOddIndex:WB,computeConv2DInfo:gn,computeConv3DInfo:Wa,computeDefaultPad:YI,computeDilation2DInfo:ng,computeOptimalWindowSize:Pv,computeOutAndReduceShapes:xn,computeOutShape:bi,computePool2DInfo:Nr,computePool3DInfo:ko,convertConv2DDataFormat:Co,decodeEinsumEquation:IN,eitherStridesOrDilationsAreOne:_n,expandShapeToKeepDim:ze,exponent:GB,exponents:jB,fromStringArrayToUint8:iV,fromUint8ToStringArray:bo,getAxesPermutation:Ne,getBroadcastDims:sc,getComplexWithIndex:CN,getEinsumComputePath:_N,getEinsumPermutation:TN,getFusedBiasGradient:Tv,getFusedDyActivation:Iv,getImageCenter:mN,getInnerMostAxes:Be,getPermuted:wg,getRaggedRank:MB,getReductionAxes:Ye,getReshaped:vg,getReshapedPermuted:Sg,getRowPartitionTypesHelper:LB,getSliceBeginCoords:gN,getSliceSize:xN,getSparseFillEmptyRowsIndicesDenseShapeMismatch:HB,getSparseFillEmptyRowsNegativeIndexErrorMessage:KB,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:qB,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:ZB,getSparseReshapeInputOutputMismatchErrorMessage:JB,getSparseReshapeInputOutputMultipleErrorMessage:QB,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:XB,getSparseReshapeNegativeOutputDimErrorMessage:YB,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:nV,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:dk,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:tV,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:eV,getUndoAxesPermutation:Ua,isIdentityPermutation:$N,log:cZ,mergeRealAndImagArrays:yo,prepareAndValidate:Dv,prepareSplitSize:EN,segment_util:dit,shouldFuse:_v,slice_util:DB,splitRealAndImagArrays:BB,stridesOrDilationsArePositive:nc,tupleValuesAreOne:Ca,upcastType:hs,validateDefaultValueShape:zB,validateInput:vv,validateUpdateShape:WT,warn:Gs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fit=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:$v,nonMaxSuppressionV4Impl:Ev,nonMaxSuppressionV5Impl:Av,whereImpl:kv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ert();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aV={kernelName:Zp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(e,Dc(ot(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pit={kernelName:ch,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const s=ee(ot(n,"float32")),r=pn(dt(yt(1),s));return oe(gt(e,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mit={kernelName:uh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const s=pn(dt(ee(ot(n,"float32")),1));return gt(e,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const git={kernelName:_c,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=It(n.shape,s.shape);return{a:()=>{let a=e;const l=Ye(n.shape,r);return l.length>0&&(a=ft(a,l)),V(a,n.shape)},b:()=>{let a=e;const l=Ye(s.shape,r);return l.length>0&&(a=ft(a,l)),V(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xit={kernelName:Qp,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((s,r)=>{n[r]=()=>e.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yit={kernelName:Jp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Bt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bit={kernelName:tm,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Bt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vit={kernelName:hh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gt(e,pn(dt(yt(1),ee(ot(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wit={kernelName:dh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const s=pn(tt(yt(1),ee(ot(n,"float32"))));return gt(e,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sit={kernelName:mh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=It(n.shape,s.shape);return{a:()=>{const a=tt(ee(n),ee(s));let l=M(e,gt(s,a));const c=Ye(n.shape,r);return c.length>0&&(l=ft(l,c)),V(l,n.shape)},b:()=>{const a=tt(ee(n),ee(s));let l=oe(M(e,gt(n,a)));const c=Ye(s.shape,r);return c.length>0&&(l=ft(l,c)),V(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kit={kernelName:fh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gt(e,tt(ee(ot(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cit={kernelName:ph,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gt(e,dt(yt(1),ee(ot(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iit(e,t,n,s,r,i){const o=_(e,"dy","avgPool3dGrad"),a=_(t,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=V(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=V(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),es("avgPool3dGrad",r,i);const h={dy:l,input:c},d={filterSize:n,strides:s,pad:r,dimRoundingMode:i},f=D.runKernel(H1,h,d);return u?V(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Tit=O({avgPool3dGrad_:Iit});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nit={kernelName:nm,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>Tit(e,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _it(e,t,n,s,r){const i=_(e,"dy","avgPoolGrad"),o=_(t,"input","avgPoolGrad");T(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=V(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},h={filterSize:n,strides:s,pad:r},d=D.runKernel(G1,u,h);return c?V(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const $it=O({avgPoolGrad_:_it});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eit={kernelName:em,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{filterSize:r,strides:i,pad:o}=n;return{x:()=>$it(e,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ait={kernelName:sm,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[s,r]=t,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>Rt(e,r,!1,!0),b:()=>Rt(s,e,!0,!1)}:!i&&o?{a:()=>Rt(e,r,!1,!1),b:()=>Rt(e,s,!0,!1)}:i&&!o?{a:()=>Rt(r,e,!1,!0),b:()=>Rt(s,e,!1,!1)}:{a:()=>Rt(r,e,!0,!0),b:()=>Rt(e,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rit={kernelName:rm,gradFunc:(e,t,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>fg(e,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dit={kernelName:$4,gradFunc:(e,t,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>ft(e,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oit={kernelName:gh,gradFunc:e=>({x:()=>e.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pit={kernelName:xh,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fit={kernelName:yh,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>dn(Tr(Io(s,r),ja(s,i)),e,Bt(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lit={kernelName:om,inputsToSave:["x"],gradFunc:aV.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mit={kernelName:am,saveAllInputs:!0,gradFunc:(e,t,n)=>{const s=t.map(l=>l.shape),{axis:r}=n,i=Dt(r,t[0].shape)[0],o=s.map(l=>l[i]);return us(e,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zit={kernelName:lm,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[s,r]=t,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return T(Ca(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>aT(s.shape,e,r,o,a,l),filter:()=>XT(s,e,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bit={kernelName:cm,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[s,r]=t,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>xo(e,r,i,o,a,1,l),filter:()=>XT(e,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vit(e,t,n,s,r){let i=e;e.rank===4&&(i=V(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let o=t;o.rank===4&&(o=V(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),T(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),T(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),T(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),T(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),T(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return D.runKernel(Z1,a,l)}const Wit=O({conv3DBackpropFilter_:Vit});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uit={kernelName:um,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:s,strides:r,pad:i}=n;T(Ca(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=t;return{x:()=>pz(o.shape,e,a,r,i),filter:()=>Wit(o,e,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jit={kernelName:bh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(oe(mv(ot(n,"float32"))),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Git={kernelName:vh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(gv(ot(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hit={kernelName:hm,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=Ne([r],s.rank);let l=nv(e,r,i,!o);return a!=null&&(l=Ft(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kit={kernelName:dm,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];T(Ca(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=t;return T(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),T(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),T(_n(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),es("depthwiseConv2d",i,o),{x:()=>iB(l.shape,e,c,r,i,a,o),filter:()=>rB(l,e,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qit={kernelName:fm,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[s,r]=t,i={x:s,filter:r,dy:e},o={x:s,filter:r,dy:e};return{x:()=>D.runKernel(vy,i,n),filter:()=>D.runKernel(wy,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xit={kernelName:Sh,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,s={dy:e,y:n};return{x:()=>D.runKernel(lb,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yit={kernelName:kh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,s=M(ps(oe(ee(n))),2/Math.sqrt(Math.PI));return{x:()=>M(e,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zit={kernelName:Ch,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(e,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qit={kernelName:mm,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>V(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jit={kernelName:Ih,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(e,ps(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tot={kernelName:Th,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eot={kernelName:Nh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=It(n.shape,s.shape);return{a:()=>{const a=gt(e,ot(s,"float32")),l=Ye(n.shape,r);return l.length>0?V(ft(a,l),n.shape):a},b:()=>{let a=M(e,ot(n,"float32"));const l=Ye(s.shape,r);l.length>0&&(a=V(ft(a,l),s.shape));const c=ee(s);return oe(gt(a,ot(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const not={kernelName:gm,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=t,l=a??yt(1),c=Ye(i.shape,r.shape),u=[];if(i.rank===1){for(let v=0;v<r.shape.length-1;++v)u.push(r.shape[v]);u.push(1)}const h=dt(r,i),d=M(e,l),f=dv(tt(o,yt(s))),p=M(M(M(f,f),f),yt(-.5));return{x:()=>i.rank===1?V(M(M(e,Xs(V(f,[1,1,1,i.shape[0]]),u)),l),r.shape):V(M(M(e,f),l),r.shape),mean:()=>{let v=M(M(f,yt(-1)),d);return i.rank===1&&(v=ft(v,c)),V(v,i.shape)},variance:()=>{let v=M(M(p,h),d);return i.rank===1&&(v=ft(v,c)),V(v,i.shape)},scale:()=>{const v=M(h,f);let w=M(e,v);return i.rank===1&&(w=ft(w,c)),V(w,i.shape)},offset:()=>{let v=e;return i.rank===1&&(v=ft(v,c)),V(v,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sot={kernelName:xm,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[s,r]=t,{axis:i,batchDims:o}=n,a=Dt(i,s.shape)[0],l=(c,u,h)=>()=>{const d=c.shape,f=u.size,p=d.slice(0,a),g=p.length,m=d.slice(i,d.length).slice(1),x=m.length,y=xD(0,g),b=xD(g+1,g+1+x),v=yD([p,[f],m]),w=V(h,v),k=V(u,[f]),I=yD([[g],y,b]),C=Ft(w,I);let N=Sv(C,k,c.shape[a]);const $=Ua(I);return N=Ft(N,$),N};if(o===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>Qn(u.map((f,p)=>l(f,r.slice(p,1),e.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,e),indices:()=>r}}};function xD(e,t){const n=[];for(let s=e;s<t;++s)n.push(s);return n}function yD(e){const t=[];for(let n=0;n<e.length;++n)for(let s=0;s<e[n].length;++s)t.push(e[n][s]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rot={kernelName:_h,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t;return{a:()=>Bt(n),b:()=>Bt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iot={kernelName:$h,gradFunc:e=>({x:()=>ot(e,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oot={kernelName:Eh,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aot={kernelName:Ah,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lot={kernelName:Rh,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cot={kernelName:bm,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{alpha:r}=n,i=ns(s,0);return{x:()=>dn(i,e,M(e,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uot={kernelName:Oh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gt(e,tt(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hot={kernelName:Dh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gt(e,ot(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dot={kernelName:E4,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s]=t,{axis:r}=n;return{logits:()=>{const o=ps(s);return dt(e,M(ft(e,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fot(e,t,n,s=5,r=1,i=1,o=.5){const a={x:e,y:t,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return D.runKernel(gb,a,l)}const pot=O({localResponseNormalizationBackprop_:fot});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mot={kernelName:Im,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s,r]=t,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>pot(s,r,e,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(e,t,n,s){return t.rank<n.rank&&(t=V(t,ze(t.shape,s))),e.rank<n.rank&&(e=V(e,ze(e.shape,s))),{x:()=>M(e,ot(Os(n,t),e.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bD={kernelName:Tm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const s=n,{reductionIndices:r}=s,i=t[0],o=t[1],a=Dt(r,i.shape),l=lV(e,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const got={kernelName:Ph,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t;return{a:()=>M(e,ot(Io(n,s),"float32")),b:()=>M(e,ot(Uu(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xot(e,t,n,s,r,i,o){const a=_(e,"dy","maxPool3dGrad"),l=_(t,"input","maxPool3dGrad"),c=_(n,"output","maxPool3dGrad");let u=a,h=l,d=c,f=!1;l.rank===4&&(f=!0,u=V(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=V(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=V(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),T(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),T(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),T(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),es("maxPool3dGrad",i,o);const p={dy:u,input:h,output:d},g={filterSize:s,strides:r,pad:i,dimRoundingMode:o},m=D.runKernel(yb,p,g);return f?V(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const yot=O({maxPool3dGrad_:xot});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bot={kernelName:_m,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s,r]=t,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>yot(e,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vot(e,t,n,s,r,i,o){const a=_(e,"dy","maxPoolGrad"),l=_(t,"input","maxPoolGrad"),c=_(n,"output","maxPoolGrad");T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),es("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},h={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return D.runKernel(xb,u,h)}const wot=O({maxPoolGrad_:vot});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sot={kernelName:Nm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s,r]=t,{filterSize:i,strides:o,pad:a}=n;return{x:()=>wot(e,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kot={kernelName:$m,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{axis:r}=n,i=Dt(r,s.shape),a=xn(s.shape,i)[1],l=X(a);return{x:()=>{const u=s.shape.slice();i.forEach(f=>{u[f]=1});const h=V(e,u);return gt(M(h,ls(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cot={kernelName:Em,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const s=n,{axis:r}=s,[i,o]=t,a=Dt(r,i.shape),l=lV(e,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iot={kernelName:Fh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t;return{a:()=>M(e,ot(ja(n,s),"float32")),b:()=>M(e,ot(ns(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tot={kernelName:Am,inputsToSave:["x"],gradFunc:(e,t,n)=>{const s=t[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>zt(e,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Not={kernelName:Lh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=It(n.shape,s.shape);return{a:()=>{const a=Ye(n.shape,r);return a.length>0?V(ft(e,a),n.shape):e},b:()=>{const a=M(e,oe(ld(gt(n,s)))),l=Ye(s.shape,r);return l.length>0?V(ft(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ot={kernelName:Mh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=It(n.shape,s.shape);return{a:()=>{const a=M(e,ot(s,"float32")),l=Ye(n.shape,r);return l.length>0?V(ft(a,l),n.shape):a},b:()=>{const a=M(e,ot(n,"float32")),l=Ye(s.shape,r);return l.length>0?V(ft(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ot={kernelName:Rm,gradFunc:e=>({x:()=>oe(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eot={kernelName:Pm,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>He(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aot={kernelName:Om,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rot={kernelName:Fm,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:s}=n;return rr(e,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vD={kernelName:Lm,inputsToSave:["x"],gradFunc:(e,t,n)=>{const s=t[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>zt(e,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dot={kernelName:zh,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,s,r]=t,i=n,o=s,a=It(i.shape,o.shape);return{a:()=>{const u=ot(o,"float32");let h=M(e,M(u,Ti(i,dt(u,yt(1)))));const d=Ye(i.shape,a);return d.length>0&&(h=ft(h,d)),V(h,i.shape)},b:()=>{const u=ns(i,0),h=dn(u,Ps(i),Bt(i));let d=M(e,M(r,h));const f=Ye(o.shape,a);return f.length>0&&(d=ft(d,f)),V(d,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oot={kernelName:Mm,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,s]=t,r=ns(n,0);return{x:()=>dn(r,e,M(e,s)),alpha:()=>{let i=dn(r,Bt(e),M(e,n));const o=Ye(s.shape,e.shape);return o.length>0&&(i=ft(i,o)),V(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pot(e,t,n){const s=e.shape.slice();s[n]=1;const r=V(t,s),i=kp(e,n,!0,!1),o=kp(e,n,!0,!0),a=M(i,o);return M(r,a)}function Fot(e,t,n){const s=e.shape.length,r=s-n.length,i=Ne(n,s);let o=e;i!=null&&(o=Ft(e,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((d,f)=>d*f,1);a.push(c);const u=o.reshape(a);let h=Pot(u,t,r);if(h=h.reshape(o.shape),i!=null){const d=Ua(i);h=Ft(h,d)}return h}const Lot={kernelName:zm,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>Fot(s,e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mot={kernelName:wh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=It(n.shape,s.shape);return{a:()=>{const a=gt(e,ot(s,"float32")),l=Ye(n.shape,r);return l.length>0?V(ft(a,l),n.shape):a},b:()=>{let a=M(e,ot(n,"float32"));const l=Ye(s.shape,r);l.length>0&&(a=V(ft(a,l),s.shape));const c=ee(s);return oe(gt(a,ot(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zot={kernelName:Bh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gt(e,oe(ee(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bot={kernelName:Wh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,s=M(ja(n,6),Dc(n));return{x:()=>M(e,ot(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vot={kernelName:Vh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(e,ot(Dc(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wot={kernelName:Bm,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>V(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uot={kernelName:Wm,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[s]=t,r={dy:e,images:s};return{images:()=>D.runKernel(Eb,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jot={kernelName:Vm,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[s]=t,r={dy:e,images:s};return{images:()=>D.runKernel($b,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Got={kernelName:Um,gradFunc:(e,t,n)=>{const{dims:s}=n,r=Dt(s,e.shape);return{x:()=>sr(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hot={kernelName:Uh,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kot={kernelName:jh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oe(gt(e,M(Ti(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qot={kernelName:jm,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>ot(Bt(n),"float32"),t:()=>M(e,ot(n,e.dtype)),e:()=>M(e,ot(ug(n),e.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xot={kernelName:Gh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const s=ns(n,yt(0)),r=yt(Fv),i=yt(Lv),o=M(e,i),a=M(M(e,r),ps(ot(n,"float32")));return dn(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yot={kernelName:Xh,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(e,M(n,dt(yt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zot={kernelName:qh,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qot={kernelName:Hh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(ig(ot(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jot={kernelName:Kh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(ev(ot(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tat={kernelName:Gm,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{begin:r,size:i}=n,o=s.shape,[a,l]=Ov(s,r,i),c=[];for(let u=0;u<e.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>To(e,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eat={kernelName:Xm,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[s]=t,{dim:r}=n,i=!0,o=M(e,s);return{logits:()=>dt(o,M(ft(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nat={kernelName:Yh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(e,jr(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wD={kernelName:Km,gradFunc:(e,t,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>rg(e,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SD={kernelName:qm,gradFunc:(e,t,n)=>{const{axis:s}=n;return{x:()=>Me(e,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sat={kernelName:Zh,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gt(e,M(pn(ot(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rat={kernelName:zb,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(e,M(ot(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iat={kernelName:Qh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=yt(2);return{a:()=>M(e,M(r,dt(n,s))),b:()=>M(e,M(r,dt(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oat={kernelName:sd,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aat={kernelName:Jh,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,s]=t,r=It(n.shape,s.shape);return{a:()=>{let a=e;const l=Ye(n.shape,r);return l.length>0&&(a=ft(a,l)),V(a,n.shape)},b:()=>{let a=e;const l=Ye(s.shape,r);return l.length>0&&(a=ft(a,l)),V(oe(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lat={kernelName:Hm,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,r=s.shape.slice(),{axis:i}=n;Dt(i,s.shape).forEach(c=>{r[c]=1});const a=V(e,r),l=M(a,ls(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cat={kernelName:td,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gt(e,ee(ig(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uat={kernelName:ed,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>M(dt(yt(1),ee(n)),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hat={kernelName:nd,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[s]=t,{reps:r}=n;return{x:()=>{let o=Bt(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=tt(o,zt(e,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=tt(o,zt(e,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=tt(o,zt(e,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=tt(o,zt(e,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dat={kernelName:Dl,gradFunc:(e,t,n)=>{const s=n,{perm:r}=s,i=Ua(r);return{x:()=>Ft(e,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fat={kernelName:Zm,gradFunc:(e,t,n)=>{const s=n,{axis:r}=s;return{value:()=>Qn(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pat={kernelName:Qm,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>mat(e,n)}}};function mat(e,t){const n=Ei(t,Bt(t)),s=cd(e,n);let r=Io(t,yt(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=wn(r,a+1);r=Tr(r,ls(s.shape,"bool"));const o=Bt(s);return dn(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gat={kernelName:Jm,gradFunc:e=>({x:()=>Bt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xat=[aV,pit,mit,git,xit,yit,bit,vit,wit,Sit,kit,Cit,Nit,Eit,Ait,Rit,Dit,Oit,Pit,Fit,Lit,Mit,Bit,zit,Uit,jit,Git,Hit,Kit,qit,Mot,Xit,Yit,Zit,Qit,Jit,eot,tot,not,sot,rot,iot,oot,aot,lot,cot,uot,hot,dot,mot,bD,bD,got,bot,Sot,kot,Cot,Iot,Tot,Not,_ot,$ot,Eot,Aot,Rot,vD,vD,Dot,Oot,Lot,zot,Bot,Vot,Wot,Uot,jot,Got,Hot,Kot,qot,Xot,Yot,Zot,Qot,Jot,tat,eat,nat,wD,wD,SD,SD,sat,iat,rat,oat,aat,lat,cat,uat,hat,dat,fat,pat,gat];for(const e of xat)A4(e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.abs=function(){return this.throwIfDisposed(),je(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.acos=function(){return this.throwIfDisposed(),WI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.acosh=function(){return this.throwIfDisposed(),UI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.add=function(e){return this.throwIfDisposed(),tt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.all=function(e,t){return this.throwIfDisposed(),Qb(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.any=function(e,t){return this.throwIfDisposed(),vp(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.argMax=function(e){return this.throwIfDisposed(),ec(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.argMin=function(e){return this.throwIfDisposed(),jI(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,()=>"The array must have only 1 element."),V(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.asType=function(e){return this.throwIfDisposed(),ot(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as1D=function(){return this.throwIfDisposed(),V(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as2D=function(e,t){return this.throwIfDisposed(),V(this,[e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),V(this,[e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as4D=function(e,t,n,s){return this.throwIfDisposed(),V(this,[e,t,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as5D=function(e,t,n,s,r){return this.throwIfDisposed(),V(this,[e,t,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.asin=function(){return this.throwIfDisposed(),GI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.asinh=function(){return this.throwIfDisposed(),HI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.atan=function(){return this.throwIfDisposed(),KI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.atan2=function(e){return this.throwIfDisposed(),qI(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.atanh=function(){return this.throwIfDisposed(),XI(this)};Z().prototype.avgPool=function(e,t,n,s){return this.throwIfDisposed(),sg(this,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),rg(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.batchNorm=function(e,t,n,s,r){return this.throwIfDisposed(),rd(this,e,t,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Ol(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cast=function(e){return this.throwIfDisposed(),ot(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.ceil=function(){return this.throwIfDisposed(),nT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),fs(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Ut&&(e=[e]),Me([this,...e],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.conv1d=function(e,t,n,s,r,i){return this.throwIfDisposed(),Jb(this,e,t,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.conv2dTranspose=function(e,t,n,s,r){return this.throwIfDisposed(),tv(this,e,t,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.conv2d=function(e,t,n,s,r,i){return this.throwIfDisposed(),xo(this,e,t,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cos=function(){return this.throwIfDisposed(),ig(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cosh=function(){return this.throwIfDisposed(),ev(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),kp(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),nv(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),uT(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.depthwiseConv2d=function(e,t,n,s,r,i){return this.throwIfDisposed(),id(this,e,t,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.dilation2d=function(e,t,n,s,r){return this.throwIfDisposed(),hT(this,e,t,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.divNoNan=function(e){return this.throwIfDisposed(),dT(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.div=function(e){return this.throwIfDisposed(),gt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.dot=function(e){return this.throwIfDisposed(),fT(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.elu=function(){return this.throwIfDisposed(),od(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.equal=function(e){return this.throwIfDisposed(),Os(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.erf=function(){return this.throwIfDisposed(),sv(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),mT(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.exp=function(){return this.throwIfDisposed(),ps(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.expandDims=function(e){return this.throwIfDisposed(),wn(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.expm1=function(){return this.throwIfDisposed(),gT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.fft=function(){return this.throwIfDisposed(),yg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.flatten=function(){return this.throwIfDisposed(),V(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.floor=function(){return this.throwIfDisposed(),ld(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.floorDiv=function(e){return this.throwIfDisposed(),Zb(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.gather=function(e,t,n){return this.throwIfDisposed(),cd(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Io(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.greater=function(e){return this.throwIfDisposed(),ns(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.ifft=function(){return this.throwIfDisposed(),Ku(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.irfft=function(){return this.throwIfDisposed(),yv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.isFinite=function(){return this.throwIfDisposed(),xT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.isInf=function(){return this.throwIfDisposed(),yT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.isNaN=function(){return this.throwIfDisposed(),bT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.leakyRelu=function(e){return this.throwIfDisposed(),ag(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.lessEqual=function(e){return this.throwIfDisposed(),ja(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.less=function(e){return this.throwIfDisposed(),Uu(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.localResponseNormalization=function(e,t,n,s){return this.throwIfDisposed(),vT(this,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logSigmoid=function(){return this.throwIfDisposed(),wT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logSoftmax=function(e){return this.throwIfDisposed(),ov(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),cg(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.log=function(){return this.throwIfDisposed(),Ps(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.log1p=function(){return this.throwIfDisposed(),lg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Tr(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logicalNot=function(){return this.throwIfDisposed(),ug(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logicalOr=function(e){return this.throwIfDisposed(),av(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logicalXor=function(e){return this.throwIfDisposed(),ST(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Rt(this,e,t,n)};Z().prototype.maxPool=function(e,t,n,s){return this.throwIfDisposed(),hg(this,e,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.max=function(e,t){return this.throwIfDisposed(),tr(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.maximum=function(e){return this.throwIfDisposed(),Ei(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.mean=function(e,t){return this.throwIfDisposed(),ke(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.min=function(e,t){return this.throwIfDisposed(),Wu(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.minimum=function(e){return this.throwIfDisposed(),Ta(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),CT(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.mod=function(e){return this.throwIfDisposed(),IT(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.mul=function(e){return this.throwIfDisposed(),M(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.neg=function(){return this.throwIfDisposed(),oe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.norm=function(e,t,n){return this.throwIfDisposed(),ad(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.notEqual=function(e){return this.throwIfDisposed(),rc(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),ju(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.onesLike=function(){return this.throwIfDisposed(),Fs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.pad=function(e,t){return this.throwIfDisposed(),To(this,e,t)};Z().prototype.pool=function(e,t,n,s,r,i){return this.throwIfDisposed(),TT(this,e,t,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.pow=function(e){return this.throwIfDisposed(),Ti(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.prelu=function(e){return this.throwIfDisposed(),pg(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.prod=function(e,t){return this.throwIfDisposed(),NT(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.reciprocal=function(){return this.throwIfDisposed(),LT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.relu=function(){return this.throwIfDisposed(),ei(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.relu6=function(){return this.throwIfDisposed(),uv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.reshapeAs=function(e){return this.throwIfDisposed(),V(this,e.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.reshape=function(e){return this.throwIfDisposed(),V(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),cB(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),uB(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.reverse=function(e){return this.throwIfDisposed(),sr(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.rfft=function(){return this.throwIfDisposed(),bg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.round=function(){return this.throwIfDisposed(),hv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.rsqrt=function(){return this.throwIfDisposed(),dv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.selu=function(){return this.throwIfDisposed(),fv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.separableConv2d=function(e,t,n,s,r,i){return this.throwIfDisposed(),pv(this,e,t,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sigmoid=function(){return this.throwIfDisposed(),jr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sign=function(){return this.throwIfDisposed(),MT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sin=function(){return this.throwIfDisposed(),mv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sinh=function(){return this.throwIfDisposed(),gv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.slice=function(e,t){return this.throwIfDisposed(),zt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.softmax=function(e){return this.throwIfDisposed(),xg(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.softplus=function(){return this.throwIfDisposed(),Ac(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),fg(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.split=function(e,t){return this.throwIfDisposed(),us(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sqrt=function(){return this.throwIfDisposed(),pn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.square=function(){return this.throwIfDisposed(),ee(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.squaredDifference=function(e){return this.throwIfDisposed(),bv(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.squeeze=function(e){return this.throwIfDisposed(),Ha(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof Ut?[this,e]:[this,...e];return Qn(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.step=function(e){return this.throwIfDisposed(),Dc(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.stridedSlice=function(e,t,n,s,r,i,o,a){return this.throwIfDisposed(),zT(this,e,t,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sub=function(e){return this.throwIfDisposed(),dt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sum=function(e,t){return this.throwIfDisposed(),ft(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.tan=function(){return this.throwIfDisposed(),BT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.tanh=function(){return this.throwIfDisposed(),Ia(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.tile=function(e){return this.throwIfDisposed(),Xs(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.toBool=function(){return this.throwIfDisposed(),ot(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.toFloat=function(){return this.throwIfDisposed(),ot(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.toInt=function(){return this.throwIfDisposed(),ot(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.topk=function(e,t){return this.throwIfDisposed(),UT(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.transpose=function(e){return this.throwIfDisposed(),Ft(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.unique=function(e){return this.throwIfDisposed(),jT(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Sv(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.unstack=function(e){return this.throwIfDisposed(),rr(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.where=function(e,t){return this.throwIfDisposed(),dn(e,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.zerosLike=function(){return this.throwIfDisposed(),Bt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class li extends Error{constructor(t){super(t),Object.setPrototypeOf(this,li.prototype)}}class Sr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Sr.prototype)}}class W extends Error{constructor(t){super(t),Object.setPrototypeOf(this,W.prototype)}}class $t extends Error{constructor(t){super(t),Object.setPrototypeOf(this,$t.prototype)}}class RN extends Error{constructor(t){super(t),Object.setPrototypeOf(this,RN.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cV{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ac(e,t){if(Array.isArray(e)){let n=[];for(let s=0;s<t;s++)n=n.concat(e);return n}else{const n=new Array(t);return n.fill(e),n}}function ci(e,t){if(!e)throw new RN(t)}function kD(e,t){let n=0;for(const s of e)s===t&&n++;return n}function os(e){return e.length===1?e[0]:e}function Yt(e){return Array.isArray(e)?e:[e]}function Bi(e){const n=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function gl(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let cr={};function DN(e){if(e==null)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function fk(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>fk(t));else{const t=Object.keys(e);for(const n of t){const s=e[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?e[n]=s.value:fk(s))}}}function kg(e,t={},n={},s="object",r=!1){if(typeof e=="string"){const i=e;let o;if(i in n)o=n[i];else if(i in cr)o=cr[i];else if(o=t[i],o==null)throw new W(`Unknown ${s}: ${e}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=e;if(i.className==null||i.config==null)throw new W(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in cr?[a,l]=cr.className:o in t&&([a,l]=t[o]),a==null)throw new W(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(cr))c[f]=cr[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const h=Object.assign({},cr);for(const f of Object.keys(n))cr[f]=n[f];fk(i.config);const d=l(a,i.config,n,r);return cr=Object.assign({},h),d}else{const c=Object.assign({},cr);for(const h of Object.keys(n))cr[h]=n[h];const u=new a(i.config);return cr=Object.assign({},c),u}}}function yat(e,t){return e<t?-1:e>t?1:0}function p0(e,t){return-1*yat(e,t)}function da(e){if(e==null)return e;const t=[];for(const n of e)t.indexOf(n)===-1&&t.push(n);return t}function bat(e){if(e==null)throw new W(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function Pc(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new W(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function ON(e,t,n=0,s=1/0){return ci(n>=0),ci(s>=n),Array.isArray(e)&&e.length>=n&&e.length<=s&&e.every(r=>typeof r===t)}function un(e,t){Array.isArray(e)?(T(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,s)=>un(n,`element ${s+1} of ${t}`))):T(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${uV(e)}.`)}function uV(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>uV(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function vat(e,t,n){let s=n!=null?n():vn(),r;return(...o)=>{const a=n!=null?n():vn();return a-s<t||(s=a,r=e(...o)),r}}function hV(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let wat=0;function dV(){return wat++}const m0={};function Mv(e=""){return e in m0||(m0[e]=0),m0[e]+=1,e+m0[e].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Sat=["channelsFirst","channelsLast"],kat=["nearest","bilinear"],Cat=["valid","same","causal"],Iat=["max","avg"],Tat=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const jc=new Map;function Ve(e){Pc(Sat,"DataFormat",e)}function Nat(e){Pc(kat,"InterpolationFormat",e)}function ar(e){Pc(Cat,"PaddingMode",e)}function fV(e){Pc(Iat,"PoolMode",e)}const Af=[],CD="/";function Pl(e,t){Af.push(e);try{const n=t();return Af.pop(),n}catch(n){throw Af.pop(),n}}function _at(){return Af.length===0?"":Af.join(CD)+CD}function pV(e){if(!gV(e))throw new Error("Not a valid tensor name: '"+e+"'");return _at()+e}function mV(e){if(!gV(e))throw new Error("Not a valid tensor name: '"+e+"'");jc.has(e)||jc.set(e,0);const t=jc.get(e);if(jc.set(e,jc.get(e)+1),t>0){const n=`${e}_${t}`;return jc.set(n,1),n}else return e}const $at=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function gV(e){return!!e.match($at)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Eat(e){return e===parseInt(e.toString(),10)}function fa(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let s=1;for(let r=t;r<n;++r)s*=e[r];return s}function qu(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const s=e[n];s<t&&(t=s)}return t}function Na(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const s=e[n];s>t&&(t=s)}return t}function Xr(e,t){if(t<e)throw new W(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let s=e;s<t;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let u2;function tn(){return u2==null&&(u2=FI().epsilon()),u2}function Yr(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vi(e,t){return ot(e,t)}function Cg(e,t=-1){const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),V(e,n)}function Aat(e,t){return G(()=>{if(e.shape.length!==2)throw new W(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);const n=Cg(e,1);return pk(n,[1,t,1])})}function Rat(e){const t=[fa(e.shape)];return V(e,t)}function Dat(e){if(e.rank<=1)throw new W(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],fa(e.shape,1)];return V(e,t)}function Fl(e,t,n){return G(()=>{switch(e.rank){case 1:return mg(e,t,n);case 2:return xv(e,[t,0],[n,e.shape[1]]);case 3:return gg(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return Hu(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return zt(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return zt(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new W(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function h2(e,t,n){return G(()=>{switch(e.rank){case 1:return mg(e,t,n);case 2:return xv(e,[0,t],[e.shape[0],n]);case 3:return gg(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return Hu(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new W(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function g0(e,t,n,s){return G(()=>{switch(e.rank){case 1:return mg(e,t,n);case 2:switch(s){case 1:return Fl(e,t,n);case 2:return h2(e,t,n);default:throw new W(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Fl(e,t,n);case 2:return gg(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return h2(e,t,n);default:throw new W(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Fl(e,t,n);case 2:return Hu(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return Hu(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return h2(e,t,n);default:throw new W(`The axis is not within the rank of the tensor ${s}`)}default:throw new W(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function PN(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),Me(e,t)}function ID(e,t){switch(e.rank){case 1:return sT([e,t]);case 2:return rT([e,t],0);case 3:return iT([e,t],0);case 4:return oT([e,t],0);default:throw new W(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function pk(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new W(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return Xs(e,t)}function zv(e,t=0,n=1,s,r){return cv(e,t,n,s,r)}function wi(e,t,n,s){if(e.rank<2||t.rank<2)throw new $t(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){const r=e.shape.slice(-1)[0],i=t.shape.slice(-2)[0];if(r!==i)throw new $t(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return lk({a:e,b:t,transposeA:!1,transposeB:!1,bias:s?mk(e.rank,s,Yr()):null,activation:n});{const r=e.shape.slice(),i=r.pop();e=V(e,[-1,i]);const o=t.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:t.rank},(p,g)=>g===0?t.rank-2:g<=t.rank-2?g-1:g);t=V(Ft(t,u),[l,-1]);const h=[...r,...c];return V(lk({a:e,b:t,transposeA:!1,transposeB:!1,bias:s?mk(e.rank,s,Yr()):null,activation:n}),h)}}function xV(e,t,n){return G(()=>(Array.isArray(t)?t=cn(t,"int32"):t=ot(t,"int32"),cd(e,t,n)))}function Ig(e){return M(e,e)}function mk(e,t,n){const s=t.shape;if(t.rank!==1&&t.rank!==e)throw new W(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return s.length===1?V(t,[1,s[0],1,1,1]):V(t,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?V(t,[1,1,1,1,s[0]]):V(t,[1].concat(s))}else if(e===4){if(n==="channelsFirst")return s.length===1?V(t,[1,s[0],1,1]):V(t,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?V(t,[1,1,1,s[0]]):V(t,[1].concat(s))}else if(e===3){if(n==="channelsFirst")return s.length===1?V(t,[1,s[0],1]):V(t,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?V(t,[1,1,s[0]]):V(t,[1].concat(s))}else if(e<3)return t;throw new W(`Unsupported input rank by biasAdd: ${t.rank}`)}function ni(e,t,n){return G(()=>(n==null&&(n=Yr()),Ve(n),tt(e,mk(e.rank,t,n))))}function Oat(e,t=1){if(t!==1)throw new $t(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return od(e)}function Pat(e){return G(()=>gt(e,tt(je(e),1)))}function yV(e,t,n,s){return G(()=>KT(e,t,n,s))}function Fat(e){return G(()=>{const t=tt(.5,M(.2,e));return fs(t,0,1)})}function Tg(e,t,n=!1){return n?e():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Lat=["fanIn","fanOut","fanAvg"],Mat=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zat(e){Pc(Lat,"FanMode",e)}function Bat(e){Pc(Mat,"Distribution",e)}class _r extends Oc{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class FN extends _r{apply(t,n){return He(t,n)}}FN.className="Zeros";st(FN);class Bv extends _r{apply(t,n){return ls(t,n)}}Bv.className="Ones";st(Bv);class LN extends _r{constructor(t){if(super(),typeof t!="object")throw new W(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new W(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return G(()=>M(yt(this.value),ls(t,n)))}getConfig(){return{value:this.value}}}LN.className="Constant";st(LN);class MN extends _r{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return Ga(t,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}MN.className="RandomUniform";st(MN);class zN extends _r{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new $t(`randomNormal does not support dType ${n}.`);return zv(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}zN.className="RandomNormal";st(zN);class BN extends _r{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new $t(`truncatedNormal does not support dType ${n}.`);return wv(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}BN.className="TruncatedNormal";st(BN);class VN extends _r{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,n){return G(()=>{if(t.length!==2||t[0]!==t[1])throw new W("Identity matrix initializer can only be used for 2D square matrices.");return M(this.gain,rv(t[0]))})}getConfig(){return{gain:this.gain}}}VN.className="Identity";st(VN);function Vat(e,t="channelsLast"){let n,s;if(Ve(t),e.length===2)n=e[0],s=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){const r=fa(e,2);n=e[1]*r,s=e[0]*r}else if(t==="channelsLast"){const r=fa(e,0,e.length-2);n=e[e.length-2]*r,s=e[e.length-1]*r}}else{const r=fa(e);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class ms extends _r{constructor(t){if(super(),t.scale<0)throw new W(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,zat(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,Bat(this.distribution),this.seed=t.seed}apply(t,n){const s=Vat(t),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new $t(`${this.getClassName()} does not support dType ${n}.`);return wv(t,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Ga(t,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}ms.className="VarianceScaling";st(ms);class Vv extends ms{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return ms.className}}Vv.className="GlorotUniform";st(Vv);class Wv extends ms{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return ms.className}}Wv.className="GlorotNormal";st(Wv);class Uv extends ms{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return ms.className}}Uv.className="HeNormal";st(Uv);class jv extends ms{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return ms.className}}jv.className="HeUniform";st(jv);class Gv extends ms{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return ms.className}}Gv.className="LeCunNormal";st(Gv);class Hv extends ms{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return ms.className}}Hv.className="LeCunUniform";st(Hv);class WN extends _r{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,n){return G(()=>{if(t.length<2)throw new $t("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=X(t.slice(0,-1)),r=t[t.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],a=zv(o,0,1,n,this.seed),l=ZT.qr(a,!1);let c=l[0];const h=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=M(c,h.sign()),s<r&&(c=c.transpose()),M(yt(this.gain),c.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}WN.className="Orthogonal";st(WN);const TD={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function ND(e,t={}){return kg(e,Hs.getMap().classNameMap,t,"initializer")}function Ie(e){return DN(e)}function xe(e){if(typeof e=="string"){const t=e in TD?TD[e]:e;if(t==="GlorotNormal")return new Wv;if(t==="GlorotUniform")return new Vv;if(t==="HeNormal")return new Uv;if(t==="HeUniform")return new jv;if(t==="LeCunNormal")return new Gv;if(t==="LeCunUniform")return new Hv;{const n={};return n.className=t,n.config={},ND(n)}}else return e instanceof _r?e:ND(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gk(e){return Array.isArray(e)&&Array.isArray(e[0])}function _y(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function kt(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new W(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function Gt(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new W(`Expected exactly 1 Shape; got ${e.length}`)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $y(e){let t=0;for(const n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((s,r)=>s*r);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _D="Variable";class bV{constructor(t,n="float32",s=_D,r=!0,i=null){this.dtype=n??"float32",this.shape=t.shape,this.id=dV(),s=s??_D,this.originalName=pV(s),this.name=mV(this.originalName),this.trainable_=r,this.constraint=i,this.val=GT(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),Wat(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function Wat(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function xk(e){return e.map(t=>t.read())}function UN(e){e.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ke{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Zr{constructor(t,n,s,r,i,o,a){this.dtype=t,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=dV(),o!=null&&(this.originalName=pV(o),this.name=mV(this.originalName)),this.rank=n.length}}let Uat=0;class Kv{constructor(t,n){this.callArgs=n,this.id=Uat++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const s of t.inboundLayers)s!=null&&s.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let jat=0;class Ot extends Oc{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=jat++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const s=this.getClassName();n=Bi(s)+"_"+Mv(s)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let s;if(t.batchInputShape!=null)s=t.batchInputShape;else if(t.inputShape!=null){let i=null;t.batchSize!=null&&(i=t.batchSize),s=[i].concat(t.inputShape)}this.batchInputShape=s;let r=t.dtype;r==null&&(r=t.inputDType),r==null&&(r="float32"),this.dtype=r}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new Sr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new W(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return os(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return os(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new li(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new li(`Layer ${this.name} is not connected, no input to return.`);return os(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new li(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new li(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return os(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const n=Yt(t);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Yt(this.inputSpec);if(n.length!==s.length)throw new W(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${t}`);for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new W(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),h=o.axes[c],d=u>=0?l[u]:l[l.length+u];if(h!=null&&[h,null].indexOf(d)===-1)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${h} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const s=Yt(t),r=Kat(t),i=qat(t);if(r===i)throw new W("Arguments to apply() must be all SymbolicTensors or all Tensors");return Pl(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const o=[];for(const a of Yt(t))o.push(a.shape);this.build(os(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(t),i){let o=this.call(t,n);this.supportsMasking&&this.setMaskMetadata(t,o);const a=Yt(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=os(l),this.activityRegularizer!=null)throw new $t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=Gat(t),a=this.computeOutputShape(o);let l;const c=Hat(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,h)=>new Zr(c,u,this,Yt(t),n,this.name,h)):l=new Zr(c,a,this,Yt(t),n,this.name),this.addInboundNode(t,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new $t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&t[r]!=null&&t[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new li(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);t.indexOf(s)===-1&&t.push(s)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new li(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Sr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return $y(this.weights)}build(t){this.built=!0}getWeights(t=!1){return xk(t?this.trainableWeights:this.weights)}setWeights(t){G(()=>{const n=this.weights;if(n.length!==t.length)throw new W(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const s=[],r=xk(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=t[i];if(!Pt(o.shape,l.shape))throw new W(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}UN(s)})}addWeight(t,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(t)!==-1)throw new W(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():xe("zeros"));const c=r.apply(n,s),u=new bV(c,s,t,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=Yt(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(t,n,s){if(!this.supportsMasking)return;const r=this.computeMask(t,s),i=Yt(n),o=Yt(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(t,n,s,r,i,o,a=null){const l=Yt(t);n=Yt(n),s=Yt(s),r=Yt(r),i=_y(i),o=_y(o);const c=[],u=[],h=[];for(const d of l)c.push(d.sourceLayer),u.push(d.nodeIndex),h.push(d.tensorIndex);new Kv({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:h,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function Gat(e){e=Yt(e);const t=[];for(const n of e)t.push(n.shape);return os(t)}function Hat(e){return"float32"}function vV(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{const s=t.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=vV(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function Kat(e){let t=!0;for(const n of Yt(e))if(!(n instanceof Zr)){t=!1;break}return t}function qat(e){let t=!0;for(const n of Yt(e))if(n instanceof Zr){t=!1;break}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dd extends Ot{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:Mv("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new W("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new W("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new W("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=t.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new Zr(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new W(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}dd.className="InputLayer";st(dd);function wV(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new W("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new dd({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xat(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return ot(t,e.dtype)}catch{throw new W(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}class Xo{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Xo)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,s){if(this.id2Value[t.id]==null)this.id2Value[t.id]=Xat(t,n),this.name2Id[t.name]=t.id,s!=null&&(this.id2Mask[t.id]=s);else throw new W(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Zr){if(this.id2Value[t.id]==null)throw new W(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new W(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof Zr){if(this.id2Value[t.id]==null)throw new W(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new W(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Ct(this.id2Mask)}}const Ey=new cV,Ay=new cV;function Yat(e){Ey!=null&&Ey.setMaxEntries(e),Ay!=null&&Ay.setMaxEntries(e)}function nf(e,t,n,s){const r=n==null?!1:n.training,i=Array.isArray(e),o=i?e:[e],a=o.map(p=>p.name),l=[],c=t.names();for(const p of a)c.indexOf(p)!==-1?l.push(t.getValue(p)):l.push(null);const u=a.join(",")+"|"+t.names().sort().join(",");let h=Ey.get(u),d;if(h==null){const p=Zat(o,t);h=p.sorted,d=p.recipientCounts,Ey.put(u,h),Ay.put(u,d)}d={},r||Object.assign(d,Ay.get(u));const f=new Xo(t);for(let p=0;p<h.length;++p){const g=h[p],m=g.sourceLayer;if(m instanceof dd)continue;const x=[],y=[],b=[];let v=!1;for(const N of g.inputs){const $=f.getValue(N),A=f.getMask(N);x.push($),y.push(A),A!=null&&(v=!0),r||(d[N.name]--,d[N.name]===0&&!t.hasKey(N)&&a.indexOf(N.name)===-1&&!$.isDisposed&&N.sourceLayer.stateful!==!0&&b.push($))}v&&(n=n||{},n.mask=y[0]);const w=Yt(m.apply(x,n));let k=null;m.supportsMasking&&(k=m.computeMask(x,y));const I=Jat(g),C=Array.isArray(I)?I:[I];for(let N=0;N<C.length;++N){f.hasKey(C[N])||f.add(C[N],w[N],Array.isArray(k)?k[0]:k);const $=a.indexOf(C[N].name);$!==-1&&(l[$]=w[N])}r||Ct(b)}return f.disposeMasks(),i?l:l[0]}function Zat(e,t){T(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(e.length===1){const r=$D(e[0],t);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of e){const{sorted:o,recipientMap:a}=$D(i,t);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:Qat(s)}}function Qat(e){const t={};for(const n in e)t[n]=e[n].size;return t}function $D(e,t){const n=new Set,s=[],r={};for(const a of t.names())n.add(a);const i=[],o=[];for(i.push(e);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function Jat(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let s=0;s<e.sourceLayer.inboundNodes.length;++s)for(const r of e.sourceLayer.inboundNodes[s].outputTensors)if(r.id===e.id){n=s;break}t=e.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tlt=H();tlt.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Yat);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jN(e,t){return G(()=>pn(ft(M(e,e),t,!0)))}class Ng extends Oc{getConfig(){return{}}}class GN extends Ng{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return G(()=>{const n=jN(t,this.axis),s=fs(n,0,this.maxValue);return M(t,gt(s,tt(tn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}GN.className="MaxNorm";st(GN);class HN extends Ng{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return G(()=>gt(t,tt(tn(),jN(t,this.axis))))}getConfig(){return{axis:this.axis}}}HN.className="UnitNorm";st(HN);class KN extends Ng{apply(t){return ei(t)}}KN.className="NonNeg";st(KN);class qN extends Ng{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return G(()=>{const n=jN(t,this.axis),s=tt(M(this.rate,fs(n,this.minValue,this.maxValue)),M(1-this.rate,n));return M(t,gt(s,tt(tn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}qN.className="MinMaxNorm";st(qN);const ED={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function en(e){return DN(e)}function AD(e,t={}){return kg(e,Hs.getMap().classNameMap,t,"constraint")}function nn(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in ED?ED[e]:e,config:{}};return AD(n)}else return e instanceof Ng?e:AD(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function elt(e){return new GN(e)}function nlt(e){return new HN(e)}function slt(){return new KN}function rlt(e){return new qN(e)}const ilt=Object.freeze(Object.defineProperty({__proto__:null,maxNorm:elt,minMaxNorm:rlt,nonNeg:slt,unitNorm:nlt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function olt(){return new FN}function alt(){return new Bv}function llt(e){return new LN(e)}function clt(e){return new MN(e)}function ult(e){return new zN(e)}function hlt(e){return new BN(e)}function dlt(e){return new VN(e)}function flt(e){return new ms(e)}function plt(e){return new Vv(e)}function mlt(e){return new Wv(e)}function glt(e){return new Uv(e)}function xlt(e){return new jv(e)}function ylt(e){return new Gv(e)}function blt(e){return new Hv(e)}function vlt(e){return new WN(e)}const wlt=Object.freeze(Object.defineProperty({__proto__:null,constant:llt,glorotNormal:mlt,glorotUniform:plt,heNormal:glt,heUniform:xlt,identity:dlt,leCunNormal:ylt,leCunUniform:blt,ones:alt,orthogonal:vlt,randomNormal:ult,randomUniform:clt,truncatedNormal:hlt,varianceScaling:flt,zeros:olt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Mo(e){if(e==null)return;const t=[],n=[],s=[];for(const r in e){const i=e[r];if(typeof i!="number"){const o=i;t.push(o.data()),n.push(r),s.push(o)}}if(t.length>0){const r=await Promise.all(t);for(let i=0;i<r.length;++i)e[n[i]]=r[i][0];Ct(s)}}function SV(e){if(e!=null)for(const t in e){const n=e[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var RD;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(RD||(RD={}));const Slt=125;class Xu{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,n){}async onEpochEnd(t,n){}async onBatchBegin(t,n){}async onBatchEnd(t,n){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class kV{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}async onEpochBegin(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(t,n)}async onEpochEnd(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(t,n)}async onBatchBegin(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(t,n)}async onBatchEnd(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(t,n)}async onTrainBegin(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainEnd(t)}}class klt extends Xu{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=G(()=>tt(this.totals[r],M(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(t,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:G(()=>{const r=M(gt(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),Je(n[s])}))}}class CV extends Xu{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,n){n==null&&(n={}),this.epoch.push(t);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const t=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];t.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(t);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class IV extends Xu{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||dN,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Slt),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");yy(this.yieldEvery)&&(this.maybeWait=vat(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,n,s){const r=[];this.yield!=null&&(await Mo(s),r.push(this.yield(t,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,n){this.currentEpoch=t,this.epochBegin!=null&&(await Mo(n),await this.epochBegin(t,n))}async onEpochEnd(t,n){const s=[];this.epochEnd!=null&&(await Mo(n),s.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(t,n){this.batchBegin!=null&&(await Mo(n),await this.batchBegin(t,n))}async onBatchEnd(t,n){const s=[];this.batchEnd!=null&&(await Mo(n),s.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):yy(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,t,n)),await Promise.all(s)}async onTrainBegin(t){this.trainBegin!=null&&(await Mo(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await Mo(t),await this.trainEnd(t))}}function TV(e,t){return e==null&&(e={}),e instanceof Xu?[e]:Array.isArray(e)&&e[0]instanceof Xu?e:Yt(e).map(s=>new IV(s,t))}class Ws{constructor(){}static registerCallbackConstructor(t,n){T(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),Ws.checkForDuplicate(n),Ws.constructors[t]==null&&(Ws.constructors[t]=[]),Ws.constructors[t].push(n)}static checkForDuplicate(t){for(const n in Ws.constructors)Ws.constructors[+n].forEach(r=>{if(r===t)throw new W("Duplicate callback constructor.")})}static clear(){Ws.constructors={}}static createCallbacks(t){const n=[];for(const s in Ws.constructors){const r=+s;t>=r&&n.push(...Ws.constructors[r])}return n.map(s=>new s)}}Ws.constructors={};function NV(e,t,n,s,r,i,o,a,l){const c=new CV,u=[new klt,...Ws.createCallbacks(t)];e!=null&&u.push(...e),u.push(c);const h=new kV(u);return h.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:t,doValidation:a,metrics:l}),{callbackList:h,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gr(e,t={},n=!1){return kg(e,Hs.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ry(e,t){return G(()=>{e.dtype!=="float32"&&(e=ot(e,"float32"));const n=ft(Ig(e),t,!0),s=Ec(n.shape,tn()),r=pn(Ei(n,s));return gt(e,r)})}function Fc(e,t){return G(()=>ke(Ig(dt(t,e)),-1))}function qv(e,t){return G(()=>ke(je(dt(t,e)),-1))}function fd(e,t){return G(()=>{const n=dt(e,t),s=fs(je(e),tn(),Number.MAX_VALUE),r=je(gt(n,s));return M(100,ke(r,-1))})}function Clt(e,t){return G(()=>{const n=fs(t,tn(),Number.MAX_VALUE),s=Ps(tt(1,n)),r=fs(e,tn(),Number.MAX_VALUE),i=Ps(tt(1,r));return ke(Ig(dt(s,i)),-1)})}function Ilt(e,t){return G(()=>{const n=Ei(0,dt(1,M(e,t)));return ke(Ig(n),-1)})}function Tlt(e,t){return G(()=>{const n=Ei(0,dt(1,M(e,t)));return ke(n,-1)})}function Nlt(e,t){return G(()=>{const n=ft(M(e,t),-1),s=tr(M(dt(1,e),t),-1);return Ei(0,tt(1,dt(s,n)))})}function _lt(e,t){return G(()=>{const n=Math.log(2),s=dt(t,e),r=dt(tt(s,Ac(M(-2,s))),n);return ke(r,-1)})}function Cp(e,t,n=!1){return G(()=>{if(n)t=xg(t);else{const s=ft(t,t.shape.length-1,!0);t=gt(t,s)}return t=fs(t,tn(),1-tn()),oe(ft(M(ot(e,"float32"),Ps(t)),t.shape.length-1))})}function Dy(e,t,n=!1){return G(()=>{const s=ot(ld(Rat(e)),"int32");t=fs(t,tn(),1-tn());const r=t.shape,i=V(ju(s,r[r.length-1]),r);return Cp(i,t,n)})}function $lt(e,t){if(!Pt(e.shape,t.shape))throw new W(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return G(()=>{const n=ei(t),s=oe(je(t));return tt(dt(n,M(t,e)),lg(ps(s)))})}function Xv(e,t){return G(()=>{let n;return n=fs(t,tn(),1-tn()),n=Ps(gt(n,dt(1,n))),ke($lt(e,n),-1)})}function Elt(e,t){return G(()=>{const n=fs(e,tn(),1),s=fs(t,tn(),1);return ft(M(e,Ps(gt(n,s))),-1)})}function Alt(e,t){return G(()=>{const n=Ps(tt(tn(),t));return ke(dt(t,M(e,n)),-1)})}function XN(e,t){return G(()=>{const n=Ry(e,-1),s=Ry(t,-1),r=M(n,s);return oe(ft(r,-1))})}const Oy={meanSquaredError:Fc,meanAbsoluteError:qv,meanAbsolutePercentageError:fd,meanSquaredLogarithmicError:Clt,squaredHinge:Ilt,hinge:Tlt,categoricalHinge:Nlt,logcosh:_lt,categoricalCrossentropy:Cp,sparseCategoricalCrossentropy:Dy,binaryCrossentropy:Xv,kullbackLeiblerDivergence:Elt,poisson:Alt,cosineProximity:XN};function d2(e){if(typeof e=="string"){if(e in Oy)return Oy[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new W(t)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YN(e,t){return G(()=>{const n=M(.5,Fs(t)),s=vi(ns(t,n),e.dtype);return ke(Os(e,s),-1)})}function ZN(e,t){return G(()=>vi(Os(ec(e,-1),ec(t,-1)),"float32"))}function _V(e,t){return G(()=>ot(ft(Tr(Os(e,1),Os(t,1))),"float32"))}function Rlt(e,t){return G(()=>ot(ft(Tr(Os(e,1),Os(t,0))),"float32"))}function Dlt(e,t){return G(()=>ot(ft(Tr(Os(e,0),Os(t,1))),"float32"))}function $V(e,t){return G(()=>{const n=_V(e,t),s=Dlt(e,t),r=tt(n,s);return ot(dn(ns(r,0),gt(n,r),0),"float32")})}function Olt(e,t){return G(()=>{const n=_V(e,t),s=Rlt(e,t),r=tt(n,s);return ot(dn(ns(r,0),gt(n,r),0),"float32")})}function EV(e,t){return Xv(e,t)}function AV(e,t){return e.rank===t.rank&&(e=Ha(e,[e.rank-1])),t=ec(t,-1),t.dtype!==e.dtype&&(t=ot(t,e.dtype)),ot(Os(e,t),"float32")}function Plt(e,t){return G(()=>{const n=e.sub(t).square().sum(),s=e.sub(e.mean()).square().sum();return yt(1).sub(n.div(s))})}const Flt=Fc,Llt=Fc,Mlt=qv,zlt=qv,Blt=fd,Vlt=fd,QN=Cp,Wlt=XN,RV=Dy,Py={binaryAccuracy:YN,categoricalAccuracy:ZN,precision:$V,categoricalCrossentropy:QN,sparseCategoricalCrossentropy:RV,mse:Flt,MSE:Llt,mae:Mlt,MAE:zlt,mape:Blt,MAPE:Vlt,cosine:Wlt};function Ult(e){if(typeof e=="string"&&e in Py)return Py[e];if(typeof e!="string"&&e!=null)return e;throw new W(`Unknown metric ${e}`)}function x0(e){if(ci(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(const n of Object.keys(Oy))if(Oy[n]===e){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(Py))if(Py[n]===e){t=n;break}return t!==void 0?t:e.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jlt(e){const t={Adagrad:()=>hl.adagrad(.01),Adadelta:()=>hl.adadelta(1,.95,tn()),Adam:()=>hl.adam(.001,.9,.999,tn()),Adamax:()=>hl.adamax(.002,.9,.999,tn(),0),RMSProp:()=>hl.rmsprop(.001,.9,0,tn()),SGD:()=>hl.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new W(`Unknown Optimizer ${e}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const DD=1*1024*1024;function OD(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!yk(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(e);s.length>DD&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${DD}.`)}}function yk(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t)if(typeof n!="string"||!yk(e[n]))return!1;return!0}else if(Array.isArray(e)){for(const t of e)if(!yk(t))return!1;return!0}else return!1;else{const t=typeof e;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Glt(e,t,n,s=console.log){const r=Klt(e),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(t*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in e.nodesByDepth)o.push(...e.nodesByDepth[u])}s("_".repeat(t)),Fy(i,n,s),s("=".repeat(t));const a=e.layers;for(let u=0;u<a.length;++u)r?qlt(a[u],n,s):Xlt(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=Hlt(e),c=$y(e.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(t))}function Hlt(e){let t;return e.collectedTrainableWeights!=null?t=$y(e.collectedTrainableWeights):t=$y(e.trainableWeights),t}function Klt(e){let t=!0;const n=[],s=[];for(const r in e.nodesByDepth)n.push(e.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){t=!1;break}s.push(...r)}if(t)for(const r of e.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){t=!1;break}else i=!0;if(!t)break}return t}function Fy(e,t,n=console.log){let s="";for(let r=0;r<e.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=e[r],s=s.slice(0,t[r]),s+=" ".repeat(t[r]-s.length);n(s)}function qlt(e,t,n){let s,r;try{r=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(e.outputShape)}catch{s="multiple"}const i=e.name,o=e.getClassName(),a=[`${i} (${o})`,r,s,e.countParams().toString()];Fy(a,t,n)}function Xlt(e,t,n,s){let r,i;try{i=e.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}const o=[];for(const h of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(h)===-1))for(let d=0;d<h.inboundLayers.length;++d){const f=h.inboundLayers[d].name,p=h.nodeIndices[d],g=h.tensorIndices[d];o.push(`${f}[${p}][${g}]`)}const a=e.name,l=e.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,e.countParams().toString(),c];Fy(u,t,s);for(let h=1;h<o.length;++h)Fy(["","","","",o[h]],t,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DV(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function Ip(e,t){if(e===null)return null;if(typeof e=="string")return gl(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],s=e.length;for(let r=0;r<s;++r){const i=e[r];DV(t,r,i)?n.push(i):n.push(Ip(i,t))}return n}else{const n={};for(const s of Object.keys(e)){const r=e[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=gl(s);n[i]=Ip(r,i)}}return n}}function bk(e,t){if(e==null)return null;if(typeof e=="string")return Bi(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],s=e.length;for(let r=0;r<s;++r){const i=e[r];DV(t,r,i)?n.push(i):n.push(bk(i,t))}return n}else{const n={};for(const s of Object.keys(e)){const r=e[s],i=Bi(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=bk(r,s)}return n}}/** @license See the LICENSE file. */const Yv="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ylt=e=>{const t=Object.keys(e);if(t.length===0)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Dr extends Ot{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=Mv(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],da(this.inputs).length!==this.inputs.length)throw new W(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);da(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const b=y.sourceLayer,v=y.nodeIndex,w=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push(w)}for(const y of this.inputs){const b=y.sourceLayer,v=y.nodeIndex,w=y.tensorIndex;ci(v===0,"input layer has >1 nodes"),ci(w===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const b=this.inputLayers[y];if(!(b instanceof dd))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},s={},r={},i={},o={},a=[],l=(y,b,v,w,k,I)=>{(w==null||k==null||I==null)&&(w=y.sourceLayer,k=y.nodeIndex,I=y.tensorIndex);const C=w.inboundNodes[k];if(v.indexOf(C)!==-1)throw new Sr(`The tensor ${y.name} at layer "${w.name}" is part of a cycle.`);if(b.indexOf(C)!==-1)return;this.containerNodes.add(Dr.nodeKey(w,k)),w.id in o||(o[w.id]=Object.keys(o).length),v.indexOf(C)===-1&&v.push(C);const N=C.inboundLayers.length;for(let $=0;$<N;$++){const A=C.inputTensors[$],R=C.inboundLayers[$],z=C.nodeIndices[$],U=C.tensorIndices[$];l(A,b,v,R,z,U)}for(b.push(C);v.indexOf(C)>=0;)v.splice(v.indexOf(C),1);a.push(C)},c=[],u=[];for(const y of this.outputs)l(y,c,u);const h=a.slice().reverse();for(const y of h){s[y.id]=y,y.id in n||(n[y.id]=0);let b=n[y.id];const v=r[y.outboundLayer.id]==null?0:r[y.outboundLayer.id];b=Math.max(b,v),r[y.outboundLayer.id]=b,i[y.outboundLayer.id]=y.outboundLayer,n[y.id]=b;for(let w=0;w<y.inboundLayers.length;w++){const k=y.inboundLayers[w],I=y.nodeIndices[w],C=k.inboundNodes[I],N=n[C.id]==null?0:n[C.id];n[C.id]=Math.max(b+1,N),s[C.id]=C}}const d={};for(const y in n){const b=n[y];b in d||(d[b]=[]),d[b].push(s[y])}const f={};for(const y in r){const b=r[y];b in f||(f[b]=[]),f[b].push(i[y])}let p=Object.keys(f).map(y=>parseInt(y,10)).sort(p0);this.layers=[];for(const y of p){const b=f[y];b.sort((v,w)=>{const k=o[v.id],I=o[w.id];return k<I?-1:k>I?1:0});for(const v of b)v instanceof Dr&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=f,p=Object.keys(d).map(y=>parseInt(y,10)).sort(p0);const g=this.inputs.slice(),m=[];for(const y of p)for(const b of d[y]){const v=b.outboundLayer;if(v!=null){for(const w of b.inputTensors)if(g.indexOf(w)===-1)throw new Sr(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${v.name}". The following previous layers were accessed without issue: ${m}`);for(const w of b.outputTensors)g.push(w);m.push(v.name)}}this.nodesByDepth=d;const x=this.layers.map(y=>y.name);for(const y of x){const b=x.filter(v=>v===y).length;if(b!==1)throw new Sr(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new Kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new W("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const s={};let r=0;const i=Ylt(t);i&&this.parseWeights(t);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new W(`Duplicate weight name: ${u}`);s[u]=c,r++}const o=[];for(const a in t){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],t[a]]);else if(n)throw new W(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new W(`${a.length} of ${r} weights are not set: ${a}`)}UN(o)}parseWeights(t){for(const n in Object.keys(t)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");i!==n&&(t[i]=t[n],delete t[n])}}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${Yv}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const s=bk(this.updatedConfig());return n?JSON.stringify(s):s}call(t,n){return G(()=>{t=Yt(t);const s=new Xo;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],t[r]);return nf(this.outputs,s,n)})}computeMask(t,n){return G(()=>{t=Yt(t);let s;return n==null?s=ac(null,t.length):s=Yt(n),this.runInternalGraph(t,s)[1]})}computeOutputShape(t){const n=_y(t);if(n.length!==this.inputLayers.length)throw new W(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(p0);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(u.id)!==-1)continue;const h=[];for(let g=0;g<c.inboundLayers.length;g++){const m=c.inboundLayers[g],x=c.nodeIndices[g],y=c.tensorIndices[g],b=`${m.name}_${x}_${y}`,v=s[b];h.push(v)}const d=u.computeOutputShape(os(h)),f=_y(d),p=u.inboundNodes.indexOf(c);for(let g=0;g<f.length;g++){const m=`${u.name}_${p}_${g}`;s[m]=f[g]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],h=`${l.name}_${c}_${u}`;o.push(h)}for(let a=0;a<o.length;a++){const l=o[a];ci(l in s),i.push(s[l])}return os(i)}runInternalGraph(t,n){n==null&&(n=ac(null,t.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=t[l],h=n[l];s[c.id]=[u,h]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(p0);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const h=u.outboundLayer,d=u.inputTensors,f=u.outputTensors,p=new Array;for(const g of d)g.id in s&&p.push(s[g.id]);if(p.length===d.length){let g={},m,x,y,b;if(u.callArgs!=null&&(g=u.callArgs),p.length===1){const[v,w]=p[0];g.mask==null&&(g.mask=w),y=Yt(h.call(v,g)),b=Yt(h.computeMask(v,w)),m=[v],x=[w]}else m=p.map(v=>v[0]),x=p.map(v=>v[1]),g.mask==null&&(g.mask=x),y=Yt(h.call(m,g)),b=Yt(h.computeMask(m,x));if(h.activityRegularizer)throw new $t("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<f.length;++v){const w=f[v],k=y[v],I=b[v];s[w.id]=[k,I]}}}}const i=[],o=[],a=[];for(const l of this.outputs){ci(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(t){const n={};let s;for(const r of this.layers){s=r instanceof Dr?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=Dr.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new W("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const s of this.layers)if(s.name===t)return s;throw new W(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new W(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return G(()=>{const t=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Dr.nodeKey(n,s);this.containerNodes.has(r)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let h=0;h<o.inboundNodes.length;h++){const d=o.inboundNodes[h],f=Dr.nodeKey(o,h);let p={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const g=[];for(let m=0;m<d.inboundLayers.length;m++){const x=d.inboundLayers[m],y=d.nodeIndices[m],b=d.tensorIndices[m],v=Dr.nodeKey(x,y);let w=n[v];w==null&&(w=0),g.push([x.name,w,b,p])}c.push(g)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}t.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Dr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.inputLayersTensorIndices[o];r.push([a.name,u,h])}t.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Dr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.outputLayersTensorIndices[o];i.push([a.name,u,h])}return t.outputLayers=i,t}static fromConfig(t,n,s={},r=!1){const i={},o={};function a(m,x){m.name in o?o[m.name].push(x):o[m.name]=[x]}function l(m,x){const y=[];let b;for(const v of x){const w=v[0],k=v[1],I=v[2];if(b=v[3]==null?{}:v[3],!(w in i)){a(m,x);return}const C=i[w];if(C.inboundNodes.length<=k){a(m,x);return}const N=C.inboundNodes[k];y.push(N.outputTensors[I])}y.length>0&&m.apply(os(y),b)}function c(m){const x=m.name,y=Gr(m,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(r),i[x]=y,m.inboundNodes.forEach(v=>{if(!(v instanceof Array))throw new W(`Corrupted configuration, expected array for nodeData: ${v}`);a(y,v)})}const u=n.name,h=n.layers;for(const m of h)c(m);for(;!bat(o);)for(const m of h){const x=i[m.name];if(x.name in o){const y=o[x.name];delete o[x.name];for(const b of y)l(x,b)}}const d=[],f=[],p=n.inputLayers;for(const m of p){const x=m[0],y=m[1],b=m[2];ci(x in i);const w=i[x].inboundNodes[y].outputTensors;d.push(w[b])}const g=n.outputLayers;for(const m of g){const x=m[0],y=m[1],b=m[2];ci(x in i);const w=i[x].inboundNodes[y].outputTensors;f.push(w[b])}return new t({inputs:d,outputs:f,name:u})}get stateful(){if(this._stateful)throw new W("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){G(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zlt(e,t,n){const s=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>null);if(s===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==s)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){const r=[];return t.forEach(i=>{i in e?r.push(e[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function OV(e,t){return Zlt(e,t,"classWeight")}async function PV(e,t,n,s){if(n!=null){const r=G(()=>{if(e.shape.length===1)return yi(e);if(e.shape.length===2){if(e.shape[1]>1)return ec(e,1);if(e.shape[1]===1)return V(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());Ct(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),cn(o,"float32")}else return null}function Qlt(e,t){return M(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Jlt=32;function FV(e,t){let n,s;const r=t;n=r.xs,s=r.ys,T(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const i=PD("input",e.inputNames,n),o=PD("output",e.outputNames,s),a=i[0].shape[0];T(i.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),T(o.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<i.length;l++)T(i[l].shape[0]===a,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);for(let l=0;l<o.length;l++)T(o[l].shape[0]===a,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);return{xs:i,ys:o}}function PD(e,t,n){if(n instanceof Ut)return[n];if(Array.isArray(n))return T(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{const s=[];for(const r of t){if(n[r]==null)throw new W(`The feature data generated by the dataset lacks the required ${e} key '${r}'.`);s.push(n[r])}return s}}function tct(e){if(e.length===3)throw new $t("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function ect(e,t,n){const s=n.batchesPerEpoch!=null;if(T(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),T(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),T(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(FD(n.validationData))T(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const m=tct(n.validationData);i=m.xs,o=m.ys}const a=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(m=>"val_"+m)):c=l.slice();const u=TV(n.callbacks,n.yieldEvery),h=n.verbose==null?1:n.verbose,{callbackList:d,history:f}=NV(u,h,n.epochs,null,null,nct(t,n),null,r,c);d.setModel(e),e.history=f,await d.onTrainBegin(),e.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await t.iterator();for(;p<n.epochs;){const m={};await d.onEpochBegin(p);let x=0,y=0;for(s||(g=await t.iterator());!s||x<n.batchesPerEpoch;){const b=await g.next();if(s&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:v,ys:w}=FV(e,b.value),k={};k.batch=y,k.size=v[0].shape[0],await d.onBatchBegin(y,k);const I=[];if(n.classWeight!=null){const $=OV(n.classWeight,e.outputNames);for(let A=0;A<$.length;++A)I.push(await PV(w[A],null,$[A]))}const C=v.concat(w).concat(I),N=a(C);Ct(C);for(let $=0;$<l.length;++$){const A=l[$],R=N[$];k[A]=R,Je(R)}await d.onBatchEnd(y,k),SV(k),y++,x++}if(s?x>=n.batchesPerEpoch:b.done){if(r){let v;FD(n.validationData)?v=Yt(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):v=Yt(e.evaluate(i,o,{batchSize:n.validationBatchSize==null?Jlt:n.validationBatchSize,verbose:0}));for(let w=0;w<e.metricsNames.length;++w)m[`val_${e.metricsNames[w]}`]=v[w]}break}if(e.stopTraining_)break}if(await d.onEpochEnd(p,m),p++,e.stopTraining_)break}return await d.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function nct(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function FD(e){return typeof e.iterator=="function"}function sct(e){return typeof e.next=="function"}async function rct(e,t,n){n=n||{};const s=n.batches!=null,r=e.testFunction;let i=[];if(n.verbose>0)throw new $t("Verbose mode is not implemented yet.");T(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=sct(t)?t:await t.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=G(()=>{if(c.value){const{xs:u,ys:h}=FV(e,c.value),d=u.concat(h),f=G(()=>r(d));if(Ct(d),l===0)for(let g=0;g<f.length;++g)i.push(yt(0));const p=d[0].shape[0];for(let g=0;g<f.length;++g){const m=f[g],x=i[g];i[g]=G(()=>tt(i[g],M(p,m))),l>0&&Ct(x)}Ct(f),a+=p,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=gt(i[c],a),Ct(u)}return os(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function f2(e){T(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function zd(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(s=>Fl(s,t,n-t)):Fl(e,t,n-t)}function vk(e,t){return G(()=>e==null?null:Array.isArray(e)?e.map(n=>vk(n,t)):xV(e,t.dtype==="int32"?t:ot(t,"int32")))}function p2(e,t){const n=[];let s=0,r=null;for(;s<e;)r=s+t,r>=e&&(r=e),n.push([s,r]),s=r;return n}function LV(e){const t=[];e instanceof Ut&&(e=[e]);for(let n=0;n<e.length;++n){const s=e[n];if(s.rank===1)t.push(Cg(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(s)}}return t}function Rr(e,t){if(e==null)return;const n=[];if(t instanceof Ut)n.push(t.id);else if(Array.isArray(t))t.forEach(r=>n.push(r.id));else if(t!=null)for(const r in t){const i=t[r];n.push(i.id)}const s=[];if(e instanceof Ut)n.indexOf(e.id)===-1&&s.push(e);else if(Array.isArray(e))e.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(e!=null)for(const r in e){const i=e[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ict(e){return e instanceof Ut}function wk(e){return Array.isArray(e)}function LD(e){return!ict(e)&&!wk(e)}function MD(e,t,n,s=!0,r=""){if(t==null||t.length===0){if(e!=null){let o=!1;if(wk(e)&&e.length>0)o=!0;else if(LD(e)){for(const a in e)if(e.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new W(`Error when checking model ${r} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(o=>null);let i;if(LD(e)){e=e,i=[];for(const o of t){if(e[o]==null)throw new W(`No data provided for "${o}". Need data for each key in: ${t}`);i.push(e[o])}}else if(wk(e)){if(e=e,e.length!==t.length)throw new W(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);i=e}else{if(e=e,t.length>1)throw new W(`The model ${r} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);i=[e]}if(i=LV(i),n!=null)for(let o=0;o<t.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new W(`Error when checking ${r}: expected ${t[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new W(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function oct(e,t,n){const s=da(e.map(i=>i.shape[0]));s.sort();const r=da(t.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new W(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>1)throw new W(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!Pt(s,r))throw new W(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function act(e,t,n){const s=[Fc,Xv,Cp];for(let r=0;r<e.length;++r){const i=e[r],o=t[r],a=n[r];if(o!=null){if(o===Cp&&i.shape[i.shape.length-1]===1)throw new W(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const h=l[u],d=c[u];if(d!=null&&h!==d)throw new W(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function zD(e,t,n,s=!0,r=""){let i;if(Array.isArray(e)){if(e.length!==t.length)throw new W(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);i=e}else{if(t.length>1)throw new W(`The model expects ${t.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);i=[e]}if(n!=null)for(let o=0;o<t.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new W(`Error when checking ${r}: expected ${t[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new W(`Error when checking ${r}: expected ${t[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function lct(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(s=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(s=>n);{const s=[];for(const r of t){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const cct="layers-model";class io extends Dr{constructor(t){super(t),this.isTraining=!1}summary(t,n,s=console.log){if(!this.built)throw new W("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Glt(this,t,n,s)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=jlt(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof _o))throw new W("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const o in t.loss)if(this.outputNames.indexOf(o)===-1)throw new W(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)t.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(d2(t.loss[o]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new W(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(a=>d2(a))}else{const o=d2(t.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Pl("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=lct(t.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};Pl("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let h,d,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const m=this.internalOutputShapes[o];m[m.length-1]===1||this.lossFunctions[o]===Xv?["accuracy","acc"].indexOf(p)!==-1?d=YN:["crossentropy","ce"].indexOf(p)!==-1&&(d=EV):this.lossFunctions[o]===Dy?["accuracy","acc"].indexOf(p)!==-1?d=AV:["crossentropy","ce"].indexOf(p)!==-1&&(d=RV):["accuracy","acc"].indexOf(p)!==-1?d=ZN:["crossentropy","ce"].indexOf(p)!==-1&&(d=QN);let x;["accuracy","acc"].indexOf(p)!==-1?x="acc":["crossentropy","ce"].indexOf(p)!==-1&&(x="ce"),f=d,h=u+x}else f=Ult(p),h=u+x0(p);let g;Pl(h,()=>{g=f}),i(o,h,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,s={}){const r=s.batchSize==null?32:s.batchSize;f2(r);const o=this.standardizeUserDataXY(t,n,!0,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return os(c)}finally{Rr(o[0],t),Rr(o[1],n)}}async evaluateDataset(t,n){return this.makeTestFunction(),rct(this,t,n)}checkNumSamples(t,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new W(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?i=t[0].shape[0]:i=t.shape[0];else throw new W(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new W("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new Xo;if(t instanceof Ut&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new W(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],t[l])}else for(const l of this.inputs){const c=t[l.name];if(c==null)throw new W(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=nf(i,o);return s?a:a[0]}retrieveSymbolicTensors(t){const n=ac(null,t.length);let s=t.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<t.length;++a){const l=o.indexOf(t[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(t[o])}),new W(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(t,n=32,s=!1){return G(()=>{const r=this.checkNumSamples(t);if(s)throw new $t("Verbose predictLoop() is not implemented yet.");const i=p2(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)G(()=>{const c=i[a][0],u=i[a][1],h=zd(t,c,u),d=[];if(Array.isArray(h))for(let p=0;p<h.length;++p)d.push({key:this.inputs[p],value:h[p]});else d.push({key:this.inputs[0],value:h});const f=new Xo(d);return nf(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return os(o.map(a=>Me(a,0)))})}predict(t,n={}){const s=LV(t);zD(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return f2(r),this.predictLoop(s,r)}finally{Rr(s,t)}}predictOnBatch(t){zD(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,s=!0,r){if(this.optimizer_==null)throw new Sr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===Dy?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(t=MD(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=MD(n,this.feedOutputNames,i,!1,"target"),oct(t,n),act(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&t[0].shape[0]%r!==0)throw new W(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}async standardizeUserData(t,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(t,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=OV(r,this.outputNames);c=[];for(let h=0;h<u.length;++h)c.push(await PV(l[h],null,u[h]))}return[a,l,c]}testLoop(t,n,s,r=0,i){return G(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new $t("Verbose mode is not implemented yet.");if(i!=null)throw new $t("steps mode in testLoop() is not implemented yet");{const l=p2(o,s),c=cn(Xr(0,o));for(let u=0;u<l.length;++u){const h=l[u][0],d=l[u][1],f=Fl(c,h,d-h),p=vk(n,f),g=t(p);if(u===0)for(let m=0;m<g.length;++m)a.push(yt(0));for(let m=0;m<g.length;++m){const x=g[m];a[m]=tt(a[m],M(d-h,x))}}for(let u=0;u<a.length;++u)a[u]=gt(a[u],o)}return a})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let s=0;s<t.length;++s){const r=t[s];let i=r;if(kD(t,r)>1){const o=kD(t.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return t=>{const n=[],s=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const h=[];for(let g=0;g<this.inputs.length;++g)h.push({key:this.inputs[g],value:s[g]});const d=new Xo(h),f=nf(this.outputs,d,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const m=this.lossFunctions[g];let x=m(r[g],f[g]);i[g]!=null&&(x=Qlt(x,i[g]));const y=ke(x);n.push(y),g===0?p=x:p=tt(p,x)}for(let g=0;g<this.metricsTensors.length;++g){let m;if(this.outputs.length>1&&g<this.outputs.length)m=n[g];else{const x=this.metricsTensors[g][0],y=this.metricsTensors[g][1];m=ke(x(r[y],f[y]))}Je(m),o.push(m)}return p=ke(p),this.calculateLosses().forEach(g=>{p=tt(p,g)}),p},l=this.collectedTrainableWeights.map(h=>h.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=t=>G(()=>{const n=[];let s;const r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new Xo(o),l=nf(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],h=ke(u(i[c],l[c]));c===0?s=h:s=tt(s,h),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],h=this.metricsTensors[c][1],d=ke(u(i[h],l[h]));n.push(d)}return n})}async fit(t,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,o,a,l,c,u,h,d;try{const f=s.batchSize==null?32:s.batchSize;f2(f);const g=await this.standardizeUserData(t,n,s.sampleWeight,s.classWeight,!1,f);r=g[0],i=g[1],d=g[2];let m=!1,x;if(s.validationData!=null&&s.validationData.length>0){if(m=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new $t("validationData including sample weights is not supported yet."):new W(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const $=await this.standardizeUserData(l,c,null,null,!0,f);u=$[0],h=$[1],x=u.concat(h)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){m=!0;const N=Math.floor(r[0].shape[0]*(1-s.validationSplit)),$=r[0].shape[0];u=zd(r,N,$),o=r,r=zd(r,0,N),h=zd(i,N,$),a=i,i=zd(i,0,N),x=u.concat(h)}else s.validationSteps!=null&&(m=!0);const y=r.concat(i).concat(d);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),v=this.getDedupedMetricsNames();let w,k;m?(this.makeTestFunction(),w=this.testFunction,k=v.slice().concat(v.map(N=>"val_"+N))):(w=null,x=[],k=v.slice());const I=TV(s.callbacks,s.yieldEvery);return await this.fitLoop(b,y,v,f,s.epochs,s.verbose,I,w,x,s.shuffle,k,s.initialEpoch,null,null)}finally{this.isTraining=!1,Rr(r,t),Rr(i,n),Rr(o,t),Rr(a,n),Rr(u,l),Rr(h,c),d!=null&&Ct(d)}}async fitLoop(t,n,s,r,i,o,a,l,c,u,h,d,f,p){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),d==null&&(d=0);let g=!1;if(l!=null&&c!=null&&(g=!0),p!=null&&(g=!0,f==null))throw new W("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(n,r,f,"steps_per_epoch");let x;m!=null&&(x=Xr(0,m)),o==null&&(o=1);const{callbackList:y,history:b}=NV(a,o,i,d,m,f,r,g,h);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let v=d;v<i;++v){await y.onEpochBegin(v);const w={};if(f!=null)throw new $t("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new $t("batch shuffling is not implemneted yet");u&&CI(x);const k=cn(x),I=p2(m,r);for(let C=0;C<I.length;++C){const N={};if(await y.onBatchBegin(C,N),G(()=>{const $=I[C][0],A=I[C][1],R=Fl(k,$,A-$);N.batch=C,N.size=A-$;const z=vk(n,R),U=t(z);for(let F=0;F<s.length;++F){const P=s[F],L=U[F];N[P]=L,Je(L)}if(C===I.length-1&&g){const F=this.testLoop(l,c,r);for(let P=0;P<s.length;++P){const L=s[P],E=F[P];Je(E),w["val_"+L]=E}}}),await y.onBatchEnd(C,N),SV(N),this.stopTraining_)break}k.dispose()}if(await y.onEpochEnd(v,w),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,n){return ect(this,t,n)}async trainOnBatch(t,n){const s=await this.standardizeUserData(t,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return Ct(a),Rr(s[0],t),Rr(s[1],n),os(l)}getNamedWeights(t){const n=[],s=t!=null&&t.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=ek().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-ek().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=Bi(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>Bi(n))}else{const n=Object.keys(this.loss);t={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")t[r]=Bi(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Bi(x0(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>Bi(x0(t)));{const t={};for(const n in this.metrics)t[n]=Bi(x0(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Ip(t.optimizer_config),s=Gr(n);let r;if(typeof t.loss=="string")r=gl(t.loss);else if(Array.isArray(t.loss))r=t.loss.map(o=>gl(o));else if(t.loss!=null){r={};for(const o in t.loss)r[o]=gl(t.loss[o])}let i;if(Array.isArray(t.metrics))i=t.metrics.map(o=>gl(o));else if(t.metrics!=null){i={};for(const o in t.metrics)i[o]=gl(t.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(t,n){if(typeof t=="string"){const c=ez(t);if(c.length===0)throw new W(`Cannot find any save handlers for URL '${t}'`);if(c.length>1)throw new W(`Found more than one (${c.length}) save handlers for URL '${t}'`);t=c[0]}if(t.save==null)throw new W("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await nk(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:cct,generatedBy:`TensorFlow.js tfjs-layers v${Yv}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:h}=await nk(await this.optimizer.getWeights(),c);s.specs.push(...h),s.data=J4([s.data,u])}return this.userDefinedMetadata!=null&&(OD(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,t.save(a)}setUserDefinedMetadata(t){OD(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}io.className="Model";st(io);class MV extends io{}MV.className="Functional";st(MV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function uct(e,t){"modelTopology"in e||(e={modelTopology:e}),e=e;let n=e.modelTopology;n.model_config!=null&&(n=n.model_config);const s=Ip(n),r=Gr(s,t);if(e.weightsManifest!=null){const i=await xB(e.weightsManifest,e.pathPrefix,r.weights.map(a=>a.originalName)),o={};for(const a of r.weights)o[a.originalName]=i[a.originalName];r.loadWeights(o),Ct(i)}return r}async function hct(e,t){if(t==null&&(t={}),typeof e=="string"){const n=nz(e,t);if(n.length===0)n.push(vB(e,t));else if(n.length>1)throw new W(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return dct(e,void 0,t)}async function dct(e,t,n){if(n==null&&(n={}),e.load==null)throw new W("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await e.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const i=n.strict==null?!0:n.strict,o=s.weightData!=null&&s.weightSpecs!=null&&i,a=Gr(Ip(r),t,o),l=s.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),s.userDefinedMetadata!=null&&a.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new W("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:u}=fct(s.weightData,s.weightSpecs);a.loadWeights(c,i),a.optimizer!=null&&u.length>0&&await a.optimizer.setWeights(u),Ct(c),Ct(u.map(h=>h.tensor))}return a}function fct(e,t){const n=LI(e,t),s={},r=[];return t.forEach(i=>{i.group==="optimizer"?r.push({name:i.name,tensor:n[i.name]}):s[i.name]=n[i.name]}),{modelWeights:s,optimizerWeights:r}}class lc extends io{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:Mv("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new W(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof lc||t instanceof io;let s;if(n){if(s=t,s.outputs.length!==1)throw new W("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new W("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new W("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=wV({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(t.inboundNodes.length!==1)throw new W(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new W("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=vV(this.outputs[0])}this.inboundNodes=[],new Kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ac(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=t.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(Gt(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new io({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,s=console.log){this.built||this.build(),super.summary(t,n,s)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,s={}){if(!this.built)throw new Sr("The model needs to be compiled before being used.");return this.model.evaluate(t,n,s)}async evaluateDataset(t,n){if(!this.built)throw new Sr("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,s={}){if(!this.built)throw new Sr("The model needs to be compiled before being used.");return this.model.fit(t,n,s)}async fitDataset(t,n){if(!this.built)throw new Sr("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new W("Legacy serialization format not supported yet.");i=n}else T(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new t(o);if(!(a instanceof lc))throw new $t(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=Gr(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(t){if(this.model==null)throw new W("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new W("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),t.push(s)}return{name:this.name,layers:t}}}lc.className="Sequential";st(lc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pct(e){return new io(e)}function mct(e){return new lc(e)}function zV(e){return wV(e)}function gct(e,t){Ws.registerCallbackConstructor(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ln=class extends Oc{getConfig(){return{}}};class BV extends Ln{apply(t,n=1){return Oat(t,n)}}BV.className="elu";st(BV);class VV extends Ln{apply(t){return fv(t)}}VV.className="selu";st(VV);class WV extends Ln{apply(t){return ei(t)}}WV.className="relu";st(WV);class UV extends Ln{apply(t){return G(()=>Ta(6,ei(t)))}}UV.className="relu6";st(UV);class jV extends Ln{apply(t){return t}}jV.className="linear";st(jV);class GV extends Ln{apply(t){return jr(t)}}GV.className="sigmoid";st(GV);class HV extends Ln{apply(t){return Fat(t)}}HV.className="hardSigmoid";st(HV);class KV extends Ln{apply(t){return Ac(t)}}KV.className="softplus";st(KV);class qV extends Ln{apply(t){return Pat(t)}}qV.className="softsign";st(qV);class XV extends Ln{apply(t){return Ia(t)}}XV.className="tanh";st(XV);let JN=class extends Ln{apply(t,n=-1){return xg(t,n)}};JN.className="softmax";st(JN);class YV extends Ln{apply(t,n=-1){return ov(t,n)}}YV.className="logSoftmax";st(YV);class ZV extends Ln{apply(t){return G(()=>G(()=>{const n=Math.sqrt(2),s=M(.5,tt(1,sv(gt(t,n))));return M(t,s)}))}}ZV.className="gelu";st(ZV);class QV extends Ln{apply(t){return G(()=>M(.5,M(t,tt(1,Ia(M(pn(gt(2,Math.PI)),tt(t,M(.044715,Ti(t,3)))))))))}}QV.className="gelu_new";st(QV);class JV extends Ln{apply(t){return G(()=>M(t,Ia(Ac(t))))}}JV.className="mish";st(JV);class t5 extends Ln{apply(t,n=1){return G(()=>M(jr(M(t,n)),t))}}t5.className="swish";st(t5);function _a(e){return e.getClassName()}function m2(e,t={}){return kg(e,Hs.getMap().classNameMap,t,"activation")}function $a(e){if(e==null){const t={};return t.className="linear",t.config={},m2(t)}if(typeof e=="string"){const t={};return t.className=e,t.config={},m2(t)}else return e instanceof Ln?e:m2(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t_(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}class e5 extends Oc{}class _g extends e5{constructor(t){super(),t_(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return G(()=>{let n=He([1]);return this.hasL1&&(n=tt(n,ft(M(this.l1,je(t))))),this.hasL2&&(n=tt(n,ft(M(this.l2,Ig(t))))),V(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}_g.className="L1L2";st(_g);function xct(e){return t_(e),new _g({l1:e!=null?e.l1:null,l2:0})}function yct(e){return t_(e),new _g({l2:e!=null?e.l2:null,l1:0})}const BD={l1l2:"L1L2"};function re(e){return DN(e)}function VD(e,t={}){return kg(e,Hs.getMap().classNameMap,t,"regularizer")}function be(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in BD?BD[e]:e,config:{}};return VD(n)}else return e instanceof e5?e:VD(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class e_ extends Ot{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=kt(t);let s=ei(t);return this.maxValue!=null&&(s=fs(s,0,this.maxValue)),s}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}e_.className="ReLU";st(e_);class n_ extends Ot{constructor(t){super(t??{}),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const s=kt(t);return ag(s,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}n_.className="LeakyReLU";st(n_);class s_ extends Ot{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=xe(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=be(t.alphaRegularizer),this.alphaConstraint=nn(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new W(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=Gt(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<t.length;++r)s[r]=t[r];this.inputSpec=[new Ke({ndim:t.length,axes:s})],this.built=!0}call(t,n){return t=kt(t),pg(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Ie(this.alphaInitializer),alphaRegularizer:re(this.alphaRegularizer),alphaConstraint:en(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}s_.className="PReLU";st(s_);let r_=class extends Ot{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new $t(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const s=kt(t);return od(s)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}};r_.className="ELU";st(r_);class i_ extends Ot{constructor(t){super(t??{}),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const s=kt(t);return M(s,ot(ns(s,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}i_.className="ThresholdedReLU";st(i_);class o_ extends Ot{constructor(t){super(t??{}),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new JN().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){return G(()=>{let s=kt(t);const r=n.mask;if(r!=null){const i=M(dt(ls(s.shape),ot(r,s.dtype)),yt(-1e9));s=tt(s,i)}return this.axis instanceof Array?this.axis.length>1?ps(dt(s,cg(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}o_.className="Softmax";st(o_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cu(e,t,n){if(typeof e=="number")return ac(e,t);if(e.length!==t)throw new W(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let s=0;s<t;++s){const r=e[s];if(!Eat(r))throw new W(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${r}`)}return e}function Hr(e,t,n,s,r=1){if(e==null)return e;const i=t+(t-1)*(r-1);let o;return n==="same"?o=e:o=e-i+1,Math.floor((o+s-1)/s)}function ui(e,t,n,s){if(e==null)return null;if(s==="valid")e=e*t+Na([n-t,0]);else if(s==="same")e=e*t;else throw new W(`Unsupport padding mode: ${s}.`);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function a_(e,t){return G(()=>(Ve(t),t==="channelsFirst"?Ft(e,[0,2,3,1]):e))}function n5(e,t){return G(()=>(Ve(t),t==="channelsFirst"?Ft(e,[0,2,3,4,1]):e))}function bct(e,t,n,s=1,r="valid",i,o=1){return G(()=>{if(i==null&&(i=Yr()),Ve(i),e.shape.length!==3)throw new W(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new W(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new W(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(e=Ft(e,[0,2,1])),r==="causal")throw new $t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=Jb(e,t,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=ni(a,n)),a})}function WD(e,t,n,s=[1,1],r="valid",i,o,a=null){return G(()=>{if(i==null&&(i=Yr()),Ve(i),e.rank!==3&&e.rank!==4)throw new W(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new W(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=a_(e,i);if(r==="causal")throw new $t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=sB({x:l,filter:t,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=Ft(l,[0,3,1,2])),l})}function vct(e,t,n,s=[1,1,1],r="valid",i,o){return G(()=>{if(i==null&&(i=Yr()),Ve(i),e.rank!==4&&e.rank!==5)throw new W(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new W(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let a=n5(e,i);if(r==="causal")throw new $t("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=lT(a,t,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=ni(a,n)),i==="channelsFirst"&&(a=Ft(a,[0,4,1,2,3])),a})}class Zv extends Ot{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Zv.verifyArgs(n),this.rank=t,un(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new $t(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Cu(n.kernelSize,t,"kernelSize"),this.strides=Cu(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,ar(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ve(this.dataFormat),this.activation=$a(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=xe(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=nn(n.biasConstraint),this.biasRegularizer=be(n.biasRegularizer),this.activityRegularizer=be(n.activityRegularizer),this.dilationRate=Cu(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new W(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new W(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new W(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(ci("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!ON(t.kernelSize,"number",1,3))throw new W(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:_a(this.activation),useBias:this.useBias,biasInitializer:Ie(this.biasInitializer),biasRegularizer:re(this.biasRegularizer),activityRegularizer:re(this.activityRegularizer),biasConstraint:en(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class pd extends Zv{constructor(t,n){super(t,n),this.kernel=null,pd.verifyArgs(n),this.filters=n.filters,un(this.filters,"filters"),this.kernelInitializer=xe(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=nn(n.kernelConstraint),this.kernelRegularizer=be(n.kernelRegularizer)}build(t){t=Gt(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new W(`The channel dimension of the input should be defined. Found ${t[n]}`);const s=t[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(t,n){return G(()=>{t=kt(t);let s;const r=this.bias==null?null:this.bias.read(),i=hV(this.activation.getClassName());if(i!=null&&this.rank===2)s=WD(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=bct(t,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=WD(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=vct(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new $t("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(t){t=Gt(t);const n=[],s=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let i=0;i<s.length;++i){const o=Hr(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[t[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const t={filters:this.filters,kernelInitializer:Ie(this.kernelInitializer),kernelRegularizer:re(this.kernelRegularizer),kernelConstraint:en(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new W(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class md extends pd{constructor(t){super(2,t),md.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!ON(t.kernelSize,"number",1,2))throw new W(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}md.className="Conv2D";st(md);class gd extends pd{constructor(t){super(3,t),gd.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new W(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}gd.className="Conv3D";st(gd);class l_ extends md{constructor(t){if(super(t),this.inputSpec=[new Ke({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new W(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Gt(t),t.length!==4)throw new W("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new W("The channel dimension of the inputs should be defined. Found `None`.");const s=t[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ke({ndim:4,axes:{[n]:s}})],this.built=!0}call(t,n){return G(()=>{let s=kt(t);if(s.shape.length!==4)throw new W(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],h=this.kernelSize[1],d=this.strides[0],f=this.strides[1],p=ui(l,d,u,this.padding),g=ui(c,f,h,this.padding),m=[i,p,g,this.filters];this.dataFormat!=="channelsLast"&&(s=Ft(s,[0,2,3,1]));let x=tv(s,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=Ft(x,[0,3,1,2])),this.bias!=null&&(x=ni(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(t){t=Gt(t);const n=t.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=ui(n[r],l,o,this.padding),n[i]=ui(n[i],c,a,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}l_.className="Conv2DTranspose";st(l_);class c_ extends gd{constructor(t){if(super(t),this.inputSpec=[new Ke({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new W(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Gt(t),t.length!==5)throw new W("Input should have rank 5; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new W("The channel dimension of the inputs should be defined. Found `None`.");const s=t[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ke({ndim:5,axes:{[n]:s}})],this.built=!0}call(t,n){return G(()=>{let s=kt(t);if(s.shape.length!==5)throw new W(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],h=r[a],d=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],m=this.strides[1],x=this.strides[2],y=ui(c,g,d,this.padding),b=ui(u,m,f,this.padding),v=ui(h,x,p,this.padding),w=[i,y,b,v,this.filters];this.dataFormat!=="channelsLast"&&(s=Ft(s,[0,2,3,4,1]));let k=cT(s,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(k=Ft(k,[0,4,1,2,3])),this.bias!==null&&(k=ni(k,this.bias.read(),this.dataFormat)),this.activation!==null&&(k=this.activation.apply(k)),k})}computeOutputShape(t){t=Gt(t);const n=t.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],h=this.strides[1],d=this.strides[2];return n[s]=this.filters,n[r]=ui(n[r],u,a,this.padding),n[i]=ui(n[i],h,l,this.padding),n[o]=ui(n[o],d,c,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}c_.className="Conv3DTranspose";st(c_);class s5 extends pd{constructor(t,n){if(super(t,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new W("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new W("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new W(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=xe(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=be(n.depthwiseRegularizer),this.depthwiseConstraint=nn(n.depthwiseConstraint),this.pointwiseInitializer=xe(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=be(n.pointwiseRegularizer),this.pointwiseConstraint=nn(n.pointwiseConstraint)}build(t){if(t=Gt(t),t.length<this.rank+2)throw new W(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new W(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const s=t[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Ke({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(t,n){return G(()=>{t=kt(t);let s;if(this.rank===1)throw new $t("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=Ft(t,[0,2,3,1])),s=pv(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=ni(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Ft(s,[0,3,1,2])),s})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Ie(this.depthwiseInitializer),t.pointwiseInitializer=Ie(this.pointwiseInitializer),t.depthwiseRegularizer=re(this.depthwiseRegularizer),t.pointwiseRegularizer=re(this.pointwiseRegularizer),t.depthwiseConstraint=en(this.depthwiseConstraint),t.pointwiseConstraint=en(this.pointwiseConstraint),t}}s5.className="SeparableConv";class u_ extends s5{constructor(t){super(2,t)}}u_.className="SeparableConv2D";st(u_);class $g extends pd{constructor(t){super(1,t),$g.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!ON(t.kernelSize,"number",1,1))throw new W(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}$g.className="Conv1D";st($g);class h_ extends Ot{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return G(()=>{if(t=kt(t),this.dataFormat==="channelsLast"){const s=g0(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return g0(s,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=g0(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return g0(s,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}h_.className="Cropping2D";st(h_);class d_ extends Ot{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Ve(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,Nat(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],s=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,s]}else{const n=t[1]==null?null:this.size[0]*t[1],s=t[2]==null?null:this.size[1]*t[2];return[t[0],n,s,t[3]]}}call(t,n){return G(()=>{let s=kt(t);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Ft(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?wr.resizeNearestNeighbor(s,[i,o]):wr.resizeBilinear(s,[i,o]);return Ft(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?wr.resizeNearestNeighbor(s,[i,o]):wr.resizeBilinear(s,[i,o])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}}d_.className="UpSampling2D";st(d_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wct(e,t,n=[1,1],s="valid",r,i){return G(()=>{r==null&&(r=Yr()),Ve(r);let o=a_(e,r);if(e.rank!==4)throw new W(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new W(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=id(o,t,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=Ft(o,[0,3,1,2])),o})}class f_ extends Zv{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=xe(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=nn(t.depthwiseConstraint),this.depthwiseRegularizer=be(t.depthwiseRegularizer)}build(t){if(t=Gt(t),t.length<4)throw new W(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new W(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const s=t[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return G(()=>{t=kt(t);let s=wct(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=ni(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(t){t=Gt(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],r=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,i=Hr(n,this.kernelSize[0],this.padding,this.strides[0]),o=Hr(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],r,i,o]:[t[0],i,o,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Ie(this.depthwiseInitializer),t.depthwiseRegularizer=re(this.depthwiseRegularizer),t.depthwiseConstraint=en(this.depthwiseRegularizer),t}}f_.className="DepthwiseConv2D";st(f_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function r5(e,t,n,s){if(Array.isArray(e)){if(t!=null||n!=null)throw new W("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=e.slice(e.length-s,e.length),e=e.slice(0,e.length-s)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return t=r(t),n=r(n),{inputs:e,initialState:t,constants:n}}function i5(e,t,n,s=!1,r,i,o=!1,a=!1){return G(()=>{const l=t.shape.length;if(l<3)throw new W(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Xr(2,l));t=Ft(t,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=ot(ot(r,"bool"),"float32"),r.rank===l-1&&(r=wn(r,-1)),r=Ft(r,c)),s&&(t=sr(t,0),r!=null&&(r=sr(r,0)));const u=[];let h,d=n;const f=t.shape[0],p=rr(t);let g;r!=null&&(g=rr(r));for(let x=0;x<f;++x){const y=p[x],b=G(()=>e(y,d));if(r==null)h=b[0],d=b[1];else{const v=G(()=>{const w=g[x],k=dt(Fs(w),w),I=tt(M(b[0],w),M(d[0],k)),C=d.map((N,$)=>tt(M(b[1][$],w),M(N,k)));return{output:I,newStates:C}});h=v.output,d=v.newStates}a&&u.push(h)}let m;return a&&(m=Qn(u,1)),[h,m,d]})}class si extends Ot{constructor(t){super(t);let n;if(t.cell==null)throw new W("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new tw({cells:t.cell}):n=t.cell,n.stateSize==null)throw new W("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new Ke({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Xr(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){gk(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[t[0],t[1],s]:r=[t[0],s],this.returnState){const i=[];for(const o of n)i.push([t[0],o]);return[r].concat(i)}else return r}computeMask(t,n){return G(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<t;++s)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new $t("Constants support is not implemented in RNN yet.");gk(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,s=t.slice(2);this.inputSpec[0]=new Ke({shape:[n,null,...s]});const r=[t[0]].concat(t.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Pt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new W(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new Ke({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){G(()=>{if(!this.stateful)throw new li("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new W("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>He([s,r])):this.states_=[He([s,this.cell.stateSize])];else if(t==null)Ct(this.states_),this.keptStates!=null&&(Ct(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>He([s,r])):this.states_[0]=He([s,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new W(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):Ct(this.states_);for(let r=0;r<this.states_.length;++r){const i=t[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!Pt(i.shape,a))throw new W(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>Je(r.clone()))})}apply(t,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=r5(t,s,r,this.numConstants);t=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new Ke({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof Zr){const c=[t].concat(o),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(t,n)}call(t,n){return G(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;t=kt(t),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(t));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new W(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=i5((p,g)=>{const m=this.cell.call([p].concat(g),a);return[m[0],m.slice(1)]},t,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],h=c[1],d=c[2];this.stateful&&this.resetStates(d,r);const f=this.returnSequences?h:u;return this.returnState?[f].concat(d):f})}getInitialState(t){return G(()=>{let n=He(t.shape);return n=ft(n,[1,2]),n=Cg(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?pk(n,[1,s]):n):this.cell.stateSize>1?[pk(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===si.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),t),n)}static fromConfig(t,n,s={}){const r=n.cell,i=Gr(r,s);return new t(Object.assign(n,{cell:i}))}}si.className="RNN";st(si);class Eg extends Ot{}class Qv extends Eg{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,un(this.units,"units"),this.activation=$a(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xe(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xe(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xe(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=be(t.kernelRegularizer),this.recurrentRegularizer=be(t.recurrentRegularizer),this.biasRegularizer=be(t.biasRegularizer),this.kernelConstraint=nn(t.kernelConstraint),this.recurrentConstraint=nn(t.recurrentConstraint),this.biasConstraint=nn(t.biasConstraint),this.dropout=qu([1,Na([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=qu([1,Na([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Gt(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return G(()=>{if(t=t,t.length!==2)throw new W(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let s=t[1];t=t[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ea({ones:()=>Fs(t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ea({ones:()=>Fs(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=wi(M(t,o),this.kernel.read()):i=wi(t,this.kernel.read()),this.bias!=null&&(i=ni(i,this.bias.read())),a!=null&&(s=M(s,a));let l=tt(i,wi(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:_a(this.activation),useBias:this.useBias,kernelInitializer:Ie(this.kernelInitializer),recurrentInitializer:Ie(this.recurrentInitializer),biasInitializer:Ie(this.biasInitializer),kernelRegularizer:re(this.kernelRegularizer),recurrentRegularizer:re(this.recurrentRegularizer),biasRegularizer:re(this.biasRegularizer),activityRegularizer:re(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),n)}}Qv.className="SimpleRNNCell";st(Qv);class p_ extends si{constructor(t){t.cell=new Qv(t),super(t)}call(t,n){return G(()=>{this.cell.dropoutMask!=null&&(Ct(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ct(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(t,{mask:s,training:r,initialState:i})})}static fromConfig(t,n){return new t(n)}}p_.className="SimpleRNN";st(p_);class Jv extends Eg{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new W("GRUCell does not support reset_after parameter set to true.");this.units=t.units,un(this.units,"units"),this.activation=$a(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=$a(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xe(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xe(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xe(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=be(t.kernelRegularizer),this.recurrentRegularizer=be(t.recurrentRegularizer),this.biasRegularizer=be(t.biasRegularizer),this.kernelConstraint=nn(t.kernelConstraint),this.recurrentConstraint=nn(t.recurrentConstraint),this.biasConstraint=nn(t.biasConstraint),this.dropout=qu([1,Na([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=qu([1,Na([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Gt(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return G(()=>{if(t=t,t.length!==2)throw new W(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const s=n.training==null?!1:n.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ea({ones:()=>Fs(t),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ea({ones:()=>Fs(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(t=M(t,i[0]));let u=wi(t,this.kernel.read());this.useBias&&(u=ni(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=M(r,o[0]));const h=this.recurrentKernel.read(),[d,f]=us(h,[2*this.units,this.units],h.rank-1),p=wi(r,d),[g,m,x]=us(u,3,u.rank-1),[y,b]=us(p,2,p.rank-1);a=this.recurrentActivation.apply(tt(g,y)),l=this.recurrentActivation.apply(tt(m,b));const v=wi(M(l,r),f);c=this.activation.apply(tt(x,v));const w=tt(M(a,r),M(tt(1,oe(a)),c));return[w,w]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:_a(this.activation),recurrentActivation:_a(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ie(this.kernelInitializer),recurrentInitializer:Ie(this.recurrentInitializer),biasInitializer:Ie(this.biasInitializer),kernelRegularizer:re(this.kernelRegularizer),recurrentRegularizer:re(this.recurrentRegularizer),biasRegularizer:re(this.biasRegularizer),activityRegularizer:re(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),n)}}Jv.className="GRUCell";st(Jv);class m_ extends si{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Jv(t),super(t)}call(t,n){return G(()=>{this.cell.dropoutMask!=null&&(Ct(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ct(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(t,{mask:s,training:r,initialState:i})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}m_.className="GRU";st(m_);class Ag extends Eg{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,un(this.units,"units"),this.activation=$a(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=$a(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xe(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xe(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xe(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=be(t.kernelRegularizer),this.recurrentRegularizer=be(t.recurrentRegularizer),this.biasRegularizer=be(t.biasRegularizer),this.kernelConstraint=nn(t.kernelConstraint),this.recurrentConstraint=nn(t.recurrentConstraint),this.biasConstraint=nn(t.biasConstraint),this.dropout=qu([1,Na([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=qu([1,Na([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=Gt(t);const s=t[t.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends _r{apply(l,c){const u=i.apply([o]),h=new Bv().apply([o]),d=i.apply([o*2]);return ID(ID(u,h),d)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return G(()=>{const s=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new W(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let r=t[1];const i=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ea({ones:()=>Fs(t),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ea({ones:()=>Fs(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,h;0<this.dropout&&this.dropout<1&&(t=M(t,o[0]));let d=wi(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=M(r,a[0])),d=tt(d,wi(r,this.recurrentKernel.read())),this.useBias&&(d=ni(d,this.bias.read()));const[f,p,g,m]=us(d,4,d.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=tt(M(c,i),M(l,this.activation.apply(g))),h=this.recurrentActivation.apply(m);const x=M(h,this.activation.apply(u));return[x,x,u]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:_a(this.activation),recurrentActivation:_a(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ie(this.kernelInitializer),recurrentInitializer:Ie(this.recurrentInitializer),biasInitializer:Ie(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:re(this.kernelRegularizer),recurrentRegularizer:re(this.recurrentRegularizer),biasRegularizer:re(this.biasRegularizer),activityRegularizer:re(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),recurrentConstraint:en(this.recurrentConstraint),biasConstraint:en(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),n)}}Ag.className="LSTMCell";st(Ag);class g_ extends si{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Ag(t),super(t)}call(t,n){return G(()=>{this.cell.dropoutMask!=null&&(Ct(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ct(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(t,{mask:s,training:r,initialState:i})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}g_.className="LSTM";st(g_);class tw extends Eg{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return G(()=>{t=t;let s=t.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[t[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(t){gk(t)&&(t=t[0]),t=t;let n;this.cells.forEach((s,r)=>{Pl(`RNNCell_${r}`,()=>{s.build(t),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},t),r)}static fromConfig(t,n,s={}){const r=[];for(const i of n.cells)r.push(Gr(i,s));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return xk(t)}setWeights(t){const n=[];for(const s of this.cells){const r=s.weights.length,i=t.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}UN(n)}}tw.className="StackedRNNCells";st(tw);function Ea(e){const{ones:t,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=e,o=()=>i!=null?i(t(),n):yV(t(),n),a=()=>Tg(o,t,s);return!r||r<=1?Je(a().clone()):Array(r).fill(void 0).map(a).map(c=>Je(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Sct=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]]);return n};class o5 extends si{constructor(t){if(t.unroll)throw new $t("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new $t("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new Ke({ndim:5})]}call(t,n){return G(()=>{if(this.cell.dropoutMask!=null&&(Ct(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ct(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new W("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(t,{mask:s,training:r,initialState:i})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return G(()=>{const{stateSize:n}=this.cell,s=t.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=He(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(t,n=!1){G(()=>{if(!this.stateful)throw new li("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new W("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>He(i)):this.states_=[He(i)];else if(t==null)Ct(this.states_),this.keptStates!=null&&(Ct(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>He(i)):this.states_[0]=He(i);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new W(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):Ct(this.states_);for(let a=0;a<this.states_.length;++a){const l=t[a],c=i;if(!Pt(l.shape,c))throw new W(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Je(a.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=t[l?3:2],u=t[l?4:3],h=Hr(c,r[0],i,o[0],a[0]),d=Hr(u,r[1],i,o[1],a[1]);return[...t.slice(0,2),...l?[s,h,d]:[h,d,s]]}}o5.className="ConvRNN2D";class ew extends Ag{constructor(t){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=t;super(Object.assign(Object.assign({},t),{units:n})),this.filters=n,un(this.filters,"filters"),this.kernelSize=Cu(s,2,"kernelSize"),this.kernelSize.forEach(l=>un(l,"kernelSize")),this.strides=Cu(r||1,2,"strides"),this.strides.forEach(l=>un(l,"strides")),this.padding=i||"valid",ar(this.padding),this.dataFormat=o||"channelsLast",Ve(this.dataFormat),this.dilationRate=Cu(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>un(l,"dilationRate"))}build(t){var n;t=Gt(t);const s=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[s]==null)throw new W(`The channel dimension of the input should be defined. Found ${t[s]}`);const r=t[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends _r{apply(d,f){const p=c.apply([u]),g=ls([u]),m=c.apply([u*2]);return PN([p,g,m])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return G(()=>{if(t.length!==3)throw new W(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const s=n.training||!1,r=t[0],i=t[1],o=t[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ea({ones:()=>Fs(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(q,Y,Q)=>!Y||!Y[Q]?q:M(Y[Q],q);let u=c(r,l,0),h=c(r,l,1),d=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ea({ones:()=>Fs(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=c(i,p,0),m=c(i,p,1),x=c(i,p,2),y=c(i,p,3);const b=3,[v,w,k,I]=us(this.kernel.read(),a,b),[C,N,$,A]=this.useBias?us(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,v,C,this.padding),h=this.inputConv(h,w,N,this.padding),d=this.inputConv(d,k,$,this.padding),f=this.inputConv(f,I,A,this.padding);const[R,z,U,F]=us(this.recurrentKernel.read(),a,b);g=this.recurrentConv(g,R),m=this.recurrentConv(m,z),x=this.recurrentConv(x,U),y=this.recurrentConv(y,F);const P=this.recurrentActivation.apply(tt(u,g)),L=this.recurrentActivation.apply(tt(h,m)),E=tt(M(L,o),M(P,this.activation.apply(tt(d,x)))),B=M(this.recurrentActivation.apply(tt(f,y)),this.activation.apply(E));return[B,B,E]})}getConfig(){const t=super.getConfig(),n=Sct(t,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(t,n,s,r){const i=xo(t,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?ni(i,s,this.dataFormat):i}recurrentConv(t,n){return xo(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}ew.className="ConvLSTM2DCell";st(ew);class x_ extends o5{constructor(t){const n=new ew(t);super(Object.assign(Object.assign({},t),{cell:n}))}static fromConfig(t,n){return new t(n)}}x_.className="ConvLSTM2D";st(x_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nw extends Ot{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=kt(t);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return Tg(()=>yV(s,this.rate,i,this.seed),()=>s,r)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}nw.className="Dropout";st(nw);class y_ extends nw{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}y_.className="SpatialDropout1D";st(y_);class b_ extends Ot{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,un(this.units,"units"),this.activation=$a(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=xe(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=xe(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=nn(t.kernelConstraint),this.biasConstraint=nn(t.biasConstraint),this.kernelRegularizer=be(t.kernelRegularizer),this.biasRegularizer=be(t.biasRegularizer),this.activityRegularizer=be(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=Gt(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=Gt(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=kt(t),r=hV(this.activation.getClassName());let i;return r!=null?i=wi(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=wi(s,this.kernel.read()),this.bias!=null&&(i=ni(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const t={units:this.units,activation:_a(this.activation),useBias:this.useBias,kernelInitializer:Ie(this.kernelInitializer),biasInitializer:Ie(this.biasInitializer),kernelRegularizer:re(this.kernelRegularizer),biasRegularizer:re(this.biasRegularizer),activityRegularizer:re(this.activityRegularizer),kernelConstraint:en(this.kernelConstraint),biasConstraint:en(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}b_.className="Dense";st(b_);class v_ extends Ot{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=Gt(t);for(const n of t.slice(1))if(n==null)throw new W(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],fa(t,1)]}call(t,n){return G(()=>{this.invokeCallHook(t,n);let s=kt(t);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=Ft(s,r)}return Dat(s)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}}v_.className="Flatten";st(v_);class w_ extends Ot{constructor(t){super(t),this.supportsMasking=!0,this.activation=$a(t.activation)}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=kt(t);return this.activation.apply(s)})}getConfig(){const t={activation:_a(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}w_.className="Activation";st(w_);class S_ extends Ot{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return G(()=>(t=kt(t),Aat(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}S_.className="RepeatVector";st(S_);class k_ extends Ot{constructor(t){super(t),this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new W("Can only specifiy one unknown dimension.");else i*=c}const a=fa(t);if(o!==null){if(i===0||a%i!==0)throw new W(s);r[o]=a/i}else if(a!==i)throw new W(s);return r}computeOutputShape(t){let n=!1;for(let s=0;s<t.length;++s)if(this.isUnknown(t[s])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=kt(t),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return V(s,i)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}k_.className="Reshape";st(k_);class C_ extends Ot{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=Xr(1,t.dims.length+1);if(!Pt(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ke({ndim:this.dims.length+1})]}computeOutputShape(t){t=Gt(t);const n=t.slice();return this.dims.forEach((s,r)=>{n[r+1]=t[s]}),n}call(t,n){return Ft(kt(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}C_.className="Permute";st(C_);class I_ extends Ot{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const s=kt(t);return vp(rc(s,this.maskValue),-1)}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=kt(t),o=vp(rc(s,this.maskValue),-1,!0);return M(s,ot(o,s.dtype))})}}I_.className="Masking";st(I_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class T_ extends Ot{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Yt(t.inputLength))}this.inputDim=t.inputDim,un(this.inputDim,"inputDim"),this.outputDim=t.outputDim,un(this.outputDim,"outputDim"),this.embeddingsInitializer=xe(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=be(t.embeddingsRegularizer),this.activityRegularizer=be(t.activityRegularizer),this.embeddingsConstraint=nn(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return G(()=>this.maskZero?(t=kt(t),rc(t,Bt(t))):null)}computeOutputShape(t){if(t=Gt(t),this.inputLength==null)return[...t,this.outputDim];const n=Yt(this.inputLength);if(n.length!==t.length-1)throw new W(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=t[r+1];if(i!=null&&o!=null&&i!==o)throw new W(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);i==null&&(n[s]=o),s++}}return[t[0],...n,this.outputDim]}call(t,n){return G(()=>{this.invokeCallHook(t,n);let s=kt(t);s.dtype!=="int32"&&(s=vi(s,"int32"));const r=xV(this.embeddings.read(),V(s,[s.size]));return V(r,Gt(this.computeOutputShape(s.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ie(this.embeddingsInitializer),embeddingsRegularizer:re(this.embeddingsRegularizer),activityRegularizer:re(this.activityRegularizer),embeddingsConstraint:en(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}T_.className="Embedding";st(T_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Lc extends Ot{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new $t}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const s=t.slice(0,t.length-n.length);for(let r=0;r<n.length;++r){const i=t[t.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new W("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));s.push(i)}}return s}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Gt(t)]),t=t,t.length<2)throw new W(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const i of t)i!=null&&i[0]!==null&&n.push(i[0]);if(n=da(n),n.length>1)throw new W(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let s=t[0]==null?null:t[0].slice(1);for(let i=1;i<t.length;++i){const o=t[i]==null?null:t[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=t.map(i=>i.length);t.indexOf(null)===-1&&da(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return G(()=>{if(t=t,this.reshapeRequired){const s=[],r=t.map(i=>i.rank);if(r.indexOf(null)===-1){const i=Na(r);for(let o of t){const a=o.rank;for(let l=0;l<i-a;++l)o=Cg(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of t){const c=l.rank;if(c==null){const u=l.shape,h=u[0],d=u.slice(1).concat([h]);let f=V(l,[h].concat(fa(u.slice(1))));f=Ft(f,[1,0]),f=V(f,d),s.push(f),i=!0}else if(c>1){const u=Xr(1,c).concat([0]);s.push(Ft(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],h=[u].concat(l.slice(0,l.length-1));o=V(Ft(V(o,[-1,u]),[1,0]),h)}else if(a>1){const l=[a-1].concat(Xr(0,a-1));o=Ft(o,l)}}return o}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let r=1;r<t.length;++r){const i=t[r]==null?null:t[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of t)r!=null&&r[0]!==null&&s.push(r[0]);return s=da(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(t,n){return G(()=>{if(n==null)return null;if(!Array.isArray(n))throw new W("`mask` should be an Array");if(!Array.isArray(t))throw new W("`inputs` should be an Array");if(n.length!==t.length)throw new W(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:wn(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Tr(s,n[r]);return s})}}class N_ extends Lc{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=tt(n,t[s]);return n})}}N_.className="Add";st(N_);class __ extends Lc{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=M(n,t[s]);return n})}}__.className="Multiply";st(__);class $_ extends Lc{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=tt(n,t[s]);return M(1/t.length,n)})}}$_.className="Average";st($_);class E_ extends Lc{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0];for(let s=1;s<t.length;++s)n=Ei(n,t[s]);return n})}}E_.className="Maximum";st(E_);class A_ extends Lc{constructor(t){super(t)}mergeFunction(t){return G(()=>{let n=t[0];for(let s=1;s<t.length;++s)n=Ta(n,t[s]);return n})}}A_.className="Minimum";st(A_);class R_ extends Lc{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new W("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const r of t)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<t.length;++r){const i=t[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(Pt(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new W("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return G(()=>PN(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new W("A `Concatenate` layer should be called on a list of inputs.");const n=t,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new W("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new W("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new W(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return G(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<t.length;++o)n[o]==null?r.push(ot(Fs(t[o]),"bool")):n[o].rank<t[o].rank?r.push(wn(n[o],-1)):r.push(n[o]);const i=Me(r,this.axis);return Qb(i,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}R_.className="Concatenate";st(R_);function Bd(e,t){for(;e<0;)e+=t;return e}function kct(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new $t("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),T(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new $t("batchDot is not implemented for complex64-type Tensors yet.");const s=e.shape.length,r=t.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return G(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);t=V(t,t.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);e=V(e,e.shape.concat(l))}else o=0;let a;if(e.shape.length===2&&t.shape.length===2)i[0]===i[1]?a=ft(M(e,t),i[0]):a=ft(M(Ft(e,[1,0]),t),i[1]);else{const l=i[0]!==e.shape.length-1,c=i[1]===t.shape.length-1;a=Rt(e,t,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=Ha(a,c)}return a.shape.length===1&&(a=wn(a,1)),a})}class D_ extends Lc{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){T(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],s=t[1];if(n.length>3||s.length>3)throw new $t("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new W(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(t){if(t.length!==2)throw new W(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],s=t[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>Bd(i,t[o].shape.length)):r=[Bd(this.axes,n.shape.length),Bd(this.axes,s.shape.length)],this.normalize&&(n=Ry(n,r[0]),s=Ry(s,r[1])),kct(n,s,r)}interpretAxes(t,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Bd(this.axes,t.length),Bd(this.axes,n.length)],s}computeOutputShape(t){T(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),s=t[1].slice();if(n.length>3||s.length>3)throw new $t("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}D_.className="Dot";st(D_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class O_ extends Ot{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=kt(t);return Tg(()=>tt(zv(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}O_.className="GaussianNoise";st(O_);class P_ extends Ot{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return G(()=>{this.invokeCallHook(t,n);const s=kt(t);return this.rate>0&&this.rate<1?Tg(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return M(s,zv(s.shape,1,i))},()=>s,n.training||!1):s})}}P_.className="GaussianDropout";st(P_);class F_ extends Ot{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||kt(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return G(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(t);return Tg(()=>{const i=kt(t),l=-1.6732632423543772*1.0507009873554805;let c=Io(Ga(s),this.rate);c=vi(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-u*l*this.rate,d=tt(M(i,c),M(tt(c,-1),l));return tt(M(d,u),h)},()=>kt(t),n.training||!1)}return t})}}F_.className="AlphaDropout";st(F_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tp(e,t,n,s,r,i=.001){let o;if(e.rank===2)o=QI(e,t,n,s,r,i);else if(e.rank===3)o=JI(e,t,n,s,r,i);else if(e.rank===4)o=tT(e,t,n,s,r,i);else throw new $t(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return o}function Cct(e,t,n,s,r=.001){return G(()=>{const i=dg(e,s),o=i.mean,a=i.variance;return[Tp(e,o,a,n,t,r),o,a]})}function Ict(e,t,n,s,r=.001){return G(()=>{const i=dg(e,s),o=i.mean,a=i.variance,l=[];for(const p of Xr(0,e.rank))s.indexOf(p)!==-1?l.push(1):l.push(e.shape[p]);const c=V(o,l),u=V(a,l),h=t==null?null:V(t,l),d=n==null?null:V(n,l);return[Tp(e,c,u,d,h,r),o,a]})}function Tct(e,t,n,s,r=.001){return Pt(s.slice().sort(),Xr(0,e.rank-1))?Cct(e,t,n,s,r):Ict(e,t,n,s,r)}class L_ extends Ot{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=xe(t.betaInitializer||"zeros"),this.gammaInitializer=xe(t.gammaInitializer||"ones"),this.movingMeanInitializer=xe(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=xe(t.movingVarianceInitializer||"ones"),this.betaConstraint=nn(t.betaConstraint),this.gammaConstraint=nn(t.gammaConstraint),this.betaRegularizer=be(t.betaRegularizer),this.gammaRegularizer=be(t.gammaRegularizer)}build(t){t=Gt(t);const n=this.axis>=0?this.axis:this.axis+t.length,s=t[n];if(s==null)throw new W(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new Ke({ndim:t.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return G(()=>{const s=n.training==null?!1:n.training,r=kt(t),i=r.shape,o=i.length,a=Xr(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=ac(1,o);c[l]=i[l];const u=a.slice();u.sort();const h=!Pt(u,Xr(0,o).slice(0,o-1)),d=()=>{if(h){const y=V(this.movingMean.read(),c),b=V(this.movingVariance.read(),c),v=this.center?V(this.beta.read(),c):null,w=this.scale?V(this.gamma.read(),c):null;return Tp(r,y,b,v,w,this.epsilon)}else return Tp(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return d();const[f,p,g]=Tct(r,this.gamma.read(),this.beta.read(),a,this.epsilon),m=(y,b,v)=>{G(()=>{const w=1-v,k=y.read(),I=M(dt(k,b),w);y.write(dt(k,I))})};return(()=>{m(this.movingMean,p,this.momentum),m(this.movingVariance,g,this.momentum)})(),f})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ie(this.betaInitializer),gammaInitializer:Ie(this.gammaInitializer),movingMeanInitializer:Ie(this.movingMeanInitializer),movingVarianceInitializer:Ie(this.movingVarianceInitializer),betaRegularizer:re(this.betaRegularizer),gammaRegularizer:re(this.gammaRegularizer),betaConstraint:en(this.betaConstraint),gammaConstraint:en(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}L_.className="BatchNormalization";st(L_);class M_ extends Ot{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=xe(t.betaInitializer||"zeros"),this.gammaInitializer=xe(t.gammaInitializer||"ones"),this.betaRegularizer=be(t.betaRegularizer),this.gammaRegularizer=be(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=Gt(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==da(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>t[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(t,n){const s=kt(t),r=s.shape,i=r.length;return G(()=>{let{mean:a,variance:l}=dg(s,this.axis,!0);const c=ac(1,i);for(const g of this.axis)c[g]=r[g];const u=g=>g!=null&&g.shape.length!==i?V(g,c):g;let h=this.scale?u(this.gamma.read()):null,d=this.center?u(this.beta.read()):null;const f=[],p=[];for(let g=0;g<i;++g)this.axis.indexOf(g)!==-1?(f.push(r[g]),p.push(1)):(f.push(1),p.push(r[g]));return a=Xs(a,f),l=Xs(l,f),h!=null&&(h=Xs(h,p)),d!=null&&(d=Xs(d,p)),Tp(s,a,l,d,h,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ie(this.betaInitializer),gammaInitializer:Ie(this.gammaInitializer),betaRegularizer:re(this.betaRegularizer),gammaRegularizer:re(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}M_.className="LayerNormalization";st(M_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nct(e,t,n){return G(()=>{if(e.rank!==4)throw new W(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new W("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Yr()),n!=="channelsLast"&&n!=="channelsFirst")throw new W(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],t[0],t[1]]:s=[[0,0],t[0],t[1],[0,0]],To(e,s)})}class z_ extends Ot{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Yr():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new W(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,s;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],s=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new W(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new W(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);s=t.padding[1]}this.padding=[n,s]}this.inputSpec=[new Ke({ndim:4})]}computeOutputShape(t){t=Gt(t);let n,s;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?s=t[3]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],t[1],n,s]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?s=t[2]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],n,s,t[3]])}call(t,n){return G(()=>Nct(kt(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}z_.className="ZeroPadding2D";st(z_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sw(e,t,n,s,r,i){return G(()=>{Ve(r),fV(i),ar(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Yr()),i==null&&(i="max"),e=a_(e,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=hg(e,t,n,a):o=sg(e,t,n,a),r==="channelsFirst"&&(o=Ft(o,[0,3,1,2])),o})}function a5(e,t,n,s,r,i){return G(()=>{Ve(r),fV(i),ar(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Yr()),i==null&&(i="max"),e=n5(e,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=kT(e,t,n,a):o=ZI(e,t,n,a),r==="channelsFirst"&&(o=Ft(o,[0,4,1,2,3])),o})}class l5 extends Ot{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new W(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(un(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new W(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);un(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,ar(this.padding),this.inputSpec=[new Ke({ndim:3})]}computeOutputShape(t){t=Gt(t);const n=Hr(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return G(()=>{this.invokeCallHook(t,n),t=Cg(kt(t),2);const s=this.poolingFunction(kt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Ha(s,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class B_ extends l5{constructor(t){super(t)}poolingFunction(t,n,s,r,i){return Ve(i),ar(r),sw(t,n,s,r,i,"max")}}B_.className="MaxPooling1D";st(B_);class V_ extends l5{constructor(t){super(t)}poolingFunction(t,n,s,r,i){return Ve(i),ar(r),sw(t,n,s,r,i,"avg")}}V_.className="AveragePooling1D";st(V_);class c5 extends Ot{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new W(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];un(this.poolSize,"poolSize"),un(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Ve(this.dataFormat),ar(this.padding),this.inputSpec=[new Ke({ndim:4})]}computeOutputShape(t){t=Gt(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Hr(n,this.poolSize[0],this.padding,this.strides[0]),s=Hr(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,s]:[t[0],n,s,t[3]]}call(t,n){return G(()=>(this.invokeCallHook(t,n),this.poolingFunction(kt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class W_ extends c5{constructor(t){super(t)}poolingFunction(t,n,s,r,i){return Ve(i),ar(r),sw(t,n,s,r,i,"max")}}W_.className="MaxPooling2D";st(W_);class U_ extends c5{constructor(t){super(t)}poolingFunction(t,n,s,r,i){return Ve(i),ar(r),sw(t,n,s,r,i,"avg")}}U_.className="AveragePooling2D";st(U_);class u5 extends Ot{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new W(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];un(this.poolSize,"poolSize"),un(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Ve(this.dataFormat),ar(this.padding),this.inputSpec=[new Ke({ndim:5})]}computeOutputShape(t){t=Gt(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],r=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Hr(n,this.poolSize[0],this.padding,this.strides[0]),s=Hr(s,this.poolSize[1],this.padding,this.strides[1]),r=Hr(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,s,r]:[t[0],n,s,r,t[4]]}call(t,n){return G(()=>(this.invokeCallHook(t,n),this.poolingFunction(kt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class j_ extends u5{constructor(t){super(t)}poolingFunction(t,n,s,r,i){return Ve(i),ar(r),a5(t,n,s,r,i,"max")}}j_.className="MaxPooling3D";st(j_);class G_ extends u5{constructor(t){super(t)}poolingFunction(t,n,s,r,i){return Ve(i),ar(r),a5(t,n,s,r,i,"avg")}}G_.className="AveragePooling3D";st(G_);class h5 extends Ot{constructor(t){super(t),this.inputSpec=[new Ke({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new $t}}class H_ extends h5{constructor(t){super(t||{})}call(t,n){return G(()=>{const s=kt(t);return ke(s,1)})}}H_.className="GlobalAveragePooling1D";st(H_);class K_ extends h5{constructor(t){super(t||{})}call(t,n){return G(()=>{const s=kt(t);return tr(s,1)})}}K_.className="GlobalMaxPooling1D";st(K_);class d5 extends Ot{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Ve(this.dataFormat),this.inputSpec=[new Ke({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new $t}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class q_ extends d5{call(t,n){return G(()=>{const s=kt(t);return this.dataFormat==="channelsLast"?ke(s,[1,2]):ke(s,[2,3])})}}q_.className="GlobalAveragePooling2D";st(q_);class X_ extends d5{call(t,n){return G(()=>{const s=kt(t);return this.dataFormat==="channelsLast"?tr(s,[1,2]):tr(s,[2,3])})}}X_.className="GlobalMaxPooling2D";st(X_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class f5 extends Ot{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,s={}){const r=n.layer,i=Gr(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new t(o)}}class Y_ extends f5{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=Gt(t),t.length<3)throw new W(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=Gt(t);const n=[t[0]].concat(t.slice(2)),s=this.layer.computeOutputShape(n),r=t[1];return[s[0],r].concat(s.slice(1))}call(t,n){return G(()=>(t=kt(t),i5((o,a)=>[kt(this.layer.call(o,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}Y_.className="TimeDistributed";st(Y_);function _ct(e){Pc(Tat,"BidirectionalMergeMode",e)}const $ct="concat";class Z_ extends f5{constructor(t){super(t);const n=t.layer.getConfig(),s={};s.className=t.layer.getClassName(),s.config=n,this.forwardLayer=Gr(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=t.layer.getClassName(),r.config=n,this.backwardLayer=Gr(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?$ct:t.mergeMode,_ct(this.mergeMode),t.weights)throw new $t("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,s=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,s)),this.backwardLayer.setWeights(t.slice(s))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):os(r)}apply(t,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=r5(t,s,r,this.numConstants);if(t=i.inputs,s=i.initialState,r=i.constants,Array.isArray(t)&&(s=t.slice(1),t=t[0]),(s==null||s.length===0)&&r==null)return super.apply(t,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new W("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(h=>new Ke({shape:h.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new $t("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Zr;for(const c of o)if(c instanceof Zr!==l)throw new W("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[t].concat(o),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(t,n)}call(t,n){return G(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(t,n),i=this.backwardLayer.call(t,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(t,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(t,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=sr(i,1));let a;return this.mergeMode==="concat"?a=PN([r,i]):this.mergeMode==="sum"?a=tt(r,i):this.mergeMode==="ave"?a=M(.5,tt(r,i)):this.mergeMode==="mul"?a=M(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Pl(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Pl(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const s=Gr(n.layer);if(delete n.layer,n.numConstants!=null)throw new $t("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new t(r)}}Z_.className="Bidirectional";st(Z_);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Q_ extends Ot{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return G(()=>(t=kt(t),t.dtype!=="float32"&&(t=vi(t,"float32")),tt(M(t,this.scale),this.offset)))}}Q_.className="Rescaling";st(Q_);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Ect,cropAndResize:Act}=wr;class J_ extends Ot{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,n,s,r,i,o,a,l){return G(()=>{let c,u=!1;const h=n/o,d=s/a,f=(r+n)/o,p=(i+s)/a,g=[h,d,f,p],m=[];t.rank===3?(u=!0,c=Qn([t])):c=t;for(let w=0;w<c.shape[0];w++)m.push(g);const x=Ds(m,[m.length,4]),y=ic(0,m.length,1,"int32"),v=Act(c,x,y,[r,i],"nearest");return vi(u?kt(rr(v)):v,l)})}upsize(t,n,s,r){return G(()=>{const i=Ect(t,[n,s]);return vi(i,r)})}call(t,n){return G(()=>{const s=kt(t),r=s.dtype,i=s.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,r):this.upsize(t,this.height,this.width,r)})}getConfig(){const t={height:this.height,width:this.width},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=Gt(t);const n=t.length-3,s=t.length-2;return t[n]=this.height,t[s]=this.width,t}}J_.className="CenterCrop";st(J_);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rct(e,t,n,s){let r=kt(e);if(r.dtype!=="int32"&&(r=vi(r,"int32")),t==="int")return r;const i=r.shape;if(r.rank===0&&(r=wn(r,-1)),t==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=wn(r,-1)),r.rank>2)throw new W(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${i} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(t),a=r;let l;if(typeof s<"u"&&t==="count"?l=Ty(a,s,n,o):l=Ty(a,[],n,o),t!=="tfIdf")return l;if(s)return M(l,s);throw new W("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class t$ extends Ot{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){return t=Gt(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,n){return G(()=>{t=kt(t),t.dtype!=="int32"&&(t=vi(t,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new W(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=kt(n.countWeights)}const r=tr(t),i=Wu(t),o=ns(this.numTokens,r).bufferSync().get(0),a=Io(i,0).bufferSync().get(0);if(!(o&&a))throw new W(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Rct(t,this.outputMode,this.numTokens,s)})}}t$.className="CategoryEncoding";st(t$);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Dct=["bilinear","nearest"],UD=new Set(Dct);class e$ extends Ot{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(UD.has(t.interpolation))this.interpolation=t.interpolation;else throw new W(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!t.cropToAspectRatio}computeOutputShape(t){t=Gt(t);const n=t[2];return[this.height,this.width,n]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return G(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return wr.resizeBilinear(t,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return wr.resizeNearestNeighbor(t,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...UD]} are supported`)})}}e$.className="Resizing";st(e$);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class p5{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}p5.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class m5 extends Ot{constructor(t){super(t),this.randomGenerator=new p5(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(t,n),t}}m5.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Oct=["bilinear","nearest"],jD=new Set(Oct);class n$ extends m5{constructor(t){super(t);const{factor:n,interpolation:s="bilinear"}=t;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new W(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new W(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new W(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(jD.has(s))this.interpolation=s;else throw new W(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=Gt(t);const n=t[2];return[this.imgHeight,-1,n]}call(t,n){return G(()=>{const s=kt(t);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Ga([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return wr.resizeBilinear(t,o);case"nearest":return wr.resizeNearestNeighbor(t,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...jD]} are supported`)}})}}n$.className="RandomWidth";st(n$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pct(e){return new dd(e)}function Fct(e){return new r_(e)}function Lct(e){return new e_(e)}function Mct(e){return new n_(e)}function zct(e){return new s_(e)}function Bct(e){return new o_(e)}function Vct(e){return new i_(e)}function Wct(e){return new $g(e)}function Uct(e){return new md(e)}function jct(e){return new l_(e)}function Gct(e){return new gd(e)}function Hct(e){return new c_(e)}function Kct(e){return new u_(e)}function qct(e){return new h_(e)}function Xct(e){return new d_(e)}function Yct(e){return new f_(e)}function Zct(e){return new w_(e)}function Qct(e){return new b_(e)}function Jct(e){return new nw(e)}function tut(e){return new y_(e)}function eut(e){return new v_(e)}function nut(e){return new S_(e)}function sut(e){return new k_(e)}function rut(e){return new C_(e)}function iut(e){return new T_(e)}function out(e){return new N_(e)}function aut(e){return new $_(e)}function lut(e){return new R_(e)}function cut(e){return new E_(e)}function uut(e){return new A_(e)}function hut(e){return new __(e)}function dut(e){return new D_(e)}function fut(e){return new L_(e)}function put(e){return new M_(e)}function mut(e){return new z_(e)}function s$(e){return new V_(e)}function gut(e){return s$(e)}function xut(e){return s$(e)}function r$(e){return new U_(e)}function yut(e){return r$(e)}function but(e){return r$(e)}function i$(e){return new G_(e)}function vut(e){return i$(e)}function wut(e){return i$(e)}function Sut(e){return new H_(e)}function kut(e){return new q_(e)}function g5(e){return new K_(e)}function x5(e){return new X_(e)}function y5(e){return new B_(e)}function b5(e){return new W_(e)}function Cut(e){return new j_(e)}function Iut(e){return new m_(e)}function Tut(e){return new Jv(e)}function Nut(e){return new g_(e)}function _ut(e){return new Ag(e)}function $ut(e){return new p_(e)}function Eut(e){return new Qv(e)}function Aut(e){return new x_(e)}function Rut(e){return new ew(e)}function Dut(e){return new si(e)}function Out(e){return new tw(e)}function Put(e){return new Z_(e)}function Fut(e){return new Y_(e)}const Lut=g5,Mut=x5,zut=y5,But=b5;function Vut(e){return new O_(e)}function Wut(e){return new P_(e)}function Uut(e){return new F_(e)}function jut(e){return new I_(e)}function Gut(e){return new Q_(e)}function Hut(e){return new J_(e)}function Kut(e){return new e$(e)}function qut(e){return new t$(e)}function Xut(e){return new n$(e)}const Yut=Object.freeze(Object.defineProperty({__proto__:null,Layer:Ot,RNN:si,RNNCell:Eg,activation:Zct,add:out,alphaDropout:Uut,average:aut,averagePooling1d:s$,averagePooling2d:r$,averagePooling3d:i$,avgPool1d:gut,avgPool2d:yut,avgPool3d:vut,avgPooling1d:xut,avgPooling2d:but,avgPooling3d:wut,batchNormalization:fut,bidirectional:Put,categoryEncoding:qut,centerCrop:Hut,concatenate:lut,conv1d:Wct,conv2d:Uct,conv2dTranspose:jct,conv3d:Gct,conv3dTranspose:Hct,convLstm2d:Aut,convLstm2dCell:Rut,cropping2D:qct,dense:Qct,depthwiseConv2d:Yct,dot:dut,dropout:Jct,elu:Fct,embedding:iut,flatten:eut,gaussianDropout:Wut,gaussianNoise:Vut,globalAveragePooling1d:Sut,globalAveragePooling2d:kut,globalMaxPool1d:Lut,globalMaxPool2d:Mut,globalMaxPooling1d:g5,globalMaxPooling2d:x5,gru:Iut,gruCell:Tut,input:zV,inputLayer:Pct,layerNormalization:put,leakyReLU:Mct,lstm:Nut,lstmCell:_ut,masking:jut,maxPool1d:zut,maxPool2d:But,maxPooling1d:y5,maxPooling2d:b5,maxPooling3d:Cut,maximum:cut,minimum:uut,multiply:hut,permute:rut,prelu:zct,randomWidth:Xut,reLU:Lct,repeatVector:nut,rescaling:Gut,reshape:sut,resizing:Kut,rnn:Dut,separableConv2d:Kct,simpleRNN:$ut,simpleRNNCell:Eut,softmax:Bct,spatialDropout1d:tut,stackedRNNCells:Out,thresholdedReLU:Vct,timeDistributed:Fut,upSampling2d:Xct,zeroPadding2d:mut},Symbol.toStringTag,{value:"Module"}));function Zut(e,t){return YN(e,t)}function Qut(e,t){return EV(e,t)}function Jut(e,t){return AV(e,t)}function tht(e,t){return ZN(e,t)}function eht(e,t){return QN(e,t)}function nht(e,t){return $V(e,t)}function sht(e,t){return Olt(e,t)}function rht(e,t){return XN(e,t)}function iht(e,t){return qv(e,t)}function oht(e,t){return fd(e,t)}function aht(e,t){return fd(e,t)}function lht(e,t){return fd(e,t)}function cht(e,t){return Fc(e,t)}function uht(e,t){return Fc(e,t)}function hht(e,t){return Fc(e,t)}function dht(e,t){return Plt(e,t)}const fht=Object.freeze(Object.defineProperty({__proto__:null,MAPE:aht,MSE:uht,binaryAccuracy:Zut,binaryCrossentropy:Qut,categoricalAccuracy:tht,categoricalCrossentropy:eht,cosineProximity:rht,mape:lht,meanAbsoluteError:iht,meanAbsolutePercentageError:oht,meanSquaredError:cht,mse:hht,precision:nht,r2Score:dht,recall:sht,sparseCategoricalAccuracy:Jut},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const pht=Object.freeze(Object.defineProperty({__proto__:null,modelFromJSON:uct},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mht(e){return new _g(e)}function ght(e){return xct(e)}function xht(e){return yct(e)}const yht=Object.freeze(Object.defineProperty({__proto__:null,l1:ght,l1l2:mht,l2:xht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class v5 extends Xu{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof io))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function y0(e,t){return e<t}function GD(e,t){return e>t}class w5 extends v5{constructor(t){if(super(),t==null&&(t={}),t.restoreBestWeights)throw new $t("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=y0:this.mode==="max"?this.monitorFunc=GD:this.monitor.indexOf("acc")!==-1?this.monitorFunc=GD:this.monitorFunc=y0,this.monitorFunc===y0&&(this.minDelta*=-1)}async onTrainBegin(t){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===y0?1/0:-1/0}async onEpochEnd(t,n){await Mo(n);const s=this.getMonitorValue(n);s!=null&&(this.monitorFunc(s-this.minDelta,this.best)?(this.best=s,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))}async onTrainEnd(t){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(t){t==null&&(t={});const n=t[this.monitor];return n==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(t)}`),n}}function bht(e){return new w5(e)}const vht={earlyStopping:bht};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wht=H();wht.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ws;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(ws||(ws={}));var HD;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(HD||(HD={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$={};function Sht(e,t){const n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};o$[e]=n}function S5(e){return o$[e]}function kht(e){delete o$[e]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S(e,t,n,s,r){const i=t.inputParams[e];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd,c=a<0?t.inputNames.length+a:a;if(i.type==="tensor")return Sn(t.inputNames[c],n,s,r);if(i.type==="tensors"){const d=t.inputs.slice(a,l);return t.inputNames.slice(a,l).filter((p,g)=>{var m;return((m=d[g])===null||m===void 0?void 0:m.op)!=="NoOp"}).map(p=>Sn(p,n,s,r))}const u=Sn(t.inputNames[c],n,s,r),h=u.dataSync();return i.type==="number"?h[0]:Js(u.shape,h)}const o=t.attrParams[e];return o&&o.value}function Sn(e,t,n,s){const[r,i]=ks(e,n);if(s!=null){const a=s.getHashTableHandleByName(r);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!t[Ly(r,a)]);return o!==void 0?t[Ly(r,o)][i]:void 0}function KD(e,t,n){return t[Ly(e,n.currentContextId)]}function Vi(e,t){const[n,s,r]=ks(e,t);return[Ly(n,t&&t.currentContextId),s,r]}function Ly(e,t){return t?`${e}-${t}`:e}function ks(e,t){if(e==="")return["",0,void 0];const n=t!=null&&t.parseNodeNameCache!=null;if(n){const i=t.parseNodeNameCache.get(e);if(i!=null)return i}const s=e.split(":");let r;if(s.length===1)r=[e,0,void 0];else{const i=s[0],o=s.length===3?s[1]:void 0,a=Number(s[s.length-1]);r=[i,a,o]}return n&&t.parseNodeNameCache.set(e,r),r}function ox(e,t,n){let s=S("pad",e,t,n);if(s==="explicit"){s=S("explicitPaddings",e,t,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)r[i][0]=s[i*2],r[i][1]=s[i*2+1];return r}return s}function Wi(e){return e.kept?e:yi(e)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cht=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Iht=Object.freeze(Object.defineProperty({__proto__:null,json:Cht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tht=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Nht=Object.freeze(Object.defineProperty({__proto__:null,json:Tht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ht=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],$ht=Object.freeze(Object.defineProperty({__proto__:null,json:_ht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eht=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Aht=Object.freeze(Object.defineProperty({__proto__:null,json:Eht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rht=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Dht=Object.freeze(Object.defineProperty({__proto__:null,json:Rht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oht=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Pht=Object.freeze(Object.defineProperty({__proto__:null,json:Oht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fht=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Lht=Object.freeze(Object.defineProperty({__proto__:null,json:Fht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mht=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],zht=Object.freeze(Object.defineProperty({__proto__:null,json:Mht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bht=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Vht=Object.freeze(Object.defineProperty({__proto__:null,json:Bht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wht=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Uht=Object.freeze(Object.defineProperty({__proto__:null,json:Wht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jht=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Ght=Object.freeze(Object.defineProperty({__proto__:null,json:jht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hht=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Kht=Object.freeze(Object.defineProperty({__proto__:null,json:Hht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qht=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Xht=Object.freeze(Object.defineProperty({__proto__:null,json:qht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yht=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Zht=Object.freeze(Object.defineProperty({__proto__:null,json:Yht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qht=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Jht=Object.freeze(Object.defineProperty({__proto__:null,json:Qht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tdt=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],edt=Object.freeze(Object.defineProperty({__proto__:null,json:tdt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ndt=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],sdt=Object.freeze(Object.defineProperty({__proto__:null,json:ndt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rdt=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],idt=Object.freeze(Object.defineProperty({__proto__:null,json:rdt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const odt=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],adt=Object.freeze(Object.defineProperty({__proto__:null,json:odt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qD{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[Iht,Nht,$ht,Aht,Dht,Pht,Lht,zht,Vht,Uht,Ght,Kht,Xht,Zht,Jht,edt,sdt,idt,adt],n=[].concat(...t.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(t,n={}){const s=t.node,r=[],i=[],o=[],a=s.reduce((g,m)=>(g[m.name]=this.mapNode(m),m.op.startsWith("Placeholder")?r.push(g[m.name]):m.op==="Const"?i.push(g[m.name]):(m.input==null||m.input.length===0)&&o.push(g[m.name]),g),{});let l=[];const c=[];let u={},h={};n!=null&&(u=this.mapSignatureEntries(n.inputs),h=this.mapSignatureEntries(n.outputs));const d=Object.keys(a);d.forEach(g=>{const m=a[g];m.inputNames.forEach((x,y)=>{const[b,,v]=Vi(x),w=a[b];if(w.outputs!=null){const k=w.outputs.indexOf(v);if(k!==-1){const I=`${b}:${k}`;m.inputNames[y]=I}}m.inputs.push(w),w.children.push(m)})}),Object.keys(h).length===0?d.forEach(g=>{const m=a[g];m.children.length===0&&c.push(m)}):Object.keys(h).forEach(g=>{const[m]=Vi(g),x=a[m];x!=null&&(x.signatureKey=h[g],c.push(x))}),Object.keys(u).length>0?Object.keys(u).forEach(g=>{const[m]=Vi(g),x=a[m];x&&(x.signatureKey=u[g],l.push(x))}):l=r;let f={};t.library!=null&&t.library.function!=null&&(f=t.library.function.reduce((g,m)=>(g[m.signature.name]=this.mapFunction(m),g),{}));const p={nodes:a,inputs:l,outputs:c,weights:i,placeholders:r,signature:n,functions:f};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(t){return Object.keys(t||{}).reduce((n,s)=>(n[t[s].name]=s,n),{})}mapNode(t){const n=S5(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const s={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,i)=>(r[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,i)=>{const o=i.type;let a;switch(i.type){case"string":a=Sk(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=Sk(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=$k(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=$k(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=Ck(t.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=Ck(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=_k(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=_k(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=kk(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=kk(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=Ak(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=Ak(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=Nk(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=Nk(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=Ek(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=Ek(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=Ik(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=Ik(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=Tk(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=Tk(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=XD(t.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=XD(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${t.op}`)}return r[i.name]={value:a,type:o},r},{})),s}mapFunction(t){const n=t.nodeDef,s=[],r=[];let i={};n!=null&&(i=n.reduce((h,d)=>(h[d.name]=this.mapNode(d),d.op==="Const"&&r.push(h[d.name]),h),{}));const o=[],a=[];t.signature.inputArg.forEach(h=>{const[d]=Vi(h.name),f={name:d,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:a$(h.type),type:"dtype"}},children:[]};f.signatureKey=h.name,o.push(f),i[d]=f}),Object.keys(i).forEach(h=>{const d=i[h];d.inputNames.forEach((f,p)=>{const[g,,m]=Vi(f),x=i[g];if(x.outputs!=null){const y=x.outputs.indexOf(m);if(y!==-1){const b=`${g}:${y}`;d.inputNames[p]=b}}d.inputs.push(x),x.children.push(d)})});const c=t.ret;t.signature.outputArg.forEach(h=>{const[d,f]=Vi(c[h.name]),p=i[d];p!=null&&(p.defaultOutput=f,a.push(p))});const u=this.mapArgsToSignature(t);return{nodes:i,inputs:o,outputs:a,weights:r,placeholders:s,signature:u}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:t.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,t.ret),n),{})}}mapArgToTensorInfo(t,n){let s=t.name;return n!=null&&(s=n[s]),{name:s,dtype:t.type}}}function ldt(e){const t=H().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function k5(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):ldt(e);return t?n:n.toLowerCase()}function Sk(e,t,n,s=!1){const r=e[t];return r!=null?k5(r.s,s):n}function kk(e,t,n){const s=e[t];return s?s.b:n}function Ck(e,t,n){const s=e[t]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function a$(e){switch(typeof e=="string"&&(e=ws[e]),e){case ws.DT_FLOAT:case ws.DT_HALF:return"float32";case ws.DT_INT32:case ws.DT_INT64:case ws.DT_INT8:case ws.DT_UINT8:return"int32";case ws.DT_BOOL:return"bool";case ws.DT_DOUBLE:return"float32";case ws.DT_STRING:return"string";case ws.DT_COMPLEX64:case ws.DT_COMPLEX128:return"complex64";default:return null}}function XD(e,t,n){const s=e[t];return s&&s.func?s.func.name:n}function Ik(e,t,n){const s=e[t];return s&&s.type?a$(s.type):n}function Tk(e,t,n){const s=e[t];return s&&s.list&&s.list.type?s.list.type.map(r=>a$(r)):n}function C5(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function Nk(e,t,n){const s=e[t];return s&&s.shape?C5(s.shape):n}function _k(e,t,n){const s=e[t];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function $k(e,t,n,s=!1){const r=e[t];return r&&r.list&&r.list.s?r.list.s.map(i=>k5(i,s)):n}function Ek(e,t,n){const s=e[t];return s&&s.list&&s.list.shape?s.list.shape.map(r=>C5(r)):n}function Ak(e,t,n){const s=e[t];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cdt{constructor(t,n,s){this.node=t,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(r=>this.getInput(r)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((r,i)=>(r[i]=this.getAttr(i),r),{}))}getInput(t){return Sn(t,this.tensorMap,this.context)}getAttr(t,n){const s=this.node.rawAttrs[t];if(s.tensor!=null)return Sn(t,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return Ck(this.node.rawAttrs,t,n);if(s.s!=null)return Sk(this.node.rawAttrs,t,n);if(s.b!=null)return kk(this.node.rawAttrs,t,n);if(s.shape!=null)return Nk(this.node.rawAttrs,t,n);if(s.type!=null)return Ik(this.node.rawAttrs,t,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return _k(this.node.rawAttrs,t,n);if(s.list.s!=null)return $k(this.node.rawAttrs,t,n);if(s.list.shape!=null)return Ek(this.node.rawAttrs,t,n);if(s.list.b!=null)return Ak(this.node.rawAttrs,t,n);if(s.list.type!=null)return Tk(this.node.rawAttrs,t,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const En=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:OI,abs:je,acos:WI,acosh:UI,add:tt,addN:uz,all:Qb,any:vp,argMax:ec,argMin:jI,asin:GI,asinh:HI,atan:KI,atan2:qI,atanh:XI,avgPool:sg,avgPool3d:ZI,basicLSTMCell:hz,batchNorm:rd,batchNorm2d:QI,batchNorm3d:JI,batchNorm4d:tT,batchToSpaceND:rg,bincount:eT,bitwiseAnd:dz,booleanMaskAsync:Zz,broadcastArgs:fz,broadcastTo:Ol,buffer:Et,cast:ot,ceil:nT,clipByValue:fs,clone:yi,complex:go,concat:Me,concat1d:sT,concat2d:rT,concat3d:iT,concat4d:oT,conv1d:Jb,conv2d:xo,conv2dTranspose:tv,conv3d:lT,conv3dTranspose:cT,cos:ig,cosh:ev,cosineWindow:Cv,cumprod:kp,cumsum:nv,denseBincount:Ty,depthToSpace:uT,depthwiseConv2d:id,diag:mz,dilation2d:hT,div:gt,divNoNan:dT,dot:fT,dropout:KT,einsum:ml,elu:od,enclosingPowerOfTwo:qT,ensureShape:gz,equal:Os,erf:sv,euclideanNorm:mT,exp:ps,expandDims:wn,expm1:gT,eye:rv,fft:yg,fill:Ec,floor:ld,floorDiv:Zb,fused:oB,gather:cd,gatherND:eB,greater:ns,greaterEqual:Io,ifft:Ku,imag:og,image:wr,inTopKAsync:nB,irfft:yv,isFinite:xT,isInf:yT,isNaN:bT,leakyRelu:ag,less:Uu,lessEqual:ja,linalg:ZT,linspace:bz,localResponseNormalization:vT,log:Ps,log1p:lg,logSigmoid:wT,logSoftmax:ov,logSumExp:cg,logicalAnd:Tr,logicalNot:ug,logicalOr:av,logicalXor:ST,losses:fB,lowerBound:wz,matMul:Rt,max:tr,maxPool:hg,maxPool3d:kT,maxPoolWithArgmax:Sz,maximum:Ei,mean:ke,meshgrid:kz,min:Wu,minimum:Ta,mirrorPad:CT,mod:IT,moments:dg,movingAverage:Qz,mul:M,multiRNNCell:Cz,multinomial:Iz,neg:oe,norm:ad,notEqual:rc,oneHot:ju,ones:ls,onesLike:Fs,op:O,outerProduct:Tz,pad:To,pad1d:Nz,pad2d:_z,pad3d:$z,pad4d:Ez,pool:TT,pow:Ti,prelu:pg,print:VI,prod:NT,raggedGather:Az,raggedRange:Rz,raggedTensorToTensor:Dz,rand:Oz,randomGamma:Mz,randomNormal:cv,randomStandardNormal:zz,randomUniform:Ga,randomUniformInt:Bz,range:ic,real:Gu,reciprocal:LT,relu:ei,relu6:uv,reshape:V,reverse:sr,reverse1d:Vz,reverse2d:Wz,reverse3d:Uz,reverse4d:jz,rfft:bg,round:hv,rsqrt:dv,scalar:yt,scatterND:Jz,searchSorted:lv,selu:fv,separableConv2d:pv,setdiff1dAsync:Gz,sigmoid:jr,sign:MT,signal:dB,sin:mv,sinh:gv,slice:zt,slice1d:mg,slice2d:xv,slice3d:gg,slice4d:Hu,softmax:xg,softplus:Ac,spaceToBatchND:fg,sparse:pB,sparseToDense:tB,spectral:hB,split:us,sqrt:pn,square:ee,squaredDifference:bv,squeeze:Ha,stack:Qn,step:Dc,stridedSlice:zT,string:mB,sub:dt,sum:ft,tan:BT,tanh:Ia,tensor:Ds,tensor1d:cn,tensor2d:ro,tensor3d:VT,tensor4d:Hz,tensor5d:Kz,tensor6d:qz,tensorScatterUpdate:Xz,tile:Xs,topk:UT,transpose:Ft,truncatedNormal:wv,unique:jT,unsortedSegmentSum:Sv,unstack:rr,upperBound:Yz,variable:GT,where:dn,whereAsync:HT,zeros:He,zerosLike:Bt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const udt=(e,t,n,s=En)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(S("a",e,t,n),S("b",e,t,n))];case"AddN":return[s.addN(S("tensors",e,t,n))];case"FloorMod":case"Mod":return[s.mod(S("a",e,t,n),S("b",e,t,n))];case"Mul":return[s.mul(S("a",e,t,n),S("b",e,t,n))];case"RealDiv":case"Div":return[s.div(S("a",e,t,n),S("b",e,t,n))];case"DivNoNan":return[s.divNoNan(S("a",e,t,n),S("b",e,t,n))];case"FloorDiv":return[s.floorDiv(S("a",e,t,n),S("b",e,t,n))];case"Sub":return[s.sub(S("a",e,t,n),S("b",e,t,n))];case"Minimum":return[s.minimum(S("a",e,t,n),S("b",e,t,n))];case"Maximum":return[s.maximum(S("a",e,t,n),S("b",e,t,n))];case"Pow":return[s.pow(S("a",e,t,n),S("b",e,t,n))];case"SquaredDifference":return[s.squaredDifference(S("a",e,t,n),S("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hdt=(e,t,n,s=En)=>{switch(e.op){case"Abs":case"ComplexAbs":return[s.abs(S("x",e,t,n))];case"Acos":return[s.acos(S("x",e,t,n))];case"Acosh":return[s.acosh(S("x",e,t,n))];case"Asin":return[s.asin(S("x",e,t,n))];case"Asinh":return[s.asinh(S("x",e,t,n))];case"Atan":return[s.atan(S("x",e,t,n))];case"Atan2":return[s.atan2(S("x",e,t,n),S("y",e,t,n))];case"Atanh":return[s.atanh(S("x",e,t,n))];case"Ceil":return[s.ceil(S("x",e,t,n))];case"Complex":return[s.complex(S("real",e,t,n),S("imag",e,t,n))];case"Cos":return[s.cos(S("x",e,t,n))];case"Cosh":return[s.cosh(S("x",e,t,n))];case"Elu":return[s.elu(S("x",e,t,n))];case"Erf":return[s.erf(S("x",e,t,n))];case"Exp":return[s.exp(S("x",e,t,n))];case"Expm1":return[s.expm1(S("x",e,t,n))];case"Floor":return[s.floor(S("x",e,t,n))];case"Log":return[s.log(S("x",e,t,n))];case"Log1p":return[s.log1p(S("x",e,t,n))];case"Imag":return[s.imag(S("x",e,t,n))];case"Neg":return[s.neg(S("x",e,t,n))];case"Reciprocal":return[s.reciprocal(S("x",e,t,n))];case"Real":return[s.real(S("x",e,t,n))];case"Relu":return[s.relu(S("x",e,t,n))];case"Round":return[s.round(S("x",e,t,n))];case"Selu":return[s.selu(S("x",e,t,n))];case"Sigmoid":return[s.sigmoid(S("x",e,t,n))];case"Sin":return[s.sin(S("x",e,t,n))];case"Sign":return[s.sign(S("x",e,t,n))];case"Sinh":return[s.sinh(S("x",e,t,n))];case"Softplus":return[s.softplus(S("x",e,t,n))];case"Sqrt":return[s.sqrt(S("x",e,t,n))];case"Square":return[s.square(S("x",e,t,n))];case"Tanh":return[s.tanh(S("x",e,t,n))];case"Tan":return[s.tan(S("x",e,t,n))];case"ClipByValue":return[s.clipByValue(S("x",e,t,n),S("clipValueMin",e,t,n),S("clipValueMax",e,t,n))];case"Relu6":return[s.relu6(S("x",e,t,n))];case"Rsqrt":return[s.rsqrt(Sn(e.inputNames[0],t,n))];case"LeakyRelu":return[s.leakyRelu(S("x",e,t,n),S("alpha",e,t,n))];case"Prelu":return[s.prelu(S("x",e,t,n),S("alpha",e,t,n))];case"IsNan":return[s.isNaN(Sn(e.inputNames[0],t,n))];case"IsInf":return[s.isInf(Sn(e.inputNames[0],t,n))];case"IsFinite":return[s.isFinite(Sn(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fr(e,t,n=""){if(!(typeof e=="number"||typeof t=="number")){T(e.length===t.length,()=>n+` Shapes ${e} and ${t} must match`);for(let s=0;s<e.length;s++){const r=e[s],i=t[s];T(r<0||i<0||r===i,()=>n+` Shapes ${e} and ${t} must match`)}}}function YD(e){return!(typeof e=="number"||e.some(t=>t<0))}function Vd(e,t,n){let s=Rk(e,n);const r=!YD(s);if(r&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&t.forEach(i=>{s=Rk(i.shape,s)}),!YD(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function Rk(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const n=[];for(let s=0;s<e.length;++s){const r=e[s],i=t[s];if(r>=0&&i>=0&&r!==i)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[s]=r>=0?r:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ddt{constructor(t,n,s,r,i,o,a){this.name=t,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=yt(0),Je(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const n=this.tensors[t];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(t){return t.map(n=>this.read(n))}write(t,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),fr(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);s.tensor=n,Je(n),s.written=!0,this.tensors[t]=s}writeMany(t,n){if(t.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${n.length}.`);t.forEach((s,r)=>this.write(s,n[r]))}gather(t,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(t)t=t.slice(0,this.size());else{t=[];for(let r=0;r<this.size();r++)t.push(r)}if(t.length===0)return Ds([],[0].concat(this.elementShape));const s=this.readMany(t);return fr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Qn(s,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return Ds([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return fr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Me(s,0)}scatter(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const s=Math.max(...t);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(t,rr(n,0))}split(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=t.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const i=s===0?0:n.size/s,o=[];G(()=>{n=V(n,[1,s,i]);for(let l=0;l<t.length;++l){const u=[0,l===0?0:r[l-1],0],h=[1,t[l],i];o[l]=V(zt(n,u,h),this.elementShape)}return o});const a=[];for(let l=0;l<t.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cc{get id(){return this.idTensor.id}constructor(t,n,s,r=-1){this.tensors=t,this.elementShape=n,this.elementDtype=s,t!=null&&t.forEach(i=>{if(s!==i.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${i.dtype}`);fr(n,i.shape,"TensorList shape mismatch: "),Je(i)}),this.idTensor=yt(0),this.maxNumElements=r,Je(this.idTensor)}copy(){return new cc([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);fr(t,this.elementShape,"TensorList shape mismatch: ");const r=Vd(this.elementShape,this.tensors,t);return G(()=>{const i=this.tensors.map(o=>V(o,r));return Qn(i,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Vd(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,fr(r.shape,t,"TensorList shape mismatch: "),V(r,s)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(fr(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Je(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const n=new cc([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(let s=0;s<Math.min(this.tensors.length,t);++s)n.tensors[s]=this.tensors[s];return n}getItem(t,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);fr(this.tensors[t].shape,n,"TensorList shape mismatch: ");const r=Vd(this.elementShape,this.tensors,n);return V(this.tensors[t],r)}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);fr(this.elementShape,n.shape,"TensorList shape mismatch: "),Je(n),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=n}gather(t,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);fr(this.elementShape,s,"TensorList shape mismatch: "),t=t.slice(0,this.size());const r=Vd(this.elementShape,this.tensors,s);return t.length===0?Ds([],[0].concat(r)):G(()=>{const i=t.map(o=>V(this.tensors[o],r));return Qn(i,0)})}concat(t,n){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);fr(this.elementShape,n,"TensorList shape mismatch: ");const s=Vd(this.elementShape,this.tensors,n);return this.size()===0?Ds([],[0].concat(s)):G(()=>{const r=this.tensors.map(i=>V(i,s));return Me(r,0)})}}function fdt(e,t,n){const s=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);const r=e.shape.slice(1);fr(r,t,"TensorList shape mismatch: ");const i=rr(e);return new cc(i,t,s)}function pdt(e,t,n,s){return new cc([],e,t,s)}function mdt(e,t,n,s){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const r=Math.max(...t);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const i=new cc([],n,e.dtype,s),o=rr(e,0);return t.forEach((a,l)=>{i.setItem(a,o[l])}),i}function gdt(e,t,n){let s=0;const r=t.map(u=>(s+=u,s));if(s!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${e.shape}`);const i=e.shape.slice(1),o=Rk(i,n),a=s===0?0:e.size/s,l=G(()=>{const u=[];e=V(e,[1,s,a]);for(let h=0;h<t.length;++h){const f=[0,h===0?0:r[h-1],0],p=[1,t[h],a];u[h]=V(zt(e,f,p),o)}return e.dispose(),u}),c=new cc([],n,e.dtype,t.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xdt=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const s=S("thenBranch",e,t,n),r=S("elseBranch",e,t,n),i=S("cond",e,t,n),o=S("args",e,t,n);return(await i.data())[0]?n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=S("body",e,t,n),r=S("cond",e,t,n),i=S("args",e,t,n),o=await n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(u=>u.id);let l=await o[0].data();o.forEach(u=>{!u.kept&&a.indexOf(u.id)===-1&&u.dispose()});let c=i;for(;l[0];){const u=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const h=c.map(f=>f.id);u.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&h.indexOf(f.id)===-1&&f.dispose()});const d=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await d[0].data(),d.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&h.indexOf(f.id)===-1&&f.dispose()})}return c}case"LoopCond":{const s=S("pred",e,t,n);return[Wi(s)]}case"Switch":{const s=S("pred",e,t,n);let r=S("data",e,t,n);return r.kept||(r=Wi(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=e.inputNames.find(r=>Sn(r,t,n)!==void 0);if(s){const r=Sn(s,t,n);return[Wi(r)]}return}case"Enter":{const s=S("frameName",e,t,n),r=S("tensor",e,t,n);return n.enterFrame(s),[Wi(r)]}case"Exit":{const s=S("tensor",e,t,n);return n.exitFrame(),[Wi(s)]}case"NextIteration":{const s=S("tensor",e,t,n);return n.nextIteration(),[Wi(s)]}case"TensorArrayV3":{const s=S("size",e,t,n),r=S("dtype",e,t,n),i=S("elementShape",e,t,n),o=S("dynamicSize",e,t,n),a=S("clearAfterRead",e,t,n),l=S("identicalElementShapes",e,t,n),c=S("name",e,t,n),u=new ddt(c,r,s,i,l,o,a);return n.addTensorArray(u),[u.idTensor,yt(1)]}case"TensorArrayWriteV3":{const s=S("tensorArrayId",e,t,n),r=S("index",e,t,n),i=S("tensor",e,t,n),o=n.getTensorArray(s.id);return o.write(r,i),[o.idTensor]}case"TensorArrayReadV3":{const s=S("tensorArrayId",e,t,n),r=S("index",e,t,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=S("tensorArrayId",e,t,n),r=S("indices",e,t,n),i=S("dtype",e,t,n);return[n.getTensorArray(s.id).gather(r,i)]}case"TensorArrayScatterV3":{const s=S("tensorArrayId",e,t,n),r=S("indices",e,t,n),i=S("tensor",e,t,n),o=n.getTensorArray(s.id);return o.scatter(r,i),[o.idTensor]}case"TensorArrayConcatV3":{const s=S("tensorArrayId",e,t,n),r=n.getTensorArray(s.id),i=S("dtype",e,t,n);return[r.concat(i)]}case"TensorArraySplitV3":{const s=S("tensorArrayId",e,t,n),r=S("tensor",e,t,n),i=S("lengths",e,t,n),o=n.getTensorArray(s.id);return o.split(i,r),[o.idTensor]}case"TensorArraySizeV3":{const s=S("tensorArrayId",e,t,n),r=n.getTensorArray(s.id);return[yt(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=S("tensorArrayId",e,t,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=S("tensorListId",e,t,n),r=S("index",e,t,n),i=S("tensor",e,t,n),o=n.getTensorList(s.id);return o.setItem(r,i),[o.idTensor]}case"TensorListGetItem":{const s=S("tensorListId",e,t,n),r=S("index",e,t,n),i=S("elementShape",e,t,n),o=S("elementDType",e,t,n);return[n.getTensorList(s.id).getItem(r,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=S("indices",e,t,n),r=S("tensor",e,t,n),i=S("elementShape",e,t,n),o=S("numElements",e,t,n),a=mdt(r,s,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=S("elementShape",e,t,n),r=S("elementDType",e,t,n);let i;e.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=S(i,e,t,n),a=e.op==="TensorListReserve"?-1:o,l=pdt(s,r,o,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=S("tensorListId",e,t,n),r=S("indices",e,t,n),i=S("elementShape",e,t,n),o=S("elementDType",e,t,n);return[n.getTensorList(s.id).gather(r,o,i)]}case"TensorListStack":{const s=S("tensorListId",e,t,n),r=S("elementShape",e,t,n),i=S("elementDType",e,t,n),o=S("numElements",e,t,n);return[n.getTensorList(s.id).stack(r,i,o)]}case"TensorListFromTensor":{const s=S("tensor",e,t,n),r=S("elementShape",e,t,n),i=S("elementDType",e,t,n),o=fdt(s,r,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=S("tensorListId",e,t,n),r=n.getTensorList(s.id),i=S("dtype",e,t,n),o=S("elementShape",e,t,n);return[r.concat(i,o)]}case"TensorListPushBack":{const s=S("tensorListId",e,t,n),r=S("tensor",e,t,n),i=n.getTensorList(s.id);return i.pushBack(r),[i.idTensor]}case"TensorListPopBack":{const s=S("tensorListId",e,t,n),r=S("elementShape",e,t,n),i=S("elementDType",e,t,n);return[n.getTensorList(s.id).popBack(r,i)]}case"TensorListSplit":{const s=S("tensor",e,t,n),r=S("elementShape",e,t,n),i=S("lengths",e,t,n),o=gdt(s,i,r);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const s=S("tensorListId",e,t,n),r=n.getTensorList(s.id);return[yt(r.size(),"int32")]}case"TensorListResize":{const s=S("tensorListId",e,t,n),r=S("size",e,t,n),o=n.getTensorList(s.id).resize(r);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZD(e,t,n){const[s,r]=S("fusedOps",e,t,n),i=s==="biasadd",o=!i,a=r==="prelu",l=s==="fusedbatchnorm",c=S("numArgs",e,t,n);if(i){if(a&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=S("strides",e,t,n),h=ox(e,t,n),d=S("dataFormat",e,t,n).toUpperCase(),f=S("dilations",e,t,n);let[p,g]=S("args",e,t,n);o&&(g=p,p=void 0);const m=S("leakyreluAlpha",e,t,n);return{stride:u,pad:h,dataFormat:d,dilations:f,biasArg:p,preluArg:g,activationFunc:r,leakyreluAlpha:m}}const ydt=(e,t,n,s=En)=>{switch(e.op){case"Conv1D":{const r=S("stride",e,t,n),i=S("pad",e,t,n),o=S("dataFormat",e,t,n).toUpperCase(),a=S("dilation",e,t,n);return[s.conv1d(S("x",e,t,n),S("filter",e,t,n),r,i,o,a)]}case"Conv2D":{const r=S("strides",e,t,n),i=ox(e,t,n),o=S("dataFormat",e,t,n).toUpperCase(),a=S("dilations",e,t,n);return[s.conv2d(S("x",e,t,n),S("filter",e,t,n),[r[1],r[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:h}=ZD(e,t,n);return[s.fused.conv2d({x:S("x",e,t,n),filter:S("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:h}=ZD(e,t,n);return[s.fused.depthwiseConv2d({x:S("x",e,t,n),filter:S("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=S("outputShape",e,t,n),i=S("strides",e,t,n),o=ox(e,t,n);return[s.conv2dTranspose(S("x",e,t,n),S("filter",e,t,n),r,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=S("strides",e,t,n),i=ox(e,t,n),o=S("dilations",e,t,n),a=S("dataFormat",e,t,n).toUpperCase();return[s.depthwiseConv2d(S("input",e,t,n),S("filter",e,t,n),[r[1],r[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const r=S("strides",e,t,n),i=S("pad",e,t,n),o=S("dataFormat",e,t,n).toUpperCase(),a=S("dilations",e,t,n);return[s.conv3d(S("x",e,t,n),S("filter",e,t,n),[r[1],r[2],r[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const r=S("strides",e,t,n),i=S("pad",e,t,n),o=S("kernelSize",e,t,n);return[s.avgPool(S("x",e,t,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=S("strides",e,t,n),i=S("pad",e,t,n),o=S("kernelSize",e,t,n);return[s.maxPool(S("x",e,t,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=S("strides",e,t,n),i=S("pad",e,t,n),o=S("kernelSize",e,t,n),a=S("includeBatchInIndex",e,t,n),{result:l,indexes:c}=s.maxPoolWithArgmax(S("x",e,t,n),[o[1],o[2]],[r[1],r[2]],i,a);return[l,c]}case"AvgPool3D":{const r=S("strides",e,t,n),i=S("pad",e,t,n),o=S("kernelSize",e,t,n);return[s.avgPool3d(S("x",e,t,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=S("strides",e,t,n),i=S("pad",e,t,n),o=S("kernelSize",e,t,n);return[s.maxPool3d(S("x",e,t,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=S("strides",e,t,n),i=S("pad",e,t,n),o=S("dilations",e,t,n),a=r[1],l=r[2],c=o[1],u=o[2];return[s.dilation2d(S("x",e,t,n),S("filter",e,t,n),[a,l],i,[c,u],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bdt=(e,t,n,s=En)=>{switch(e.op){case"Fill":{const r=S("shape",e,t,n),i=S("dtype",e,t,n),o=S("value",e,t,n);return[s.fill(r,o,i)]}case"LinSpace":{const r=S("start",e,t,n),i=S("stop",e,t,n),o=S("num",e,t,n);return[s.linspace(r,i,o)]}case"Multinomial":{const r=S("logits",e,t,n),i=S("numSamples",e,t,n),o=S("seed",e,t,n);return[s.multinomial(r,i,o)]}case"OneHot":{const r=S("indices",e,t,n),i=S("depth",e,t,n),o=S("onValue",e,t,n),a=S("offValue",e,t,n),l=S("dtype",e,t,n);return[s.oneHot(r,i,o,a,l)]}case"Ones":return[s.ones(S("shape",e,t,n),S("dtype",e,t,n))];case"OnesLike":return[s.onesLike(S("x",e,t,n))];case"RandomStandardNormal":return[s.randomStandardNormal(S("shape",e,t,n),S("dtype",e,t,n),S("seed",e,t,n))];case"RandomUniform":return[s.randomUniform(S("shape",e,t,n),S("minval",e,t,n),S("maxval",e,t,n),S("dtype",e,t,n))];case"RandomUniformInt":return[s.randomUniformInt(S("shape",e,t,n),S("minval",e,t,n),S("maxval",e,t,n),S("seed",e,t,n))];case"Range":{const r=S("start",e,t,n),i=S("stop",e,t,n),o=S("step",e,t,n);return[s.range(r,i,o,S("dtype",e,t,n))]}case"TruncatedNormal":{const r=S("shape",e,t,n),i=S("mean",e,t,n),o=S("stdDev",e,t,n),a=S("seed",e,t,n);return[s.truncatedNormal(r,i,o,S("dtype",e,t,n),a)]}case"Zeros":return[s.zeros(S("shape",e,t,n),S("dtype",e,t,n))];case"ZerosLike":return[s.zerosLike(S("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2(e,t,n){const s=S("boxes",e,t,n),r=S("scores",e,t,n),i=S("maxOutputSize",e,t,n),o=S("iouThreshold",e,t,n),a=S("scoreThreshold",e,t,n),l=S("softNmsSigma",e,t,n);return{boxes:s,scores:r,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const vdt=async(e,t,n,s,r=En)=>{switch(e.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=g2(e,t,n),h=await r.image.nonMaxSuppressionWithScoreAsync(i,o,a,l,c,u);return[h.selectedIndices,h.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=g2(e,t,n),u=S("padToMaxOutputSize",e,t,n),h=await r.image.nonMaxSuppressionPaddedAsync(i,o,a,l,c,u);return[h.selectedIndices,h.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=g2(e,t,n);return[await r.image.nonMaxSuppressionAsync(i,o,a,l,c)]}case"Where":{const i=r.cast(S("condition",e,t,n),"bool"),o=[await r.whereAsync(i)];return i.dispose(),o}case"ListDiff":return r.setdiff1dAsync(S("x",e,t,n),S("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wdt=(e,t,n,s=En)=>{switch(e.op){case"LowerBound":{const r=S("sortedSequence",e,t,n),i=S("values",e,t,n);return[s.lowerBound(r,i)]}case"TopKV2":{const r=S("x",e,t,n),i=S("k",e,t,n),o=S("sorted",e,t,n),a=s.topk(r,i,o);return[a.values,a.indices]}case"UpperBound":{const r=S("sortedSequence",e,t,n),i=S("values",e,t,n);return[s.upperBound(r,i)]}case"Unique":{const r=S("x",e,t,n),i=s.unique(r);return[i.values,i.indices]}case"UniqueV2":{const r=S("x",e,t,n),i=S("axis",e,t,n),o=s.unique(r,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sdt=(e,t,n,s=En)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const r=S("default",e,t,n);return[Sn(e.name,t,n)||r];case"Placeholder":return[Sn(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=S("x",e,t,n);return[Wi(u)]}case"IdentityN":return S("x",e,t,n).map(u=>Wi(u));case"Snapshot":const i=S("x",e,t,n);return[Wi(i)];case"Shape":return[s.tensor1d(S("x",e,t,n).shape,"int32")];case"ShapeN":return S("x",e,t,n).map(u=>s.tensor1d(u.shape));case"Size":return[s.scalar(S("x",e,t,n).size,"int32")];case"Rank":return[s.scalar(S("x",e,t,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const o=S("x",e,t,n),a=S("data",e,t,n),l=S("message",e,t,n),c=S("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kdt{get id(){return this.handle.id}constructor(t,n){this.keyDType=t,this.valueDType=n,this.handle=yt(0),this.tensorMap=new Map,Je(this.handle)}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return yt(this.size(),"int32")}async import(t,n){this.checkKeyAndValueTensor(t,n);const s=await t.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),G(()=>{const r=rr(n),i=s.length,o=r.length;T(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const l=s[a],c=r[a];Je(c),this.tensorMap.set(l,c)}return this.handle})}async find(t,n){this.checkKeyAndValueTensor(t,n);const s=await t.data();return G(()=>{const r=[];for(let i=0;i<s.length;i++){const o=s[i],a=this.findWithDefault(o,n);r.push(a)}return Qn(r)})}findWithDefault(t,n){const s=this.tensorMap.get(t);return s??n}checkKeyAndValueTensor(t,n){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cdt=async(e,t,n,s)=>{switch(e.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(e.name);if(r!=null)return[r];{const i=S("keyDType",e,t,n),o=S("valueDType",e,t,n),a=new kdt(i,o);return s.addHashTable(e.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=S("tableHandle",e,t,n,s),i=S("keys",e,t,n),o=S("values",e,t,n);return[await s.getHashTableById(r.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const r=S("tableHandle",e,t,n,s),i=S("keys",e,t,n),o=S("defaultValue",e,t,n);return[await s.getHashTableById(r.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=S("tableHandle",e,t,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Idt=(e,t,n,s=En)=>{switch(e.op){case"ResizeBilinear":{const r=S("images",e,t,n),i=S("size",e,t,n),o=S("alignCorners",e,t,n),a=S("halfPixelCenters",e,t,n);return[s.image.resizeBilinear(r,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const r=S("images",e,t,n),i=S("size",e,t,n),o=S("alignCorners",e,t,n),a=S("halfPixelCenters",e,t,n);return[s.image.resizeNearestNeighbor(r,[i[0],i[1]],o,a)]}case"CropAndResize":{const r=S("image",e,t,n),i=S("boxes",e,t,n),o=S("boxInd",e,t,n),a=S("cropSize",e,t,n),l=S("method",e,t,n),c=S("extrapolationValue",e,t,n);return[s.image.cropAndResize(r,i,o,a,l,c)]}case"ImageProjectiveTransformV3":{const r=S("images",e,t,n),i=S("transforms",e,t,n),o=S("outputShape",e,t,n),a=S("fillValue",e,t,n),l=S("interpolation",e,t,n),c=S("fillMode",e,t,n);return[s.image.transform(r,i,l.toLowerCase(),c.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tdt=(e,t,n,s=En)=>{switch(e.op){case"Equal":return[s.equal(S("a",e,t,n),S("b",e,t,n))];case"NotEqual":return[s.notEqual(S("a",e,t,n),S("b",e,t,n))];case"Greater":return[s.greater(S("a",e,t,n),S("b",e,t,n))];case"GreaterEqual":return[s.greaterEqual(S("a",e,t,n),S("b",e,t,n))];case"Less":return[s.less(S("a",e,t,n),S("b",e,t,n))];case"LessEqual":return[s.lessEqual(S("a",e,t,n),S("b",e,t,n))];case"LogicalAnd":return[s.logicalAnd(S("a",e,t,n),S("b",e,t,n))];case"LogicalNot":return[s.logicalNot(S("a",e,t,n))];case"LogicalOr":return[s.logicalOr(S("a",e,t,n),S("b",e,t,n))];case"Select":case"SelectV2":return[s.where(S("condition",e,t,n),S("a",e,t,n),S("b",e,t,n))];case"BitwiseAnd":return[s.bitwiseAnd(S("a",e,t,n),S("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ndt=(e,t,n,s=En)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(S("a",e,t,n),S("b",e,t,n),S("transposeA",e,t,n),S("transposeB",e,t,n))];case"Einsum":return[s.einsum(S("equation",e,t,n),...S("tensors",e,t,n))];case"Transpose":return[s.transpose(S("x",e,t,n),S("perm",e,t,n))];case"_FusedMatMul":const[r,i]=S("fusedOps",e,t,n),o=r==="biasadd",a=i==="prelu",l=S("numArgs",e,t,n),c=S("leakyreluAlpha",e,t,n);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,h]=S("args",e,t,n);return[s.fused.matMul({a:S("a",e,t,n),b:S("b",e,t,n),transposeA:S("transposeA",e,t,n),transposeB:S("transposeB",e,t,n),bias:u,activation:i,preluActivationWeights:h,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(S("a",e,t,n),S("numLower",e,t,n),S("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _dt=(e,t,n,s=En)=>{switch(e.op){case"EuclideanNorm":return[s.euclideanNorm(S("x",e,t,n),S("axis",e,t,n),S("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(S("x",e,t,n),S("mean",e,t,n),S("variance",e,t,n),S("offset",e,t,n),S("scale",e,t,n),S("epsilon",e,t,n))];case"FusedBatchNormV3":return[s.batchNorm(S("x",e,t,n),S("mean",e,t,n),S("variance",e,t,n),S("offset",e,t,n),S("scale",e,t,n),S("epsilon",e,t,n))];case"LRN":return[s.localResponseNormalization(S("x",e,t,n),S("radius",e,t,n),S("bias",e,t,n),S("alpha",e,t,n),S("beta",e,t,n))];case"Softmax":return[s.softmax(S("x",e,t,n))];case"LogSoftmax":return[s.logSoftmax(S("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $dt=(e,t,n,s=En)=>{switch(e.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:i}=s.raggedGather(S("paramsNestedSplits",e,t,n),S("paramsDenseValues",e,t,n),S("indices",e,t,n),S("outputRaggedRank",e,t,n));return r.concat(i)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:i}=s.raggedRange(S("starts",e,t,n),S("limits",e,t,n),S("splits",e,t,n));return[r,i]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(S("shape",e,t,n),S("values",e,t,n),S("defaultValue",e,t,n),S("rowPartitionTensors",e,t,n),S("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Edt=(e,t,n,s=En)=>{switch(e.op){case"Max":{const a=S("axis",e,t,n),l=S("keepDims",e,t,n);return[s.max(S("x",e,t,n),a,l)]}case"Mean":{const a=S("axis",e,t,n),l=S("keepDims",e,t,n);return[s.mean(S("x",e,t,n),a,l)]}case"Min":{const a=S("axis",e,t,n),l=S("keepDims",e,t,n);return[s.min(S("x",e,t,n),a,l)]}case"Sum":{const a=S("axis",e,t,n),l=S("keepDims",e,t,n);return[s.sum(S("x",e,t,n),a,l)]}case"All":{const a=S("axis",e,t,n),l=S("keepDims",e,t,n);return[s.all(S("x",e,t,n),a,l)]}case"Any":{const a=S("axis",e,t,n),l=S("keepDims",e,t,n);return[s.any(S("x",e,t,n),a,l)]}case"ArgMax":{const a=S("axis",e,t,n);return[s.argMax(S("x",e,t,n),a)]}case"ArgMin":{const a=S("axis",e,t,n);return[s.argMin(S("x",e,t,n),a)]}case"Prod":{const a=S("axis",e,t,n),l=S("keepDims",e,t,n);return[s.prod(S("x",e,t,n),a,l)]}case"Cumprod":{const a=S("axis",e,t,n),l=S("exclusive",e,t,n),c=S("reverse",e,t,n);return[s.cumprod(S("x",e,t,n),a,l,c)]}case"Cumsum":{const a=S("axis",e,t,n),l=S("exclusive",e,t,n),c=S("reverse",e,t,n);return[s.cumsum(S("x",e,t,n),a,l,c)]}case"Bincount":const r=S("x",e,t,n),i=S("weights",e,t,n),o=S("size",e,t,n);return[s.bincount(r,i,o)];case"DenseBincount":{const a=S("x",e,t,n),l=S("weights",e,t,n),c=S("size",e,t,n),u=S("binaryOutput",e,t,n);return[s.denseBincount(a,l,c,u)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Adt=(e,t,n,s=En)=>{switch(e.op){case"ConcatV2":case"Concat":{const r=S("n",e,t,n),i=S("axis",e,t,n);let o=S("tensors",e,t,n);return o=o.slice(0,r),[s.concat(o,i)]}case"Gather":{const r=S("x",e,t,n),i=S("indices",e,t,n);return[s.gather(r,s.cast(i,"int32"),0)]}case"GatherV2":{const r=S("axis",e,t,n),i=S("batchDims",e,t,n),o=S("x",e,t,n),a=S("indices",e,t,n);return[s.gather(o,s.cast(a,"int32"),r,i)]}case"Reverse":{const r=S("dims",e,t,n),i=[];for(let a=0;a<r.length;a++)r[a]&&i.push(a);const o=S("x",e,t,n);return[s.reverse(o,i)]}case"ReverseV2":{const r=S("axis",e,t,n),i=S("x",e,t,n);return[s.reverse(i,r)]}case"Slice":{const r=S("begin",e,t,n),i=S("size",e,t,n);return[s.slice(S("x",e,t,n),r,i)]}case"StridedSlice":{const r=S("begin",e,t,n),i=S("end",e,t,n),o=S("strides",e,t,n),a=S("beginMask",e,t,n),l=S("endMask",e,t,n),c=S("ellipsisMask",e,t,n),u=S("newAxisMask",e,t,n),h=S("shrinkAxisMask",e,t,n),d=S("x",e,t,n);return[s.stridedSlice(d,r,i,o,a,l,c,u,h)]}case"Pack":return G(()=>{const r=S("axis",e,t,n),i=S("tensors",e,t,n),o=i[0].shape,a=s.squeeze(i[0]).shape,l=i.map(c=>{const u=Pt(c.shape,o);if(!u&&!Pt(s.squeeze(c).shape,a))throw new Error("the input tensors shape does not match");return u?c:s.reshape(c,o)});return[s.stack(l,r)]});case"Unpack":{const r=S("axis",e,t,n),i=S("tensor",e,t,n);return s.unstack(i,r)}case"Tile":{const r=S("reps",e,t,n);return[s.tile(S("x",e,t,n),r)]}case"Split":case"SplitV":{const r=S("axis",e,t,n),i=S("numOrSizeSplits",e,t,n),o=S("x",e,t,n);return s.split(o,i,r)}case"ScatterNd":{const r=S("indices",e,t,n),i=S("values",e,t,n),o=S("shape",e,t,n);return[s.scatterND(r,i,o)]}case"GatherNd":{const r=S("x",e,t,n),i=S("indices",e,t,n);return[s.gatherND(r,i)]}case"SparseToDense":{const r=S("sparseIndices",e,t,n),i=S("outputShape",e,t,n),o=S("sparseValues",e,t,n),a=S("defaultValue",e,t,n);return[s.sparseToDense(r,o,i,o.dtype===a.dtype?a:s.cast(a,o.dtype))]}case"TensorScatterUpdate":{const r=S("indices",e,t,n),i=S("values",e,t,n),o=S("tensor",e,t,n);return[s.tensorScatterUpdate(o,r,i)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rdt=(e,t,n,s=En)=>{switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows(S("indices",e,t,n),S("values",e,t,n),S("denseShape",e,t,n),S("defaultValue",e,t,n));return[r,i,o,a]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=s.sparse.sparseReshape(S("inputIndices",e,t,n),S("inputShape",e,t,n),S("newShape",e,t,n));return[r,i]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(S("data",e,t,n),S("indices",e,t,n),S("segmentIds",e,t,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(S("data",e,t,n),S("indices",e,t,n),S("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ddt=(e,t,n,s=En)=>{switch(e.op){case"FFT":return[s.fft(S("x",e,t,n))];case"IFFT":return[s.ifft(S("x",e,t,n))];case"RFFT":return[s.rfft(S("x",e,t,n))];case"IRFFT":return[s.irfft(S("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Odt=(e,t,n,s=En)=>{switch(e.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(S("input",e,t,n),S("pattern",e,t,n),S("rewrite",e,t,n),S("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=s.string.stringNGrams(S("data",e,t,n),S("dataSplits",e,t,n),S("separator",e,t,n),S("nGramWidths",e,t,n),S("leftPad",e,t,n),S("rightPad",e,t,n),S("padWidth",e,t,n),S("preserveShortSequences",e,t,n));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:o}=s.string.stringSplit(S("input",e,t,n),S("delimiter",e,t,n),S("skipEmpty",e,t,n));return[r,i,o]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(S("input",e,t,n),S("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pdt=(e,t,n,s=En)=>{switch(e.op){case"Cast":return[s.cast(S("x",e,t,n),S("dtype",e,t,n))];case"ExpandDims":{const r=S("axis",e,t,n);return[s.expandDims(S("x",e,t,n),r)]}case"Squeeze":{const r=S("axis",e,t,n);return[s.squeeze(S("x",e,t,n),r)]}case"Reshape":return[s.reshape(S("x",e,t,n),S("shape",e,t,n))];case"EnsureShape":return[s.ensureShape(S("x",e,t,n),S("shape",e,t,n))];case"MirrorPad":return[s.mirrorPad(S("x",e,t,n),S("padding",e,t,n),S("mode",e,t,n))];case"PadV2":case"Pad":return[s.pad(S("x",e,t,n),S("padding",e,t,n),S("constantValue",e,t,n))];case"SpaceToBatchND":{const r=S("blockShape",e,t,n),i=S("paddings",e,t,n);return[s.spaceToBatchND(S("x",e,t,n),r,i)]}case"BatchToSpaceND":{const r=S("blockShape",e,t,n),i=S("crops",e,t,n);return[s.batchToSpaceND(S("x",e,t,n),r,i)]}case"DepthToSpace":{const r=S("blockSize",e,t,n),i=S("dataFormat",e,t,n).toUpperCase();return[s.depthToSpace(S("x",e,t,n),r,i)]}case"BroadcastTo":return[s.broadcastTo(S("x",e,t,n),S("shape",e,t,n))];case"BroadcastArgs":return[s.broadcastArgs(S("s0",e,t,n),S("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QD(e,t,n,s,r=G){const i=((o,a,l)=>{switch(o.category){case"arithmetic":return r(()=>udt(o,a,l));case"basic_math":return r(()=>hdt(o,a,l));case"control":return xdt(o,a,l);case"convolution":return r(()=>ydt(o,a,l));case"creation":return r(()=>bdt(o,a,l));case"dynamic":return vdt(o,a,l);case"evaluation":return r(()=>wdt(o,a,l));case"image":return r(()=>Idt(o,a,l));case"graph":return r(()=>Sdt(o,a,l));case"logical":return r(()=>Tdt(o,a,l));case"matrices":return r(()=>Ndt(o,a,l));case"normalization":return r(()=>_dt(o,a,l));case"ragged":return r(()=>$dt(o,a,l));case"reduction":return r(()=>Edt(o,a,l));case"slice_join":return r(()=>Adt(o,a,l));case"sparse":return r(()=>Rdt(o,a,l));case"spectral":return r(()=>Ddt(o,a,l));case"string":return r(()=>Odt(o,a,l));case"transformation":return r(()=>Pdt(o,a,l));case"hash_table":return Cdt(o,a,l,s);case"custom":const c=S5(o.op);if(c&&c.customExecutor)return c.customExecutor(new cdt(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return fo(i)?i.then(o=>[].concat(o)):[].concat(i)}class JD{constructor(t={},n={},s={},r={},i){this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,n){return{id:t,frameName:n,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(s))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(t);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tO(e,t,n,s){const r=new Set,i=[];let o=null,a=null;const l=new Set,c=new Set(Object.keys(e).map(d=>ks(d)[0]));s=s||[];const u=new Set(s.map(d=>ks(d.name)[0])),h=[...t];for(;h.length>0;){const d=h.pop();if((xl(d)||Udt(d)||jdt(d))&&o==null&&(o=d,a=o.children.map(f=>f.name).filter(f=>r.has(f))),r.add(d.name),n[d.name]==null&&!c.has(d.name)&&!u.has(d.name)){if(d.inputs.length===0){i.push(d.name);continue}d.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),h.push(f))})}}return{inputs:e,outputs:t,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:a}}function Fdt(e,t){const{usedNodes:n,inputs:s}=t,r=Object.keys(s).map(m=>ks(m)[0]).map(m=>e.nodes[m]),i=e.initNodes||[],o=m=>n.has(typeof m=="string"?m:m.name);function a(m){return[...new Map(m.map(x=>[x.name,x])).values()]}const l=a([...r,...e.weights,...i]).filter(o),c=a([...l,...Object.values(e.nodes)]).filter(o),u=new Map(c.map(m=>[m.name,m])),h={};for(const m of c){h[m.name]=h[m.name]||0;for(const x of m.children)o(x)||(h[x.name]=Number.POSITIVE_INFINITY),h[x.name]=(h[x.name]||0)+1}const d=Object.entries(h).filter(([,m])=>m===0).map(([m])=>m),f=[...d];for(;d.length>0;){const m=d.pop(),x=u.get(m);for(const y of x.children.filter(o))--h[y.name]===0&&(f.push(y.name),d.push(y.name))}const p=f.map(m=>u.get(m)),g=Ldt(p,l);return Mdt(g,l),g}function Ldt(e,t){const n=new Map(e.map(o=>[o.name,o])),s=t.map(o=>o.name),r=new Set(s);for(;s.length>0;){const o=s.pop(),a=n.get(o);for(const l of a.children)!n.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return e.filter(o=>r.has(o.name))}class b0 extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}function Mdt(e,t){const n=new Map(e.map((a,l)=>[a.name,l])),s=new Set(t.map(a=>a.name)),r=a=>s.has(typeof a=="string"?a:a.name),i=new Set(e.map(a=>a.name)),o=a=>i.has(typeof a=="string"?a:a.name);for(const a of e){for(const l of a.children.filter(o)){if(!n.has(l.name))throw new b0(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new b0(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!r(a))for(const l of a.inputs){if(!n.has(l.name))throw new b0(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new b0(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function zdt(e){const t=new Map(e.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,s=e.map((a,l)=>xl(a)?n:l),r=a=>{const l=s[t.get(a.name)];return l??-1},i=e.map((a,l)=>a.children.map(r).reduce((c,u)=>Math.max(c,u),s[l])),o=new Map;for(let a=0;a<e.length;++a){const l=i[a];if(l===n)continue;const c=e[a],u=e[l];o.has(u.name)||o.set(u.name,[]),o.get(u.name).push(c)}return o}const Bdt=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Vdt=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),Wdt=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function xl(e){return Bdt.has(e.op)}function Udt(e){return Vdt.has(e.op)}function jdt(e){return Wdt.has(e.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class My{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const n=Object.keys(t).map(s=>t[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(s=>{this._functionExecutorMap[s]=new My(t.functions[s],this)})}getCompilationKey(t,n){const s=t.map(i=>i.name).sort(),r=n.map(i=>i.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(t,n){const s=tO(t,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:o}=s;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const c=n.map(h=>h.name),u=Object.keys(t);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${u}]. Missing the following inputs: [${r}]`)}const a=Fdt(this.graph,s),l=zdt(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(t){if(t==null)return null;const n=t.clone();return Je(n),n}cloneTensorList(t){return t?t.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(t,n){this.disposeIntermediateTensors(),t=this.mapInputs(t);const s=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(d=>this.graph.nodes[ks(d)[0]]),i=n.map(d=>ks(d)[0]),o=new Set(i);let a=i.map(d=>this.graph.nodes[d]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(r,a);let c=this.compiledMap.get(l);c==null&&(c=this.compile(t,a),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=H().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const u={},h={};return G(()=>{const d=new JD(this.weightMap,u,h,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(x=>{const[y,b]=ks(x,d),v=[];v[b]=t[x],f[y]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[y]=this.cloneTensorList(v))});const p=this.getFrozenTensorIds(f),{orderedNodes:g,nodeLiveUntilMap:m}=c;for(const x of g){if(f[x.name])continue;const y=QD(x,f,d,this._resourceManager);if(fo(y))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);f[x.name]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[x.name]=this.cloneTensorList(y)),this.checkTensorForDisposalWithNodeLiveUntilInfo(x,f,d,p,o,m.get(x.name))}return this.parent==null&&d.dispose(p),n.map(x=>Sn(x,f,d))})}getFrozenTensorIds(t){const n=[].concat.apply([],Object.keys(t).map(s=>t[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(t,n,s,r,i,o,a){if(!(xl(n)||o.has(t))){for(const l of s[t])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(xl(l))continue;const c=KD(l.name,s,r);if(c!=null)for(const u of c){if(!u||u.kept||i.has(u.id))continue;const h=a[u.id];h===1?(u.dispose(),delete a[u.id]):h!=null&&a[u.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,n,s,r,i,o){function a(l){return xl(l)||i.has(l.name)}if(!(xl(t)||o==null))for(const l of o){if(a(l))continue;const c=KD(l.name,n,s);for(const u of c)!u||u.kept||r.has(u.id)||u.dispose()}}async executeAsync(t,n){return this._executeAsync(t,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(const n of t)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,n,s=!1,r={},i={}){this.disposeIntermediateTensors(),s||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=H().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const o=new JD(this.weightMap,r,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(t,o,n,s),l=n.map(d=>Sn(d,a,o)),c=l.map(d=>d.id),u=Object.keys(t).map(d=>t[d].id),h=new Set([...c,...u,...this.weightIds]);return Object.values(a).forEach(d=>{d.forEach(f=>{f&&!f.isDisposed&&!h.has(f.id)&&f.dispose()})}),this.parent==null&&o.dispose(h),l}async executeFunctionAsync(t,n,s){const r=t.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(t,n,s,r){const i=Object.keys(t),o=i.map(v=>this.graph.nodes[ks(v)[0]]),a=s.map(v=>ks(v)[0]),l=new Set(a);let c=a.map(v=>this.graph.nodes[v]);c.length===0&&(c=this._outputs);const{usedNodes:u,missingInputs:h,dynamicNode:d,syncInputs:f}=tO(t,c,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map(v=>({node:v,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(t).forEach(v=>{const[w,k]=ks(v),I=[];I[k]=t[v],g[w]=I});const m={},x=this.getFrozenTensorIds(g),y={};for(;p.length>0;){const v=this.processStack(o,p,n,g,y,x,l,m,u);await Promise.all(v)}d==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=c.filter(v=>!xl(v)&&!Sn(v.name,g,n)).map(v=>v.name);if(b.length>0){let v="";throw d!=null&&(v=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${i}]. Consider providing the following inputs: [${h}]. ${v}`)}return g}processStack(t,n,s,r,i,o,a,l,c){const u=[];for(;n.length>0;){const h=n.pop();s.currentContext=h.contexts;let d="";if(h.node.op==="Enter"&&S("isConstant",h.node,r,s)&&([d]=Vi(h.node.name,s)),r[h.node.name]==null){const f=QD(h.node,r,s,this._resourceManager);d||([d]=Vi(h.node.name,s));const p=s.currentContext;fo(f)?u.push(f.then(g=>(r[d]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(g)),s.currentContext=p,this.checkTensorForDisposal(d,h.node,r,s,o,a,l),this.processChildNodes(h.node,n,s,r,i,c),g))):(r[d]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(f)),this.checkTensorForDisposal(d,h.node,r,s,o,a,l),this.processChildNodes(h.node,n,s,r,i,c))}else this.processChildNodes(h.node,n,s,r,i,c)}return u}processChildNodes(t,n,s,r,i,o){t.children.forEach(a=>{const[l]=Vi(a.name,s);i[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(c=>!!Sn(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})):a.inputNames.every(c=>!!Sn(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{const s=t[n],[r]=ks(n),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===s.shape.length&&s.shape.every((l,c)=>o[c]===-1||o[c]===l);T(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&T(s.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(t){var n,s;const r={};for(const i in t){const o=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[i];o!=null?r[o.name]=t[i]:r[i]=t[i]}return r}checkInputs(t){const n=Object.keys(t).filter(s=>{const[r]=ks(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>{var s,r;const i=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return i!=null?i.name:n},{})}checkOutputs(t){t.forEach(n=>{const[s]=ks(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class Gdt{constructor(t={},n={}){this.hashTableNameToHandle=t,this.hashTableMap=n}addHashTable(t,n){this.hashTableNameToHandle[t]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hdt="?tfjs-format=file",Kdt="model.json";class l${get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t,n={},s=oN){this.modelUrl=t,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new Gdt}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const n=this.io.getLoadHandlers(t,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[t]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return fo(t)?t.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(t)}loadSync(t){const n=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,n)}async loadStreaming(t){if(t.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await Q4(t.getWeightStream(),t.weightSpecs);return this.loadWithWeightMap(t,n)}loadWithWeightMap(t,n){this.artifacts=t;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(r=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new My(qD.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const i=qD.Instance.transformGraph(t.modelInitializer);this.initializer=new My(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}async save(t,n){if(typeof t=="string"){const s=this.io.getSaveHandlers(t);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${t}'`);t=s[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}addStructuredOutputNames(t){if(this.structuredOutputKeys){const n=t instanceof Ut?[t]:t,s={};return n.forEach((r,i)=>s[this.structuredOutputKeys[i]]=r),s}return t}predict(t,n){const s=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(t,n){const s=await this.executeAsync(t,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(t){var n;if(!(t instanceof Ut)&&!Array.isArray(t)){const i=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(i!=null)for(const o in i){const a=i[o];a.resourceId!=null&&(t[o]=this.resourceIdToCapturedInput[a.resourceId])}return t}t=Array.isArray(t)?t:[t];const s=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${t.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((i,o)=>{var a,l,c;const u=(c=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[o])===null||c===void 0?void 0:c.resourceId;return u!=null?i[o]=this.resourceIdToCapturedInput[u]:i[o]=t[r++],i},{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const i=s[r],o=n[i];this.resourceIdToCapturedInput[o.resourceId]=t[r]}}}execute(t,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const s=this.executor.execute(t,n);return s.length>1?s:s[0]}async executeAsync(t,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(t,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((n,s)=>(n[s]=[t[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Ct(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function qdt(e,t={},n=oN){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=Ydt(e));const s=new l$(e,t,n);return await s.load(),s}function Xdt(e){if(e==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){const[s,r]=e;if(!s)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const i=Iy(s.weightsManifest),o=zI(s,i,r);t=Ny(o)}else if("load"in e)t=e;else if("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e)t=Ny(e);else throw new Error("Unknown model format");const n=new l$(t);return n.load(),n}function Ydt(e){return e.endsWith("/")||(e=e+"/"),`${e}${Kdt}${Hdt}`}/** @license See the LICENSE file. */const I5="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function Zdt(e,t){return zy(e,t)}function zy(e,t,n=new Map,s=new Set){if(e==null)return null;if(typeof Blob=="function"&&e instanceof Blob)return e.slice();if(s.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const r=t(e);if(r.recurse&&r.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse)if(Yu(e)){const i=Array.isArray(e)?[]:{};s.add(e);for(const o in e){const a=e[o],l=zy(a,t,n,s);i[o]=l}return s.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}else throw new Error(`Can't recurse into non-iterable type: ${e}`);else return n.set(e,r.value),r.value}function Qdt(e,t=N5){return T5(e,t)}function T5(e,t,n=new Set){const s=e[0];if(n.has(s))throw new Error("Circular references are not supported.");const r=t(e);if(r.recurse&&r.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse)if(Yu(s)){const i=Array.isArray(s)?[]:{};n.add(s);for(const o in s){const a=e.map(c=>c[o]),l=T5(a,t,n);i[o]=l}return n.delete(s),i}else throw new Error(`Can't recurse into non-iterable type: ${s}`);else return r.value}function N5(e){return e===null?null:Yu(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function _5(e,t){const n=new Map;zy(e,t,n);for(const r of Array.from(n.keys())){const i=n.get(r);if(fo(i)){const o=await i;n.set(r,o)}}return zy(e,t,n)}function Yu(e){let t=!1;if(H().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:n}=require("string_decoder");t=e instanceof n}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Ut)&&!(e instanceof Promise)&&!t)}function Jdt(e){return e==null||tft(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Ut||Ze(e)}function tft(e){return e===null||typeof e!="object"&&typeof e!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function eft(e){return Zdt(e,nft)}function nft(e){return e instanceof Ut?{value:e.clone(),recurse:!1}:Yu(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class $5{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const n of t)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+t),s=this.get(n);return this.set(n,this.pop()),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class rw extends $5{constructor(){super(rw.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=this.capacity*2,n=new Array(t),s=this.length();for(let r=0;r<s;r++)n[r]=this.get(this.wrap(this.begin+r));this.data=n,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=s}}rw.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function E5(e){return new ift(e)}function c$(e){return new oft(e)}function sft(e,t){return new A5(e,t)}function rft(e,t=Yo.FAIL){return new mft(e,t)}class mn{async toArray(){const t=[];let n=await this.next();for(;!n.done;)t.push(n.value),n=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),n=[];let s=await t.next();for(;!s.done;)n.push(s.value),s=await t.next();return n}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let n=await this.next(),s=t(n.value);for(;!n.done&&s;)n=await this.next(),s=t(n.value)}handleErrors(t){return new fft(this,t)}filter(t){return new hft(this,t)}map(t){return new dft(this,t)}mapAsync(t){return new eO(this,t)}serialMapAsync(t){return new eO(this,t).serial()}flatmap(t){return new pft(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(n=>n===!0)}rowMajorBatch(t,n=!0){return new uft(this,t,n)}columnMajorBatch(t,n=!0,s=N5){return this.rowMajorBatch(t,n).map(i=>Qdt(i,s))}concatenate(t,n){return new A5(E5([this,t]),n)}take(t){return t<0||t==null?this:new cft(this,t)}skip(t){return t<0||t==null?this:new lft(this,t)}prefetch(t){return new R5(this,t)}shuffle(t,n){return new gft(this,t,n)}serial(){return new aft(this)}}class ift extends mn{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:eft(t),done:!1}}}class oft extends mn{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}}}class aft extends mn{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class lft extends mn{constructor(t,n){super(),this.upstream=t,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;Ct(t.value)}return this.upstream.next()}}class cft extends mn{constructor(t,n){super(),this.upstream=t,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class uft extends mn{constructor(t,n,s=!0){super(),this.upstream=t,this.batchSize=n,this.enableSmallLastBatch=s,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const n=await this.upstream.next();if(n.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(n.value)}return{value:t,done:!1}}}class hft extends mn{constructor(t,n){super(),this.upstream=t,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;Ct(t.value)}}}class dft extends mn{constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const n=mo(t.value),s=this.transform(t.value),r=mo(s);for(const i of n)Yb(i,r)||i.dispose();return{value:s,done:!1}}}class fft extends mn{constructor(t,n){super(),this.upstream=t,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class eO extends mn{constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const n=mo(t.value),s=await this.transform(t.value),r=mo(s);for(const i of n)Yb(i,r)||i.dispose();return{value:s,done:!1}}}class u$ extends mn{constructor(){super(),this.outputQueue=new rw,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class pft extends u${constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const t=await this.upstream.next();if(t.done)return!1;const n=mo(t.value),s=this.transform(t.value),r=mo(s);this.outputQueue.pushAll(s);for(const i of n)Yb(i,r)||i.dispose();return!0}}class A5 extends mn{constructor(t,n){super(),this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,this.iterator==null){const s=await this.moreIterators.next();if(s.done)return{value:null,done:!0};this.iterator=s.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(t)):n}}var Yo;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(Yo||(Yo={}));class mft extends mn{constructor(t,n=Yo.FAIL){super(),this.iterators=t,this.mismatchMode=n,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(t){await t;let n=0,s=0;function r(o){return o instanceof mn?{value:o.next().then(l=>(n++,l.done&&s++,l.value)),recurse:!1}:{value:null,recurse:!0}}const i=await _5(this.iterators,r);if(n===s)return{value:null,done:!0};if(s>0)switch(this.mismatchMode){case Yo.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case Yo.SHORTEST:return{value:null,done:!0};case Yo.LONGEST:}return this.count++,{value:i,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class R5 extends mn{constructor(t,n){super(),this.upstream=t,this.bufferSize=n,this.buffer=new $5(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class gft extends R5{constructor(t,n,s){super(t,n),this.upstream=t,this.windowSize=n,this.upstreamExhausted=!1,this.random=ud.alea(s||vn().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),n=await this.buffer.shuffleExcise(t);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class xd{constructor(){this.size=null}batch(t,n=!0){const s=this;T(t>0,()=>`batchSize needs to be positive, but it is
      ${t}`);let r;return this.size===1/0||this.size==null?r=this.size:n?r=Math.ceil(this.size/t):r=Math.floor(this.size/t),Ss(async()=>(await s.iterator()).columnMajorBatch(t,n,bft),r)}concatenate(t){const n=this;let s;return this.size===1/0||t.size===1/0?s=1/0:this.size!=null&&t.size!=null?s=this.size+t.size:s=null,Ss(async()=>(await n.iterator()).concatenate(await t.iterator()),s)}filter(t){const n=this;let s;return this.size===1/0?s=1/0:s=null,Ss(async()=>(await n.iterator()).filter(r=>G(()=>t(r))),s)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const n=this;return Ss(async()=>(await n.iterator()).map(s=>G(()=>t(s))),this.size)}mapAsync(t){const n=this;return Ss(async()=>(await n.iterator()).mapAsync(t),this.size)}prefetch(t){if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return Ss(async()=>(await n.iterator()).prefetch(t),this.size)}repeat(t){const n=this;let s;return this.size!=null&&t>0?s=this.size*t:t===0?s=0:this.size!=null&&(t===void 0||t<0)?s=1/0:s=null,Ss(async()=>{const r=c$(async()=>({value:await n.iterator(),done:!1}));return sft(r.take(t))},s)}skip(t){const n=this;let s;return this.size!=null&&t>=0&&this.size>=t?s=this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?s=0:s=null,Ss(async()=>(await n.iterator()).skip(t),s)}shuffle(t,n,s=!0){if(t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,i=ud.alea(n||vn().toString());return Ss(async()=>{let o=i.int32();return s&&(o+=i.int32()),(await r.iterator()).shuffle(t,o.toString())},this.size)}take(t){const n=this;let s;return this.size!=null&&this.size>t?s=t:this.size!=null&&this.size<=t?s=this.size:s=null,Ss(async()=>(await n.iterator()).take(t),s)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}xd.MAX_BUFFER_SIZE=1e4;function Ss(e,t=null){return new class extends xd{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function xft(e){return Ss(async()=>E5(e),e.length)}function yft(e){if(!Yu(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=t==null?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(const n in e)t=t==null?e[n].size:Math.min(t,e[n].size);return Ss(async()=>{const n=await _5(e,s=>{if(s instanceof xd)return{value:s.iterator(),recurse:!1};if(Yu(s))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return rft(n,Yo.SHORTEST)},t)}function bft(e){if(e===null)return null;const t=e[0];return Jdt(t)?{value:vft(e),recurse:!1}:{value:null,recurse:!0}}function vft(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Ut?Qn(e):Ds(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class D5 extends xd{constructor(t){super(),this.input=t}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(r=>(r.endsWith("\r")&&(r=r.slice(0,-1)),r))}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const v0='"',Wd=Symbol("out"),nO=Symbol("field"),w0=Symbol("quote"),x2=Symbol("quoteafterquote"),sO=Symbol("quoteinquote");class O5 extends xd{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const t=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&T(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);const n=this.fullColumnNames.reduce((r,i)=>(r[i]=r[i]+1||1,r),{}),s=Object.keys(n).filter(r=>n[r]>1);if(T(s.length===0,()=>"Duplicate column names found: "+s.toString()),this.columnConfigs){for(const r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const n=await(await this.base.iterator()).next();if(n.done)throw new Error("No data was found for CSV parsing.");const s=n.value;return this.parseRow(s,!1)}else return null}constructor(t,n){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new D5(t),n||(n={}),this.hasHeader=n.hasHeader!==!1,this.fullColumnNames=n.columnNames,this.columnConfigs=n.columnConfigs,this.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(T(n.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=n.delimiter?n.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let t=await this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(n=>this.makeDataElement(n))}makeDataElement(t){const n=this.parseRow(t),s={},r={};for(let i=0;i<this.fullColumnNames.length;i++){const o=this.fullColumnNames[i],a=this.columnConfigs?this.columnConfigs[o]:null;if(!(this.configuredColumnsOnly&&!a)){const l=n[i];let c=null;if(l==="")if(a&&a.default!==void 0)c=a.default;else{if(a&&(a.required||a.isLabel))throw new Error(`Required column ${o} is empty in this line: ${t}`);c=void 0}else{const u=Number(l);if(isNaN(u))a&&a.dtype==="bool"?c=this.getBoolean(l):c=l;else if(!a||!a.dtype)c=u;else switch(a.dtype){case"float32":c=u;break;case"int32":c=Math.floor(u);break;case"bool":c=this.getBoolean(l);break;default:c=u}}a&&a.isLabel?r[o]=c:s[o]=c}}return Object.keys(r).length===0?s:{xs:s,ys:r}}getBoolean(t){return t==="1"||t.toLowerCase()==="true"?1:0}parseRow(t,n=!0){const s=[];let r=0;const i=t.length;let o=Wd;for(let a=0;a<i;a++)switch(o){case Wd:switch(t.charAt(a)){case v0:r=a+1,o=w0;break;case this.delimiter:if(r=a+1,this.delimiter===" "&&this.delimWhitespace)break;s.push(""),o=Wd;break;default:o=nO,r=a;break}break;case nO:switch(t.charAt(a)){case this.delimiter:s.push(t.substring(r,a)),o=Wd,r=a+1;break}break;case w0:switch(t.charAt(a)){case v0:o=x2;break}break;case x2:switch(t.charAt(a)){case this.delimiter:s.push(t.substring(r,a-1)),o=Wd,r=a+1;break;case v0:o=w0;break;default:o=sO;break}break;case sO:switch(t.charAt(a)){case v0:o=w0;break}break}if(o===x2?s.push(t.substring(r,i-1)):s.push(t.substring(r)),n&&s.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${s}`);return s}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class h$ extends mn{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=t.includeSpectrogram!==!1,this.includeWaveform=t.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(!H().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const n=new h$(t);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(s){throw new Error(`Error thrown while initializing video stream: ${s.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,n;const s=await this.getAudioData();if(this.includeSpectrogram){const r=this.flattenQueue(s.freqDataQueue);t=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const r=this.flattenQueue(s.timeDataQueue);n=this.getTensorFromAudioDataArray(r,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:n},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const t=[],n=[];let s=0;return new Promise(r=>{const i=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:t,timeDataQueue:n}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++s===this.numFrames&&(clearInterval(i),r({freqDataQueue:t,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const n=t[0].length,s=new Float32Array(t.length*n);return t.forEach((r,i)=>s.set(r,i*n)),s}getTensorFromAudioDataArray(t,n){const s=new Float32Array(X(n));return s.set(t,s.length-t.length),Ds(s,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class d$ extends mn{constructor(t,n){if(super(),this.webcamVideoElement=t,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=cn([0],"int32"),this.webcamConfig.centerCrop){const s=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,i=(1-s)/2,o=(1-r)/2,a=i+s,l=r+o;this.cropBox=ro([o,i,l,a],[1,4])}else this.cropBox=ro([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,n={}){if(!H().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}const s=new d$(t,n);return await s.start(),s}async start(){this.webcamConfig.facingMode&&T(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=CB(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{t.dispose()}else return{value:t,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(t){return G(()=>{const n=wn(ot(t,"float32"),0);let s;s=wr.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=s.shape;return V(s,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class P5{}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class F5 extends mn{split(t){return new wft(this,t)}}class wft extends F5{constructor(t,n){super(),this.upstream=t,this.impl=new Sft(t,n)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class Sft extends u${constructor(t,n){super(),this.upstream=t,this.separator=n,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const t=await this.upstream.next();if(t.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const n=t.value.split(this.separator);n[0]=this.carryover+n[0];for(const s of n.slice(0,-1))this.outputQueue.push(s);return this.carryover=n[n.length-1],!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class kft extends mn{decodeUTF8(){return new Cft(this)}}class Cft extends F5{constructor(t){super(),this.upstream=t,this.impl=new Ift(t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class Ift extends u${constructor(t){if(super(),this.upstream=t,H().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:n}=require("string_decoder");this.decoder=new n("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const t=await this.upstream.next();let n;if(t.done)return!1;n=t.value;let s;return H().get("IS_BROWSER")?s=this.decoder.decode(n,{stream:!0}):s=this.decoder.write(Buffer.from(n.buffer)),this.outputQueue.push(s),!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class L5 extends kft{constructor(t,n={}){super(),this.file=t,this.options=n,T(t instanceof Uint8Array||(H().get("IS_BROWSER")?t instanceof File||t instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=n.offset||0,this.chunkSize=n.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((n,s)=>{const r=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)n(new Uint8Array(this.file.slice(this.offset,r)));else{const i=new FileReader;i.onload=a=>{let l=i.result;if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),!(l instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));n(l)},i.onabort=a=>s(new Error("Aborted")),i.onerror=a=>s(new Error(a.type));const o=this.file.slice(this.offset,r);i.readAsArrayBuffer(o)}this.offset=r}),done:!1}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */async function Tft(e,t={},n){let s,r;typeof e=="string"?s=e:(s=e.url,r=Nft(e));const i=await W4(s,r);if(i.ok){const o=new Uint8Array(await i.arrayBuffer());return new L5(o,t)}else throw new Error(i.statusText)}const Nft=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function M5(e){return typeof e=="string"&&e.slice(0,7)==="file://"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class z5 extends P5{constructor(t,n={}){super(),this.input=t,this.options=n}async iterator(){if(M5(this.input)&&H().get("IS_NODE")){const t=require("fs");this.input=t.readFileSync(this.input.slice(7))}return new L5(this.input,this.options)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class B5 extends P5{constructor(t,n={}){super(),this.url=t,this.fileOptions=n}async iterator(){return M5(this.url)?new z5(this.url,this.fileOptions).iterator():Tft(this.url,this.fileOptions)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function _ft(e,t={}){return new O5(new B5(e),t)}function $ft(e){const t=c$(e);return Ss(async()=>t)}function Eft(e){return Ss(async()=>{const t=await e();return c$(()=>t.next())})}async function Aft(e,t){return d$.create(e,t)}async function Rft(e){return h$.create(e)}/** @license See the LICENSE file. */const V5="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dft=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:O5,Dataset:xd,FileDataSource:z5,TextLineDataset:D5,URLDataSource:B5,array:xft,csv:_ft,func:$ft,generator:Eft,microphone:Rft,version_data:V5,webcam:Aft,zip:yft},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mt(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oft=kv;class Rg extends B1{nextDataId(){return Rg.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new kI(this,Pr())}write(t,n,s){this.firstUse&&(this.firstUse=!1,H().get("IS_NODE")&&Gs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:s,refCount:1}),r}makeTensorInfo(t,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&di(s[0])){const i=s.map(o=>xi(o));r=this.write(i,t,n)}else r=this.write(s,t,n);return{dataId:r,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,s,r,i){this.data.set(t,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:s}=this.data.get(t);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return yo(r,i)}return T4(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const s=n.map(r=>po(r));return Et(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Et(t.shape,t.dtype,n)}makeOutput(t,n,s){return Pr().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(t);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=vn();return t(),{kernelMs:vn()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){mt([t],"where");const n=this.readSync(t.dataId);return Oft(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Rg.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const Pft=e=>{const{x:t}=e.inputs,n=e.backend;mt(t,"abs");let s=new Float32Array(X(t.shape));const r=n.data.get(t.dataId).values;return s=W5(r),n.makeOutput(s,t.shape,t.dtype)},Fft={kernelName:Zp,backendName:"cpu",kernelFunc:Pft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function We(e){return(t,n,s,r,i)=>{const o=It(t,n),a=o.length,l=bt(o),c=X(o),u=fn(i,c),h=t.length,d=n.length,f=bt(t),p=bt(n),g=sc(t,o),m=sc(n,o);if(g.length+m.length===0)for(let x=0;x<u.length;++x)u[x]=e(s[x%s.length],r[x%r.length]);else for(let x=0;x<u.length;++x){const y=Nc(x,a,l),b=y.slice(-h);g.forEach(I=>b[I]=0);const v=Ur(b,h,f),w=y.slice(-d);m.forEach(I=>w[I]=0);const k=Ur(w,d,p);u[x]=e(s[v],r[k])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ts(e){const{inputs:t,backend:n}=e,{real:s,imag:r}=t,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const Lft={kernelName:X1,backendName:"cpu",kernelFunc:Ts};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function By(e,t,n="float32"){if(n==="complex64"){const r=By(e,t,"float32"),i=By(e,t,"float32");return Ts({inputs:{real:r,imag:i},backend:e})}const s=Tn(X(t),n);return e.makeTensorInfo(t,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _i(e){const{inputs:t,backend:n}=e,{x:s}=t;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Mft={kernelName:$h,backendName:"cpu",kernelFunc:_i};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uc(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const zft={kernelName:_b,backendName:"cpu",kernelFunc:uc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U5(e,t,n,s){if(s==="int32"){const r=Int32Array.from(e);return[t,"int32",r]}if(s==="bool"){const r=Ba([0],n),[i,o]=We((a,l)=>a!==l?1:0)(t,[],e,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Aa(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return _i({inputs:{x:r},backend:n});const u=By(n,r.shape,r.dtype),h=Aa({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),d=Ts({inputs:{real:h,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),d}if(r.dtype==="complex64"){const u=uc({inputs:{input:r},backend:n}),h=Aa({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),h}if(!TI(r.dtype,i)){const u=_i({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=U5(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const Bft={kernelName:gh,backendName:"cpu",kernelFunc:Aa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sn(e,t,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;mt([o,a],e);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,h=o.dtype==="string"?bo(c):c,d=o.dtype==="string"?bo(u):u,f=s||o.dtype,[p,g]=t(o.shape,a.shape,h,d,f);return l.makeTensorInfo(g,f,p)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=Aa({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,f=l.data.get(h.dataId).values,p=l.data.get(d.dataId).values,g=Aa({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),m=l.data.get(g.dataId),x=m.complexTensorInfos.real,y=m.complexTensorInfos.imag,b=l.data.get(x.dataId).values,v=l.data.get(y.dataId).values,[w,k,I]=n(o.shape,a.shape,f,p,b,v),C=l.makeTensorInfo(I,"float32",w),N=l.makeTensorInfo(I,"float32",k),$=Ts({inputs:{real:C,imag:N},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(C),l.disposeIntermediateTensorInfo(N),$}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,h=s||o.dtype,[d,f]=t(o.shape,a.shape,c,u,h);return l.makeTensorInfo(f,h,d)}}}function f$(e){return(t,n,s,r,i,o)=>{const a=It(t,n),l=X(a),c=a.length,u=bt(a),h=fn("float32",l),d=fn("float32",l),f=sc(t,a),p=sc(n,a),g=yo(s,r),m=yo(i,o),x=t.length,y=bt(t),b=n.length,v=bt(n);if(f.length+p.length===0)for(let w=0;w<h.length;w++){const k=w%g.length,I=w%m.length,C=e(g[k*2],g[k*2+1],m[I*2],m[I*2+1]);h[w]=C.real,d[w]=C.imag}else for(let w=0;w<h.length;w++){const k=Nc(w,c,u),I=k.slice(-x);f.forEach(R=>I[R]=0);const C=Ur(I,x,y),N=k.slice(-b);p.forEach(R=>N[R]=0);const $=Ur(N,b,v),A=e(g[C*2],g[C*2+1],m[$*2],m[$*2+1]);h[w]=A.real,d[w]=A.imag}return[h,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j5=We((e,t)=>e+t),Vft=f$((e,t,n,s)=>({real:e+n,imag:t+s})),Zu=sn(_c,j5,Vft),Wft={kernelName:_c,backendName:"cpu",kernelFunc:Zu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p$(e,t,n,s,r){const i=X(s),o=Tn(r,n);for(let a=0;a<e.length;a++){const l=e[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=t[a]:o[l]+=1)}return o}function G5(e,t,n,s=!1){const r=e.shape[0],i=e.shape[1],o=Et([r,n],t.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=e.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):t.size>0?o.set(o.get(a,c)+t.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H5=We((e,t)=>e&t),Uft=sn(im,H5),jft={kernelName:im,backendName:"cpu",kernelFunc:Uft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ai(e){return(t,n,s)=>{const r=Ee(n,t.length);for(let i=0;i<t.length;++i)r[i]=e(t[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zt(e,t,n){const s=Ai(t);return qa(e,s,n)}function qa(e,t,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;mt(o,e);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=bo(l)}else c=l;const u=n||o.dtype,h=t(c,u,r);return a.makeTensorInfo(o.shape,u,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K5=Ai(e=>Math.ceil(e)),Gft=qa(xh,K5),Hft={kernelName:xh,backendName:"cpu",kernelFunc:Gft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q5(e,t,n,s){const r=Ee(n,X(t));if(s&&n!=="string"){let i=0;e.forEach(o=>{const a=X(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;e.forEach(o=>{const a=n==="string"?bo(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*t[1]+i;for(let h=0;h<o.shape[1];++h)r[u+h]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X5=We((e,t)=>e===t?1:0),Y5=sn(pm,X5,null,"bool"),Kft={kernelName:pm,backendName:"cpu",kernelFunc:Y5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z5=Ai(e=>Math.exp(e)),Q5=qa(Ch,Z5,"float32"),qft={kernelName:Ch,backendName:"cpu",kernelFunc:Q5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J5=Ai(e=>Math.expm1(e)),Xft=qa(Ih,J5),Yft={kernelName:Ih,backendName:"cpu",kernelFunc:Xft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tW=Ai(e=>Math.floor(e)),Zft=qa(Th,tW),Qft={kernelName:Th,backendName:"cpu",kernelFunc:Zft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eW=We((e,t)=>Math.floor(e/t)),Jft=sn(Nh,eW,null,"int32"),tpt={kernelName:Nh,backendName:"cpu",kernelFunc:Jft};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nW(e,t,n,s,r,i,o,a,l){const c=Et([s,i],n);for(let u=0;u<s;u++){const h=[];let d=0;for(let f=0;f<r;f++){const p=e[u*r+f];d+=p*o[f],h.push(p)}if(d<0||d>=l/i)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=t.get(...t.indexToLoc(d*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sW(e,t,n){const s=Et(n,e.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=t.locToIndex([a,l]);o[2]=t.values[c];const u=e.locToIndex(o);0<=u&&u<e.values.length&&(s.values[r]=e.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rW=We((e,t)=>e>t?1:0),ept=sn(ym,rW,null,"bool"),npt={kernelName:ym,backendName:"cpu",kernelFunc:ept};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iW=We((e,t)=>e>=t?1:0),spt=sn(_h,iW,null,"bool"),rpt={kernelName:_h,backendName:"cpu",kernelFunc:spt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oW=We((e,t)=>e<t?1:0),ipt=sn(vm,oW,null,"bool"),opt={kernelName:vm,backendName:"cpu",kernelFunc:ipt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aW=We((e,t)=>e<=t?1:0),apt=sn(wm,aW,null,"bool"),lpt={kernelName:wm,backendName:"cpu",kernelFunc:apt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lW(e,t,n){const s=(t-e)/(n-1),r=Tn(n,"float32");r[0]=e;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cW=Ai(e=>Math.log(e)),cpt=qa(Dh,cW),upt={kernelName:Dh,backendName:"cpu",kernelFunc:cpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(e,t,n,s){const r=fn(s,X(n));for(let i=0;i<r.length;++i){const o=i*t;let a=e[o];for(let l=0;l<t;++l){const c=e[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hW=We((e,t)=>Math.max(e,t)),hpt=sn(Ph,hW),dpt={kernelName:Ph,backendName:"cpu",kernelFunc:hpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dW=We((e,t)=>Math.min(e,t)),fpt=sn(Fh,dW),ppt={kernelName:Fh,backendName:"cpu",kernelFunc:fpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m$=We((e,t)=>e*t),mpt=f$((e,t,n,s)=>({real:e*n-t*s,imag:e*s+t*n})),iw=sn(Mh,m$,mpt),gpt={kernelName:Mh,backendName:"cpu",kernelFunc:iw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(e,t,n){const s=So(-1,n);return m$([],t,s,e,n)}function xpt(e){const{inputs:t,backend:n}=e,{x:s}=t;mt(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=fW(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const ypt={kernelName:Rm,backendName:"cpu",kernelFunc:xpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pW=We((e,t)=>e!==t?1:0),bpt=sn(Dm,pW,null,"bool"),vpt={kernelName:Dm,backendName:"cpu",kernelFunc:bpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g$(e,t,n,s,r){const i=t.length,o=X(t),a=bt(t),l=bt(r),c=fn(n,X(r));for(let u=0;u<o;++u){const h=Nc(u,i,a),d=new Array(h.length);for(let p=0;p<d.length;p++)d[p]=h[s[p]];const f=Ur(d,i,l);c[f]=e[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gs(e){const{inputs:t,attrs:n,backend:s}=e,{x:r}=t,{perm:i}=n;mt(r,"transpose");const o=r.shape.length,a=new Array(o);for(let h=0;h<a.length;h++)a[h]=r.shape[i[h]];const l=s.data.get(r.dataId).values,c=g$(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const wpt={kernelName:Dl,backendName:"cpu",kernelFunc:gs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mW(e,t,n,s){const[r,i]=xn(e,s),o=hs(t,"int32"),a=Tn(X(r),o),l=X(i);for(let c=0;c<a.length;++c){const u=c*l;let h=1;for(let d=0;d<l;++d)h*=n[u+d];a[c]=h}return{outVals:a,outShape:r,outDtype:o}}function Spt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s;mt(r,"prod");const a=r.shape.length,l=Dt(i,r.shape),c=Ne(l,a);let u=l,h=r;const d=[];c!=null&&(h=gs({inputs:{x:r},backend:n,attrs:{perm:c}}),d.push(h),u=Be(u.length,a));const f=n.data.get(h.dataId).values,{outVals:p,outShape:g,outDtype:m}=mW(h.shape,h.dtype,f,u);let x=g;return o&&(x=ze(g,l)),d.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(x,m,p)}const kpt={kernelName:zm,backendName:"cpu",kernelFunc:Spt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cpt(e,t,n){e.forEach((s,r)=>{if(s<0||s>=n){const i=Nc(r,t.length,bt(t)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function Ipt(e,t){for(let n=0;n<e.length;++n){const s=e[n],r=n===e.length-1?t:e[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function Tpt(e,t,n,s){const r=[];let i=0;const o=t.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);Ipt(n,s);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];const u=t[c+1];for(let h=1;h<l+1;++h)a[c].push(h*u)}for(let c=0;c<e.length;++c){let u=e[c],h=e[c]+1;for(let d=0;d<n.length;++d){const f=n[d],p=d+t.length-1;if(p>=0){const g=a[p],m=g[g.length-1]-f[u];for(let x=u;x<h;++x)a[p].push(f[x+1]+m)}u=f[u],h=f[h]}h!==u&&(r.push([u,h]),i+=h-u)}return{outSplits:a,valueSlices:r,numValues:i}}function Npt(e){const t=[];for(let n=0;n<e.length;++n){const s=e[n].length,r=Ee("int32",s);t.push(r),e[n].forEach((i,o)=>r[o]=i)}return t}function rO(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let s=t;s<e.length;s++)n[t-1]*=e[s];return n}function _pt(e,t,n,s,r,i){const o=rO(t,2)[1],a=rO(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let h=0;h<s;++h)r[l*a+h]=e[u*o+h];++l}}function $pt(e,t,n,s,r){const i=t.slice();i[0]=r;const o=Ee(n,X(i)),a=e.length,l=a===0?0:a/t[0];return _pt(e,t,s,l,o,i),[o,i]}function gW(e,t,n,s,r,i,o,a){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const l=t[0][0]-1;if(Cpt(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:h,numValues:d}=Tpt(i,o,e,c),f=Npt(u),p=$pt(n,s,r,h,d);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iO=2147483647;function xW(e,t,n,s,r,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=t.length===0,l=r.length===0,c=o.length===0,u=[];a||u.push(t[0]),l||u.push(r[0]),c||u.push(o[0]);for(let m=1;m<u.length;++m)if(u[m]!==u[m-1])throw new Error("starts, limits, and deltas must have the same shape");const h=u.length===0?1:u[0],d=Ee("int32",h+1);d[0]=0;for(let m=0;m<h;++m){const x=a?e[0]:e[m],y=l?s[0]:s[m],b=c?i[0]:i[m];if(b===0)throw new Error("Requires delta != 0");let v;if(b>0&&y<x||b<0&&y>x)v=0;else if(v=Math.ceil(Math.abs((y-x)/b)),v>iO)throw new Error(`Requires ((limit - start) / delta) <= ${iO}`);d[m+1]=d[m]+v}const f=d[h],p=Ee(n,f);let g=0;for(let m=0;m<h;++m){const x=d[m+1]-d[m];let y=a?e[0]:e[m];const b=c?i[0]:i[m];for(let v=0;v<x;++v)p[g++]=y,y+=b}return[d,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ur=zr;class Vy{constructor(t,n,s,r,i,o,a,l,c,u){this.shape=t,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=LB(u),this.raggedRank=MB(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===ur.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===ur.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case ur.VALUE_ROWIDS:return Vy.getMaxWidthValueRowID(n);case ur.ROW_SPLITS:return Vy.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${ur[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=t[r+1]-t[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let s=0,r=t[0],i=0;for(let o=1;o<n;++o){const a=t[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(t,n,s=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return aO(t,s)}calculateOutputSize(t){const n=this.valuesShape,s=this.defaultValueShape;zB(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=FB(this.raggedRank,r,n);o[0]<0&&(o[0]=t);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(t,n,s){const r=Math.min(t,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<t;++a)i.push(-1);return T(i.length===t,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(t,n,s,r){const i=t.length,o=[];for(let a=0;a<i-1;++a){const l=t[a+1]-t[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let h=0;h<c;++h)o.push(u),u+=s;for(let h=0;h<l-c;++h)o.push(-1)}if(i>0&&o.length!==t[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,n,s,r){const i=t.length,o=[];if(i===0)return[];let a=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const h=t[u];if(h===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=h,h>=n.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${n.length}`);c=n[h]}o.push(c)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,n,s,r){const i=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case ur.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case ur.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${ur[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case ur.FIRST_DIM_SIZE:return t[0];case ur.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ur.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ur[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=aO(s,!1),o=Ee(this.valuesDType,X(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(t,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(t+1);const l=X(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;G(()=>{const g=V(u,p);u=Ol(g,a).dataSync()})}let h=0,d=0,f=0;for(let p=0;p<=c;++p){let g=p<c?n[p]:-1;if(g===f){++f;continue}if(d<f){const m=i.subarray(h*l),x=o.subarray(d*l),y=(f-d)*l;oO(x,m,y)}if(p>=c){const m=s.length;g=Math.floor(m/l)}if(g>f)if(this.defaultValue.length===1)o.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;){const m=o.slice(f*l);oO(m,u,l),++f}g<0?(h=p+1,d=f):(h=p,d=f,f=d+1)}}}function oO(e,t,n){for(let s=0;s<n;s++)e[s]=t[s]}function aO(e,t){const n=[];for(let s of e){if(s<0){if(!t)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function yW(e,t,n,s,r,i,o,a,l,c){return new Vy(e,t,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(e,t,n,s){const r=e===t,i=e<t&&n<0,o=t<e&&n>1;if(r||i||o)return Tn(0,s);const a=Math.abs(Math.ceil((t-e)/n)),l=Tn(a,s);t<e&&n===1&&(n=-1),l[0]=e;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vW=Ai(e=>1/Math.sqrt(e)),Ept=qa(jh,vW),Apt={kernelName:jh,backendName:"cpu",kernelFunc:Ept};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tl(e,t,n,s,r,i,o,a,l,c){const u=[s/r,r],h=e.values,d=t.values;if(s===0)return Et(n,t.dtype);const f=l instanceof Xe?l:Et(u,t.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const g=[];let m=0;for(let x=0;x<o;x++){const y=h[p*o+x];g.push(y),m+=y*a[x]}if(m<0||m>=s/r)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let x=0;x<r;x++)c?f.values[m*r+x]+=d[p*r+x]:f.values[m*r+x]=t.rank===0?d[0]:d[p*r+x]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rpt=Ai(e=>1/(1+Math.exp(-e))),wW=Zt(Xh,e=>1/(1+Math.exp(-e))),Dpt={kernelName:Xh,backendName:"cpu",kernelFunc:wW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(e,t,n,s,r){const i=cN(s,t,n),o=X(n),a=bt(s);if(i){const h=uN(t,a);return r==="string"?e.slice(h,h+o):e.subarray(h,h+o)}const l=r==="string"?bo(e):e,c=Et(s,r,l),u=Et(n,r);for(let h=0;h<u.size;++h){const d=u.indexToLoc(h),f=d.map((p,g)=>p+t[g]);u.set(c.get(...f),...d)}return r==="string"?iV(u.values):u.values}function hc(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:i,size:o}=s;mt(r,"slice");const[a,l]=Ov(r,i,o);aN(r,a,l);const c=n.data.get(r.dataId).values,u=SW(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const Opt={kernelName:Gm,backendName:"cpu",kernelFunc:hc};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kW(e,t,n,s,r,i,o){const a=t[0],l=i[0],c=new Array(l),u=new Array(a),h=t[1];if(l===0){if(a!==0)throw new Error(HB(a));const m=Ee(n,0),x=Ee(r,0);return[m,[0,h],x,c,u]}let d=!0,f=0;const p=new Array(l).fill(0);for(let m=0;m<a;++m){const x=e[m*h];if(x<0)throw new Error(KB(m,x));if(x>=l)throw new Error(qB(m,x,l));++p[x],d=d&&x>=f,f=x}let g=!0;for(let m=0;m<l;++m){const x=p[m]===0;c[m]=x,g=g&&!x,p[m]=Math.max(p[m],1),m>0&&(p[m]+=p[m-1])}if(g&&d){const m=e,x=s;for(let y=0;y<a;++y)u[y]=y;return[m,[a,h],x,c,u]}else{const m=p[l-1],x=Ee(n,m*h),y=Ee(r,m),b=new Array(l).fill(0);for(let v=0;v<a;++v){const w=e[v*h],k=b[w],I=(w===0?0:p[w-1])+k;b[w]++;for(let C=0;C<h;++C)x[I*h+C]=e[v*h+C];y[I]=s[v],u[v]=I}for(let v=0;v<l;++v)if(b[v]===0){const k=v===0?0:p[v-1];x[k*h+0]=v;for(let I=1;I<h;++I)x[k*h+I]=0;y[k]=o}return[x,[m,h],y,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(e,t,n,s,r){const i=X(s),o=t[0],a=r.length,l=[];let c=1,u=-1;for(let m=0;m<a;++m){const x=r[m];if(x===-1){if(u!==-1)throw new Error(XB(u,m));u=m,l.push(1)}else{if(x<0)throw new Error(YB(m,x));c*=x,l.push(x)}}if(u!==-1){if(c<=0)throw new Error(ZB());const m=Math.trunc(i/c);if(c*m!==i)throw new Error(QB(s,l));l[u]=m}if(X(l)!==i)throw new Error(JB(s,l));const d=s.length,f=[];if(d>0){f[d-1]=1;for(let m=d-2;m>=0;--m)f[m]=f[m+1]*s[m+1]}const p=[];if(a>0){p[a-1]=1;for(let m=a-2;m>=0;--m)p[m]=p[m+1]*l[m+1]}const g=Ee(n,o*a);for(let m=0;m<o;++m){let x=0;for(let y=0;y<d;++y)x+=e[m*d+y]*f[y];for(let y=0;y<a;++y)g[m*a+y]=Math.trunc(x/p[y]),x%=p[y]}return[g,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x$(e,t,n,s,r,i=!1,o=0){const a=s.length,l=[t[0],e.length/t[0]],c=l[1],h=a>0?r[a-1]+1:0;if(h<0)throw new Error(dk());const d=t.slice();d[0]=h;const f=d.reduce((b,v)=>b*v,1),p=Ee(n,f);if(a===0)return h>0&&p.fill(o),[p,d];if(h<=0)throw new Error(dk());let g=0,m=1,x=0,y=r[g];for(;;){let b=0;if(m<a){if(b=r[m],y===b){++m;continue}if(y>=b)throw new Error(tV())}if(y<0||y>=h)throw new Error(eV(y,h));y>x&&p.fill(o,x*c,y*c);for(let v=g;v<m;++v){const w=s[v];if(w<0||w>=l[0])throw new Error(nV(v,s[v],l[0]));for(let k=0;k<c;k++)p[y*c+k]+=e[w*c+k]}if(i)for(let v=0;v<c;v++)p[y*c+v]/=m-g;if(g=m,++m,x=y+1,y=b,m>a)break}return x<h&&p.fill(o,x*c,h*c),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ppt=Ai(e=>Math.sqrt(e)),Fpt=Zt(Zh,e=>Math.sqrt(e)),Lpt={kernelName:Zh,backendName:"cpu",kernelFunc:Fpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW=We((e,t)=>{const n=e-t;return n*n}),Mpt=sn(Qh,IW),zpt={kernelName:Qh,backendName:"cpu",kernelFunc:Mpt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TW=Ai((e,t)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=t;return e.replace(new RegExp(n,s?"g":""),r)}),Bpt=qa(Ym,TW),Vpt={kernelName:Ym,backendName:"cpu",kernelFunc:Bpt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(e,t,n,s){const r=Et(e,t.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(t.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wpt{constructor(t,n,s,r,i,o){this.separator=xi(t),this.nGramWidths=n,this.leftPad=xi(s),this.rightPad=xi(r),this.padWidth=i,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const s=this.getPadWidth(n);return Math.max(0,t+2*s-n+1)}createNGrams(t,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),h=o-(c+u),d=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let y=0;y<h;++y)f+=t[d+y].length;f+=u*this.rightPad.length;const p=c+u+h-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const g=s[r+a];let m=0;const x=y=>y.forEach(b=>g[m++]=b);for(let y=0;y<c;++y)x(this.leftPad),x(this.separator);for(let y=0;y<h-1;++y)x(t[d+y]),x(this.separator);if(h>0){x(t[d+h-1]);for(let y=0;y<u;++y)x(this.separator),x(this.rightPad)}else{for(let y=0;y<u-1;++y)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(t,n){const s=t.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=Ee("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(h=>{u+=this.getNumNGrams(c,h)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(h=>{const d=n[l+1]-n[l],f=this.getNumNGrams(d,h);this.createNGrams(t,c,a,u,f,h),u+=f}),this.preserveShort&&u===o[l]){const h=n[l+1]-n[l];if(h===0)continue;const d=h+2*this.padWidth;this.createNGrams(t,c,a,u,1,d)}}return[a,o]}}function _W(e,t,n,s,r,i,o,a){return new Wpt(n,s,r,i,o,a).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upt(e,t,n,s){if(!e.length)return;if(t.length===0){for(let i=0;i<e.length;++i)s.push(e.subarray(i,i+1));return}if(t.length===1){const i=t[0];let o=e.indexOf(i);for(;o!==-1;){const a=e.subarray(0,o);(!n||a.length!==0)&&s.push(a),e=e.subarray(o+1),o=e.indexOf(i)}(!n||e.length!==0)&&s.push(e);return}let r=0;for(let i=0;i<e.length+1;i++)if(i===e.length||t.indexOf(e[i])!==-1){const o=e.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function $W(e,t,n){const s=e.length,r=[];let i=0,o=0;const a=new Array(s);for(let d=0;d<s;++d){const f=r.length;Upt(e[d],t,n,r);const p=r.length-f;a[d]=p,i+=p,o=Math.max(o,p)}const l=Ee("int32",i*2),c=new Array(i),u=[s,o];let h=0;for(let d=0;d<s;++d)for(let f=0;f<a[d];++f)l[h*2]=d,l[h*2+1]=f,c[h]=r[h],++h;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EW(e,t){const n=Ee("int32",e.length);for(let s=0;s<e.length;++s)n[s]=V4(e[s]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AW=We((e,t)=>e-t),jpt=f$((e,t,n,s)=>({real:e-n,imag:t-s})),y$=sn(Jh,AW,jpt),Gpt={kernelName:Jh,backendName:"cpu",kernelFunc:y$};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(e,t){const n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];const s=Et(n,e.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(e.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%e.shape[l];const a=e.locToIndex(o);s.values[r]=e.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sf=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function DW(e,t,n=0,s=e.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=t-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),d=Math.max(n,Math.floor(t-l*u/a+h)),f=Math.min(s,Math.floor(t+(a-l)*u/a+h));DW(e,t,d,f)}const r=e[t];let i=n,o=s;for(ji(e,n,t),sf(e[s],r)>0&&ji(e,n,s);i<o;){for(ji(e,i,o),i++,o--;sf(e[i],r)<0;)i=i+1;for(;sf(e[o],r)>0;)o=o-1}sf(e[n],r)===0?ji(e,n,o):(o=o+1,ji(e,o,s)),o<=t&&(n=o+1),t<=o&&(s=o-1)}}function OW(e,t,n,s,r){const i=t[t.length-1],[o,a]=[e.length/i,i],l=fn(n,o*s),c=fn("int32",o*s);for(let h=0;h<o;h++){const d=h*a,f=e.subarray(d,d+a);let p=new Array(f.length);f.forEach((y,b)=>p[b]={value:y,index:b}),s<p.length&&(DW(p,s),p=p.slice(0,s)),r&&p.sort(sf);const g=h*s,m=l.subarray(g,g+s),x=c.subarray(g,g+s);for(let y=0;y<s;y++)m[y]=p[y].value,x[y]=p[y].index}const u=t.slice();return u[u.length-1]=s,[Et(u,n,l),Et(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(e,t,n,s){const r=Dt(t,n)[0],i=[1,n[0],1];for(let p=0;p<r;p++)i[0]*=n[p];i[1]=n[r];for(let p=r+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[r]),l=new Xe(i,s,e),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[r];p++){let g;if(u)g=e[p].toString();else{const x=[];for(let y=0;y<i[0];y++)for(let b=0;b<i[2];b++)x.push(l.get(y,p,b));g=x.join(",")}const m=o.get(g);if(m!=null)a[p]=m;else{const x=o.size;o.set(g,x),a[p]=x,c.push(p)}}const h=i.slice();h[1]=o.size;const d=new Xe(h,s);c.forEach((p,g)=>{for(let m=0;m<i[0];m++)for(let x=0;x<i[2];x++)d.set(l.get(m,p,x),m,g,x)});const f=n.slice();return f[r]=h[1],{outputValues:d.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FW=Object.freeze(Object.defineProperty({__proto__:null,addImpl:j5,bincountImpl:p$,bincountReduceImpl:G5,bitwiseAndImpl:H5,castImpl:U5,ceilImpl:K5,concatImpl:q5,equalImpl:X5,expImpl:Z5,expm1Impl:J5,floorDivImpl:eW,floorImpl:tW,gatherNdImpl:nW,gatherV2Impl:sW,greaterEqualImpl:iW,greaterImpl:rW,lessEqualImpl:aW,lessImpl:oW,linSpaceImpl:lW,logImpl:cW,maxImpl:uW,maximumImpl:hW,minimumImpl:dW,multiplyImpl:m$,negImpl:fW,notEqualImpl:pW,prodImpl:mW,raggedGatherImpl:gW,raggedRangeImpl:xW,raggedTensorToTensorImpl:yW,rangeImpl:bW,rsqrtImpl:vW,scatterImpl:Tl,sigmoidImpl:Rpt,simpleAbsImpl:W5,sliceImpl:SW,sparseFillEmptyRowsImpl:kW,sparseReshapeImpl:CW,sparseSegmentReductionImpl:x$,sqrtImpl:Ppt,squaredDifferenceImpl:IW,staticRegexReplaceImpl:TW,stridedSliceImpl:NW,stringNGramsImpl:_W,stringSplitImpl:$W,stringToHashBucketFastImpl:EW,subImpl:AW,tileImpl:RW,topKImpl:OW,transposeImpl:g$,uniqueImpl:PW},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const LW="4.21.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */PI("cpu",()=>new Rg,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MW=Zt(Sh,e=>e>=0?e:Math.exp(e)-1),Hpt={kernelName:Sh,backendName:"cpu",kernelFunc:MW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{alpha:i}=s;mt([r],"leakyRelu");const o=X(r.shape),a=n.data.get(r.dataId).values,l=fn("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const Kpt={kernelName:bm,backendName:"cpu",kernelFunc:zW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpt=We((e,t)=>e<0?t*e:e);function BW(e){const{inputs:t,backend:n}=e,{x:s,alpha:r}=t;mt([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=qpt(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const Xpt={kernelName:Mm,backendName:"cpu",kernelFunc:BW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VW=Zt(Vh,e=>Math.max(0,e)),Ypt={kernelName:Vh,backendName:"cpu",kernelFunc:VW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WW=Zt(Wh,e=>Math.min(Math.max(0,e),6)),Zpt={kernelName:Wh,backendName:"cpu",kernelFunc:WW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wy(e,t,n,s,r){if(n==="linear")return _i({inputs:{x:t},backend:e});if(n==="relu")return VW({inputs:{x:t},backend:e});if(n==="elu")return MW({inputs:{x:t},backend:e});if(n==="relu6")return WW({inputs:{x:t},backend:e});if(n==="prelu")return BW({inputs:{x:t,alpha:s},backend:e});if(n==="leakyrelu")return zW({inputs:{x:t},backend:e,attrs:{alpha:r}});if(n==="sigmoid")return wW({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ae(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{shape:i}=s,o=X(r.shape),a=II(i,o),l=X(a);T(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;u.shape=a,h.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const Qpt={kernelName:Bm,backendName:"cpu",kernelFunc:ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:i}=t,{transposeA:o,transposeB:a}=s;mt([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],h=a?i.shape[c-1]:i.shape[c-2],d=o?r.shape[l-1]:r.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=r.shape.slice(0,-2),g=i.shape.slice(0,-2),m=X(p),x=X(g),b=It(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,f]);T(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const v=o?[m,u,d]:[m,d,u],w=a?[x,f,h]:[x,h,f],k=ae({inputs:{x:r},backend:n,attrs:{shape:v}}),I=ae({inputs:{x:i},backend:n,attrs:{shape:w}}),C=o?k.shape[1]:k.shape[2],N=o?k.shape[2]:k.shape[1],$=a?I.shape[1]:I.shape[2],A=Math.max(m,x),R=n.data.get(k.dataId).values,z=n.data.get(I.dataId).values,U=bt(k.shape),F=bt(I.shape),[P,L,E]=o?[U[0],1,U[1]]:[U[0],U[1],1],[B,q,Y]=a?[1,F[1],F[0]]:[F[1],1,F[0]],Q=N*$,J=Et([A,N,$],k.dtype),et=J.values,nt=n.blockSize;for(let rt=0;rt<A;rt++){const ht=rt%m,vt=rt%x;for(let wt=0;wt<N;wt+=nt){const Tt=Math.min(wt+nt,N);for(let _t=0;_t<$;_t+=nt){const Nt=Math.min(_t+nt,$);for(let qt=0;qt<C;qt+=nt){const fe=Math.min(qt+nt,C);for(let Qt=wt;Qt<Tt;Qt++)for(let Xt=_t;Xt<Nt;Xt++){let le=0;for(let pe=qt;pe<fe;pe++){const Ri=R[ht*P+Qt*L+pe*E],yn=z[pe*B+Xt*q+vt*Y];le+=Ri*yn}et[rt*Q+(Qt*$+Xt)]+=le}}}}}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(I),n.makeTensorInfo(b,J.dtype,J.values)}const Jpt={kernelName:sm,backendName:"cpu",kernelFunc:UW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tmt(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:i,bias:o,preluActivationWeights:a}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;let d,f,p;const g=[];d=UW({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=Zu({inputs:{a:d,b:o},backend:n}),g.push(d),d=f),u&&(p=Wy(n,d,u,a,h),g.push(d),d=p);for(const x of g)n.disposeIntermediateTensorInfo(x);return d}const emt={kernelName:fp,backendName:"cpu",kernelFunc:tmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nmt=Zt(ch,e=>Math.acos(e)),smt={kernelName:ch,backendName:"cpu",kernelFunc:nmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rmt=Zt(uh,e=>Math.acosh(e)),imt={kernelName:uh,backendName:"cpu",kernelFunc:rmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function omt(e){const{inputs:t,backend:n}=e,s=t;mt(t,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=Et(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const amt={kernelName:Qp,backendName:"cpu",kernelFunc:omt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s;mt(r,"all");const a=Dt(i,r.shape);let l=a;const c=Ne(l,r.shape.length);let u=r;c!=null&&(u=gs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Be(l.length,r.shape.length)),$n("all",l,u.shape.length);const[h,d]=xn(u.shape,l),f=X(d),p=Tn(X(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=g[y];for(let v=0;v<f;++v){const w=g[y+v];b=b&&w}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const x=ze(h,a),y=ae({inputs:{x:m},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(m),y}return m}const cmt={kernelName:U1,backendName:"cpu",kernelFunc:lmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function umt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s;mt(r,"any");const a=Dt(i,r.shape);let l=a;const c=Ne(l,r.shape.length);let u=r;c!=null&&(u=gs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Be(l.length,r.shape.length)),$n("any",l,u.shape.length);const[h,d]=xn(u.shape,l),f=X(d),p=Tn(X(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=g[y];for(let v=0;v<f;++v){const w=g[y+v];b=b||w}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const x=ze(h,a),y=ae({inputs:{x:m},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(m),y}return m}const hmt={kernelName:j1,backendName:"cpu",kernelFunc:umt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i}=s;mt(r,"argMax");let o=Dt(i,r.shape);const a=Ne(o,r.shape.length);let l=r;const c=[];a!=null&&(l=gs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Be(o.length,l.shape.length)),o=[o[0]],$n("argMax",o,l.shape.length);const[u,h]=xn(l.shape,o),d=X(u),f=Tn(d,"int32"),p=X(h),g=n.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const x=m*p;let y=g[x],b=0;for(let v=0;v<p;++v){const w=g[x+v];w>y&&(y=w,b=v)}f[m]=b}return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(u,"int32",f)}const fmt={kernelName:Jp,backendName:"cpu",kernelFunc:dmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i}=s;mt(r,"argMin");let o=Dt(i,r.shape);const a=Ne(o,r.shape.length);let l=r;const c=[];a!=null&&(l=gs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Be(o.length,l.shape.length)),o=[o[0]],$n("argMin",o,l.shape.length);const[u,h]=xn(l.shape,o),d=X(u),f=Tn(d,"int32"),p=X(h),g=n.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const x=m*p;let y=g[x],b=0;for(let v=0;v<p;++v){const w=g[x+v];w<y&&(y=w,b=v)}f[m]=b}return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(u,"int32",f)}const mmt={kernelName:tm,backendName:"cpu",kernelFunc:pmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gmt=Zt(hh,e=>Math.asin(e)),xmt={kernelName:hh,backendName:"cpu",kernelFunc:gmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ymt=Zt(dh,e=>Math.asinh(e)),bmt={kernelName:dh,backendName:"cpu",kernelFunc:ymt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vmt=Zt(fh,e=>Math.atan(e)),wmt={kernelName:fh,backendName:"cpu",kernelFunc:vmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Smt=We((e,t)=>Math.atan2(e,t)),kmt=sn(mh,Smt),Cmt={kernelName:mh,backendName:"cpu",kernelFunc:kmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Imt=Zt(ph,e=>Math.atanh(e)),Tmt={kernelName:ph,backendName:"cpu",kernelFunc:Imt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b$(e,t,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Et(r.outShape,n),m=g.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3];for(let v=0;v<r.batchSize;++v){const w=v*x,k=v*s[0];for(let I=0;I<r.inChannels;++I)for(let C=0;C<r.outHeight;++C){const N=C*o-d,$=Math.max(0,N),A=Math.min(r.inHeight,u+N),R=w+C*y;for(let z=0;z<r.outWidth;++z){const U=z*a-f,F=Math.max(0,U),P=Math.min(r.inWidth,h+U);let L=p,E=0,B=0;for(let Y=$;Y<A;Y+=l){const Q=k+Y*s[1];for(let J=F;J<P;J+=c){const et=Q+J*s[2],nt=e[et+I];i==="max"&&nt>L?L=nt:i==="avg"&&(E+=nt,B++)}if(isNaN(L))break}const q=R+z*b+I;m[q]=i==="avg"?E/B:L}}}return g}function jW(e,t,n,s,r=!1,i=!1){const o=Et(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,h=s.effectiveFilterHeight,d=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,g=Et(t,n,e);for(let m=0;m<s.batchSize;++m)for(let x=0;x<s.inChannels;++x)for(let y=0;y<s.outHeight;++y){const b=y*a-f;let v=b;for(;v<0;)v+=c;const w=Math.min(s.inHeight,h+b);for(let k=0;k<s.outWidth;++k){const I=k*l-p;let C=I;for(;C<0;)C+=u;const N=Math.min(s.inWidth,d+I);let $=Number.NEGATIVE_INFINITY,A=-1;for(let R=v;R<w;R+=c){const z=R-b;for(let U=C;U<N;U+=u){const F=U-I,P=g.get(m,R,U,x);P>$&&($=P,r?A=i?((m*s.inHeight+R)*s.inWidth+U)*s.inChannels+x:(R*s.inWidth+U)*s.inChannels+x:A=z*d+F)}}o.set(A,m,y,k,x)}}return o}function GW(e,t,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,g=r.padInfo.front,m=r.padInfo.top,x=r.padInfo.left,y=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Et(r.outShape,n),v=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[2]*r.outShape[3]*r.outShape[4],I=r.outShape[3]*r.outShape[4],C=r.outShape[4];for(let N=0;N<r.batchSize;++N){const $=N*w,A=N*s[0];for(let R=0;R<r.inChannels;++R)for(let z=0;z<r.outDepth;++z){const U=z*o-g;let F=U;for(;F<0;)F+=c;const P=Math.min(r.inDepth,d+U),L=$+z*k;for(let E=0;E<r.outHeight;++E){const B=E*a-m;let q=B;for(;q<0;)q+=u;const Y=Math.min(r.inHeight,f+B),Q=L+E*I;for(let J=0;J<r.outWidth;++J){const et=J*l-x;let nt=et;for(;nt<0;)nt+=h;const rt=Math.min(r.inWidth,p+et),ht=Q+J*C;let vt=y,wt=0,Tt=0;for(let Nt=F;Nt<P;Nt+=c){const qt=A+Nt*s[1];for(let fe=q;fe<Y;fe+=u){const Qt=qt+fe*s[2];for(let Xt=nt;Xt<rt;Xt+=h){const le=Qt+Xt*s[3],pe=e[le+R];if(i==="max"&&pe>vt?vt=pe:i==="avg"&&(wt+=pe,Tt++),isNaN(vt))break}if(isNaN(vt))break}if(isNaN(vt))break}const _t=ht+R;v[_t]=i==="avg"?wt/Math.max(Tt,1):vt}}}}return b}function Nmt(e,t){const n=Et(t.outShape,"int32"),s=t.strideDepth,r=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,a=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left;for(let g=0;g<t.batchSize;++g)for(let m=0;m<t.inChannels;++m)for(let x=0;x<t.outDepth;++x){const y=x*s-d;let b=y;for(;b<0;)b+=o;const v=Math.min(t.inDepth,c+y);for(let w=0;w<t.outHeight;++w){const k=w*r-f;let I=k;for(;I<0;)I+=a;const C=Math.min(t.inHeight,u+k);for(let N=0;N<t.outWidth;++N){const $=N*i-p;let A=$;for(;A<0;)A+=l;const R=Math.min(t.inWidth,h+$);let z=Number.NEGATIVE_INFINITY,U=-1;for(let F=b;F<v;F+=o){const P=F-y;for(let L=I;L<C;L+=a){const E=L-k;for(let B=A;B<R;B+=l){const q=B-$,Y=e.get(g,F,L,B,m);Y>=z&&(z=Y,U=P*u*h+E*u+q)}}}n.set(U,g,x,w,N,m)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _mt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;mt(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;T(_n(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Nr(r.shape,i,o,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&Pt(u.inShape,u.outShape))h=_i({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,f=bt(r.shape),p=b$(d,r.shape,r.dtype,f,u,"avg");h=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return h}const $mt={kernelName:em,backendName:"cpu",kernelFunc:_mt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Emt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;mt(r,"avgPool3d");const u=ko(r.shape,i,o,1,a,l,c),h=n.data.get(r.dataId).values,d=GW(h,r.shape,r.dtype,bt(r.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const Amt={kernelName:nm,backendName:"cpu",kernelFunc:Emt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rmt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:i}=t,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;mt([r,i],"avgPool3DGrad");const u=ko(i.shape,o,a,1,l,c),h=u.strideDepth,d=u.strideHeight,f=u.strideWidth,p=u.filterDepth,g=u.filterHeight,m=u.filterWidth,x=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,I=v-1-u.padInfo.front,C=k-1-u.padInfo.left,N=w-1-u.padInfo.top,$=Et(i.shape,"float32"),A=1/(p*g*m),R=n.bufferSync(r);for(let z=0;z<u.batchSize;++z)for(let U=0;U<u.inChannels;++U)for(let F=0;F<u.inDepth;++F)for(let P=0;P<u.inHeight;++P)for(let L=0;L<u.inWidth;++L){const E=F-I,B=P-N,q=L-C;let Y=0;for(let Q=0;Q<v;Q+=x){const J=(E+Q)/h;if(!(J<0||J>=u.outDepth||Math.floor(J)!==J))for(let et=0;et<w;et+=y){const nt=(B+et)/d;if(!(nt<0||nt>=u.outHeight||Math.floor(nt)!==nt))for(let rt=0;rt<k;rt+=b){const ht=(q+rt)/f;if(ht<0||ht>=u.outWidth||Math.floor(ht)!==ht)continue;const vt=R.get(z,J,nt,ht,U);Y+=vt}}}$.set(Y*A,z,F,P,L,U)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const Dmt={kernelName:H1,backendName:"cpu",kernelFunc:Rmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Omt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:i}=t,o=i;mt([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Nr(o.shape,a,l,1,c),h=u.strideHeight,d=u.strideWidth,f=u.filterHeight,p=u.filterWidth,g=u.dilationHeight,m=u.dilationWidth,x=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,v=x-1-u.padInfo.top,w=Et(o.shape,"float32"),k=1/(f*p),I=n.data.get(r.dataId).values,C=Et(r.shape,"float32",I);for(let N=0;N<u.batchSize;++N)for(let $=0;$<u.inChannels;++$)for(let A=0;A<u.inHeight;++A)for(let R=0;R<u.inWidth;++R){const z=A-v,U=R-b;let F=0;for(let P=0;P<x;P+=g){const L=(z+P)/h;if(!(L<0||L>=u.outHeight||Math.floor(L)!==L))for(let E=0;E<y;E+=m){const B=(U+E)/d;if(B<0||B>=u.outWidth||Math.floor(B)!==B)continue;const q=C.get(N,L,B,$);F+=q}}w.set(F*k,N,A,R,$)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Pmt={kernelName:G1,backendName:"cpu",kernelFunc:Omt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,scale:i,offset:o,mean:a,variance:l}=t;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),mt([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),m=p.length,x=f.length,y=d.length,b=h.length;let v=0,w=0,k=0,I=0;for(let C=0;C<u.length;++C)g[C]=p[v++]+(u[C]-h[w++])*f[k++]/Math.sqrt(d[I++]+c),v>=m&&(v=0),w>=b&&(w=0),k>=x&&(k=0),I>=y&&(I=0);return n.makeTensorInfo(r.shape,r.dtype,g)}const Lmt={kernelName:gm,backendName:"cpu",kernelFunc:Fmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:i,crops:o}=s;mt([r],"batchToSpaceND");const a=i.reduce((x,y)=>x*y),l=vg(r.shape,i,a),c=wg(l.length,i.length),u=Sg(r.shape,i,a),h=gN(o,i.length),d=xN(u,o,i.length),f=ae({inputs:{x:r},backend:n,attrs:{shape:l}}),p=gs({inputs:{x:f},backend:n,attrs:{perm:c}}),g=ae({inputs:{x:p},backend:n,attrs:{shape:u}}),m=hc({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const zmt={kernelName:rm,backendName:"cpu",kernelFunc:Mmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:i}=t,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=p$(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Vmt={kernelName:K1,backendName:"cpu",kernelFunc:Bmt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wmt(e){const{inputs:t,backend:n}=e,{s0:s,s1:r}=t,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=It(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Umt={kernelName:q1,backendName:"cpu",kernelFunc:Wmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jmt=Zt(yh,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),Gmt={kernelName:yh,backendName:"cpu",kernelFunc:jmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hmt=e=>{const{x:t}=e.inputs,n=e.backend,s=new Float32Array(X(t.shape)),r=n.data.get(t.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],h=l[c];s[c]=Math.hypot(u,h)}return n.makeOutput(s,t.shape,"float32")},Kmt={kernelName:om,backendName:"cpu",kernelFunc:Hmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qu(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const qmt={kernelName:pb,backendName:"cpu",kernelFunc:Qu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ju(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s,i=Dt(r,t[0].shape)[0],o=t.map(g=>g.shape);fN(o,i);let a=bi(t.map(g=>g.shape),i);if(X(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);const l=t.filter(g=>X(g.shape)>0);if(l.length===1)return _i({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(v=>uc({inputs:{input:v},backend:n})),m=l.map(v=>Qu({inputs:{input:v},backend:n})),x=Ju({inputs:g,backend:n,attrs:{axis:i}}),y=Ju({inputs:m,backend:n,attrs:{axis:i}}),b=Ts({inputs:{real:x,imag:y},backend:n});return g.forEach(v=>n.disposeIntermediateTensorInfo(v)),m.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),b}const c=l.map(g=>{const x=[-1,X(g.shape.slice(i))];return ae({inputs:{x:g},backend:n,attrs:{shape:x}})}),u=c.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));a=bi(c.map(g=>g.shape),1);const h=c[0].shape[0]===1,d=q5(u,a,t[0].dtype,h),f=bi(l.map(g=>g.shape),i),p=n.makeTensorInfo(f,t[0].dtype,d);return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const Xmt={kernelName:am,backendName:"cpu",kernelFunc:Ju};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i}=t,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;mt([r,i],"conv2d");const h=Co(l),d=gn(r.shape,i.shape,o,c,a,u,!1,h),f=d.filterHeight,p=d.filterWidth,g=d.dilationHeight,m=d.dilationWidth,x=d.padInfo.left,y=d.padInfo.top,b=d.dataFormat==="channelsLast",v=new Xe(d.outShape,r.dtype),w=bt(r.shape),k=bt(i.shape),I=w[0],C=b?w[1]:w[2],N=b?w[2]:1,$=b?1:w[1],A=v.strides[0],R=b?v.strides[1]:v.strides[2],z=b?v.strides[2]:1,U=b?1:v.strides[1],F=n.data.get(r.dataId).values,P=n.data.get(i.dataId).values,L=v.values;for(let E=0;E<d.batchSize;++E){const B=E*I,q=E*A;for(let Y=0;Y<d.outHeight;++Y){const Q=q+Y*R,J=Y*d.strideHeight-y;for(let et=0;et<f;++et){const nt=J+et*g;if(nt<0||nt>=d.inHeight)continue;const rt=et*k[0],ht=B+nt*C;for(let vt=0;vt<d.outWidth;++vt){const wt=Q+vt*z,Tt=vt*d.strideWidth-x;for(let _t=0;_t<p;++_t){const Nt=Tt+_t*m;if(Nt<0||Nt>=d.inWidth)continue;const qt=rt+_t*k[1],fe=ht+Nt*N;let Qt=qt;for(let Xt=0;Xt<d.inChannels;++Xt){const le=F[fe+Xt*$];for(let pe=0;pe<d.outChannels;++pe)L[wt+pe*U]+=le*P[Qt+pe];Qt+=d.outChannels}}}}}}return n.makeTensorInfo(v.shape,v.dtype,L)}const Ymt={kernelName:lm,backendName:"cpu",kernelFunc:HW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zmt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:i}=t,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;mt([r,i],"conv2dBackpropFilter");const h=Co(l),d=gn(r.shape,u,o,1,a,c,!1,h),{strideHeight:f,strideWidth:p,filterHeight:g,filterWidth:m}=d,x=d.dataFormat==="channelsLast",y=new Xe(d.filterShape,"float32"),b=d.padInfo.left,v=d.padInfo.top,w=n.data.get(r.dataId).values,k=n.data.get(i.dataId).values,I=new Xe(r.shape,r.dtype,w),C=new Xe(i.shape,i.dtype,k);for(let N=0;N<g;++N){const $=Math.max(0,Math.ceil((v-N)/f)),A=Math.min(d.outHeight,(d.inHeight+v-N)/f);for(let R=0;R<m;++R){const z=Math.max(0,Math.ceil((b-R)/p)),U=Math.min(d.outWidth,(d.inWidth+b-R)/p);for(let F=0;F<d.inChannels;++F)for(let P=0;P<d.outChannels;++P){let L=0;for(let E=0;E<d.batchSize;++E)for(let B=$;B<A;++B){const q=N+B*f-v;for(let Y=z;Y<U;++Y){const Q=R+Y*p-b;x?L+=I.get(E,q,Q,F)*C.get(E,B,Y,P):L+=I.get(E,F,q,Q)*C.get(E,P,B,Y)}}y.set(L,N,R,F,P)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Qmt={kernelName:Y1,backendName:"cpu",kernelFunc:Zmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jmt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:i}=t,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;mt([r,i],"conv2dBackpropInput");const h=bt(i.shape),d=bt(r.shape);let f=Co(c);const p=gn(o,i.shape,a,1,l,u,!1,f),g=new Xe(p.inShape,"float32"),m=g.values,x=n.data.get(r.dataId).values,y=n.data.get(i.dataId).values,[b,v,w]=h,{batchSize:k,filterHeight:I,filterWidth:C,inChannels:N,inHeight:$,inWidth:A,outChannels:R,outHeight:z,outWidth:U,strideHeight:F,strideWidth:P}=p;f=p.dataFormat;const L=I-1-p.padInfo.top,E=C-1-p.padInfo.left,B=f==="channelsLast",q=g.strides[0],Y=B?g.strides[1]:g.strides[2],Q=B?g.strides[2]:1,J=B?1:g.strides[1],et=d[0],nt=B?d[1]:d[2],rt=B?d[2]:1,ht=B?1:d[1];for(let vt=0;vt<k;++vt)for(let wt=0;wt<N;++wt)for(let Tt=0;Tt<$;++Tt){const _t=Tt-L,Nt=Math.max(0,Math.ceil(_t/F)),qt=Math.min(z,(I+_t)/F);for(let fe=0;fe<A;++fe){const Qt=fe-E,Xt=Math.max(0,Math.ceil(Qt/P)),le=Math.min(U,(C+Qt)/P);let pe=0;for(let yn=Nt;yn<qt;++yn){const Ao=yn*F-_t;for(let Bs=Xt;Bs<le;++Bs){const Za=Bs*P-Qt,Er=et*vt+nt*yn+rt*Bs,Di=b*(I-1-Ao)+v*(C-1-Za)+w*wt;for(let Ro=0;Ro<R;++Ro){const Do=x[Er+ht*Ro],Oo=y[Di+Ro];pe+=Do*Oo}}}const Ri=q*vt+Y*Tt+Q*fe+J*wt;m[Ri]=pe}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const tgt={kernelName:cm,backendName:"cpu",kernelFunc:Jmt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function egt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i}=t,{strides:o,pad:a,dilations:l}=s;mt([r,i],"conv3d");const c=Wa(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:g,padInfo:m}=c,x=m.front,y=m.left,b=m.top,v=new Xe(c.outShape,r.dtype),w=n.data.get(r.dataId).values,k=n.data.get(i.dataId).values,I=v.values,C=bt(r.shape),N=bt(i.shape);for(let $=0;$<c.batchSize;++$){const A=$*C[0],R=$*v.strides[0];for(let z=0;z<c.outDepth;++z){const U=R+z*v.strides[1],F=z*c.strideDepth-x;for(let P=0;P<u;++P){const L=F+P*f;if(L<0||L>=c.inDepth)continue;const E=P*N[0],B=A+L*C[1];for(let q=0;q<c.outHeight;++q){const Y=U+q*v.strides[2],Q=q*c.strideHeight-b;for(let J=0;J<h;++J){const et=Q+J*p;if(et<0||et>=c.inHeight)continue;const nt=E+J*N[1],rt=B+et*C[2];for(let ht=0;ht<c.outWidth;++ht){const vt=Y+ht*c.outChannels,wt=ht*c.strideWidth-y;for(let Tt=0;Tt<d;++Tt){const _t=wt+Tt*g;if(_t<0||_t>=c.inWidth)continue;const Nt=nt+Tt*N[2],qt=rt+_t*c.inChannels;let fe=Nt;for(let Qt=0;Qt<c.inChannels;++Qt){const Xt=w[qt+Qt];for(let le=0;le<c.outChannels;++le)I[vt+le]+=Xt*k[fe+le];fe+=c.outChannels}}}}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const ngt={kernelName:um,backendName:"cpu",kernelFunc:egt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sgt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:i}=t,{strides:o,pad:a,filterShape:l}=s;mt([r,i],"conv3dBackpropFilterV2");const c=bt(r.shape),u=bt(i.shape),h=Wa(r.shape,l,o,1,a),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,g=h.filterDepth,m=h.filterHeight,x=h.filterWidth,y=new Xe(h.filterShape,"float32"),b=y.values,[v,w,k,I]=y.strides,C=n.data.get(i.dataId).values,[N,$,A,R]=u,z=n.data.get(r.dataId).values,[U,F,P,L]=c,E=h.padInfo.front,B=h.padInfo.left,q=h.padInfo.top;for(let Y=0;Y<g;++Y){const Q=Math.max(0,Math.ceil((E-Y)/d)),J=Math.min(h.outDepth,(h.inDepth+E-Y)/d),et=Y*v;for(let nt=0;nt<m;++nt){const rt=Math.max(0,Math.ceil((q-nt)/f)),ht=Math.min(h.outHeight,(h.inHeight+q-nt)/f),vt=nt*w+et;for(let wt=0;wt<x;++wt){const Tt=Math.max(0,Math.ceil((B-wt)/p)),_t=Math.min(h.outWidth,(h.inWidth+B-wt)/p),Nt=wt*k+vt;for(let qt=0;qt<h.inChannels;++qt){const fe=qt*I+Nt;for(let Qt=0;Qt<h.outChannels;++Qt){let Xt=0;for(let le=0;le<h.batchSize;++le){const pe=le*U,Ri=le*N;for(let yn=Q;yn<J;++yn){const Bs=(Y+yn*d-E)*F+pe,Za=yn*$+Ri;for(let Er=rt;Er<ht;++Er){const Ro=(nt+Er*f-q)*P+Bs,Do=Er*A+Za;for(let Oo=Tt;Oo<_t;++Oo){const mw=(wt+Oo*p-B)*L+Ro,gw=Oo*R+Do;Xt+=z[mw+qt]*C[gw+Qt]}}}}b[fe+Qt]=Xt}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const rgt={kernelName:Z1,backendName:"cpu",kernelFunc:sgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function igt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:i}=t,{pad:o,strides:a,inputShape:l}=s;mt([r],"conv3dBackpropInputV2");const c=bt(r.shape),u=bt(i.shape),h=Wa(l,i.shape,a,1,o),d=new Xe(h.inShape,"float32"),f=d.values,[p,g,m,x]=d.strides,y=n.data.get(r.dataId).values,[b,v,w,k]=c,I=n.data.get(i.dataId).values,[C,N,$,A]=u,{batchSize:R,filterDepth:z,filterHeight:U,filterWidth:F,inChannels:P,inDepth:L,inHeight:E,inWidth:B,outChannels:q,outDepth:Y,outHeight:Q,outWidth:J,strideDepth:et,strideHeight:nt,strideWidth:rt}=h,ht=z-1-h.padInfo.front,vt=U-1-h.padInfo.top,wt=F-1-h.padInfo.left;for(let Tt=0;Tt<R;++Tt)for(let _t=0;_t<P;++_t)for(let Nt=0;Nt<L;++Nt){const qt=Nt-ht,fe=Math.max(0,Math.ceil(qt/et)),Qt=Math.min(Y,(z+qt)/et);for(let Xt=0;Xt<E;++Xt){const le=Xt-vt,pe=Math.max(0,Math.ceil(le/nt)),Ri=Math.min(Q,(U+le)/nt);for(let yn=0;yn<B;++yn){const Ao=yn-wt,Bs=Math.max(0,Math.ceil(Ao/rt)),Za=Math.min(J,(F+Ao)/rt);let Er=0;for(let Di=fe;Di<Qt;++Di){const Ro=Di*et-qt;for(let Do=pe;Do<Ri;++Do){const Oo=Do*nt-le;for(let Nd=Bs;Nd<Za;++Nd){const mw=Nd*rt-Ao,gw=b*Tt+v*Di+w*Do+k*Nd,Dj=C*(z-1-Ro)+N*(U-1-Oo)+$*(F-1-mw)+A*_t;for(let Ug=0;Ug<q;++Ug){const Oj=y[gw+Ug],Pj=I[Dj+Ug];Er+=Oj*Pj}}}}f[p*Tt+g*Nt+m*Xt+x*yn+_t]=Er}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const ogt={kernelName:Q1,backendName:"cpu",kernelFunc:igt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const agt=Zt(bh,e=>Math.cos(e)),lgt={kernelName:bh,backendName:"cpu",kernelFunc:agt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cgt=Zt(vh,e=>Math.cosh(e)),ugt={kernelName:vh,backendName:"cpu",kernelFunc:cgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hgt(e){const{inputs:t,backend:n,attrs:s}=e,{image:r,boxes:i,boxInd:o}=t,{cropSize:a,method:l,extrapolationValue:c}=s,[u,h,d,f]=r.shape,p=i.shape[0],[g,m]=a,x=Et([p,g,m,f],"float32"),y=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,v=n.data.get(r.dataId).values,w=bt(r.shape),k=bt(x.shape);for(let I=0;I<p;I++){const C=I*4,N=y[C],$=y[C+1],A=y[C+2],R=y[C+3],z=b[I];if(z>=u)continue;const U=g>1?(A-N)*(h-1)/(g-1):0,F=m>1?(R-$)*(d-1)/(m-1):0;for(let P=0;P<g;P++){const L=g>1?N*(h-1)+P*U:.5*(N+A)*(h-1);if(L<0||L>h-1){for(let E=0;E<m;E++)for(let B=0;B<f;B++){const q=B+E*k[2]+P*k[1]+I*k[0];x.values[q]=c}continue}if(l==="bilinear"){const E=Math.floor(L),B=Math.ceil(L),q=L-E;for(let Y=0;Y<m;Y++){const Q=m>1?$*(d-1)+Y*F:.5*($+R)*(d-1);if(Q<0||Q>d-1){for(let rt=0;rt<f;rt++){const ht=rt+Y*k[2]+P*k[1]+I*k[0];x.values[ht]=c}continue}const J=Math.floor(Q),et=Math.ceil(Q),nt=Q-J;for(let rt=0;rt<f;rt++){let ht=rt+J*w[2]+E*w[1]+z*w[0];const vt=v[ht];ht=rt+et*w[2]+E*w[1]+z*w[0];const wt=v[ht];ht=rt+J*w[2]+B*w[1]+z*w[0];const Tt=v[ht];ht=rt+et*w[2]+B*w[1]+z*w[0];const _t=v[ht],Nt=vt+(wt-vt)*nt,qt=Tt+(_t-Tt)*nt;ht=rt+Y*k[2]+P*k[1]+I*k[0],x.values[ht]=Nt+(qt-Nt)*q}}}else for(let E=0;E<m;++E){const B=m>1?$*(d-1)+E*F:.5*($+R)*(d-1);if(B<0||B>d-1){for(let Q=0;Q<f;Q++){const J=Q+E*k[2]+P*k[1]+I*k[0];x.values[J]=c}continue}const q=Math.round(B),Y=Math.round(L);for(let Q=0;Q<f;Q++){const J=Q+q*w[2]+Y*w[1]+z*w[0],et=Q+E*k[2]+P*k[1]+I*k[0];x.values[et]=v[J]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const dgt={kernelName:tb,backendName:"cpu",kernelFunc:hgt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fgt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,exclusive:o,reverse:a}=s;mt(r,"cumprod");const l=Ne([i],r.shape.length);let c=r;l!=null&&(c=gs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Be(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=hs(c.dtype,"int32"),d=W1(X(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(x,y)=>x+p-y-1:(x,y)=>x+y;for(let x=0;x<f.length;x+=p)for(let y=0;y<p;y++){const b=g(x,y);if(y===0)d[b]=o?1:f[b];else{const v=g(x,y-1);d[b]=o?f[v]*d[v]:f[b]*d[v]}}const m=n.makeTensorInfo(c.shape,h,d);if(l!=null){const x=Ua(l),y=gs({inputs:{x:m},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),y}return m}const pgt={kernelName:J1,backendName:"cpu",kernelFunc:fgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mgt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,exclusive:o,reverse:a}=s;mt(r,"cumsum");const l=Ne([i],r.shape.length);let c=r;l!=null&&(c=gs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Be(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=hs(c.dtype,"int32"),d=Tn(X(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(x,y)=>x+p-y-1:(x,y)=>x+y;for(let x=0;x<f.length;x+=p)for(let y=0;y<p;y++){const b=g(x,y);if(y===0)d[b]=o?0:f[b];else{const v=g(x,y-1);d[b]=o?f[v]+d[v]:f[b]+d[v]}}const m=n.makeTensorInfo(c.shape,h,d);if(l!=null){const x=Ua(l),y=gs({inputs:{x:m},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),y}return m}const ggt={kernelName:hm,backendName:"cpu",kernelFunc:mgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xgt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:i}=t,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=p$(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=G5(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const ygt={kernelName:eb,backendName:"cpu",kernelFunc:xgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bgt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockSize:i,dataFormat:o}=s;T(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],h=l*i,d=c*i,f=u/(i*i),p=n.data.get(r.dataId).values,g=new Float32Array(a*h*d*f);let m=0;for(let x=0;x<a;++x)for(let y=0;y<h;++y){const b=Math.floor(y/i),v=y%i;for(let w=0;w<d;++w){const k=Math.floor(w/i),I=w%i,C=(v*i+I)*f;for(let N=0;N<f;++N){const A=N+C+u*(k+c*(b+l*x));g[m++]=p[A]}}}return n.makeTensorInfo([a,h,d,f],r.dtype,g)}const vgt={kernelName:nb,backendName:"cpu",kernelFunc:bgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i}=t,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;mt([r,i],"depthwiseConv2DNative");const u=bt(r.shape),h=bt(i.shape);let d=l;d==null&&(d=[1,1]),T(_n(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const f=gn(r.shape,i.shape,o,d,a,c,!0),{filterHeight:p,filterWidth:g,dilationHeight:m,dilationWidth:x,padInfo:y}=f,b=y.left,v=y.top,w=f.outChannels/f.inChannels,k=new Xe(f.outShape,r.dtype),I=n.data.get(r.dataId).values,C=n.data.get(i.dataId).values,N=k.values;for(let $=0;$<f.batchSize;++$){const A=$*u[0],R=$*k.strides[0];for(let z=0;z<f.outHeight;++z){const U=R+z*k.strides[1],F=z*f.strideHeight-v;for(let P=0;P<p;++P){const L=F+P*m;if(L<0||L>=f.inHeight)continue;const E=P*h[0],B=A+L*u[1];for(let q=0;q<f.outWidth;++q){const Y=U+q*k.strides[2],Q=q*f.strideWidth-b;for(let J=0;J<g;++J){const et=Q+J*x;if(et<0||et>=f.inWidth)continue;const nt=E+J*h[1],rt=B+et*f.inChannels;let ht=Y,vt=nt;for(let wt=0;wt<f.inChannels;++wt){const Tt=I[rt+wt];for(let _t=0;_t<w;++_t)N[ht+_t]+=Tt*C[vt+_t];ht+=w,vt+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const wgt={kernelName:dm,backendName:"cpu",kernelFunc:KW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sgt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:i}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;mt([r,i],"depthwiseConv2dNativeBackpropFilter");const h=gn(r.shape,u,o,a,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:g}=h,m=new Xe(h.filterShape,"float32"),x=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,v=n.data.get(r.dataId).values,w=new Xe(r.shape,r.dtype,v),k=n.data.get(i.dataId).values,I=new Xe(i.shape,i.dtype,k);for(let C=0;C<p;++C){const N=Math.max(0,Math.ceil((y-C)/d)),$=Math.min(h.outHeight,(h.inHeight+y-C)/d);for(let A=0;A<g;++A){const R=Math.max(0,Math.ceil((x-A)/f)),z=Math.min(h.outWidth,(h.inWidth+x-A)/f);for(let U=0;U<h.outChannels;++U){const F=Math.trunc(U/b),P=U%b;let L=0;for(let E=0;E<h.batchSize;++E)for(let B=N;B<$;++B){const q=C+B*d-y;for(let Y=R;Y<z;++Y){const Q=A+Y*f-x;L+=w.get(E,q,Q,F)*I.get(E,B,Y,U)}}m.set(L,C,A,F,P)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const kgt={kernelName:sb,backendName:"cpu",kernelFunc:Sgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cgt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:i}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;mt([r,i],"depthwiseConv2DNativeBackpropInput");const h=bt(r.shape),d=bt(i.shape),f=gn(u,i.shape,o,a,l,c,!0),p=new Xe(f.inShape,"float32"),g=p.values,[m,x,y]=p.strides,b=n.data.get(r.dataId).values,[v,w,k]=h,I=n.data.get(i.dataId).values,[C,N,$]=d,{batchSize:A,filterHeight:R,filterWidth:z,inChannels:U,inHeight:F,inWidth:P,outChannels:L,outHeight:E,outWidth:B,strideHeight:q,strideWidth:Y}=f,Q=R-1-f.padInfo.top,J=z-1-f.padInfo.left,et=L/U;for(let nt=0;nt<A;++nt)for(let rt=0;rt<U;++rt)for(let ht=0;ht<F;++ht){const vt=ht-Q,wt=Math.max(0,Math.ceil(vt/q)),Tt=Math.min(E,(R+vt)/q);for(let _t=0;_t<P;++_t){const Nt=_t-J,qt=Math.max(0,Math.ceil(Nt/Y)),fe=Math.min(B,(z+Nt)/Y);let Qt=0;for(let Xt=wt;Xt<Tt;++Xt){const le=Xt*q-vt;for(let pe=qt;pe<fe;++pe){const Ri=pe*Y-Nt,yn=v*nt+w*Xt+k*pe,Ao=C*(R-1-le)+N*(z-1-Ri)+$*rt;for(let Bs=0;Bs<et;++Bs){const Za=rt*et+Bs,Er=b[yn+Za],Di=I[Ao+Bs];Qt+=Er*Di}}}g[m*nt+x*ht+y*_t+rt]=Qt}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Igt={kernelName:rb,backendName:"cpu",kernelFunc:Cgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tgt(e){const{inputs:t,backend:n}=e,{x:s}=t,r=X(s.shape),i=n.data.get(s.dataId).values,o=Et([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Ngt={kernelName:ib,backendName:"cpu",kernelFunc:Tgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _gt={kernelName:fm,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r}=e,{strides:i,pad:o,dilations:a}=n,l=t,c=l.data.get(s.dataId).values,u=s.shape.length,h=l.data.get(r.dataId).values,d=r.shape.length,{batchSize:f,inHeight:p,inWidth:g,inChannels:m,outHeight:x,outWidth:y,padInfo:b,strideHeight:v,strideWidth:w,filterHeight:k,filterWidth:I,dilationHeight:C,dilationWidth:N,outShape:$}=ng(s.shape,r.shape,i,o,"NHWC",a),A=X($),R=$.length,z=Ee(s.dtype,A);for(let F=0;F<f;++F)for(let P=0;P<x;++P){const L=P*v-b.top;for(let E=0;E<y;++E){const B=E*w-b.left;for(let q=0;q<m;++q){let Y=Number.MIN_SAFE_INTEGER;for(let J=0;J<k;++J){const et=L+J*C;if(et>=0&&et<p)for(let nt=0;nt<I;++nt){const rt=B+nt*N;if(rt>=0&&rt<g){const ht=Ur([F,et,rt,q],u,bt(s.shape)),vt=Ur([J,nt,q],d,bt(r.shape)),wt=c[ht]+h[vt];wt>Y&&(Y=wt)}}}const Q=Ur([F,P,E,q],R,bt($));z[Q]=Y}}}return{dataId:l.write(Ba(z,s.dtype),$,s.dtype),shape:$,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $gt={kernelName:wy,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r,dy:i}=e,{strides:o,pad:a,dilations:l}=n,c=t,u=Js(s.shape,c.data.get(s.dataId).values),h=Js(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:x,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:w,filterWidth:k,dilationHeight:I,dilationWidth:C,outShape:N}=ng(s.shape,r.shape,o,a,"NHWC",l);T(i.rank===N.length,()=>`Error in ${wy}, dy must have the same rank as output ${N.length}, but got ${i.rank}`);const $=Js(N,c.data.get(i.dataId).values),A=NI(r.shape,r.dtype);for(let z=0;z<d;++z)for(let U=0;U<m;++U){const F=U*b-y.top;for(let P=0;P<x;++P){const L=P*v-y.left;for(let E=0;E<g;++E){let B=Number.MIN_SAFE_INTEGER,q=0,Y=0;for(let Q=0;Q<w;++Q){const J=F+Q*I;if(J>=0&&J<f)for(let et=0;et<k;++et){const nt=L+et*C;if(nt>=0&&nt<p){const rt=u[z][J][nt][E]+h[Q][et][E];rt>B&&(B=rt,q=Q,Y=et)}}}A[q][Y][E]+=$[z][U][P][E]}}}return{dataId:c.write(Ba(A,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Egt={kernelName:vy,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r,dy:i}=e,{strides:o,pad:a,dilations:l}=n,c=t,u=Js(s.shape,c.data.get(s.dataId).values),h=Js(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:x,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:w,filterWidth:k,dilationHeight:I,dilationWidth:C,outShape:N}=ng(s.shape,r.shape,o,a,"NHWC",l);T(i.rank===N.length,()=>`Error in ${vy}, dy must have the same rank as output ${N.length}, but got ${i.rank}`);const $=Js(N,c.data.get(i.dataId).values),A=NI(s.shape,s.dtype);for(let z=0;z<d;++z)for(let U=0;U<m;++U){const F=U*b-y.top;for(let P=0;P<x;++P){const L=P*v-y.left;for(let E=0;E<g;++E){let B=Number.MIN_SAFE_INTEGER,q=F<0?0:F,Y=L<0?0:L;for(let Q=0;Q<w;++Q){const J=F+Q*I;if(J>=0&&J<f)for(let et=0;et<k;++et){const nt=L+et*C;if(nt>=0&&nt<p){const rt=u[z][J][nt][E]+h[Q][et][E];rt>B&&(B=rt,q=J,Y=nt)}}}A[z][q][Y][E]+=$[z][U][P][E]}}}return{dataId:c.write(Ba(A,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Agt(e){const{inputs:t,backend:n,attrs:s}=e,{image:r}=t,{canvas:i,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${u} type.`);const[d,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],g=n.data.get(r.dataId).values,m=r.dtype==="float32"?255:1,x=new Uint8ClampedArray(f*d*4);for(let b=0;b<d*f;++b){const v=[0,0,0,255*c];for(let k=0;k<p;k++){const I=g[b*p+k];if(r.dtype==="float32"){if(I<0||I>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${I}.`)}else if(r.dtype==="int32"&&(I<0||I>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${I}.`);p===1?(v[0]=I*m,v[1]=I*m,v[2]=I*m):v[k]=I*m}const w=b*4;x[w+0]=Math.round(v[0]),x[w+1]=Math.round(v[1]),x[w+2]=Math.round(v[2]),x[w+3]=Math.round(v[3])}i.width=f,i.height=d;const y=new ImageData(x,f,d);return h.putImageData(y,0,0),r}const Rgt={kernelName:ob,backendName:"cpu",kernelFunc:Agt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dg(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s;mt(r,"sum");let a;r.dtype==="bool"?a=Aa({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=_i({inputs:{x:r},backend:n});const l=a.shape.length,c=Dt(i,a.shape),u=Ne(c,l);let h=c,d=a;u!=null&&(d=gs({inputs:{x:a},backend:n,attrs:{perm:u}}),h=Be(h.length,l)),$n("sum",h,d.shape.length);const[f,p]=xn(d.shape,h),g=hs(d.dtype,"int32");let m=By(n,f,g);const x=X(p),y=n.data.get(m.dataId).values,b=n.data.get(d.dataId).values;for(let v=0;v<y.length;++v){const w=v*x;let k=0;for(let I=0;I<x;++I)k+=b[w+I];y[v]=k}if(o){const v=ze(m.shape,c),w=m;m=ae({inputs:{x:m},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(d),m}const Dgt={kernelName:Hm,backendName:"cpu",kernelFunc:Dg};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ogt(e){const{inputs:t,backend:n,attrs:s}=e,{equation:r}=s,i=t,{allDims:o,summedDims:a,idDims:l}=IN(r,i.length);NN(o.length,l,i);const{path:c,steps:u}=_N(a,l),h=u.length;let d=null,f=o.length;const p=[];for(let g=0;g<h;++g){for(const m of u[g]){const{permutationIndices:x,expandDims:y}=TN(f,l[m]);let b;$N(x)?b=i[m]:(b=gs({inputs:{x:i[m]},backend:n,attrs:{perm:x}}),p.push(b));const v=b.shape.slice();for(let w=0;w<y.length;++w)v.splice(y[w],0,1);Pt(b.shape,v)||(b=ae({inputs:{x:b},backend:n,attrs:{shape:v}}),p.push(b)),d===null?d=b:(d=iw({inputs:{a:b,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=Dg({inputs:{x:d},backend:n,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const Pgt={kernelName:ab,backendName:"cpu",kernelFunc:Ogt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fgt(e){const{inputs:t,backend:n}=e,{dy:s,y:r}=t;mt([s,r],"eluGrad");const i=new Float32Array(X(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const Lgt={kernelName:lb,backendName:"cpu",kernelFunc:Fgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mgt=yN,zgt=bN,Bgt=vN,Vgt=wN,Wgt=SN,Ugt=kN,jgt=Zt(kh,e=>{const t=Math.sign(e),n=Math.abs(e),s=1/(1+Mgt*n);return t*(1-((((Ugt*s+Wgt)*s+Vgt)*s+Bgt)*s+zgt)*s*Math.exp(-n*n))}),Ggt={kernelName:kh,backendName:"cpu",kernelFunc:jgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uy(e){const{inputs:t,backend:n,attrs:s}=e,{input:r}=t,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(T(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),ae({inputs:{x:r},backend:n,attrs:{shape:a}})}const Hgt={kernelName:mm,backendName:"cpu",kernelFunc:Uy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kgt=We((e,t)=>e/t),v$=sn(wh,Kgt),Dk={kernelName:wh,backendName:"cpu",kernelFunc:v$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(e,t,n){const s=e.shape,r=s[0],i=s[1],o=n.data.get(e.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=X(c),h=fn("float32",u),d=fn("float32",u);for(let m=0;m<r;m++){const x=hc({inputs:{x:a},backend:n,attrs:{begin:[m,0],size:[1,i]}}),y=hc({inputs:{x:l},backend:n,attrs:{begin:[m,0],size:[1,i]}}),b=Ts({inputs:{real:x,imag:y},backend:n}),{real:v,imag:w}=qgt(b,t,n),k=yo(v,w);for(let I=0;I<i;I++){const C=CN(k,I);h[m*i+I]=C.real,d[m*i+I]=C.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(c,"float32",h),p=n.makeTensorInfo(c,"float32",d),g=Ts({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}function qgt(e,t,n){const s=X(e.shape),r=n.data.get(e.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(Xgt(s)){const a=Ok(i,o,s,t,n),l=[e.shape[0],e.shape[1]];if(t){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),h=n.makeTensorInfo([],"float32",So(s,"float32")),d=_i({inputs:{x:h},backend:n}),f=Dk.kernelFunc({inputs:{a:c,b:h},backend:n}),p=Dk.kernelFunc({inputs:{a:u,b:d},backend:n}),g=n.data.get(f.dataId).values,m=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:g,imag:m}}return a}else{const a=yo(i,o),l=Ygt(a,s,t);return BB(l)}}function Xgt(e){return(e&e-1)===0}function Ok(e,t,n,s,r){if(n===1)return{real:e,imag:t};const i=yo(e,t),o=n/2,a=VB(i),l=a.real,c=a.imag,u=[l.length],h=r.makeTensorInfo(u,"float32",l),d=r.makeTensorInfo(u,"float32",c),f=Ts({inputs:{real:h,imag:d},backend:r}),p=WB(i),g=p.real,m=p.imag,x=[g.length],y=r.makeTensorInfo(x,"float32",g),b=r.makeTensorInfo(x,"float32",m),v=Ts({inputs:{real:y,imag:b},backend:r}),w=Ok(l,c,o,s,r),k=w.real,I=w.imag,C=[k.length],N=r.makeTensorInfo(C,"float32",k),$=r.makeTensorInfo(C,"float32",I),A=Ts({inputs:{real:N,imag:$},backend:r}),R=Ok(g,m,o,s,r),z=R.real,U=R.imag,F=[z.length],P=r.makeTensorInfo(F,"float32",z),L=r.makeTensorInfo(F,"float32",U),E=Ts({inputs:{real:P,imag:L},backend:r}),B=jB(n,s),q=[B.real.length],Y=r.makeTensorInfo(q,"float32",B.real),Q=r.makeTensorInfo(q,"float32",B.imag),J=Ts({inputs:{real:Y,imag:Q},backend:r}),et=iw({inputs:{a:J,b:E},backend:r}),nt=Zu({inputs:{a:A,b:et},backend:r}),rt=y$({inputs:{a:A,b:et},backend:r}),ht=uc({inputs:{input:nt},backend:r}),vt=uc({inputs:{input:rt},backend:r}),wt=Qu({inputs:{input:nt},backend:r}),Tt=Qu({inputs:{input:rt},backend:r}),_t=Ju({inputs:[ht,vt],backend:r,attrs:{axis:0}}),Nt=Ju({inputs:[wt,Tt],backend:r,attrs:{axis:0}}),qt=r.data.get(_t.dataId).values,fe=r.data.get(Nt.dataId).values;return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(L),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(Q),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(et),r.disposeIntermediateTensorInfo(nt),r.disposeIntermediateTensorInfo(rt),r.disposeIntermediateTensorInfo(ht),r.disposeIntermediateTensorInfo(wt),r.disposeIntermediateTensorInfo(vt),r.disposeIntermediateTensorInfo(Tt),r.disposeIntermediateTensorInfo(_t),r.disposeIntermediateTensorInfo(Nt),{real:qt,imag:fe}}function Ygt(e,t,n){const s=new Float32Array(t*2);for(let r=0;r<t;r++){let i=0,o=0;for(let a=0;a<t;a++){const l=GB(r*a,t,n),c=CN(e,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=t,o/=t),UB(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zgt(e){const{inputs:t,backend:n}=e,{input:s}=t,r=X(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=ae({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=qW(a,!1,n),c=ae({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Qgt={kernelName:cb,backendName:"cpu",kernelFunc:Zgt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w$(e){const{backend:t,attrs:n}=e,{shape:s,value:r,dtype:i}=n,o=i||Tc(r),a=Ee(o,X(s));return t0t(a,r,o),t.makeTensorInfo(s,o,a)}const Jgt={kernelName:ub,backendName:"cpu",kernelFunc:w$};function t0t(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e0t={kernelName:hb,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,r=n,i=fn(s.dtype,X(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let d=0;d<o;d++){const f=d*l*a*c;for(let p=0;p<a;p++){const g=p*(l*c);for(let m=0;m<l;m++){const x=m*c;for(let y=0;y<c;y++){const b=Math.round(l-m-1),v=f+g+x+y;let w=u[v];if(b>=0&&b<l){const k=b*c,I=f+g+k+y;w=u[I]}i[v]=w}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i,bias:o,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let g=HW({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const m=g;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const x=ae({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=Zu({inputs:{a:g,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else g=Zu({inputs:{a:g,b:o},backend:n});n.disposeIntermediateTensorInfo(m)}if(f){const m=g;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=ae({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=Wy(n,g,f,x,p),n.disposeIntermediateTensorInfo(x)}else g=Wy(n,g,f,a,p);n.disposeIntermediateTensorInfo(m)}return g}const s0t={kernelName:pp,backendName:"cpu",kernelFunc:n0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i,bias:o,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let g=KW({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const m=g;g=Zu({inputs:{a:g,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(f){const m=g;g=Wy(n,g,f,a,p),n.disposeIntermediateTensorInfo(m)}return g}const i0t={kernelName:mp,backendName:"cpu",kernelFunc:r0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0t(e){const{inputs:t,backend:n}=e,{params:s,indices:r}=t,i=X(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,h]=Dv(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const d=n.data.get(r.dataId).values,f=n.bufferSync(s),p=nW(d,f,s.dtype,c,a,u,h,s.shape,i);return n.makeTensorInfo(l,s.dtype,p.values)}const a0t={kernelName:db,backendName:"cpu",kernelFunc:o0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,indices:i}=t,{axis:o,batchDims:a}=s;mt([r,i],"gatherV2");const l=Dt(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let v=0;v<c.length;++v){const w=c[v];T(w<=u-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${u-1}]`)}let h=a;a==null&&(h=0);const d=X(i.shape),f=AN(r,i,l,h),p=ae({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=ae({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),m=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],x=n.bufferSync(g),y=n.bufferSync(p),b=sW(y,x,m);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const c0t={kernelName:xm,backendName:"cpu",kernelFunc:l0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0t(e){const{inputs:t,backend:n}=e,{input:s}=t,r=X(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=ae({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=qW(a,!0,n),c=ae({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const h0t={kernelName:fb,backendName:"cpu",kernelFunc:u0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d0t=Zt(Eh,e=>Number.isFinite(e)?1:0,"bool"),f0t={kernelName:Eh,backendName:"cpu",kernelFunc:d0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p0t=Zt(Ah,e=>Math.abs(e)===1/0?1:0,"bool"),m0t={kernelName:Ah,backendName:"cpu",kernelFunc:p0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g0t=Zt(Rh,e=>Number.isNaN(e)?1:0,"bool"),x0t={kernelName:Rh,backendName:"cpu",kernelFunc:g0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0t(e){const{backend:t,attrs:n}=e,{start:s,stop:r,num:i}=n,o=lW(s,r,i);return t.makeTensorInfo([o.length],"float32",o)}const b0t={kernelName:mb,backendName:"cpu",kernelFunc:y0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v0t=Zt(Oh,e=>Math.log1p(e)),w0t={kernelName:Oh,backendName:"cpu",kernelFunc:v0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S0t=We((e,t)=>e&&t),k0t=sn(Sm,S0t,null,"bool"),C0t={kernelName:Sm,backendName:"cpu",kernelFunc:k0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I0t=Zt(km,e=>e?0:1,"bool"),T0t={kernelName:km,backendName:"cpu",kernelFunc:I0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N0t=We((e,t)=>e||t),_0t=sn(Cm,N0t,null,"bool"),$0t={kernelName:Cm,backendName:"cpu",kernelFunc:_0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{depthRadius:i,bias:o,alpha:a,beta:l}=s;mt(r,"LRN");const c=r.shape[3],u=c-1,h=n.data.get(r.dataId).values,d=X(r.shape),f=new Float32Array(d);function p(g){const m=g%c;let x=g-m+Math.max(0,m-i);const y=g-m+Math.min(m+i,u);let b=0;for(;x<=y;x++){const v=h[x];b+=v*v}return b}for(let g=0;g<d;g++){const m=p(g),x=h[g]*Math.pow(o+a*m,-l);f[g]=x}return n.makeTensorInfo(r.shape,r.dtype,f)}const A0t={kernelName:Im,backendName:"cpu",kernelFunc:E0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,y:i,dy:o}=t,{depthRadius:a,bias:l,alpha:c,beta:u}=s;mt(o,"LRNGrad");const h=X(o.shape),d=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(r.dataId).values,g=n.data.get(i.dataId).values,m=new Float32Array(h),x=h;for(let y=0;y<x;y++){const b=y%d,v=y-b+Math.max(0,b-a),w=y-b+Math.min(d,b+a+1);let k=0;for(let I=v;I<w;I++)k+=Math.pow(p[I],2);k=c*k+l;for(let I=v;I<w;I++){let C=-2*c*u*p[I]*g[y]/k;y===I&&(C+=Math.pow(k,-u)),C*=f[y],m[I]+=C}}return n.makeTensorInfo(o.shape,r.dtype,m)}const D0t={kernelName:gb,backendName:"cpu",kernelFunc:R0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=Dt(i,l);let h=u;const d=Ne(h,c);let f=a.data.get(r.dataId).values;if(d!=null){const v=new Array(c);for(let w=0;w<v.length;w++)v[w]=l[d[w]];f=g$(f,l,r.dtype,d,v),h=Be(h.length,c),l=v}mt(r,"max"),$n("max",h,c);const[p,g]=xn(l,h),m=X(g),x=uW(f,m,p,r.dtype),y=a.write(x,p,r.dtype);let b=p;return o&&(b=ze(p,u)),{dataId:y,shape:b,dtype:r.dtype}}const O0t={kernelName:Tm,backendName:"cpu",kernelFunc:XW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;mt(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;T(_n(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Nr(r.shape,i,o,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&Pt(u.inShape,u.outShape))h=_i({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,f=bt(r.shape),p=b$(d,r.shape,r.dtype,f,u,"max");h=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return h}const F0t={kernelName:Nm,backendName:"cpu",kernelFunc:P0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;mt(r,"maxPool3d");const u=ko(r.shape,i,o,1,a,l,c),h=n.data.get(r.dataId).values,d=GW(h,r.shape,r.dtype,bt(r.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const M0t={kernelName:_m,backendName:"cpu",kernelFunc:L0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0t(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:i}=t,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;mt([r,i],"maxPool3DGrad");const u=ko(i.shape,o,a,1,l,c),h=n.bufferSync(i),d=Nmt(h,u),f=u.strideDepth,p=u.strideHeight,g=u.strideWidth,m=u.dilationDepth,x=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,v=u.effectiveFilterHeight,w=u.effectiveFilterWidth,k=b-1-u.padInfo.front,I=w-1-u.padInfo.left,C=v-1-u.padInfo.top,N=Et(i.shape,"float32"),$=n.bufferSync(r);for(let A=0;A<u.batchSize;++A)for(let R=0;R<u.inChannels;++R)for(let z=0;z<u.inDepth;++z)for(let U=0;U<u.inHeight;++U)for(let F=0;F<u.inWidth;++F){const P=z-k,L=U-C,E=F-I;let B=0;for(let q=0;q<b;q+=m){const Y=(P+q)/f;if(!(Y<0||Y>=u.outDepth||Math.floor(Y)!==Y))for(let Q=0;Q<v;Q+=x){const J=(L+Q)/p;if(!(J<0||J>=u.outHeight||Math.floor(J)!==J))for(let et=0;et<w;et+=y){const nt=(E+et)/g;if(nt<0||nt>=u.outWidth||Math.floor(nt)!==nt)continue;const rt=b*v*w-1-d.get(A,Y,J,nt,R),ht=q*v*w+Q*w+et,vt=rt===ht?1:0;if(vt===0)continue;const wt=$.get(A,Y,J,nt,R);B+=wt*vt}}}N.set(B,A,z,U,F,R)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const B0t={kernelName:yb,backendName:"cpu",kernelFunc:z0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0t(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:i,output:o}=t,a=i;mt([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=Nr(a.shape,l,c,1,u,h),f=n.data.get(a.dataId).values,p=Et(d.outShape,a.dtype,jW(f,a.shape,a.dtype,d).values),g=d.strideHeight,m=d.strideWidth,x=d.dilationHeight,y=d.dilationWidth,b=d.effectiveFilterHeight,v=d.effectiveFilterWidth,w=v-1-d.padInfo.left,k=b-1-d.padInfo.top,I=Et(a.shape,"float32"),C=n.data.get(r.dataId).values,N=Et(r.shape,"float32",C);for(let $=0;$<d.batchSize;++$)for(let A=0;A<d.inChannels;++A)for(let R=0;R<d.inHeight;++R)for(let z=0;z<d.inWidth;++z){const U=R-k,F=z-w;let P=0;for(let L=0;L<b;L+=x){const E=(U+L)/g;if(!(E<0||E>=d.outHeight||Math.floor(E)!==E))for(let B=0;B<v;B+=y){const q=(F+B)/m;if(q<0||q>=d.outWidth||Math.floor(q)!==q)continue;const Y=b*v-1-p.get($,E,q,A),Q=L*v+B,J=Y===Q?1:0;if(J===0)continue;const et=N.get($,E,q,A);P+=et*J}}I.set(P,$,R,z,A)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const W0t={kernelName:xb,backendName:"cpu",kernelFunc:V0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U0t(e,t,n,s,r){const i=bt(t),o=b$(e,t,n,i,r,"max"),a=jW(e,t,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j0t={kernelName:bb,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:s}=e,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=t,l=n;mt(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=Nr(s.shape,r,i,[1,1],o),[h,d]=U0t(c,s.shape,s.dtype,a,u),f=l.write(h,u.outShape,s.dtype),p=l.write(d,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s,a=Dt(i,r.shape),c=xn(r.shape,a)[1],u=X(c),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));h.push(d);const f=Aa({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});h.push(f);const p=v$({inputs:{a:f,b:d},backend:n});h.push(p);const g=Dg({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return h.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}const H0t={kernelName:$m,backendName:"cpu",kernelFunc:G0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s;mt(r,"min");const a=Dt(i,r.shape);let l=a;const c=Ne(l,r.shape.length);let u=r;c!=null&&(u=gs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Be(l.length,r.shape.length)),$n("min",l,u.shape.length);const[h,d]=xn(u.shape,l),f=X(d),p=Tn(X(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let b=g[y];for(let v=0;v<f;++v){const w=g[y+v];(Number.isNaN(w)||w<b)&&(b=w)}p[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const x=ze(h,a),y=ae({inputs:{x:m},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(m),y}return m}const q0t={kernelName:Em,backendName:"cpu",kernelFunc:K0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X0t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:i,mode:o}=s;mt(r,"mirrorPad");const a=i.map((b,v)=>b[0]+r.shape[v]+b[1]),l=i.map(b=>b[0]),c=i.map((b,v)=>b[0]+r.shape[v]),u=o==="reflect"?0:1,h=n.data.get(r.dataId).values,d=r.shape.length,f=bt(r.shape),p=X(a),g=a.length,m=bt(a),x=fn(r.dtype,p);for(let b=0;b<p;b++){let v=Nc(b,g,m);for(let k=0;k<g;k++)v[k]<l[k]?v[k]=l[k]*2-v[k]-u:v[k]>=c[k]&&(v[k]=(c[k]-1)*2-v[k]+u);v=v.map((k,I)=>k-l[I]);const w=Ur(v,d,f);x[b]=h[w]}return{dataId:n.write(x,a,r.dtype),shape:a,dtype:r.dtype}}const Y0t={kernelName:Am,backendName:"cpu",kernelFunc:X0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z0t=We((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),Q0t=sn(Lh,Z0t),J0t={kernelName:Lh,backendName:"cpu",kernelFunc:Q0t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Dt([a],r.shape),c=XW({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=ze(c.shape,l),h=ae({inputs:{x:c},backend:n,attrs:{shape:u}}),d=y$({inputs:{a:r,b:h},backend:n}),f=Q5({inputs:{x:d},backend:n}),p=Dg({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),g=ae({inputs:{x:p},backend:n,attrs:{shape:u}}),m=v$({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const txt={kernelName:Xm,backendName:"cpu",kernelFunc:YW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ext(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{numSamples:i,seed:o,normalized:a}=s;mt(r,"multinomial");const l=a?r:YW({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,d=[c,i],f=Tn(X(d),"int32");for(let p=0;p<c;++p){const g=p*u,m=new Float32Array(u-1);m[0]=h[g];for(let b=1;b<m.length;++b)m[b]=m[b-1]+h[g+b];const x=ud.alea(o.toString()),y=p*i;for(let b=0;b<i;++b){const v=x();f[y+b]=m.length;for(let w=0;w<m.length;w++)if(v<m[w]){f[y+b]=w;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",f)}const nxt={kernelName:vb,backendName:"cpu",kernelFunc:ext};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sxt=$v;function rxt(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:i}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;mt(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:h}=sxt(c,u,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const ixt={kernelName:wb,backendName:"cpu",kernelFunc:rxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oxt=Ev;function axt(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:i}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;mt(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:f}=oxt(u,h,o,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const lxt={kernelName:Sb,backendName:"cpu",kernelFunc:axt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cxt=Av;function uxt(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:i}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;mt(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,d=o,f=a,p=l,g=c,{selectedIndices:m,selectedScores:x}=cxt(u,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const hxt={kernelName:kb,backendName:"cpu",kernelFunc:uxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dxt(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r}=t,{dtype:i,depth:o,onValue:a,offValue:l}=s;mt(r,"oneHot");const c=X(r.shape),u=new Float32Array(c*o);u.fill(l);const h=n.data.get(r.dataId).values;for(let d=0;d<c;++d)h[d]>=0&&h[d]<o&&(u[d*o+h[d]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const fxt={kernelName:Pm,backendName:"cpu",kernelFunc:dxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jy(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=uc({inputs:{input:s},backend:n}),i=jy({inputs:{x:r},backend:n}),o=Qu({inputs:{input:s},backend:n}),a=jy({inputs:{x:o},backend:n}),l=Ts({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return w$({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const pxt={kernelName:Jm,backendName:"cpu",kernelFunc:jy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=uc({inputs:{input:s},backend:n}),i=ZW({inputs:{x:r},backend:n}),o=Qu({inputs:{input:s},backend:n}),a=jy({inputs:{x:o},backend:n}),l=Ts({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return w$({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const mxt={kernelName:Om,backendName:"cpu",kernelFunc:ZW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s;if(t.length===1)return Uy({inputs:{input:t[0]},backend:n,attrs:{dim:r}});const i=t[0].shape,o=t[0].dtype;t.forEach(u=>{Nn(i,u.shape,"All tensors passed to stack must have matching shapes"),T(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=t.map(u=>{const h=Uy({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(h),h}),c=Ju({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const gxt={kernelName:Fm,backendName:"cpu",kernelFunc:QW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xxt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:i,constantValue:o}=s;mt(r,"pad");const a=i.map((y,b)=>y[0]+r.shape[b]+y[1]),l=i.map(y=>y[0]),c=n.data.get(r.dataId).values,u=X(r.shape),h=r.shape.length,d=bt(r.shape),f=X(a),p=a.length,g=bt(a),m=fn(r.dtype,f);o!==0&&m.fill(o);for(let y=0;y<u;y++){const v=Nc(y,h,d).map((k,I)=>k+l[I]),w=Ur(v,p,g);m[w]=c[y]}return{dataId:n.write(m,a,r.dtype),shape:a,dtype:r.dtype}}const JW={kernelName:Lm,backendName:"cpu",kernelFunc:xxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yxt=We((e,t)=>Math.pow(e,t)),bxt=sn(zh,yxt),vxt={kernelName:zh,backendName:"cpu",kernelFunc:bxt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wxt(e){const{inputs:t,backend:n,attrs:s}=e,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=t,a=r.map(m=>n.data.get(m.dataId).values),l=r.map(m=>m.shape),c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[h,d,f]=gW(a,l,c,i.shape,i.dtype,u,o.shape),p=h.map(m=>n.makeTensorInfo([m.length],"int32",m)),g=n.makeTensorInfo(f,i.dtype,d);return p.concat([g])}const Sxt={kernelName:Cb,backendName:"cpu",kernelFunc:wxt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kxt(e){const{inputs:t,backend:n}=e,{starts:s,limits:r,deltas:i}=t,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=xW(o,s.shape,s.dtype,a,r.shape,l,i.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],s.dtype,u);return[h,d]}const Cxt={kernelName:Ib,backendName:"cpu",kernelFunc:kxt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ixt(e){const{inputs:t,backend:n,attrs:s}=e,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,d=a.map(m=>n.data.get(m.dataId).values),f=a.map(m=>m.shape),[p,g]=yW(c,r.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,g)}const Txt={kernelName:Tb,backendName:"cpu",kernelFunc:Ixt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxt(e){const{backend:t,attrs:n}=e,{start:s,stop:r,dtype:i,step:o}=n,a=bW(s,r,o,i);return t.makeTensorInfo([a.length],i,a)}const _xt={kernelName:Nb,backendName:"cpu",kernelFunc:Nxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $xt=Zt(Bh,e=>1/e),Ext={kernelName:Bh,backendName:"cpu",kernelFunc:$xt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Axt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:o,size:a}=s;mt(r,"resizeBilinear");const l=bt(r.shape),[c,u]=a,[h,d,f,p]=r.shape,g=n.data.get(r.dataId).values,m=new Float32Array(X([h,c,u,p])),x=[i&&c>1?d-1:d,i&&u>1?f-1:f],y=[i&&c>1?c-1:c,i&&u>1?u-1:u];let b=0;const v=x[0]/y[0],w=x[1]/y[1];for(let k=0;k<h;k++)for(let I=0;I<c;I++){let C;o?C=v*(I+.5)-.5:C=v*I;const N=Math.max(0,Math.floor(C)),$=C-N,A=Math.min(d-1,Math.ceil(C)),R=k*l[0]+N*l[1],z=k*l[0]+A*l[1];for(let U=0;U<u;U++){let F;o?F=w*(U+.5)-.5:F=w*U;const P=Math.max(0,Math.floor(F)),L=F-P,E=Math.min(f-1,Math.ceil(F)),B=R+P*l[2],q=z+P*l[2],Y=R+E*l[2],Q=z+E*l[2];for(let J=0;J<p;J++){const et=g[B+J],nt=g[q+J],rt=g[Y+J],ht=g[Q+J],vt=et+(rt-et)*L,wt=nt+(ht-nt)*L,Tt=vt+(wt-vt)*$;m[b++]=Tt}}}return n.makeTensorInfo([h,c,u,p],"float32",m)}const Rxt={kernelName:Wm,backendName:"cpu",kernelFunc:Axt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:i}=t,{alignCorners:o}=s;mt([i,r],"resizeBilinearGrad");const a=bt(r.shape),[l,c,u,h]=r.shape,[,d,f]=i.shape,p=new Float32Array(l*c*u*h),g=[o&&d>1?c-1:c,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],x=g[0]/m[0],y=g[1]/m[1],b=n.data.get(i.dataId).values;let v=0;for(let w=0;w<l;w++){const k=w*a[0];for(let I=0;I<d;I++){const C=I*x,N=Math.floor(C),$=Math.min(Math.ceil(C),c-1),A=k+N*a[1],R=k+$*a[1],z=C-N,U=1-z;for(let F=0;F<f;F++){const P=F*y,L=Math.floor(P),E=Math.min(Math.ceil(P),u-1),B=P-L,q=1-B,Y=A+L*a[2],Q=A+E*a[2],J=R+L*a[2],et=R+E*a[2],nt=U*q,rt=U*B,ht=z*q,vt=z*B;for(let wt=0;wt<h;wt++){const Tt=b[v++];p[Y+wt]+=Tt*nt,p[Q+wt]+=Tt*rt,p[J+wt]+=Tt*ht,p[et+wt]+=Tt*vt}}}}return n.makeTensorInfo([l,u,c,h],"float32",p)}const Oxt={kernelName:Eb,backendName:"cpu",kernelFunc:Dxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:o,size:a}=s;mt(r,"resizeNearestNeighbor");const l=bt(r.shape),[c,u]=a,[h,d,f,p]=r.shape,g=n.data.get(r.dataId).values,m=new Float32Array(h*c*u*p),x=[i&&c>1?d-1:d,i&&u>1?f-1:f],y=[i&&c>1?c-1:c,i&&u>1?u-1:u],b=x[0]/y[0],v=x[1]/y[1];let w=0;for(let k=0;k<h;k++){const I=k*l[0];for(let C=0;C<c;C++){const N=o?b*(C+.5):b*C;let $=Math.min(d-1,i?Math.round(N):Math.floor(N));o&&($=Math.max(0,$));const A=I+$*l[1];for(let R=0;R<u;R++){const z=o?v*(R+.5):v*R;let U=Math.min(f-1,i?Math.round(z):Math.floor(z));o&&(U=Math.max(0,U));const F=A+U*l[2];for(let P=0;P<p;P++){const L=g[F+P];m[w++]=L}}}}return n.makeTensorInfo([h,c,u,p],r.dtype,m)}const Fxt={kernelName:Vm,backendName:"cpu",kernelFunc:Pxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lxt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:i}=t,{alignCorners:o}=s;mt([i,r],"resizeNearestNeighborGrad");const a=bt(r.shape),l=bt(i.shape),[c,u,h,d]=r.shape,[,f,p]=i.shape,g=new Float32Array(c*u*h*d),m=n.data.get(i.dataId).values,x=[o&&f>1?u-1:u,o&&p>1?h-1:h],y=[o&&f>1?f-1:f,o&&p>1?p-1:p],b=x[0]/y[0],v=x[1]/y[1],w=1/b,k=1/v,I=Math.ceil(w)*2+2,C=Math.ceil(k)*2+2;for(let N=0;N<c;N++){const $=N*a[0];for(let A=0;A<u;A++){const R=$+A*a[1],z=Math.floor(A*w),U=Math.floor(z-I/2);for(let F=0;F<h;F++){const P=R+F*a[2],L=Math.floor(F*k),E=Math.floor(L-C/2);for(let B=0;B<d;B++){let q=0;for(let Y=0;Y<I;Y++){const Q=Y+U;if(Q<0||Q>=f)continue;const J=$+Q*l[1],et=Q*b,nt=Math.min(u-1,o?Math.round(et):Math.floor(et));if(A===nt)for(let rt=0;rt<C;rt++){const ht=rt+E;if(ht<0||ht>=p)continue;const vt=J+ht*l[2],wt=ht*v,Tt=Math.min(h-1,o?Math.round(wt):Math.floor(wt));F===Tt&&(q+=m[vt+B])}}g[P+B]=q}}}}return n.makeTensorInfo(r.shape,r.dtype,g)}const Mxt={kernelName:$b,backendName:"cpu",kernelFunc:Lxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zxt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dims:i}=s;mt(r,"reverse");const o=r.shape.length,a=Dt(i,r.shape);if(o===0)return _i({inputs:{x:r},backend:n});const l=new Xe(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const h=l.indexToLoc(u),d=h.slice();a.forEach(f=>d[f]=r.shape[f]-1-d[f]),l.set(c.get(...d),...h)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Bxt={kernelName:Um,backendName:"cpu",kernelFunc:zxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vxt={kernelName:Kb,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,{radians:r,fillValue:i,center:o}=t,a=n,l=fn(s.dtype,X(s.shape)),[c,u,h,d]=s.shape,[f,p]=mN(o,u,h),g=255,m=Math.sin(r),x=Math.cos(r),y=a.data.get(s.dataId).values;for(let v=0;v<c;v++){const w=v*h*u*d;for(let k=0;k<u;k++){const I=k*(h*d);for(let C=0;C<h;C++){const N=C*d;for(let $=0;$<d;$++){const A=[c,k,C,$],R=A[2],z=A[1];let U=(R-f)*x-(z-p)*m,F=(R-f)*m+(z-p)*x;U=Math.round(U+f),F=Math.round(F+p);let P=i;if(typeof i!="number"&&($===3?P=g:P=i[$]),U>=0&&U<h&&F>=0&&F<u){const E=F*(h*d),B=U*d,q=w+E+B+$;P=y[q]}const L=w+I+N+$;l[L]=P}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wxt=Zt(Uh,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),Uxt={kernelName:Uh,backendName:"cpu",kernelFunc:Wxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jxt(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r,updates:i}=t,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Ka(i,r,o),d=!0,f=n.bufferSync(r),p=n.bufferSync(i),g=Tl(f,p,o,h,c,l,a,u,0,d);return n.makeTensorInfo(o,g.dtype,g.values)}const Gxt={kernelName:Ab,backendName:"cpu",kernelFunc:jxt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxt(e,t){let n=0,s=e.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),e[r]<t?n=r+1:s=r;return s}function Kxt(e,t){let n=0,s=e.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),e[r]<=t?n=r+1:s=r;return s}function qxt(e,t,n,s,r,i){const o=Ee("int32",n*r);for(let a=0;a<n;++a){const l=e.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?Hxt(l,t[u+c]):Kxt(l,t[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xxt(e){const{inputs:t,backend:n,attrs:s}=e,{sortedSequence:r,values:i}=t,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=qxt(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const Yxt={kernelName:Db,backendName:"cpu",kernelFunc:Xxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zxt(e){const{inputs:t,backend:n}=e,{condition:s,t:r,e:i}=t;mt([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=hs(r.dtype,i.dtype),h=Tn(X(r.shape),u);let d=0;const f=o===0||o>1||r.shape.length===1?1:X(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let g=0;g<f;g++)a[p]===1?h[d++]=l[p]:h[d++]=c[p];return n.makeTensorInfo(r.shape,u,h)}const Qxt={kernelName:jm,backendName:"cpu",kernelFunc:Zxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jxt=Fv,tyt=Lv,eyt=Zt(Gh,e=>e>=0?tyt*e:Jxt*(Math.exp(e)-1)),nyt={kernelName:Gh,backendName:"cpu",kernelFunc:eyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const syt=Zt(qh,e=>e<0?-1:e>0?1:0),ryt={kernelName:qh,backendName:"cpu",kernelFunc:syt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iyt=Zt(Hh,e=>Math.sin(e)),oyt={kernelName:Hh,backendName:"cpu",kernelFunc:iyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ayt=Zt(Kh,e=>Math.sinh(e)),lyt={kernelName:Kh,backendName:"cpu",kernelFunc:ayt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cyt=11920928955078125e-23,lO=Math.log(cyt)+2,uyt=Zt(Yh,e=>{const t=e>-lO,n=e<lO,s=Math.exp(e);let r;return n?r=s:t?r=e:r=Math.log(1+s),r}),hyt={kernelName:Yh,backendName:"cpu",kernelFunc:uyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dyt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:i,paddings:o}=s;mt([r],"spaceToBatchND");const a=X(i),l=[[0,0]];l.push(...o);for(let k=1+i.length;k<r.shape.length;++k)l.push([0,0]);const c=JW.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=vg(c.shape,i,a,!1),h=wg(u.length,i.length,!1),d=Sg(c.shape,i,a,!1),g=ae({inputs:{x:c},backend:n,attrs:{shape:u}}),y=gs({inputs:{x:g},backend:n,attrs:{perm:h}}),w=ae({inputs:{x:y},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),w}const fyt={kernelName:Km,backendName:"cpu",kernelFunc:dyt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pyt(e){const{inputs:t,backend:n}=e,{indices:s,values:r,denseShape:i,defaultValue:o}=t;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[h,d,f,p,g]=kW(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const myt={kernelName:Ob,backendName:"cpu",kernelFunc:pyt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gyt(e){const{inputs:t,backend:n}=e,{inputIndices:s,inputShape:r,newShape:i}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,h]=CW(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const xyt={kernelName:Pb,backendName:"cpu",kernelFunc:gyt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yyt(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:i}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=x$(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const byt={kernelName:Fb,backendName:"cpu",kernelFunc:yyt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vyt(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:i}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=x$(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const wyt={kernelName:Lb,backendName:"cpu",kernelFunc:vyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Syt(e){const{inputs:t,backend:n,attrs:s}=e,{sparseIndices:r,sparseValues:i,defaultValue:o}=t,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=Ka(i,r,a),f=!1,p=n.bufferSync(r);let g;switch(i.dtype){case"bool":{const m=n.bufferSync(i),x=!!n.data.get(o.dataId).values[0];g=Tl(p,m,a,d,u,c,l,h,x,f);break}case"float32":{const m=n.bufferSync(i),x=n.data.get(o.dataId).values[0];g=Tl(p,m,a,d,u,c,l,h,x,f);break}case"int32":{const m=n.bufferSync(i),x=n.data.get(o.dataId).values[0];g=Tl(p,m,a,d,u,c,l,h,x,f);break}case"string":{const m=n.bufferSync(i),x=po(n.data.get(o.dataId).values[0]);g=Tl(p,m,a,d,u,c,l,h,x,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const kyt={kernelName:Mb,backendName:"cpu",kernelFunc:Syt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cyt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{numOrSizeSplits:i,axis:o}=s,a=Dt(o,r.shape)[0],l=EN(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(h=>{const d=[...u];d[a]=h;const f=hc({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});return c[a]+=h,f})}const Iyt={kernelName:qm,backendName:"cpu",kernelFunc:Cyt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tyt={kernelName:zb,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,s=t;mt(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nyt=Zt(sd,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),_yt={kernelName:sd,backendName:"cpu",kernelFunc:Nyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $yt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s;mt(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:x,begin:y,end:b,strides:v}=hN(r.shape,i,o,a,l,c,u,h,d);let w;if(g)w=ae({inputs:{x:r},backend:n,attrs:{shape:p}});else if(m||x){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const k=lN(y,b,v),I=hc({inputs:{x:r},backend:n,attrs:{begin:y,size:k}});w=ae({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else{const k=n.bufferSync(r),I=NW(f,k,v,y);w=n.makeTensorInfo(p,I.dtype,I.values)}return w}const Eyt={kernelName:Bb,backendName:"cpu",kernelFunc:$yt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ayt(e){const{inputs:t,backend:n,attrs:s}=e,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=t,d=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[p,g]=_W(d,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}const Ryt={kernelName:Vb,backendName:"cpu",kernelFunc:Ayt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dyt(e){const{inputs:t,backend:n,attrs:s}=e,{skipEmpty:r}=s,{input:i,delimiter:o}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,h]=$W(a,l,r),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const Oyt={kernelName:Wb,backendName:"cpu",kernelFunc:Dyt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pyt(e){const{inputs:t,backend:n,attrs:s}=e,{numBuckets:r}=s,{input:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=EW(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const Fyt={kernelName:Ub,backendName:"cpu",kernelFunc:Pyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lyt=Zt(td,e=>Math.tan(e)),Myt={kernelName:td,backendName:"cpu",kernelFunc:Lyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zyt=Zt(ed,e=>Math.tanh(e)),Byt={kernelName:ed,backendName:"cpu",kernelFunc:zyt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vyt(e){const{inputs:t,backend:n}=e,{tensor:s,indices:r,updates:i}=t,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=Ka(i,r,s.shape),h=!1,d=n.bufferSync(r),f=n.bufferSync(i),p=n.bufferSync(s),g=Tl(d,f,s.shape,u,l,a,o,c,p,h);return n.makeTensorInfo(s.shape,g.dtype,g.values)}const Wyt={kernelName:Rb,backendName:"cpu",kernelFunc:Vyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uyt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reps:i}=s;mt(r,"tile");const o=RW(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const jyt={kernelName:nd,backendName:"cpu",kernelFunc:Uyt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gyt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{k:i,sorted:o}=s;mt(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=OW(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const Hyt={kernelName:jb,backendName:"cpu",kernelFunc:Gyt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kyt(e){const{inputs:t,attrs:n,backend:s}=e,{image:r,transforms:i}=t,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,h,d,f]=r.shape,[p,g]=c??[h,d],m=[u,p,g,f],x=bt(r.shape),y=x[0],b=x[1],v=x[2],w=bt(m),k=w[0],I=w[1],C=w[2],N=fn(r.dtype,X(m));N.fill(l);const $=s.data.get(r.dataId).values,A=s.data.get(i.dataId).values;for(let z=0;z<u;++z){const U=i.shape[0]===1?A:A.subarray(z*8,z*8+8);for(let F=0;F<p;++F)for(let P=0;P<g;++P)for(let L=0;L<f;++L){let E;const B=U[6]*P+U[7]*F+1;if(B===0)continue;const q=(U[0]*P+U[1]*F+U[2])/B,Y=(U[3]*P+U[4]*F+U[5])/B,Q=cO(q,d,a),J=cO(Y,h,a);switch(o){case"nearest":E=Jyt($,h,d,y,b,v,z,J,Q,L,l);break;case"bilinear":E=t1t($,h,d,y,b,v,z,J,Q,L,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const et=z*k+F*I+P*C+L;N[et]=E}return s.makeTensorInfo(m,r.dtype,N)}return{dataId:s.write(N,m,r.dtype),shape:r.shape,dtype:r.dtype}}const qyt={kernelName:Gb,backendName:"cpu",kernelFunc:Kyt};function cO(e,t,n){switch(n){case"reflect":return Xyt(e,t);case"wrap":return Yyt(e,t);case"nearest":return Qyt(e,t);case"constant":default:return Zyt(e)}}function Xyt(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const s=2*t;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-t?n+s:-n-1}else if(n>t-1)if(t<=1)n=0;else{const s=2*t;n-=s*Math.trunc(n/s),n>=t&&(n=s-n-1)}return wa(0,n,t-1)}function Yyt(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const s=t-1;n+=t*(Math.trunc(-n/s)+1)}else if(n>t-1)if(t<=1)n=0;else{const s=t-1;n-=t*Math.trunc(n/s)}return wa(0,n,t-1)}function Zyt(e,t){return e}function Qyt(e,t){return wa(0,e,t-1)}function rf(e,t,n,s,r,i,o,a,l,c,u){const h=o*s+a*r+l*i+c;return 0<=a&&a<t&&0<=l&&l<n?e[h]:u}function Jyt(e,t,n,s,r,i,o,a,l,c,u){const h=Math.round(a),d=Math.round(l);return rf(e,t,n,s,r,i,o,h,d,c,u)}function t1t(e,t,n,s,r,i,o,a,l,c,u){const h=Math.floor(a),d=Math.floor(l),f=h+1,p=d+1,g=(p-l)*rf(e,t,n,s,r,i,o,h,d,c,u)+(l-d)*rf(e,t,n,s,r,i,o,h,p,c,u),m=(p-l)*rf(e,t,n,s,r,i,o,f,d,c,u)+(l-d)*rf(e,t,n,s,r,i,o,f,p,c,u);return(f-a)*g+(a-h)*m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1t(e){const{inputs:t,attrs:n,backend:s}=e,{axis:r}=n,{x:i}=t;mt(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=PW(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const n1t={kernelName:Hb,backendName:"cpu",kernelFunc:e1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1t(e){const{inputs:t,backend:n,attrs:s}=e,{value:r}=t;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=r.shape[f]);const u=new Array(o).fill(0),h=r.shape.slice();h[i]=1;const d=new Array(a);for(let f=0;f<d.length;f++){u[i]=f;const p=hc({inputs:{x:r},backend:n,attrs:{begin:u,size:h}});d[f]=ae({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return d}const r1t={kernelName:Zm,backendName:"cpu",kernelFunc:s1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i1t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,segmentIds:i}=t,{numSegments:o}=s;mt(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],h=a-l;let d=i;for(let p=0;p<h;++p){const g=Uy({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=g,u.push(g)}for(let p=0;p<o;++p){const g=So(p,"int32"),m=n.makeTensorInfo([],"int32",g),x=Y5({inputs:{a:m,b:d},backend:n}),y=Aa({inputs:{x},backend:n,attrs:{dtype:"float32"}}),b=iw({inputs:{a:y,b:r},backend:n}),v=Dg({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(v),u.push(m),u.push(x),u.push(y),u.push(b),u.push(v)}const f=QW({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const o1t={kernelName:Qm,backendName:"cpu",kernelFunc:i1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a1t=[emt,Fft,smt,imt,Wft,amt,cmt,hmt,fmt,mmt,xmt,bmt,wmt,Cmt,Tmt,$mt,Amt,Dmt,Pmt,Jpt,Lmt,zmt,Vmt,jft,Umt,Bft,Hft,Gmt,Lft,Kmt,Xmt,Ymt,Qmt,tgt,ngt,rgt,ogt,lgt,ugt,dgt,pgt,ggt,ygt,vgt,wgt,kgt,Igt,Ngt,_gt,$gt,Egt,Rgt,Pgt,Hpt,Lgt,Kft,Ggt,qft,Hgt,Yft,Qgt,Jgt,e0t,Qft,tpt,s0t,i0t,a0t,c0t,npt,rpt,Mft,h0t,qmt,f0t,m0t,x0t,Kpt,opt,lpt,b0t,upt,w0t,C0t,T0t,$0t,A0t,D0t,O0t,dpt,F0t,M0t,B0t,W0t,j0t,H0t,q0t,ppt,Y0t,J0t,nxt,gpt,ypt,ixt,lxt,hxt,vpt,fxt,mxt,gxt,JW,vxt,Xpt,kpt,Sxt,Cxt,Txt,_xt,zft,Dk,Ext,Ypt,Zpt,Qpt,Rxt,Oxt,Fxt,Mxt,Bxt,Vxt,Uxt,Apt,Gxt,Yxt,Qxt,nyt,Dpt,ryt,oyt,lyt,Opt,txt,hyt,fyt,myt,xyt,byt,wyt,kyt,Iyt,Lpt,Tyt,zpt,Vpt,_yt,Eyt,Ryt,Oyt,Fyt,Gpt,Dgt,Myt,Byt,Wyt,jyt,Hyt,qyt,wpt,n1t,r1t,o1t,pxt];for(const e of a1t)qb(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yl={},S0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function t6(e,t){yl[e]=t}function Qr(e,t){if(!(e in yl)||t!=null){const s=c1t(e,t);if(s!==null)yl[e]=s;else return console.log("Could not get context for WebGL version",e),null}const n=yl[e];return n==null||n.isContextLost()?(delete yl[e],Qr(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),yl[e])}function l1t(e){if(!H().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function c1t(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=t??l1t(e);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete yl[e]},!1),H().getBool("SOFTWARE_WEBGL_ENABLED")&&(S0.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",S0)||n.getContext("experimental-webgl",S0):n.getContext("webgl2",S0)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Np;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Np||(Np={}));var Ys;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Ys||(Ys={}));var kn;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(kn||(kn={}));function Og(e,t){return[t,e]}function u1t(e,t){return e*t}function k0(e){const t=X(e),n=Math.ceil(t/4);return xy(n)}function yd(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function h1t(e,t){const[n,s]=yd(e,t);return n*s*4}function S$(e,t){const n=e;let s,r,i,o,a,l,c,u,h,d;return H().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(s=e.RGBA,r=e.RGBA,i=e.RGBA,o=n.RGBA,a=e.RGBA,c=4,u=4,h=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT,l=e.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ct(e,t){const n=t();return H().getBool("DEBUG")&&d1t(e),n}function d1t(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+n6(e,t))}const f1t=596e-10,p1t=65504;function e6(e){return!!(H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||f1t<Math.abs(e)&&Math.abs(e)<p1t)}function n6(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function of(e,t){return $o(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function s6(e,t){const n=$o(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ct(e,()=>e.shaderSource(n,t)),ct(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function r6(e,t){const n=$o(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ct(e,()=>e.shaderSource(n,t)),ct(e,()=>e.compileShader(n)),H().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw k$(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const m1t=/ERROR: [0-9]+:([0-9]+):/g;function k$(e,t){const n=m1t.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}const s=+n[1],r=e.split(`
`),i=r.length.toString().length+2,o=r.map((h,d)=>Rl((d+1).toString(),i)+h);let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${Rl(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function i6(e){return $o(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function o6(e,t){if(ct(e,()=>e.linkProgram(t)),!H().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function ax(e,t){if(ct(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function a6(e,t){const n=$o(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return ct(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),ct(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function l6(e,t){const n=$o(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return ct(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),ct(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function g1t(){return H().getNumber("WEBGL_VERSION")===2?1:4}function c6(e){return $o(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function u6(e,t){const n=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const s=`[${e}x${t}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(e>n||t>n){const s=`[${e}x${t}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function h6(e){return $o(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function Pk(e,t,n,s,r,i,o){const a=e.getAttribLocation(t,n);return a===-1?!1:(ct(e,()=>e.bindBuffer(e.ARRAY_BUFFER,s)),ct(e,()=>e.vertexAttribPointer(a,r,e.FLOAT,!1,i,o)),ct(e,()=>e.enableVertexAttribArray(a)),!0)}function d6(e,t,n){x6(e,n),ct(e,()=>e.activeTexture(e.TEXTURE0+n)),ct(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function x1t(e,t){x6(e,t),ct(e,()=>e.activeTexture(e.TEXTURE0+t)),ct(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function f6(e,t,n){return $o(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function p6(e,t,n){return e.getUniformLocation(t,n)}function m6(e,t,n,s){ct(e,()=>d6(e,t,s)),ct(e,()=>e.uniform1i(n,s))}function y1t(e){ct(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ct(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),ct(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function lx(e,t,n){ct(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),ct(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function Fk(e,t){ct(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),ct(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function af(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+g6(e,t))}function g6(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function $o(e,t,n){const s=ct(e,()=>t());if(s==null)throw new Error(n);return s}function x6(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=t+e.TEXTURE0;if(s<e.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function dc(e,t=2){return X(e.slice(0,e.length-t))}function fc(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function lf(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[dc(e),...fc(e)]),t}function y6(e,t=!1){let n=H().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=H().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&H().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),t&&(n=n*2,s=s*2,e=e.map((a,l)=>l>=e.length-2?V1(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=wo(e).newShape);let r=X(e),i=null;e.length<=1&&r<=n?i=[1,r]:e.length===2&&e[0]<=n&&e[1]<=n?i=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?i=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?i=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?i=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(i=[e[0],e[1]*e[2]*e[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(t?2:1)&&Math.min(...i)>0;if(i==null||o)if(t){const a=dc(e);let l=2,c=2;e.length&&([l,c]=fc(e)),r=a*(l/2)*(c/2),i=xy(r).map(u=>u*2)}else i=xy(r);return i}function C0(e){return e%2===0}function _p(e,t){if(e=e.slice(-2),t=t.slice(-2),Pt(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){const n=e[e.length-1],s=t[t.length-1];if(n===s||C0(n)&&C0(s)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&C0(e[0])&&C0(t[0])}let cx,ux;function b6(e){if(cx==null){const t=Qr(e);cx=t.getParameter(t.MAX_TEXTURE_SIZE)}return cx}function b1t(){cx=null}function v1t(){ux=null}function v6(e){if(ux==null){const t=Qr(e);ux=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ux)}function w6(e){if(e===0)return 0;let t;const n=Qr(e);return Zs(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:Zs(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function Zs(e,t){return e.getExtension(t)!=null}function Lk(e){try{if(Qr(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function S6(e){if(e===0)return!1;const t=Qr(e);if(e===1){if(!Zs(t,"OES_texture_float"))return!1}else if(!Zs(t,"EXT_color_buffer_float"))return!1;return Mk(t)}function k6(e){if(e===0)return!1;const t=Qr(e);if(e===1){if(!Zs(t,"OES_texture_float")||!Zs(t,"WEBGL_color_buffer_float"))return!1}else{if(Zs(t,"EXT_color_buffer_float"))return Mk(t);const s="EXT_color_buffer_half_float";if(Zs(t,s)){const r=t.getExtension(s);return w1t(t,r)}return!1}return Mk(t)}function Mk(e){const t=S$(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(i),o}function w1t(e,t){const n=S$(e,t),s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(s),e.deleteFramebuffer(o),a}function C6(e){return e!==2?!1:Qr(e).fenceSync!=null}function bd(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}const S1t=Object.freeze(Object.defineProperty({__proto__:null,assertNotComplex:bd,bindCanvasToFramebuffer:y1t,bindColorTextureToFramebuffer:lx,bindTextureToProgramUniformSampler:m6,bindTextureUnit:d6,bindVertexBufferToProgramAttribute:Pk,callAndCheck:ct,canBeRepresented:e6,createFragmentShader:r6,createFramebuffer:h6,createProgram:i6,createStaticIndexBuffer:l6,createStaticVertexBuffer:a6,createTexture:c6,createVertexShader:s6,getBatchDim:dc,getExtensionOrThrow:of,getFramebufferErrorMessage:g6,getMaxTexturesInShader:v6,getNumChannels:g1t,getProgramUniformLocation:p6,getProgramUniformLocationOrThrow:f6,getRowsCols:fc,getShapeAs3D:lf,getTextureShapeFromLogicalShape:y6,getWebGLDisjointQueryTimerVersion:w6,getWebGLErrorMessage:n6,getWebGLMaxTextureSize:b6,hasExtension:Zs,isCapableOfRenderingToFloatTexture:S6,isDownloadFloatTextureEnabled:k6,isReshapeFree:_p,isWebGLFenceEnabled:C6,isWebGLVersionEnabled:Lk,linkProgram:o6,logShaderSourceAndInfoLog:k$,resetMaxTextureSize:b1t,resetMaxTexturesInShader:v1t,unbindColorTextureFromFramebuffer:Fk,unbindTextureUnit:x1t,validateFramebuffer:af,validateProgram:ax,validateTextureSize:u6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xt=H();xt.registerFlag("HAS_WEBGL",()=>xt.getNumber("WEBGL_VERSION")>0);xt.registerFlag("WEBGL_VERSION",()=>Lk(2)?2:Lk(1)?1:0);xt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);xt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>xt.get("WEBGL_VERSION")===2);xt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);xt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);xt.registerFlag("WEBGL_PACK",()=>xt.getBool("HAS_WEBGL"));xt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_CLIP",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_REDUCE",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_LAZILY_UNPACK",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_CONV_IM2COL",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>b6(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>v6(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=xt.getNumber("WEBGL_VERSION");return e===0?0:w6(e)});xt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>xt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!RI());xt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>S6(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>xt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:xt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));xt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>k6(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>C6(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>xt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);xt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});xt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>RI()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});xt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);xt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);xt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);xt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);xt.registerFlag("WEBGL_EXP_CONV",()=>!1);xt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>xt.getBool("IS_TEST"));xt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);xt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);xt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);xt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ss(){let e,t,n,s,r,i,o,a,l,c;return H().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=H().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mc(e,t,n="index"){const s=bt(t);return s.map((r,i)=>{const o=`int ${e[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${r}`:`index -= ${e[i]} * ${r}`;return`${o}; ${a};`}).join("")}function ow(e,t,n="index"){const s=bt(t);return s.map((r,i)=>{const o=`int ${e[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * outShapeStrides[${i}]`:`index -= ${e[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function k1t(e,t){const n=e.length,s=e.map(i=>`${t}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function C1t(e,t,n="index"){const s=e.map((i,o)=>o),r=k1t(s,t);return r.map((i,o)=>{const a=`int ${e[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${e[o+1]} = ${n} - ${e[o]} * ${r[o]}`:`index -= ${e[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function C$(e){const t=bt(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function I$(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const I6=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:T6}=oV;function I1t(e,t,n){const s=[];if(e.forEach(f=>{const p=X(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:g}=T$(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),i=e.map(f=>T1t(f,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=t.texShape,a=ss(),l=$1t(a);let c,u,h=R1t(a);return t.isPacked?(c=N1t(t.logicalShape,o,n.enableShapeUniforms),u=A1t(a)):(c=_1t(t.logicalShape,o,n.enableShapeUniforms),u=E1t(a)),n.packedInputs&&(h+=F1t),[h,l,u,r,c,i,n.userCode].join(`
`)}function vd(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return q1t(e,t);case 1:return Y1t(e,t);case 2:return Q1t(e,t);case 3:return tbt(e,t);case 4:return nbt(e,t);case 5:return sbt(e);case 6:return rbt(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function N6(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return K1t(e);case 1:return X1t(e,t);case 2:return Z1t(e,t);case 3:return J1t(e,t);default:return ebt(e,t)}}function T1t(e,t,n=!1,s){let r="";n?r+=N6(e,s):r+=vd(e,s);const i=e.shapeInfo.logicalShape,o=t.logicalShape;return i.length<=o.length&&(n?r+=ibt(e,t):r+=obt(e,t)),r}function N1t(e,t,n){switch(e.length){case 0:return _6();case 1:return L1t(e,t,n);case 2:return G1t(e,t,n);case 3:return z1t(e,t,n);default:return V1t(e,t,n)}}function _1t(e,t,n){switch(e.length){case 0:return _6();case 1:return M1t(e,t,n);case 2:return H1t(e,t,n);case 3:return B1t(e,t,n);case 4:return W1t(e,t,n);case 5:return U1t(e,t);case 6:return j1t(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function $1t(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function E1t(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function A1t(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function R1t(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${D1t}
    ${O1t}
    ${P1t}
  `}const D1t=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,O1t=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,P1t=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,F1t=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function _6(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function L1t(e,t,n){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function M1t(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function z1t(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),i=r*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function B1t(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${ow(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;const s=Mc(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function V1t(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),i=r*Math.ceil(e[e.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<e.length-1;c++)o*=e[e.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${e.length}(${l});
    }
  `}function W1t(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${ow(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Mc(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function U1t(e,t){const n=Mc(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function j1t(e,t){const n=Mc(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function G1t(e,t,n){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Pt(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function H1t(e,t,n){return Pt(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function zc(e){return`offset${e}`}function K1t(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),s=ss();return`
    vec4 ${n}() {
      return ${s.texture2D}(${t}, halfCR);
    }
  `}function q1t(e,t){const n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=e.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=zc(n);if(t)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=e.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function X1t(e,t){const n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e.shapeInfo.texShape,i=ss();if(t)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function Y1t(e,t){const n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${wd(e)}
      }
    `;const r=e.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=zc(n);return o===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function Z1t(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=e.shapeInfo.texShape,o=i[0],a=i[1],l=ss();if(i!=null&&Pt(n,i))return t?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(t)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function Q1t(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=e.shapeInfo.texShape;if(i!=null&&Pt(n,i)){if(t)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const d=i[0],f=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=wo(n),l=o;if(l.length<n.length){const d=Sd(e,l),f=["row","col"];return`
      ${vd(d,t)}
      float ${r}(int row, int col) {
        return ${r}(${kd(f,a)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${wd(e)}
      }
    `;const c=i[0],u=i[1],h=zc(s);return u===1?t?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?t?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:t?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${h};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function J1t(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const d=n.slice(1),f=[1,2],p=Sd(e,d),g=["b","row","col"];return`
        ${N6(p,t)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${kd(g,f)});
        }
      `}const a=ss();if(t)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${h}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function tbt(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=wo(n),c=a;if(c.length<n.length){const g=Sd(e,c),m=["row","col","depth"];return`
        ${vd(g,t)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${kd(m,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${wd(e)}
      }
    `;const u=e.shapeInfo.texShape,h=u[0],d=u[1],f=e.shapeInfo.flatOffset;if(d===i&&f==null)return t?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(d===o&&f==null)return t?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=zc(s);return t?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${s}, uv);
      }
  `}function ebt(e,t){const n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=ss();if(t)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=e.shapeInfo.logicalShape,o=i.length,a=e.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],h=Math.ceil(i[o-1]/2);let d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let g=2;g<o-1;g++)f=`int b${g}, `+f,d*=i[o-g-1],p=`b${g} * ${d} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function nbt(e,t){const n=e.shapeInfo.logicalShape,s=e.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=wo(n);if(l.length<n.length){const y=Sd(e,l),b=["row","col","depth","depth2"];return`
      ${vd(y,t)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${kd(b,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${wd(e)}
      }
    `;const u=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],f=h[1],p=`int stride2 = ${s}Shape[3];`,g=`int stride1 = ${s}Shape[2] * stride2;`,m=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return t?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===i&&u==null)return t?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;const x=zc(s);return t?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${m}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${x});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${x});
      return sampleTexture(${s}, uv);
    }
  `}function sbt(e){const t=e.shapeInfo.logicalShape,n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t[4],i=t[3]*r,o=t[2]*i,a=t[1]*o,{newShape:l,keptDims:c}=wo(t);if(l.length<t.length){const g=Sd(e,l),m=["row","col","depth","depth2","depth3"];return`
      ${vd(g)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${kd(m,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${wd(e)}
      }
    `;const u=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],f=h[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=zc(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function rbt(e){const t=e.shapeInfo.logicalShape,n=e.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=wo(t);if(r.length<t.length){const m=Sd(e,r),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${vd(m)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${kd(x,i)});
      }
    `}const o=t[5],a=t[4]*o,l=t[3]*a,c=t[2]*l,u=t[1]*c;if(e.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${wd(e)}
      }
    `;const h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,f=d[0],p=d[1];if(p===u&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=zc(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${g};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function wd(e){const t=e.name,n=X(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function ibt(e,t){const n=e.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,a=T6(e.shapeInfo.logicalShape,t.logicalShape),l=se(o),c=o-i;let u;const h=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(y=>`coords.${h[y+c]} = 0;`).join(`
`);let d="";o<2&&i>0?d="coords":d=e.shapeInfo.logicalShape.map((y,b)=>`coords.${h[b+c]}`).join(", ");let f="return outputValue;";const g=X(e.shapeInfo.logicalShape)===1,x=X(t.logicalShape)===1;if(i===1&&!g&&!x)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!x)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const y=i-2,b=i-1;a.indexOf(y)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${d});
      ${f}
    }
  `}function obt(e,t){const n=e.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,a=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&a===l&&e.shapeInfo.flatOffset==null&&Pt(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=se(l),u=T6(e.shapeInfo.logicalShape,t.logicalShape),h=l-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":l<2&&u.length>=1?d="coords = 0;":d=u.map(g=>`coords.${f[g+h]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=e.shapeInfo.logicalShape.map((g,m)=>`coords.${f[m+h]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${s}(${p});
    }
  `}function se(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function T$(e,t,n){const{newShape:s,keptDims:r}=wo(t),i=t.length,o=e&&i===3&&t[0]===1,a=o?t.slice(1):s,l=!e&&i>1&&!Pt(t,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:t,keptDims:r}}function Sd(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function kd(e,t){return t.map(n=>e[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function abt(e,t,n,s){const r=n.map((u,h)=>{const d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:t.variableNames[h],shapeInfo:d}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=I1t(r,o,t),l=r6(e.gl,a),c=e.createProgram(l);return H().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},$6(e,t,c)))}function $6(e,t,n){const s=[],r=[];let i,o,a,l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),H().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const h of t.variableNames){const d={name:h,uniform:e.getUniformLocation(n,h,u),offset:e.getUniformLocation(n,`offset${h}`,u)};t.enableShapeUniforms&&(d.shape=e.getUniformLocation(n,`${h}Shape`,u),d.texShape=e.getUniformLocation(n,`${h}TexShape`,u)),s.push(d)}if(t.enableShapeUniforms&&(i=e.getUniformLocation(n,"outShape",u),a=e.getUniformLocation(n,"outShapeStrides",u),o=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(const h of t.customUniforms)r.push(e.getUniformLocation(n,h.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function uO(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,s)=>{const r=n.logicalShape,i=t[s],o=i.shape;if(!Pt(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!Pt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function lbt(e,t,n,s,r){t.program.enableShapeUniforms||(uO(t.inShapeInfos,n),uO([t.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),H().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:h,shape:d,texShape:f}=t.variablesLocations[l];if(d){const{uniformShape:p}=T$(t.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:e.gl.uniform1iv(d,new Int32Array(p));break;case 2:e.gl.uniform2iv(d,new Int32Array(p));break;case 3:e.gl.uniform3iv(d,new Int32Array(p));break;case 4:e.gl.uniform4iv(d,new Int32Array(p));break}}if(f&&e.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(X(c.shape)<2)e.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),e.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&h!=null&&e.gl.uniform1i(h,c.texData.slice.flatOffset),e.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=t.outShapeLocation;if(a)switch(s.shape.length){case 1:e.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:e.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:e.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:e.gl.uniform4iv(a,new Int32Array(s.shape));break}if(t.outShapeStridesLocation){const l=bt(s.shape);switch(s.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),t.program.customUniforms&&r)for(let l=0;l<t.program.customUniforms.length;++l){const c=t.program.customUniforms[l],u=t.customUniformLocations[l],h=r[l];if(c.type==="float")e.gl.uniform1fv(u,h);else if(c.type==="vec2")e.gl.uniform2fv(u,h);else if(c.type==="vec3")e.gl.uniform3fv(u,h);else if(c.type==="vec4")e.gl.uniform4fv(u,h);else if(c.type==="int")e.gl.uniform1iv(u,h);else if(c.type==="ivec2")e.gl.uniform2iv(u,h);else if(c.type==="ivec3")e.gl.uniform3iv(u,h);else if(c.type==="ivec4")e.gl.uniform4iv(u,h);else throw Error(`uniform type ${c.type} is not supported yet.`)}e.executeProgram()}function cbt(e,t,n){let s="";t.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:h}=T$(e.packedInputs,o.shape,l);let d="",f="",p="";if(u.length===1&&e.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${w[0]>1}_${w[1]>1}`}else if(u.length===2&&!e.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!e.packedInputs){const w=bt(u);p=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const g=o.shape.length,m=u.length===2&&Pt(o.shape,l),x=X(o.shape)===1,y=sc(o.shape,n.shape),b=!e.packedInputs&&g===n.shape.length&&Pt(l,n.texData.texShape),v=e.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${g}_${b}_${c?h:""}_${u.length}_${x}_${y}_${m}_${d}_${f}_${p}_${v}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=e.userCode;let i=e.constructor.name;return i+="_"+s+"_"+r+`${H().getNumber("WEBGL_VERSION")}`,i}function Mn(e){return H().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ubt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Np.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ss();this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?ow(["r","c","d"],t):Mc(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hbt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Np.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ss();this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?ow(["r","c","d"],t):Mc(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dbt{constructor(t){this.variableNames=["A"],this.outTexUsage=Ys.DOWNLOAD;const n=ss();this.outputShape=t,this.userCode=`
      ${I6}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fbt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ys.DOWNLOAD;const n=ss();this.outputShape=t,this.userCode=`
      ${I6}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pbt={R:0,G:1,B:2,A:3};class hO{constructor(t,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ss();this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${pbt[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?I$():C$(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mbt{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ss();this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?I$():C$(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(e){const t=ss(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return s6(e,n)}function A6(e){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return a6(e,t)}function R6(e){const t=new Uint16Array([0,1,2,2,1,3]);return l6(e,t)}function Pg(e,t,n,s,r,i){u6(t,n);const o=c6(e),a=e.TEXTURE_2D;return ct(e,()=>e.bindTexture(a,o)),ct(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),ct(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),ct(e,()=>e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST)),ct(e,()=>e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST)),H().getNumber("WEBGL_VERSION")===1?ct(e,()=>e.texImage2D(a,0,s,t,n,0,r,i,null)):ct(e,()=>e.texStorage2D(a,1,s,t,n)),ct(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:o,texShape:[n,t]}}function N$(e){return e.internalFormatFloat}function D6(e,t,n,s){const[r,i]=Og(t,n);return Pg(e,r,i,N$(s),s.textureFormatFloat,e.FLOAT)}function _$(e){return e.internalFormatHalfFloat}function O6(e,t,n,s){const[r,i]=Og(t,n);return Pg(e,r,i,_$(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function $$(e){return e.downloadTextureFormat}function P6(e,t,n,s){const[r,i]=Og(t,n);return Pg(e,r,i,$$(s),e.RGBA,e.UNSIGNED_BYTE)}function E$(e){return e.internalFormatPackedFloat}function F6(e,t,n,s){const[r,i]=yd(t,n);return Pg(e,r,i,E$(s),e.RGBA,e.FLOAT)}function A$(e){return e.internalFormatPackedHalfFloat}function L6(e,t,n,s){const[r,i]=yd(t,n);return Pg(e,r,i,A$(s),e.RGBA,s.textureTypeHalfFloat)}function M6(e,t,n){return ct(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Pk(e,t,"clipSpacePos",n,3,20,0)&&Pk(e,t,"uv",n,2,20,12)}function z6(e,t,n,s,r,i){ct(e,()=>e.bindTexture(e.TEXTURE_2D,t));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=e.UNSIGNED_BYTE,l=e.RGBA):(o=new Float32Array(n*s*4),a=e.FLOAT,l=i.internalFormatPackedFloat),o.set(r),H().getNumber("WEBGL_VERSION")===2?ct(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,s,e.RGBA,a,o)):ct(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,s,0,e.RGBA,a,o)),ct(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function B6(e,t,n){ct(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?H().getNumber("WEBGL_VERSION")===2?ct(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):ct(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):H().getNumber("WEBGL_VERSION")===2?ct(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):ct(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),ct(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function V6(e,t,n,s){const r=e.createBuffer();ct(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r));const a=4*4*t*n;return ct(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),ct(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),ct(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),r}function W6(e,t,n){const s=e,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function U6(e,t,n,s){const[r,i]=Og(t,n),o=4,a=new Uint8Array(u1t(t*n,o));return ct(e,()=>e.readPixels(0,0,r,i,s.downloadTextureFormat,e.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function j6(e,t,n,s,r,i,o,a){const l=e,c=new Float32Array(h1t(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function G6(e,t,n){const s=new Float32Array(t*n*4);return ct(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,s)),s}const gbt=Object.freeze(Object.defineProperty({__proto__:null,bindVertexProgramAttributeStreams:M6,createBufferFromOutputTexture:V6,createFloat16MatrixTexture:O6,createFloat16PackedMatrixTexture:L6,createFloat32MatrixTexture:D6,createIndexBuffer:R6,createPackedMatrixTexture:F6,createUnsignedBytesMatrixTexture:P6,createVertexBuffer:A6,createVertexShader:E6,downloadByteEncodedFloatMatrixFromOutputTexture:U6,downloadFloat32MatrixFromBuffer:W6,downloadMatrixFromPackedOutputTexture:G6,downloadPackedMatrixFromBuffer:j6,getInternalFormatForFloat16MatrixTexture:_$,getInternalFormatForFloat16PackedMatrixTexture:A$,getInternalFormatForFloat32MatrixTexture:N$,getInternalFormatForPackedMatrixTexture:E$,getInternalFormatForUnsignedBytesMatrixTexture:$$,uploadDenseMatrixToTexture:z6,uploadPixelDataToTexture:B6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hx{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=H().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,t6(n,t)):this.gl=Qr(n),t=this.gl,H().getNumber("WEBGL_VERSION")===2){const i=t;this.createVertexArray=()=>ct(i,()=>i.createVertexArray()),this.bindVertexArray=o=>ct(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>ct(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>ct(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(t!=null){const i=t.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ct(t,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>ct(t,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>ct(t,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>ct(t,()=>t.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),H().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=of(this.gl,i),Zs(this.gl,o))this.textureHalfFloatExtension=of(this.gl,o);else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Zs(this.gl,r))this.colorBufferHalfFloatExtension=of(this.gl,r);else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Zs(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Zs(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=A6(this.gl),this.indexBuffer=R6(this.gl),this.framebuffer=h6(this.gl),this.textureConfig=S$(this.gl,this.textureHalfFloatExtension)}get debug(){return H().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;ct(t,()=>t.finish()),ct(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),ct(t,()=>t.deleteFramebuffer(this.framebuffer)),ct(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),ct(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),ct(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),D6(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),O6(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),P6(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),B6(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,s,r){this.throwIfDisposed(),z6(this.gl,t,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),L6(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),F6(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(Fk(this.gl,this.framebuffer),this.outputTexture=null),ct(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,s){return this.downloadMatrixDriver(t,()=>U6(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,s,r,i,o){return j6(this.gl,t,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return W6(this.gl,t,n)}createBufferFromTexture(t,n,s){this.bindTextureToFrameBuffer(t);const r=V6(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,s;if(H().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(t,n,s){return this.downloadMatrixDriver(t,()=>G6(this.gl,n,s))}createProgram(t){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=E6(n));const s=i6(n);ct(n,()=>n.attachShader(s,this.vertexShader)),ct(n,()=>n.attachShader(s,t)),o6(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&ax(n,r),r}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const n=this.gl;ct(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),M6(n,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(ct(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&ax(this.gl,this.program),ct(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,s=!0){return this.throwIfDisposed(),s?f6(this.gl,t,n):p6(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),ct(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),m6(this.gl,t,n,s)}setOutputMatrixTexture(t,n,s){this.setOutputMatrixTextureDriver(t,s,n)}setOutputPackedMatrixTexture(t,n,s){this.throwIfDisposed();const[r,i]=yd(n,s);this.setOutputMatrixTextureDriver(t,r,i)}setOutputMatrixWriteRegion(t,n,s,r){this.setOutputMatrixWriteRegionDriver(s,t,r,n)}setOutputPackedMatrixWriteRegion(t,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&ax(this.gl,this.program),af(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ct(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ct(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=of(this.gl,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await GS(()=>this.disposed||this.isQueryAvailable(t,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(t,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(t,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(t,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(t,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=xbt(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in H().platform&&(s=H().platform.setTimeoutCustom.bind(H().platform)),GS(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),lx(this.gl,t,this.framebuffer),this.debug&&af(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(lx(this.gl,this.outputTexture,this.framebuffer),this.debug&&af(this.gl)):Fk(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(t,n,s){this.throwIfDisposed();const r=this.gl;lx(r,t,this.framebuffer),this.debug&&af(r),this.outputTexture=t,ct(r,()=>r.viewport(0,0,n,s)),ct(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(t,n,s,r){this.throwIfDisposed(),ct(this.gl,()=>this.gl.scissor(t,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function xbt(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:ybt,bincountImpl:H6,bincountReduceImpl:bbt,bitwiseAndImpl:vbt,castImpl:wbt,ceilImpl:Sbt,concatImpl:kbt,equalImpl:Cbt,expImpl:Ibt,expm1Impl:Tbt,floorImpl:Nbt,gatherNdImpl:_bt,gatherV2Impl:$bt,greaterImpl:Ebt,greaterEqualImpl:Abt,lessImpl:Rbt,lessEqualImpl:Dbt,linSpaceImpl:Obt,logImpl:Pbt,maxImpl:Fbt,maximumImpl:Lbt,minimumImpl:Mbt,multiplyImpl:zbt,negImpl:Bbt,notEqualImpl:Vbt,prodImpl:Wbt,raggedGatherImpl:Ubt,raggedRangeImpl:jbt,raggedTensorToTensorImpl:Gbt,rangeImpl:Hbt,rsqrtImpl:Kbt,scatterImpl:qbt,sigmoidImpl:Xbt,simpleAbsImpl:K6,sliceImpl:Ybt,sparseFillEmptyRowsImpl:Zbt,sparseReshapeImpl:Qbt,sparseSegmentReductionImpl:q6,sqrtImpl:Jbt,staticRegexReplaceImpl:tvt,stridedSliceImpl:evt,stringNGramsImpl:nvt,stringSplitImpl:svt,stringToHashBucketFastImpl:rvt,subImpl:ivt,tileImpl:ovt,topKImpl:avt,transposeImpl:R$,uniqueImpl:lvt}=FW;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function Kn(e,t){return t===1?[e]:X6(e,t)}function cvt(e,t){if(e===1)return"rc";let n="";for(let s=0;s<e;s++)n+=t[s],s<e-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uvt{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Mn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Kn("rc",this.rank),s=se(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(t){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${t[t.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${t[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";const n=t.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(t){const n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y6{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${hvt(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?I$():C$(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${s}

        setOutput(result);
      }
    `}}function hvt(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?C1t(["r","c","d"],"inputShape"):Mc(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dvt{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,n,s){const r=fO(n,s),i=pO(t,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=dO(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return r===kn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===kn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===kn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===kn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===kn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(t,n,s,r){if(this.freeTextures==null)return;const i=fO(s,r),o=pO(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=dO(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=H().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(t);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function fvt(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function dO(e,t,n,s,r){const i=pvt(t,s);let o;if(r){const[l,c]=yd(e[0],e[1]);o=l*c}else{const[l,c]=Og(e[0],e[1]);o=l*c}const a=fvt(n,i);return o*a}function pvt(e,t){switch(e){case kn.PACKED_2X2_FLOAT32:return E$(t);case kn.PACKED_2X2_FLOAT16:return A$(t);case kn.UNPACKED_FLOAT32:return N$(t);case kn.UNPACKED_FLOAT16:return _$(t);case kn.PACKED_4X1_UNSIGNED_BYTE:return $$(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function mvt(e){return H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?kn.PACKED_2X2_FLOAT32:kn.UNPACKED_FLOAT32:e?kn.PACKED_2X2_FLOAT16:kn.UNPACKED_FLOAT16}function fO(e,t){if(e===Ys.UPLOAD)return kn.PACKED_2X2_FLOAT32;if(e===Ys.RENDER||e==null)return mvt(t);if(e===Ys.DOWNLOAD||e===Ys.PIXELS)return kn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function pO(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fi{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const $r="if (isnan(x)) return x;",gvt="return x;",mO="return abs(x);",xvt="return (x >= 0.0) ? x : (exp(x) - 1.0);",yvt=$r+`
  return (x < 0.0) ? 0.0 : x;
`,bvt=$r+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Vo="return x;",vvt="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wvt="return x;",Svt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,kvt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Cvt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ivt="return 1.0 / (1.0 + exp(-1.0 * x));";class Zo{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tvt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length);const n=t.length,s=Kn("rc",n),r=se(n),i=cvt(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nvt=kv,_vt=1e-7,$vt=1e-4,I0={};function Evt(e){return e in I0||(I0[e]={}),I0[e]}const Avt=H().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Rvt=600;function Dvt(){return H().global.screen==null?1024:H().global.screen.height*H().global.screen.width*window.devicePixelRatio*Rvt/1024/1024}class Fg extends B1{nextDataId(){return Fg.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!H().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof hx)n=t;else{const s=Qr(H().getNumber("WEBGL_VERSION"),t);n=new hx(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Qr(H().getNumber("WEBGL_VERSION"));n=new hx(s),this.binaryCache=Evt(H().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new dvt(this.gpgpu),this.numMBBeforeWarning=Dvt(),this.texData=new kI(this,Pr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,s,r,i,o){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:t,texShape:[r,i]},l.texShape=[r,i];const c=lf(n),u=new hO(c,!1,o),h=this.runWebGLProgram(u,[a],s,[[r,i]]);return h.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),h.dataId}write(t,n,s){if((H().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||H().getBool("DEBUG"))&&this.checkNumericalProblems(t),s==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:t,usage:Ys.UPLOAD,refCount:1}),r}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}move(t,n,s,r,i){if(H().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:s,dtype:r,values:n,usage:Ys.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const n=this.texData.get(t),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let d;l?d=new Zo(a,Vo):d=new fi(a,Vo);const f=this.runWebGLProgram(d,[{dataId:t,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(t);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=vn());let h;if(r==="complex64"){const d=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);h=yo(d,f)}else h=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=vn()-u),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){const p=this.pendingRead.get(t);return new Promise(g=>p.push(g))}const n=this.texData.get(t),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new Zo(r,Vo):p=new fi(r,Vo);const g=this.runWebGLProgram(p,[{dataId:t,shape:r,dtype:o}],o),m=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),m}if(s!=null)return this.convertAndCacheOnCPU(t);if(H().getBool("DEBUG")&&!H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&H().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&H().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...k0(r))}this.pendingRead.set(t,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=p[0],m=p[1];h=yo(g,m)}else if(c==null)h=this.getValuesFromTexture(t);else{const p=X(r);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;ct(p,()=>p.deleteBuffer(c))}const d=this.convertAndCacheOnCPU(t,h),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach(p=>p(d)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Pr().removeDataId(t,this),this.pendingDeletes--),d}readToGPU(t,n={}){const s=this.texData.get(t),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new Zo(i,Vo):f=new fi(i,Vo);const p=this.runWebGLProgram(f,[{dataId:t,shape:i,dtype:a}],a),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(t,n.customTexShape),h=Pr().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const s=n.map(r=>po(r));return Et(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Et(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const s=t[n];if(!e6(s))throw H().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:s,isPacked:r}=this.texData.get(t),i=X(n);if(H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(t),f=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...k0(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(d),p}const o=H().getBool("WEBGL_PACK")&&r===!0,a=o?lf(n):n,l=o?new fbt(a):new dbt(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:t}],"float32"),u=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,t();const i=Ci(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=Ci(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=b4(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:vn(),endMs:null}}endTimer(t){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=vn(),t)}async getQueryTime(t){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:s}=this.texData.get(t);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(t),l=a&&a.origDataId||t,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=Avt){return H().getBool("WEBGL_CPU_FORWARD")&&t.every(s=>this.texData.get(s.dataId).texture==null&&X(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){Gs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return Nvt(t.shape,n)}packedUnaryOp(t,n,s){const r=new Zo(t.shape,n),i=this.compileAndRun(r,[t],s);return Pr().makeTensorFromTensorInfo(i)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const r=K6(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,r)}if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,mO,t.dtype);const n=new fi(t.shape,mO),s=this.compileAndRun(n,[t]);return Pr().makeTensorFromTensorInfo(s)}makeTensorInfo(t,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&di(s[0])){const i=s.map(o=>xi(o));r=this.write(i,t,n)}else r=this.write(s,t,n);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:n}}makeOutput(t,n,s){return Pr().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,s),this)}unpackTensor(t){const n=new Tvt(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new uvt(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)}packedReshape(t,n){const s=[dc(t.shape),...fc(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[dc(n),...fc(n)],o=new Y6(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(t,n){const s=this.texData.get(t),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const d=X(i),f=n[0]*n[1]*4;T(d<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=lf(i);let l;r?l=new hbt(a):l=new ubt(a);const c=!0,u=[n??k0(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:t}],o,u,c,n);return{dtype:o,shape:i,dataId:h.dataId}}runWebGLProgram(t,n,s,r,i=!1,o){const a=this.makeTensorInfo(t.outputShape,s),l=this.texData.get(a.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===Np.DENSE){const x=o??k0(t.outputShape);l.texShape=x.map(y=>y*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),X(a.shape)===0)return l.values=fn(a.dtype,0),a;const c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(x.dataId);if(y.texture==null){if(!t.packedInputs&&X(x.shape)<=H().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:y.values};t.packedInputs&&(y.isPacked=!0,y.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!y.isPacked!=!!t.packedInputs)x=y.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),y=this.texData.get(x.dataId);else if(y.isPacked&&!_p(y.shape,x.shape)){const b=x,v=x.shape;x.shape=y.shape,x=this.packedReshape(x,v),c.push(x),y=this.texData.get(x.dataId),b.shape=v}return{shape:x.shape,texData:y,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},d=cbt(t,u,h),f=this.getAndSaveBinary(d,()=>abt(this.gpgpu,t,u,h)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),H().get("ENGINE_COMPILE_ONLY")||lbt(this.gpgpu,f,u,h,r),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),p&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)}));const m=H().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const x=vn();x-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!H().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(t,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(t,n,s,r,i)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(H().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=G(()=>{if(!H().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=H().getBool("DEBUG");H().set("DEBUG",!1);const n=this.abs(yt(1e-8)).dataSync()[0];if(H().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?_vt:$vt}uploadToGPU(t){const n=this.texData.get(t),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=vn());let h=n.texShape;if(h==null&&(h=y6(s,l),n.texShape=h),i!=null){const d=lf(s);let f,p=h[1],g=h[0];const m=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!m)&&([p,g]=yd(h[0],h[1])),l?f=new mbt(d,m):f=new hO(d,m);const x=m?[g,p]:h,y=this.makeTensorInfo(x,r),b=this.texData.get(y.dataId);m?b.usage=Ys.PIXELS:b.usage=Ys.UPLOAD,b.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,g,i);const v=[[g,p]],k=this.runWebGLProgram(f,[y],r,v,!0),I=this.texData.get(k.dataId);n.texShape=I.texShape,n.isPacked=I.isPacked,n.usage=I.usage,H().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=I.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=vn()-u)}else{const d=this.acquireTexture(h,a,r,l);n.texture=d}}convertAndCacheOnCPU(t,n){const s=this.texData.get(t),{dtype:r}=s;return n!=null&&(s.values=Ovt(n,r)),s.values}acquireTexture(t,n,s,r){if(this.numBytesInGPU+=this.computeBytes(t,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,r)}computeBytes(t,n){return t[0]*t[1]*dp(n)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});t.push(s)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await dN(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(k$(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=$6(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=s,t.infLoc=r,t.nanLoc=i,t.outShapeLocation=o,t.outShapeStridesLocation=a,t.outTexShapeLocation=l}}createTensorFromGPUData(t,n,s){t.channels=t.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=t,l=Pr().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,i,o,a);return Pr().makeTensorFromDataId(c,n,s,l)}}Fg.nextDataId=0;function Ovt(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let s=0;s<n.length;++s)n[s]=Math.round(e[s]);return n}else throw new Error(`Unknown dtype ${t}`)}/** @license See the LICENSE file. */const Z6="4.21.0";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q6(){H().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */DI()&&PI("webgl",()=>new Fg,2);const Pvt={forceHalfFloat:Q6};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class pc{constructor(t,n,s){this.variableNames=["A","B"],this.outputShape=It(n,s),this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bc=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Cd{constructor(t,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=It(n,s);const i=this.outputShape.length;this.enableShapeUniforms=Mn(i);let o="";if(r)if(i===0||X(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${se(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Kn("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ls(e){const{inputs:t,backend:n}=e,{x:s}=t;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Fvt={kernelName:$h,backendName:"webgl",kernelFunc:Ls};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(e){const{inputs:t,backend:n}=e,{real:s,imag:r}=t,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=Ls({inputs:{x:s},backend:n}),l=Ls({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const Lvt={kernelName:X1,backendName:"webgl",kernelFunc:Xa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J6="return (a < 0.) ? b * a : a;",tU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Mvt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{alpha:i}=s,o=n.makeTensorInfo([],"float32",So(i,"float32")),a=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cd(tU,r.shape,o.shape):new pc(J6,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const zvt={kernelName:bm,backendName:"webgl",kernelFunc:Mvt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eU="return (a < 0.) ? b * a : a;",nU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Bvt(e){const{inputs:t,backend:n}=e,{x:s,alpha:r}=t,i=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cd(nU,s.shape,r.shape):new pc(eU,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const Vvt={kernelName:Mm,backendName:"webgl",kernelFunc:Bvt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Id="if (isnan(x)) return x;";function jt({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const h=a.texData.get(o.dataId),d=n(h.values,l);return a.makeTensorInfo(o.shape,l,d)}const c=H().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let u;return c?u=new Zo(o.shape,t):u=new fi(o.shape,e),a.runWebGLProgram(u,[o],l)}}function An({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),g=u.texData.get(c.dataId),[m,x]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[v,w]=b,k={dataId:v.dataId,dtype:v.dtype,shape:l.shape},I={dataId:w.dataId,dtype:w.dtype,shape:c.shape},C=new pc(e,l.shape,c.shape);return u.runWebGLProgram(C,[k,I],hs(v.dtype,w.dtype))}),y=Xa({inputs:{real:m,imag:x},backend:u});return u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(x),y}const h=i||hs(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,g=u.texData.get(c.dataId).values,m=l.dtype==="string"?bo(p):p,x=l.dtype==="string"?bo(g):g,[y,b]=r(l.shape,c.shape,m,x,h),v=u.makeTensorInfo(b,h),w=u.texData.get(v.dataId);return w.values=y,v}const d=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let f;return d?f=new Cd(t,l.shape,c.shape,n):f=new pc(e,l.shape,c.shape),u.runWebGLProgram(f,[l,c],h)}}function $p(e,t=!1){if(e==="linear")return t?wvt:gvt;if(e==="relu")return t?kvt:yvt;if(e==="elu")return t?Svt:xvt;if(e==="relu6")return t?Cvt:bvt;if(e==="prelu")return t?nU:eU;if(e==="leakyrelu")return t?tU:J6;if(e==="sigmoid")return t?Ivt:vvt;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sU{constructor(t,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Mn(this.outputShape.length);const u=r?t[1]:t[2],h=Math.ceil(u/2),d=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",x="";a&&(l?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:m=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";t[0]<n[0]?b=`imod(rc.x, ${t[0]})`:n[0]<t[0]&&(v=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${v};
        for (int i = 0; i < ${h}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gO={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class xO{constructor(t,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=It(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yO="return a * b;";function O$(e){const{inputs:t,backend:n}=e,{a:s,b:r}=t,i=hs(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new xO(gO.REAL,s.shape,r.shape),u=new xO(gO.IMAG,s.shape,r.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=Xa({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=zbt(s.shape,r.shape,a.values,l.values,i),h=n.makeTensorInfo(u,i),d=n.texData.get(h.dataId);return d.values=c,h}let o;return H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Cd(yO,s.shape,r.shape):o=new pc(yO,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const Wvt={kernelName:Mh,backendName:"webgl",kernelFunc:O$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uvt(e,t,n){const s=[dc(e.shape),...fc(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[dc(t),...fc(t)],o=new Y6(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:t,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{shape:i}=s,o=n,a=X(r.shape),l=II(i,a),c=X(l);T(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!_p(r.shape,l)&&!(u.texture!==null&&_p(u.shape,l))?Uvt(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const jvt={kernelName:Bm,backendName:"webgl",kernelFunc:lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bO{constructor(t,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=t;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const h=1/n;c=`sumValue += dot(values * ${Zl(h)?h.toPrecision(2):h}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gvt{constructor(t,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=t;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,h=s%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hvt(e){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:e[1],s=Pv(n);t.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return t}function Vc(e,t,n,s){const r=Hvt(e.shape);let i=e;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,h;n==="mean"?u=o===0?new bO({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:c},a):new bO({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:c}):u=new Gvt({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:c},n),h=i,i=s.runWebGLProgram(u,[i],t),h.dataId!==e.dataId&&s.disposeIntermediateTensorInfo(h)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kvt{constructor(t,n){this.variableNames=["A"];const s=new Array(t.length);for(let o=0;o<s.length;o++)s[o]=t[n[o]];this.outputShape=s,this.rank=s.length;const r=se(this.rank),i=qvt(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function qvt(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(t);for(let r=0;r<e.length;r++)s[e[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xvt{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(t.length);for(let u=0;u<s.length;u++)s[u]=t[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=se(this.rank),i=X6("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aw(e,t,n){const s=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Xvt(e.shape,t):new Kvt(e.shape,t);return n.runWebGLProgram(s,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yvt(e,t,n,s){const r=t,i=e.shape.length,o=Dt(r,e.shape);let a=o;const l=Ne(a,i),c=l!=null;let u=e;c&&(u=aw(e,l,s),a=Be(a.length,i)),$n("sum",a,i);const[h,d]=xn(u.shape,a);let f=h;n&&(f=ze(h,o));const p=X(d),m=X(e.shape)/p,x=lt({inputs:{x:u},attrs:{shape:[m,p]},backend:s}),y=Xb(e.dtype),b=Vc(x,y,"sum",s),v=lt({inputs:{x:b},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(b),c&&s.disposeIntermediateTensorInfo(u),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lw(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s;return Yvt(r,i,o,n)}const Zvt={kernelName:Hm,backendName:"webgl",kernelFunc:lw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jn(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const h=o.texData.get(r.dataId).values,d=R$(h,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const f=o.texData.get(c.dataId);f.values=d}else c=aw(r,i,o);return c}const Qvt={kernelName:Dl,backendName:"webgl",kernelFunc:Jn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rU=1e3;function Gy({a:e,b:t,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=e.shape.length,u=t.shape.length,h=n?e.shape[c-2]:e.shape[c-1],d=s?t.shape[u-1]:t.shape[u-2],f=n?e.shape[c-1]:e.shape[c-2],p=s?t.shape[u-2]:t.shape[u-1],g=e.shape.slice(0,-2),m=t.shape.slice(0,-2),x=X(g),y=X(m),v=It(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([f,p]);T(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=n?[x,h,f]:[x,f,h],k=s?[y,p,d]:[y,d,p],I=lt({inputs:{x:e},backend:r,attrs:{shape:w}}),C=lt({inputs:{x:t},backend:r,attrs:{shape:k}}),N=[I,C],$=Math.max(x,y),A=n?I.shape[1]:I.shape[2],R=i!=null,z=o!=null,U=l==="leakyrelu",F=l!=null?$p(l,!0):null,P=R||z||U||F!=null;let L;if((f===1||p===1)&&A>rU&&P===!1){let B=I,q=C;n&&(B=Jn({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),N.push(B)),s&&(q=Jn({inputs:{x:C},backend:r,attrs:{perm:[0,2,1]}}),N.push(q));const Y=p!==1,Q=p===1;let J=B;Y&&(J=lt({inputs:{x:B},backend:r,attrs:{shape:[$,A,1]}}),N.push(J));const et=p===1?2:1;let nt=q;Q&&(nt=lt({inputs:{x:q},backend:r,attrs:{shape:[$,1,A]}}),N.push(nt));const rt=O$({inputs:{a:J,b:nt},backend:r});L=lw({inputs:{x:rt},backend:r,attrs:{axis:et,keepDims:!0}}),N.push(rt)}else{const B=hs(e.dtype,t.dtype),q=new sU(w,k,[$,f,p],n,s,R,F,z,U),Y=[I,C];if(i!=null&&Y.push(i),z&&Y.push(o),U){const Q=r.makeTensorInfo([],"float32",So(a,"float32"));Y.push(Q),N.push(Q)}L=r.runWebGLProgram(q,Y,B)}const E=lt({inputs:{x:L},backend:r,attrs:{shape:v}});N.push(L);for(const B of N)r.disposeIntermediateTensorInfo(B);return E}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jvt(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:i,bias:o,preluActivationWeights:a}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;return Gy({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:u})}const twt={kernelName:fp,backendName:"webgl",kernelFunc:Jvt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vO="return abs(x);";function ewt(e){const{inputs:t,backend:n}=e,{x:s}=t;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=K6(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return H().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Zo(s.shape,vO):r=new fi(s.shape,vO),n.runWebGLProgram(r,[s],s.dtype)}const nwt={kernelName:Zp,backendName:"webgl",kernelFunc:ewt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const swt=$r+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,rwt=jt({opSnippet:swt}),iwt={kernelName:ch,backendName:"webgl",kernelFunc:rwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const owt=$r+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,awt=jt({opSnippet:owt}),lwt={kernelName:uh,backendName:"webgl",kernelFunc:awt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wO="return a + b;",cwt=An({opSnippet:wO,packedOpSnippet:wO,supportsComplex:!0,cpuKernelImpl:ybt}),uwt={kernelName:_c,backendName:"webgl",kernelFunc:cwt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hwt{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dwt{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dx(e){const{inputs:t,backend:n}=e,s=t;if(s.length===1)return Ls({inputs:{x:s[0]},backend:n});if(s.length>H().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=dx({inputs:s.slice(0,l),backend:n}),u=dx({inputs:s.slice(l),backend:n});return dx({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>hs(l,c)),i=s.map(l=>l.shape),a=H().getBool("WEBGL_PACK")?new dwt(s[0].shape,i):new hwt(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const fwt={kernelName:Qp,backendName:"webgl",kernelFunc:dx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pwt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s,a=r.shape.length,l=Dt(i,r.shape);let c=l;const u=Ne(c,a);let h=r;u!=null&&(h=Jn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Be(c.length,a)),$n("all",c,a);const[d,f]=xn(h.shape,c),p=X(f),g=lt({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=Vc(g,g.dtype,"all",n);let x;if(o){const y=ze(d,l);x=lt({inputs:{x:m},backend:n,attrs:{shape:y}})}else x=lt({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),x}const mwt={kernelName:U1,backendName:"webgl",kernelFunc:pwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gwt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s,a=r.shape.length,l=Dt(i,r.shape);let c=l;const u=Ne(c,a);let h=r;u!=null&&(h=Jn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Be(c.length,a)),$n("any",c,a);const[d,f]=xn(h.shape,c),p=X(f),g=lt({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=Vc(g,g.dtype,"any",n);let x;if(o){const y=ze(d,l);x=lt({inputs:{x:m},backend:n,attrs:{shape:y}})}else x=lt({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),x}const xwt={kernelName:j1,backendName:"webgl",kernelFunc:gwt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ywt{constructor(t,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=t;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bwt{constructor(t,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(t.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=se(l),u=Kn("coords",l);let h,d;if(o===1){d=l+1;const C=se(d);h=`
        ${C} sourceLocR = ${C}(${u.join()}, 0);
        ++${u[l-1]};
        ${C} sourceLocG = ${C}(${u.join()}, 0);
        ++${u[l-2]};
        ${C} sourceLocA = ${C}(${u.join()}, 0);
        --${u[l-1]};
        ${C} sourceLocB = ${C}(${u.join()}, 0);
        --${u[l-2]};`}else d=l,h=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,d),p="."+f[d-1],g=f.map(C=>"int "+C),m=Kn("sourceLocR",d-1).concat("inIdx.r"),x=Kn("sourceLocG",d-1).concat("inIdx.g"),y=Kn("sourceLocB",d-1).concat("inIdx.b"),b=Kn("sourceLocA",d-1).concat("inIdx.a"),v=s==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,k=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,I=r?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${I}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(e,t,n,s=null){let r=t.shape[0],i=t.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=Pv(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new ywt(a,n,s==null),c=[t];s!=null&&c.push(s);const u=e.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const h=iU(e,t,n,u);return e.disposeIntermediateTensorInfo(u),h}function oU(e,t,n,s=null){const r=s!=null?s.shape:t.shape,i=r[r.length-1],o=Pv(i),a=new bwt(r,o,n,s==null),l=s==null?[t]:[t,s],c=e.runWebGLProgram(a,l,"int32");if(c.shape.length===t.shape.length){const u=oU(e,t,n,c);return e.disposeIntermediateTensorInfo(c),u}return c}function aU(e,t,n,s){const r=[n];if($n("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,t.shape.length),!H().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const i=[],o=e.texData.get(t.dataId),a=o!==null&&o.isPacked;let l=t;a&&(l=e.unpackTensor(t),i.push(l));const[c,u]=xn(l.shape,r),h=X(u),d=lt({inputs:{x:l},backend:e,attrs:{shape:[-1,h]}});i.push(d);const f=iU(e,d,s);i.push(f);const p=lt({inputs:{x:f},backend:e,attrs:{shape:c}});return i.forEach(g=>e.disposeIntermediateTensorInfo(g)),p}return oU(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vwt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i}=s;let o=Dt(i,r.shape);const a=Ne(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Jn({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Be(o.length,l.shape.length)),$n("argMax",[o[0]],l.shape.length);const u=aU(n,l,o[0],"max");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const wwt={kernelName:Jp,backendName:"webgl",kernelFunc:vwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Swt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i}=s;let o=Dt(i,r.shape);const a=Ne(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Jn({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Be(o.length,l.shape.length)),$n("argMin",[o[0]],l.shape.length);const u=aU(n,l,o[0],"min");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const kwt={kernelName:tm,backendName:"webgl",kernelFunc:Swt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cwt=$r+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Iwt=jt({opSnippet:Cwt}),Twt={kernelName:hh,backendName:"webgl",kernelFunc:Iwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nwt=$r+"return log(x + sqrt(x * x + 1.0));",_wt=jt({opSnippet:Nwt}),$wt={kernelName:dh,backendName:"webgl",kernelFunc:_wt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ewt=$r+`
  return atan(x);
`,Awt=jt({opSnippet:Ewt}),Rwt={kernelName:fh,backendName:"webgl",kernelFunc:Awt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dwt=D$+`
  return atan(a, b);
`,Owt=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bc+`
  return result;
`,Pwt=An({opSnippet:Dwt,packedOpSnippet:Owt}),Fwt={kernelName:mh,backendName:"webgl",kernelFunc:Pwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lwt=$r+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Mwt=jt({opSnippet:Lwt}),zwt={kernelName:ph,backendName:"webgl",kernelFunc:Mwt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ep{constructor(t,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,u=t.dilationWidth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const g=n==="avg",m=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,x=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let y="0.0";if(g||(y="-1.0 / 1e-20"),s){const C=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${C} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?m:x:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let v=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(v="avgValue / max(count, 1.0)");const w=Math.floor(o/4)*4,k=o%4,I=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${I}
          }

          int xC = xCCorner + ${w};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${I}
          }
        }
        setOutput(${v});
      }
    `}}class P${constructor(t,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideDepth,l=t.strideHeight,c=t.strideWidth,u=t.dilationDepth,h=t.dilationHeight,d=t.dilationWidth,f=t.effectiveFilterDepth,p=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.front,x=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const b=n==="avg";let v="0.0";if(b||(v="-1.0 / 1e-20"),s){const $=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${m}, ${x}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${$} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const I=Math.floor(o/4)*4,C=o%4,N=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${m}, ${x}, ${y});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${I}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${N}
            }

            int xC = xCCorner + ${I};
            if (${C===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${C===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${C===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${N}
            }
          }
        }
        setOutput(${k});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;bd(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;T(_n(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Nr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Pt(u.inShape,u.outShape))return Ls({inputs:{x:r},backend:n});const h=new Ep(u,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const Vwt={kernelName:em,backendName:"webgl",kernelFunc:Bwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wwt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],h=ko(r.shape,i,o,u,a,l,c),d=new P$(h,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const Uwt={kernelName:nm,backendName:"webgl",kernelFunc:Wwt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jwt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,u=l-1-t.padInfo.top,h=c-1-t.padInfo.left,d=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Gwt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,s=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,h=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=h-1-t.padInfo.front,g=d-1-t.padInfo.top,m=f-1-t.padInfo.left,x=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${m});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hwt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:i}=t,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=ko(o.shape,a,l,h,c,u),f=new Gwt(d);return n.runWebGLProgram(f,[r],o.dtype)}const Kwt={kernelName:H1,backendName:"webgl",kernelFunc:Hwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:i}=t,o=i;bd([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Nr(o.shape,a,l,1,c),h=new jwt(u);return n.runWebGLProgram(h,[r],o.dtype)}const Xwt={kernelName:G1,backendName:"webgl",kernelFunc:qwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ywt(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:i}=t,{transposeA:o,transposeB:a}=s;return Gy({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const Zwt={kernelName:sm,backendName:"webgl",kernelFunc:Ywt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qwt{constructor(t,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],It(t,n),It(t,s);let a="0.0";r!=null&&(It(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(It(t,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jwt{constructor(t,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],It(t,n),It(t,s);let a="vec4(0.0)";r!=null&&(It(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(It(t,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t2t=({inputs:e,backend:t,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=e;T(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let h=null;a!=null&&(h=a.shape,c.push(a));const d=H().getBool("WEBGL_PACK_NORMALIZATION")?new Jwt(s.shape,r.shape,i.shape,u,h,l):new Qwt(s.shape,r.shape,i.shape,u,h,l);return t.runWebGLProgram(d,c,c[0].dtype)},e2t={kernelName:gm,backendName:"webgl",kernelFunc:t2t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n2t{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=se(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=s2t(this.rank);let r;const i=t.map((o,a)=>`sourceLoc.${zk[a]} = start[${a}] + coords.${zk[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const zk=["x","y","z","w","u","v"];function s2t(e){if(e===1)return"sourceLoc";if(e<=6)return zk.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r2t{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=se(this.rank),s=Kn("coords",this.rank),r=Kn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${t[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((u,h)=>`start[${h}]`).join()});`:t.map((u,h)=>`${r[h]} = ${s[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2t(e,t,n,s){const r=s.texData.get(e.dataId),i=s.makeTensorInfo(n,e.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=e.dtype;let a=uN(t,bt(e.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||e.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function Td(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:i,size:o}=s,[a,l]=Ov(r,i,o);if(aN(r,a,l),X(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const h=n.texData.get(r.dataId),d=Ybt(h.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,d)}const{isPacked:c}=n.texData.get(r.dataId),u=cN(r.shape,a,l);if(c||!u){const h=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new r2t(l):new n2t(l),d=[a];return n.runWebGLProgram(h,[r],r.dtype,d)}return n.uploadToGPU(r.dataId),i2t(r,a,l,n)}const o2t={kernelName:Gm,backendName:"webgl",kernelFunc:Td};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a2t=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:i,crops:o}=s;T(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,b)=>y*b),l=vg(r.shape,i,a),c=wg(l.length,i.length),u=Sg(r.shape,i,a),h=gN(o,i.length),d=xN(u,o,i.length),f=[],p=lt({inputs:{x:r},backend:n,attrs:{shape:l}}),g=Jn({inputs:{x:p},backend:n,attrs:{perm:c}}),m=lt({inputs:{x:g},backend:n,attrs:{shape:u}}),x=Td({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(g),f.push(m),f.forEach(y=>n.disposeIntermediateTensorInfo(y)),x},l2t={kernelName:rm,backendName:"webgl",kernelFunc:a2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c2t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:i}=t,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=H6(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const u2t={kernelName:K1,backendName:"webgl",kernelFunc:c2t};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h2t=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,d2t=`
  return float(int(a.r) & int(b.r));
`;function f2t(e){const{inputs:t,backend:n}=e,{a:s,b:r}=t,i=H().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=H().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,h]=vbt(s.shape,r.shape,l,c,s.dtype),d=n.makeTensorInfo(h,s.dtype),f=n.texData.get(d.dataId);return f.values=u,d}let a;return i?a=new Cd(h2t,s.shape,r.shape,!1):a=new pc(d2t,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const p2t={kernelName:im,backendName:"webgl",kernelFunc:f2t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2t(e){const{inputs:t,backend:n}=e,{s0:s,s1:r}=t,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=It(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const g2t={kernelName:q1,backendName:"webgl",kernelFunc:m2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x2t="return float(a != b);",lU=An({opSnippet:x2t,cpuKernelImpl:Vbt,dtype:"bool"}),y2t={kernelName:Dm,backendName:"webgl",kernelFunc:lU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lg(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.texData.get(s.dataId);return Ls({inputs:{x:r.complexTensorInfos.real},backend:n})}const b2t={kernelName:_b,backendName:"webgl",kernelFunc:Lg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v2t="return float(int(x));";function w2t(e,t){const n=new fi(e.shape,v2t),s=t.runWebGLProgram(n,[e],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bk(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Ls({inputs:{x:r},backend:n});const o=He(r.shape),a=Bk({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=Xa({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=Lg({inputs:{input:r},backend:n}),a=Bk({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!TI(r.dtype,i)){const o=Ls({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=wbt(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return w2t(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",fn("bool",1)),l=lU({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const S2t={kernelName:gh,backendName:"webgl",kernelFunc:Bk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SO="return ceil(x);",k2t=jt({opSnippet:SO,packedOpSnippet:SO,cpuKernelImpl:Sbt}),C2t={kernelName:xh,backendName:"webgl",kernelFunc:k2t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I2t{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T2t{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{clipValueMin:i,clipValueMax:o}=s;let a;H().getBool("WEBGL_PACK_CLIP")?a=new T2t(r.shape):a=new I2t(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const _2t={kernelName:yh,backendName:"webgl",kernelFunc:N2t};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $2t{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kO(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function E2t(e){const{inputs:t,backend:n}=e,{x:s}=t,r=n.texData.get(s.dataId),i=new $2t(s.shape),o=[kO(s,r.complexTensorInfos.real),kO(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const A2t={kernelName:om,backendName:"webgl",kernelFunc:E2t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R2t{constructor(t){this.outputShape=[],this.outputShape=bi(t,1),this.variableNames=t.map((o,a)=>`T${a}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+t[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D2t{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=bi(t,n);const s=this.outputShape,r=s.length,i=se(r),o=Kn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((g,m)=>`T${m}`);const l=new Array(t.length-1);l[0]=t[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+t[g][n];const c=a[n],u=a.slice(-2),h=a.join();let d=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${u.join()}));
        }`;for(let g=1;g<l.length;g++){const m=l[g-1];d+=`
        if (${c} < ${l[g]}  && ${c} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${T0(a,c,m)}),
            vec2(${T0(u,c,m)}));
        }`}const f=l.length,p=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${T0(a,c,p)}),
          vec2(${T0(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function T0(e,t,n){const s=e.indexOf(t);return e.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cw(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.texData.get(s.dataId);return Ls({inputs:{x:r.complexTensorInfos.imag},backend:n})}const O2t={kernelName:pb,backendName:"webgl",kernelFunc:cw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cf(e,t,n){const s=e[0].dtype;if(s==="complex64"){const f=e.map(y=>Lg({inputs:{input:y},backend:n})),p=e.map(y=>cw({inputs:{input:y},backend:n})),g=cf(f,t,n),m=cf(p,t,n),x=Xa({inputs:{real:g,imag:m},backend:n});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),p.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),x}let r=n.shouldExecuteOnCPU(e);if(s==="string"&&(r=!0),r){const f=e.map(v=>{const k=[-1,X(v.shape.slice(t))];return lt({inputs:{x:v},backend:n,attrs:{shape:k}})}),p=f.map(v=>({vals:n.readSync(v.dataId),shape:v.shape})),g=bi(f.map(v=>v.shape),1),m=f[0].shape[0]===1,x=kbt(p,g,s,m),y=bi(e.map(v=>v.shape),t),b=n.makeTensorInfo(y,s,x);return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const i=e.filter(f=>X(f.shape)>0),o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new fi(e[0].shape,Vo):new Zo(e[0].shape,Vo);return n.runWebGLProgram(f,e,s)}const a=H().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let g=0;g<i.length;g+=a){const m=i.slice(g,g+a);f.push(cf(m,t,n))}const p=cf(f,t,n);for(const g of f)n.disposeIntermediateTensorInfo(g);return p}if(o){const f=new D2t(i.map(p=>p.shape),t);return n.runWebGLProgram(f,i,s)}const{tensors2D:l,outShape:c}=P2t(i,t,n),u=new R2t(l.map(f=>f.shape)),h=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const d=lt({inputs:{x:h},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(h),d}function P2t(e,t,n){const s=bi(e.map(i=>i.shape),t);return{tensors2D:e.map(i=>lt({inputs:{x:i},attrs:{shape:[-1,X(i.shape.slice(t))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s,i=Dt(r,t[0].shape)[0],o=t.map(c=>c.shape);fN(o,i);const a=bi(t.map(c=>c.shape),i);if(X(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);const l=t.filter(c=>X(c.shape)>0);return l.length===1?Ls({inputs:{x:l[0]},backend:n}):cf(l,i,n)}const F2t={kernelName:am,backendName:"webgl",kernelFunc:cU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uU{constructor(t,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,a=t.padInfo.left,l=t.strideHeight,c=t.strideWidth,u=t.dilationHeight,h=t.dilationWidth,d=t.filterHeight,f=t.filterWidth,p=Math.floor(t.inChannels/4)*4,g=t.inChannels%4,m=t.dataFormat==="channelsLast",x=m?1:2,y=m?2:3,b=m?3:1;let v="",w="";s&&(r?v=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?v=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:v=`
          float activation(float x) {
            ${s}
          }
        `,w="result = activation(result);");const k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${w}
        setOutput(result);
      }
    `}}class L2t{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,s=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,h=t.filterDepth,d=t.filterHeight,f=t.filterWidth,p=Math.floor(t.inChannels/4)*4,g=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hU{constructor(t,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Mn(this.outputShape.length);const o=t.padInfo.left,a=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,u=t.filterWidth,h=u;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<u;m++)d+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let m=0;m<u;m++)d+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(h+1)/2;m++){const x=m*2;if(d+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<u&&(o%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?d+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<u)){const y=o%2===0?V1(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:d+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):y===1?d+=`
                     xC${x+1} = xTexelC${x};
                     `:d+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<u&&(o%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<u&&(d+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<u&&(d+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<u&&(d+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M2t{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Mn(this.outputShape.length);const{dataFormat:s}=n,r=ss(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let h=0;h<=1;h++)c+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hy(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function dU({x:e,filter:t,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=e.shape,c=s.texData.get(e.dataId),u=n.inChannels,h=l[0]*l[1]*l[2],d=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,g=!1;let m;const x=[];if(i!=null){const v=Hy(i.shape,f);v!=null&&(i=lt({inputs:{x:i},backend:s,attrs:{shape:v}}),x.push(i))}if(r!=null){const v=Hy(r.shape,f);v!=null&&(r=lt({inputs:{x:r},backend:s,attrs:{shape:v}}),x.push(r))}if(!((h===1||d===1)&&u>rU)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Pt(c.shape.slice(-3),l.slice(-3))){const v=l[0]*l[1]*(l[2]+1),w={dataId:e.dataId,shape:[1,v,n.inChannels],dtype:e.dtype},k=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,T(_p(c.shape,w.shape),()=>`packed reshape ${c.shape} to ${w.shape} isn't free`);const I=lt({inputs:{x:t},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(I);const C=Gy({a:w,b:I,backend:s,transposeA:p,transposeB:g,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),N=s.texData.get(C.dataId);T(N.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=k,N.shape=n.outShape,m=Ls({inputs:{x:C},backend:s}),m.shape=n.outShape,x.push(C)}else{const v=n.outHeight*n.outWidth,w=lt({inputs:{x:e},backend:s,attrs:{shape:f?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),k=lt({inputs:{x:t},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),I=Gy({a:f?w:k,b:f?k:w,transposeA:!f,transposeB:g,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});m=lt({inputs:{x:I},backend:s,attrs:{shape:n.outShape}}),x.push(w),x.push(k),x.push(I)}for(const v of x)s.disposeIntermediateTensorInfo(v);return m}function fU({x:e,filter:t,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:h,outHeight:d,dataFormat:f}=n,p=f==="channelsLast",g=l*c*u,m=d*h,x=[n.batchSize,g,m],y=!0,b=!1,v=[];if(i!=null){const E=Hy(i.shape,p);E!=null&&(i=lt({inputs:{x:i},backend:s,attrs:{shape:E}}),v.push(i))}if(r!=null){const E=Hy(r.shape,p);E!=null&&(r=lt({inputs:{x:r},backend:s,attrs:{shape:E}}),v.push(r))}const w=lt({inputs:{x:t},backend:s,attrs:{shape:[1,g,X(t.shape)/g]}});v.push(w);const k=new M2t(x,n),I=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],C=s.runWebGLProgram(k,[e],"float32",I),N=lt({inputs:{x:C},backend:s,attrs:{shape:x}});v.push(C),v.push(N);const $=r!=null,A=i!=null,R=a==="leakyrelu",z=a?$p(a,!0):null,U=new sU(p?N.shape:w.shape,p?w.shape:N.shape,p?[n.batchSize,m,n.outChannels]:[n.batchSize,n.outChannels,m],y,b,$,z,A,R),F=p?[N,w]:[w,N];if(r&&F.push(r),A&&F.push(i),R){const E=s.makeTensorInfo([],"float32",So(o,"float32"));F.push(E),v.push(E)}const P=s.runWebGLProgram(U,F,"float32"),L=lt({inputs:{x:P},backend:s,attrs:{shape:n.outShape}});v.push(P);for(const E of v)s.disposeIntermediateTensorInfo(E);return L}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i}=t,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,h=Co(l),d=gn(r.shape,i.shape,o,c,a,u,!1,h);let f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=dU({x:r,filter:i,convInfo:d,backend:n});else if(d.strideWidth<=2&&h==="channelsLast"&&H().getBool("WEBGL_EXP_CONV")){const g=new hU(d),m=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(g,[r,i],"float32",m)}else if(H().getBool("WEBGL_CONV_IM2COL"))f=fU({x:r,filter:i,convInfo:d,backend:n});else{const g=new uU(d);f=n.runWebGLProgram(g,[r,i],"float32")}const p=lt({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),p}const B2t={kernelName:lm,backendName:"webgl",kernelFunc:z2t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V2t{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,s=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class W2t{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=t.dataFormat==="channelsLast",a=n-1-t.padInfo.top,l=s-1-t.padInfo.left,c=o?1:2,u=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class U2t{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,s=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class j2t{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,s=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,l=n-1-t.padInfo.front,c=s-1-t.padInfo.top,u=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:i}=t,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,h=Co(l),d=gn(r.shape,u,o,1,a,c,!1,h),f=new V2t(d);return n.runWebGLProgram(f,[r,i],"float32")}const H2t={kernelName:Y1,backendName:"webgl",kernelFunc:G2t};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K2t{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Mn(this.outputShape.length);const n=t.filterHeight,s=t.filterWidth,r=n-1-t.padInfo.top,i=s-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2t(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:i}=t,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,h=Co(c),d=gn(o,i.shape,a,1,l,u,!1,h);if(H().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&h==="channelsLast"){const f=[[d.strideHeight,d.strideWidth]],p=new K2t(d);return n.runWebGLProgram(p,[r,i],"float32",f)}else{const f=new W2t(d);return n.runWebGLProgram(f,[r,i],"float32")}}const X2t={kernelName:cm,backendName:"webgl",kernelFunc:q2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i}=t,{strides:o,pad:a,dilations:l}=s,c=Wa(r.shape,i.shape,o,l,a),u=new L2t(c);return n.runWebGLProgram(u,[r,i],"float32")}const Z2t={kernelName:um,backendName:"webgl",kernelFunc:Y2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:i}=t,{strides:o,pad:a,filterShape:l}=s,c=Wa(r.shape,l,o,1,a),u=new U2t(c);return n.runWebGLProgram(u,[r,i],"float32")}const J2t={kernelName:Z1,backendName:"webgl",kernelFunc:Q2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tSt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:i}=t,{pad:o,strides:a,inputShape:l}=s,c=Wa(l,i.shape,a,1,o),u=new j2t(c);return n.runWebGLProgram(u,[r,i],"float32")}const eSt={kernelName:Q1,backendName:"webgl",kernelFunc:tSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nSt=Id+`
  return cos(x);
`,sSt=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Bc}
  return result;
`,rSt=jt({opSnippet:nSt,packedOpSnippet:sSt}),iSt={kernelName:bh,backendName:"webgl",kernelFunc:rSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oSt=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,aSt=jt({opSnippet:oSt}),lSt={kernelName:vh,backendName:"webgl",kernelFunc:aSt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cSt{constructor(t,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=t,[u]=n,[h,d]=s;this.outputShape=[u,h,d,c];const f=r==="bilinear"?1:0,[p,g]=[`${a-1}.0`,`${l-1}.0`],[m,x,y]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,v,w]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${v};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uSt=e=>{const{inputs:t,backend:n,attrs:s}=e,{image:r,boxes:i,boxInd:o}=t,{cropSize:a,method:l,extrapolationValue:c}=s,u=new cSt(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},hSt={kernelName:tb,backendName:"webgl",kernelFunc:uSt};var Ap;(function(e){e.Prod="*",e.Sum="+"})(Ap||(Ap={}));class CO{constructor(t,n,s,r){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Ap.Prod?"1.0":"0.0",a=s?o:`getX(${IO(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${se(i)} coords = getOutputCoords();
        int end = ${TO(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${TO(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${IO(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function IO(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function TO(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(e,t,n,s,r,i){const o=t.shape.length,a=Ne([s],o);let l=t;a!=null&&(l=Jn({inputs:{x:t},backend:n,attrs:{perm:a}}));const c=Be(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${s}`);const u=l.shape[c];let h=Ls({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const f=new CO(e,l.shape,!1,i),p=[[d]],g=h;h=n.runWebGLProgram(f,[h],h.dtype,p),n.disposeIntermediateTensorInfo(g)}if(r){const d=new CO(e,l.shape,r,i),f=h;h=n.runWebGLProgram(d,[h],h.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const d=Ua(a),f=Jn({inputs:{x:h},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),f}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dSt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,exclusive:o,reverse:a}=s;return pU(Ap.Prod,r,n,i,o,a)}const fSt={kernelName:J1,backendName:"webgl",kernelFunc:dSt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pSt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,exclusive:o,reverse:a}=s;return pU(Ap.Sum,r,n,i,o,a)}const mSt={kernelName:hm,backendName:"webgl",kernelFunc:pSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gSt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:i}=t,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=H6(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=bbt(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const xSt={kernelName:eb,backendName:"webgl",kernelFunc:gSt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ySt{constructor(t,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bSt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],h=l*i,d=c*i,f=u/(i*i),p=o==="NHWC"?[a,h,d,f]:[a,f,h,d],g=new ySt(p,i,o);return n.runWebGLProgram(g,[r],r.dtype)}const vSt={kernelName:nb,backendName:"webgl",kernelFunc:bSt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mU{constructor(t,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Mn(this.outputShape.length);const o=t.filterHeight,a=t.filterWidth,l=t.outChannels/t.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gU{constructor(t,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Mn(this.outputShape.length);const o=t.outChannels/t.inChannels,a=t.padInfo.left,l=t.strideWidth,c=t.dilationWidth,u=t.filterHeight,h=t.filterWidth,d=h;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<h;x++)f+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let x=0;x<h;x++)f+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(d+1)/2;x++){const y=x*2;if(f+=`
          xC = xCCorner + ${y*c};
          `,l===1){if(y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,c===1&&y>0?f+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<h)){const b=a%2===0?V1(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:f+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?f+=`
                    xC${y+1} = xTexelC${y};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<h&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<h&&(f+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<h&&(f+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<h&&(f+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",g="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wSt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i}=t,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),T(_n(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const h=gn(r.shape,i.shape,o,u,a,c,!0);let d;H().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new gU(h):d=new mU(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[r,i],"float32",f)}const SSt={kernelName:dm,backendName:"webgl",kernelFunc:wSt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kSt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,s=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class CSt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,a=s-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:i}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,h=gn(r.shape,u,o,a,l,c,!0),d=new kSt(h);return n.runWebGLProgram(d,[r,i],"float32")}const TSt={kernelName:sb,backendName:"webgl",kernelFunc:ISt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NSt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:i}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,h=gn(u,i.shape,o,a,l,c,!0),d=new CSt(h);return n.runWebGLProgram(d,[r,i],"float32")}const _St={kernelName:rb,backendName:"webgl",kernelFunc:NSt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $St{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ESt(e){const{inputs:t,backend:n}=e,{x:s}=t,r=[...s.shape,...s.shape],i=X(s.shape),o=lt({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new $St(i),l=n.runWebGLProgram(a,[o],o.dtype),c=lt({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const ASt={kernelName:ib,backendName:"webgl",kernelFunc:ESt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RSt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=t,{top:h,left:d}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DSt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i}=t,{strides:o,pad:a,dilations:l}=s,c=ng(r.shape,i.shape,o,a,"NHWC",l);let u;const h=new RSt(c);u=n.runWebGLProgram(h,[r,i],"float32");const d=lt({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),d}const OSt={kernelName:fm,backendName:"webgl",kernelFunc:DSt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PSt(e){const{inputs:t,backend:n,attrs:s}=e,{equation:r}=s,i=t,{allDims:o,summedDims:a,idDims:l}=IN(r,i.length);NN(o.length,l,i);const{path:c,steps:u}=_N(a,l),h=u.length;let d=null,f=o.length;const p=[];for(let g=0;g<h;++g){for(const m of u[g]){const{permutationIndices:x,expandDims:y}=TN(f,l[m]);let b;$N(x)?b=i[m]:(b=Jn({inputs:{x:i[m]},backend:n,attrs:{perm:x}}),p.push(b));const v=b.shape.slice();for(let w=0;w<y.length;++w)v.splice(y[w],0,1);Pt(b.shape,v)||(b=lt({inputs:{x:b},backend:n,attrs:{shape:v}}),p.push(b)),d===null?d=b:(d=O$({inputs:{a:b,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=lw({inputs:{x:d},backend:n,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const FSt={kernelName:ab,backendName:"webgl",kernelFunc:PSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LSt="return (x >= 0.0) ? x : (exp(x) - 1.0);",MSt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,zSt=jt({opSnippet:LSt,packedOpSnippet:MSt}),BSt={kernelName:Sh,backendName:"webgl",kernelFunc:zSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VSt="return (b >= 0.0) ? a : a * (b + 1.0);",WSt=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,USt=e=>{const{inputs:t,backend:n}=e,{dy:s,y:r}=t,i=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cd(WSt,s.shape,r.shape):new pc(VSt,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},jSt={kernelName:lb,backendName:"webgl",kernelFunc:USt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GSt=`
  return vec4(equal(a, b));
`,HSt="return float(a == b);",KSt=An({opSnippet:HSt,packedOpSnippet:GSt,dtype:"bool",cpuKernelImpl:Cbt}),qSt={kernelName:pm,backendName:"webgl",kernelFunc:KSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XSt=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${yN};
  float a1 = ${bN};
  float a2 = ${vN};
  float a3 = ${wN};
  float a4 = ${SN};
  float a5 = ${kN};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,YSt=jt({opSnippet:XSt}),ZSt={kernelName:kh,backendName:"webgl",kernelFunc:YSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QSt=Id+`
  return exp(x);
`,JSt=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,xU=jt({opSnippet:QSt,packedOpSnippet:JSt,cpuKernelImpl:Ibt,dtype:"float32"}),tkt={kernelName:Ch,backendName:"webgl",kernelFunc:xU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vk(e){const{inputs:t,attrs:n,backend:s}=e,{dim:r}=n,{input:i}=t,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(T(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),lt({inputs:{x:i},backend:s,attrs:{shape:a}})}const ekt={kernelName:mm,backendName:"webgl",kernelFunc:Vk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NO="return exp(x) - 1.0;",nkt=jt({opSnippet:NO,packedOpSnippet:NO,cpuKernelImpl:Tbt}),skt={kernelName:Ih,backendName:"webgl",kernelFunc:nkt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _O{constructor(t,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(t==="real")a="return real * expR - imag * expI;";else if(t==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yU(e,t,n){const s=n.texData.get(e.dataId),r=X(e.shape),i=e.shape[e.shape.length-1],o=r/i,a=lt({inputs:{x:e},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new _O("real",l,t),u=new _O("imag",l,t),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=Xa({inputs:{real:d,imag:f},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f);const g=lt({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rkt(e){const{inputs:t,backend:n}=e,{input:s}=t;return yU(s,!1,n)}const ikt={kernelName:cb,backendName:"webgl",kernelFunc:rkt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class okt{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mg(e){const{backend:t,attrs:n}=e,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||Tc(r),i==="string"){const o=Ee(i,X(s));return o.fill(r),t.makeTensorInfo(s,i,o)}else{const o=new okt(s,r),a=[[r]];return t.runWebGLProgram(o,[],i,a)}}const akt={kernelName:ub,backendName:"webgl",kernelFunc:Mg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lkt{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ckt={kernelName:hb,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:n}=e,s=t,r=new lkt(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $O="return floor(x);",ukt=jt({opSnippet:$O,packedOpSnippet:$O,cpuKernelImpl:Nbt}),hkt={kernelName:Th,backendName:"webgl",kernelFunc:ukt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dkt=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,fkt=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,pkt=An({opSnippet:dkt,packedOpSnippet:fkt,dtype:"int32"}),mkt={kernelName:Nh,backendName:"webgl",kernelFunc:pkt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gkt{constructor(t){this.variableNames=["A"];const n=ss(),[s,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xkt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ss(),[s,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ykt={kernelName:Sy,backendName:"webgl",kernelFunc:bkt};let Gc,y2=H().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function bkt(e){const{inputs:t,backend:n,attrs:s}=e;let{pixels:r}=t;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],h=[c,l,i];if(a||o){const g=H().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Gc==null||g!==y2)&&(y2=g,Gc=document.createElement("canvas").getContext("2d",{willReadFrequently:y2})),Gc.canvas.width=l,Gc.canvas.height=c,Gc.drawImage(r,0,0,l,c),r=Gc.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=Ys.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),r);const f=H().getBool("WEBGL_PACK")?new xkt(h):new gkt(h),p=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vkt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i,bias:o,preluActivationWeights:a}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s,g=Co(u),m=gn(r.shape,i.shape,l,h,c,d,!1,g);let x;const y=[],b=o!=null,v=a!=null,w=f==="leakyrelu",k=()=>{const C=[r,i],N=($,A)=>{if(A==="NCHW"&&$.shape.length===1&&$.shape[0]!==1){const R=lt({inputs:{x:$},backend:n,attrs:{shape:[$.shape[0],1,1]}});return y.push(R),R}return $};if(b&&C.push(N(o,u)),v&&C.push(N(a,u)),w){const $=n.makeTensorInfo([],"float32",So(p,"float32"));C.push($),y.push($)}return C};if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))x=dU({x:r,filter:i,convInfo:m,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(m.strideWidth<=2&&g==="channelsLast"&&H().getBool("WEBGL_EXP_CONV")){const C=f?$p(f,!0):null,N=new hU(m,b,C,v,w),$=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],A=k();x=n.runWebGLProgram(N,A,"float32",$)}else if(H().getBool("WEBGL_CONV_IM2COL"))x=fU({x:r,filter:i,convInfo:m,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const C=f?$p(f,!1):null,N=new uU(m,b,C,v,w),$=k();x=n.runWebGLProgram(N,$,"float32")}const I=lt({inputs:{x},backend:n,attrs:{shape:m.outShape}});return y.push(x),y.forEach(C=>n.disposeIntermediateTensorInfo(C)),I}const wkt={kernelName:pp,backendName:"webgl",kernelFunc:vkt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Skt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:i,bias:o,preluActivationWeights:a}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=s,p=[];let g=u;g==null&&(g=[1,1]),T(_n(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const m=gn(r.shape,i.shape,l,g,c,h,!0),x=H().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,y=d?$p(d,x):null,b=[r,i],v=o!=null,w=a!=null,k=d==="leakyrelu";if(v&&b.push(o),w&&b.push(a),k){const $=n.makeTensorInfo([],"float32",So(f,"float32"));b.push($),p.push($)}let I;x?I=new gU(m,v,y,w,k):I=new mU(m,v,y,w,k);const C=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],N=n.runWebGLProgram(I,b,"float32",C);return p.forEach($=>n.disposeIntermediateTensorInfo($)),N}const kkt={kernelName:mp,backendName:"webgl",kernelFunc:Skt};class Ckt{constructor(t,n,s,r){this.sliceDim=t,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=se(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ikt(e){const{inputs:t,backend:n}=e,{params:s,indices:r}=t,i=r.shape,o=i[i.length-1],a=X(s.shape),[l,c,u,h]=Dv(s,r),d=lt({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),f=lt({inputs:{x:s},backend:n,attrs:{shape:[X(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const x=n.readSync(r.dataId),y=n.bufferSync(s),b=_bt(x,y,s.dtype,c,o,u,h,s.shape,a);return n.makeTensorInfo(l,s.dtype,b.values)}const p=new Ckt(o,h,[c,u],s.shape),g=n.runWebGLProgram(p,[f,d],f.dtype),m=lt({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}const Tkt={kernelName:db,backendName:"webgl",kernelFunc:Ikt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nkt{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=se(this.rank),r=_kt(t);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function _kt(e,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<e.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,indices:i}=t,{axis:o,batchDims:a}=s,l=Dt(o,r.shape)[0];if(H().get("DEBUG")){const y=n.readSync(i.dataId),b=r.shape[l];for(let v=0;v<y.length;++v){const w=y[v];T(w<=b-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${b-1}]`)}}const c=AN(r,i,l,a),u=X(i.shape),h=[],d=lt({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=lt({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const y=n.bufferSync(f),b=n.bufferSync(d),v=$bt(b,y,p);return h.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(c.outputShape,v.dtype,v.values)}const g=new Nkt(d.shape,p),m=n.runWebGLProgram(g,[d,f],d.dtype);h.push(m);const x=lt({inputs:{x:m},backend:n,attrs:{shape:c.outputShape}});return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const $kt={kernelName:xm,backendName:"webgl",kernelFunc:bU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ekt="return float(a > b);",Akt=`
  return vec4(greaterThan(a, b));
`,Rkt=An({opSnippet:Ekt,packedOpSnippet:Akt,cpuKernelImpl:Ebt,dtype:"bool"}),Dkt={kernelName:ym,backendName:"webgl",kernelFunc:Rkt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Okt="return float(a >= b);",Pkt=`
  return vec4(greaterThanEqual(a, b));
`,Fkt=An({opSnippet:Okt,packedOpSnippet:Pkt,dtype:"bool",cpuKernelImpl:Abt}),Lkt={kernelName:_h,backendName:"webgl",kernelFunc:Fkt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mkt(e){const{inputs:t,backend:n}=e,{input:s}=t;return yU(s,!0,n)}const zkt={kernelName:fb,backendName:"webgl",kernelFunc:Mkt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bkt="return float(!isnan(x) && !isinf(x));",Vkt=jt({opSnippet:Bkt,dtype:"bool"}),Wkt={kernelName:Eh,backendName:"webgl",kernelFunc:Vkt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ukt="return float(isinf(x));",jkt=jt({opSnippet:Ukt,dtype:"bool"}),Gkt={kernelName:Ah,backendName:"webgl",kernelFunc:jkt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hkt="return float(isnan(x));",Kkt=jt({opSnippet:Hkt,dtype:"bool"}),qkt={kernelName:Rh,backendName:"webgl",kernelFunc:Kkt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xkt="return float(a < b);",Ykt=`
  return vec4(lessThan(a, b));
`,Zkt=An({opSnippet:Xkt,packedOpSnippet:Ykt,cpuKernelImpl:Rbt,dtype:"bool"}),Qkt={kernelName:vm,backendName:"webgl",kernelFunc:Zkt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jkt="return float(a <= b);",tCt=`
  return vec4(lessThanEqual(a, b));
`,eCt=An({opSnippet:Jkt,packedOpSnippet:tCt,cpuKernelImpl:Dbt,dtype:"bool"}),nCt={kernelName:wm,backendName:"webgl",kernelFunc:eCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sCt(e){const{backend:t,attrs:n}=e,{start:s,stop:r,num:i}=n,o=Obt(s,r,i);return t.makeTensorInfo([o.length],"float32",o)}const rCt={kernelName:mb,backendName:"webgl",kernelFunc:sCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iCt=Id+`
  return x < 0.0 ? 0./0. : log(x);
`,oCt=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,aCt=jt({opSnippet:iCt,packedOpSnippet:oCt,cpuKernelImpl:Pbt}),lCt={kernelName:Dh,backendName:"webgl",kernelFunc:aCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cCt=Id+`
  return log(1.0 + x);
`,uCt=jt({opSnippet:cCt}),hCt={kernelName:Oh,backendName:"webgl",kernelFunc:uCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dCt="return float(a >= 1.0 && b >= 1.0);",fCt=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,pCt=An({opSnippet:dCt,packedOpSnippet:fCt,dtype:"bool"}),mCt={kernelName:Sm,backendName:"webgl",kernelFunc:pCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gCt="return float(!(x >= 1.0));",xCt=jt({opSnippet:gCt}),yCt={kernelName:km,backendName:"webgl",kernelFunc:xCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bCt="return float(a >= 1.0 || b >= 1.0);",vCt=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,wCt=An({opSnippet:bCt,packedOpSnippet:vCt,dtype:"bool"}),SCt={kernelName:Cm,backendName:"webgl",kernelFunc:wCt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kCt{constructor(t,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=t[3]-1;this.outputShape=t;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CCt{constructor(t,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=t[3]-1;this.outputShape=t;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ICt=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=H().getBool("WEBGL_PACK_NORMALIZATION")?new CCt(r.shape,i,o,a,l):new kCt(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},TCt={kernelName:Im,backendName:"webgl",kernelFunc:ICt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NCt{constructor(t,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ct=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r,y:i,dy:o}=t,{depthRadius:a,bias:l,alpha:c,beta:u}=s,h=new NCt(r.shape,a,l,c,u);return n.runWebGLProgram(h,[r,i,o],r.dtype)},$Ct={kernelName:gb,backendName:"webgl",kernelFunc:_Ct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ECt(e,t,n,s){const r=X(t),o=X(e.shape)/r,a=lt({inputs:{x:e},attrs:{shape:[o,r]},backend:s}),l=Vc(a,e.dtype,"max",s),c=lt({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=Dt(i,r.shape);let c=l;const u=Ne(c,a),h=u!=null,d=n.shouldExecuteOnCPU([r]);let f=r;if(h){if(d){const b=n.texData.get(f.dataId).values,v=new Array(a);for(let I=0;I<v.length;I++)v[I]=r.shape[u[I]];const w=R$(b,r.shape,r.dtype,u,v);f=n.makeTensorInfo(v,r.dtype);const k=n.texData.get(f.dataId);k.values=w}else f=aw(r,u,n);c=Be(c.length,a)}$n("max",c,a);const[p,g]=xn(f.shape,c);let m=p;o&&(m=ze(p,l));let x;if(d){const b=n.texData.get(f.dataId).values,v=Fbt(b,X(g),m,r.dtype);x=n.makeTensorInfo(m,r.dtype);const w=n.texData.get(x.dataId);w.values=v}else x=ECt(f,g,m,n);return h&&n.disposeIntermediateTensorInfo(f),x}const ACt={kernelName:Tm,backendName:"webgl",kernelFunc:vU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RCt=D$+`
  return max(a, b);
`,DCt=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bc+`
  return result;
`,OCt=An({opSnippet:RCt,packedOpSnippet:DCt,cpuKernelImpl:Lbt}),PCt={kernelName:Ph,backendName:"webgl",kernelFunc:OCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;bd(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;T(_n(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Nr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Pt(u.inShape,u.outShape))return Ls({inputs:{x:r},backend:n});const h=new Ep(u,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const LCt={kernelName:Nm,backendName:"webgl",kernelFunc:FCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MCt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],h=ko(r.shape,i,o,u,a,c,l),d=new P$(h,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const zCt={kernelName:_m,backendName:"webgl",kernelFunc:MCt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BCt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,s=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,a=i-1-t.padInfo.top,l=o-1-t.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class VCt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,s=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,a=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,u=t.effectiveFilterWidth,h=l-1-t.padInfo.front,d=c-1-t.padInfo.top,f=u-1-t.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:i}=t,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=ko(o.shape,a,l,h,c,u),f=new P$(d,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),g=new VCt(d),m=n.runWebGLProgram(g,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),m}const UCt={kernelName:yb,backendName:"webgl",kernelFunc:WCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jCt(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:i,output:o}=t,a=i;bd([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=Nr(a.shape,l,c,1,u,h),f=!0,p=new Ep(d,"max",f),g=n.runWebGLProgram(p,[a],a.dtype),m=new BCt(d),x=n.runWebGLProgram(m,[r,g],a.dtype);return n.disposeIntermediateTensorInfo(g),x}const GCt={kernelName:xb,backendName:"webgl",kernelFunc:jCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCt(e,t,n,s){let r=new Ep(n,"max",!1);const i=s.runWebGLProgram(r,[e],"float32");r=new Ep(n,"max",!0,!0,t);const o=s.runWebGLProgram(r,[e],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KCt={kernelName:bb,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:s}=e,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=t,l=n;T(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];T(_n(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Nr(s.shape,r,i,c,o),[h,d]=HCt(s,a,u,l);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qCt(e,t,n,s){const r=X(t),o=X(e.shape)/r,a=lt({inputs:{x:e},attrs:{shape:[o,r]},backend:s}),l=Vc(a,"float32","mean",s),c=lt({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XCt={kernelName:$m,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:s}=e,{keepDims:r,axis:i}=t,o=n,a=s.shape.length,l=Dt(i,s.shape);let c=l;const u=Ne(c,a),h=u!=null,d=o.shouldExecuteOnCPU([s]),f=[];let p=s;if(h){if(d){const v=o.texData.get(p.dataId).values,w=new Array(a);for(let C=0;C<w.length;C++)w[C]=s.shape[u[C]];const k=R$(v,s.shape,s.dtype,u,w);p=o.makeTensorInfo(w,s.dtype);const I=o.texData.get(p.dataId);I.values=k}else p=aw(s,u,o);f.push(p),c=Be(c.length,a)}$n("sum",c,a);const[g,m]=xn(p.shape,c);let x=g;r&&(x=ze(g,l));const y=qCt(p,m,x,o);for(const b of f)o.disposeIntermediateTensorInfo(b);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s,a=r.shape.length,l=Dt(i,r.shape);let c=l;const u=Ne(c,a);let h=r;u!=null&&(h=Jn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Be(c.length,r.shape.length)),$n("min",c,a);const[d,f]=xn(h.shape,c),p=X(f),g=lt({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=Vc(g,g.dtype,"min",n);let x;if(o){const y=ze(d,l);x=lt({inputs:{x:m},backend:n,attrs:{shape:y}})}else x=lt({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),x}const ZCt={kernelName:Em,backendName:"webgl",kernelFunc:YCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QCt=D$+`
  return min(a, b);
`,JCt=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bc+`
  return result;
`,tIt=An({opSnippet:QCt,packedOpSnippet:JCt,cpuKernelImpl:Mbt}),eIt={kernelName:Fh,backendName:"webgl",kernelFunc:tIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nIt{constructor(t,n,s){this.variableNames=["x"],this.outputShape=n.map((u,h)=>u[0]+t[h]+u[1]);const r=t.length,i=se(r),o=n.map(u=>u[0]).join(","),a=n.map((u,h)=>u[0]+t[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sIt{constructor(t,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+t[g]+p[1]);const r=t.length,i=se(r),o=n.map(p=>p[0]).join(","),a=n.map((p,g)=>p[0]+t[g]).join(","),l=Kn("rc",r),c=Kn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,d=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${h});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rIt=({inputs:e,backend:t,attrs:n})=>{const{x:s}=e,{paddings:r,mode:i}=n,o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sIt(s.shape,r,i):new nIt(s.shape,r,i);return t.runWebGLProgram(o,[s],s.dtype)},iIt={kernelName:Am,backendName:"webgl",kernelFunc:rIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oIt=`if (b == 0.0) return NAN;
  return mod(a, b);`,aIt=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Bc+`
  return result;
`,lIt=An({opSnippet:oIt,packedOpSnippet:aIt}),cIt={kernelName:Lh,backendName:"webgl",kernelFunc:lIt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uIt{constructor(t,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hIt=`
if (a == b) {
  return 1.0;
};
return a / b;`,dIt=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,wU=An({opSnippet:hIt,packedOpSnippet:dIt,checkOutOfBounds:!0}),fIt={kernelName:wh,backendName:"webgl",kernelFunc:wU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EO="return a - b;",SU=An({opSnippet:EO,packedOpSnippet:EO,supportsComplex:!0,cpuKernelImpl:ivt}),pIt={kernelName:Jh,backendName:"webgl",kernelFunc:SU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{dim:i}=s,o=Dt([i],r.shape),a=vU({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=ze(a.shape,o),c=lt({inputs:{x:a},backend:n,attrs:{shape:l}}),u=SU({inputs:{a:r,b:c},backend:n}),h=xU({inputs:{x:u},backend:n}),d=lw({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),f=lt({inputs:{x:d},backend:n,attrs:{shape:l}}),p=wU({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}const mIt={kernelName:Xm,backendName:"webgl",kernelFunc:kU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gIt(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{numSamples:i,seed:o,normalized:a}=s,l=a?r:kU({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new uIt(c,u,i),d=[[o]],f=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),f}const xIt={kernelName:vb,backendName:"webgl",kernelFunc:gIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yIt=$r+`
  return -x;
`,bIt=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function vIt(e){const{inputs:t,backend:n}=e,{x:s}=t;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=Bbt(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return H().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Zo(s.shape,bIt):r=new fi(s.shape,yIt),n.runWebGLProgram(r,[s],s.dtype)}const wIt={kernelName:Rm,backendName:"webgl",kernelFunc:vIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SIt=$v;function kIt(e){Gs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:i}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:h}=SIt(c,u,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const CIt={kernelName:wb,backendName:"webgl",kernelFunc:kIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IIt=Ev;function TIt(e){Gs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:i}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),h=n.readSync(i.dataId),{selectedIndices:d,validOutputs:f}=IIt(u,h,o,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const NIt={kernelName:Sb,backendName:"webgl",kernelFunc:TIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _It=Av;function $It(e){Gs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:i}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),h=n.readSync(i.dataId),d=o,f=a,p=l,g=c,{selectedIndices:m,selectedScores:x}=_It(u,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const EIt={kernelName:kb,backendName:"webgl",kernelFunc:$It};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AIt{constructor(t,n,s,r){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RIt=e=>{const{inputs:t,backend:n,attrs:s}=e,{indices:r}=t,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=X(r.shape),u=new AIt(c,o,a,l),h=lt({inputs:{x:r},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],i);n.disposeIntermediateTensorInfo(h);const f=[...r.shape,o],p=lt({inputs:{x:d},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(d),p},DIt={kernelName:Pm,backendName:"webgl",kernelFunc:RIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ky(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="complex64"){const r=Lg({inputs:{input:s},backend:n}),i=Ky({inputs:{x:r},backend:n}),o=cw({inputs:{input:s},backend:n}),a=Ky({inputs:{x:o},backend:n}),l=Xa({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Mg({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const OIt={kernelName:Jm,backendName:"webgl",kernelFunc:Ky};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Lg({inputs:{input:s},backend:n}),i=CU({inputs:{x:r},backend:n}),o=cw({inputs:{input:s},backend:n}),a=Ky({inputs:{x:o},backend:n}),l=Xa({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Mg({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const PIt={kernelName:Om,backendName:"webgl",kernelFunc:CU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIt(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s;if(t.length===1)return Vk({inputs:{input:t[0]},backend:n,attrs:{dim:r}});const i=t[0].shape,o=t[0].dtype;t.forEach(u=>{Nn(i,u.shape,"All tensors passed to stack must have matching shapes"),T(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=t.map(u=>{const h=Vk({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(h),h}),c=cU({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const LIt={kernelName:Fm,backendName:"webgl",kernelFunc:FIt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MIt{constructor(t,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+t[u]+c[1]);const r=t.length,i=se(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+t[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zIt{constructor(t,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,m)=>g[0]+t[m]+g[1]);const r=t.length,i=se(r),o=n.map(g=>g[0]).join(","),a=n.map((g,m)=>g[0]+t[m]).join(","),l=Kn("rc",r),c=Kn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,m=r===1?2:4;g<m;g++)p+=`
        ${d[g]}
        if (${f}) {
          result[${g}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${g}] = getChannel(getX(${c.join()}), ${h});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IU=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:i,constantValue:o}=s;if(X(r.shape)===0){const c=i.map((u,h)=>u[0]+r.shape[h]+u[1]);return Mg({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zIt(r.shape,i,o):new MIt(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},BIt={kernelName:Lm,backendName:"webgl",kernelFunc:IU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VIt=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,WIt=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Bc+`
  return result;
`,UIt=An({opSnippet:VIt,packedOpSnippet:WIt}),jIt={kernelName:zh,backendName:"webgl",kernelFunc:UIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=Dt(i,r.shape);let u=c;const h=Ne(u,a);let d=r;h!=null&&(d=Jn({inputs:{x:r},backend:n,attrs:{perm:h}}),u=Be(u.length,a),l.push(d)),$n("prod",u,a);let f;if(n.shouldExecuteOnCPU([d])){const p=n.texData.get(d.dataId).values,{outVals:g,outShape:m,outDtype:x}=Wbt(d.shape,d.dtype,p,u);f=n.makeTensorInfo(m,x,g)}else{const[p,g]=xn(d.shape,u),m=X(g),x=lt({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),y=Xb(r.dtype),b=Vc(x,y,"prod",n);f=lt({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(x),l.push(b)}if(o){l.push(f);const p=ze(f.shape,c);f=lt({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const HIt={kernelName:zm,backendName:"webgl",kernelFunc:GIt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KIt(e){const{inputs:t,backend:n,attrs:s}=e,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=t,{outputRaggedRank:a}=s,l=r.map(x=>n.readSync(x.dataId)),c=r.map(x=>x.shape),u=n.readSync(i.dataId),h=n.readSync(o.dataId),[d,f,p]=Ubt(l,c,u,i.shape,i.dtype,h,o.shape,a),g=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),m=n.makeTensorInfo(p,i.dtype,f);return g.concat([m])}const qIt={kernelName:Cb,backendName:"webgl",kernelFunc:KIt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XIt(e){const{inputs:t,backend:n}=e,{starts:s,limits:r,deltas:i}=t,o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=jbt(o,s.shape,s.dtype,a,r.shape,l,i.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],s.dtype,u);return[h,d]}const YIt={kernelName:Ib,backendName:"webgl",kernelFunc:XIt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIt(e){const{inputs:t,backend:n,attrs:s}=e,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),h=n.readSync(o.dataId),d=a.map(m=>n.readSync(m.dataId)),f=a.map(m=>m.shape),[p,g]=Gbt(c,r.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,g)}const QIt={kernelName:Tb,backendName:"webgl",kernelFunc:ZIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TU=e=>{const{backend:t,attrs:n}=e,{start:s,stop:r,step:i,dtype:o}=n,a=Hbt(s,r,i,o);return t.makeTensorInfo([a.length],o,a)},JIt={kernelName:Nb,backendName:"webgl",kernelFunc:TU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tTt="return 1.0 / x;",eTt=jt({opSnippet:tTt}),nTt={kernelName:Bh,backendName:"webgl",kernelFunc:eTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sTt=$r+`
  return (x < 0.0) ? 0.0 : x;
`,rTt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,iTt=jt({opSnippet:sTt,packedOpSnippet:rTt}),oTt={kernelName:Vh,backendName:"webgl",kernelFunc:iTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aTt=$r+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,lTt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cTt=jt({opSnippet:aTt,packedOpSnippet:lTt}),uTt={kernelName:Wh,backendName:"webgl",kernelFunc:cTt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hTt{constructor(t,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=t;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s];let d;i?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dTt{constructor(t,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=t;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s];let d;i?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fTt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=H().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new dTt(r.shape,l,c,i,o):new hTt(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const pTt={kernelName:Wm,backendName:"webgl",kernelFunc:fTt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mTt{constructor(t,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=t,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gTt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:i}=t,{alignCorners:o}=s,a=new mTt(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const xTt={kernelName:Eb,backendName:"webgl",kernelFunc:gTt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yTt{constructor(t,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=t;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s],d=r?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bTt{constructor(t,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=t;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s],d=r?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vTt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=H().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new bTt(r.shape,l,c,i,o):new yTt(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const wTt={kernelName:Vm,backendName:"webgl",kernelFunc:vTt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class STt{constructor(t,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=t,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kTt(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:i}=t,{alignCorners:o}=s,a=new STt(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const CTt={kernelName:$b,backendName:"webgl",kernelFunc:kTt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ITt{constructor(t,n){this.variableNames=["x"];const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=t,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&t[a]!==1?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`,i=t.map((a,l)=>r(l)).join(","),o=se(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TTt{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=t;const r=Kn("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=se(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${h(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return d(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",d(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",d(p)}function h(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",d(p)}function d(p){const g=t.map((y,b)=>f(b,p)),m=g.join(","),x=g.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${x}))`}function f(p,g){return n.indexOf(p)!==-1&&t[p]!==1?`${t[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NTt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dims:i}=s,o=r.shape.length,a=Dt(i,r.shape);if(o===0)return Ls({inputs:{x:r},backend:n});const l=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TTt(r.shape,a):new ITt(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const _Tt={kernelName:Um,backendName:"webgl",kernelFunc:NTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Tt{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=t[1],r=t[2];this.outputShape=t;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ETt={kernelName:Kb,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,{radians:r,fillValue:i,center:o}=t,a=n,l=new $Tt(s.shape,i),[c,u]=mN(o,s.shape[1],s.shape[2]),h=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ATt=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,RTt=jt({opSnippet:ATt}),DTt={kernelName:Uh,backendName:"webgl",kernelFunc:RTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OTt="return inversesqrt(x);",PTt=jt({opSnippet:OTt,cpuKernelImpl:Kbt}),FTt={kernelName:jh,backendName:"webgl",kernelFunc:PTt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F${constructor(t,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=se(i.length),u=se(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const d=`getIndices(${h})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LTt{constructor(t,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=se(i.length),u=se(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const d=`getIndices(${h})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,x=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MTt(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r,updates:i}=t,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Ka(i,r,o),d=[h/c,c];if(h===0)return n.makeTensorInfo(o,r.dtype);const f=lt({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=lt({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;H().getBool("WEBGL_PACK")?m=new LTt(l,a,f.shape.length,p.shape.length,u,d):m=new F$(l,a,f.shape.length,p.shape.length,u,d);const x=n.runWebGLProgram(m,[p,f,g],p.dtype),y=lt({inputs:{x},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(g),y}const zTt={kernelName:Ab,backendName:"webgl",kernelFunc:MTt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BTt{constructor(t,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=H().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VTt(e){const{inputs:t,backend:n,attrs:s}=e,{sortedSequence:r,values:i}=t,{side:o}=s,a=new BTt(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const WTt={kernelName:Db,backendName:"webgl",kernelFunc:VTt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UTt{constructor(t,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<t&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=se(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jTt(e){const{inputs:t,backend:n}=e,{condition:s,t:r,e:i}=t,o=new UTt(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],hs(r.dtype,i.dtype))}const GTt={kernelName:jm,backendName:"webgl",kernelFunc:jTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HTt=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Fv};
  float scale = ${Lv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,KTt=jt({opSnippet:HTt}),qTt={kernelName:Gh,backendName:"webgl",kernelFunc:KTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XTt=Id+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,YTt=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ZTt=jt({opSnippet:XTt,packedOpSnippet:YTt,cpuKernelImpl:Xbt}),QTt={kernelName:Xh,backendName:"webgl",kernelFunc:ZTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JTt=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,tNt=jt({opSnippet:JTt}),eNt={kernelName:qh,backendName:"webgl",kernelFunc:tNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nNt=Id+`
  return sin(x);
`,sNt=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Bc}
  return result;
`,rNt=jt({opSnippet:nNt,packedOpSnippet:sNt}),iNt={kernelName:Hh,backendName:"webgl",kernelFunc:rNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oNt=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,aNt=jt({opSnippet:oNt}),lNt={kernelName:Kh,backendName:"webgl",kernelFunc:aNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cNt=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,uNt=jt({opSnippet:cNt}),hNt={kernelName:Yh,backendName:"webgl",kernelFunc:uNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dNt=e=>{const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:i,paddings:o}=s;T(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,y)=>x*y),l=[[0,0]];l.push(...o);for(let x=1+i.length;x<r.shape.length;++x)l.push([0,0]);const c=[],u=IU({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),h=vg(u.shape,i,a,!1),d=wg(h.length,i.length,!1),f=Sg(u.shape,i,a,!1),p=lt({inputs:{x:u},backend:n,attrs:{shape:h}}),g=Jn({inputs:{x:p},backend:n,attrs:{perm:d}}),m=lt({inputs:{x:g},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(g),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),m},fNt={kernelName:Km,backendName:"webgl",kernelFunc:dNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pNt(e){const{inputs:t,backend:n}=e,{indices:s,values:r,denseShape:i,defaultValue:o}=t;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[h,d,f,p,g]=Zbt(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const mNt={kernelName:Ob,backendName:"webgl",kernelFunc:pNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gNt(e){const{inputs:t,backend:n}=e,{inputIndices:s,inputShape:r,newShape:i}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,h]=Qbt(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const xNt={kernelName:Pb,backendName:"webgl",kernelFunc:gNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yNt(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:i}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=q6(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const bNt={kernelName:Fb,backendName:"webgl",kernelFunc:yNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vNt(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:i}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=q6(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const wNt={kernelName:Lb,backendName:"webgl",kernelFunc:vNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SNt(e){const{inputs:t,backend:n,attrs:s}=e,{sparseIndices:r,sparseValues:i,defaultValue:o}=t,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=Ka(i,r,a),f=!1;if(i.dtype==="string"){const x=n.bufferSync(r),y=n.bufferSync(i),b=po(n.readSync(o.dataId)[0]),v=qbt(x,y,a,d,u,c,l,h,b,f);return n.makeTensorInfo(a,v.dtype,v.values)}const p=new F$(c,l,r.shape.length,i.shape.length,h,[d,1],f),g=n.runWebGLProgram(p,[i,r,o],i.dtype),m=lt({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),m}const kNt={kernelName:Mb,backendName:"webgl",kernelFunc:SNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CNt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{numOrSizeSplits:i,axis:o}=s,a=Dt(o,r.shape)[0],l=EN(r,i,a),c=r.shape.length,u=new Array(c).fill(0),h=r.shape.slice();return l.map(d=>{const f=[...h];f[a]=d;const p=Td({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,p})}const INt={kernelName:qm,backendName:"webgl",kernelFunc:CNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AO="return sqrt(x);",TNt=jt({opSnippet:AO,packedOpSnippet:AO,cpuKernelImpl:Jbt}),NNt={kernelName:Zh,backendName:"webgl",kernelFunc:TNt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Nt="return x * x;",$Nt=jt({opSnippet:_Nt}),ENt={kernelName:zb,backendName:"webgl",kernelFunc:$Nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RO="return (a - b) * (a - b);",ANt=An({opSnippet:RO,packedOpSnippet:RO}),RNt={kernelName:Qh,backendName:"webgl",kernelFunc:ANt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DNt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(r.dataId),o=bo(i),a=tvt(o,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const ONt={kernelName:Ym,backendName:"webgl",kernelFunc:DNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PNt({inputs:e,attrs:t,backend:n}){const{x:s}=e,r=$r+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,i=new fi(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const FNt={kernelName:sd,backendName:"webgl",kernelFunc:PNt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LNt{constructor(t,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=se(s.length),o=se(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${t});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MNt(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s,{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:x,begin:y,end:b,strides:v}=hN(r.shape,i,o,a,l,c,u,h,d);let w;if(g)w=lt({inputs:{x:r},backend:n,attrs:{shape:p}});else if(m||x){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const I=lN(y,b,v),C=Td({inputs:{x:r},backend:n,attrs:{begin:y,size:I}});w=lt({inputs:{x:C},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(C)}else if(n.shouldExecuteOnCPU([r])){const C=n.readSync(r.dataId),N=Et(r.shape,r.dtype,C),$=evt(f,N,v,y);w=n.makeTensorInfo(p,r.dtype,$.values)}else{const C=new LNt(y,v,f);w=n.runWebGLProgram(C,[r],r.dtype)}const k=lt({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),k}const zNt={kernelName:Bb,backendName:"webgl",kernelFunc:MNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BNt(e){const{inputs:t,backend:n,attrs:s}=e,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=t,d=n.readSync(u.dataId),f=n.readSync(h.dataId),[p,g]=nvt(d,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}const VNt={kernelName:Vb,backendName:"webgl",kernelFunc:BNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WNt(e){const{inputs:t,backend:n,attrs:s}=e,{skipEmpty:r}=s,{input:i,delimiter:o}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,h]=svt(a,l,r),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const UNt={kernelName:Wb,backendName:"webgl",kernelFunc:WNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNt(e){const{inputs:t,backend:n,attrs:s}=e,{numBuckets:r}=s,{input:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=rvt(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const GNt={kernelName:Ub,backendName:"webgl",kernelFunc:jNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HNt="return tan(x);",KNt=jt({opSnippet:HNt}),qNt={kernelName:td,backendName:"webgl",kernelFunc:KNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XNt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,YNt=jt({opSnippet:XNt}),ZNt={kernelName:ed,backendName:"webgl",kernelFunc:YNt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QNt(e){const{inputs:t,backend:n,attrs:s}=e,{tensor:r,indices:i,updates:o}=t,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Ka(o,i,r.shape),d=[h/c,c];if(h===0)return n.makeTensorInfo(r.shape,i.dtype);const f=lt({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=lt({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),g=lt({inputs:{x:r},backend:n,attrs:{shape:d}}),m=new F$(l,a,f.shape.length,p.shape.length,u,d,!1,!0),x=n.runWebGLProgram(m,[p,f,g],g.dtype),y=lt({inputs:{x},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),y}const JNt={kernelName:Rb,backendName:"webgl",kernelFunc:QNt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t_t{constructor(t,n){this.variableNames=["A"];const s=new Array(t.length);for(let o=0;o<s.length;o++)s[o]=t[o]*n[o];this.outputShape=s,this.rank=s.length;const r=se(this.rank),i=e_t(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function e_t(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<e.length;r++)s.push(`imod(${n[r]}, ${e[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(d=>po(d)):l,u=Et(r.shape,r.dtype,c),h=ovt(u,i);return n.makeTensorInfo(h.shape,h.dtype,h.values)}const o=new t_t(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const n_t={kernelName:nd,backendName:"webgl",kernelFunc:NU};class s_t{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class r_t{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tl(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function DO(e){let t=1;for(;t<e;)t*=2;return t}function i_t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{k:i,sorted:o}=s,a=H().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=H().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const $=n.readSync(r.dataId),[A,R]=avt($,c,r.dtype,i,o);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(R.shape,R.dtype,R.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,Mg({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const h=n.texData.get(r.dataId),d=h!==null&&h.isPacked,f=d?n.unpackTensor(r):r,g=X(c)/u,m=lt({inputs:{x:f},attrs:{shape:[g,u]},backend:n});d&&tl(n,f);const x=DO(i),y=DO(u);let b=null;const v=()=>b===null?[m,m]:[m,b],w=($,A,R)=>{const z=v(),U=new s_t(R),P=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[$],[A]],L=b;b=n.runWebGLProgram(U,z,"int32",P),tl(n,L)};for(let $=1;$<x;$*=2){const A=$*2;for(let R=$;R>=1;R/=2)w(A,R,[g,y])}for(let $=y;$>x;$/=2){const A=v(),R=new r_t([g,$/2]),U=[[u],[b===null?1:0],[x]],F=b;b=n.runWebGLProgram(R,A,"int32",U),tl(n,F);const P=x/2,L=P*2;for(let E=P;E>=1;E/=2)w(L,E,b.shape)}let k=b;b=Td({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,i]}}),tl(n,k);let I=bU({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});tl(n,m);const C=c.slice(0,-1);C.push(i),k=b,b=lt({inputs:{x:b},attrs:{shape:C},backend:n}),tl(n,k);const N=I;return I=lt({inputs:{x:I},attrs:{shape:C},backend:n}),tl(n,N),[I,b]}const o_t={kernelName:jb,backendName:"webgl",kernelFunc:i_t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a_t{constructor(t,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l_t(e){const{inputs:t,backend:n,attrs:s}=e,{image:r,transforms:i}=t,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,h,d,f]=r.shape,[p,g]=c??[h,d],m=[u,p,g,f],x=new a_t(h,d,o,a,l,m);return n.runWebGLProgram(x,[r,i],"float32")}const c_t={kernelName:Gb,backendName:"webgl",kernelFunc:l_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_t(e){const{inputs:t,attrs:n,backend:s}=e,{axis:r}=n,{x:i}=t;bd(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=lvt(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const h_t={kernelName:Hb,backendName:"webgl",kernelFunc:u_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_t(e){const{inputs:t,backend:n,attrs:s}=e,{value:r}=t;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let g=0;g<a;g++)g!==i&&(c[u++]=o.shape[g]);const h=[],d=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let g=0;g<p.length;g++){d[i]=g;const m=Td({inputs:{x:o},backend:n,attrs:{begin:d,size:f}}),x=lt({inputs:{x:m},backend:n,attrs:{shape:c}});p[g]=x,h.push(m)}return h.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const f_t={kernelName:Zm,backendName:"webgl",kernelFunc:d_t};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p_t{constructor(t,n){this.variableNames=["x","segmentIds"];const s=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,h=s%4,d=`
        sumValue += dot(values, segFilter);
    `;let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m_t(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,segmentIds:i}=t,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=Ne([c],a);let h=r;u!=null&&(h=Jn({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(h),c=Be(1,a)[0]);const d=rV(h.shape,c,o),f=X([h.shape[c]]),p=lt({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(p);const g=Xb(r.dtype),m=(v,w,k,I,C)=>{const N=v.shape[0],$=v.shape[1],A=sV($,C),R={windowSize:A,inSize:$,batchSize:N,numSegments:C},z=new p_t(R,w),U=n.compileAndRun(z,[v,k],I);if(l.push(U),U.shape[1]===C)return U;const F=TU({backend:n,attrs:{start:0,stop:C,step:1,dtype:"float32"}}),P=NU({inputs:{x:F},backend:n,attrs:{reps:[$/A]}});return l.push(F),l.push(P),m(U,w,P,I,C)},x=m(p,"unsortedSegmentSum",i,g,o),y=lt({inputs:{x},backend:n,attrs:{shape:d}});let b=y;if(u!=null){l.push(y);const v=Ua(u);b=Jn({inputs:{x:b},backend:n,attrs:{perm:v}})}return l.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const g_t={kernelName:Qm,backendName:"webgl",kernelFunc:m_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x_t=[twt,nwt,iwt,lwt,uwt,fwt,mwt,xwt,wwt,kwt,Twt,$wt,Rwt,Fwt,zwt,Vwt,Uwt,Kwt,Xwt,Zwt,e2t,l2t,u2t,p2t,g2t,S2t,C2t,_2t,Lvt,A2t,F2t,B2t,H2t,X2t,Z2t,J2t,eSt,iSt,lSt,hSt,fSt,mSt,xSt,vSt,SSt,TSt,_St,ASt,OSt,FSt,BSt,jSt,qSt,ZSt,tkt,ekt,skt,ikt,akt,ckt,hkt,mkt,ykt,wkt,kkt,Tkt,$kt,Dkt,Lkt,Fvt,zkt,O2t,Wkt,Gkt,qkt,zvt,Qkt,nCt,rCt,lCt,hCt,mCt,yCt,SCt,TCt,$Ct,ACt,PCt,LCt,zCt,UCt,GCt,KCt,XCt,ZCt,eIt,iIt,cIt,xIt,Wvt,wIt,CIt,NIt,EIt,y2t,DIt,PIt,LIt,BIt,jIt,Vvt,HIt,qIt,YIt,QIt,JIt,b2t,fIt,nTt,oTt,uTt,jvt,pTt,xTt,wTt,CTt,_Tt,ETt,DTt,FTt,zTt,WTt,GTt,qTt,QTt,eNt,iNt,lNt,o2t,mIt,hNt,fNt,mNt,xNt,bNt,wNt,kNt,INt,NNt,ENt,RNt,ONt,FNt,zNt,VNt,UNt,GNt,pIt,Zvt,qNt,ZNt,JNt,n_t,o_t,c_t,Qvt,h_t,f_t,g_t,OIt];for(const e of x_t)qb(e);/** @license See the LICENSE file. */const y_t="4.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b_t={"tfjs-core":OB,"tfjs-backend-cpu":LW,"tfjs-backend-webgl":Z6,"tfjs-data":V5,"tfjs-layers":Yv,"tfjs-converter":I5,tfjs:y_t},Yc=Object.freeze(Object.defineProperty({__proto__:null,Abs:Zp,Acos:ch,Acosh:uh,AdadeltaOptimizer:QT,AdagradOptimizer:JT,AdamOptimizer:tN,AdamaxOptimizer:eN,Add:_c,AddN:Qp,All:U1,Any:j1,ArgMax:Jp,ArgMin:tm,Asin:hh,Asinh:dh,Atan:fh,Atan2:mh,Atanh:ph,AvgPool:em,AvgPool3D:nm,AvgPool3DGrad:H1,AvgPoolGrad:G1,BatchMatMul:sm,BatchToSpaceND:rm,Bincount:K1,BitwiseAnd:im,BroadcastArgs:q1,BroadcastTo:$4,Callback:v5,CallbackList:kV,Cast:gh,Ceil:xh,ClipByValue:yh,Complex:X1,ComplexAbs:om,Concat:am,Conv2D:lm,Conv2DBackpropFilter:Y1,Conv2DBackpropInput:cm,Conv3D:um,Conv3DBackpropFilterV2:Z1,Conv3DBackpropInputV2:Q1,Cos:bh,Cosh:vh,CropAndResize:tb,Cumprod:J1,Cumsum:hm,CustomCallback:IV,DataStorage:kI,DenseBincount:eb,DepthToSpace:nb,DepthwiseConv2dNative:dm,DepthwiseConv2dNativeBackpropFilter:sb,DepthwiseConv2dNativeBackpropInput:rb,Diag:ib,Dilation2D:fm,Dilation2DBackpropFilter:wy,Dilation2DBackpropInput:vy,Draw:ob,get ENV(){return _I},EarlyStopping:w5,Einsum:ab,Elu:Sh,EluGrad:lb,Environment:N4,Equal:pm,Erf:kh,Exp:Ch,ExpandDims:mm,Expm1:Ih,FFT:cb,Fill:ub,FlipLeftRight:hb,Floor:Th,FloorDiv:Nh,FromPixels:Sy,FusedBatchNorm:gm,FusedConv2D:pp,FusedDepthwiseConv2D:mp,GPGPUContext:hx,GatherNd:db,GatherV2:xm,GraphModel:l$,Greater:ym,GreaterEqual:_h,History:CV,IFFT:fb,Identity:$h,Imag:pb,InputSpec:Ke,IsFinite:Eh,IsInf:Ah,IsNan:Rh,KernelBackend:B1,LRN:Im,LRNGrad:gb,LayerVariable:bV,LayersModel:io,LeakyRelu:bm,Less:vm,LessEqual:wm,LinSpace:mb,Log:Dh,Log1p:Oh,LogSoftmax:E4,LogicalAnd:Sm,LogicalNot:km,LogicalOr:Cm,LogicalXor:rZ,LowerBound:iZ,MathBackendCPU:Rg,MathBackendWebGL:Fg,MatrixBandPart:oZ,Max:Tm,MaxPool:Nm,MaxPool3D:_m,MaxPool3DGrad:yb,MaxPoolGrad:xb,MaxPoolWithArgmax:bb,Maximum:Ph,Mean:$m,Min:Em,Minimum:Fh,MirrorPad:Am,Mod:Lh,MomentumOptimizer:nN,Multinomial:vb,Multiply:Mh,Neg:Rm,NonMaxSuppressionV3:wb,NonMaxSuppressionV4:Sb,NonMaxSuppressionV5:kb,NotEqual:Dm,OP_SCOPE_SUFFIX:OI,OneHot:Pm,OnesLike:Om,Optimizer:_o,OptimizerConstructors:PB,Pack:Fm,PadV2:Lm,Pool:aZ,Pow:zh,Prelu:Mm,Prod:zm,RMSPropOptimizer:sN,RNN:si,RaggedGather:Cb,RaggedRange:Ib,RaggedTensorToTensor:Tb,Range:Nb,get Rank(){return XS},Real:_b,RealDiv:wh,Reciprocal:Bh,get Reduction(){return Hn},Relu:Vh,Relu6:Wh,Reshape:Bm,ResizeBilinear:Wm,ResizeBilinearGrad:Eb,ResizeNearestNeighbor:Vm,ResizeNearestNeighborGrad:$b,Reverse:Um,RotateWithOffset:Kb,Round:Uh,Rsqrt:jh,SGDOptimizer:Rv,ScatterNd:Ab,SearchSorted:Db,Select:jm,Selu:Gh,Sequential:lc,Sigmoid:Xh,Sign:qh,Sin:Hh,Sinh:Kh,Slice:Gm,Softmax:Xm,Softplus:Yh,SpaceToBatchND:Km,SparseFillEmptyRows:Ob,SparseReshape:Pb,SparseSegmentMean:Fb,SparseSegmentSum:Lb,SparseToDense:Mb,SplitV:qm,Sqrt:Zh,Square:zb,SquaredDifference:Qh,StaticRegexReplace:Ym,Step:sd,StridedSlice:Bb,StringNGrams:Vb,StringSplit:Wb,StringToHashBucketFast:Ub,Sub:Jh,Sum:Hm,SymbolicTensor:Zr,Tan:td,Tanh:ed,Tensor:Ut,TensorBuffer:Xe,TensorScatterUpdate:Rb,Tile:nd,TopK:jb,Transform:Gb,Transpose:Dl,Unique:Hb,Unpack:Zm,UnsortedSegmentSum:Qm,UpperBound:lZ,Variable:yp,ZerosLike:Jm,_FusedMatMul:fp,abs:je,acos:WI,acosh:UI,add:tt,addN:uz,all:Qb,any:vp,argMax:ec,argMin:jI,asin:GI,asinh:HI,atan:KI,atan2:qI,atanh:XI,avgPool:sg,avgPool3d:ZI,backend:FI,backend_util:oV,basicLSTMCell:hz,batchNorm:rd,batchNorm2d:QI,batchNorm3d:JI,batchNorm4d:tT,batchToSpaceND:rg,bincount:eT,bitwiseAnd:dz,booleanMaskAsync:Zz,broadcastArgs:fz,broadcastTo:Ol,broadcast_util:zJ,browser:sit,buffer:Et,callbacks:vht,cast:ot,ceil:nT,clipByValue:fs,clone:yi,complex:go,concat:Me,concat1d:sT,concat2d:rT,concat3d:iT,concat4d:oT,constraints:ilt,conv1d:Jb,conv2d:xo,conv2dTranspose:tv,conv3d:lT,conv3dTranspose:cT,copyRegisteredKernels:dZ,cos:ig,cosh:ev,cosineWindow:Cv,cumprod:kp,cumsum:nv,customGrad:Ni,data:Dft,denseBincount:Ty,deprecationWarn:UZ,depthToSpace:uT,depthwiseConv2d:id,deregisterOp:kht,device_util:LZ,diag:mz,dilation2d:hT,disableDeprecationWarnings:WZ,dispose:Ct,disposeVariables:jZ,div:gt,divNoNan:dT,dot:fT,dropout:KT,einsum:ml,elu:od,enableDebugMode:VZ,enableProdMode:BZ,enclosingPowerOfTwo:qT,engine:Pr,ensureShape:gz,env:H,equal:Os,erf:sv,euclideanNorm:mT,exp:ps,expandDims:wn,expm1:gT,eye:rv,fft:yg,fill:Ec,findBackend:YZ,findBackendFactory:ZZ,floor:ld,floorDiv:Zb,forceHalfFloat:Q6,fused:oB,gather:cd,gatherND:eB,gather_util:rit,getBackend:Y4,getGradient:HS,getKernel:xp,getKernelsForBackend:ky,gpgpu_util:gbt,grad:Stt,grads:ktt,greater:ns,greaterEqual:Io,ifft:Ku,imag:og,image:wr,inTopKAsync:nB,initializers:wlt,input:zV,io:oN,irfft:yv,isFinite:xT,isInf:yT,isNaN:bT,keep:Je,kernel_impls:fit,layers:Yut,leakyRelu:ag,less:Uu,lessEqual:ja,linalg:ZT,linspace:bz,loadGraphModel:qdt,loadGraphModelSync:Xdt,loadLayersModel:hct,localResponseNormalization:vT,log:Ps,log1p:lg,logSigmoid:wT,logSoftmax:ov,logSumExp:cg,logicalAnd:Tr,logicalNot:ug,logicalOr:av,logicalXor:ST,losses:fB,lowerBound:wz,matMul:Rt,math:qrt,max:tr,maxPool:hg,maxPool3d:kT,maxPoolWithArgmax:Sz,maximum:Ei,mean:ke,memory:ek,meshgrid:kz,metrics:fht,min:Wu,minimum:Ta,mirrorPad:CT,mod:IT,model:pct,models:pht,moments:dg,movingAverage:Qz,mul:M,multiRNNCell:Cz,multinomial:Iz,neg:oe,nextFrame:dN,norm:ad,notEqual:rc,oneHot:ju,ones:ls,onesLike:Fs,op:O,outerProduct:Tz,pad:To,pad1d:Nz,pad2d:_z,pad3d:$z,pad4d:Ez,pool:TT,pow:Ti,prelu:pg,print:VI,prod:NT,profile:GZ,raggedGather:Az,raggedRange:Rz,raggedTensorToTensor:Dz,rand:Oz,randomGamma:Mz,randomNormal:cv,randomStandardNormal:zz,randomUniform:Ga,randomUniformInt:Bz,range:ic,ready:qZ,real:Gu,reciprocal:LT,registerBackend:PI,registerCallbackConstructor:gct,registerGradient:A4,registerKernel:qb,registerOp:Sht,regularizers:yht,relu:ei,relu6:uv,removeBackend:XZ,reshape:V,reverse:sr,reverse1d:Vz,reverse2d:Wz,reverse3d:Uz,reverse4d:jz,rfft:bg,round:hv,rsqrt:dv,scalar:yt,scatterND:Jz,scatter_util:Nnt,searchSorted:lv,selu:fv,separableConv2d:pv,sequential:mct,serialization:_rt,setBackend:KZ,setPlatform:QZ,setWebGLContext:t6,setdiff1dAsync:Gz,shared:FW,sigmoid:jr,sign:MT,signal:dB,sin:mv,sinh:gv,slice:zt,slice1d:mg,slice2d:xv,slice3d:gg,slice4d:Hu,slice_util:DB,softmax:xg,softplus:Ac,spaceToBatchND:fg,sparse:pB,sparseToDense:tB,spectral:hB,split:us,sqrt:pn,square:ee,squaredDifference:bv,squeeze:Ha,stack:Qn,step:Dc,stridedSlice:zT,string:mB,sub:dt,sum:ft,sumOutType:Xb,tan:BT,tanh:Ia,tensor:Ds,tensor1d:cn,tensor2d:ro,tensor3d:VT,tensor4d:Hz,tensor5d:Kz,tensor6d:qz,tensorScatterUpdate:Xz,tensor_util:RZ,test_util:Bet,tidy:G,tile:Xs,time:HZ,topk:UT,train:hl,transpose:Ft,truncatedNormal:wv,unique:jT,unregisterGradient:hZ,unregisterKernel:uZ,unsortedSegmentSum:Sv,unstack:rr,upcastType:hs,upperBound:Yz,util:vZ,valueAndGrad:Ctt,valueAndGrads:Itt,variable:GT,variableGrads:vz,version:b_t,version_converter:I5,version_core:OB,version_cpu:LW,version_layers:Yv,version_webgl:Z6,webgl:Pvt,webgl_util:S1t,where:dn,whereAsync:HT,zeros:He,zerosLike:Bt},Symbol.toStringTag,{value:"Module"}));(function(e,t){for(var n=mc,s=e();;)try{var r=-parseInt(n(400))/1*(parseInt(n(409))/2)+parseInt(n(388))/3+parseInt(n(403))/4*(-parseInt(n(387))/5)+parseInt(n(395))/6*(parseInt(n(399))/7)+-parseInt(n(397))/8+-parseInt(n(402))/9*(-parseInt(n(404))/10)+parseInt(n(392))/11*(parseInt(n(396))/12);if(r===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(qy,753833);var v_t=function(){var e=!0;return function(t,n){var s=e?function(){var r=mc;if(n){var i=n[r(394)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();function mc(e,t){var n=qy();return mc=function(s,r){s=s-386;var i=n[s];return i},mc(e,t)}(function(){v_t(this,function(){var e=mc,t=new RegExp("function *\\( *\\)"),n=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),s=OO("init");!t[e(410)](s+e(390))||!n[e(410)](s+"input")?s("0"):OO()})()})();function w_t(e){var t=mc;return e[t(411)]().replace(/[^a-z0-9\s]/g,"")[t(398)](/\s+/)[t(389)](Boolean)}function OO(e){function t(n){var s=mc;if(typeof n===s(406))return(function(r){})[s(407)](s(386)).apply("counter");(""+n/n)[s(408)]!==1||n%20===0?(function(){return!0})[s(407)](s(401)+s(393))[s(405)]("action"):(function(){return!1})[s(407)](s(401)+"gger").apply(s(391)),t(++n)}try{if(e)return t;t(0)}catch{}}function qy(){var e=["101912GudENA","debu","13536405CgRvBw","4mcHskv","10wEOWuA","call","string","constructor","length","28iTwGZC","test","toLowerCase","while (true) {}","6038705CUvGfo","1404087OKXJjh","filter","chain","stateObject","77PIQxIq","gger","apply","2116170AcUPVY","1672584pePotg","7761488IbdvCZ","split","28MuAhCn"];return qy=function(){return e},qy()}function Xy(){const e=["gger","debu","every","No matching terms in query.","forEach","while (true) {}","fill","chain","979245RsbFSg","test","transpose","constructor","353563TcPTlV","indexOf","7327860uyDQeN","string","dot","function *\\( *\\)","2RuuRcr","102272ysSyko","36NNuKIg","init","action","input","328512CHxSNm","stateObject","apply","10RTZlgf","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","length","1641955FJaCwA","958866MFDKtP","counter"];return Xy=function(){return e},Xy()}(function(e,t){const n=gc,s=e();for(;;)try{if(parseInt(n(428))/1*(-parseInt(n(401))/2)+parseInt(n(424))/3+-parseInt(n(407))/4*(parseInt(n(410))/5)+-parseInt(n(414))/6+-parseInt(n(413))/7+parseInt(n(402))/8*(parseInt(n(403))/9)+parseInt(n(430))/10===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(Xy,198142);const S_t=function(){let e=!0;return function(t,n){const s=e?function(){const r=gc;if(n){const i=n[r(409)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();function gc(e,t){const n=Xy();return gc=function(s,r){return s=s-401,n[s]},gc(e,t)}(function(){S_t(this,function(){const e=gc,t=new RegExp(e(433)),n=new RegExp(e(411),"i"),s=PO(e(404));!t[e(425)](s+e(423))||!n[e(425)](s+e(406))?s("0"):PO()})()})();function k_t(e,t,n){const s=gc,r=w_t(e),i=new Array(t[s(412)])[s(422)](0);if(r[s(420)](c=>{const u=s,h=t[u(429)](c);h!==-1&&(i[h]+=1)}),i[s(418)](c=>c===0))throw new Error(s(419));const o=cn(i),a=ro(n);return Yc[s(432)](o,a[s(426)]())}function PO(e){function t(n){const s=gc;if(typeof n===s(431))return(function(r){})[s(427)](s(421)).apply(s(415));(""+n/n).length!==1||n%20===0?(function(){return!0})[s(427)](s(417)+s(416)).call(s(405)):(function(){return!1})[s(427)](s(417)+s(416))[s(409)](s(408)),t(++n)}try{if(e)return t;t(0)}catch{}}/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function zg(e){return e+.5|0}const Qo=(e,t,n)=>Math.max(Math.min(e,n),t);function uf(e){return Qo(zg(e*2.55),0,255)}function pa(e){return Qo(zg(e*255),0,255)}function Ui(e){return Qo(zg(e/2.55)/100,0,1)}function FO(e){return Qo(zg(e*100),0,100)}const hr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Wk=[..."0123456789ABCDEF"],C_t=e=>Wk[e&15],I_t=e=>Wk[(e&240)>>4]+Wk[e&15],N0=e=>(e&240)>>4===(e&15),T_t=e=>N0(e.r)&&N0(e.g)&&N0(e.b)&&N0(e.a);function N_t(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&hr[e[1]]*17,g:255&hr[e[2]]*17,b:255&hr[e[3]]*17,a:t===5?hr[e[4]]*17:255}:(t===7||t===9)&&(n={r:hr[e[1]]<<4|hr[e[2]],g:hr[e[3]]<<4|hr[e[4]],b:hr[e[5]]<<4|hr[e[6]],a:t===9?hr[e[7]]<<4|hr[e[8]]:255})),n}const __t=(e,t)=>e<255?t(e):"";function $_t(e){var t=T_t(e)?C_t:I_t;return e?"#"+t(e.r)+t(e.g)+t(e.b)+__t(e.a,t):void 0}const E_t=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function _U(e,t,n){const s=t*Math.min(n,1-n),r=(i,o=(i+e/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function A_t(e,t,n){const s=(r,i=(r+e/60)%6)=>n-n*t*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function R_t(e,t,n){const s=_U(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)s[r]*=1-t-n,s[r]+=t;return s}function D_t(e,t,n,s,r){return e===r?(t-n)/s+(t<n?6:0):t===r?(n-e)/s+2:(e-t)/s+4}function L$(e){const n=e.r/255,s=e.g/255,r=e.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,c,u;return i!==o&&(u=i-o,c=a>.5?u/(2-i-o):u/(i+o),l=D_t(n,s,r,u,i),l=l*60+.5),[l|0,c||0,a]}function M$(e,t,n,s){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,s)).map(pa)}function z$(e,t,n){return M$(_U,e,t,n)}function O_t(e,t,n){return M$(R_t,e,t,n)}function P_t(e,t,n){return M$(A_t,e,t,n)}function $U(e){return(e%360+360)%360}function F_t(e){const t=E_t.exec(e);let n=255,s;if(!t)return;t[5]!==s&&(n=t[6]?uf(+t[5]):pa(+t[5]));const r=$U(+t[2]),i=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?s=O_t(r,i,o):t[1]==="hsv"?s=P_t(r,i,o):s=z$(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function L_t(e,t){var n=L$(e);n[0]=$U(n[0]+t),n=z$(n),e.r=n[0],e.g=n[1],e.b=n[2]}function M_t(e){if(!e)return;const t=L$(e),n=t[0],s=FO(t[1]),r=FO(t[2]);return e.a<255?`hsla(${n}, ${s}%, ${r}%, ${Ui(e.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const LO={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},MO={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function z_t(){const e={},t=Object.keys(MO),n=Object.keys(LO);let s,r,i,o,a;for(s=0;s<t.length;s++){for(o=a=t[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,LO[i]);i=parseInt(MO[o],16),e[a]=[i>>16&255,i>>8&255,i&255]}return e}let _0;function B_t(e){_0||(_0=z_t(),_0.transparent=[0,0,0,0]);const t=_0[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const V_t=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function W_t(e){const t=V_t.exec(e);let n=255,s,r,i;if(t){if(t[7]!==s){const o=+t[7];n=t[8]?uf(o):Qo(o*255,0,255)}return s=+t[1],r=+t[3],i=+t[5],s=255&(t[2]?uf(s):Qo(s,0,255)),r=255&(t[4]?uf(r):Qo(r,0,255)),i=255&(t[6]?uf(i):Qo(i,0,255)),{r:s,g:r,b:i,a:n}}}function U_t(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Ui(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const b2=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Hc=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function j_t(e,t,n){const s=Hc(Ui(e.r)),r=Hc(Ui(e.g)),i=Hc(Ui(e.b));return{r:pa(b2(s+n*(Hc(Ui(t.r))-s))),g:pa(b2(r+n*(Hc(Ui(t.g))-r))),b:pa(b2(i+n*(Hc(Ui(t.b))-i))),a:e.a+n*(t.a-e.a)}}function $0(e,t,n){if(e){let s=L$(e);s[t]=Math.max(0,Math.min(s[t]+s[t]*n,t===0?360:1)),s=z$(s),e.r=s[0],e.g=s[1],e.b=s[2]}}function EU(e,t){return e&&Object.assign(t||{},e)}function zO(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=pa(e[3]))):(t=EU(e,{r:0,g:0,b:0,a:1}),t.a=pa(t.a)),t}function G_t(e){return e.charAt(0)==="r"?W_t(e):F_t(e)}class Rp{constructor(t){if(t instanceof Rp)return t;const n=typeof t;let s;n==="object"?s=zO(t):n==="string"&&(s=N_t(t)||B_t(t)||G_t(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=EU(this._rgb);return t&&(t.a=Ui(t.a)),t}set rgb(t){this._rgb=zO(t)}rgbString(){return this._valid?U_t(this._rgb):void 0}hexString(){return this._valid?$_t(this._rgb):void 0}hslString(){return this._valid?M_t(this._rgb):void 0}mix(t,n){if(t){const s=this.rgb,r=t.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-c,s.r=255&c*s.r+i*r.r+.5,s.g=255&c*s.g+i*r.g+.5,s.b=255&c*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(t,n){return t&&(this._rgb=j_t(this._rgb,t._rgb,n)),this}clone(){return new Rp(this.rgb)}alpha(t){return this._rgb.a=pa(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=zg(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return $0(this._rgb,2,t),this}darken(t){return $0(this._rgb,2,-t),this}saturate(t){return $0(this._rgb,1,t),this}desaturate(t){return $0(this._rgb,1,-t),this}rotate(t){return L_t(this._rgb,t),this}}/*!
 * Chart.js v4.4.4
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function Oi(){}const H_t=(()=>{let e=0;return()=>e++})();function Kt(e){return e===null||typeof e>"u"}function Ce(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Wt(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Pe(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function Vs(e,t){return Pe(e)?e:t}function At(e,t){return typeof e>"u"?t:e}const K_t=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,AU=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function ce(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function Jt(e,t,n,s){let r,i,o;if(Ce(e))for(i=e.length,r=0;r<i;r++)t.call(n,e[r],r);else if(Wt(e))for(o=Object.keys(e),i=o.length,r=0;r<i;r++)t.call(n,e[o[r]],o[r])}function Yy(e,t){let n,s,r,i;if(!e||!t||e.length!==t.length)return!1;for(n=0,s=e.length;n<s;++n)if(r=e[n],i=t[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function Zy(e){if(Ce(e))return e.map(Zy);if(Wt(e)){const t=Object.create(null),n=Object.keys(e),s=n.length;let r=0;for(;r<s;++r)t[n[r]]=Zy(e[n[r]]);return t}return e}function RU(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function q_t(e,t,n,s){if(!RU(e))return;const r=t[e],i=n[e];Wt(r)&&Wt(i)?Dp(r,i,s):t[e]=Zy(i)}function Dp(e,t,n){const s=Ce(t)?t:[t],r=s.length;if(!Wt(e))return e;n=n||{};const i=n.merger||q_t;let o;for(let a=0;a<r;++a){if(o=s[a],!Wt(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)i(l[c],e,o,n)}return e}function Rf(e,t){return Dp(e,t,{merger:X_t})}function X_t(e,t,n){if(!RU(e))return;const s=t[e],r=n[e];Wt(s)&&Wt(r)?Rf(s,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Zy(r))}const BO={"":e=>e,x:e=>e.x,y:e=>e.y};function Y_t(e){const t=e.split("."),n=[];let s="";for(const r of t)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Z_t(e){const t=Y_t(e);return n=>{for(const s of t){if(s==="")break;n=n&&n[s]}return n}}function Ra(e,t){return(BO[t]||(BO[t]=Z_t(t)))(e)}function B$(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Op=e=>typeof e<"u",Da=e=>typeof e=="function",VO=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function Q_t(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const ve=Math.PI,ye=2*ve,J_t=ye+ve,Qy=Number.POSITIVE_INFINITY,t$t=ve/180,qe=ve/2,el=ve/4,WO=ve*2/3,Jo=Math.log10,Si=Math.sign;function Df(e,t,n){return Math.abs(e-t)<n}function UO(e){const t=Math.round(e);e=Df(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Jo(e))),s=e/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function e$t(e){const t=[],n=Math.sqrt(e);let s;for(s=1;s<n;s++)e%s===0&&(t.push(s),t.push(e/s));return n===(n|0)&&t.push(n),t.sort((r,i)=>r-i).pop(),t}function th(e){return!isNaN(parseFloat(e))&&isFinite(e)}function n$t(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function DU(e,t,n){let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s][n],isNaN(i)||(t.min=Math.min(t.min,i),t.max=Math.max(t.max,i))}function Br(e){return e*(ve/180)}function V$(e){return e*(180/ve)}function jO(e){if(!Pe(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function OU(e,t){const n=t.x-e.x,s=t.y-e.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*ve&&(i+=ye),{angle:i,distance:r}}function Uk(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function s$t(e,t){return(e-t+J_t)%ye-ve}function js(e){return(e%ye+ye)%ye}function Pp(e,t,n,s){const r=js(e),i=js(t),o=js(n),a=js(i-r),l=js(o-r),c=js(r-i),u=js(r-o);return r===i||r===o||s&&i===o||a>l&&c<u}function Cn(e,t,n){return Math.max(t,Math.min(n,e))}function r$t(e){return Cn(e,-32768,32767)}function Xi(e,t,n,s=1e-6){return e>=Math.min(t,n)-s&&e<=Math.max(t,n)+s}function W$(e,t,n){n=n||(o=>e[o]<t);let s=e.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Yi=(e,t,n,s)=>W$(e,n,s?r=>{const i=e[r][t];return i<n||i===n&&e[r+1][t]===n}:r=>e[r][t]<n),i$t=(e,t,n)=>W$(e,n,s=>e[s][t]>=n);function o$t(e,t,n){let s=0,r=e.length;for(;s<r&&e[s]<t;)s++;for(;r>s&&e[r-1]>n;)r--;return s>0||r<e.length?e.slice(s,r):e}const PU=["push","pop","shift","splice","unshift"];function a$t(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),PU.forEach(n=>{const s="_onData"+B$(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return e._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function GO(e,t){const n=e._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(t);r!==-1&&s.splice(r,1),!(s.length>0)&&(PU.forEach(i=>{delete e[i]}),delete e._chartjs)}function FU(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const LU=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function MU(e,t){let n=[],s=!1;return function(...r){n=r,s||(s=!0,LU.call(window,()=>{s=!1,e.apply(t,n)}))}}function l$t(e,t){let n;return function(...s){return t?(clearTimeout(n),n=setTimeout(e,t,s)):e.apply(this,s),t}}const U$=e=>e==="start"?"left":e==="end"?"right":"center",Vn=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,c$t=(e,t,n,s)=>e===(s?"left":"right")?n:e==="center"?(t+n)/2:t;function zU(e,t,n){const s=t.length;let r=0,i=s;if(e._sorted){const{iScale:o,_parsed:a}=e,l=o.axis,{min:c,max:u,minDefined:h,maxDefined:d}=o.getUserBounds();h&&(r=Cn(Math.min(Yi(a,l,c).lo,n?s:Yi(t,l,o.getPixelForValue(c)).lo),0,s-1)),d?i=Cn(Math.max(Yi(a,o.axis,u,!0).hi+1,n?0:Yi(t,l,o.getPixelForValue(u),!0).hi+1),r,s)-r:i=s-r}return{start:r,count:i}}function BU(e){const{xScale:t,yScale:n,_scaleRanges:s}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!s)return e._scaleRanges=r,!0;const i=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),i}const E0=e=>e===0||e===1,HO=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*ye/n)),KO=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*ye/n)+1,Of={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*qe)+1,easeOutSine:e=>Math.sin(e*qe),easeInOutSine:e=>-.5*(Math.cos(ve*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>E0(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>E0(e)?e:HO(e,.075,.3),easeOutElastic:e=>E0(e)?e:KO(e,.075,.3),easeInOutElastic(e){return E0(e)?e:e<.5?.5*HO(e*2,.1125,.45):.5+.5*KO(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Of.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Of.easeInBounce(e*2)*.5:Of.easeOutBounce(e*2-1)*.5+.5};function j$(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function qO(e){return j$(e)?e:new Rp(e)}function v2(e){return j$(e)?e:new Rp(e).saturate(.5).darken(.1).hexString()}const u$t=["x","y","borderWidth","radius","tension"],h$t=["color","borderColor","backgroundColor"];function d$t(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:h$t},numbers:{type:"number",properties:u$t}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function f$t(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const XO=new Map;function p$t(e,t){t=t||{};const n=e+JSON.stringify(t);let s=XO.get(n);return s||(s=new Intl.NumberFormat(e,t),XO.set(n,s)),s}function Bg(e,t,n){return p$t(t,n).format(e)}const VU={values(e){return Ce(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const s=this.chart.options.locale;let r,i=e;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),i=m$t(e,n)}const o=Jo(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Bg(e,s,l)},logarithmic(e,t,n){if(e===0)return"0";const s=n[t].significand||e/Math.pow(10,Math.floor(Jo(e)));return[1,2,3,5,10,15].includes(s)||t>.8*n.length?VU.numeric.call(this,e,t,n):""}};function m$t(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var uw={formatters:VU};function g$t(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:uw.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const xc=Object.create(null),jk=Object.create(null);function Pf(e,t){if(!t)return e;const n=t.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];e=e[i]||(e[i]=Object.create(null))}return e}function w2(e,t,n){return typeof t=="string"?Dp(Pf(e,t),n):Dp(Pf(e,""),t)}class x$t{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>v2(r.backgroundColor),this.hoverBorderColor=(s,r)=>v2(r.borderColor),this.hoverColor=(s,r)=>v2(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return w2(this,t,n)}get(t){return Pf(this,t)}describe(t,n){return w2(jk,t,n)}override(t,n){return w2(xc,t,n)}route(t,n,s,r){const i=Pf(this,t),o=Pf(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[r];return Wt(l)?Object.assign({},c,l):At(l,c)},set(l){this[a]=l}}})}apply(t){t.forEach(n=>n(this))}}var Fe=new x$t({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[d$t,f$t,g$t]);function y$t(e){return!e||Kt(e.size)||Kt(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function Jy(e,t,n,s,r){let i=t[r];return i||(i=t[r]=e.measureText(r).width,n.push(r)),i>s&&(s=i),s}function b$t(e,t,n,s){s=s||{};let r=s.data=s.data||{},i=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(r=s.data={},i=s.garbageCollect=[],s.font=t),e.save(),e.font=t;let o=0;const a=n.length;let l,c,u,h,d;for(l=0;l<a;l++)if(h=n[l],h!=null&&!Ce(h))o=Jy(e,r,i,o,h);else if(Ce(h))for(c=0,u=h.length;c<u;c++)d=h[c],d!=null&&!Ce(d)&&(o=Jy(e,r,i,o,d));e.restore();const f=i.length/2;if(f>n.length){for(l=0;l<f;l++)delete r[i[l]];i.splice(0,f)}return o}function nl(e,t,n){const s=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*s)/s+r}function YO(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Gk(e,t,n,s){WU(e,t,n,s,null)}function WU(e,t,n,s,r){let i,o,a,l,c,u,h,d;const f=t.pointStyle,p=t.rotation,g=t.radius;let m=(p||0)*t$t;if(f&&typeof f=="object"&&(i=f.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){e.save(),e.translate(n,s),e.rotate(m),e.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),e.restore();return}if(!(isNaN(g)||g<=0)){switch(e.beginPath(),f){default:r?e.ellipse(n,s,r/2,g,0,0,ye):e.arc(n,s,g,0,ye),e.closePath();break;case"triangle":u=r?r/2:g,e.moveTo(n+Math.sin(m)*u,s-Math.cos(m)*g),m+=WO,e.lineTo(n+Math.sin(m)*u,s-Math.cos(m)*g),m+=WO,e.lineTo(n+Math.sin(m)*u,s-Math.cos(m)*g),e.closePath();break;case"rectRounded":c=g*.516,l=g-c,o=Math.cos(m+el)*l,h=Math.cos(m+el)*(r?r/2-c:l),a=Math.sin(m+el)*l,d=Math.sin(m+el)*(r?r/2-c:l),e.arc(n-h,s-a,c,m-ve,m-qe),e.arc(n+d,s-o,c,m-qe,m),e.arc(n+h,s+a,c,m,m+qe),e.arc(n-d,s+o,c,m+qe,m+ve),e.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*g,u=r?r/2:l,e.rect(n-u,s-l,2*u,2*l);break}m+=el;case"rectRot":h=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),e.moveTo(n-h,s-a),e.lineTo(n+d,s-o),e.lineTo(n+h,s+a),e.lineTo(n-d,s+o),e.closePath();break;case"crossRot":m+=el;case"cross":h=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),e.moveTo(n-h,s-a),e.lineTo(n+h,s+a),e.moveTo(n+d,s-o),e.lineTo(n-d,s+o);break;case"star":h=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),e.moveTo(n-h,s-a),e.lineTo(n+h,s+a),e.moveTo(n+d,s-o),e.lineTo(n-d,s+o),m+=el,h=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),e.moveTo(n-h,s-a),e.lineTo(n+h,s+a),e.moveTo(n+d,s-o),e.lineTo(n-d,s+o);break;case"line":o=r?r/2:Math.cos(m)*g,a=Math.sin(m)*g,e.moveTo(n-o,s-a),e.lineTo(n+o,s+a);break;case"dash":e.moveTo(n,s),e.lineTo(n+Math.cos(m)*(r?r/2:g),s+Math.sin(m)*g);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Zi(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function hw(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function dw(e){e.restore()}function v$t(e,t,n,s,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else r==="after"!=!!s?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function w$t(e,t,n,s){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function S$t(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Kt(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function k$t(e,t,n,s,r){if(r.strikethrough||r.underline){const i=e.measureText(s),o=t-i.actualBoundingBoxLeft,a=t+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(o,u),e.lineTo(a,u),e.stroke()}}function C$t(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function yc(e,t,n,s,r,i={}){const o=Ce(t)?t:[t],a=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(e.save(),e.font=r.string,S$t(e,i),l=0;l<o.length;++l)c=o[l],i.backdrop&&C$t(e,i.backdrop),a&&(i.strokeColor&&(e.strokeStyle=i.strokeColor),Kt(i.strokeWidth)||(e.lineWidth=i.strokeWidth),e.strokeText(c,n,s,i.maxWidth)),e.fillText(c,n,s,i.maxWidth),k$t(e,n,s,c,i),s+=Number(r.lineHeight);e.restore()}function Fp(e,t){const{x:n,y:s,w:r,h:i,radius:o}=t;e.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*ve,ve,!0),e.lineTo(n,s+i-o.bottomLeft),e.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,ve,qe,!0),e.lineTo(n+r-o.bottomRight,s+i),e.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,qe,0,!0),e.lineTo(n+r,s+o.topRight),e.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-qe,!0),e.lineTo(n+o.topLeft,s)}const I$t=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,T$t=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function N$t(e,t){const n=(""+e).match(I$t);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const _$t=e=>+e||0;function G$(e,t){const n={},s=Wt(t),r=s?Object.keys(t):t,i=Wt(e)?s?o=>At(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of r)n[o]=_$t(i(o));return n}function UU(e){return G$(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Ll(e){return G$(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ts(e){const t=UU(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function hn(e,t){e=e||{},t=t||Fe.font;let n=At(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let s=At(e.style,t.style);s&&!(""+s).match(T$t)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:At(e.family,t.family),lineHeight:N$t(At(e.lineHeight,t.lineHeight),n),size:n,style:s,weight:At(e.weight,t.weight),string:""};return r.string=y$t(r),r}function hf(e,t,n,s){let r,i,o;for(r=0,i=e.length;r<i;++r)if(o=e[r],o!==void 0&&o!==void 0)return o}function $$t(e,t,n){const{min:s,max:r}=e,i=AU(t,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function Ya(e,t){return Object.assign(Object.create(e),t)}function H$(e,t=[""],n,s,r=()=>e[0]){const i=n||e;typeof s>"u"&&(s=KU("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>H$([a,...e],t,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete e[0][l],!0},get(a,l){return GU(a,l,()=>L$t(l,t,e,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(a,l){return QO(a).includes(l)},ownKeys(a){return QO(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function eh(e,t,n,s){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:jU(e,s),setContext:i=>eh(e,i,n,s),override:i=>eh(e.override(i),t,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete e[o],!0},get(i,o,a){return GU(i,o,()=>A$t(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(i,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(i,o,a){return e[o]=a,delete i[o],!0}})}function jU(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:s=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Da(n)?n:()=>n,isIndexable:Da(s)?s:()=>s}}const E$t=(e,t)=>e?e+B$(t):t,K$=(e,t)=>Wt(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function GU(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const s=n();return e[t]=s,s}function A$t(e,t,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=e;let a=s[t];return Da(a)&&o.isScriptable(t)&&(a=R$t(t,a,e,n)),Ce(a)&&a.length&&(a=D$t(t,a,e,o.isIndexable)),K$(t,a)&&(a=eh(a,r,i&&i[t],o)),a}function R$t(e,t,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e);let l=t(i,o||s);return a.delete(e),K$(e,l)&&(l=q$(r._scopes,r,e,l)),l}function D$t(e,t,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(e))return t[i.index%t.length];if(Wt(t[0])){const l=t,c=r._scopes.filter(u=>u!==l);t=[];for(const u of l){const h=q$(c,r,e,u);t.push(eh(h,i,o&&o[e],a))}}return t}function HU(e,t,n){return Da(e)?e(t,n):e}const O$t=(e,t)=>e===!0?t:typeof e=="string"?Ra(t,e):void 0;function P$t(e,t,n,s,r){for(const i of t){const o=O$t(n,i);if(o){e.add(o);const a=HU(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function q$(e,t,n,s){const r=t._rootScopes,i=HU(t._fallback,n,s),o=[...e,...r],a=new Set;a.add(s);let l=ZO(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=ZO(a,o,i,l,s),l===null)?!1:H$(Array.from(a),[""],r,i,()=>F$t(t,n,s))}function ZO(e,t,n,s,r){for(;n;)n=P$t(e,t,n,s,r);return n}function F$t(e,t,n){const s=e._getTarget();t in s||(s[t]={});const r=s[t];return Ce(r)&&Wt(n)?n:r||{}}function L$t(e,t,n,s){let r;for(const i of t)if(r=KU(E$t(i,e),n),typeof r<"u")return K$(e,r)?q$(n,s,e,r):r}function KU(e,t){for(const n of t){if(!n)continue;const s=n[e];if(typeof s<"u")return s}}function QO(e){let t=e._keys;return t||(t=e._keys=M$t(e._scopes)),t}function M$t(e){const t=new Set;for(const n of e)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(s);return Array.from(t)}function qU(e,t,n,s){const{iScale:r}=e,{key:i="r"}=this._parsing,o=new Array(s);let a,l,c,u;for(a=0,l=s;a<l;++a)c=a+n,u=t[c],o[a]={r:r.parse(Ra(u,i),c)};return o}const z$t=Number.EPSILON||1e-14,nh=(e,t)=>t<e.length&&!e[t].skip&&e[t],XU=e=>e==="x"?"y":"x";function B$t(e,t,n,s){const r=e.skip?t:e,i=t,o=n.skip?t:n,a=Uk(i,r),l=Uk(o,i);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=s*c,d=s*u;return{previous:{x:i.x-h*(o.x-r.x),y:i.y-h*(o.y-r.y)},next:{x:i.x+d*(o.x-r.x),y:i.y+d*(o.y-r.y)}}}function V$t(e,t,n){const s=e.length;let r,i,o,a,l,c=nh(e,0);for(let u=0;u<s-1;++u)if(l=c,c=nh(e,u+1),!(!l||!c)){if(Df(t[u],0,z$t)){n[u]=n[u+1]=0;continue}r=n[u]/t[u],i=n[u+1]/t[u],a=Math.pow(r,2)+Math.pow(i,2),!(a<=9)&&(o=3/Math.sqrt(a),n[u]=r*o*t[u],n[u+1]=i*o*t[u])}}function W$t(e,t,n="x"){const s=XU(n),r=e.length;let i,o,a,l=nh(e,0);for(let c=0;c<r;++c){if(o=a,a=l,l=nh(e,c+1),!a)continue;const u=a[n],h=a[s];o&&(i=(u-o[n])/3,a[`cp1${n}`]=u-i,a[`cp1${s}`]=h-i*t[c]),l&&(i=(l[n]-u)/3,a[`cp2${n}`]=u+i,a[`cp2${s}`]=h+i*t[c])}}function U$t(e,t="x"){const n=XU(t),s=e.length,r=Array(s).fill(0),i=Array(s);let o,a,l,c=nh(e,0);for(o=0;o<s;++o)if(a=l,l=c,c=nh(e,o+1),!!l){if(c){const u=c[t]-l[t];r[o]=u!==0?(c[n]-l[n])/u:0}i[o]=a?c?Si(r[o-1])!==Si(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}V$t(e,r,i),W$t(e,i,t)}function A0(e,t,n){return Math.max(Math.min(e,n),t)}function j$t(e,t){let n,s,r,i,o,a=Zi(e[0],t);for(n=0,s=e.length;n<s;++n)o=i,i=a,a=n<s-1&&Zi(e[n+1],t),i&&(r=e[n],o&&(r.cp1x=A0(r.cp1x,t.left,t.right),r.cp1y=A0(r.cp1y,t.top,t.bottom)),a&&(r.cp2x=A0(r.cp2x,t.left,t.right),r.cp2y=A0(r.cp2y,t.top,t.bottom)))}function G$t(e,t,n,s,r){let i,o,a,l;if(t.spanGaps&&(e=e.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")U$t(e,r);else{let c=s?e[e.length-1]:e[0];for(i=0,o=e.length;i<o;++i)a=e[i],l=B$t(c,a,e[Math.min(i+1,o-(s?0:1))%o],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&j$t(e,n)}function X$(){return typeof window<"u"&&typeof document<"u"}function Y$(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function t1(e,t,n){let s;return typeof e=="string"?(s=parseInt(e,10),e.indexOf("%")!==-1&&(s=s/100*t.parentNode[n])):s=e,s}const fw=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function H$t(e,t){return fw(e).getPropertyValue(t)}const K$t=["top","right","bottom","left"];function Ml(e,t,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=K$t[r];s[i]=parseFloat(e[t+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const q$t=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function X$t(e,t){const n=e.touches,s=n&&n.length?n[0]:e,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(q$t(r,i,e.target))a=r,l=i;else{const c=t.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function dl(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:s}=t,r=fw(n),i=r.boxSizing==="border-box",o=Ml(r,"padding"),a=Ml(r,"border","width"),{x:l,y:c,box:u}=X$t(e,n),h=o.left+(u&&a.left),d=o.top+(u&&a.top);let{width:f,height:p}=t;return i&&(f-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-h)/f*n.width/s),y:Math.round((c-d)/p*n.height/s)}}function Y$t(e,t,n){let s,r;if(t===void 0||n===void 0){const i=e&&Y$(e);if(!i)t=e.clientWidth,n=e.clientHeight;else{const o=i.getBoundingClientRect(),a=fw(i),l=Ml(a,"border","width"),c=Ml(a,"padding");t=o.width-c.width-l.width,n=o.height-c.height-l.height,s=t1(a.maxWidth,i,"clientWidth"),r=t1(a.maxHeight,i,"clientHeight")}}return{width:t,height:n,maxWidth:s||Qy,maxHeight:r||Qy}}const R0=e=>Math.round(e*10)/10;function Z$t(e,t,n,s){const r=fw(e),i=Ml(r,"margin"),o=t1(r.maxWidth,e,"clientWidth")||Qy,a=t1(r.maxHeight,e,"clientHeight")||Qy,l=Y$t(e,t,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const d=Ml(r,"border","width"),f=Ml(r,"padding");c-=f.width+d.width,u-=f.height+d.height}return c=Math.max(0,c-i.width),u=Math.max(0,s?c/s:u-i.height),c=R0(Math.min(c,o,l.maxWidth)),u=R0(Math.min(u,a,l.maxHeight)),c&&!u&&(u=R0(c/2)),(t!==void 0||n!==void 0)&&s&&l.height&&u>l.height&&(u=l.height,c=R0(Math.floor(u*s))),{width:c,height:u}}function JO(e,t,n){const s=t||1,r=Math.floor(e.height*s),i=Math.floor(e.width*s);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(e.currentDevicePixelRatio=s,o.height=r,o.width=i,e.ctx.setTransform(s,0,0,s,0,0),!0):!1}const Q$t=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};X$()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function tP(e,t){const n=H$t(e,t),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function fl(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function J$t(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:s==="middle"?n<.5?e.y:t.y:s==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function tEt(e,t,n,s){const r={x:e.cp2x,y:e.cp2y},i={x:t.cp1x,y:t.cp1y},o=fl(e,r,n),a=fl(r,i,n),l=fl(i,t,n),c=fl(o,a,n),u=fl(a,l,n);return fl(c,u,n)}const eEt=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},nEt=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function Iu(e,t,n){return e?eEt(t,n):nEt()}function YU(e,t){let n,s;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=s)}function ZU(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function QU(e){return e==="angle"?{between:Pp,compare:s$t,normalize:js}:{between:Xi,compare:(t,n)=>t-n,normalize:t=>t}}function eP({start:e,end:t,count:n,loop:s,style:r}){return{start:e%n,end:t%n,loop:s&&(t-e+1)%n===0,style:r}}function sEt(e,t,n){const{property:s,start:r,end:i}=n,{between:o,normalize:a}=QU(s),l=t.length;let{start:c,end:u,loop:h}=e,d,f;if(h){for(c+=l,u+=l,d=0,f=l;d<f&&o(a(t[c%l][s]),r,i);++d)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:e.style}}function JU(e,t,n){if(!n)return[e];const{property:s,start:r,end:i}=n,o=t.length,{compare:a,between:l,normalize:c}=QU(s),{start:u,end:h,loop:d,style:f}=sEt(e,t,n),p=[];let g=!1,m=null,x,y,b;const v=()=>l(r,b,x)&&a(r,b)!==0,w=()=>a(i,x)===0||l(i,b,x),k=()=>g||v(),I=()=>!g||w();for(let C=u,N=u;C<=h;++C)y=t[C%o],!y.skip&&(x=c(y[s]),x!==b&&(g=l(x,r,i),m===null&&k()&&(m=a(x,r)===0?C:N),m!==null&&I()&&(p.push(eP({start:m,end:C,loop:d,count:o,style:f})),m=null),N=C,b=x));return m!==null&&p.push(eP({start:m,end:h,loop:d,count:o,style:f})),p}function tj(e,t){const n=[],s=e.segments;for(let r=0;r<s.length;r++){const i=JU(s[r],e.points,t);i.length&&n.push(...i)}return n}function rEt(e,t,n,s){let r=0,i=t-1;if(n&&!s)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(i+=r);i>r&&e[i%t].skip;)i--;return i%=t,{start:r,end:i}}function iEt(e,t,n,s){const r=e.length,i=[];let o=t,a=e[t],l;for(l=t+1;l<=n;++l){const c=e[l%r];c.skip||c.stop?a.skip||(s=!1,i.push({start:t%r,end:(l-1)%r,loop:s}),t=o=c.stop?l:null):(o=l,a.skip&&(t=l)),a=c}return o!==null&&i.push({start:t%r,end:o%r,loop:s}),i}function oEt(e,t){const n=e.points,s=e.options.spanGaps,r=n.length;if(!r)return[];const i=!!e._loop,{start:o,end:a}=rEt(n,r,i,s);if(s===!0)return nP(e,[{start:o,end:a,loop:i}],n,t);const l=a<o?a+r:a,c=!!e._fullLoop&&o===0&&a===r-1;return nP(e,iEt(n,o,l,c),n,t)}function nP(e,t,n,s){return!s||!s.setContext||!n?t:aEt(e,t,n,s)}function aEt(e,t,n,s){const r=e._chart.getContext(),i=sP(e.options),{_datasetIndex:o,options:{spanGaps:a}}=e,l=n.length,c=[];let u=i,h=t[0].start,d=h;function f(p,g,m,x){const y=a?-1:1;if(p!==g){for(p+=l;n[p%l].skip;)p-=y;for(;n[g%l].skip;)g+=y;p%l!==g%l&&(c.push({start:p%l,end:g%l,loop:m,style:x}),u=x,h=g%l)}}for(const p of t){h=a?h:p.start;let g=n[h%l],m;for(d=h+1;d<=p.end;d++){const x=n[d%l];m=sP(s.setContext(Ya(r,{type:"segment",p0:g,p1:x,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),lEt(m,u)&&f(h,d-1,p.loop,u),g=x,u=m}h<d-1&&f(h,d-1,p.loop,u)}return c}function sP(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function lEt(e,t){if(!t)return!1;const n=[],s=function(r,i){return j$(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(e,s)!==JSON.stringify(t,s)}/*!
 * Chart.js v4.4.4
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class cEt{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:t,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=LU.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(t),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,t,"progress")),i.length||(s.running=!1,this._notify(r,s,t,"complete"),s.initial=!1),n+=i.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let s=n.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,s)),s}listen(t,n,s){this._getAnims(t).listeners[n].push(s)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Fi=new cEt;const rP="transparent",uEt={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const s=qO(e||rP),r=s.valid&&qO(t||rP);return r&&r.valid?r.mix(s,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class hEt{constructor(t,n,s,r){const i=n[s];r=hf([t.to,r,i,t.from]);const o=hf([t.from,i,r]);this._active=!0,this._fn=t.fn||uEt[t.type||typeof o],this._easing=Of[t.easing]||Of.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=i,this._loop=!!t.loop,this._to=hf([t.to,n,r,t.from]),this._from=hf([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,s)=>{t.push({res:n,rej:s})})}_notify(t){const n=t?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class ej{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!Wt(t))return;const n=Object.keys(Fe.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const i=t[r];if(!Wt(i))return;const o={};for(const a of n)o[a]=i[a];(Ce(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(t,n){const s=n.options,r=fEt(t,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&dEt(t.options.$animations,s).then(()=>{t.options=s},()=>{}),i}_createAnimations(t,n){const s=this._properties,r=[],i=t.$animations||(t.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(t,n));continue}const u=n[c];let h=i[c];const d=s.get(c);if(h)if(d&&h.active()){h.update(d,u,a);continue}else h.cancel();if(!d||!d.duration){t[c]=u;continue}i[c]=h=new hEt(d,t,c,u),r.push(h)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const s=this._createAnimations(t,n);if(s.length)return Fi.add(this._chart,s),!0}}function dEt(e,t){const n=[],s=Object.keys(t);for(let r=0;r<s.length;r++){const i=e[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function fEt(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function iP(e,t){const n=e&&e.options||{},s=n.reverse,r=n.min===void 0?t:0,i=n.max===void 0?t:0;return{start:s?i:r,end:s?r:i}}function pEt(e,t,n){if(n===!1)return!1;const s=iP(e,n),r=iP(t,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function mEt(e){let t,n,s,r;return Wt(e)?(t=e.top,n=e.right,s=e.bottom,r=e.left):t=n=s=r=e,{top:t,right:n,bottom:s,left:r,disabled:e===!1}}function nj(e,t){const n=[],s=e._getSortedDatasetMetas(t);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function oP(e,t,n,s={}){const r=e.keys,i=s.mode==="single";let o,a,l,c;if(t!==null){for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(s.all)continue;break}c=e.values[l],Pe(c)&&(i||t===0||Si(t)===Si(c))&&(t+=c)}return t}}function gEt(e,t){const{iScale:n,vScale:s}=t,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(e),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[r]:u,[i]:e[u]};return a}function aP(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function xEt(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function yEt(e){const{min:t,max:n,minDefined:s,maxDefined:r}=e.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function bEt(e,t,n){const s=e[t]||(e[t]={});return s[n]||(s[n]={})}function lP(e,t,n,s){for(const r of t.getMatchingVisibleMetas(s).reverse()){const i=e[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function cP(e,t){const{chart:n,_cachedMeta:s}=e,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,c=o.axis,u=xEt(i,o,s),h=t.length;let d;for(let f=0;f<h;++f){const p=t[f],{[l]:g,[c]:m}=p,x=p._stacks||(p._stacks={});d=x[c]=bEt(r,u,g),d[a]=m,d._top=lP(d,o,!0,s.type),d._bottom=lP(d,o,!1,s.type);const y=d._visualValues||(d._visualValues={});y[a]=m}}function S2(e,t){const n=e.scales;return Object.keys(n).filter(s=>n[s].axis===t).shift()}function vEt(e,t){return Ya(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function wEt(e,t,n){return Ya(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Ud(e,t){const n=e.controller.index,s=e.vScale&&e.vScale.axis;if(s){t=t||e._parsed;for(const r of t){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const k2=e=>e==="reset"||e==="none",uP=(e,t)=>t?e:Object.assign({},e),SEt=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:nj(n,!0),values:null};class Kr{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=aP(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Ud(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,d,f,p)=>h==="x"?d:h==="r"?p:f,i=n.xAxisID=At(s.xAxisID,S2(t,"x")),o=n.yAxisID=At(s.yAxisID,S2(t,"y")),a=n.rAxisID=At(s.rAxisID,S2(t,"r")),l=n.indexAxis,c=n.iAxisID=r(l,i,o,a),u=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&GO(this._data,this),t._stacked&&Ud(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),s=this._data;if(Wt(n)){const r=this._cachedMeta;this._data=gEt(n,r)}else if(s!==n){if(s){GO(s,this);const r=this._cachedMeta;Ud(r),r._parsed=[]}n&&Object.isExtensible(n)&&a$t(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=aP(n.vScale,n),n.stack!==s.stack&&(r=!0,Ud(n),n.stack=s.stack),this._resyncElements(t),(r||i!==n._stacked)&&cP(this,n._parsed)}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=t===0&&n===r.length?!0:s._sorted,c=t>0&&s._parsed[t-1],u,h,d;if(this._parsing===!1)s._parsed=r,s._sorted=!0,d=r;else{Ce(r[t])?d=this.parseArrayData(s,r,t,n):Wt(r[t])?d=this.parseObjectData(s,r,t,n):d=this.parsePrimitiveData(s,r,t,n);const f=()=>h[a]===null||c&&h[a]<c[a];for(u=0;u<n;++u)s._parsed[u+t]=h=d[u],l&&(f()&&(l=!1),c=h);s._sorted=l}o&&cP(this,d)}parsePrimitiveData(t,n,s,r){const{iScale:i,vScale:o}=t,a=i.axis,l=o.axis,c=i.getLabels(),u=i===o,h=new Array(r);let d,f,p;for(d=0,f=r;d<f;++d)p=d+s,h[d]={[a]:u||i.parse(c[p],p),[l]:o.parse(n[p],p)};return h}parseArrayData(t,n,s,r){const{xScale:i,yScale:o}=t,a=new Array(r);let l,c,u,h;for(l=0,c=r;l<c;++l)u=l+s,h=n[u],a[l]={x:i.parse(h[0],u),y:o.parse(h[1],u)};return a}parseObjectData(t,n,s,r){const{xScale:i,yScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,h,d,f;for(u=0,h=r;u<h;++u)d=u+s,f=n[d],c[u]={x:i.parse(Ra(f,a),d),y:o.parse(Ra(f,l),d)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,s){const r=this.chart,i=this._cachedMeta,o=n[t.axis],a={keys:nj(r,!0),values:n._stacks[t.axis]._visualValues};return oP(a,o,i.index,{mode:s})}updateRangeFromParsed(t,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=oP(r,i,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&t===s.iScale,o=r.length,a=this._getOtherScale(t),l=SEt(n,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=yEt(a);let d,f;function p(){f=r[d];const g=f[a.axis];return!Pe(f[t.axis])||u>g||h<g}for(d=0;d<o&&!(!p()&&(this.updateRangeFromParsed(c,t,f,l),i));++d);if(i){for(d=o-1;d>=0;--d)if(!p()){this.updateRangeFromParsed(c,t,f,l);break}}return c}getAllParsedValues(t){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][t.axis],Pe(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(t);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=mEt(At(this.options.clip,pEt(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(t,i,a,l),u=a;u<a+l;++u){const h=r[u];h.hidden||(h.active&&c?o.push(h):h.draw(t,i))}for(u=0;u<o.length;++u)o[u].draw(t,i)}getStyle(t,n){const s=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,n,s){const r=this.getDataset();let i;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];i=o.$context||(o.$context=wEt(this.getContext(),t,o)),i.parsed=this.getParsed(t),i.raw=r.data[t],i.index=i.dataIndex=t}else i=this.$context||(this.$context=vEt(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=t+"-"+n,a=i[o],l=this.enableOptionSharing&&Op(s);if(a)return uP(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),h=r?[`${t}Hover`,"hover",t,""]:[t,""],d=c.getOptionScopes(this.getDataset(),u),f=Object.keys(Fe.elements[t]),p=()=>this.getContext(s,r,n),g=c.resolveNamedOptions(d,f,p,h);return g.$shared&&(g.$shared=l,i[o]=Object.freeze(uP(g,l))),g}_resolveAnimations(t,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,n),d=u.getOptionScopes(this.getDataset(),h);l=u.createResolver(d,this.getContext(t,s,n))}const c=new ej(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||k2(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const s=this.resolveDataElementOptions(t,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(t,n,s,r){k2(r)?Object.assign(t,s):this._resolveAnimations(n,r).update(t,s)}updateSharedOptions(t,n,s){t&&!k2(n)&&this._resolveAnimations(void 0,n).update(t,s)}_setStyle(t,n,s,r){t.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(t,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(t,n,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,n,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,t):i<r&&this._removeElements(i,r-i)}_insertElements(t,n,s=!0){const r=this._cachedMeta,i=r.data,o=t+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(i),a=t;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(t,n),s&&this.updateElements(i,t,n,"reset")}updateElements(t,n,s,r){}_removeElements(t,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(t,n);s._stacked&&Ud(s,r)}s.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,s,r]=t;this[n](s,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}at(Kr,"defaults",{}),at(Kr,"datasetElementType",null),at(Kr,"dataElementType",null);function kEt(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=FU(s.sort((r,i)=>r-i))}return e._cache.$bar}function CEt(e){const t=e.iScale,n=kEt(t,e.type);let s=t._length,r,i,o,a;const l=()=>{o===32767||o===-32768||(Op(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(r=0,i=n.length;r<i;++r)o=t.getPixelForValue(n[r]),l();for(a=void 0,r=0,i=t.ticks.length;r<i;++r)o=t.getPixelForTick(r),l();return s}function IEt(e,t,n,s){const r=n.barThickness;let i,o;return Kt(r)?(i=t.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:t.pixels[e]-i/2}}function TEt(e,t,n,s){const r=t.pixels,i=r[e];let o=e>0?r[e-1]:null,a=e<r.length-1?r[e+1]:null;const l=n.categoryPercentage;o===null&&(o=i-(a===null?t.end-t.start:a-i)),a===null&&(a=i+i-o);const c=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:n.barPercentage,start:c}}function NEt(e,t,n,s){const r=n.parse(e[0],s),i=n.parse(e[1],s),o=Math.min(r,i),a=Math.max(r,i);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:i,min:o,max:a}}function sj(e,t,n,s){return Ce(e)?NEt(e,t,n,s):t[n.axis]=n.parse(e,s),t}function hP(e,t,n,s){const r=e.iScale,i=e.vScale,o=r.getLabels(),a=r===i,l=[];let c,u,h,d;for(c=n,u=n+s;c<u;++c)d=t[c],h={},h[r.axis]=a||r.parse(o[c],c),l.push(sj(d,h,i,c));return l}function C2(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function _Et(e,t,n){return e!==0?Si(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function $Et(e){let t,n,s,r,i;return e.horizontal?(t=e.base>e.x,n="left",s="right"):(t=e.base<e.y,n="bottom",s="top"),t?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:t,top:r,bottom:i}}function EEt(e,t,n,s){let r=t.borderSkipped;const i={};if(!r){e.borderSkipped=i;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=$Et(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===s?r=c:(n._bottom||0)===s?r=u:(i[dP(u,o,a,l)]=!0,r=c)),i[dP(r,o,a,l)]=!0,e.borderSkipped=i}function dP(e,t,n,s){return s?(e=AEt(e,t,n),e=fP(e,n,t)):e=fP(e,t,n),e}function AEt(e,t,n){return e===t?n:e===n?t:e}function fP(e,t,n){return e==="start"?t:e==="end"?n:e}function REt(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class Ff extends Kr{parsePrimitiveData(t,n,s,r){return hP(t,n,s,r)}parseArrayData(t,n,s,r){return hP(t,n,s,r)}parseObjectData(t,n,s,r){const{iScale:i,vScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=i.axis==="x"?a:l,u=o.axis==="x"?a:l,h=[];let d,f,p,g;for(d=s,f=s+r;d<f;++d)g=n[d],p={},p[i.axis]=i.parse(Ra(g,c),d),h.push(sj(Ra(g,u),p,o,d));return h}updateRangeFromParsed(t,n,s,r){super.updateRangeFromParsed(t,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,i.min),t.max=Math.max(t.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(t),o=i._custom,a=C2(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:d}=this._getSharedOptions(n,r);for(let f=n;f<n+s;f++){const p=this.getParsed(f),g=i||Kt(p[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),m=this._calculateBarIndexPixels(f,u),x=(p._stacks||{})[a.axis],y={horizontal:c,base:g.base,enableBorderRadius:!x||C2(p._custom)||o===x._top||o===x._bottom,x:c?g.head:m.center,y:c?m.center:g.head,height:c?m.size:Math.abs(g.size),width:c?Math.abs(g.size):m.size};d&&(y.options=h||this.resolveDataElementOptions(f,t[f].active?"active":r));const b=y.options||t[f].options;EEt(y,b,x,o),REt(y,b,u.ratio),this.updateElement(t[f],f,y,r)}}_getStacks(t,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),i=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[s.axis],c=u=>{const h=u._parsed.find(f=>f[s.axis]===l),d=h&&h[u.vScale.axis];if(Kt(d)||isNaN(d))return!0};for(const u of r)if(!(n!==void 0&&c(u))&&((i===!1||o.indexOf(u.stack)===-1||i===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,s){const r=this._getStacks(t,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const t=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const a=t.barThickness;return{min:a||CEt(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(t),c=l._custom,u=C2(c);let h=l[n.axis],d=0,f=s?this.applyStack(n,l,s):h,p,g;f!==h&&(d=f-h,f=h),u&&(h=c.barStart,f=c.barEnd-c.barStart,h!==0&&Si(h)!==Si(c.barEnd)&&(d=0),d+=h);const m=!Kt(i)&&!u?i:d;let x=n.getPixelForValue(m);if(this.chart.getDataVisibility(t)?p=n.getPixelForValue(d+f):p=x,g=p-x,Math.abs(g)<o){g=_Et(g,n,a)*o,h===a&&(x-=g/2);const y=n.getPixelForDecimal(0),b=n.getPixelForDecimal(1),v=Math.min(y,b),w=Math.max(y,b);x=Math.max(Math.min(x,w),v),p=x+g,s&&!u&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(p)-n.getValueForPixel(x))}if(x===n.getPixelForValue(a)){const y=Si(g)*n.getLineWidthForValue(a)/2;x+=y,g-=y}return{size:g,base:x,head:p,center:p+g/2}}_calculateBarIndexPixels(t,n){const s=n.scale,r=this.options,i=r.skipNull,o=At(r.maxBarThickness,1/0);let a,l;if(n.grouped){const c=i?this._getStackCount(t):n.stackCount,u=r.barThickness==="flex"?TEt(t,n,r,c):IEt(t,n,r,c),h=this._getStackIndex(this.index,this._cachedMeta.stack,i?t:void 0);a=u.start+u.chunk*h+u.chunk/2,l=Math.min(o,u.chunk*u.ratio)}else a=s.getPixelForValue(this.getParsed(t)[s.axis],t),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,n=t.vScale,s=t.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}at(Ff,"id","bar"),at(Ff,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),at(Ff,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class fx extends Kr{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,s,r){const i=super.parsePrimitiveData(t,n,s,r);for(let o=0;o<i.length;o++)i[o]._custom=this.resolveDataElementOptions(o+s).radius;return i}parseArrayData(t,n,s,r){const i=super.parseArrayData(t,n,s,r);for(let o=0;o<i.length;o++){const a=n[s+o];i[o]._custom=At(a[2],this.resolveDataElementOptions(o+s).radius)}return i}parseObjectData(t,n,s,r){const i=super.parseObjectData(t,n,s,r);for(let o=0;o<i.length;o++){const a=n[s+o];i[o]._custom=At(a&&a.r&&+a.r,this.resolveDataElementOptions(o+s).radius)}return i}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let s=t.length-1;s>=0;--s)n=Math.max(n,t[s].size(this.resolveDataElementOptions(s))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:i}=n,o=this.getParsed(t),a=r.getLabelForValue(o.x),l=i.getLabelForValue(o.y),c=o._custom;return{label:s[t]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,s,r){const i=r==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(n,r),u=o.axis,h=a.axis;for(let d=n;d<n+s;d++){const f=t[d],p=!i&&this.getParsed(d),g={},m=g[u]=i?o.getPixelForDecimal(.5):o.getPixelForValue(p[u]),x=g[h]=i?a.getBasePixel():a.getPixelForValue(p[h]);g.skip=isNaN(m)||isNaN(x),c&&(g.options=l||this.resolveDataElementOptions(d,f.active?"active":r),i&&(g.options.radius=0)),this.updateElement(f,d,g,r)}}resolveDataElementOptions(t,n){const s=this.getParsed(t);let r=super.resolveDataElementOptions(t,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const i=r.radius;return n!=="active"&&(r.radius=0),r.radius+=At(s&&s._custom,i),r}}at(fx,"id","bubble"),at(fx,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),at(fx,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function DEt(e,t,n){let s=1,r=1,i=0,o=0;if(t<ye){const a=e,l=a+t,c=Math.cos(a),u=Math.sin(a),h=Math.cos(l),d=Math.sin(l),f=(b,v,w)=>Pp(b,a,l,!0)?1:Math.max(v,v*n,w,w*n),p=(b,v,w)=>Pp(b,a,l,!0)?-1:Math.min(v,v*n,w,w*n),g=f(0,c,h),m=f(qe,u,d),x=p(ve,c,h),y=p(ve+qe,u,d);s=(g-x)/2,r=(m-y)/2,i=-(g+x)/2,o=-(m+y)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class Nl extends Kr{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(Wt(s[t])){const{key:l="value"}=this._parsing;i=c=>+Ra(s[c],l)}let o,a;for(o=t,a=t+n;o<a;++o)r._parsed[o]=i(o)}}_getRotation(){return Br(this.options.rotation-90)}_getCircumference(){return Br(this.options.circumference)}_getRotationExtents(){let t=ye,n=-ye;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();t=Math.min(t,i),n=Math.max(n,i+o)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(K_t(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:d,ratioY:f,offsetX:p,offsetY:g}=DEt(h,u,l),m=(s.width-o)/d,x=(s.height-o)/f,y=Math.max(Math.min(m,x)/2,0),b=AU(this.options.radius,y),v=Math.max(b*l,0),w=(b-v)/this._getVisibleDatasetWeightTotal();this.offsetX=p*b,this.offsetY=g*b,r.total=this.calculateTotal(),this.outerRadius=b-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*c,0),this.updateElements(i,0,i.length,t)}_circumference(t,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*i/ye)}updateElements(t,n,s,r){const i=r==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,h=(a.top+a.bottom)/2,d=i&&c.animateScale,f=d?0:this.innerRadius,p=d?0:this.outerRadius,{sharedOptions:g,includeOptions:m}=this._getSharedOptions(n,r);let x=this._getRotation(),y;for(y=0;y<n;++y)x+=this._circumference(y,i);for(y=n;y<n+s;++y){const b=this._circumference(y,i),v=t[y],w={x:u+this.offsetX,y:h+this.offsetY,startAngle:x,endAngle:x+b,circumference:b,outerRadius:p,innerRadius:f};m&&(w.options=g||this.resolveDataElementOptions(y,v.active?"active":r)),x+=b,this.updateElement(v,y,w,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let s=0,r;for(r=0;r<n.length;r++){const i=t._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?ye*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=Bg(n._parsed[t],s.options.locale);return{label:r[t]||"",value:i}}getMaxBorderWidth(t){let n=0;const s=this.chart;let r,i,o,a,l;if(!t){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),t=o.data,a=o.controller;break}}if(!t)return 0;for(r=0,i=t.length;r<i;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let s=0,r=t.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(t){return Math.max(At(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}at(Nl,"id","doughnut"),at(Nl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),at(Nl,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),at(Nl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=t.legend.options;return n.labels.map((i,o)=>{const l=t.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class px extends Kr{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=zU(n,r,o);this._drawStart=a,this._drawCount=l,BU(n)&&(a=0,l=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=r;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:c},t),this.updateElements(r,a,l,t)}updateElements(t,n,s,r){const i=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(n,r),d=o.axis,f=a.axis,{spanGaps:p,segment:g}=this.options,m=th(p)?p:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||i||r==="none",y=n+s,b=t.length;let v=n>0&&this.getParsed(n-1);for(let w=0;w<b;++w){const k=t[w],I=x?k:{};if(w<n||w>=y){I.skip=!0;continue}const C=this.getParsed(w),N=Kt(C[f]),$=I[d]=o.getPixelForValue(C[d],w),A=I[f]=i||N?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,C,l):C[f],w);I.skip=isNaN($)||isNaN(A)||N,I.stop=w>0&&Math.abs(C[d]-v[d])>m,g&&(I.parsed=C,I.raw=c.data[w]),h&&(I.options=u||this.resolveDataElementOptions(w,k.active?"active":r)),x||this.updateElement(k,w,I,r),v=C}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,s=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return s;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,i,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}at(px,"id","line"),at(px,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),at(px,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Lf extends Kr{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=Bg(n._parsed[t].r,s.options.locale);return{label:r[t]||"",value:i}}parseObjectData(t,n,s,r){return qU.bind(this)(t,n,s,r)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,r)=>{const i=this.getParsed(r).r;!isNaN(i)&&this.chart.getDataVisibility(r)&&(i<n.min&&(n.min=i),i>n.max&&(n.max=i))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,s=t.options,r=Math.min(n.right-n.left,n.bottom-n.top),i=Math.max(r/2,0),o=Math.max(s.cutoutPercentage?i/100*s.cutoutPercentage:1,0),a=(i-o)/t.getVisibleDatasetCount();this.outerRadius=i-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,n,s,r){const i=r==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,h=c.yCenter,d=c.getIndexAngle(0)-.5*ve;let f=d,p;const g=360/this.countVisibleElements();for(p=0;p<n;++p)f+=this._computeAngle(p,r,g);for(p=n;p<n+s;p++){const m=t[p];let x=f,y=f+this._computeAngle(p,r,g),b=o.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;f=y,i&&(l.animateScale&&(b=0),l.animateRotate&&(x=y=d));const v={x:u,y:h,innerRadius:0,outerRadius:b,startAngle:x,endAngle:y,options:this.resolveDataElementOptions(p,m.active?"active":r)};this.updateElement(m,p,v,r)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((s,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(t,n,s){return this.chart.getDataVisibility(t)?Br(this.resolveDataElementOptions(t,n).angle||s):0}}at(Lf,"id","polarArea"),at(Lf,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),at(Lf,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=t.legend.options;return n.labels.map((i,o)=>{const l=t.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Hk extends Nl{}at(Hk,"id","pie"),at(Hk,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class mx extends Kr{getLabelAndValue(t){const n=this._cachedMeta.vScale,s=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(s[n.axis])}}parseObjectData(t,n,s,r){return qU.bind(this)(t,n,s,r)}update(t){const n=this._cachedMeta,s=n.dataset,r=n.data||[],i=n.iScale.getLabels();if(s.points=r,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:i.length===r.length,options:o};this.updateElement(s,void 0,a,t)}this.updateElements(r,0,r.length,t)}updateElements(t,n,s,r){const i=this._cachedMeta.rScale,o=r==="reset";for(let a=n;a<n+s;a++){const l=t[a],c=this.resolveDataElementOptions(a,l.active?"active":r),u=i.getPointPositionForValue(a,this.getParsed(a).r),h=o?i.xCenter:u.x,d=o?i.yCenter:u.y,f={x:h,y:d,angle:u.angle,skip:isNaN(h)||isNaN(d),options:c};this.updateElement(l,a,f,r)}}}at(mx,"id","radar"),at(mx,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),at(mx,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class Mf extends Kr{getLabelAndValue(t){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:i}=n,o=this.getParsed(t),a=r.getLabelForValue(o.x),l=i.getLabelForValue(o.y);return{label:s[t]||"",value:"("+a+", "+l+")"}}update(t){const n=this._cachedMeta,{data:s=[]}=n,r=this.chart._animationsDisabled;let{start:i,count:o}=zU(n,s,r);if(this._drawStart=i,this._drawCount=o,BU(n)&&(i=0,o=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=n;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=s;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!r,options:c},t)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(s,i,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,n,s,r){const i=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(n,r),h=this.getSharedOptions(u),d=this.includeOptions(r,h),f=o.axis,p=a.axis,{spanGaps:g,segment:m}=this.options,x=th(g)?g:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||i||r==="none";let b=n>0&&this.getParsed(n-1);for(let v=n;v<n+s;++v){const w=t[v],k=this.getParsed(v),I=y?w:{},C=Kt(k[p]),N=I[f]=o.getPixelForValue(k[f],v),$=I[p]=i||C?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,k,l):k[p],v);I.skip=isNaN(N)||isNaN($)||C,I.stop=v>0&&Math.abs(k[f]-b[f])>x,m&&(I.parsed=k,I.raw=c.data[v]),d&&(I.options=h||this.resolveDataElementOptions(v,w.active?"active":r)),y||this.updateElement(w,v,I,r),b=k}this.updateSharedOptions(h,r,u)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let a=0;for(let l=n.length-1;l>=0;--l)a=Math.max(a,n[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const s=t.dataset,r=s.options&&s.options.borderWidth||0;if(!n.length)return r;const i=n[0].size(this.resolveDataElementOptions(0)),o=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,i,o)/2}}at(Mf,"id","scatter"),at(Mf,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),at(Mf,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var OEt=Object.freeze({__proto__:null,BarController:Ff,BubbleController:fx,DoughnutController:Nl,LineController:px,PieController:Hk,PolarAreaController:Lf,RadarController:mx,ScatterController:Mf});function sl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Z${constructor(t){at(this,"options");this.options=t||{}}static override(t){Object.assign(Z$.prototype,t)}init(){}formats(){return sl()}parse(){return sl()}format(){return sl()}add(){return sl()}diff(){return sl()}startOf(){return sl()}endOf(){return sl()}}var PEt={_date:Z$};function FEt(e,t,n,s){const{controller:r,data:i,_sorted:o}=e,a=r._cachedMeta.iScale;if(a&&t===a.axis&&t!=="r"&&o&&i.length){const l=a._reversePixels?i$t:Yi;if(s){if(r._sharedOptions){const c=i[0],u=typeof c.getRange=="function"&&c.getRange(t);if(u){const h=l(i,t,n-u),d=l(i,t,n+u);return{lo:h.lo,hi:d.hi}}}}else return l(i,t,n)}return{lo:0,hi:i.length-1}}function Vg(e,t,n,s,r){const i=e.getSortedVisibleDatasetMetas(),o=n[t];for(let a=0,l=i.length;a<l;++a){const{index:c,data:u}=i[a],{lo:h,hi:d}=FEt(i[a],t,o,r);for(let f=h;f<=d;++f){const p=u[f];p.skip||s(p,c,f)}}}function LEt(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(s,r){const i=t?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function I2(e,t,n,s,r){const i=[];return!r&&!e.isPointInArea(t)||Vg(e,n,t,function(a,l,c){!r&&!Zi(a,e.chartArea,0)||a.inRange(t.x,t.y,s)&&i.push({element:a,datasetIndex:l,index:c})},!0),i}function MEt(e,t,n,s){let r=[];function i(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],s),{angle:h}=OU(o,{x:t.x,y:t.y});Pp(h,c,u)&&r.push({element:o,datasetIndex:a,index:l})}return Vg(e,n,t,i),r}function zEt(e,t,n,s,r,i){let o=[];const a=LEt(n);let l=Number.POSITIVE_INFINITY;function c(u,h,d){const f=u.inRange(t.x,t.y,r);if(s&&!f)return;const p=u.getCenterPoint(r);if(!(!!i||e.isPointInArea(p))&&!f)return;const m=a(t,p);m<l?(o=[{element:u,datasetIndex:h,index:d}],l=m):m===l&&o.push({element:u,datasetIndex:h,index:d})}return Vg(e,n,t,c),o}function T2(e,t,n,s,r,i){return!i&&!e.isPointInArea(t)?[]:n==="r"&&!s?MEt(e,t,n,r):zEt(e,t,n,s,r,i)}function pP(e,t,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return Vg(e,n,t,(l,c,u)=>{l[o]&&l[o](t[n],r)&&(i.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(t.x,t.y,r))}),s&&!a?[]:i}var BEt={evaluateInteractionItems:Vg,modes:{index(e,t,n,s){const r=dl(t,e),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?I2(e,r,i,s,o):T2(e,r,i,!1,s,o),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(e,t,n,s){const r=dl(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?I2(e,r,i,s,o):T2(e,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,c=e.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(e,t,n,s){const r=dl(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return I2(e,r,i,s,o)},nearest(e,t,n,s){const r=dl(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return T2(e,r,i,n.intersect,s,o)},x(e,t,n,s){const r=dl(t,e);return pP(e,r,"x",n.intersect,s)},y(e,t,n,s){const r=dl(t,e);return pP(e,r,"y",n.intersect,s)}}};const rj=["left","top","right","bottom"];function jd(e,t){return e.filter(n=>n.pos===t)}function mP(e,t){return e.filter(n=>rj.indexOf(n.pos)===-1&&n.box.axis===t)}function Gd(e,t){return e.sort((n,s)=>{const r=t?s:n,i=t?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function VEt(e){const t=[];let n,s,r,i,o,a;for(n=0,s=(e||[]).length;n<s;++n)r=e[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,t.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return t}function WEt(e){const t={};for(const n of e){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!rj.includes(r))continue;const o=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return t}function UEt(e,t){const n=WEt(e),{vBoxMaxWidth:s,hBoxMaxHeight:r}=t;let i,o,a;for(i=0,o=e.length;i<o;++i){a=e[i];const{fullSize:l}=a.box,c=n[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*s:l&&t.availableWidth,a.height=r):(a.width=s,a.height=u?u*r:l&&t.availableHeight)}return n}function jEt(e){const t=VEt(e),n=Gd(t.filter(c=>c.box.fullSize),!0),s=Gd(jd(t,"left"),!0),r=Gd(jd(t,"right")),i=Gd(jd(t,"top"),!0),o=Gd(jd(t,"bottom")),a=mP(t,"x"),l=mP(t,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:jd(t,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function gP(e,t,n,s){return Math.max(e[n],t[n])+Math.max(e[s],t[s])}function ij(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function GEt(e,t,n,s){const{pos:r,box:i}=n,o=e.maxPadding;if(!Wt(r)){n.size&&(e[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,e[r]+=n.size}i.getPadding&&ij(o,i.getPadding());const a=Math.max(0,t.outerWidth-gP(o,e,"left","right")),l=Math.max(0,t.outerHeight-gP(o,e,"top","bottom")),c=a!==e.w,u=l!==e.h;return e.w=a,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function HEt(e){const t=e.maxPadding;function n(s){const r=Math.max(t[s]-e[s],0);return e[s]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function KEt(e,t){const n=t.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(t[o],n[o])}),i}return s(e?["left","right"]:["top","bottom"])}function df(e,t,n,s){const r=[];let i,o,a,l,c,u;for(i=0,o=e.length,c=0;i<o;++i){a=e[i],l=a.box,l.update(a.width||t.w,a.height||t.h,KEt(a.horizontal,t));const{same:h,other:d}=GEt(t,n,a,s);c|=h&&r.length,u=u||d,l.fullSize||r.push(a)}return c&&df(r,t,n,s)||u}function D0(e,t,n,s,r){e.top=n,e.left=t,e.right=t+s,e.bottom=n+r,e.width=s,e.height=r}function xP(e,t,n,s){const r=n.padding;let{x:i,y:o}=t;for(const a of e){const l=a.box,c=s[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const h=t.w*u,d=c.size||l.height;Op(c.start)&&(o=c.start),l.fullSize?D0(l,r.left,o,n.outerWidth-r.right-r.left,d):D0(l,t.left+c.placed,o,h,d),c.start=o,c.placed+=h,o=l.bottom}else{const h=t.h*u,d=c.size||l.width;Op(c.start)&&(i=c.start),l.fullSize?D0(l,i,r.top,d,n.outerHeight-r.bottom-r.top):D0(l,i,t.top+c.placed,d,h),c.start=i,c.placed+=h,i=l.right}}t.x=i,t.y=o}var Xn={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,s){if(!e)return;const r=ts(e.options.layout.padding),i=Math.max(t-r.width,0),o=Math.max(n-r.height,0),a=jEt(e.boxes),l=a.vertical,c=a.horizontal;Jt(e.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const u=l.reduce((g,m)=>m.box.options&&m.box.options.display===!1?g:g+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/u,hBoxMaxHeight:o/2}),d=Object.assign({},r);ij(d,ts(s));const f=Object.assign({maxPadding:d,w:i,h:o,x:r.left,y:r.top},r),p=UEt(l.concat(c),h);df(a.fullSize,f,h,p),df(l,f,h,p),df(c,f,h,p)&&df(l,f,h,p),HEt(f),xP(a.leftAndTop,f,h,p),f.x+=f.w,f.y+=f.h,xP(a.rightAndBottom,f,h,p),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},Jt(a.chartArea,g=>{const m=g.box;Object.assign(m,e.chartArea),m.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class oj{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,s){}removeEventListener(t,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,s,r){return n=Math.max(0,n||t.width),s=s||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(t){return!0}updateConfig(t){}}class qEt extends oj{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const gx="$chartjs",XEt={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},yP=e=>e===null||e==="";function YEt(e,t){const n=e.style,s=e.getAttribute("height"),r=e.getAttribute("width");if(e[gx]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",yP(r)){const i=tP(e,"width");i!==void 0&&(e.width=i)}if(yP(s))if(e.style.height==="")e.height=e.width/(t||2);else{const i=tP(e,"height");i!==void 0&&(e.height=i)}return e}const aj=Q$t?{passive:!0}:!1;function ZEt(e,t,n){e&&e.addEventListener(t,n,aj)}function QEt(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,aj)}function JEt(e,t){const n=XEt[e.type]||e.type,{x:s,y:r}=dl(e,t);return{type:n,chart:t,native:e,x:s!==void 0?s:null,y:r!==void 0?r:null}}function e1(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function tAt(e,t,n){const s=e.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||e1(a.addedNodes,s),o=o&&!e1(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function eAt(e,t,n){const s=e.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||e1(a.removedNodes,s),o=o&&!e1(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const Lp=new Map;let bP=0;function lj(){const e=window.devicePixelRatio;e!==bP&&(bP=e,Lp.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function nAt(e,t){Lp.size||window.addEventListener("resize",lj),Lp.set(e,t)}function sAt(e){Lp.delete(e),Lp.size||window.removeEventListener("resize",lj)}function rAt(e,t,n){const s=e.canvas,r=s&&Y$(s);if(!r)return;const i=MU((a,l)=>{const c=r.clientWidth;n(a,l),c<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||i(c,u)});return o.observe(r),nAt(e,i),o}function N2(e,t,n){n&&n.disconnect(),t==="resize"&&sAt(e)}function iAt(e,t,n){const s=e.canvas,r=MU(i=>{e.ctx!==null&&n(JEt(i,e))},e);return ZEt(s,t,r),r}class oAt extends oj{acquireContext(t,n){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(YEt(t,n),s):null}releaseContext(t){const n=t.canvas;if(!n[gx])return!1;const s=n[gx].initial;["height","width"].forEach(i=>{const o=s[i];Kt(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[gx],!0}addEventListener(t,n,s){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),o={attach:tAt,detach:eAt,resize:rAt}[n]||iAt;r[n]=o(t,n,s)}removeEventListener(t,n){const s=t.$proxies||(t.$proxies={}),r=s[n];if(!r)return;({attach:N2,detach:N2,resize:N2}[n]||QEt)(t,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,s,r){return Z$t(t,n,s,r)}isAttached(t){const n=t&&Y$(t);return!!(n&&n.isConnected)}}function aAt(e){return!X$()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?qEt:oAt}var V0;let Eo=(V0=class{constructor(){at(this,"x");at(this,"y");at(this,"active",!1);at(this,"options");at(this,"$animations")}tooltipPosition(t){const{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}hasValue(){return th(this.x)&&th(this.y)}getProps(t,n){const s=this.$animations;if(!n||!s)return this;const r={};return t.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},at(V0,"defaults",{}),at(V0,"defaultRoutes"),V0);function lAt(e,t){const n=e.options.ticks,s=cAt(e),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?hAt(t):[],o=i.length,a=i[0],l=i[o-1],c=[];if(o>r)return dAt(t,c,i,o/r),c;const u=uAt(i,t,r);if(o>0){let h,d;const f=o>1?Math.round((l-a)/(o-1)):null;for(O0(t,c,u,Kt(f)?0:a-f,a),h=0,d=o-1;h<d;h++)O0(t,c,u,i[h],i[h+1]);return O0(t,c,u,l,Kt(f)?t.length:l+f),c}return O0(t,c,u),c}function cAt(e){const t=e.options.offset,n=e._tickSize(),s=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(s,r))}function uAt(e,t,n){const s=fAt(e),r=t.length/n;if(!s)return Math.max(r,1);const i=e$t(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function hAt(e){const t=[];let n,s;for(n=0,s=e.length;n<s;n++)e[n].major&&t.push(n);return t}function dAt(e,t,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<e.length;o++)o===i&&(t.push(e[o]),r++,i=n[r*s])}function O0(e,t,n,s,r){const i=At(s,0),o=Math.min(At(r,e.length),e.length);let a=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),u=i;u<0;)a++,u=Math.round(i+a*n);for(c=Math.max(i,0);c<o;c++)c===u&&(t.push(e[c]),a++,u=Math.round(i+a*n))}function fAt(e){const t=e.length;let n,s;if(t<2)return!1;for(s=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==s)return!1;return s}const pAt=e=>e==="left"?"right":e==="right"?"left":e,vP=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,wP=(e,t)=>Math.min(t||e,e);function SP(e,t){const n=[],s=e.length/t,r=e.length;let i=0;for(;i<r;i+=s)n.push(e[Math.floor(i)]);return n}function mAt(e,t,n){const s=e.ticks.length,r=Math.min(t,s-1),i=e._startPixel,o=e._endPixel,a=1e-6;let l=e.getPixelForTick(r),c;if(!(n&&(s===1?c=Math.max(l-i,o-l):t===0?c=(e.getPixelForTick(1)-l)/2:c=(l-e.getPixelForTick(r-1))/2,l+=r<t?c:-c,l<i-a||l>o+a)))return l}function gAt(e,t){Jt(e,n=>{const s=n.gc,r=s.length/2;let i;if(r>t){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function Hd(e){return e.drawTicks?e.tickLength:0}function kP(e,t){if(!e.display)return 0;const n=hn(e.font,t),s=ts(e.padding);return(Ce(e.text)?e.text.length:1)*n.lineHeight+s.height}function xAt(e,t){return Ya(e,{scale:t,type:"scale"})}function yAt(e,t,n){return Ya(e,{tick:n,index:t,type:"tick"})}function bAt(e,t,n){let s=U$(e);return(n&&t!=="right"||!n&&t==="right")&&(s=pAt(s)),s}function vAt(e,t,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=e,{chartArea:c,scales:u}=l;let h=0,d,f,p;const g=o-r,m=a-i;if(e.isHorizontal()){if(f=Vn(s,i,a),Wt(n)){const x=Object.keys(n)[0],y=n[x];p=u[x].getPixelForValue(y)+g-t}else n==="center"?p=(c.bottom+c.top)/2+g-t:p=vP(e,n,t);d=a-i}else{if(Wt(n)){const x=Object.keys(n)[0],y=n[x];f=u[x].getPixelForValue(y)-m+t}else n==="center"?f=(c.left+c.right)/2-m+t:f=vP(e,n,t);p=Vn(s,o,r),h=n==="left"?-qe:qe}return{titleX:f,titleY:p,maxWidth:d,rotation:h}}class Wc extends Eo{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return t=Vs(t,Number.POSITIVE_INFINITY),n=Vs(n,Number.NEGATIVE_INFINITY),s=Vs(s,Number.POSITIVE_INFINITY),r=Vs(r,Number.NEGATIVE_INFINITY),{min:Vs(t,s),max:Vs(n,r),minDefined:Pe(t),maxDefined:Pe(n)}}getMinMax(t){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,t),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:Vs(n,Vs(s,n)),max:Vs(s,Vs(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ce(this.options.beforeUpdate,[this])}update(t,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=$$t(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?SP(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=lAt(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,t=!t),this._startPixel=n,this._endPixel=s,this._reversePixels=t,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ce(this.options.afterUpdate,[this])}beforeSetDimensions(){ce(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ce(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),ce(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ce(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s],i.label=ce(n.callback,[i.value,s,t],this)}afterTickToLabelConversion(){ce(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ce(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,s=wP(this.ticks.length,t.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,c;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),h=u.widest.width,d=u.highest.height,f=Cn(this.chart.width-h,0,this.maxWidth);a=t.offset?this.maxWidth/s:f/(s-1),h+6>a&&(a=f/(s-(t.offset?.5:1)),l=this.maxHeight-Hd(t.grid)-n.padding-kP(t.title,this.chart.options.font),c=Math.sqrt(h*h+d*d),o=V$(Math.min(Math.asin(Cn((u.highest.height+6)/a,-1,1)),Math.asin(Cn(l/c,-1,1))-Math.asin(Cn(d/c,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){ce(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ce(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=kP(r,n.options.font);if(a?(t.width=this.maxWidth,t.height=Hd(i)+l):(t.height=this.maxHeight,t.width=Hd(i)+l),s.display&&this.ticks.length){const{first:c,last:u,widest:h,highest:d}=this._getLabelSizes(),f=s.padding*2,p=Br(this.labelRotation),g=Math.cos(p),m=Math.sin(p);if(a){const x=s.mirror?0:m*h.width+g*d.height;t.height=Math.min(this.maxHeight,t.height+x+f)}else{const x=s.mirror?0:g*h.width+m*d.height;t.width=Math.min(this.maxWidth,t.width+x+f)}this._calculatePadding(c,u,m,g)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,f=0;l?c?(d=r*t.width,f=s*n.height):(d=s*t.height,f=r*n.width):i==="start"?f=n.width:i==="end"?d=t.width:i!=="inner"&&(d=t.width/2,f=n.width/2),this.paddingLeft=Math.max((d-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-h+o)*this.width/(this.width-h),0)}else{let u=n.height/2,h=t.height/2;i==="start"?(u=0,h=t.height):i==="end"&&(u=n.height,h=0),this.paddingTop=u+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ce(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,s;for(n=0,s=t.length;n<s;n++)Kt(t[n].label)&&(t.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=SP(s,n)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/wP(n,s));let c=0,u=0,h,d,f,p,g,m,x,y,b,v,w;for(h=0;h<n;h+=l){if(p=t[h].label,g=this._resolveTickFontOptions(h),r.font=m=g.string,x=i[m]=i[m]||{data:{},gc:[]},y=g.lineHeight,b=v=0,!Kt(p)&&!Ce(p))b=Jy(r,x.data,x.gc,b,p),v=y;else if(Ce(p))for(d=0,f=p.length;d<f;++d)w=p[d],!Kt(w)&&!Ce(w)&&(b=Jy(r,x.data,x.gc,b,w),v+=y);o.push(b),a.push(v),c=Math.max(b,c),u=Math.max(v,u)}gAt(i,n);const k=o.indexOf(c),I=a.indexOf(u),C=N=>({width:o[N]||0,height:a[N]||0});return{first:C(0),last:C(n-1),widest:C(k),highest:C(I),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return r$t(this._alignToPixels?nl(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const s=n[t];return s.$context||(s.$context=yAt(this.getContext(),t,s))}return this.$context||(this.$context=xAt(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Br(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=t.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),d=Hd(i),f=[],p=a.setContext(this.getContext()),g=p.display?p.width:0,m=g/2,x=function(P){return nl(s,P,g)};let y,b,v,w,k,I,C,N,$,A,R,z;if(o==="top")y=x(this.bottom),I=this.bottom-d,N=y-m,A=x(t.top)+m,z=t.bottom;else if(o==="bottom")y=x(this.top),A=t.top,z=x(t.bottom)-m,I=y+m,N=this.top+d;else if(o==="left")y=x(this.right),k=this.right-d,C=y-m,$=x(t.left)+m,R=t.right;else if(o==="right")y=x(this.left),$=t.left,R=x(t.right)-m,k=y+m,C=this.left+d;else if(n==="x"){if(o==="center")y=x((t.top+t.bottom)/2+.5);else if(Wt(o)){const P=Object.keys(o)[0],L=o[P];y=x(this.chart.scales[P].getPixelForValue(L))}A=t.top,z=t.bottom,I=y+m,N=I+d}else if(n==="y"){if(o==="center")y=x((t.left+t.right)/2);else if(Wt(o)){const P=Object.keys(o)[0],L=o[P];y=x(this.chart.scales[P].getPixelForValue(L))}k=y-m,C=k-d,$=t.left,R=t.right}const U=At(r.ticks.maxTicksLimit,h),F=Math.max(1,Math.ceil(h/U));for(b=0;b<h;b+=F){const P=this.getContext(b),L=i.setContext(P),E=a.setContext(P),B=L.lineWidth,q=L.color,Y=E.dash||[],Q=E.dashOffset,J=L.tickWidth,et=L.tickColor,nt=L.tickBorderDash||[],rt=L.tickBorderDashOffset;v=mAt(this,b,l),v!==void 0&&(w=nl(s,v,B),c?k=C=$=R=w:I=N=A=z=w,f.push({tx1:k,ty1:I,tx2:C,ty2:N,x1:$,y1:A,x2:R,y2:z,width:B,color:q,borderDash:Y,borderDashOffset:Q,tickWidth:J,tickColor:et,tickBorderDash:nt,tickBorderDashOffset:rt}))}return this._ticksLength=h,this._borderValue=y,f}_computeLabelItems(t){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=i,d=Hd(s.grid),f=d+u,p=h?-u:f,g=-Br(this.labelRotation),m=[];let x,y,b,v,w,k,I,C,N,$,A,R,z="middle";if(r==="top")k=this.bottom-p,I=this._getXAxisLabelAlignment();else if(r==="bottom")k=this.top+p,I=this._getXAxisLabelAlignment();else if(r==="left"){const F=this._getYAxisLabelAlignment(d);I=F.textAlign,w=F.x}else if(r==="right"){const F=this._getYAxisLabelAlignment(d);I=F.textAlign,w=F.x}else if(n==="x"){if(r==="center")k=(t.top+t.bottom)/2+f;else if(Wt(r)){const F=Object.keys(r)[0],P=r[F];k=this.chart.scales[F].getPixelForValue(P)+f}I=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")w=(t.left+t.right)/2-f;else if(Wt(r)){const F=Object.keys(r)[0],P=r[F];w=this.chart.scales[F].getPixelForValue(P)}I=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(l==="start"?z="top":l==="end"&&(z="bottom"));const U=this._getLabelSizes();for(x=0,y=a.length;x<y;++x){b=a[x],v=b.label;const F=i.setContext(this.getContext(x));C=this.getPixelForTick(x)+i.labelOffset,N=this._resolveTickFontOptions(x),$=N.lineHeight,A=Ce(v)?v.length:1;const P=A/2,L=F.color,E=F.textStrokeColor,B=F.textStrokeWidth;let q=I;o?(w=C,I==="inner"&&(x===y-1?q=this.options.reverse?"left":"right":x===0?q=this.options.reverse?"right":"left":q="center"),r==="top"?c==="near"||g!==0?R=-A*$+$/2:c==="center"?R=-U.highest.height/2-P*$+$:R=-U.highest.height+$/2:c==="near"||g!==0?R=$/2:c==="center"?R=U.highest.height/2-P*$:R=U.highest.height-A*$,h&&(R*=-1),g!==0&&!F.showLabelBackdrop&&(w+=$/2*Math.sin(g))):(k=C,R=(1-A)*$/2);let Y;if(F.showLabelBackdrop){const Q=ts(F.backdropPadding),J=U.heights[x],et=U.widths[x];let nt=R-Q.top,rt=0-Q.left;switch(z){case"middle":nt-=J/2;break;case"bottom":nt-=J;break}switch(I){case"center":rt-=et/2;break;case"right":rt-=et;break;case"inner":x===y-1?rt-=et:x>0&&(rt-=et/2);break}Y={left:rt,top:nt,width:et+Q.width,height:J+Q.height,color:F.backdropColor}}m.push({label:v,font:N,textOffset:R,options:{rotation:g,color:L,strokeColor:E,strokeWidth:B,textAlign:q,textBaseline:z,translation:[w,k],backdrop:Y}})}return m}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Br(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=t+i,l=o.widest.width;let c,u;return n==="left"?r?(u=this.right+i,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+i,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(s,r,i,o),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let i,o;const a=(l,c,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,h,d;this.isHorizontal()?(c=nl(t,this.left,o)-o/2,u=nl(t,this.right,a)+a/2,h=d=l):(h=nl(t,this.top,o)-o/2,d=nl(t,this.bottom,a)+a/2,c=u=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(c,h),n.lineTo(u,d),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&hw(s,r);const i=this.getLabelItems(t);for(const o of i){const a=o.options,l=o.font,c=o.label,u=o.textOffset;yc(s,c,0,u,l,a)}r&&dw(s)}drawTitle(){const{ctx:t,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=hn(s.font),o=ts(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||Wt(n)?(l+=o.bottom,Ce(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:h,rotation:d}=vAt(this,l,n,a);yc(t,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:d,textAlign:bAt(a,n,r),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,s=At(t.grid&&t.grid.z,-1),r=At(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Wc.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!t||a.type===t)&&r.push(a)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return hn(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class P0{constructor(t,n,s){this.type=t,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let s;kAt(n)&&(s=this.register(n));const r=this.items,i=t.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+t);return i in r||(r[i]=t,wAt(t,o,s),this.override&&Fe.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const n=this.items,s=t.id,r=this.scope;s in n&&delete n[s],r&&s in Fe[r]&&(delete Fe[r][s],this.override&&delete xc[s])}}function wAt(e,t,n){const s=Dp(Object.create(null),[n?Fe.get(n):{},Fe.get(t),e.defaults]);Fe.set(t,s),e.defaultRoutes&&SAt(t,e.defaultRoutes),e.descriptors&&Fe.describe(t,e.descriptors)}function SAt(e,t){Object.keys(t).forEach(n=>{const s=n.split("."),r=s.pop(),i=[e].concat(s).join("."),o=t[n].split("."),a=o.pop(),l=o.join(".");Fe.route(i,r,l,a)})}function kAt(e){return"id"in e&&"defaults"in e}class CAt{constructor(){this.controllers=new P0(Kr,"datasets",!0),this.elements=new P0(Eo,"elements"),this.plugins=new P0(Object,"plugins"),this.scales=new P0(Wc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(t,i,r):Jt(r,o=>{const a=s||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,n,s){const r=B$(t);ce(s["before"+r],[],s),n[t](s),ce(s["after"+r],[],s)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(t))return s}return this.plugins}_get(t,n,s){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return r}}var ai=new CAt;class IAt{constructor(){this._init=[]}notify(t,n,s,r){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const i=r?this._descriptors(t).filter(r):this._descriptors(t),o=this._notify(i,t,n,s);return n==="afterDestroy"&&(this._notify(i,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,n,s,r){r=r||{};for(const i of t){const o=i.plugin,a=o[s],l=[n,r,i.options];if(ce(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){Kt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const s=t&&t.config,r=At(s.options&&s.options.plugins,{}),i=TAt(s);return r===!1&&!n?[]:_At(t,i,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),t,"stop"),this._notify(r(s,n),t,"start")}}function TAt(e){const t={},n=[],s=Object.keys(ai.plugins.items);for(let i=0;i<s.length;i++)n.push(ai.getPlugin(s[i]));const r=e.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),t[o.id]=!0)}return{plugins:n,localIds:t}}function NAt(e,t){return!t&&e===!1?null:e===!0?{}:e}function _At(e,{plugins:t,localIds:n},s,r){const i=[],o=e.getContext();for(const a of t){const l=a.id,c=NAt(s[l],r);c!==null&&i.push({plugin:a,options:$At(e.config,{plugin:a,local:n[l]},c,o)})}return i}function $At(e,{plugin:t,local:n},s,r){const i=e.pluginScopeKeys(t),o=e.getOptionScopes(s,i);return n&&t.defaults&&o.push(t.defaults),e.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Kk(e,t){const n=Fe.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function EAt(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function AAt(e,t){return e===t?"_index_":"_value_"}function CP(e){if(e==="x"||e==="y"||e==="r")return e}function RAt(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function qk(e,...t){if(CP(e))return e;for(const n of t){const s=n.axis||RAt(n.position)||e.length>1&&CP(e[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function IP(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function DAt(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(s=>s.xAxisID===e||s.yAxisID===e);if(n.length)return IP(e,"x",n[0])||IP(e,"y",n[0])}return{}}function OAt(e,t){const n=xc[e.type]||{scales:{}},s=t.scales||{},r=Kk(e.type,t),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!Wt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=qk(o,a,DAt(o,e),Fe.scales[a.type]),c=AAt(l,r),u=n.scales||{};i[o]=Rf(Object.create(null),[{axis:l},a,u[l],u[c]])}),e.data.datasets.forEach(o=>{const a=o.type||e.type,l=o.indexAxis||Kk(a,t),u=(xc[a]||{}).scales||{};Object.keys(u).forEach(h=>{const d=EAt(h,l),f=o[d+"AxisID"]||d;i[f]=i[f]||Object.create(null),Rf(i[f],[{axis:d},s[f],u[h]])})}),Object.keys(i).forEach(o=>{const a=i[o];Rf(a,[Fe.scales[a.type],Fe.scale])}),i}function cj(e){const t=e.options||(e.options={});t.plugins=At(t.plugins,{}),t.scales=OAt(e,t)}function uj(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function PAt(e){return e=e||{},e.data=uj(e.data),cj(e),e}const TP=new Map,hj=new Set;function F0(e,t){let n=TP.get(e);return n||(n=t(),TP.set(e,n),hj.add(n)),n}const Kd=(e,t,n)=>{const s=Ra(t,n);s!==void 0&&e.add(s)};class FAt{constructor(t){this._config=PAt(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=uj(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),cj(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return F0(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return F0(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return F0(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,s=this.type;return F0(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const s=this._scopeCache;let r=s.get(t);return(!r||n)&&(r=new Map,s.set(t,r)),r}getOptionScopes(t,n,s){const{options:r,type:i}=this,o=this._cachedScopes(t,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(u=>{t&&(l.add(t),u.forEach(h=>Kd(l,t,h))),u.forEach(h=>Kd(l,r,h)),u.forEach(h=>Kd(l,xc[i]||{},h)),u.forEach(h=>Kd(l,Fe,h)),u.forEach(h=>Kd(l,jk,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),hj.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:t,type:n}=this;return[t,xc[n]||{},Fe.datasets[n]||{},{type:n},Fe,jk]}resolveNamedOptions(t,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=NP(this._resolverCache,t,r);let l=o;if(MAt(o,n)){i.$shared=!1,s=Da(s)?s():s;const c=this.createResolver(t,s,a);l=eh(o,s,c)}for(const c of n)i[c]=l[c];return i}createResolver(t,n,s=[""],r){const{resolver:i}=NP(this._resolverCache,t,s);return Wt(n)?eh(i,n,void 0,r):i}}function NP(e,t,n){let s=e.get(t);s||(s=new Map,e.set(t,s));const r=n.join();let i=s.get(r);return i||(i={resolver:H$(t,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const LAt=e=>Wt(e)&&Object.getOwnPropertyNames(e).some(t=>Da(e[t]));function MAt(e,t){const{isScriptable:n,isIndexable:s}=jU(e);for(const r of t){const i=n(r),o=s(r),a=(o||i)&&e[r];if(i&&(Da(a)||LAt(a))||o&&Ce(a))return!0}return!1}var zAt="4.4.4";const BAt=["top","bottom","left","right","chartArea"];function _P(e,t){return e==="top"||e==="bottom"||BAt.indexOf(e)===-1&&t==="x"}function $P(e,t){return function(n,s){return n[e]===s[e]?n[t]-s[t]:n[e]-s[e]}}function EP(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),ce(n&&n.onComplete,[e],t)}function VAt(e){const t=e.chart,n=t.options.animation;ce(n&&n.onProgress,[e],t)}function dj(e){return X$()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const xx={},AP=e=>{const t=dj(e);return Object.values(xx).filter(n=>n.canvas===t).pop()};function WAt(e,t,n){const s=Object.keys(e);for(const r of s){const i=+r;if(i>=t){const o=e[r];delete e[r],(n>0||i>t)&&(e[i+n]=o)}}}function UAt(e,t,n,s){return!n||e.type==="mouseout"?null:s?t:e}function L0(e,t,n){return e.options.clip?e[n]:t[n]}function jAt(e,t){const{xScale:n,yScale:s}=e;return n&&s?{left:L0(n,t,"left"),right:L0(n,t,"right"),top:L0(s,t,"top"),bottom:L0(s,t,"bottom")}:t}var Fo;let Wg=(Fo=class{static register(...t){ai.add(...t),RP()}static unregister(...t){ai.remove(...t),RP()}constructor(t,n){const s=this.config=new FAt(n),r=dj(t),i=AP(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||aAt(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=H_t(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new IAt,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=l$t(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],xx[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Fi.listen(this,"complete",EP),Fi.listen(this,"progress",VAt),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return Kt(t)?n&&i?i:r?s/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return ai}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():JO(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return YO(this.canvas,this.ctx),this}stop(){return Fi.stop(this),this}resize(t,n){Fi.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,t,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,JO(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),ce(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Jt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=qk(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Jt(i,o=>{const a=o.options,l=a.id,c=qk(l,a),u=At(a.type,o.dtype);(a.position===void 0||_P(a.position,c)!==_P(o.dposition))&&(a.position=o.dposition),r[l]=!0;let h=null;if(l in s&&s[l].type===u)h=s[l];else{const d=ai.getScale(u);h=new d({id:l,type:u,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(a,t)}),Jt(r,(o,a)=>{o||delete s[a]}),Jt(s,o=>{Xn.configure(this,o,o.options),Xn.addBox(this,o)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,s=t.length;if(t.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);t.splice(n,s-n)}this._sortedMetasets=t.slice(0).sort($P("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||Kk(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=ai.getController(a),{datasetElementType:c,dataElementType:u}=Fe.datasets[a];Object.assign(l,{dataElementType:ai.getElement(u),datasetElementType:c&&ai.getElement(c)}),o.controller=new l(this,s),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){Jt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:h}=this.getDatasetMeta(c),d=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(d),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||Jt(i,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort($P("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Jt(this.scales,t=>{Xn.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!VO(n,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;WAt(t,r,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(t.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!VO(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Xn.update(this,this.width,this.height,t);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],Jt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Da(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const s=this.getDatasetMeta(t),r={meta:s,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Fi.has(this)?this.attached&&!Fi.running(this)&&Fi.start(this):(this.draw(),EP({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!t||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,s=t._clip,r=!s.disabled,i=jAt(t,this.chartArea),o={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(r&&hw(n,{left:s.left===!1?0:i.left-s.left,right:s.right===!1?this.width:i.right+s.right,top:s.top===!1?0:i.top-s.top,bottom:s.bottom===!1?this.height:i.bottom+s.bottom}),t.controller.draw(),r&&dw(n),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(t){return Zi(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,s,r){const i=BEt.modes[n];return typeof i=="function"?i(this,t,s,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=Ya(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(t,n){const s=this.getDatasetMeta(t);s.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(t),o=i.controller._resolveAnimations(void 0,r);Op(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),Fi.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),YO(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete xx[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),t[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};Jt(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,s=(l,c)=>{n.addEventListener(this,l,c),t[l]=c},r=(l,c)=>{t[l]&&(n.removeEventListener(this,l,c),delete t[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){Jt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},Jt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(t[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){o=t[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],s=t.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!Yy(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(t,n,s){return this._plugins.notify(this,t,n,s)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,s){const r=this.options.hover,i=(l,c)=>l.filter(u=>!c.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),o=i(n,t),a=s?t:i(t,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(t,n){const s={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(t,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(t,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(t,r,s,o),l=Q_t(t),c=UAt(t,this._lastEvent,s,l);s&&(this._lastEvent=null,ce(i.onHover,[t,a,this],this),l&&ce(i.onClick,[t,a,this],this));const u=!Yy(a,r);return(u||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=c,u}_getActiveElements(t,n,s,r){if(t.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(t,i.mode,i,r)}},at(Fo,"defaults",Fe),at(Fo,"instances",xx),at(Fo,"overrides",xc),at(Fo,"registry",ai),at(Fo,"version",zAt),at(Fo,"getChart",AP),Fo);function RP(){return Jt(Wg.instances,e=>e._plugins.invalidate())}function GAt(e,t,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:a,innerRadius:l}=t;let c=r/a;e.beginPath(),e.arc(i,o,a,s-c,n+c),l>r?(c=r/l,e.arc(i,o,l,n+c,s-c,!0)):e.arc(i,o,r,n+qe,s-qe),e.closePath(),e.clip()}function HAt(e){return G$(e,["outerStart","outerEnd","innerStart","innerEnd"])}function KAt(e,t,n,s){const r=HAt(e.options.borderRadius),i=(n-t)/2,o=Math.min(i,s*t/2),a=l=>{const c=(n-Math.min(i,l))*s/2;return Cn(l,0,Math.min(i,c))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:Cn(r.innerStart,0,o),innerEnd:Cn(r.innerEnd,0,o)}}function Kc(e,t,n,s){return{x:n+e*Math.cos(t),y:s+e*Math.sin(t)}}function n1(e,t,n,s,r,i){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,h=Math.max(t.outerRadius+s+n-c,0),d=u>0?u+s+n+c:0;let f=0;const p=r-l;if(s){const F=u>0?u-s:0,P=h>0?h-s:0,L=(F+P)/2,E=L!==0?p*L/(L+s):p;f=(p-E)/2}const g=Math.max(.001,p*h-n/ve)/h,m=(p-g)/2,x=l+m+f,y=r-m-f,{outerStart:b,outerEnd:v,innerStart:w,innerEnd:k}=KAt(t,d,h,y-x),I=h-b,C=h-v,N=x+b/I,$=y-v/C,A=d+w,R=d+k,z=x+w/A,U=y-k/R;if(e.beginPath(),i){const F=(N+$)/2;if(e.arc(o,a,h,N,F),e.arc(o,a,h,F,$),v>0){const B=Kc(C,$,o,a);e.arc(B.x,B.y,v,$,y+qe)}const P=Kc(R,y,o,a);if(e.lineTo(P.x,P.y),k>0){const B=Kc(R,U,o,a);e.arc(B.x,B.y,k,y+qe,U+Math.PI)}const L=(y-k/d+(x+w/d))/2;if(e.arc(o,a,d,y-k/d,L,!0),e.arc(o,a,d,L,x+w/d,!0),w>0){const B=Kc(A,z,o,a);e.arc(B.x,B.y,w,z+Math.PI,x-qe)}const E=Kc(I,x,o,a);if(e.lineTo(E.x,E.y),b>0){const B=Kc(I,N,o,a);e.arc(B.x,B.y,b,x-qe,N)}}else{e.moveTo(o,a);const F=Math.cos(N)*h+o,P=Math.sin(N)*h+a;e.lineTo(F,P);const L=Math.cos($)*h+o,E=Math.sin($)*h+a;e.lineTo(L,E)}e.closePath()}function qAt(e,t,n,s,r){const{fullCircles:i,startAngle:o,circumference:a}=t;let l=t.endAngle;if(i){n1(e,t,n,s,l,r);for(let c=0;c<i;++c)e.fill();isNaN(a)||(l=o+(a%ye||ye))}return n1(e,t,n,s,l,r),e.fill(),l}function XAt(e,t,n,s,r){const{fullCircles:i,startAngle:o,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:u,borderDash:h,borderDashOffset:d}=l,f=l.borderAlign==="inner";if(!c)return;e.setLineDash(h||[]),e.lineDashOffset=d,f?(e.lineWidth=c*2,e.lineJoin=u||"round"):(e.lineWidth=c,e.lineJoin=u||"bevel");let p=t.endAngle;if(i){n1(e,t,n,s,p,r);for(let g=0;g<i;++g)e.stroke();isNaN(a)||(p=o+(a%ye||ye))}f&&GAt(e,t,p),i||(n1(e,t,n,s,p,r),e.stroke())}class ff extends Eo{constructor(n){super();at(this,"circumference");at(this,"endAngle");at(this,"fullCircles");at(this,"innerRadius");at(this,"outerRadius");at(this,"pixelMargin");at(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.getProps(["x","y"],r),{angle:o,distance:a}=OU(i,{x:n,y:s}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:h,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),f=(this.options.spacing+this.options.borderWidth)/2,p=At(d,c-l),g=Pp(o,l,c)&&l!==c,m=p>=ye||g,x=Xi(a,u+f,h+f);return m&&x}getCenterPoint(n){const{x:s,y:r,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:c,spacing:u}=this.options,h=(i+o)/2,d=(a+l+u+c)/2;return{x:s+Math.cos(h)*d,y:r+Math.sin(h)*d}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>ye?Math.floor(r/ye):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const c=1-Math.sin(Math.min(ve,r||0)),u=i*c;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,qAt(n,this,u,o,a),XAt(n,this,u,o,a),n.restore()}}at(ff,"id","arc"),at(ff,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),at(ff,"defaultRoutes",{backgroundColor:"backgroundColor"}),at(ff,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function fj(e,t,n=t){e.lineCap=At(n.borderCapStyle,t.borderCapStyle),e.setLineDash(At(n.borderDash,t.borderDash)),e.lineDashOffset=At(n.borderDashOffset,t.borderDashOffset),e.lineJoin=At(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=At(n.borderWidth,t.borderWidth),e.strokeStyle=At(n.borderColor,t.borderColor)}function YAt(e,t,n){e.lineTo(n.x,n.y)}function ZAt(e){return e.stepped?v$t:e.tension||e.cubicInterpolationMode==="monotone"?w$t:YAt}function pj(e,t,n={}){const s=e.length,{start:r=0,end:i=s-1}=n,{start:o,end:a}=t,l=Math.max(r,o),c=Math.min(i,a),u=r<o&&i<o||r>a&&i>a;return{count:s,start:l,loop:t.loop,ilen:c<l&&!u?s+c-l:c-l}}function QAt(e,t,n,s){const{points:r,options:i}=t,{count:o,start:a,loop:l,ilen:c}=pj(r,n,s),u=ZAt(i);let{move:h=!0,reverse:d}=s||{},f,p,g;for(f=0;f<=c;++f)p=r[(a+(d?c-f:f))%o],!p.skip&&(h?(e.moveTo(p.x,p.y),h=!1):u(e,g,p,d,i.stepped),g=p);return l&&(p=r[(a+(d?c:0))%o],u(e,g,p,d,i.stepped)),!!l}function JAt(e,t,n,s){const r=t.points,{count:i,start:o,ilen:a}=pj(r,n,s),{move:l=!0,reverse:c}=s||{};let u=0,h=0,d,f,p,g,m,x;const y=v=>(o+(c?a-v:v))%i,b=()=>{g!==m&&(e.lineTo(u,m),e.lineTo(u,g),e.lineTo(u,x))};for(l&&(f=r[y(0)],e.moveTo(f.x,f.y)),d=0;d<=a;++d){if(f=r[y(d)],f.skip)continue;const v=f.x,w=f.y,k=v|0;k===p?(w<g?g=w:w>m&&(m=w),u=(h*u+v)/++h):(b(),e.lineTo(v,w),p=k,h=0,g=m=w),x=w}b()}function Xk(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?JAt:QAt}function tRt(e){return e.stepped?J$t:e.tension||e.cubicInterpolationMode==="monotone"?tEt:fl}function eRt(e,t,n,s){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,s)&&r.closePath()),fj(e,t.options),e.stroke(r)}function nRt(e,t,n,s){const{segments:r,options:i}=t,o=Xk(t);for(const a of r)fj(e,i,a.style),e.beginPath(),o(e,t,a,{start:n,end:n+s-1})&&e.closePath(),e.stroke()}const sRt=typeof Path2D=="function";function rRt(e,t,n,s){sRt&&!t.options.segment?eRt(e,t,n,s):nRt(e,t,n,s)}class ta extends Eo{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;G$t(this._points,s,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=oEt(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,s=t.length;return s&&n[t[s-1].end]}interpolate(t,n){const s=this.options,r=t[n],i=this.points,o=tj(this,{property:n,start:r,end:r});if(!o.length)return;const a=[],l=tRt(s);let c,u;for(c=0,u=o.length;c<u;++c){const{start:h,end:d}=o[c],f=i[h],p=i[d];if(f===p){a.push(f);continue}const g=Math.abs((r-f[n])/(p[n]-f[n])),m=l(f,p,g,s.stepped);m[n]=t[n],a.push(m)}return a.length===1?a[0]:a}pathSegment(t,n,s){return Xk(this)(t,this,n,s)}path(t,n,s){const r=this.segments,i=Xk(this);let o=this._loop;n=n||0,s=s||this.points.length-n;for(const a of r)o&=i(t,this,a,{start:n,end:n+s-1});return!!o}draw(t,n,s,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(t.save(),rRt(t,this,s,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}at(ta,"id","line"),at(ta,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),at(ta,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),at(ta,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function DP(e,t,n,s){const r=e.options,{[n]:i}=e.getProps([n],s);return Math.abs(t-i)<r.radius+r.hitRadius}class yx extends Eo{constructor(n){super();at(this,"parsed");at(this,"skip");at(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.options,{x:o,y:a}=this.getProps(["x","y"],r);return Math.pow(n-o,2)+Math.pow(s-a,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(n,s){return DP(this,n,"x",s)}inYRange(n,s){return DP(this,n,"y",s)}getCenterPoint(n){const{x:s,y:r}=this.getProps(["x","y"],n);return{x:s,y:r}}size(n){n=n||this.options||{};let s=n.radius||0;s=Math.max(s,s&&n.hoverRadius||0);const r=s&&n.borderWidth||0;return(s+r)*2}draw(n,s){const r=this.options;this.skip||r.radius<.1||!Zi(this,s,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,Gk(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}at(yx,"id","point"),at(yx,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),at(yx,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function mj(e,t){const{x:n,y:s,base:r,width:i,height:o}=e.getProps(["x","y","base","width","height"],t);let a,l,c,u,h;return e.horizontal?(h=o/2,a=Math.min(n,r),l=Math.max(n,r),c=s-h,u=s+h):(h=i/2,a=n-h,l=n+h,c=Math.min(s,r),u=Math.max(s,r)),{left:a,top:c,right:l,bottom:u}}function ea(e,t,n,s){return e?0:Cn(t,n,s)}function iRt(e,t,n){const s=e.options.borderWidth,r=e.borderSkipped,i=UU(s);return{t:ea(r.top,i.top,0,n),r:ea(r.right,i.right,0,t),b:ea(r.bottom,i.bottom,0,n),l:ea(r.left,i.left,0,t)}}function oRt(e,t,n){const{enableBorderRadius:s}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,i=Ll(r),o=Math.min(t,n),a=e.borderSkipped,l=s||Wt(r);return{topLeft:ea(!l||a.top||a.left,i.topLeft,0,o),topRight:ea(!l||a.top||a.right,i.topRight,0,o),bottomLeft:ea(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:ea(!l||a.bottom||a.right,i.bottomRight,0,o)}}function aRt(e){const t=mj(e),n=t.right-t.left,s=t.bottom-t.top,r=iRt(e,n/2,s/2),i=oRt(e,n/2,s/2);return{outer:{x:t.left,y:t.top,w:n,h:s,radius:i},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function _2(e,t,n,s){const r=t===null,i=n===null,a=e&&!(r&&i)&&mj(e,s);return a&&(r||Xi(t,a.left,a.right))&&(i||Xi(n,a.top,a.bottom))}function lRt(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function cRt(e,t){e.rect(t.x,t.y,t.w,t.h)}function $2(e,t,n={}){const s=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,i=(e.x+e.w!==n.x+n.w?t:0)-s,o=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+s,y:e.y+r,w:e.w+i,h:e.h+o,radius:e.radius}}class zf extends Eo{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=aRt(this),a=lRt(o.radius)?Fp:cRt;t.save(),(o.w!==i.w||o.h!==i.h)&&(t.beginPath(),a(t,$2(o,n,i)),t.clip(),a(t,$2(i,-n,o)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),a(t,$2(i,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,s){return _2(this,t,n,s)}inXRange(t,n){return _2(this,t,null,n)}inYRange(t,n){return _2(this,null,t,n)}getCenterPoint(t){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],t);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}at(zf,"id","bar"),at(zf,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),at(zf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var uRt=Object.freeze({__proto__:null,ArcElement:ff,BarElement:zf,LineElement:ta,PointElement:yx});const Yk=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],OP=Yk.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function gj(e){return Yk[e%Yk.length]}function xj(e){return OP[e%OP.length]}function hRt(e,t){return e.borderColor=gj(t),e.backgroundColor=xj(t),++t}function dRt(e,t){return e.backgroundColor=e.data.map(()=>gj(t++)),t}function fRt(e,t){return e.backgroundColor=e.data.map(()=>xj(t++)),t}function pRt(e){let t=0;return(n,s)=>{const r=e.getDatasetMeta(s).controller;r instanceof Nl?t=dRt(n,t):r instanceof Lf?t=fRt(n,t):r&&(t=hRt(n,t))}}function PP(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function mRt(e){return e&&(e.borderColor||e.backgroundColor)}var gRt={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,n){if(!n.enabled)return;const{data:{datasets:s},options:r}=e.config,{elements:i}=r;if(!n.forceOverride&&(PP(s)||mRt(r)||i&&PP(i)))return;const o=pRt(e);s.forEach(o)}};function xRt(e,t,n,s,r){const i=r.samples||s;if(i>=n)return e.slice(t,t+n);const o=[],a=(n-2)/(i-2);let l=0;const c=t+n-1;let u=t,h,d,f,p,g;for(o[l++]=e[u],h=0;h<i-2;h++){let m=0,x=0,y;const b=Math.floor((h+1)*a)+1+t,v=Math.min(Math.floor((h+2)*a)+1,n)+t,w=v-b;for(y=b;y<v;y++)m+=e[y].x,x+=e[y].y;m/=w,x/=w;const k=Math.floor(h*a)+1+t,I=Math.min(Math.floor((h+1)*a)+1,n)+t,{x:C,y:N}=e[u];for(f=p=-1,y=k;y<I;y++)p=.5*Math.abs((C-m)*(e[y].y-N)-(C-e[y].x)*(x-N)),p>f&&(f=p,d=e[y],g=y);o[l++]=d,u=g}return o[l++]=e[c],o}function yRt(e,t,n,s){let r=0,i=0,o,a,l,c,u,h,d,f,p,g;const m=[],x=t+n-1,y=e[t].x,v=e[x].x-y;for(o=t;o<t+n;++o){a=e[o],l=(a.x-y)/v*s,c=a.y;const w=l|0;if(w===u)c<p?(p=c,h=o):c>g&&(g=c,d=o),r=(i*r+a.x)/++i;else{const k=o-1;if(!Kt(h)&&!Kt(d)){const I=Math.min(h,d),C=Math.max(h,d);I!==f&&I!==k&&m.push({...e[I],x:r}),C!==f&&C!==k&&m.push({...e[C],x:r})}o>0&&k!==f&&m.push(e[k]),m.push(a),u=w,i=0,p=g=c,h=d=f=o}}return m}function yj(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function FP(e){e.data.datasets.forEach(t=>{yj(t)})}function bRt(e,t){const n=t.length;let s=0,r;const{iScale:i}=e,{min:o,max:a,minDefined:l,maxDefined:c}=i.getUserBounds();return l&&(s=Cn(Yi(t,i.axis,o).lo,0,n-1)),c?r=Cn(Yi(t,i.axis,a).hi+1,s,n)-s:r=n-s,{start:s,count:r}}var vRt={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){FP(e);return}const s=e.width;e.data.datasets.forEach((r,i)=>{const{_data:o,indexAxis:a}=r,l=e.getDatasetMeta(i),c=o||r.data;if(hf([a,e.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=e.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||e.options.parsing)return;let{start:h,count:d}=bRt(l,c);const f=n.threshold||4*s;if(d<=f){yj(r);return}Kt(o)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(g){this._data=g}}));let p;switch(n.algorithm){case"lttb":p=xRt(c,h,d,s,n);break;case"min-max":p=yRt(c,h,d,s);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=p})},destroy(e){FP(e)}};function wRt(e,t,n){const s=e.segments,r=e.points,i=t.points,o=[];for(const a of s){let{start:l,end:c}=a;c=Q$(l,c,r);const u=Zk(n,r[l],r[c],a.loop);if(!t.segments){o.push({source:a,target:u,start:r[l],end:r[c]});continue}const h=tj(t,u);for(const d of h){const f=Zk(n,i[d.start],i[d.end],d.loop),p=JU(a,r,f);for(const g of p)o.push({source:g,target:d,start:{[n]:LP(u,f,"start",Math.max)},end:{[n]:LP(u,f,"end",Math.min)}})}}return o}function Zk(e,t,n,s){if(s)return;let r=t[e],i=n[e];return e==="angle"&&(r=js(r),i=js(i)),{property:e,start:r,end:i}}function SRt(e,t){const{x:n=null,y:s=null}=e||{},r=t.points,i=[];return t.segments.forEach(({start:o,end:a})=>{a=Q$(o,a,r);const l=r[o],c=r[a];s!==null?(i.push({x:l.x,y:s}),i.push({x:c.x,y:s})):n!==null&&(i.push({x:n,y:l.y}),i.push({x:n,y:c.y}))}),i}function Q$(e,t,n){for(;t>e;t--){const s=n[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function LP(e,t,n,s){return e&&t?s(e[n],t[n]):e?e[n]:t?t[n]:0}function bj(e,t){let n=[],s=!1;return Ce(e)?(s=!0,n=e):n=SRt(e,t),n.length?new ta({points:n,options:{tension:0},_loop:s,_fullLoop:s}):null}function MP(e){return e&&e.fill!==!1}function kRt(e,t,n){let r=e[t].fill;const i=[t];let o;if(!n)return r;for(;r!==!1&&i.indexOf(r)===-1;){if(!Pe(r))return r;if(o=e[r],!o)return!1;if(o.visible)return r;i.push(r),r=o.fill}return!1}function CRt(e,t,n){const s=_Rt(e);if(Wt(s))return isNaN(s.value)?!1:s;let r=parseFloat(s);return Pe(r)&&Math.floor(r)===r?IRt(s[0],t,r,n):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function IRt(e,t,n,s){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=s?!1:n}function TRt(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:Wt(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function NRt(e,t,n){let s;return e==="start"?s=n:e==="end"?s=t.options.reverse?t.min:t.max:Wt(e)?s=e.value:s=t.getBaseValue(),s}function _Rt(e){const t=e.options,n=t.fill;let s=At(n&&n.target,n);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function $Rt(e){const{scale:t,index:n,line:s}=e,r=[],i=s.segments,o=s.points,a=ERt(t,n);a.push(bj({x:null,y:t.bottom},s));for(let l=0;l<i.length;l++){const c=i[l];for(let u=c.start;u<=c.end;u++)ARt(r,o[u],a)}return new ta({points:r,options:{}})}function ERt(e,t){const n=[],s=e.getMatchingVisibleMetas("line");for(let r=0;r<s.length;r++){const i=s[r];if(i.index===t)break;i.hidden||n.unshift(i.dataset)}return n}function ARt(e,t,n){const s=[];for(let r=0;r<n.length;r++){const i=n[r],{first:o,last:a,point:l}=RRt(i,t,"x");if(!(!l||o&&a)){if(o)s.unshift(l);else if(e.push(l),!a)break}}e.push(...s)}function RRt(e,t,n){const s=e.interpolate(t,n);if(!s)return{};const r=s[n],i=e.segments,o=e.points;let a=!1,l=!1;for(let c=0;c<i.length;c++){const u=i[c],h=o[u.start][n],d=o[u.end][n];if(Xi(r,h,d)){a=r===h,l=r===d;break}}return{first:a,last:l,point:s}}class vj{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,s){const{x:r,y:i,radius:o}=this;return n=n||{start:0,end:ye},t.arc(r,i,o,n.end,n.start,!0),!s.bounds}interpolate(t){const{x:n,y:s,radius:r}=this,i=t.angle;return{x:n+Math.cos(i)*r,y:s+Math.sin(i)*r,angle:i}}}function DRt(e){const{chart:t,fill:n,line:s}=e;if(Pe(n))return ORt(t,n);if(n==="stack")return $Rt(e);if(n==="shape")return!0;const r=PRt(e);return r instanceof vj?r:bj(r,s)}function ORt(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function PRt(e){return(e.scale||{}).getPointPositionForValue?LRt(e):FRt(e)}function FRt(e){const{scale:t={},fill:n}=e,s=TRt(n,t);if(Pe(s)){const r=t.isHorizontal();return{x:r?s:null,y:r?null:s}}return null}function LRt(e){const{scale:t,fill:n}=e,s=t.options,r=t.getLabels().length,i=s.reverse?t.max:t.min,o=NRt(n,t,i),a=[];if(s.grid.circular){const l=t.getPointPositionForValue(0,i);return new vj({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(o)})}for(let l=0;l<r;++l)a.push(t.getPointPositionForValue(l,o));return a}function E2(e,t,n){const s=DRt(t),{line:r,scale:i,axis:o}=t,a=r.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:h=c}=l||{};s&&r.points.length&&(hw(e,n),MRt(e,{line:r,target:s,above:u,below:h,area:n,scale:i,axis:o}),dw(e))}function MRt(e,t){const{line:n,target:s,above:r,below:i,area:o,scale:a}=t,l=n._loop?"angle":t.axis;e.save(),l==="x"&&i!==r&&(zP(e,s,o.top),BP(e,{line:n,target:s,color:r,scale:a,property:l}),e.restore(),e.save(),zP(e,s,o.bottom)),BP(e,{line:n,target:s,color:i,scale:a,property:l}),e.restore()}function zP(e,t,n){const{segments:s,points:r}=t;let i=!0,o=!1;e.beginPath();for(const a of s){const{start:l,end:c}=a,u=r[l],h=r[Q$(l,c,r)];i?(e.moveTo(u.x,u.y),i=!1):(e.lineTo(u.x,n),e.lineTo(u.x,u.y)),o=!!t.pathSegment(e,a,{move:o}),o?e.closePath():e.lineTo(h.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function BP(e,t){const{line:n,target:s,property:r,color:i,scale:o}=t,a=wRt(n,s,r);for(const{source:l,target:c,start:u,end:h}of a){const{style:{backgroundColor:d=i}={}}=l,f=s!==!0;e.save(),e.fillStyle=d,zRt(e,o,f&&Zk(r,u,h)),e.beginPath();const p=!!n.pathSegment(e,l);let g;if(f){p?e.closePath():VP(e,s,h,r);const m=!!s.pathSegment(e,c,{move:p,reverse:!0});g=p&&m,g||VP(e,s,u,r)}e.closePath(),e.fill(g?"evenodd":"nonzero"),e.restore()}}function zRt(e,t,n){const{top:s,bottom:r}=t.chart.chartArea,{property:i,start:o,end:a}=n||{};i==="x"&&(e.beginPath(),e.rect(o,s,a-o,r-s),e.clip())}function VP(e,t,n,s){const r=t.interpolate(n,s);r&&e.lineTo(r.x,r.y)}var BRt={id:"filler",afterDatasetsUpdate(e,t,n){const s=(e.data.datasets||[]).length,r=[];let i,o,a,l;for(o=0;o<s;++o)i=e.getDatasetMeta(o),a=i.dataset,l=null,a&&a.options&&a instanceof ta&&(l={visible:e.isDatasetVisible(o),index:o,fill:CRt(a,o,s),chart:e,axis:i.controller.options.indexAxis,scale:i.vScale,line:a}),i.$filler=l,r.push(l);for(o=0;o<s;++o)l=r[o],!(!l||l.fill===!1)&&(l.fill=kRt(r,o,n.propagate))},beforeDraw(e,t,n){const s=n.drawTime==="beforeDraw",r=e.getSortedVisibleDatasetMetas(),i=e.chartArea;for(let o=r.length-1;o>=0;--o){const a=r[o].$filler;a&&(a.line.updateControlPoints(i,a.axis),s&&a.fill&&E2(e.ctx,a,i))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const s=e.getSortedVisibleDatasetMetas();for(let r=s.length-1;r>=0;--r){const i=s[r].$filler;MP(i)&&E2(e.ctx,i,e.chartArea)}},beforeDatasetDraw(e,t,n){const s=t.meta.$filler;!MP(s)||n.drawTime!=="beforeDatasetDraw"||E2(e.ctx,s,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const WP=(e,t)=>{let{boxHeight:n=t,boxWidth:s=t}=e;return e.usePointStyle&&(n=Math.min(n,t),s=e.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(t,n)}},VRt=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class UP extends Eo{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,s){this.maxWidth=t,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=ce(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(s=>t.filter(s,this.chart.data))),t.sort&&(n=n.sort((s,r)=>t.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,r=hn(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=WP(s,i);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,i,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let h=t;i.textAlign="left",i.textBaseline="middle";let d=-1,f=-u;return this.legendItems.forEach((p,g)=>{const m=s+n/2+i.measureText(p.text).width;(g===0||c[c.length-1]+m+2*a>o)&&(h+=u,c[c.length-(g>0?0:1)]=0,f+=u,d++),l[g]={left:0,top:f,row:d,width:m,height:r},c[c.length-1]+=m+a}),h}_fitCols(t,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-t;let h=a,d=0,f=0,p=0,g=0;return this.legendItems.forEach((m,x)=>{const{itemWidth:y,itemHeight:b}=WRt(s,n,i,m,r);x>0&&f+b+2*a>u&&(h+=d+a,c.push({width:d,height:f}),p+=d+a,g++,d=f=0),l[x]={left:p,top:f,col:g,width:y,height:b},d=Math.max(d,y),f+=b+a}),h+=d,c.push({width:d,height:f}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=Iu(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=Vn(s,this.left+r,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=Vn(s,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+t+r,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+r}else{let a=0,l=Vn(s,this.top+t+r,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=Vn(s,this.top+t+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;hw(t,this),this._draw(),dw(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=t,a=Fe.color,l=Iu(t.rtl,this.left,this.width),c=hn(o.font),{padding:u}=o,h=c.size,d=h/2;let f;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:p,boxHeight:g,itemHeight:m}=WP(o,h),x=function(k,I,C){if(isNaN(p)||p<=0||isNaN(g)||g<0)return;r.save();const N=At(C.lineWidth,1);if(r.fillStyle=At(C.fillStyle,a),r.lineCap=At(C.lineCap,"butt"),r.lineDashOffset=At(C.lineDashOffset,0),r.lineJoin=At(C.lineJoin,"miter"),r.lineWidth=N,r.strokeStyle=At(C.strokeStyle,a),r.setLineDash(At(C.lineDash,[])),o.usePointStyle){const $={radius:g*Math.SQRT2/2,pointStyle:C.pointStyle,rotation:C.rotation,borderWidth:N},A=l.xPlus(k,p/2),R=I+d;WU(r,$,A,R,o.pointStyleWidth&&p)}else{const $=I+Math.max((h-g)/2,0),A=l.leftForLtr(k,p),R=Ll(C.borderRadius);r.beginPath(),Object.values(R).some(z=>z!==0)?Fp(r,{x:A,y:$,w:p,h:g,radius:R}):r.rect(A,$,p,g),r.fill(),N!==0&&r.stroke()}r.restore()},y=function(k,I,C){yc(r,C.text,k,I+m/2,c,{strikethrough:C.hidden,textAlign:l.textAlign(C.textAlign)})},b=this.isHorizontal(),v=this._computeTitleHeight();b?f={x:Vn(i,this.left+u,this.right-s[0]),y:this.top+u+v,line:0}:f={x:this.left+u,y:Vn(i,this.top+v+u,this.bottom-n[0].height),line:0},YU(this.ctx,t.textDirection);const w=m+u;this.legendItems.forEach((k,I)=>{r.strokeStyle=k.fontColor,r.fillStyle=k.fontColor;const C=r.measureText(k.text).width,N=l.textAlign(k.textAlign||(k.textAlign=o.textAlign)),$=p+d+C;let A=f.x,R=f.y;l.setWidth(this.width),b?I>0&&A+$+u>this.right&&(R=f.y+=w,f.line++,A=f.x=Vn(i,this.left+u,this.right-s[f.line])):I>0&&R+w>this.bottom&&(A=f.x=A+n[f.line].width+u,f.line++,R=f.y=Vn(i,this.top+v+u,this.bottom-n[f.line].height));const z=l.x(A);if(x(z,R,k),A=c$t(N,A+p+d,b?A+$:this.right,t.rtl),y(l.x(A),R,k),b)f.x+=$+u;else if(typeof k.text!="string"){const U=c.lineHeight;f.y+=wj(k,U)+u}else f.y+=w}),ZU(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,s=hn(n.font),r=ts(n.padding);if(!n.display)return;const i=Iu(t.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,c=r.top+l;let u,h=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),u=this.top+c,h=Vn(t.align,h,this.right-d);else{const p=this.columnSizes.reduce((g,m)=>Math.max(g,m.height),0);u=c+Vn(t.align,this.top,this.bottom-p-t.labels.padding-this._computeTitleHeight())}const f=Vn(a,h,h+d);o.textAlign=i.textAlign(U$(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,yc(o,n.text,f,u,s)}_computeTitleHeight(){const t=this.options.title,n=hn(t.font),s=ts(t.padding);return t.display?n.lineHeight+s.height:0}_getLegendItemAt(t,n){let s,r,i;if(Xi(t,this.left,this.right)&&Xi(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],Xi(t,r.left,r.left+r.width)&&Xi(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(t){const n=this.options;if(!GRt(t.type,n))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,i=VRt(r,s);r&&!i&&ce(n.onLeave,[t,r,this],this),this._hoveredItem=s,s&&!i&&ce(n.onHover,[t,s,this],this)}else s&&ce(n.onClick,[t,s,this],this)}}function WRt(e,t,n,s,r){const i=URt(s,e,t,n),o=jRt(r,s,t.lineHeight);return{itemWidth:i,itemHeight:o}}function URt(e,t,n,s){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),t+n.size/2+s.measureText(r).width}function jRt(e,t,n){let s=e;return typeof t.text!="string"&&(s=wj(t,n)),s}function wj(e,t){const n=e.text?e.text.length:0;return t*n}function GRt(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var Sj={id:"legend",_element:UP,start(e,t,n){const s=e.legend=new UP({ctx:e.ctx,options:n,chart:e});Xn.configure(e,s,n),Xn.addBox(e,s)},stop(e){Xn.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const s=e.legend;Xn.configure(e,s,n),s.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const s=t.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),t.hidden=!0):(r.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=e.legend.options;return e._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),u=ts(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class J$ extends Eo{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=Ce(s.text)?s.text.length:1;this._padding=ts(s.padding);const i=r*hn(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:s,bottom:r,right:i,options:o}=this,a=o.align;let l=0,c,u,h;return this.isHorizontal()?(u=Vn(a,s,i),h=n+t,c=i-s):(o.position==="left"?(u=s+t,h=Vn(a,r,n),l=ve*-.5):(u=i-t,h=Vn(a,n,r),l=ve*.5),c=r-n),{titleX:u,titleY:h,maxWidth:c,rotation:l}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const s=hn(n.font),i=s.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(i);yc(t,n.text,0,0,s,{color:n.color,maxWidth:l,rotation:c,textAlign:U$(n.align),textBaseline:"middle",translation:[o,a]})}}function HRt(e,t){const n=new J$({ctx:e.ctx,options:t,chart:e});Xn.configure(e,n,t),Xn.addBox(e,n),e.titleBlock=n}var kj={id:"title",_element:J$,start(e,t,n){HRt(e,n)},stop(e){const t=e.titleBlock;Xn.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const s=e.titleBlock;Xn.configure(e,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const M0=new WeakMap;var KRt={id:"subtitle",start(e,t,n){const s=new J$({ctx:e.ctx,options:n,chart:e});Xn.configure(e,s,n),Xn.addBox(e,s),M0.set(e,s)},stop(e){Xn.removeBox(e,M0.get(e)),M0.delete(e)},beforeUpdate(e,t,n){const s=M0.get(e);Xn.configure(e,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const pf={average(e){if(!e.length)return!1;let t,n,s=new Set,r=0,i=0;for(t=0,n=e.length;t<n;++t){const a=e[t].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(e,t){if(!e.length)return!1;let n=t.x,s=t.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=e.length;i<o;++i){const l=e[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Uk(t,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function ii(e,t){return t&&(Ce(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Li(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function qRt(e,t){const{element:n,datasetIndex:s,index:r}=t,i=e.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:e,label:o,parsed:i.getParsed(r),raw:e.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function jP(e,t){const n=e.chart.ctx,{body:s,footer:r,title:i}=e,{boxWidth:o,boxHeight:a}=t,l=hn(t.bodyFont),c=hn(t.titleFont),u=hn(t.footerFont),h=i.length,d=r.length,f=s.length,p=ts(t.padding);let g=p.height,m=0,x=s.reduce((v,w)=>v+w.before.length+w.lines.length+w.after.length,0);if(x+=e.beforeBody.length+e.afterBody.length,h&&(g+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),x){const v=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;g+=f*v+(x-f)*l.lineHeight+(x-1)*t.bodySpacing}d&&(g+=t.footerMarginTop+d*u.lineHeight+(d-1)*t.footerSpacing);let y=0;const b=function(v){m=Math.max(m,n.measureText(v).width+y)};return n.save(),n.font=c.string,Jt(e.title,b),n.font=l.string,Jt(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?o+2+t.boxPadding:0,Jt(s,v=>{Jt(v.before,b),Jt(v.lines,b),Jt(v.after,b)}),y=0,n.font=u.string,Jt(e.footer,b),n.restore(),m+=p.width,{width:m,height:g}}function XRt(e,t){const{y:n,height:s}=t;return n<s/2?"top":n>e.height-s/2?"bottom":"center"}function YRt(e,t,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(e==="left"&&r+i+o>t.width||e==="right"&&r-i-o<0)return!0}function ZRt(e,t,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=e;let c="center";return s==="center"?c=r<=(a+l)/2?"left":"right":r<=i/2?c="left":r>=o-i/2&&(c="right"),YRt(c,e,t,n)&&(c="center"),c}function GP(e,t,n){const s=n.yAlign||t.yAlign||XRt(e,n);return{xAlign:n.xAlign||t.xAlign||ZRt(e,t,n,s),yAlign:s}}function QRt(e,t){let{x:n,width:s}=e;return t==="right"?n-=s:t==="center"&&(n-=s/2),n}function JRt(e,t,n){let{y:s,height:r}=e;return t==="top"?s+=n:t==="bottom"?s-=r+n:s-=r/2,s}function HP(e,t,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=e,{xAlign:a,yAlign:l}=n,c=r+i,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=Ll(o);let p=QRt(t,a);const g=JRt(t,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,d)+r:a==="right"&&(p+=Math.max(h,f)+r),{x:Cn(p,0,s.width-t.width),y:Cn(g,0,s.height-t.height)}}function z0(e,t,n){const s=ts(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-s.right:e.x+s.left}function KP(e){return ii([],Li(e))}function tDt(e,t,n){return Ya(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function qP(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const Cj={beforeTitle:Oi,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return n[t.dataIndex]}return""},afterTitle:Oi,beforeBody:Oi,beforeLabel:Oi,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return Kt(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Oi,afterBody:Oi,beforeFooter:Oi,footer:Oi,afterFooter:Oi};function vs(e,t,n,s){const r=e[t].call(n,s);return typeof r>"u"?Cj[t].call(n,s):r}class Qk extends Eo{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new ej(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=tDt(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:s}=n,r=vs(s,"beforeTitle",this,t),i=vs(s,"title",this,t),o=vs(s,"afterTitle",this,t);let a=[];return a=ii(a,Li(r)),a=ii(a,Li(i)),a=ii(a,Li(o)),a}getBeforeBody(t,n){return KP(vs(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:s}=n,r=[];return Jt(t,i=>{const o={before:[],lines:[],after:[]},a=qP(s,i);ii(o.before,Li(vs(a,"beforeLabel",this,i))),ii(o.lines,vs(a,"label",this,i)),ii(o.after,Li(vs(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(t,n){return KP(vs(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:s}=n,r=vs(s,"beforeFooter",this,t),i=vs(s,"footer",this,t),o=vs(s,"afterFooter",this,t);let a=[];return a=ii(a,Li(r)),a=ii(a,Li(i)),a=ii(a,Li(o)),a}_createItems(t){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(qRt(this.chart,n[l]));return t.filter&&(a=a.filter((u,h,d)=>t.filter(u,h,d,s))),t.itemSort&&(a=a.sort((u,h)=>t.itemSort(u,h,s))),Jt(a,u=>{const h=qP(t.callbacks,u);r.push(vs(h,"labelColor",this,u)),i.push(vs(h,"labelPointStyle",this,u)),o.push(vs(h,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(t,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=pf[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=jP(this,s),c=Object.assign({},a,l),u=GP(this.chart,s,c),h=HP(s,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,i={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,s,r){const i=this.getCaretPosition(t,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(t,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=Ll(a),{x:d,y:f}=t,{width:p,height:g}=n;let m,x,y,b,v,w;return i==="center"?(v=f+g/2,r==="left"?(m=d,x=m-o,b=v+o,w=v-o):(m=d+p,x=m+o,b=v-o,w=v+o),y=m):(r==="left"?x=d+Math.max(l,u)+o:r==="right"?x=d+p-Math.max(c,h)-o:x=this.caretX,i==="top"?(b=f,v=b-o,m=x-o,y=x+o):(b=f+g,v=b+o,m=x+o,y=x-o),w=b),{x1:m,x2:x,x3:y,y1:b,y2:v,y3:w}}drawTitle(t,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const c=Iu(s.rtl,this.x,this.width);for(t.x=z0(this,s.titleAlign,s),n.textAlign=c.textAlign(s.titleAlign),n.textBaseline="middle",o=hn(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,l+1===i&&(t.y+=s.titleMarginBottom-a)}}_drawColorBox(t,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=i,u=hn(i.bodyFont),h=z0(this,"left",i),d=r.x(h),f=l<u.lineHeight?(u.lineHeight-l)/2:0,p=n.y+f;if(i.usePointStyle){const g={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},m=r.leftForLtr(d,c)+c/2,x=p+l/2;t.strokeStyle=i.multiKeyBackground,t.fillStyle=i.multiKeyBackground,Gk(t,g,m,x),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,Gk(t,g,m,x)}else{t.lineWidth=Wt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const g=r.leftForLtr(d,c),m=r.leftForLtr(r.xPlus(d,1),c-2),x=Ll(o.borderRadius);Object.values(x).some(y=>y!==0)?(t.beginPath(),t.fillStyle=i.multiKeyBackground,Fp(t,{x:g,y:p,w:c,h:l,radius:x}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Fp(t,{x:m,y:p+1,w:c-2,h:l-2,radius:x}),t.fill()):(t.fillStyle=i.multiKeyBackground,t.fillRect(g,p,c,l),t.strokeRect(g,p,c,l),t.fillStyle=o.backgroundColor,t.fillRect(m,p+1,c-2,l-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=s,h=hn(s.bodyFont);let d=h.lineHeight,f=0;const p=Iu(s.rtl,this.x,this.width),g=function(C){n.fillText(C,p.x(t.x+f),t.y+d/2),t.y+=d+i},m=p.textAlign(o);let x,y,b,v,w,k,I;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,t.x=z0(this,m,s),n.fillStyle=s.bodyColor,Jt(this.beforeBody,g),f=a&&m!=="right"?o==="center"?c/2+u:c+2+u:0,v=0,k=r.length;v<k;++v){for(x=r[v],y=this.labelTextColors[v],n.fillStyle=y,Jt(x.before,g),b=x.lines,a&&b.length&&(this._drawColorBox(n,t,v,p,s),d=Math.max(h.lineHeight,l)),w=0,I=b.length;w<I;++w)g(b[w]),d=h.lineHeight;Jt(x.after,g)}f=0,d=h.lineHeight,Jt(this.afterBody,g),t.y-=i}drawFooter(t,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=Iu(s.rtl,this.x,this.width);for(t.x=z0(this,s.footerAlign,s),t.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=hn(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+s.footerSpacing}}drawBackground(t,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=t,{width:c,height:u}=s,{topLeft:h,topRight:d,bottomLeft:f,bottomRight:p}=Ll(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+h,l),o==="top"&&this.drawCaret(t,n,s,r),n.lineTo(a+c-d,l),n.quadraticCurveTo(a+c,l,a+c,l+d),o==="center"&&i==="right"&&this.drawCaret(t,n,s,r),n.lineTo(a+c,l+u-p),n.quadraticCurveTo(a+c,l+u,a+c-p,l+u),o==="bottom"&&this.drawCaret(t,n,s,r),n.lineTo(a+f,l+u),n.quadraticCurveTo(a,l+u,a,l+u-f),o==="center"&&i==="left"&&this.drawCaret(t,n,s,r),n.lineTo(a,l+h),n.quadraticCurveTo(a,l,a+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=pf[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=jP(this,t),l=Object.assign({},o,this._size),c=GP(n,t,l),u=HP(t,l,c,n);(r._to!==u.x||i._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=ts(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(t.save(),t.globalAlpha=s,this.drawBackground(i,t,r,n),YU(t,n.textDirection),i.y+=o.top,this.drawTitle(i,t,n),this.drawBody(i,t,n),this.drawFooter(i,t,n),ZU(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const s=this._active,r=t.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),i=!Yy(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(t,i,n,s),a=this._positionChanged(o,t),l=n||!Yy(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),l}_getActiveElements(t,n,s,r){const i=this.options;if(t.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(t,n){const{caretX:s,caretY:r,options:i}=this,o=pf[i.position].call(this,t,n);return o!==!1&&(s!==o.x||r!==o.y)}}at(Qk,"positioners",pf);var Ij={id:"tooltip",_element:Qk,positioners:pf,afterInit(e,t,n){n&&(e.tooltip=new Qk({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Cj},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},eDt=Object.freeze({__proto__:null,Colors:gRt,Decimation:vRt,Filler:BRt,Legend:Sj,SubTitle:KRt,Title:kj,Tooltip:Ij});const nDt=(e,t,n,s)=>(typeof t=="string"?(n=e.push(t)-1,s.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function sDt(e,t,n,s){const r=e.indexOf(t);if(r===-1)return nDt(e,t,n,s);const i=e.lastIndexOf(t);return r!==i?n:r}const rDt=(e,t)=>e===null?null:Cn(Math.round(e),0,t);function XP(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class s1 extends Wc{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(Kt(t))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===t?n:sDt(s,t,At(n,t),this._addedLabels),rDt(n,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const t=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=t===0&&n===i.length-1?i:i.slice(t,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=t;o<=n;o++)r.push({value:o});return r}getLabelForValue(t){return XP.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}at(s1,"id","category"),at(s1,"defaults",{ticks:{callback:XP}});function iDt(e,t){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:d}=e,f=i||1,p=u-1,{min:g,max:m}=t,x=!Kt(o),y=!Kt(a),b=!Kt(c),v=(m-g)/(h+1);let w=UO((m-g)/p/f)*f,k,I,C,N;if(w<1e-14&&!x&&!y)return[{value:g},{value:m}];N=Math.ceil(m/w)-Math.floor(g/w),N>p&&(w=UO(N*w/p/f)*f),Kt(l)||(k=Math.pow(10,l),w=Math.ceil(w*k)/k),r==="ticks"?(I=Math.floor(g/w)*w,C=Math.ceil(m/w)*w):(I=g,C=m),x&&y&&i&&n$t((a-o)/i,w/1e3)?(N=Math.round(Math.min((a-o)/w,u)),w=(a-o)/N,I=o,C=a):b?(I=x?o:I,C=y?a:C,N=c-1,w=(C-I)/N):(N=(C-I)/w,Df(N,Math.round(N),w/1e3)?N=Math.round(N):N=Math.ceil(N));const $=Math.max(jO(w),jO(I));k=Math.pow(10,Kt(l)?$:l),I=Math.round(I*k)/k,C=Math.round(C*k)/k;let A=0;for(x&&(d&&I!==o?(n.push({value:o}),I<o&&A++,Df(Math.round((I+A*w)*k)/k,o,YP(o,v,e))&&A++):I<o&&A++);A<N;++A){const R=Math.round((I+A*w)*k)/k;if(y&&R>a)break;n.push({value:R})}return y&&d&&C!==a?n.length&&Df(n[n.length-1].value,a,YP(a,v,e))?n[n.length-1].value=a:n.push({value:a}):(!y||C===a)&&n.push({value:C}),n}function YP(e,t,{horizontal:n,minRotation:s}){const r=Br(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}class r1 extends Wc{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return Kt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(t){const l=Si(r),c=Si(i);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),t||o(r-l)}this.min=r,this.max=i}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=t,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=iDt(r,i);return t.bounds==="ticks"&&DU(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const r=(s-n)/Math.max(t.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(t){return Bg(t,this.chart.options.locale,this.options.ticks.format)}}class i1 extends r1{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Pe(t)?t:0,this.max=Pe(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,s=Br(this.options.ticks.minRotation),r=(t?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}at(i1,"id","linear"),at(i1,"defaults",{ticks:{callback:uw.formatters.numeric}});const Mp=e=>Math.floor(Jo(e)),rl=(e,t)=>Math.pow(10,Mp(e)+t);function ZP(e){return e/Math.pow(10,Mp(e))===1}function QP(e,t,n){const s=Math.pow(10,n),r=Math.floor(e/s);return Math.ceil(t/s)-r}function oDt(e,t){const n=t-e;let s=Mp(n);for(;QP(e,t,s)>10;)s++;for(;QP(e,t,s)<10;)s--;return Math.min(s,Mp(e))}function aDt(e,{min:t,max:n}){t=Vs(e.min,t);const s=[],r=Mp(t);let i=oDt(t,n),o=i<0?Math.pow(10,Math.abs(i)):1;const a=Math.pow(10,i),l=r>i?Math.pow(10,r):0,c=Math.round((t-l)*o)/o,u=Math.floor((t-l)/a/10)*a*10;let h=Math.floor((c-u)/Math.pow(10,i)),d=Vs(e.min,Math.round((l+u+h*Math.pow(10,i))*o)/o);for(;d<n;)s.push({value:d,major:ZP(d),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(i++,h=2,o=i>=0?1:o),d=Math.round((l+u+h*Math.pow(10,i))*o)/o;const f=Vs(e.max,d);return s.push({value:f,major:ZP(f),significand:h}),s}class Jk extends Wc{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const s=r1.prototype.parse.apply(this,[t,n]);if(s===0){this._zero=!0;return}return Pe(s)&&s>0?s:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Pe(t)?Math.max(0,t):null,this.max=Pe(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Pe(this._userMin)&&(this.min=t===rl(this.min,0)?rl(this.min,-1):rl(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let s=this.min,r=this.max;const i=a=>s=t?s:a,o=a=>r=n?r:a;s===r&&(s<=0?(i(1),o(10)):(i(rl(s,-1)),o(rl(r,1)))),s<=0&&i(rl(r,-1)),r<=0&&o(rl(s,1)),this.min=s,this.max=r}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},s=aDt(n,this);return t.bounds==="ticks"&&DU(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":Bg(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=Jo(t),this._valueRange=Jo(this.max)-Jo(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Jo(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}at(Jk,"id","logarithmic"),at(Jk,"defaults",{ticks:{callback:uw.formatters.logarithmic,major:{enabled:!0}}});function tC(e){const t=e.ticks;if(t.display&&e.display){const n=ts(t.backdropPadding);return At(t.font&&t.font.size,Fe.font.size)+n.height}return 0}function lDt(e,t,n){return n=Ce(n)?n:[n],{w:b$t(e,t.string,n),h:n.length*t.lineHeight}}function JP(e,t,n,s,r){return e===s||e===r?{start:t-n/2,end:t+n/2}:e<s||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function cDt(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),s=[],r=[],i=e._pointLabels.length,o=e.options.pointLabels,a=o.centerPointLabels?ve/i:0;for(let l=0;l<i;l++){const c=o.setContext(e.getPointLabelContext(l));r[l]=c.padding;const u=e.getPointPosition(l,e.drawingArea+r[l],a),h=hn(c.font),d=lDt(e.ctx,h,e._pointLabels[l]);s[l]=d;const f=js(e.getIndexAngle(l)+a),p=Math.round(V$(f)),g=JP(p,u.x,d.w,0,180),m=JP(p,u.y,d.h,90,270);uDt(n,t,f,g,m)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=fDt(e,s,r)}function uDt(e,t,n,s,r){const i=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,l=0;s.start<t.l?(a=(t.l-s.start)/i,e.l=Math.min(e.l,t.l-a)):s.end>t.r&&(a=(s.end-t.r)/i,e.r=Math.max(e.r,t.r+a)),r.start<t.t?(l=(t.t-r.start)/o,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/o,e.b=Math.max(e.b,t.b+l))}function hDt(e,t,n){const s=e.drawingArea,{extra:r,additionalAngle:i,padding:o,size:a}=n,l=e.getPointPosition(t,s+r+o,i),c=Math.round(V$(js(l.angle+qe))),u=gDt(l.y,a.h,c),h=pDt(c),d=mDt(l.x,a.w,h);return{visible:!0,x:l.x,y:u,textAlign:h,left:d,top:u,right:d+a.w,bottom:u+a.h}}function dDt(e,t){if(!t)return!0;const{left:n,top:s,right:r,bottom:i}=e;return!(Zi({x:n,y:s},t)||Zi({x:n,y:i},t)||Zi({x:r,y:s},t)||Zi({x:r,y:i},t))}function fDt(e,t,n){const s=[],r=e._pointLabels.length,i=e.options,{centerPointLabels:o,display:a}=i.pointLabels,l={extra:tC(i)/2,additionalAngle:o?ve/r:0};let c;for(let u=0;u<r;u++){l.padding=n[u],l.size=t[u];const h=hDt(e,u,l);s.push(h),a==="auto"&&(h.visible=dDt(h,c),h.visible&&(c=h))}return s}function pDt(e){return e===0||e===180?"center":e<180?"left":"right"}function mDt(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function gDt(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function xDt(e,t,n){const{left:s,top:r,right:i,bottom:o}=n,{backdropColor:a}=t;if(!Kt(a)){const l=Ll(t.borderRadius),c=ts(t.backdropPadding);e.fillStyle=a;const u=s-c.left,h=r-c.top,d=i-s+c.width,f=o-r+c.height;Object.values(l).some(p=>p!==0)?(e.beginPath(),Fp(e,{x:u,y:h,w:d,h:f,radius:l}),e.fill()):e.fillRect(u,h,d,f)}}function yDt(e,t){const{ctx:n,options:{pointLabels:s}}=e;for(let r=t-1;r>=0;r--){const i=e._pointLabelItems[r];if(!i.visible)continue;const o=s.setContext(e.getPointLabelContext(r));xDt(n,o,i);const a=hn(o.font),{x:l,y:c,textAlign:u}=i;yc(n,e._pointLabels[r],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function Tj(e,t,n,s){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,ye);else{let i=e.getPointPosition(0,t);r.moveTo(i.x,i.y);for(let o=1;o<s;o++)i=e.getPointPosition(o,t),r.lineTo(i.x,i.y)}}function bDt(e,t,n,s,r){const i=e.ctx,o=t.circular,{color:a,lineWidth:l}=t;!o&&!s||!a||!l||n<0||(i.save(),i.strokeStyle=a,i.lineWidth=l,i.setLineDash(r.dash),i.lineDashOffset=r.dashOffset,i.beginPath(),Tj(e,n,o,s),i.closePath(),i.stroke(),i.restore())}function vDt(e,t,n){return Ya(e,{label:n,index:t,type:"pointLabel"})}class mf extends r1{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=ts(tC(this.options)/2),n=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(n,s)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=Pe(t)&&!isNaN(t)?t:0,this.max=Pe(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/tC(this.options))}generateTickLabels(t){r1.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,s)=>{const r=ce(this.options.pointLabels.callback,[n,s],this);return r||r===0?r:""}).filter((n,s)=>this.chart.getDataVisibility(s))}fit(){const t=this.options;t.display&&t.pointLabels.display?cDt(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,s,r){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((s-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,s,r))}getIndexAngle(t){const n=ye/(this._pointLabels.length||1),s=this.options.startAngle||0;return js(t*n+Br(s))}getDistanceFromCenterForValue(t){if(Kt(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(Kt(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const s=n[t];return vDt(this.getContext(),t,s)}}getPointPosition(t,n,s=0){const r=this.getIndexAngle(t)-qe+s;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:s,right:r,bottom:i}=this._pointLabelItems[t];return{left:n,top:s,right:r,bottom:i}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const s=this.ctx;s.save(),s.beginPath(),Tj(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:s,grid:r,border:i}=n,o=this._pointLabels.length;let a,l,c;if(n.pointLabels.display&&yDt(this,o),r.display&&this.ticks.forEach((u,h)=>{if(h!==0||h===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const d=this.getContext(h),f=r.setContext(d),p=i.setContext(d);bDt(this,f,l,o,p)}}),s.display){for(t.save(),a=o-1;a>=0;a--){const u=s.setContext(this.getPointLabelContext(a)),{color:h,lineWidth:d}=u;!d||!h||(t.lineWidth=d,t.strokeStyle=h,t.setLineDash(u.borderDash),t.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),c=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,s=n.ticks;if(!s.display)return;const r=this.getIndexAngle(0);let i,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!n.reverse)return;const c=s.setContext(this.getContext(l)),u=hn(c.font);if(i=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=u.string,o=t.measureText(a.label).width,t.fillStyle=c.backdropColor;const h=ts(c.backdropPadding);t.fillRect(-o/2-h.left,-i-u.size/2-h.top,o+h.width,u.size+h.height)}yc(t,a.label,0,-i,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}}at(mf,"id","radialLinear"),at(mf,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:uw.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),at(mf,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),at(mf,"descriptors",{angleLines:{_fallback:"grid"}});const pw={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ns=Object.keys(pw);function tF(e,t){return e-t}function eF(e,t){if(Kt(t))return null;const n=e._adapter,{parser:s,round:r,isoWeekday:i}=e._parseOpts;let o=t;return typeof s=="function"&&(o=s(o)),Pe(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(th(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function nF(e,t,n,s){const r=Ns.length;for(let i=Ns.indexOf(e);i<r-1;++i){const o=pw[Ns[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(a*o.size))<=s)return Ns[i]}return Ns[r-1]}function wDt(e,t,n,s,r){for(let i=Ns.length-1;i>=Ns.indexOf(n);i--){const o=Ns[i];if(pw[o].common&&e._adapter.diff(r,s,o)>=t-1)return o}return Ns[n?Ns.indexOf(n):0]}function SDt(e){for(let t=Ns.indexOf(e)+1,n=Ns.length;t<n;++t)if(pw[Ns[t]].common)return Ns[t]}function sF(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:s,hi:r}=W$(n,t),i=n[s]>=t?n[s]:n[r];e[i]=!0}}function kDt(e,t,n,s){const r=e._adapter,i=+r.startOf(t[0].value,s),o=t[t.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(t[l].major=!0);return t}function rF(e,t,n){const s=[],r={},i=t.length;let o,a;for(o=0;o<i;++o)a=t[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:kDt(e,s,r,n)}class zp extends Wc{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const s=t.time||(t.time={}),r=this._adapter=new PEt._date(t.adapters.date);r.init(n),Rf(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:eF(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,s=t.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Pe(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Pe(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],s=t[t.length-1]),{min:n,max:s}}buildTicks(){const t=this.options,n=t.time,s=t.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=o$t(r,i,o);return this._unit=n.unit||(s.autoSkip?nF(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):wDt(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:SDt(this._unit),this.initOffsets(r),t.reverse&&a.reverse(),rF(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,s=0,r,i;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,i=this.getDecimalForValue(t[t.length-1]),t.length===1?s=i:s=(i-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;n=Cn(n,0,o),s=Cn(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const t=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||nF(i.minUnit,n,s,this._getLabelCapacity(n)),a=At(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,c=th(l)||l===!0,u={};let h=n,d,f;if(c&&(h=+t.startOf(h,"isoWeek",l)),h=+t.startOf(h,c?"day":o),t.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const p=r.ticks.source==="data"&&this.getDataTimestamps();for(d=h,f=0;d<s;d=+t.add(d,a,o),f++)sF(u,d,p);return(d===s||r.bounds==="ticks"||f===1)&&sF(u,d,p),Object.keys(u).sort(tF).map(g=>+g)}getLabelForValue(t){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(t,s.tooltipFormat):n.format(t,s.displayFormats.datetime)}format(t,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(t,o)}_tickFormatFunction(t,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return ce(o,[t,n,s],this);const a=i.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],h=c&&a[c],d=s[n],f=c&&h&&d&&d.major;return this._adapter.format(t,r||(f?h:u))}generateTickLabels(t){let n,s,r;for(n=0,s=t.length;n<s;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(t){const n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,s=this.ctx.measureText(t).width,r=Br(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(t){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(t,0,rF(this,[t],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],n,s;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,s;if(t.length)return t;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)t.push(eF(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return FU(t.sort(tF))}}at(zp,"id","time"),at(zp,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function B0(e,t,n){let s=0,r=e.length-1,i,o,a,l;n?(t>=e[s].pos&&t<=e[r].pos&&({lo:s,hi:r}=Yi(e,"pos",t)),{pos:i,time:a}=e[s],{pos:o,time:l}=e[r]):(t>=e[s].time&&t<=e[r].time&&({lo:s,hi:r}=Yi(e,"time",t)),{time:i,pos:a}=e[s],{time:o,pos:l}=e[r]);const c=o-i;return c?a+(l-a)*(t-i)/c:a}class eC extends zp{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=B0(n,this.min),this._tableRange=B0(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:s}=this,r=[],i=[];let o,a,l,c,u;for(o=0,a=t.length;o<a;++o)c=t[o],c>=n&&c<=s&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],l=r[o-1],c=r[o],Math.round((u+l)/2)!==c&&i.push({time:c,pos:o/(a-1)});return i}_generate(){const t=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?t=this.normalize(n.concat(s)):t=n.length?n:s,t=this._cache.all=t,t}getDecimalForValue(t){return(B0(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return B0(this._table,s*this._tableRange+this._minPos,!0)}}at(eC,"id","timeseries"),at(eC,"defaults",zp.defaults);var CDt=Object.freeze({__proto__:null,CategoryScale:s1,LinearScale:i1,LogarithmicScale:Jk,RadialLinearScale:mf,TimeScale:zp,TimeSeriesScale:eC});const IDt=[OEt,uRt,eDt,CDt],Nj="label";function iF(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function TDt(e,t){const n=e.options;n&&t&&Object.assign(n,t)}function _j(e,t){e.labels=t}function $j(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Nj;const s=[];e.datasets=t.map(r=>{const i=e.datasets.find(o=>o[n]===r[n]);return!i||!r.data||s.includes(i)?{...r}:(s.push(i),Object.assign(i,r),i)})}function NDt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nj;const n={labels:[],datasets:[]};return _j(n,e.labels),$j(n,e.datasets,t),n}function _Dt(e,t){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:i,type:o,data:a,options:l,plugins:c=[],fallbackContent:u,updateMode:h,...d}=e,f=K.useRef(null),p=K.useRef(),g=()=>{f.current&&(p.current=new Wg(f.current,{type:o,data:NDt(a,i),options:l&&{...l},plugins:c}),iF(t,p.current))},m=()=>{iF(t,null),p.current&&(p.current.destroy(),p.current=null)};return K.useEffect(()=>{!r&&p.current&&l&&TDt(p.current,l)},[r,l]),K.useEffect(()=>{!r&&p.current&&_j(p.current.config.data,a.labels)},[r,a.labels]),K.useEffect(()=>{!r&&p.current&&a.datasets&&$j(p.current.config.data,a.datasets,i)},[r,a.datasets]),K.useEffect(()=>{p.current&&(r?(m(),setTimeout(g)):p.current.update(h))},[r,l,a.labels,a.datasets,h]),K.useEffect(()=>{p.current&&(m(),setTimeout(g))},[o]),K.useEffect(()=>(g(),()=>m()),[]),Mt.createElement("canvas",Object.assign({ref:f,role:"img",height:n,width:s},d),u)}const $Dt=K.forwardRef(_Dt);function Ej(e,t){return Wg.register(t),K.forwardRef((n,s)=>Mt.createElement($Dt,Object.assign({},n,{ref:s,type:e})))}const nC=Ej("bar",Ff),EDt=Ej("scatter",Mf),Aj=ki;function o1(){const e=["length","602555xoLlUO","string","w-64 bg-gray-300 rounded-full h-4","9664389tjfpPP","key","while (true) {}","call","div","opacity-50","test","mt-16 text-center text-gray-300","log","An unknown error occurred during query processing.","...","function *\\( *\\)","map","text-5xl font-bold text-white mb-4","norm","text-xl text-gray-200","rgba(255,255,255,0.1)","euclidean","init","Enter","index","1458264sJsbwP","absolute inset-0 bg-gradient-to-r from-white to-transparent opacity-20 rounded-2xl filter blur-lg","bg-opacity-20","sort","text-center mb-12","316323NmLcej","opacity-100","4410768WztYaU","All chunks loaded.","max-h-96","add","Type your query here...","An unknown error occurred during chunk loading.","text-gray-200 mt-2 transition-opacity duration-500 ","Doc ","button","stringify","mr-2",": Similarity ","counter","1184964SKOaUD","gger","trim","white","226533JYOnhG","squeeze","matMul","tensor2d","bg-blue-500 h-4 rounded-full","8ZCgTbY","debu","3kMEhin","similarity","stateObject","max-h-32","constructor","Loading data...","mt-8","min-h-screen bg-gradient-to-br from-purple-600 via-pink-500 to-red-500 p-8 flex items-center justify-center","message","text-3xl font-semibold text-white mb-6","concat","An unknown error occurred while loading metadata.","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","footer","expandDims","chain","documents","relative max-w-2xl w-full","scalar","slice","mb-6 transform transition-all duration-500 ease-in-out ","input","rgba(75, 192, 192, 0.6)","text-white text-xl mb-4","Cosine Similarity","text","text-red-500 text-center mt-4","text-white mt-2","dispose","flex flex-col items-center justify-center min-h-screen","array","apply","register","action","Results","mul","Discover relevant documents using Latent Semantic Analysis.","w-full p-4 rounded mb-6 bg-white bg-opacity-30 placeholder-gray-200 text-white focus:outline-none focus:ring-2 focus:ring-purple-300 transition duration-300","target"];return o1=function(){return e},o1()}(function(e,t){const n=ki,s=e();for(;;)try{if(parseInt(n(401))/1+-parseInt(n(472))/2*(-parseInt(n(408))/3)+-parseInt(n(479))/4+parseInt(n(448))/5+-parseInt(n(397))/6+parseInt(n(477))/7*(-parseInt(n(406))/8)+parseInt(n(451))/9===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(o1,804622);const ADt=function(){let e=!0;return function(t,n){const s=e?function(){const r=ki;if(n){const i=n[r(439)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){ADt(this,function(){const e=ki,t=new RegExp(e(462)),n=new RegExp(e(420),"i"),s=oF(e(469));!t[e(457)](s+e(423))||!n[e(457)](s+e(429))?s("0"):oF()})()})();Wg[Aj(440)](s1,i1,zf,kj,Ij,Sj);function ki(e,t){const n=o1();return ki=function(s,r){return s=s-390,n[s]},ki(e,t)}const A2=189;function RDt(){const e=Aj,[t,n]=K.useState(""),[s,r]=K.useState(null),[i,o]=K.useState([]),[a,l]=K.useState(null),[c,u]=K.useState(!0),[h,d]=K.useState(0),[f,p]=K.useState({Vt:[],terms:[],U:[],documents:[]}),[g,m]=K.useState(null);K.useEffect(()=>{(async()=>{const v=ki;try{const w=await WY();p({...w,U:[],documents:[]}),await x(0)}catch(w){w instanceof Error?m(w[v(416)]):m(v(419))}})()},[]);const x=async b=>{const v=ki;try{console[v(459)]("Loading chunk "+b+v(461));const w=await jY(b);console[v(459)]("Chunk "+b+" loaded."),p(k=>({...k,U:k.U.concat(w.U),documents:k[v(424)][v(418)](w[v(424)])})),d(b+1),b+1<A2?await x(b+1):(u(!1),console[v(459)](v(480)))}catch(w){w instanceof Error?m(w[v(416)]):m(v(484))}},y=async()=>{const b=ki;if(!t[b(399)]()){m("Please enter a query.");return}m(null);try{const{U:v,Vt:w,terms:k,documents:I}=f,C=k_t(t,k,w),N=Yc[b(404)](v),$=Yc[b(403)](N,C[b(422)](1))[b(402)](),A=Yc[b(465)](N,b(468),1),R=Yc[b(465)](C),z=A[b(443)](R)[b(482)](Yc[b(426)](1e-8)),U=$.div(z),F=await U[b(438)](),P=F[b(463)]((L,E)=>({index:E,similarity:L,document:I[E]}))[b(475)]((L,E)=>E[b(409)]-L.similarity)[b(427)](0,5);o(P),l({labels:P[b(463)](L=>b(391)+L[b(471)]),datasets:[{label:b(432),data:P[b(463)](L=>L.similarity),backgroundColor:b(430)}]}),N[b(436)](),$[b(436)](),U[b(436)]()}catch(v){v instanceof Error?m(v[b(416)]):m(b(460))}};return j.jsx(e(455),{className:e(415),children:j.jsxs(e(455),{className:e(425),children:[j.jsx("div",{className:e(473)}),j.jsx("div",{className:"relative bg-white bg-opacity-10 border border-white border-opacity-30 backdrop-filter backdrop-blur-xl rounded-2xl shadow-2xl p-8",children:c?j.jsxs("div",{className:e(437),children:[j.jsx(e(455),{className:e(431),children:e(413)}),j.jsx("div",{className:e(450),children:j.jsx(e(455),{className:e(405),style:{width:h/A2*100+"%"}})}),j.jsxs("div",{className:e(435),children:[Math.round(h/A2*100),"%"]})]}):j.jsxs(j.Fragment,{children:[j.jsxs(e(455),{className:e(476),children:[j.jsx("h1",{className:e(464),children:"LSA Search Engine"}),j.jsx("p",{className:e(466),children:e(444)})]}),j.jsx("input",{type:e(433),className:e(445),placeholder:e(483),value:t,onChange:b=>n(b[e(446)].value),onKeyDown:b=>{const v=e;b[v(452)]===v(470)&&y()}}),j.jsxs(e(392),{onClick:y,className:"w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-pink-500 hover:to-purple-500 transition duration-300 transform hover:scale-105 flex items-center justify-center",children:[j.jsx(fY,{className:e(394)}),"Search"]}),g&&j.jsx(e(455),{className:e(434),children:g}),i.length>0&&j.jsxs(e(455),{className:e(414),children:[j.jsx("h2",{className:e(417),children:e(442)}),j.jsx("ul",{children:i[e(463)]((b,v)=>j.jsx("li",{className:e(428)+(v===s?"scale-105 bg-opacity-40":e(474)),onMouseEnter:()=>r(v),onMouseLeave:()=>r(null),children:j.jsxs(e(455),{className:"bg-white bg-opacity-20 p-4 rounded-lg shadow-lg hover:bg-opacity-30 transition-all duration-500 ease-in-out overflow-hidden "+e(v===s?481:411),style:{transition:"all 0.5s ease-in-out"},children:[j.jsxs("p",{className:"text-white text-lg font-semibold",children:["Document ",b[e(471)],e(395),b[e(409)].toFixed(4)]}),j.jsx("p",{className:e(390)+e(v===s?478:456),children:b.document[e(433)]})]})},v))}),j.jsx("div",{className:e(414),children:j.jsx(nC,{data:a,options:{responsive:!0,scales:{x:{ticks:{color:e(400)},grid:{display:!1}},y:{ticks:{color:"white"},grid:{color:e(467)}}},animation:{duration:1e3,easing:"easeInOutQuad"}}},JSON[e(393)](a))})]}),j.jsx(e(421),{className:e(458),children:" 2024 Nathan Clark. All rights reserved."})]})})]})})}function oF(e){function t(n){const s=ki;if(typeof n===s(449))return(function(r){}).constructor(s(453)).apply(s(396));(""+n/n)[s(447)]!==1||n%20===0?(function(){return!0})[s(412)](s(407)+s(398))[s(454)](s(441)):(function(){return!1}).constructor(s(407)+s(398))[s(439)](s(410)),t(++n)}try{if(e)return t;t(0)}catch{}}const Rj=Cs;function a1(){const e=["Interactive Linear Regression Assumptions","line","gger","min","random","4RLVsQN","Variance ():","6121157BwWHIq","any","941349cpEYaP","constructor","apply","10CSBKcY","5gFrPXv","string","Frequency","input w-full p-2 rounded bg-gray-700 text-white","input","test","reduce","target","max","init","floor","block font-medium","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","Generated Plot","Slope Bins","text-xl font-semibold mt-6","6556026McpIbe","Histogram of Intercepts","mt-4","label","results mt-8","abs","map","action","div","Number of Simulations (S):","Regression Line: Y = ","register","form","preventDefault","rgba(255, 159, 64, 0.6)","number","Proportion of slopes more extreme than calculated slope: ","counter","rgba(54, 162, 235, 0.6)","3005984hhcCwU","Slopes","call","Intercept Bins","counts","40NPbbXk","sigma2","value","button","text-2xl font-semibold mb-4","4266658mzmkgA","1411075EynDdv","rgba(255, 99, 132, 1)","while (true) {}","toFixed","from","log","filter","stateObject","bins","length","w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded","chain","push","forEach","1122201pvbTBV","space-y-4"];return a1=function(){return e},a1()}function Cs(e,t){const n=a1();return Cs=function(s,r){return s=s-450,n[s]},Cs(e,t)}(function(e,t){const n=Cs,s=e();for(;;)try{if(-parseInt(n(483))/1+parseInt(n(504))/2*(parseInt(n(508))/3)+-parseInt(n(472))/4*(-parseInt(n(512))/5)+-parseInt(n(453))/6+parseInt(n(506))/7+parseInt(n(477))/8*(parseInt(n(497))/9)+parseInt(n(511))/10*(parseInt(n(482))/11)===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(a1,761090);const DDt=function(){let e=!0;return function(t,n){const s=e?function(){const r=Cs;if(n){const i=n[r(510)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){DDt(this,function(){const e=Cs,t=new RegExp("function *\\( *\\)"),n=new RegExp(e(524),"i"),s=aF(e(521));!t[e(517)](s+e(494))||!n[e(517)](s+"input")?s("0"):aF()})()})();Wg[Rj(464)](...IDt);function ODt(){const e=Rj,[t,n]=K.useState(100),[s,r]=K.useState(0),[i,o]=K.useState(1),[a,l]=K.useState(1e3),[c,u]=K.useState(null),[h,d]=K.useState(null),[f,p]=K.useState(0),[g,m]=K.useState(0),[x,y]=K.useState(!1),b=R=>{R[Cs(466)](),A(t,s,i,a)};function v(){const R=Cs;let z=0,U=0;for(;z===0;)z=Math.random();for(;U===0;)U=Math[R(503)]();return Math.sqrt(-2*Math[R(488)](z))*Math.cos(2*Math.PI*U)}function w(R,z){return R+z*v()}function k(R,z){const U=I(R),F=I(z),P=C(R,U),L=N(R,z,U,F),E=L/P,B=F-E*U;return{slope:E,intercept:B}}function I(R){const z=Cs;return R[z(518)]((U,F)=>U+F,0)/R[z(492)]}function C(R,z){const U=Cs;return R[U(518)]((F,P)=>F+(P-z)**2,0)/R[U(492)]}function N(R,z,U,F){const P=Cs;let L=0;for(let E=0;E<R[P(492)];E++)L+=(R[E]-U)*(z[E]-F);return L/R.length}function $(R,z){const U=Cs,F=Math[U(502)](...R),P=Math.max(...R),L=(P-F)/z,E=Array[U(487)]({length:z},(q,Y)=>F+Y*L),B=Array(z).fill(0);return R[U(496)](q=>{let Q=Math[U(522)]((q-F)/L);Q===z&&Q--,B[Q]++}),{bins:E,counts:B}}const A=(R,z,U,F)=>{const P=Cs,L=Array[P(487)]({length:R},()=>Math[P(503)]()),E=Math.sqrt(U),B=L[P(459)](Nt=>w(z,E)),{slope:q,intercept:Y}=k(L,B),Q={datasets:[{label:"Data Points",data:L[P(459)]((Nt,qt)=>({x:Nt,y:B[qt]})),backgroundColor:P(471)},{label:P(463)+q[P(486)](2)+"X + "+Y[P(486)](2),data:[{x:Math[P(502)](...L),y:q*Math[P(502)](...L)+Y},{x:Math[P(520)](...L),y:q*Math[P(520)](...L)+Y}],type:P(500),borderColor:P(484),borderWidth:2,fill:!1,pointRadius:0}]},J=[],et=[];for(let Nt=0;Nt<F;Nt++){const qt=Array.from({length:R},()=>Math[P(503)]()),fe=qt[P(459)](le=>le+w(z,E)),{slope:Qt,intercept:Xt}=k(qt,fe);J[P(495)](Qt),et[P(495)](Xt)}const nt=20,rt=$(J,nt),ht=$(et,nt),vt={labels:rt[P(491)].map(Nt=>Nt.toFixed(2)),datasets:[{label:P(473),data:rt[P(476)],backgroundColor:P(471)}]},wt={labels:ht.bins[P(459)](Nt=>Nt[P(486)](2)),datasets:[{label:"Intercepts",data:ht[P(476)],backgroundColor:P(467)}]},Tt=J[P(489)](Nt=>Math[P(458)](Nt)>Math[P(458)](q))[P(492)]/F*100,_t=et[P(489)](Nt=>Math.abs(Nt)>Math[P(458)](Y))[P(492)]/F*100;u(Q),d({slopeHistogramData:vt,interceptHistogramData:wt}),p(Tt),m(_t),y(!0)};return j.jsxs(e(461),{className:"mt-6 p-6 bg-gray-800 text-white rounded-lg",children:[j.jsx("h1",{className:e(481),children:e(499)}),j.jsxs(e(465),{onSubmit:b,className:e(498),children:[j.jsxs(e(461),{children:[j.jsx("label",{htmlFor:"N",className:e(523),children:"Sample Size (N):"}),j.jsx(e(516),{type:e(468),id:"N",name:"N",required:!0,className:e(515),value:t,onChange:R=>n(parseInt(R[e(519)][e(479)]))})]}),j.jsxs(e(461),{children:[j.jsx(e(456),{htmlFor:"mu",className:"block font-medium",children:"Mean ():"}),j.jsx(e(516),{type:"number",step:e(507),id:"mu",name:"mu",required:!0,className:e(515),value:s,onChange:R=>r(parseFloat(R.target[e(479)]))})]}),j.jsxs(e(461),{children:[j.jsx("label",{htmlFor:e(478),className:"block font-medium",children:e(505)}),j.jsx("input",{type:e(468),step:e(507),id:e(478),name:e(478),required:!0,className:e(515),value:i,onChange:R=>o(parseFloat(R[e(519)].value))})]}),j.jsxs(e(461),{children:[j.jsx(e(456),{htmlFor:"S",className:e(523),children:e(462)}),j.jsx("input",{type:"number",id:"S",name:"S",required:!0,className:e(515),value:a,onChange:R=>l(parseInt(R[e(519)][e(479)]))})]}),j.jsx(e(480),{type:"submit",className:e(493),children:"Generate"})]}),x&&j.jsxs(e(461),{className:e(457),children:[j.jsx("h2",{className:e(452),children:e(450)}),j.jsx("div",{className:"mt-4",children:j.jsx(EDt,{data:c,options:{scales:{x:{title:{display:!0,text:"X"}},y:{title:{display:!0,text:"Y"}}}}})}),j.jsx("h2",{className:e(452),children:"Histogram of Slopes"}),j.jsx("div",{className:e(455),children:j.jsx(nC,{data:h.slopeHistogramData,options:{scales:{x:{title:{display:!0,text:e(451)}},y:{title:{display:!0,text:e(514)}}}}})}),j.jsx("h2",{className:"text-xl font-semibold mt-6",children:e(454)}),j.jsx(e(461),{className:"mt-4",children:j.jsx(nC,{data:h.interceptHistogramData,options:{scales:{x:{title:{display:!0,text:e(475)}},y:{title:{display:!0,text:e(514)}}}}})}),j.jsxs("p",{className:"mt-4",children:[e(469),f[e(486)](2),"%"]}),j.jsxs("p",{children:["Proportion of intercepts more extreme than calculated intercept: ",g[e(486)](2),"%"]})]})]})}function aF(e){function t(n){const s=Cs;if(typeof n===s(513))return(function(r){})[s(509)](s(485))[s(510)](s(470));(""+n/n)[s(492)]!==1||n%20===0?(function(){return!0}).constructor("debu"+s(501))[s(474)](s(460)):(function(){return!1})[s(509)]("debu"+s(501)).apply(s(490)),t(++n)}try{if(e)return t;t(0)}catch{}}(function(e,t){const n=sh,s=e();for(;;)try{if(parseInt(n(323))/1*(-parseInt(n(311))/2)+parseInt(n(312))/3+-parseInt(n(316))/4+parseInt(n(322))/5+parseInt(n(291))/6+-parseInt(n(317))/7+parseInt(n(306))/8===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(l1,604084);const PDt=function(){let e=!0;return function(t,n){const s=e?function(){if(n){const r=n.apply(t,arguments);return n=null,r}}:function(){};return e=!1,s}}();(function(){PDt(this,function(){const e=sh,t=new RegExp(e(318)),n=new RegExp(e(289),"i"),s=cF(e(294));!t[e(313)](s+e(297))||!n[e(313)](s+e(285))?s("0"):cF()})()})();function lF(){const e=sh,t=6,n=Array.from({length:t+1},(r,i)=>i),s=[j.jsx(j.Fragment,{children:e(321)}),j.jsx(j.Fragment,{children:e(302)}),j.jsx(zY,{}),j.jsx(j.Fragment,{children:e(310)}),j.jsx(RDt,{}),j.jsxs(j.Fragment,{children:["This is the submission to this ",j.jsx("a",{href:e(304),children:"Kaggle competition"})]}),j.jsx(ODt,{})];return j.jsxs("div",{className:e(286),children:[j.jsx("h1",{className:e(305),children:e(303)}),j.jsxs("div",{className:"space-y-8",children:[j.jsx("p",{className:e(293),children:e(298)}),j.jsx("a",{href:"https://github.com/user04f8/genetic-nlp",className:e(295),children:e(299)})]}),j.jsx(e(292),{className:e(307)}),j.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:e(320)}),j.jsx(e(292),{className:"space-y-8",children:n[e(296)](r=>j.jsxs(e(292),{children:[j.jsxs("h2",{className:e(305),children:[e(301),r]}),j.jsx("p",{className:e(293),children:s[r]}),j.jsx("a",{href:e(287)+r,className:e(295),children:"Github Link"})]},r))})]})}function sh(e,t){const n=l1();return sh=function(s,r){return s=s-285,n[s]},sh(e,t)}function cF(e){function t(n){const s=sh;if(typeof n=="string")return(function(r){})[s(319)](s(308))[s(315)](s(288));(""+n/n)[s(300)]!==1||n%20===0?(function(){return!0})[s(319)](s(309)+s(290))[s(314)]("action"):(function(){return!1})[s(319)](s(309)+s(290))[s(315)]("stateObject"),t(++n)}try{if(e)return t;t(0)}catch{}}function l1(){const e=["my-8 border-t border-gray-500 opacity-50","while (true) {}","debu","This is the completed analysis of SVD on MNIST","1773826aDsphI","3446781agJwQP","test","call","apply","2484200EBhNAm","7873117mCcPbA","function *\\( *\\)","constructor","Weekly mini-projects","This is a simple assignment used as a test.","4737850RdgaUm","1KpWLjk","input","mt-20 p-6 text-white","https://github.com/user04f8-cs506/nbclark-assignment-","counter","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","gger","3490092qQompB","div","mt-2","init","text-blue-500 underline","map","chain","This was the winning submission to a kaggle competition on recommender systems, developing a unique approach to generalizing n-grams via the embedding similarity metric.","Github Link","length","Assignment ","This is the assignment on data colection and analysis.","Fuzzy n-grams & matrix factorization: towards improved recommender systems","https://www.kaggle.com/competitions/cs-506-predicting-customer-churn-using-knn/leaderboard","text-2xl font-semibold","4468792WYCkCg"];return l1=function(){return e},l1()}function bc(e,t){var n=c1();return bc=function(s,r){s=s-420;var i=n[s];return i},bc(e,t)}(function(e,t){for(var n=bc,s=e();;)try{var r=parseInt(n(448))/1*(parseInt(n(436))/2)+parseInt(n(431))/3+-parseInt(n(450))/4+parseInt(n(420))/5*(parseInt(n(443))/6)+parseInt(n(438))/7*(-parseInt(n(435))/8)+parseInt(n(449))/9+parseInt(n(426))/10*(-parseInt(n(440))/11);if(r===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(c1,692861);var FDt=function(){var e=!0;return function(t,n){var s=e?function(){var r=bc;if(n){var i=n[r(447)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){FDt(this,function(){var e=bc,t=new RegExp("function *\\( *\\)"),n=new RegExp(e(445),"i"),s=uF(e(427));!t[e(428)](s+e(433))||!n[e(428)](s+e(424))?s("0"):uF()})()})();function LDt(){var e=bc;return j.jsxs(l7,{children:[j.jsx(g7,{}),j.jsx(e(439),{className:e(421),children:j.jsxs(t7,{children:[j.jsx(al,{path:"/",element:j.jsx(VX,{})}),j.jsx(al,{path:"/work-experience",element:j.jsx(KX,{})}),j.jsx(al,{path:"/projects",element:j.jsx(QX,{})}),j.jsx(al,{path:e(430),element:j.jsx(xY,{})}),j.jsx(al,{path:e(444),element:j.jsx(lF,{})}),j.jsx(al,{path:e(437),element:j.jsx(lF,{})})]})})]})}function uF(e){function t(n){var s=bc;if(typeof n===s(432))return(function(r){}).constructor(s(434))[s(447)](s(429));(""+n/n)[s(425)]!==1||n%20===0?(function(){return!0})[s(441)]("debu"+s(422)).call(s(442)):(function(){return!1})[s(441)](s(446)+"gger")[s(447)](s(423)),t(++n)}try{if(e)return t;t(0)}catch{}}function c1(){var e=["stateObject","input","length","10btXGQl","init","test","counter","/contact","2655882UHYyYF","string","chain","while (true) {}","5212088SdKTLe","6zWdWnm","/assignments","7IwcNRh","div","16995429iiPieb","constructor","action","114unyhre","/mini-projects","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","debu","apply","352809RYfXgd","2527353xNBgLU","2437144iVwDvK","335305ZmSIQU","mt-20","gger"];return c1=function(){return e},c1()}var R2=vc;function vc(e,t){var n=u1();return vc=function(s,r){s=s-164;var i=n[s];return i},vc(e,t)}(function(e,t){for(var n=vc,s=e();;)try{var r=parseInt(n(174))/1+-parseInt(n(185))/2+-parseInt(n(169))/3+-parseInt(n(187))/4*(parseInt(n(168))/5)+parseInt(n(175))/6+parseInt(n(186))/7+-parseInt(n(182))/8;if(r===t)break;s.push(s.shift())}catch{s.push(s.shift())}})(u1,705941);var MDt=function(){var e=!0;return function(t,n){var s=e?function(){var r=vc;if(n){var i=n[r(166)](t,arguments);return n=null,i}}:function(){};return e=!1,s}}();(function(){MDt(this,function(){var e=vc,t=new RegExp("function *\\( *\\)"),n=new RegExp(e(180),"i"),s=hF(e(170));!t[e(179)](s+e(165))||!n[e(179)](s+"input")?s("0"):hF()})()})();function u1(){var e=["4WZHAVp","while (true) {}","chain","apply","render","281275DXTmhx","2639721lStYji","init","string","call","debu","1288358bCoxqd","666438BnHCcR","action","counter","gger","test","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","root","4528320rZaAzg","getElementById","constructor","771226XKxFHt","8360275kGDwEQ"];return u1=function(){return e},u1()}TL(document[R2(183)](R2(181)))[R2(167)](j.jsx(K.StrictMode,{children:j.jsx(LDt,{})}));function hF(e){function t(n){var s=vc;if(typeof n===s(171))return(function(r){})[s(184)](s(164))[s(166)](s(177));(""+n/n).length!==1||n%20===0?(function(){return!0}).constructor(s(173)+s(178))[s(172)](s(176)):(function(){return!1})[s(184)](s(173)+"gger").apply("stateObject"),t(++n)}try{if(e)return t;t(0)}catch{}}
